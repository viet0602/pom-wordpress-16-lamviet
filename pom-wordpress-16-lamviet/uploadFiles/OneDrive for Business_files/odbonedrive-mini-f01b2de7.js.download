define("Q3",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.SharePointList="SharePointList"})(n=t.DataSyncEntityType||(t.DataSyncEntityType={}));t.NucleusPreviewEnabled={ODB:1620};t.EnableNucleusListConflictsUX={ODB:60063};function r(e,n){return e(t.NucleusPreviewEnabled)&&(window.localStorage&&"true"===window.localStorage.NucleusPreviewEnabled||/[?&]enableNucleusPreview=true/.test(location.search))}t.isDataSyncEnabled=r;t.isSyncConflictsUxEnabled=function(e){return r(e,n.SharePointList)&&e(t.EnableNucleusListConflictsUX)}});
define("wo",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="EUPL",r="undefined"!=typeof window?window.performance:void 0;t.now=function(){try{if(r&&r.now)return Math.round(performance.now())}catch(e){}return Date.now()};function i(e,t){void 0===t&&(t=!0);return t&&0!==e.lastIndexOf(n+".")?n+"."+e:e}t.mark=function(e,t){try{r&&r.mark&&r.mark(i(e,t))}catch(e){}};t.getMarkTime=function(e,t){try{if(r&&r.getEntriesByName){var n=r.getEntriesByName(i(e,t),"mark");return n&&n.length>0?Math.round(n[0].startTime):NaN}}catch(e){}return NaN};t.getMarkTimes=function(e){try{if(r&&r.getEntriesByType){for(var t=[],n=r.getEntriesByType("mark"),i=0,s=n;i<s.length;i++){var o=s[i];e[o.name]&&t.push({name:o.name,time:o.startTime})}return t}}catch(e){}return[]};t.measure=function(e,t,n,s){try{r&&r.measure&&r.measure(i(e,s),i(t,s),i(n,s))}catch(e){}};t.clearMarks=function(e,t){if(r&&r.mark)for(var n=0,s=Object.keys(e);n<s.length;n++){var o=s[n];r.clearMarks(i(o,t))}}});
define("Oo",["require","exports","ww","wo"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("B8e",["require","exports","ww","SH","yH","vS","KS","WS","JS"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t)});
define("Yq",["require","exports","ww","Jq"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("HD",["require","exports","RD"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WopiHelper=n.WopiHelper});
define("r2",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.unknown="Unknown";t.requestAborted="RequestAborted";t.canceled="Canceled";t.noConnection="NoConnection";t.offline="Offline";t.missingWebForDigestAuth="MissingWebForDigestAuth"});
define("lj",["require","exports","ww","cP","pj","uj"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,r){var o=e.call(this,t,r)||this,u=r.pageContext;o._legacyRequestCache=new s.RequestCache(t,{pageContext:u});t.cacheType;var a=n.__rest(t,["cacheType"]);o._persistentRequestCache=new i.PersistentRequestCache(a,{pageContext:u});return o}t.prototype.getDataUtilizingLegacyCache=function(e){var t=this,r=e,i=r.getUrl,s=r.getAdditionalPostData,o=r.cacheRequestKey,u=r.cacheTimeoutTime,a=n.__rest(r,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime"]);(a=n.__assign({url:i&&i(),additionalPostData:s&&s(),method:"POST"},a)).url=a.url||i&&i();"needsRequestDigest"in a||(a.needsRequestDigest=this.needsRequestDigest(a.url));a.additionalPostData=a.additionalPostData||s&&s();o=o||this.getRequestKey(a.url,a.method,a.additionalPostData);var f=e.useStale,l=void 0!==f&&f,c=e.bypassCache,h=void 0!==c&&c,p=e.onlyCache,d=void 0!==p&&p,v=e.checkForInvalidation,m=void 0!==v&&v,g=e.setInvalidated,y=void 0!==g&&g;return this._legacyRequestCache.getDataUtilizingCache({cacheRequestKey:o,useStale:l,bypassCache:h,onlyCache:d,checkForInvalidation:m,setInvalidated:y,cacheTimeoutTime:u,getData:function(){return t.dataRequestor.getData(a)}})};t.prototype.getDataUtilizingPersistentCache=function(e){var t=this,r=e,i=r.getUrl,s=r.getAdditionalPostData,o=r.cacheRequestKey,u=r.cacheTimeoutTime,a=r.returnStatistics,f=n.__rest(r,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime","returnStatistics"]);(f=n.__assign({url:i&&i(),additionalPostData:s&&s(),method:"POST"},f)).url=f.url||i&&i();"needsRequestDigest"in f||(f.needsRequestDigest=this.needsRequestDigest(f.url));f.additionalPostData=f.additionalPostData||s&&s();o=o||this.getRequestKey(f.url,f.method,f.additionalPostData);var l=e.cachingStrategy;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:l,cacheRequestKey:o,cacheTimeoutTime:u,getData:function(){return t.dataRequestor.getData(f)},returnStatistics:a})};t.prototype.isCachedDataInvalidated=function(e){return this._legacyRequestCache.isCachedDataInvalidated&&this._legacyRequestCache.isCachedDataInvalidated(e)};t.prototype.getRequestKey=function(e,t,n){return this._legacyRequestCache.getRequestKey(e,t,n)};Object.defineProperty(t.prototype,"cacheId",{get:function(){return this._legacyRequestCache.cacheId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cacheVersionId",{get:function(){return this._legacyRequestCache.cacheVersionId},enumerable:!0,configurable:!0});t.prototype.flushCache=function(e){this._legacyRequestCache.flushCache(e);this._persistentRequestCache.flushCache(e)};return t})(r.default);t.CachedDataSource=o;t.default=o});
define("t2",["require","exports","ww","A","s2","me","bv","W","Mv","N","Te","o2","$3","r2","a2","n2"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSyncTelemetryHandler=v.getSyncTelemetryHandler;var m="undefined"!=typeof window?window:void 0,g=m&&m.performance;t.isQosEndSchemaOverride=function(e){return"object"==typeof e};var y=(function(){function e(e,t){this._pageContext=t?t.pageContext:e.pageContext;this._tokenProvider=t&&t.tokenProvider;this._qosName=e.qosName;this._apiEvent=t&&t.apiEvent||s.default;this._engagement=t&&t.engagement||o.Engagement;this._normalizeErrors=!!e.normalizeErrors;this._getDataWithTokenProvider=t&&t.getDataWithTokenProvider}e.parseJSON=function(e){return e&&JSON.parse(e)||void 0};e.prototype.getData=function(t){var s=this,o=t.url,v=t.parseResponse,y=void 0===v?e.parseJSON:v,b=t.qosExtraData,w=t.telemetryHandler,E=t.additionalPostData,S=void 0===E?"":E,x=t.contentType,T=t.method,N=void 0===T?"POST":T,C=t.maxRetries,k=void 0===C?0:C,L=t.responseType,A=t.onUploadProgress,O=t.timeout,M=t.authToken,_=t.noTimeoutInLastRetry,D=void 0!==_&&_,P=t.useExactAuthToken,H=void 0!==P&&P,B=!0,j=this._pageContext,F=this._tokenProvider,I=this._getDataWithTokenProvider,q=new l.SimpleUri(o),R=q.authority+"/{ length: "+q.path.length+", segments: "+q.segments.length+" }",U=[];this._qosName&&U.push(this._qosName);t.qosName&&U.push(t.qosName);var z=U.join("."),W=function(e){var v=e.authToken,E=e.expiresOn,T=e.correlationId,C=t.crossSiteCollectionCall,M=void 0!==C&&C,_=t.noRedirect,P=void 0!==_&&_,F=t.needsRequestDigest,I=void 0===F||F,q=t.additionalHeaders?n.__assign({},t.additionalHeaders):void 0;if(v){var U=H?v:"Bearer "+v;if(q){var W=!1;for(var X in q)X&&"authorization"===X.toLowerCase()&&(W=!0);W||(q.Authorization=U)}else q={Authorization:U};M=!0;I=!1;P=!0}var V,$,J=new d.ServerConnection(n.__assign(n.__assign({},j?{webServerRelativeUrl:j.webServerRelativeUrl,webAbsoluteUrl:M?j.webAbsoluteUrl:void 0,formDigest:{serverTime:j.serverTime,updateFormDigestPageLoaded:j.updateFormDigestPageLoaded,formDigestValue:j.formDigestValue,formDigestTimeoutSeconds:j.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:I,engagement:s._engagement,operationName:s._qosName})),K=m&&m.location&&new l.SimpleUri(m.location.href).authority,Q=new l.SimpleUri(o).authority,G=a.RUMOneLogger.getRUMOneLogger(),Y=Date.now();G&&(Boolean(G.readTempData("appDataFetchStart"))||G.saveTempData("appDataFetchStart",Y));return(function(e){var t,n=e.onExecute,s=e.onCancel,o=e.timeout,u=e.canRetry,a=e.noTimeoutInLastRetry,f=0,l=Math.max(e.maxRetries,0),c=function(){var e=new r.default(n,function(){s(f>=l||!u())});return o&&(!a||f<l)?r.default.timeout(o,e):e};t=f<l?i.default({canRetry:u,retries:l,callback:c,beforeRetry:function(){f++}}):c();return t})({timeout:O,onExecute:function(e,t){var r=function(r,i){return function(a){var f=a.getResponseText();$=a.getServiceWorkerDataSourceHeader();var l,p,d,m,g=c.getRequestEntryDurationMetrics(o,i),S=n.__assign(n.__assign({},b||{}),{needsRequestDigest:I,hasAuthToken:!!v,isCrossOrigin:!!K&&K!==Q,CorrelationId:a.getCorrelationId(),AuthCorrelationId:T,AuthExpiration:E,HttpStatus:a.getStatus(),serviceWorkerDataSource:$||void 0,rawRequestDuration:g.duration,performanceEntry:JSON.stringify(g),serviceWorkerFetchInfo:a.getServiceWorkerFetchInfoFromHeader()||void 0}),x=!1;try{!(function(e,t){return"blob"===e&&t&&"object"==typeof t})(L,f)?p=y(f,a):d=f;x=!0}catch(e){l=e;m={resultType:u.ResultTypeEnum.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:S}}m||(m={resultType:u.ResultTypeEnum.Success,extraData:S});if(w){m=w({response:p,eventData:m}).eventData}r.end(m);if(x)try{e(d||p)}catch(e){}else t(s._normalizeErrors?new h.GetDataError({code:"-1,parse_response",innerError:l,errorData:{status:a.getStatus()}}):void 0);J=void 0}},i=function(e,r){return function(i,a){var l=c.getRequestEntryDurationMetrics(o,r),d=n.__assign(n.__assign({},b||{}),{needsRequestDigest:I,hasAuthToken:!!v,isCrossOrigin:!!K&&K!==Q,rawRequestDuration:l.duration,performanceEntry:JSON.stringify(l)}),m="undefined"!=typeof navigator&&!1===navigator.onLine;if(i){var g=i.getCorrelationId(),y=i.getGroupThrottle(),E=i.getMSCorrelationVector(),S=i.getStatus(),x=i.getAuthErrorType();d=n.__assign(n.__assign({},d),{CorrelationId:g,HttpStatus:S,GroupThrottle:y,MSCorrelationVector:E,AuthErrorType:x});var T=u.ResultTypeEnum.Failure;if(403===S||404===S||429===S||503===S||-1===S||0===S&&m){B=!1;T=u.ResultTypeEnum.ExpectedFailure}var N=function(r){var o,a=void 0;if("object"==typeof r&&"number"==typeof r.status)a=r;else if("string"==typeof r){var l=void 0;try{l=JSON.parse(r)}catch(e){}o=(function(e){if(e)try{var t=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(e),n=t[1],r=void 0===n?"-1":n,i=t[2],s=void 0===i?"":i,o=t[3],u=void 0===o?"unknown":o,a=void 0;switch(Number(r)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:a=!0;break;default:a=!1}return new f.ApiError({code:r+","+u,message:s,isExpected:a})}catch(e){return new f.ApiError({code:"-1,Unknown",innerError:e})}})(x);l&&(a=l.error_description?{code:"-1,"+(l.error||"Unknown"),message:l.error_description}:"string"==typeof l.error?{message:l.error}:l.error||l["odata.error"]||{responseData:l})}(a=a||{}).status=S;a.retryAfter=i.getRetryAfterHeader();var c=a["@error.redirectUrl"],v=i.getRedirectUrl()||c;v&&(T=u.ResultTypeEnum.ExpectedFailure);a.redirectUrl=v;a.authenticate=i.getAuthenticateHeader();g&&(a.correlationId=g);y&&(a.groupThrottle=y);"-1,policy_enforced"===a.code&&(T=u.ResultTypeEnum.ExpectedFailure);o&&o.isExpected&&(T=u.ResultTypeEnum.ExpectedFailure);a.code=o&&o.code||a.code||p.unknown;var m="["+S.toString()+"] "+a.code,b=JSON.stringify(a),E={resultType:T,error:b,resultCode:m,extraData:d};if(w){var N=w({eventData:E,errorData:a}),C=N.eventData,k=N.canRetry;E=C;!0!==k&&!1!==k||(B=k)}e.end(E);t(s._normalizeErrors?new h.GetDataError(n.__assign({errorData:a,innerError:o},T===u.ResultTypeEnum.ExpectedFailure?{isExpected:!0}:{})):a)},C=i.getResponseType();if(C&&"text"!==C)i.parseError().then(N);else{N(i.getResponseText())}}else{var k=p.unknown,L=!0,A=0;if(a&&a instanceof f.ApiError){k=a.code;L=a.isExpected;A=-1}!m||k!==p.noConnection&&k!==p.unknown||(k=p.offline);var O={status:A,code:k},M={resultType:L?u.ResultTypeEnum.ExpectedFailure:u.ResultTypeEnum.Failure,resultCode:k,extraData:d};t(s._normalizeErrors?new h.GetDataError({errorData:O,innerError:a}):O);if(w){M=w({eventData:M,errorData:O}).eventData}e.end(M)}}};(function(){var e=V=new s._apiEvent({url:R,name:z}),t=g&&g.now();J.getServerDataFromUrl({url:o,successCallback:r(e,t),failureCallback:i(e,t),uploadProgressCallback:A,additionalPostData:S,method:N,additionalHeaders:q,contentType:x,withCredentials:!v&&void 0,noRedirect:P,responseType:L,needsRequestDigest:I})})()},maxRetries:k,noTimeoutInLastRetry:D,canRetry:function(){return B},onCancel:function(e){if(J){J.abort();e&&J.dispose()}}}).then(function(e){J&&J.dispose();return e},function(e){J&&J.dispose();!V.endTime&&r.default.isCanceled(e)&&V.end({resultCode:p.canceled,resultType:u.ResultTypeEnum.ExpectedFailure});return r.default.reject(e)})};if(M)return r.default.resolve(M).then(function(e){return W({authToken:e})});if(F&&F.getAuthToken)return I?I({apiEvent:this._apiEvent,getData:W,options:{url:o,webAbsoluteUrl:j&&j.webAbsoluteUrl},qosName:z,tokenProvider:F}):r.default.resolve(F.getAuthToken({url:o,webAbsoluteUrl:j&&j.webAbsoluteUrl})).then(function(e){return W(e&&"string"!=typeof e?e:{authToken:e})});if(j){if(j.getAuthToken)return r.default.resolve(j.getAuthToken()).then(function(e){return W({authToken:e})});if(j.authToken)return r.default.resolve(j.authToken).then(function(e){return W({authToken:e})})}return W({})};return e})();t.DataRequestor=y;t.default=y});
define("cP",["require","exports","ww","A","t2","Q3","q3"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u,a=(u=function(e){return o.default.isFeatureEnabled(e)},s.isDataSyncEnabled(u)?new Promise(function(t,n){e(["lWe"],t,n)}).then(function(e){return function(t){return e.getDataSyncClient(t,u)}}):r.default.resolve(function(e){})),f=(function(){function e(e,t){var r=this._pageContext=t.pageContext,s=t.tokenProvider,o=t.dataRequestorType,u=void 0===o?(function(e){n.__extends(t,e);function t(t){return e.call(this,t,{pageContext:r,tokenProvider:s})||this}return t})(i.default):o,a=t.dataSyncClient,f=e.dataSourceName,l=void 0===f?"DataSource":f;this.dataSyncClient=a;this.dataRequestor=new u({qosName:l})}e.prototype.getDataSourceName=function(){return this.dataSourceName};e.prototype.needsRequestDigest=function(e){return!0};e.prototype.getData=function(e,t,n,s,o,u,f,l,c,h,p,d,v){var m=this;void 0===o&&(o="POST");var g=e(),y=s&&s(),b=function(){return m.dataRequestor.getData({url:g,parseResponse:t,qosName:n,additionalPostData:y,method:o,additionalHeaders:u,contentType:f,maxRetries:l,noRedirect:c,crossSiteCollectionCall:h,telemetryHandler:p,qosExtraData:d,needsRequestDigest:m.needsRequestDigest(g),authToken:v})};if(!this._pageContext.aadUserId)return b();var w=function(e){var r=i.getSyncTelemetryHandler(e,p);return e.getData({url:g},function(e){return m.dataRequestor.getData({url:e.url,authToken:e.authToken,parseResponse:t,qosName:n,additionalPostData:y,method:o,additionalHeaders:u,contentType:f,maxRetries:l,noRedirect:c,crossSiteCollectionCall:h,telemetryHandler:function(t){return r(t,e)},qosExtraData:d,needsRequestDigest:m.needsRequestDigest(e.url),useExactAuthToken:!0})},b)};return this.dataSyncClient?r.default.wrap(w(this.dataSyncClient)):r.default.wrap(a).then(function(e){var t=e(m._pageContext.aadUserId);return t?w(t):b()})};return e})();t.DataSource=f;t.default=f});
define("$3",["require","exports","ww","N"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(r){var i=this,s=r.errorData,o=void 0===s?r.innerError instanceof t&&r.innerError.errorData||{status:0}:s,u=o.message,a=void 0===u?void 0:u,f=o.correlationId,l=void 0===f?void 0:f,c=o.code,h=void 0===c?void 0:c,p=n.__rest(o,["message","correlationId","code"]),d="object"==typeof a?a?"string"==typeof a.value?a.value:JSON.stringify(a):""+a:a,v=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},"string"==typeof l?{correlationId:l}:{}),"string"==typeof h?{code:h}:{}),"string"==typeof d?{message:d}:{}),r),{extraData:n.__assign(n.__assign({},r.extraData||{}),{hasAuthChallenge:!!p.authenticate,status:p.status,infected:p.infected,groupThrottle:p.groupThrottle,statusText:p.statusText})});(i=e.call(this,v)||this).name="GetDataError";i.errorData=o;for(var m=0,g=Object.keys(p);m<g.length;m++){var y=g[m];i[y]=p[y]}return i}return t})(r.ApiError);t.GetDataError=i});
define("fj",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_CACHE_TIMEOUT_TIME=3e5;t.DEFAULT_PERSISTENT_CACHE_TIMEOUT_TIME=864e5;t.DEFAULT_CACHE_ID_PREFIX="odsp-ds-";(function(e){e[e.useCacheAndUpdateInTheBackground=0]="useCacheAndUpdateInTheBackground";e[e.useCacheIfNotExpired=1]="useCacheIfNotExpired";e[e.onlyCache=2]="onlyCache";e[e.bypassCache=3]="bypassCache"})(t.CachingStrategy||(t.CachingStrategy={}))});
define("pj",["require","exports","ww","A","k","mj","W","fj"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t){this._getDataPromises={};var r=e.id,i=e.dataSourceName,u=e.cacheType,a=void 0===u?1:u,f=(t.pageContext||{}).aadUserId;this._id=r;this._userId=f;var l=i||r,c=o.Qos.withData(function(e){return e.name&&l&&!e.name.startsWith(l)?n.__assign(n.__assign({},e),{name:l+"."+e.name}):e});this._cache=new s.PersistentCache({cacheType:a,telemetry:{qos:c}})}e.prototype.getDataUtilizingCache=function(e){var t=this,n=e.cacheRequestKey,s=e.cachingStrategy,o=void 0===s?0:s,a=e.cacheTimeoutTime,l=void 0===a?u.DEFAULT_PERSISTENT_CACHE_TIMEOUT_TIME:a,c=e.getData,h=e.returnStatistics,p=void 0!==h&&h,d={key:n,user:this._userId},v=function(){f()||t._getDataPromises[n]||(t._getDataPromises[n]=c().then(function(e){delete t._getDataPromises[n];return e}));return(f()?c():t._getDataPromises[n]).then(function(e){t._cache.update(d,e);return p?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return i.Killswitch.isActivated("19cec8a5-4f79-4d4c-ae7e-f272ba265abb")||2!==o?r.default.resolve(this._cache.read(d)).then(function(e){var n=e.data,r=e.cacheStats;if(null==n)return v();var i=p?{data:n,cacheStats:r}:n,s=t._isCacheExpired(r.lastModified,l);switch(o){case 2:return i;case 0:s&&v();return i;case 1:return s?v():i;case 3:default:return v()}}).catch(function(){return v()}):r.default.resolve(this._cache.read(d)).then(function(e){var t=e.data,n=e.cacheStats;return null==t?null:p?{data:t,cacheStats:n}:t}).catch(function(){return null})};e.prototype.getRequestKey=function(e,t,n){var r=[];r.push(e);r.push(t);n&&r.push(n.toString());return r.join(",")};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0});e.prototype.flushCache=function(e){var t={key:e,user:this._userId};delete this._cache[e];this._cache.remove(t)};e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t};return e})();t.PersistentRequestCache=a;function f(){return i.Killswitch.isActivated("0b1fbce0-bb51-41da-a09b-8d1686398bb7")}});
define("uj",["require","exports","A","K3","G3","fj"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){var n=e.id,o=e.cacheType,u=void 0===o?i.default.session:o,a=t.cacheIdPrefix,f=void 0===a?s.DEFAULT_CACHE_ID_PREFIX:a,l=t.pageContext;this._id=n;this._version=l?l.siteClientTag+"_"+l.userDisplayName:"";this._store=new r.default(f,u);this._storeDefaultCacheType=u;this._initCache()}e.prototype.getDataUtilizingCache=function(e){var t=this,r=e.cacheRequestKey,o=e.useStale,u=void 0!==o&&o,a=e.bypassCache,f=void 0!==a&&a,l=e.onlyCache,c=void 0!==l&&l,h=e.checkForInvalidation,p=e.setInvalidated,d=e.getData,v=e.cacheTimeoutTime,m=void 0===v?s.DEFAULT_CACHE_TIMEOUT_TIME:v,g=e.returnStatistics,y=void 0!==g&&g,b=this._cache,w=b[r],E=function(){return y?{data:w._value,cacheStats:{lastModified:NaN,lastRead:w._fetched,reads:NaN}}:w._value};if(c)return w?n.default.resolve(E()):n.default.resolve(void 0);h=h&&!f&&this._storeDefaultCacheType!==i.default.local;var S=w&&this._isCacheExpired(w,r,h,m);return f||!w||S&&!u?d().then(function(e){var n=(new Date).valueOf();b[r]={_fetched:n,_value:e};p&&t._store.setValue(r,n-1,i.default.local);t._updateCache();return y?{data:e,cacheStats:{lastModified:NaN,lastRead:n,reads:NaN}}:e}):n.default.resolve(E())};e.prototype.getRequestKey=function(e,t,n){var r=[];r.push(e);r.push(t);n&&r.push(n.toString());return r.join(",")};e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0});e.prototype.flushCache=function(e){if(e){delete this._cache[e];this._updateCache()}else this._clearCache()};e.prototype._initCache=function(){if(this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)){this._clearCache();this._store.setValue(this.cacheVersionId,this._version,void 0,!1)}else this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}};e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)};e.prototype._clearCache=function(){this._cache={};this._updateCache()};e.prototype._isCacheExpired=function(e,t,n,r){if(n&&this._isCachedDataInvalidated(e,t))return!0;var i=(new Date).valueOf()-r;return e._fetched<=i};e.prototype._isCachedDataInvalidated=function(e,t){var n=Number(this._store.getValue(t,i.default.local));return!!(e&&n&&e._fetched<n)};return e})();t.RequestCache=o;t.default=o});
define("a2",["require","exports","Be","I","A3","A","N","i2","r2"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(){function e(e){void 0===e&&(e={});this._scope=new r.default;this._events=this._scope.attach(new i.default(this));var t=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||t&&new n.default(t).getPath();"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl="");if(t){this._webAbsoluteUrl=t;this._alwaysGetDigest=!0}else this._alwaysGetDigest=!1;this._needsRequestDigest=!1!==e.needsRequestDigest;this._needsRequestDigest&&this._tryLoadDigest(e.formDigest);this._requestCanaryForAuth=!1;this._engagement=e.engagement;this._operationName=e.operationName}e._isValidFormDigest=function(e){return e&&e.serverTime&&Date.now()-new Date(e.serverTime).getTime()<1e3*(e.formDigestTimeoutSeconds-60)};e.prototype.dispose=function(){this._scope.dispose()};e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0;e.abort();this._currentRequest=void 0}};e.prototype.isRequestActive=function(){return!!this._currentRequest};e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,r=e.successCallback,i=e.failureCallback,s=e.uploadProgressCallback,o=e.additionalPostData,u=e.isRest,a=void 0===u||u,f=e.method,l=void 0===f?"POST":f,c=e.withCredentials,h=e.additionalHeaders,p=e.contentType,d=e.noRedirect,v=e.responseType,m=e.needsRequestDigest,g=void 0===m?this._needsRequestDigest:m,y=(new Date).toISOString(),b=new XMLHttpRequest;b.open(l,n,!0);"boolean"==typeof c&&(b.withCredentials=c);v&&(b.responseType=v);p?b.setRequestHeader("Content-Type",p):a?b.setRequestHeader("Content-Type","application/json;odata=verbose"):b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var w=!1;if(h)for(var E in h)if(E){b.setRequestHeader(E,h[E]);"accept"===E.toLowerCase()&&(w=!0)}w||b.setRequestHeader("accept","application/json;odata=verbose");this._currentRequest=b;var S=function(e){g&&e&&b.setRequestHeader("x-requestdigest",e);t._events.on(b,"readystatechange",function(){t._onReadyStateChange(b,n,r,i,d,y)});s&&b.upload&&t._events.on(b.upload,"progress",function(e){s(e)});b.send(o)};g?this._ensureRequestDigest(S,i):S()};e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)};e.prototype._ensureRequestDigest=function(t,n){var r=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(r)?t(r.formDigestValue):this._ensureRequestDigestWorker(t,n)};e.prototype._ensureRequestDigestWorker=function(t,r){var i=this,u=new Date,f=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(f._requestCanaryForAuth=!0);var l=this._webAbsoluteUrl||this._webServerRelativeUrl;if("string"==typeof l){e._requestDigestPromise||(e._requestDigestPromise=new s.default(function(s,o){f.getServerDataFromUrl({url:n.default.concatenate(l,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),r=JSON.parse(n).d.GetContextWebInformation;e._formDigests[i._webServerRelativeUrl]={serverTime:u.toISOString(),formDigestValue:r.FormDigestValue,formDigestTimeoutSeconds:r.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date};s(e._formDigests[i._webServerRelativeUrl].formDigestValue);e._requestDigestPromise=void 0},failureCallback:function(n,i){t?t(void 0):r&&r(n,i);o(void 0);e._requestDigestPromise=void 0},method:"POST",noRedirect:!!r})}));e._requestDigestPromise.then(function(e){t&&t(e);return e})}else r&&r(void 0,new o.ApiError({code:a.missingWebForDigestAuth,isExpected:!1}))};e.prototype._onReadyStateChange=function(t,n,r,i,s,f){if(4===t.readyState){this._currentRequest=void 0;this._events.off(t);t.upload&&this._events.off(t.upload);if((d=t)&&d.isCancelled)i(void 0,new o.ApiError({code:a.requestAborted,isExpected:!0}));else if((function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!1}catch(e){return!1}return!0})(t)){var l=new u.default(t,n,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),c=l.getStatus(),h=!s&&l.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){this._requestCanaryForAuth=!1;if(403===c){var p=l.getRedirectLoginPageUrl();try{h?window.location.href=l.getRedirectToErrorCustomPromptLocation():i(l)}catch(e){}p&&!s&&(window.location.href=p)}else{p=l.getAccessDeniedRedirectUrl();try{i(l)}catch(e){}if(p&&!s){this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}});window.location.href=p}}return}if(200===c||201===c||204===c){r(l);return}if(403===c){e._requestDigestPromise=void 0;s?this._ensureRequestDigestWorker(void 0,function(e,t){return i(l,t)}):h?window.location.href=l.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0);return}401===c&&h&&(window.location.href=l.getRedirectToErrorCustomPromptLocation());i(l)}else i(void 0,new o.ApiError({code:a.noConnection,isExpected:!0}));var d}};e.prototype._tryLoadDigest=function(t){if(e._isValidFormDigest(t))e._formDigests[this._webServerRelativeUrl]=t;else{var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n&&new Date(n.serverTime).getTime()<new Date(t.serverTime).getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)}};e._formDigests={};e._requestDigestPromise=void 0;return e})();t.ServerConnection=f;t.default=f});
define("i2",["require","exports","C","Be","ze","k"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SERVICEWORKER_DATASOURCE_HEADER_KEY="X-SERVICEWORKER-DATA-SOURCE";var o=(function(){function e(e,t,n){this._request=e;this._url=t;this._webAbsoluteUrl=n&&n.webAbsoluteUrl;this._isCanaryRequest=n&&n.isCanaryRequest}e.prototype.getSourceUrl=function(){return this._url};e.prototype.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()};e.prototype.getCorrelationId=function(){return this.getResponseHeader("SPRequestGuid")};e.prototype.getGroupThrottle=function(){return this.getResponseHeader("SPGroupThrottle")};e.prototype.getAuthErrorType=function(){return this.getResponseHeader("x-ms-diagnostics")};e.prototype.getMSCorrelationVector=function(){return this.getResponseHeader("MS-CV")};e.prototype.getServiceWorkerDataSourceHeader=function(){return this.getResponseHeader(t.SERVICEWORKER_DATASOURCE_HEADER_KEY)};e.prototype.getServiceWorkerFetchInfoFromHeader=function(){return this.getResponseHeader("X-ServiceWorkerFetchInfo")};e.prototype.getRetryAfterHeader=function(){var e=this.getResponseHeader("Retry-After"),t=Number(e);return isNaN(t)?void 0:t};e.prototype.getStatus=function(){try{return this._request.status}catch(e){}};e.prototype.getAuthenticationRedirect=function(){return this.getResponseHeader("X-Forms_Based_Auth_Required")};e.prototype.getAuthenticateHeader=function(){return this.getResponseHeader("WWW-Authenticate")};e.prototype.getResponseType=function(){return this._request.responseType};e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText};e.prototype.getErrorResponseText=function(){if("blob"===this._request.responseType){return{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader("x-virus-infected"),authenticate:this.getResponseHeader("WWW-Authenticate")}}return this.getResponseText()};e.prototype.parseError=function(){var e=this,t=new n.default;this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?(function(e){var t,r=new n.default,i=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result);r.complete(e)}catch(e){r.complete({message:"Unable to parse blob result."})}}},s=function(){r.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",i);t.addEventListener("error",s);t.readAsText(e)}catch(e){s()}return r.getPromise().then(function(e){if(t){t.removeEventListener("load",i);t.removeEventListener("error",s)}return e})})(this._request.response).then(function(n){var r={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e.getResponseHeader("x-virus-infected"),authenticate:e.getResponseHeader("WWW-Authenticate")};t.complete(r)}):t.complete(this._request.response):t.complete(this._request.responseText);return t.getPromise()};e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n};e.prototype.getRedirectUrl=function(){var e=s.Killswitch.isActivated("56A1255F-5247-4496-A8A2-FF9190FC7342","11/17/2020","redirect url when access denied");if(this._isCanaryRequest)return 403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl();if(403===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();if(!e)return this.getRedirectLoginPageUrl()}else if(401===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();if(!e)return this.getRedirectLoginPageUrl()}};e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new r.default(t);n.setQueryParameter("ReturnUrl",i.default.encodeURIComponent(window.location.href));e=n.toString()}return e};e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new r.default(t);n.setQueryParameter("Source",i.default.encodeURIComponent(window.location.href));n.setQueryParameter("Type","list");n.setQueryParameter("correlation",i.default.encodeURIComponent(this.getCorrelationId()));e=n.toString()}}return e};e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),t=new r.default(e);t.setQueryParameter("ReturnUrl",window.location.href);return t.toString()};e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCode"),t=this.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t};e.prototype.getResponseHeadersDictionary=function(){var e={},t=this.getAllResponseHeaders();if(t){var n=t.trim().split(/[\r\n]+/);n&&n.length>0&&n.forEach(function(t){var n=t.split(": "),r=n.shift(),i=n.join(": ");e[r]=i})}this.getResponseHeadersDictionary=function(){return e};return e};e.prototype.getResponseHeader=function(e){var t=this.getResponseHeadersDictionary();return t[e.toLowerCase()]||t[e]};e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"};return e})();t.default=o});
define("n2",["require","exports","ww","q"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSyncTelemetryHandler=function(e,t){return function(i,s){var o=i.eventData,u=o.extraData,a={performanceEntry:u&&u.performanceEntry,httpStatus:u&&u.HttpStatus,correlationId:u&&u.CorrelationId,succeeded:o&&o.resultType===r.ResultTypeEnum.Success||!1,resultCode:o&&o.resultCode,endpoint:s},f=t&&t(i),l=e.onRequestComplete(a);u.dataSyncQos=e.getQosInfo();return n.__assign(n.__assign({},f||{}),{eventData:n.__assign(n.__assign({},f?f.eventData:o),{extraData:n.__assign(n.__assign({},f?f.eventData.extraData:o.extraData),e.getQosInfo())}),canRetry:l&&(!f||f.canRetry)})}}});
define("Y9e",["require","exports","ww","cP","ze","vS","Ge","We","Z7","gH","J9e"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;n._listContext=t.listContext;n._itemUrlHelper=t.itemUrlHelper||new o.ItemUrlHelper({},{pageContext:t.pageContext});n._apiUrlHelper=t.apiUrlHelper||new u.ApiUrlHelper({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper});n._folderPath=t.folderPath;void 0===n._folderPath&&(n._folderPath=f.getFolderPath(t.parentKey,n._listContext));return n}t.prototype.getFilterData=function(e,t,n,r){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,r)},function(e){return e},"GetFilterData")};t.prototype._getFilterDataUrl=function(e,t,n,r){var o=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl}),u=this._apiUrlHelper.build().webByItemUrl(o).method("GetList",o.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e);n&&n!==l.needsAttentionViewId&&(u=u.parameter("ViewId",n));this._folderPath&&(u=u.parameter("RootFolder",{raw:i.default.encodeURIComponent(this._folderPath)}));r&&r===s.ColumnFieldType.Taxonomy&&(u=u.parameter("ExcludeFieldFilteringHtml",!0));var f=a.getFilterParams(t,!0);return(u=u.rawParameter(f)).toString()};return t})(r.default);t.ListFilterDataSource=c;t.default=c});
define("JS",["require","exports","$S","ZS","XS"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.buildCollapsedGroups=function(e,n,r){for(var i=[],s=0,o=void 0,u=void 0,a=(r=r||n.groupBy)[0],f=r[1],l=0,c=e;l<c.length;l++){var h=c[l];if(a&&"1"===h[a+".newgroup"]){var p=t(n,h,a,0,!0,s);i.push(p);s+=p.count;o=p;u=void 0}if(f&&"1"===h[f+".newgroup"]){u=t(n,h,f,1,!0,u?u.startIndex+u.count:o?o.startIndex:0,o)}}return{groups:i,totalCount:s}};e.buildGroupFromItem=function(e,n,r,i){if((i=i||r.groupBy)&&i.length>0){var s=n&&n.length>0?n[n.length-1]:void 0,o=i[0],u=i[1];if(o&&"1"===e[o+".newgroup"]){var a=t(r,e,o,0,!1,s?s.startIndex+s.count:0);n||(n=[]);n.push(a);s=a}if(u&&"1"===e[u+".newgroup"]){var f=s&&s.children&&s.children.length>0?s.children[s.children.length-1]:void 0;t(r,e,u,1,!1,f?f.startIndex+f.count:s?s.startIndex:0,s)}}};function t(e,t,o,u,a,f,l){var c=e.groupSchema[o],h=0===u?o+".COUNT.group":o+".COUNT.group2",p=c?c.Type:void 0;c&&"Calculated"===c.FieldType&&(p=c.FieldType);var d=s(t,o,p),v=(function(e,t){return e[t+".urlencoded"]})(t,o),m=(function(e,t,o){var u=void 0;if("string"!=typeof e[t+".groupdisp"]||"DateTime"===o&&!Boolean(e[t+".groupdisp"])){if("FileSizeDisplay"===t&&e.hasOwnProperty("File_x0020_Size"))u=r.default.getDisplayString(Number(e.File_x0020_Size),{ignoreZero:!0});else if("_IsRecord"===t&&e.hasOwnProperty("_ComplianceFlags")){var a=+e._ComplianceFlags;u=4&a&&1&a?i.default.yes:i.default.no}else if(e.hasOwnProperty(t))switch(o){case"User":var f=e[t];f&&f.length>0&&(u=f[0].title);break;case"Lookup":var l=e[t];void 0!==l&&(l.Label&&l.TermID?u=l.Label:Array.isArray(l)&&l.length>0?u=l[0].lookupValue:"string"==typeof l&&(u=l));break;case"WorkflowStatus":u=e[t]?n.default.getWorkflowStatusFromRawHtml(e[t]).display:"";break;case"Boolean":case"ModStat":case"Number":case"Currency":case"Text":case"DateTime":u=e[t]}}else u=e[t+".groupdisp"];"string"!=typeof u&&(u=s(e,t,o));return u})(t,o,p),g=(function(e,t,n,r){var i=void 0;switch(r){case"Lookup":var s=e[t];void 0!==s&&(s.Label&&s.TermID?i=s.Label+"|"+s.TermID:s.length>0?i=String(s[0].lookupId):"string"==typeof s&&(i=s));break;case"Boolean":i=e[t+".value"];break;case"User":var o=e[t];if(o&&o.length>0){var u=o[0].email;i=JSON.stringify([{Key:u,IsResolved:!1}])}else"string"==typeof o&&(i=o);break;default:i=n}return i})(t,o,d,p),y={groupingType:"SPListGroup",groupingId:(l?l.groupingId+"-":"")+(d||"(null)"),name:m,groupString:v,fieldSchema:c,fieldValue:g,count:Number(t[h]),isCollapsed:a,startIndex:f,isDropEnabled:c&&"TRUE"!==c.ReadOnly&&void 0!==g,parentKey:l?l.groupingId:void 0,level:l?l.level+1:0};if(l){l.children||(l.children=[]);l.children.push(y)}return y}e.buildGroup=t;e.getGroupingId=function(e,t,n,r){return(r?r+"-":"")+(s(e,t,n)||"(null)")};function s(e,t,n){var r=void 0;if("DateTime"===n)r=(r=e[t]).split(" ")[0];else if("Lookup"===n){var i=e[t];void 0!==i&&(i.Label&&i.TermID?r=i.Label:Array.isArray(i)&&i.length>0?r=i[0].lookupValue:"string"==typeof i&&(r=i))}else if(e.hasOwnProperty(t+".singleurlencoded")&&"Calculated"!==n)r=decodeURIComponent(e[t+".singleurlencoded"]);else if(e.hasOwnProperty(t+".urlencoded")){var s=(r=decodeURIComponent(e[t+".urlencoded"])).split(";#");s.length>=2&&(r=s[s.length-2])}else"FileSizeDisplay"===t&&e.hasOwnProperty("File_x0020_Size")?r=e.File_x0020_Size:"_IsRecord"===t&&e.hasOwnProperty("_ComplianceFlags")&&(r=e._ComplianceFlags);return r}})(t.GroupBuilder||(t.GroupBuilder={}))});
define("yH",["require","exports","ww","Gk","k","CS","Z7","zi"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemName=function(e,t,n){return n&&!n.isDocLib&&t!==r.default.Folder&&(e.Title||e["URL.desc"])||e.FileLeafRef};t.updateListContext=function(e,t){if(Number(e.ListTemplateType)){t.listTemplateType=Number(e.ListTemplateType);t.isDocLib=u.isDocumentLibrary(t.listTemplateType)}"boolean"==typeof e.ContentTypesEnabled&&(t.contentTypesEnabled=e.ContentTypesEnabled);if(e.ListSchema){t.listId=e.listName;t.rawListSchema=e.ListSchema;t.viewTitle=e.viewTitle;t.openInClient="0"===t.rawListSchema.DefaultItemOpen}e.ListTitle&&(t.listTitle=e.ListTitle);e.listUrlDir&&(t.listUrl=decodeURIComponent(e.listUrlDir));e.EnableAttachments&&(t.enableAttachments="true"===e.EnableAttachments);e.Flags2&&(t.flags2=e.Flags2);var r=e.BasePermissions;r&&(t.permissions={manageLists:r.ManageLists,managePersonalViews:r.ManagePersonalViews,openItems:r.OpenItems});"boolean"!=typeof e.ExcludeFromOfflineClient&&"boolean"!=typeof e.WebExcludeFromOfflineClient||(t.excludeFromOfflineClient=!(!e.ExcludeFromOfflineClient&&!e.WebExcludeFromOfflineClient));"boolean"==typeof e.TenantTagPolicyEnabled&&(t.tenantTagPolicyEnabled=e.TenantTagPolicyEnabled);"boolean"==typeof e.verEnabled&&(t.enableVersions=e.verEnabled);"boolean"==typeof e.checkPowerAppState&&(t.checkPowerAppState=e.checkPowerAppState);"boolean"==typeof e.EnableMinorVersions&&(t.enableMinorVersions=e.EnableMinorVersions);"boolean"==typeof e.NewWOPIDocumentEnabled&&(t.newWOPIDocumentEnabled=e.NewWOPIDocumentEnabled);"number"==typeof e.NewWOPIDocumentTypes&&(t.newWOPIDocumentTypes=e.NewWOPIDocumentTypes);"boolean"==typeof e.isForceCheckout&&(t.isForceCheckout=e.isForceCheckout);"boolean"==typeof e.isModerated&&(t.isModerated=e.isModerated);"boolean"==typeof e.EnableRequestSignOff&&(t.enableRequestSignOff=e.EnableRequestSignOff);"boolean"==typeof e.AllowCreateFolder&&(t.allowCreateFolder=e.AllowCreateFolder);"boolean"==typeof e.AllowGridMode?t.allowGridMode=e.AllowGridMode:"boolean"!=typeof t.allowGridMode&&(t.allowCreateFolder=!0);e.displayFormUrl&&(t.displayFormUrl=e.displayFormUrl);e.editFormUrl&&(t.editFormUrl=e.editFormUrl);e.newFormUrl&&(t.newFormUrl=e.newFormUrl);e.metadataNavFeatureEnabled&&(t.metadataNavFeatureEnabled=e.metadataNavFeatureEnabled);e.AvailableContentTypes&&(t.availableContentTypes=e.AvailableContentTypes);if(e.ViewMetadata){var o=void 0;o=i.Killswitch.isActivated("F5D38A68-8774-425A-BC0B-1650EAA9C41D","9/21/2018","avoid mutate the original serverView object in the spdata")?e.ViewMetadata:n.__assign({},e.ViewMetadata);if(e.VisualizationInfo)try{o.VisualizationInfo=JSON.parse(e.VisualizationInfo)}catch(e){}o.CustomFormatter=e.ListSchema&&e.ListSchema.CustomFormatter;t.viewResult=new s.default(o)}t.isPlaceholder=!1};t.updateListContextGroupInfo=function(e){var t=void 0;if(e.groupByOverride)t=[e.groupByOverride];else if(e.rawListSchema&&e.rawListSchema.group1){(t=[]).push(e.rawListSchema.group1);e.rawListSchema.group2&&t.push(e.rawListSchema.group2)}var n=-1,r=e.rawListSchema&&"TRUE"===e.rawListSchema.Collapse;if(t&&t.length>0){n=0;if(e.filterParams&&!r){var i=Boolean(o.getFilterFieldByName(e.filterParams,t[0])),s=!(!i||!t[1])&&Boolean(o.getFilterFieldByName(e.filterParams,t[1]));(i&&1===t.length||s&&2===t.length)&&(n=-1)}}e.groupLevel=n;e.groupBy=n>-1?t:void 0;e.isGrouped=Boolean(e.groupBy)}});
define("SH",["require","exports","yH"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ListItemBuilderHelpers=n});
define("vS",["require","exports","yS"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ColumnFieldType=n.ColumnFieldType;(function(e){e[e.icon=16]="icon";e[e.iconMin=16]="iconMin";e[e.bigIcon=48]="bigIcon";e[e.bigIconMin=48]="bigIconMin";e[e.regularMin=90]="regularMin";e[e.regular=130]="regular";e[e.nameMin=220]="nameMin";e[e.nameODC=440]="nameODC";e[e.nameODB=280]="nameODB";e[e.originalLocation=300]="originalLocation";e[e.custom=900]="custom";e[e.sharedWith=150]="sharedWith";e[e.note=250]="note";e[e.dateModifiedMl=150]="dateModifiedMl";e[e.dotDotDot=32]="dotDotDot";e[e.ratingsMin=110]="ratingsMin"})(t.ColumnWidth||(t.ColumnWidth={}));(function(e){e[e.none=0]="none";e[e.icon=1]="icon";e[e.name=2]="name";e[e.title=3]="title";e[e.calloutInvoker=4]="calloutInvoker";e[e.shareHeroCommand=5]="shareHeroCommand";e[e.modified=6]="modified";e[e.url=7]="url"})(t.MappedColumnType||(t.MappedColumnType={}));(function(e){e[e.none=0]="none";e[e.notify=1]="notify";e[e.block=2]="block";e[e.notifyAndBlock=3]="notifyAndBlock";e[e.blockSharing=4]="blockSharing"})(t.PolicyTipType||(t.PolicyTipType={}));(function(e){e[e.Auto=0]="Auto";e[e.Pinned=1]="Pinned";e[e.Removed=2]="Removed"})(t.ShowInFiltersPaneStatus||(t.ShowInFiltersPaneStatus={}));(function(e){e[e.fileNotFound=-2147024894]="fileNotFound";e[e.invalidView=-2147024809]="invalidView";e[e.listNotFound=-1]="listNotFound";e[e.docAlreadyExists=-2130575257]="docAlreadyExists";e[e.queryThrottled=-2147024860]="queryThrottled";e[e.newExperieceRenderingNotSupported=-2]="newExperieceRenderingNotSupported";e[e.onePageNavigationViewMismatch=-3]="onePageNavigationViewMismatch";e[e.onePageNavigationError=-4]="onePageNavigationError"})(t.ErrorType||(t.ErrorType={}))});
define("KS",["require","exports","ww","WS","WS"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SchemaBuilder=r;n.__exportStar(i,t)});
define("WS",["require","exports","FS","k","Ce","Z7","zi","vS"],function(e,t,n,r,i,s,o,u){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0});var f=((a={})[1]={key:"type",index:0,isVisibleMobile:!0,isCollapsable:!1,type:u.ColumnFieldType.FileIcon},a[2]={key:"name",index:1,isRowHeader:!0,isVisibleMobile:!0,isCollapsable:!1,minWidth:u.ColumnWidth.nameMin,width:u.ColumnWidth.nameODB,type:u.ColumnFieldType.Name},a[3]={key:"Title",index:1,isVisibleMobile:!0,isCollapsable:!1,minWidth:u.ColumnWidth.nameMin,width:u.ColumnWidth.nameODB,type:u.ColumnFieldType.Title},a[5]={key:"_shareHeroCommand",index:2,isVisibleMobile:!1,isCollapsable:!0,minWidth:16,width:18,type:u.ColumnFieldType.ShareCommand},a[4]={key:"_calloutInvoker",index:3,isVisibleMobile:!1,isCollapsable:!0,minWidth:16,width:18,type:u.ColumnFieldType.DotDotDot},a[6]={key:"dateModified",index:4,isVisibleMobile:!0,isCollapsable:!1,minWidth:u.ColumnWidth.regularMin,width:u.ColumnWidth.regular,type:u.ColumnFieldType.DateTime,sortDescFirst:!0},a[7]={key:"URL",index:5,isVisibleMobile:!0,isCollapsable:!1,minWidth:u.ColumnWidth.nameMin,width:u.ColumnWidth.nameODB,type:u.ColumnFieldType.Hyperlink},a),l=5;t.EXCLUDED_FIELDS=["_ip_UnifiedCompliancePolicyUIAction","_CommentFlags","_CommentCount","Edit","MediaServiceFastMetadata","MediaServiceTranscript","name.FileSystemItemId","SMTotalFileCount","SMTotalSize"];var c=t.EXCLUDED_FIELDS.concat(["FolderChildCount","ItemChildCount"]),h=[u.ColumnFieldType.Text,u.ColumnFieldType.Name,u.ColumnFieldType.Title,u.ColumnFieldType.DateTime,u.ColumnFieldType.Number];t.buildSchema=function(e,n,r,i,s){if(e&&e.Field){for(var o=-1,a=0,h=0,m=e.Field;h<m.length;h++){if("TRUE"===(C=m[h]).listItemMenu){o=a;break}a++}!r.disableCalloutInvoker&&o>=0&&e.Field.splice(o+1,0,{DisplayName:r.calloutInvokerDisplayName,Name:"_calloutInvoker",Sortable:"FALSE",Type:"Computed"});!r.disableShareHeroCommand&&o>=0&&e.Field.splice(o+1,0,{DisplayName:r.shareHeroCommandDisplayName,Name:"_shareHeroCommand",Sortable:"FALSE",Type:"Computed"});for(var b,w,E,S=new Array(r.hasFixedSchema?l:0),x={},T=0,N=e.Field;T<N.length;T++){var C,k=(C=N[T]).Name;if(-1===(r.hasFixedSchema?c:t.EXCLUDED_FIELDS).indexOf(k)){var L=p(k),A=f[L],O=v(C,A,n,r,e,s);if("TRUE"===C.GroupField&&i){i[k]=C;if(x[k])continue;O.isVisible=!1;O.isVisibleMobile=!1}S[r.hasFixedSchema&&A&&!S[A.index]?A.index:S.length]=O;x[k]=O;switch(L){case 1:b=O;break;case 2:w=O;break;case 6:E=O}}}if((n.groupBy||e.group1||e.group2)&&(!b||b!==S[0])){var M={key:"other",name:"",minWidth:u.ColumnWidth.regularMin,width:u.ColumnWidth.regular,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isAscending:!0,fieldType:u.ColumnFieldType.Text,filterable:!1,groupable:!1,resizable:!1,isGrouped:!1,isFiltered:!1};M.minWidth=y(r.useCustomColumn);M.width=g(r.useCustomColumn);M.fieldType=u.ColumnFieldType.Computed;S.unshift(M)}return r.useCustomColumn?d(b,[[w],[E]],[w,E]):S.filter(function(e){return!!e})}};function p(e){switch(e){case"FSObjType":case"DocIcon":return 1;case"LinkFilename":case"LinkFilenameNoMenu":case"FileLeafRef":case"LinkIssueIDNoMenu":return 2;case"LinkTitle":case"LinkTitleNoMenu":case"Title":return 3;case"_calloutInvoker":return 4;case"_shareHeroCommand":return 5;case"Modified":return 6;case"URLwMenu":case"URLNoMenu":return 7;default:return 0}}t.getMappedColumnType=p;function d(e,t,n){for(var r={key:"custom",name:"",minWidth:u.ColumnWidth.regularMin,width:u.ColumnWidth.custom,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:u.ColumnFieldType.Text,filterable:!1,groupable:!1,customFields:[]},i=0;i<t.length;i++)for(var s=0,o=t[i];s<o.length;s++){var a=o[s];a.customRowNumber=i;r.customFields.push(a)}for(var f=[e,r],l=0,c=n;l<c.length;l++){var h=c[l];h.isVisible=!1;h.isVisibleMobile=!1;f.push(h)}return f}t.getCustomColumns=d;t.getMappedColumnFieldType=function(e){var t=p(e.Name),n=f[t];return n?n.type:w(e)};function v(e,t,a,f,l,c){var p=e.Name,d=t?t.type:w(e),v=!!t&&"type"===t.key,E=h.indexOf(d)>-1,S=a.filterParams||"",x=!!s.getFilterFieldByName(S,p);!x&&c&&c.additionalFiltersXml&&(x=!!c.additionalFiltersXml.match(new RegExp('FieldRef Name="'+p+'"')));if(a.viewXmlForRequest)try{var T=i.getViewDomParts(a.viewXmlForRequest);if(T&&T.where){1===T.where.querySelectorAll('[id="'+p+'"]').length&&(x=!0)}}catch(e){}var N={key:t?t.key:p,name:e.DisplayName,internalName:p,staticName:e.StaticName,fieldType:d,width:u.ColumnWidth.regular,minWidth:u.ColumnWidth.regularMin,isVisible:!0,isVisibleMobile:!t||t.isVisibleMobile,isCollapsable:!t||t.isCollapsable,canAutoResize:E,isIcon:v,resizable:!0,isRowHeader:!!t&&t.isRowHeader,sortable:"FALSE"!==e.Sortable,filterable:!("FALSE"===e.Filterable||"TRUE"===e.FilterDisable||"Note"===e.FieldType||"URL"===e.FieldType||"FileSizeDisplay"===p||"_IsRecord"===p),groupable:"FALSE"!==e.Groupable&&"FALSE"!==e.Sortable&&b(p,d),editable:!(e.FromBaseType&&"TRUE"===e.FromBaseType),isSealed:"TRUE"===e.Sealed,isGrouped:a.groupByOverride===p||l.group1===p||l.group2===p,isSorted:a.sortField===p,isAscending:a.sortField!==p||"true"===a.isAscending,sortDescFirst:!!t&&!!t.sortDescFirst,isFiltered:x,filterValues:s.getFilterValueByName(S,p),isRequired:!!e.Required,isAutoHyperLink:t?f.serverSupportsAutoHyperLink:!!e.AutoHyperLink&&f.serverSupportsAutoHyperLink||d===u.ColumnFieldType.Note&&"FALSE"!==e.RichText,isAppendOnly:e.AppendOnly&&"TRUE"===e.AppendOnly,choices:e.Choices,dispFormUrl:e.DispFormUrl,allowGridEditing:e.AllowGridEditing,pinnedToFiltersPane:e.PinnedToFiltersPane&&"TRUE"===e.PinnedToFiltersPane,showInFiltersPane:e.ShowInFiltersPane&&u.ShowInFiltersPaneStatus[e.ShowInFiltersPane],clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties,customFormatter:e.CustomFormatter,serverFieldType:e.Type,resultType:e.ResultType,isCalculated:"Calculated"===e.role,isNote:d===u.ColumnFieldType.Note&&"FALSE"===e.RichText,clientSideColumnAdapter:e.ClientSideColumnAdapter,sspId:e.SspId,termSetId:e.TermSetId,anchorId:e.AnchorId,realFieldName:e.RealFieldName,hasListItemMenu:"TRUE"===e.listItemMenu,linkToItem:!!e.LinkToItem,isLink:"URLwMenu"===e.Name&&a.listTemplateType===o.default.links,richText:e.RichText};e.ID&&(N.id=e.ID);if(t){N.minWidth=v?y(f.useCustomColumn):t.minWidth;N.width=v?g(f.useCustomColumn):t.width}d===u.ColumnFieldType.SharedWith?N.width=u.ColumnWidth.sharedWith:d===u.ColumnFieldType.Note?N.width=u.ColumnWidth.note:d===u.ColumnFieldType.AverageRating?N.minWidth=u.ColumnWidth.ratingsMin:d!==u.ColumnFieldType.DateTime||r.Killswitch.isActivated("5BF871F9-43C4-415C-8FEF-5288A169E0F8","11/13/2017","Support friendly date time columns")||(N.getValue=function(e){return(function(e,t){var r=void 0;e&&t&&(r=(r=m(e.key+".FriendlyDisplay",t))?n.getRelativeDateTimeStringForLists(r):m(e.key,t));return r})(N,e)});return N}function m(e,t){var n="";if(t&&void 0===(n=t[e])&&t.properties){void 0===(n=t.properties[e])&&t.recycleBinProperties&&(n=t.recycleBinProperties[e]);n&&Array.isArray(n)&&(n=n.join(", "))}return n}function g(e){return e?u.ColumnWidth.bigIcon:u.ColumnWidth.icon}function y(e){return e?u.ColumnWidth.bigIcon:u.ColumnWidth.iconMin}function b(e,t){switch(t){case u.ColumnFieldType.Attachments:case u.ColumnFieldType.Hyperlink:case u.ColumnFieldType.Image:case u.ColumnFieldType.Note:case u.ColumnFieldType.FileSize:case u.ColumnFieldType.FileIcon:return!1;default:var n=p(e);return 2!==n&&3!==n}}function w(e){var t=e.FieldType;"Calculated"===t&&(t=e.ResultType);if("Computed"===t)switch(e.Name){case"FileSizeDisplay":return u.ColumnFieldType.FileSize;case"ImageSize":return u.ColumnFieldType.ImageSize;case"SharedWith":return u.ColumnFieldType.SharedWith;case"_IsRecord":return u.ColumnFieldType.ComplianceRecordFlag;case"ThumbnailOnForm":case"Thumbnail":return u.ColumnFieldType.Thumbnail;default:return u.ColumnFieldType.Computed}var n=u.ColumnFieldType[t];if("number"==typeof n)return n;switch(t){case"UserMulti":return u.ColumnFieldType.User;case"URL":return"Hyperlink"===e.Format?u.ColumnFieldType.Hyperlink:u.ColumnFieldType.Image;case"LookupMulti":return u.ColumnFieldType.Lookup;case"MultiChoice":return u.ColumnFieldType.Choice;case"TaxonomyFieldType":case"TaxonomyFieldTypeMulti":return u.ColumnFieldType.Taxonomy}return u.ColumnFieldType.Text}t.getColumnFieldType=w});
define("$7",["require","exports","Me","ze","eS","k","Le"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={ODB:1201};t.getListDataUrl=function(e){var t,f,l=e.webUrl,c=e.webId,h=e.listId,p=e.view,d=e.searchTerm,v=e.rootFolder,m=e.sortField,g=e.sortDir,y=e.filterParams,b=e.groupString,w=e.requestToken,E=e.viewId,S=e.viewPath,x=e.urlParts,T=e.isOnePageNavigation,N=e.uniqueId,C=e.remoteWebUrl,k=C?[r.default.escapeUrlForCallback(C)]:[r.default.escapeUrlForCallback(l)];C&&"/"!==C.slice(-1)&&o.default.isFeatureEnabled(u)?k.push("/"):"/"!==l.slice(-1)&&k.push("/");x&&(f=void 0===(t=x.siteRelation)?x.isCrossSite:t);var L=s.Killswitch.isActivated("BC0D39CA-6A40-44C6-BC43-EC999DC12B95","3/7/2019","Use cross-site list call for anything not known to be same-site")?f===n.SiteRelation.crossSite:f!==n.SiteRelation.sameSite;if(x&&(L||c)&&x.fullListUrl&&!T){k.push("_api/SP.List.GetListDataAsStream?listFullUrl='");var A=x.fullListUrl;if(C&&o.default.isFeatureEnabled(u)){A=new URL(C).origin+x.serverRelativeItemUrl}k.push(r.default.encodeRestUriStringToken(A));if(w){"?"!==w[0]&&i.Verbose.logData({name:"ListItemDataHelper.InvalidRequestToken",message:w});k.push("'&"+w.substring(1));return k.join("")}k.push("'&View=")}else{var O=x&&x.serverRelativeListUrl;O||(O=x&&x.serverRelativeItemUrl);if(O)k.push("_api/web/GetList(@listUrl)");else if(h){k.push("_api/web/lists/GetById('");k.push(h);k.push("')")}else k.push("_api/web/DefaultDocumentLibrary");if(w){k.push("/RenderListDataAsStream");k.push(w);k.push(a(O));if("string"==typeof d){k.push("&InplaceSearchQuery=");k.push(r.default.encodeURIComponent(d))}return k.join("")}k.push("/RenderListDataAsStream?");O&&k.push(a(O,!0));k.push("View=");p&&k.push(p);if(S){k.push("&ViewPath=");k.push(r.default.encodeURIComponent(S))}}E&&k.push("&ViewId="+E);if("string"==typeof d){k.push("&InplaceSearchQuery=");k.push(r.default.encodeURIComponent(d))}if(v){k.push("&RootFolder=");k.push(r.default.encodeURIComponent(v))}if(N){k.push("&RootFolderUniqueId=");k.push(r.default.encodeURIComponent(N))}if("string"==typeof b){k.push("&IsGroupRender=TRUE");k.push("&DrillDown=1");k.push("&GroupString="+b)}m&&k.push("&SortField="+m);g&&k.push("&SortDir="+g);y&&k.push(y);return k.join("")};function a(e,t){var n=[];if(e){t||n.push("&");n.push("@listUrl='");n.push(r.default.encodeRestUriStringToken(e));n.push("'");t&&n.push("&")}return n.join("")}t.getListRequestHeaders=function(e,t){var n,i,o,u;if(t){n=t.needsQuickLaunch;i=t.webId;o=t.siteId}e.listUrl?u="listUrl="+r.default.encodeURIComponent(e.listUrl):e.listId&&(u="list="+e.listId);i&&(u+=",webId="+i);o&&!s.Killswitch.isActivated("ade8eb60-e615-4e1f-b530-ccfbc7d1c145","11/30/2017","Pass site id to GetListDataAsStream")&&(u+=",siteId="+o);return{"X-SP-REQUESTRESOURCES":n?"NAVIGATIONSTRUCTURE,"+u:u}};t.getListEntityTypeName=function(e,t){var n=e;t&&0===e.indexOf(t)&&(n=e.replace(t,""));"/"===n.substring(0,1)&&(n=n.substring(1));0===n.toLowerCase().indexOf("lists/")&&(n=n.substr("lists/".length)+"List");for(var r=[],i=0;i<n.length;i++){var s=n.charAt(i),o=n.charCodeAt(i);if(!(o>47&&o<58||o>64&&o<91||o>96&&o<123)){s="_x"+("0000"+o.toString(16)).slice(-4)+"_"}r.push(s)}r.length>0&&1===r[0].length&&(r[0]=r[0].toUpperCase());return"SP.Data."+r.join("")+"Item"};t.getEntityPropertyName=function(e,t){var n="_"===e[0]?"OData_"+e:e;if(t)switch(t.toLowerCase()){case"lookup":n+="Id";break;case"user":case"usermulti":n+="StringId"}return n};t.getFieldType=function(e,t,n){void 0===n&&(n="Text");if(!t)return n;for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.Name===e)return s.FieldType}return n}});
define("Jq",["require","exports","ww","$7","De","cP","A","W","bv","M","W","Le"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:1201};t.GROUPINGID_NEXT="__next__";var p=(function(e){n.__extends(s,e);function s(t){return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:t.pageContext})||this}s.prototype.getItem=function(t,n,r,i){var s=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;var u=t.remoteItem&&c.default.isFeatureEnabled(h)?this._getRemoteItemPostData():this.getAdditionalPostData(t.postDataContext,n,t.pageSize);return e.prototype.getData.call(this,function(){return s.getUrl(n,t)},function(e,t){return s._parseResponse(e,r.qosEvent,t)},r.qosName,function(){return u},"POST",this._getListRequestHeaders(t,n),void 0,void 0,void 0,void 0,function(e){var t=s._telemetryHandler(e);i&&i(t.eventData);return t},void 0,t.authToken).then(function(e){return e},function(e){s._errorHandler(r.qosName,e);return o.default.reject(e)})};s.prototype.getUrl=function(e,t){var n,i=t&&t.postDataContext;n=c.default.isFeatureEnabled(h)?{webUrl:this._pageContext.webAbsoluteUrl,listId:t.remoteItem?t.remoteItem.ListId:e.listId,urlParts:t.remoteItem?{}:e.urlParts,searchTerm:e.searchTerm,rootFolder:t.remoteItem?void 0:e.folderPath,isOnePageNavigation:t.isOnePageNavigation,remoteWebUrl:t.remoteItem?t.remoteItem.SiteUrl:t.remoteWebUrl,uniqueId:t.remoteItem&&t.remoteItem.UniqueId}:{webUrl:this._pageContext.webAbsoluteUrl,listId:e.listId,urlParts:e.urlParts||{},searchTerm:e.searchTerm,rootFolder:e.folderPath,isOnePageNavigation:t.isOnePageNavigation};if(this._isSpecifiedItemRequest(e))n.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest||i&&i.isOnePage)&&e.viewIdForRequest!==f.default.Empty&&(n.view=e.viewIdForRequest);!n.view&&e.viewPathForRequest&&(n.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(n.filterParams=e.filterParams);if(e.sortField){n.sortField=e.sortField;n.sortDir="false"===e.isAscending?"Desc":"Asc"}i&&i.groupReplace?n.requestToken=this._isExpandingGroup(n)?void 0:e.requestToken:n.requestToken=e.group?void 0:e.requestToken;!this._isExpandingGroup(e)||i&&i.groupReplace||(n.groupString=e.group.groupString);i&&i.webId&&(n.webId=i.webId)}return r.getListDataUrl(n)};s.prototype.getAdditionalPostData=function(e,t,n){return i.getAdditionalPostData(e,t,n)};s.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})};s.prototype._getListRequestHeaders=function(e,t){var n=r.getListRequestHeaders(t,e.postDataContext);n["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst";return n};s.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0};s.prototype._isExpandingGroup=function(e){return e.group&&e.group.groupingId!==t.GROUPINGID_NEXT};s.prototype._parseResponse=function(e,t,n){var r=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,r)}catch(n){if("{}"!==e.substring(0,2)){t.end({resultType:u.ResultTypeEnum.Failure,resultCode:"BadJSON"});throw n}return this._getListItemResponse(e.substring(2),r)}};s.prototype._getListItemResponse=function(e,t){var n;n=JSON.parse(e);"ServiceWorker-FromCache"===t&&(n.isFromServiceWorkerCache=!0);return n};s.prototype._telemetryHandler=function(e){var t=e.errorData,r=n.__assign({},e.eventData);if(t){var i=void 0,s=t.code?t.code:"";if(s.indexOf("2147024860")>-1)s="ListViewTreshold";else if(s.indexOf("2147024749")>-1)s="LookupColumnTreshold";else if(s.indexOf("2147024809")>-1&&s.indexOf("requestUrl")>-1)s="RequestURLFailure";else if(s.indexOf("2147024809")>-1&&s.indexOf("range")>-1)s="RangeError";else if(s.indexOf("2147024809")>-1&&s.indexOf("view")>-1)s="InvalidView";else if(s.indexOf("2130575340")>-1&&s.indexOf("field")>-1)s="FieldTypesNotInstalledProperly";else if(s.indexOf("2146232832")>-1){s="DefaultDoclibNotFound";if(500===t.status){i=!1;r.resultType=l.ResultTypeEnum.ExpectedFailure}}else if(s.indexOf("2147024895")>-1){s="PrefetchWebMismatch";if(500===t.status){i=!1;r.resultType=l.ResultTypeEnum.ExpectedFailure}}else s=r.resultCode;r.resultCode=s;return{canRetry:i,eventData:r}}return{eventData:r}};s.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?a.default.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&a.default.logData({name:e+".LookupColumnTreshold"})};return s})(s.default);t.SPListItemRetriever=p;t.default=p});
define("Iie",["require","exports","ww","xie","cP","A","y9","W"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(){this._qos=new u.default({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:u.ResultTypeEnum.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:u.ResultTypeEnum.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:u.ResultTypeEnum.ExpectedFailure,error:JSON.stringify(t)})};return e})(),f=(function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e})(),l=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,{},{pageContext:t})||this;i.logger=new f;if(n){n.logger&&(i.logger=n.logger);n.useAbsoluteUrlForOAuth&&(i._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)}i._oAuthUtility=new r.default(i);return i}t.prototype.qosMonitor=function(){return new a};Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:o.getSafeWebServerRelativeUrl(this._pageContext)},enumerable:!0,configurable:!0});t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var r=e.headers.get("Content-Type");e.headers.delete("Content-Type");return t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),r,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};t.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};t.prototype.getInstrumentedToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))};t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};t.forEach(function(e,t){n[t]=e});return n};t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};t.prototype._es6PromiseToOdspPromise=function(e){return new s.default(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};return t})(i.default);t.default=l});
define("$P",["require","exports","ww","y9","cP","nT","A","tT","We","Ge","Ne","eM","nM","k","eT","Be"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){var r=this,i=g(t)?t:n.pageContext;r=e.call(this,{},{pageContext:i})||this;var s=g(t)?t.apiUrlHelper:n.apiUrlHelper;r._apiUrlHelper=s||new a.ApiUrlHelper({},{itemUrlHelper:new f.ItemUrlHelper({},{pageContext:i}),pageContext:i});r._capabilities={supportsMruCaching:!0};if(n){r._dataRequestor=n.dataRequestor;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._substratePeoplePickerHelper=n.substratePeoplePickerHelper;r._livePeoplePickerHelper=n.livePeoplePickerHelper;r._getAuthToken=n.getAuthToken}return r}t.prototype.getCapabilities=function(){return this._capabilities};t.prototype.getPersonaDetails=function(e){var t=this;return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},i=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,s={personDetails:n(i.Primary),managerChain:i.ManagerChain.results.map(n),directReports:i.DirectReports.results.map(n)};s.personDetails.profilePage=r.getServerUrl(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(s.personDetails.sip)+"&origin=ProfileODBCard";return s}})})};t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===s.default.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})};t.prototype.resolve=function(e,t){var n=this;return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:r,parseResponse:function(e){var r=JSON.parse(e),i=JSON.parse(r.d.ClientPeoplePickerResolveUser),o=[];o[0]=i;p.Killswitch.isActivated("067ca2b4-2244-4153-8dfa-d11e6b4487bb","03/19/2018","Only overwrite display text if it is null or empty")?i.IsResolved||(o[0].DisplayText=i.Key):i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(o[0].DisplayText=i.Key);var u=(o=n._transformData(o,t.filterExternalUsers))[0];if(t.filterExternalUsers&&u&&1===u.entityType){u.isResolved=!1;u.entityType=0}else if(t.blockViaPolicy&&!t.filterExternalUsers&&u&&!u.isResolved&&0===u.multipleMatches.length){u.isResolved=!0;u.isExternal=!0;u.entityType=1}if(t.isGraphDistributionList&&t.useGraph&&u.isExternal){u.entityType=2;u.principalType=s.default.distributionList}return u}})})};t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t&&!this._dataRequestor&&(this._dataRequestor=new c.default({},{}));return t};t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t&&!this._dataRequestor&&(this._dataRequestor=new c.default({},{}));return t};t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper};t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)};t.prototype.sharePointSearch=function(e,t){var n=this;t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1);return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Search",authToken:r,parseResponse:function(r){var i=t.allowSharePointGroups,o=void 0===i||i,u=t.filterExternalUsers,a=t.forceResolve,f=JSON.parse(r),l=JSON.parse(f.d.ClientPeoplePickerSearchUser),c=n._transformData(l,u);u&&(c=c.filter(function(e){return 1!==e.entityType}));var h=!c.length;c=c.filter(function(e){return e.principalType===s.default.sharePointGroup?o:e.principalType===s.default.securityGroup?o||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)});if(p.Killswitch.isActivated("cc7520a8-6922-4e12-81c1-179764750212","3/29/2018","Disable limiting no results behavior to e-mail addresses."))a&&h&&c.push({name:e,userId:e,email:e});else if(!1!==t.resolveEmailIfNoResults&&0===c.length&&n._isValidEmail(e,!1)){var d={Key:e,IsResolved:!1};c.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:d,rawPersonData:d,isExternal:!0})}return c}})})};t.prototype.subscribePresence=function(e,t){var n=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var r=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};this._skypeIntegration.TrackPresence(e,r);return{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,r)}catch(e){}}}}catch(e){}return null};t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"};t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)};t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};t.prototype._graphSearch=function(e,n){var r=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(i){if(!i)return r.sharePointSearch(e,n);var o=new v.default("https://graph.microsoft.com/v1.0/me/people");if(e){o.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"});if(p.Killswitch.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&o.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var u=t._getPersonTypeFilter(n);u&&o.setQueryParameter("$filter",u)}}return r._dataRequestor.send({apiName:"Graph.PeopleSearch",path:o.toString(),headers:{Authorization:"Bearer "+i,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0);if(!t||!t.value||0===t.value.length)return r.sharePointSearch(e,n);var i=t.value,o=[];i.forEach(function(e){var t=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",i=e.userPrincipalName&&r._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:t,u={Key:i,IsResolved:!1},a="ImplicitContact"===e.personType.subclass,f="OrganizationUser"===e.personType.subclass,c="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,h="PublicDistributionList"===e.personType.subclass,p=l.getUserPhotoUrl(t),d={department:e.department,email:t,image:a?void 0:p,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||t,name:e.displayName,providerName:f?"Provider":void 0,userId:i,rawData:u,rawPersonData:u,isExternal:!f,aadObjectId:e.id};if(f){d.entityType=0;d.principalType=s.default.user;d.isResolved=!0}else if(c){d.entityType=2;d.principalType=s.default.securityGroup;d.isResolved=!1;d.userId=e.id}else{d.principalType=h?s.default.distributionList:s.default.none;d.entityType="Group"===e.personType.class?2:1;d.isResolved=!1;d.providerName=void 0}d.userId&&o.push(d)});if(!1!==n.resolveEmailIfNoResults&&0===o.length&&r._isValidEmail(e,!1)){var u={Key:e,IsResolved:!1};o.push({email:e,entityType:1,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:u,rawPersonData:u,isExternal:!0})}return o},function(t){if(h.isGraphError(t))switch(t.status){case 400:case 401:case 403:case 404:r._graphPeoplePickerHelper.disableGraphCallsForPicker();return r.sharePointSearch(e,n);default:return r.sharePointSearch(e,n)}else"Canceled"!==t.name&&r._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:r.sharePointSearch(e,n)})})};t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(i=t.siteIBSegmentIDs);var o=["Directory"];p.Killswitch.isActivated("9403ac4d-b51a-48b3-a4c0-9007477f73ea","02/18/2020","Mailbox Searching in Substrate People Suggestions.")||o.splice(0,0,"Mailbox");var a={};a=p.Killswitch.isActivated("04f09a5b-1c0f-42ef-9b9f-ba8c1e321810","07/03/2020","Removing litoken in Substrate call.")?{Authorization:"Bearer "+r,"X-User-Context":"litoken="+r}:{Authorization:"Bearer "+r};return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:u.SUBSTRATE_SEARCH_URL+"/api/v1/suggestions",headers:a,needsAuthorization:!1,requestType:"POST",postData:JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:o,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=r.Groups[0]?r.Groups[0].Suggestions:[],o=[];i.forEach(function(e){var r=e.EmailAddresses[0]||e.QueryText||"",i=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:r,u={Key:i,IsResolved:!1},a="ImplicitContact"===e.PeopleSubtype,f="OrganizationUser"===e.PeopleSubtype,c="LinkedIn"===e.PeopleSubtype,h="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,p="PublicDistributionList"===e.PeopleSubtype,d=l.getUserPhotoUrl(r),v={department:e.Department,office:e.OfficeLocation,email:r,image:a?void 0:d,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||r,name:e.DisplayName,providerName:"Provider",userId:i,rawData:u,rawPersonData:u,isExternal:!f};if(f){v.entityType=0;v.principalType=s.default.user;v.isResolved=!0}else if(h){v.entityType=2;v.principalType=s.default.securityGroup;v.isResolved=!1;v.providerName=void 0}else if(c)v.entityType=4;else{v.principalType=p?s.default.distributionList:s.default.none;v.entityType="Group"===e.PeopleType?2:1;v.isResolved=!1;v.providerName=void 0}v.userId&&o.push(v)});if(!1!==t.resolveEmailIfNoResults&&0===o.length&&n._isValidEmail(e,!1)){var u={Key:e,IsResolved:!1};o.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:u,rawPersonData:u,isExternal:!0})}return o},function(r){if("Canceled"!==r.name){n._substratePeoplePickerHelper.disableSubstrateCallsForPicker();n.sharePointSearch(e,t)}return null})})};t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&d.default.isValidEmailSyntax(e,!1):!t};t._getPersonTypeFilter=function(e){if(e.principalType===s.default.user)return"personType/class ne 'Group'";var t="";e.principalType&s.default.distributionList||(t+="personType/subclass ne 'PublicDistributionList'");if(!(e.principalType&s.default.securityGroup)){t&&(t+=" and ");t+="personType/subclass ne 'UnifiedGroup'"}return t||(!1!==e.filterPublicDistributionList?"personType/subclass ne 'PublicDistributionList'":"")};t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var r=e.EntityData,i={name:e.DisplayText,email:r.Email,userId:e.Key,job:r.Title,department:r.Department,phone:r.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(i.multipleMatches.length>0){i.multipleMatches=n._transformData(i.multipleMatches,t);t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType}))}var o=i.email;i.isResolved&&(i.image=o?l.getUserPhotoUrl(o):null);var u=r.PrincipalType||e.EntityType;switch(u){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1;i.principalType=s.default.user;i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2;i.principalType="SharePointGroup"===u?s.default.sharePointGroup:s.default.securityGroup;break;default:i.entityType=0;i.principalType=s.default.user}return i})};return t})(i.default);t.PeoplePickerDataSource=m;function g(e){return!!e.webAbsoluteUrl}});
define("nT",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e[e.user=1]="user";e[e.distributionList=2]="distributionList";e[e.securityGroup=4]="securityGroup";e[e.sharePointGroup=8]="sharePointGroup";e[e.all=15]="all"})(n||(n={}));t.default=n});
define("oP",["require","exports","ww","FS","Ge","We","cP","dP","y9","Gk","sP","uv","Ne","Le","k","ew"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EDIT_ROLE="role:1073741827";t.VIEW_ROLE="role:1073741826";t.OWNER_ROLE="role:1073741829";t.HasInheritedLinksUI={ODB:1657};var m=!d.Killswitch.isActivated("f8f5a253-cc95-4903-8f09-41053f644db1","10/13/2020","Deactivate Trackable Anyone Link, disable anyoneLinkAbility"),g=(function(e){n.__extends(o,e);function o(t,n){void 0===n&&(n={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;r._getParentListId=t.getParentListId;r._itemUrlHelper=t.itemUrlHelper||new i.ItemUrlHelper({},{pageContext:t.pageContext});r._apiUrlHelper=t.apiUrlHelper||new s.ApiUrlHelper({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper});r._sharingContextInformation=t.sharingContextInformation||void 0;r._sharingDataSourceHelper=new l.default({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var o=a.getSafeWebServerRelativeUrl(r._pageContext);r._shareUrl=o+"/_api/SP.Web.ShareObject";return r}o.parsePeople=function(e){return e.map(function(e){var t={role:o.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:t}})};o.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1}};o.prototype.getSharingInformation=function(e,t,n,r,i,s){var o,u=this,a=(r=r||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),f="pickerSettings";t&&(f+=",permissionsInformation");n&&(f+=",sharingLinkTemplates");i&&(f+=",addressBarLinkSettings");o=a.oDataParameter("$Expand",f).toString();return this.getData(function(){return o},function(t){var n=JSON.parse(t);return u._parseGetSharingInformationResponse(n,e)},"GetSharingInformation",null,"POST",null,null,null,!0,void 0,void 0,this._getExtraData(),s)};o.prototype.emailWithoutPermissioning=function(e,t,n,r){var i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("ForwardObjectLink").toString();return this.getData(function(){return i},function(e){var n=JSON.parse(e).d,r=[];n.UniquelyPermissionedUsers&&n.UniquelyPermissionedUsers.results&&(r=n.UniquelyPermissionedUsers.results);var i=[];n.InvitedUsers&&n.InvitedUsers.results&&(i=n.InvitedUsers.results);var s={};s.statusCode=n.StatusCode;s.errorMessage=n.ErrorMessage;s.people=o.parsePeople(r);s.invitedUsers=o.parsePeople(i);s.itemId=t&&t.id;i.length>0&&(s.invitationLink=i[0].InvitationLink);s.invalidEmails=[];if(n.UsersWithInvalidEmails&&n.UsersWithInvalidEmails.results)for(var u=0,a=n.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];s.invalidEmails.push(f.User)}return s},"ForwardObjectLink",function(){for(var t=[],i=0,s=e;i<s.length;i++){var o=s[i];t.push(o.rawPersonData)}var u={peoplePickerInput:JSON.stringify(t),emailBody:n,emailSubject:r};return JSON.stringify(u)})};o.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);if(t.d){return t.d.CheckPermissions.results}return null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})};o.prototype.share=function(e,n){var r,i=this,s=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(9===n.linkType||6===n.linkType||5===n.linkType)return this._shareLink(e,n);if(s){var u=n.items[0],a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,u,this._getParentListId(u));r=a.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var t=JSON.parse(e).d,r=[];t.UniquelyPermissionedUsers&&t.UniquelyPermissionedUsers.results&&(r=t.UniquelyPermissionedUsers.results);var i=[];t.InvitedUsers&&t.InvitedUsers.results&&(i=t.InvitedUsers.results);var s={};s.statusCode=t.StatusCode;s.errorMessage=t.ErrorMessage;s.people=o.parsePeople(r);s.invitedUsers=o.parsePeople(i);s.itemId=n.items[0]&&n.items[0].id;i.length>0&&(s.invitationLink=i[0].InvitationLink);s.invalidEmails=[];if(t.UsersWithInvalidEmails&&t.UsersWithInvalidEmails.results)for(var u=0,a=t.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];s.invalidEmails.push(f.User)}return s},"Share",function(){for(var r=[],o=0;o<e.length;o++){var u=e[o];r.push(u.rawPersonData)}n.roleValue===2..toString()?n.roleValue=t.EDIT_ROLE:n.roleValue===1..toString()&&(n.roleValue=t.VIEW_ROLE);var a={peoplePickerInput:JSON.stringify(r),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};s||(a.url=i._sharingDataSourceHelper.getFileUrl(n.items[0]));return JSON.stringify(a)})};o.prototype.updatePermissions2=function(e,t,n){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case u.SharingRoleV3.none:case u.SharingRoleV3.view:case u.SharingRoleV3.review:case u.SharingRoleV3.edit:case u.SharingRoleV3.owner:t=n;break;default:t=u.SharingRoleV3.view}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})};o.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return s},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case u.SharingRoleV3.none:t=0;break;case u.SharingRoleV3.view:t=1;break;case u.SharingRoleV3.review:t=6;break;case u.SharingRoleV3.edit:t=2;break;default:t=1}var s={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(s)})};o.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0)};o.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})};o.prototype.shareLink=function(e){var t=e.settings,n=e.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(n)).segment("ShareLink").toString();return this.getData(function(){return i},function(e){var t=JSON.parse(e);return t.d?y(t):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLink",function(){var n=null;t.expiration&&(n=r.convertDateToISOString(t.expiration.toString()));var i=null;if(e.recipients&&e.recipients.length>0){i=[];for(var s=0,o=e.recipients;s<o.length;s++){var u=o[s];u.rawPersonData&&i.push(u.rawPersonData)}}var a=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){a=[];for(var f=0,l=t.inviteesToRemove;f<l.length;f++){var c=l[f];a.push({id:c.id,loginName:c.loginName,name:c.primaryText,isExternal:c.isExternal,principalType:c.type,email:c.email})}}var h={request:{createLink:!!t.createLink,settings:{allowAnonymousAccess:t.allowAnonymousAccess,trackLinkUsers:t.trackLinkUsers,linkKind:t.sharingLinkKind,expiration:n,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId,description:t.description,scope:t.scope}}};a&&(h.request.settings.inviteesToRemove={results:a});if(i&&i.length>0){h.request.peoplePickerInput=JSON.stringify(i);var p=e.emailData,d=e.emailSubject;void 0!==p&&void 0===d&&(h.request.emailData={body:e.emailData,subject:""});void 0===p&&void 0!==d&&(h.request.emailData={body:"",subject:e.emailSubject});void 0!==p&&void 0!==d&&(h.request.emailData={body:e.emailData,subject:e.emailSubject})}var v=e.settings.shareId;if(v){h.request.settings.shareId=v;h.request.emailData={body:""}}return JSON.stringify(h)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};o.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})};o.prototype.shareLinkExpress=function(e,t,n){var r=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?b(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};o.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(v.isCommSite(this._pageContext))return u.ClientId.sharePoint;switch(e){case c.default.teamSite:case c.default.group:case c.default.subgroup:case c.default.sitePagePublishing:return u.ClientId.sharePoint;case c.default.mySite:return u.ClientId.odb;default:return d.Killswitch.isActivated("49c1f4de-c1fb-47ed-8d4b-695083cb10ef","11/08/2019","Default clientId to SharePoint if unknown for other web templates")?u.ClientId.unknown:u.ClientId.sharePoint}};o.prototype._shareLink=function(e,t){var n=this,i=t.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,i,this._getParentListId(i)).segment("ShareLink").toString();return this.getData(function(){return s},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var i=[],s=0,o=e;s<o.length;s++){var u=o[s];i.push(u.rawPersonData)}var a=null;t.expiration&&(a=r.convertDateToISOString(t.expiration));var f={request:{peoplePickerInput:JSON.stringify(i),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:a}};return JSON.stringify(f)})};o.prototype._getSharingLinkKind=function(e,t){var n=1;6===e?n=5:5===e?n=4:9===e&&(n=t===2..toString()?3:2);return n};o.prototype._parseGetSharingInformationResponse=function(e,n){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0};var r=e.d,i=!!r.permissionsInformation,s=!!r.sharingLinkTemplates,o=p.default.isFeatureEnabled(t.HasInheritedLinksUI)&&i,a=!!r.addressBarLinkSettings,l=i?this._parseSharingLinks(r.permissionsInformation.links.results,r.directUrl):[],c=s?this._parseSharingLinkTemplates(r.sharingLinkTemplates.templates.results):[],h=a?r.addressBarLinkSettings:null,v=[];if(d.Killswitch.isActivated("4681ee55-dadc-4d9b-a53c-30012907318a","5/5/2020","Mark site admins amongst sharing principals")){var m=i?r.permissionsInformation.siteAdmins.results.concat(r.permissionsInformation.principals.results):[];v=this._parseSharingPrincipals(m)}else if(i){var g=r.permissionsInformation.siteAdmins.results,y=r.permissionsInformation.principals.results,b=this._parseSharingPrincipals(g);b.forEach(function(e){return e.isSiteAdmin=!0});var w=this._parseSharingPrincipals(y);v=b.concat(w)}var E=this._getDefaultSharingLink(r.defaultLinkKind,l,r.sharingAbilities),S={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:r.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(n){var x=n.properties,T=x.ItemChildCount?parseInt(x.ItemChildCount,10):0,N=x.FolderChildCount?parseInt(x.FolderChildCount,10):0,C=n.type===f.default.OneNote?0:T+N,k=this._isPolicyTipFlagSet(n.policyTip,4);S={name:n.name,childCount:C,hasDlpPolicy:k,extension:n.extension,appmap:n.appMap,itemType:n.type}}var L=r.canRequestAccessForGrantAccess||r.canAddInternalPrincipal||l.length>1;return{anonymousLinkExpirationRestrictionDays:0===r.anonymousLinkExpirationRestrictionDays?-1:r.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:r.anyoneLinkTrackUsers,canAddExternalPrincipal:r.canAddExternalPrincipal,canAddInternalPrincipal:r.canAddInternalPrincipal,defaultShareLinkToExistingAccess:r.defaultShareLinkToExistingAccess,canManagePermissions:L,defaultSharingLink:E,fileExtension:r.fileExtension,sharedObjectType:r.sharedObjectType,hasInheritedLinks:!!o&&r.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(l,v),item:S,sharingLinks:l,sharingPrincipals:v,peoplePickerSettings:r.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:r.blockPeoplePickerAndSharing,requiresAccessApproval:!r.canAddInternalPrincipal&&r.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:r.canRequestAccessForGrantAccess,userRole:r.currentRole,defaultShareLinkPermission:r.defaultShareLinkPermission,sharingAbilities:r.sharingAbilities,defaultLinkKind:r.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:u.SharingAudience.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:r.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!r.permissionsInformation,sharingLinkTemplates:c,addressBarLinkSettings:h,webTemplateId:r.webTemplateId,itemUniqueId:r.itemUniqueId,customizedExternalSharingServiceUrl:r.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:r.siteIBSegmentIDs?r.siteIBSegmentIDs.results:null,enforceIBSegmentFiltering:!!r.enforceIBSegmentFiltering}};o.prototype._computeIsShared=function(e,t){for(var n=!1,r=0,i=e;r<i.length;r++){var s=i[r];s.isActive&&1!==s.sharingLinkKind&&(n=!0)}n||(n=t.length>0);return n};o.prototype._parseSharingLinks=function(e,t){var n=this,r=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,r=e.linkDetails;t=m&&void 0!==r.Scope&&-1!==r.Scope?E(r.LinkKind,r.Scope):w(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership);return{allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,description:r.Description,audience:t,expiration:r.Expiration?new Date(r.Expiration):null,isActive:r.IsActive,isEdit:S(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:n._parseSharingPrincipals(e.linkMembers.results,r.LinkKind),invitees:n._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy),isCreateOnlyLink:r.IsCreateOnlyLink,isAddressBarLink:r.IsAddressBarLink,isUnhealthy:r.IsUnhealthy,status:r.SharingLinkStatus,created:r.Created,trackLinkUsers:r.TrackLinkUsers}});(r=r.sort(function(e,t){return n._getLinkRanking(t)-n._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:u.SharingAudience.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null});return r};o.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case u.SharingAudience.anyone:t+=30;break;case u.SharingAudience.organization:t+=20;break;case u.SharingAudience.specificPeopleFlex:t+=10}e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1);return t};o.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case 0:t+=30;break;case 1:t+=20;break;case 2:t+=10}switch(e.role){case u.SharingRoleV3.edit:t+=3;break;case u.SharingRoleV3.review:t+=2;break;case u.SharingRoleV3.view:t+=1}}return t};o.prototype._parseSharingLinkTemplates=function(e){var t=this,n=e.map(function(e){var n,r=e.linkDetails;if(null!==r){var i=void 0;i=m&&void 0!==r.Scope&&-1!==r.Scope?E(r.LinkKind,r.Scope):w(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership);n={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:S(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:t._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:t._parseSharingPrincipal(r.PasswordLastModifiedBy)}}return{linkDetails:n,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}});return n=n.sort(function(e,n){return t._getSharingLinkTemplateRanking(n)-t._getSharingLinkTemplateRanking(e)})};o.prototype._parseLinkInvitees=function(e){var t=e.Invitations;if(!t)return[];for(var n=[],r=0,i=t.results;r<i.length;r++){var s=i[r];s&&s.invitee&&n.push(s.invitee)}return n.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:h.getUserPhotoUrl(t.email)}})};o.prototype._parseSharingPrincipals=function(e,t){var n=e.map(function(e){var n=e.principal;n||(n=e);var r={id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:h.getUserPhotoUrl(n.email),email:n.email};t&&(r.sharingLinkKind=t);return r});return l.default.getUniqueSharingPrincipals(n)};o.prototype._getExtraData=function(){var e;this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:u.Mode[this._sharingContextInformation.mode]});return e};o.prototype._parseSharingPrincipal=function(e){if(e){var t=e.principal;t||(t=e);return{id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:h.getUserPhotoUrl(t.email),email:t.email}}return null};o.prototype._getDefaultSharingLink=function(e,t,n){(n.peopleSharingLinkAbilities.canManageEditLink.enabled||n.peopleSharingLinkAbilities.canManageReadLink.enabled)&&1===e&&(e=6);var r=e;if(m&&n.anyoneLinkAbilities){5!==r||n.anyoneLinkAbilities.canManageEditLink.enabled||(r=4);4!==r||n.anyoneLinkAbilities.canManageReadLink.enabled||(r=3)}else{5!==r||n.anonymousLinkAbilities.canManageEditLink.enabled||(r=4);4!==r||n.anonymousLinkAbilities.canManageReadLink.enabled||(r=3)}3!==r||n.organizationLinkAbilities.canManageEditLink.enabled||(r=2);2!==r||n.organizationLinkAbilities.canManageReadLink.enabled||(r=1);var i=void 0;5===e||4===e?i=u.SharingAudience.anyone:3===e||2===e?i=u.SharingAudience.organization:1===e?i=u.SharingAudience.specificPeople:6===e&&(i=u.SharingAudience.specificPeopleFlex);return{allowsAnonymousAccess:void 0,audience:i,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}};o.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};return o})(o.default);t.SharingDataSource=g;function y(e){if(e.d){return b(e.d.ShareLink.sharingLinkInfo)}}t.parseSharingLinkInfo=y;function b(e){var t;t=m&&void 0!==e.Scope&&-1!==e.Scope?E(e.LinkKind,e.Scope):w(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:S(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function w(e,t,n){return 5===e||4===e?u.SharingAudience.anyone:3===e||2===e?u.SharingAudience.organization:1===e?u.SharingAudience.specificPeople:6===e?t?u.SharingAudience.anyone:!1===n?u.SharingAudience.organization:u.SharingAudience.specificPeopleFlex:void 0}function E(e,t){return 5===e||4===e?u.SharingAudience.anyone:3===e||2===e?u.SharingAudience.organization:1===e?u.SharingAudience.specificPeople:6===e?0==t?u.SharingAudience.anyone:1===t?u.SharingAudience.organization:u.SharingAudience.specificPeopleFlex:void 0}function S(e){return 5===e||3===e||4!==e&&2!==e&&null}});
define("sP",["require","exports","Yy","k","Le"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._sharingContextInformation=e.sharingContextInformation}e.prototype.getApiRoot=function(e,t,r){if(this._sharingContextInformation){var i=this._sharingContextInformation,s=i.isFolder,o=i.isListSharing,u=i.itemUrl,a=i.listId,f=i.listItemId,l=i.listUrl,c=i.resourceId,h=i.serverRelativeItemUrl,p=i.uniqueId,d=i.webAbsoluteUrl;if(!this.isListSharingKillswitchActive()&&o)return e.build().webByUrl({webUrl:d}).method("Lists",a);if(p){if(a)return e.build().webByUrl({webUrl:d}).segment("lists").method("getbyid",a).method("GetItemByUniqueId",p);var v=s?"GetFolderById":"GetFileById",m={guid:p};return e.build().webByUrl({webUrl:d}).method(v,m).segment("ListItemAllFields")}return l?e.build().webByUrl({listUrl:l}).method("GetListItem",h):u?e.build().webByUrl({webUrl:d}).method("GetFileByUrl",this._encodingFixEnabled()?u:n.canonicalizeUrl(u)).segment("ListItemAllFields"):a&&f?e.build().webByUrl({webUrl:d}).method("Lists",a).method("GetItemById",f):e.build().webByUrl({webUrl:d}).method("GetListItemByResourceId",c)}var g;g=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var y=e.build().webByItemUrl(g).method("Lists",r);this.isListSharingKillswitchActive()?y=t.properties.ID?y.method("GetItemById",t.properties.ID):y.method("GetItemByUniqueId",t.properties.uniqueId):t.isRootFolder||(y=t.properties.ID?y.method("GetItemById",t.properties.ID):y.method("GetItemByUniqueId",t.properties.uniqueId));return y};e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(this.isListSharingKillswitchActive()?!!t.ID||!!t.uniqueId:e.isRootFolder?!!e.list&&!!e.list.id:!!t.ID||!!t.uniqueId)};e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){if(t.has(e.loginName))return!1;t.add(e.loginName);return!0})}};e.prototype.isListSharingKillswitchActive=function(){return r.Killswitch.isActivated("0d6f4387-b53c-48b9-aab6-66369291541d","03/27/2020","List sharing changes in odsp-datasources")};e.prototype._encodingFixEnabled=function(){return i.default.isFeatureEnabled({ODB:1331})};return e})();t.default=s});
define("ese",["require","exports","ww","lj","y9","A","Be","tse"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SiteReadOnlyState=u.SiteReadOnlyState;var a="SiteDataSource",f=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{dataSourceName:a,id:a+"("+(t?t.siteId:"")+")"},{pageContext:t})||this;r.getOAuthToken=n;return r}t.prototype.getReadOnlyState=function(){var e=this,t=this.getFullSiteReadOnlyState();return-2===t?this.getDataUtilizingPersistentCache({getUrl:function(){return i.getSafeWebServerRelativeUrl(e._pageContext)+"/_api/Site/ReadOnly"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.ReadOnly},qosName:"SiteReadOnly",method:"GET",noRedirect:!0}):s.default.resolve(-1!==t)};t.prototype.getFullSiteReadOnlyState=function(){return void 0===this._pageContext.readOnlyState?-2:null===this._pageContext.readOnlyState?-1:this._pageContext.readOnlyState};t.prototype.getStatusBarInfo=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return i.getSafeWebServerRelativeUrl(e._pageContext)+"/_api/Site?$select=StatusBarLink,StatusBarText"},parseResponse:function(e){var t=JSON.parse(e);if(!t||!t.d)return{StatusBarText:void 0,StatusBarLinkText:void 0,StatusBarLinkTarget:void 0};var n=t.d.StatusBarLink,r=void 0,i=void 0;if(n){var s=n.split("|");r=s[0];var u=1===s.length?s[0]:s[1];if(0===u.lastIndexOf("http",0)){var a=new o.default(u);i=encodeURI(a.toString())}}return{StatusBarText:t.d.StatusBarText,StatusBarLinkText:r,StatusBarLinkTarget:i}},qosName:"SiteStatusBar",method:"GET",noRedirect:!0})};t.prototype.setClassificationProperty=function(e){var t=i.getSafeWebServerRelativeUrl(this._pageContext)+"/_api/Site",n=JSON.stringify({__metadata:{type:"SP.Site"},Classification:e});return this.dataRequestor.getData({url:t,qosName:"SetClassificationProperty",additionalPostData:n,method:"PATCH"})};t.prototype.setClassificationPropertyAndId=function(e,t){var n=i.getSafeWebServerRelativeUrl(this._pageContext)+"/_api/Site",r=JSON.stringify({__metadata:{type:"SP.Site"},Classification:e,SensitivityLabelId:t});return this.dataRequestor.getData({url:n,qosName:"SetClassificationProperty",additionalPostData:r,method:"PATCH"})};t.prototype.getCanSyncHubSitePermissionsProperty=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return i.getSafeWebServerRelativeUrl(t._pageContext)+"/_api/Site/CanSyncHubSitePermissions"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.CanSyncHubSitePermissions},qosName:"GetCanSyncHubSitePermissionsProperty",method:"GET",cachingStrategy:e?3:0,noRedirect:!0})};t.prototype.setCanSyncHubSitePermissionsProperty=function(e){var t=i.getSafeWebServerRelativeUrl(this._pageContext)+"/_api/Site",n=JSON.stringify({__metadata:{type:"SP.Site"},CanSyncHubSitePermissions:e});return this.dataRequestor.getData({url:t,qosName:"SetCanSyncHubSitePermissionsProperty",additionalPostData:n,method:"PATCH",noRedirect:!0})};t.prototype.isSiteFeatureEnabled=function(e,t){var n=this,r=t||i.getSafeWebServerRelativeUrl(this._pageContext),s=r+"/_api/site/Features/GetById('"+e.toString()+"')";return this.getOAuthToken(r).then(function(e){return n.dataRequestor.getData({url:s,qosName:"GetSPSiteFeatureEnabled",method:"GET",authToken:null!=e?e:void 0,parseResponse:function(e){try{var t=JSON.parse(e);if(t&&t.d&&t.d.DefinitionId)return!0}catch(e){return!1}return!1}})})};return t})(r.default);t.SiteDataSource=f;t.default=f});
define("tse",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.unknown=-2]="unknown";e[e.notReadOnly=-1]="notReadOnly";e[e.readOnly=0]="readOnly";e[e.siteMoveInProgress=1]="siteMoveInProgress";e[e.siteMoveComplete=2]="siteMoveComplete"})(t.SiteReadOnlyState||(t.SiteReadOnlyState={}))});
define("QO",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUITE_NAV_LINK_IDS={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",SITE_DESIGNS:"SuiteMenu_MenuItem_SiteDesigns",SITE_TEMPLATES:"SuiteMenu_MenuItem_SiteTemplates",HUB_SETTINGS:"SuiteMenu_MenuItem_HubSettings",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LANGUAGE:"SuiteMenu_Language",CHANGE_THE_LOOK:"Change_The_Look",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",LEGAL:"ShellLegal",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile",LISTS:"Lists",SHAREPOINT:"Sharepoint"};t.SuiteNavLinkIds=t.SUITE_NAV_LINK_IDS});
define("qN",["require","exports","ww","y9","ey","QN","ze","q3","XO","k","JO","cP","zi","uv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d="SuiteNavDataSource",v=(function(t){n.__extends(c,t);function c(e,n){var r=t.call(this,{dataSourceName:d},n)||this;r._suiteNavContext=e.suiteNavContext;r._suiteNavDataUpdater=e.suiteNavDataUpdater;r._suiteNavDataSourceBasic=e.suiteNavDataSourceBasic?e.suiteNavDataSourceBasic:new l.SuiteNavDataSourceBasic(e,n);return r}c.prototype.getCapabilities=function(){return this._suiteNavDataSourceBasic.getCapabilities()};c.prototype.getReactShellBootstrapperUrl=function(){return this._suiteNavDataSourceBasic.getReactShellBootstrapperUrl()};c.prototype.getInitialRenderNavBarData=function(){return this._suiteNavDataSourceBasic.getInitialRenderNavBarData()};c.prototype.getCacheToken=function(){return this._suiteNavDataSourceBasic.getCacheToken()};c.prototype.getUserIdentifier=function(){return this._suiteNavDataSourceBasic.getUserIdentifier()};c.prototype.getWebTemplateType=function(){var e;return Number((null===(e=this._pageContext)||void 0===e?void 0:e.webTemplate)||p.default.invalid)};c.prototype.setFeedbackMetadata=function(t,n){var r=this._suiteNavContext.feedbackOptions;if(r&&r.appId){t=t||{contentLanguage:void 0,source:"OneShell",options:{telemetryGroup:{}}};var i=u.default.isFeatureEnabled({ODB:a.isOneDrive?-1246:1246,ODC:null,Fallback:!1}),s=t.options;s.appId=r.appId;s.disableIncludeScreenshot=!i;s.userVoiceEnabled=r.userVoiceEnabled;s.userVoiceLink=r.userVoiceLink;if(!f.Killswitch.isActivated("A12253B9-7F27-4C11-BFC9-3E7688B5CE1E","9/14/20","Ensure appData in feedback options")){s.applicationGroup||(s.applicationGroup={});s.applicationGroup.appData||(s.applicationGroup.appData="{}")}var o=s.telemetryGroup;o.audienceGroup=this._getAudienceGroup();o.featureArea=this._getFeatureArea();o.processSessionId=this._pageContext.CorrelationId;i&&n&&new Promise(function(t,n){e(["html2canvas"],t,n)}).then(function(e){(e.default||e)(document.body).then(function(e){n(e.toDataURL("image/jpeg"))})})}return t};c.prototype.loadData=function(e){var t=this;if(!e&&this._dataPromise)return this._dataPromise;var n,i=o.default.escapeUrlForCallback(this._pageContext.currentUICultureName),s=r.getSafeWebServerRelativeUrl(this._pageContext),u=s?o.default.escapeUrlForCallback(s):"",a=u+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale="+i+"&v=2&msajax=1&cv=2",f=u+"/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale="+i,c=function(e){return t.getData(function(){return e},function(e){return JSON.parse(e)},"LoadData",null,"POST",null,null,1).then(function(n){var r=e===a?n:JSON.parse(n.d.GetSuiteNavData),i={suiteNavData:r.NavBarData,suiteNavContext:t._suiteNavContext,pageContext:t._pageContext},s=t._suiteNavDataUpdater?t._suiteNavDataUpdater.updateSuiteNavData(i):r.NavBarData,o=!(!s.HasTenantBranding||!r.TenantPrimaryColorShades&&!s.TenantLogoUrl);s.AppBrandTheme=l.getAppBrandTheme(t._suiteNavContext);return{data:s,jsUrl:r.JsUrl,cssUrl:r.CssUrl,hasCobranding:o,userIdentifier:t.getUserIdentifier(),cacheToken:t.getCacheToken()}})};n=this._pageContext.isSPO?c(a).catch(function(){return c(f)}):c(f);this._dataPromise=n;n.catch(function(){t._dataPromise=null});return n};c.prototype.onCssLoad=function(e){if(e.data&&e.data.ClientData)try{var t=JSON.parse(e.data.ClientData);t&&t.IsFallbackShell&&s.loadFallbackShellThemableCss()}catch(e){}};c.prototype.updateDataForCurrentPage=function(e){var t={suiteNavData:e,suiteNavContext:this._suiteNavContext,pageContext:this._pageContext};return this._suiteNavDataUpdater.updateSuiteNavData(t)};c.prototype._getAudienceGroup=function(){var e,t=this._pageContext;"prodbubble"===t.env&&"MSIT_SPDF_1_Content"===t.farmLabel?e="Dogfood":"prodbubble"===t.env?e="Microsoft":"prod"!==t.env&&"dprod"!==t.env||(e="Production");return e};c.prototype._getFeatureArea=function(){var e=this._pageContext;return e.listBaseTemplate===h.ListTemplateType.genericList?"List":e.listBaseTemplate===h.ListTemplateType.documentLibrary?"Libraries":e.listBaseTemplate===h.ListTemplateType.webPageLibrary?"Modern Pages and News Authoring (Floodgate)":"Site"};c.siteSettingsPermissions=[i.PermissionMask.enumeratePermissions,i.PermissionMask.manageWeb,i.PermissionMask.manageSubwebs,i.PermissionMask.addAndCustomizePages,i.PermissionMask.applyThemeAndBorder,i.PermissionMask.manageAlerts,i.PermissionMask.manageLists,i.PermissionMask.viewUsageData];return c})(c.DataSource);t.SuiteNavDataSource=v;t.default=v});
define("JO",["require","exports","ze","q3","Be","Ee","XO"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){this._pageContext=t.pageContext;this._usePPEHost="true"===this._getUrlQueryParam("usePPE");this._suiteNavContext=e.suiteNavContext;this._capabilities=e.suiteNavCapabilities?e.suiteNavCapabilities:{supportsCaching:!0,supportsRealSuiteNav:!0,showO365Text:!0,disableSecondaryUserPhotoProvider:!1,collapseO365Settings:!1,enableDelayLoading:!1}}e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.getReactShellBootstrapperUrl=function(){return this._usePPEHost?"https://shellppe.msocdn.com/api/shellbootstrapper/business/oneshell":"https://shellprod.msocdn.com/api/shellbootstrapper/business/oneshell"};e.prototype.getInitialRenderNavBarData=function(){return{WorkloadId:this._suiteNavContext.workloadId,CurrentMainLinkElementID:this._suiteNavContext.currentMainLinkElementID,UserID:this._parseUserID(this._pageContext.systemUserKey),UserDisplayName:this._pageContext.isSPO&&this._pageContext.isAnonymousGuestUser?void 0:this._pageContext.userDisplayName,ShellBootHost:this._usePPEHost?"https://shellppe.msocdn.com":"https://shellprod.msocdn.com",IsConsumer:!!this._suiteNavContext.isConsumer,Culture:n.default.escapeUrlForCallback(this._pageContext.currentUICultureName),IsRtl:s.default.isRightToLeft,AppBrandTheme:a(this._suiteNavContext),Language:this._pageContext.currentLanguage.toString()}};e.prototype.getCacheToken=function(){var e=this._pageContext.siteClientTag;return"string"==typeof e?e.substring(0,e.indexOf("$$")):""};e.prototype.getUserIdentifier=function(){return this._pageContext.systemUserKey};e.prototype._getUrlQueryParam=function(e){try{return new i.default(window.location.href).getQueryParameter(e)}catch(e){}};e.prototype._parseUserID=function(e){if(e){var t=e.lastIndexOf("|");return e.substring(t+1,e.indexOf("@",t))}return""};return e})();t.SuiteNavDataSourceBasic=u;function a(e){var t={Primary:r.default.isFeatureEnabled({ODB:o.isOneDrive?-1546:1546,ODC:null,Fallback:!1})?"#03787c":"#0078D4"};return e.appBrandTheme?e.appBrandTheme:t}t.getAppBrandTheme=a;t.default=u});
define("hB",["require","exports","y9","uv","t2","A","gB","Tw","bB","k","q3","XO"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=l.default.isFeatureEnabled({ODB:c.isOneDrive?-1546:1546,ODC:null,Fallback:!1})?"#03787c":"#0078d4",p=(function(){function e(e){this._pageContext=e;this._dataRequestor=new i.DataRequestor({qosName:"WebThemeDataSource"},{pageContext:e})}e.prototype.getCacheToken=function(){var e="",t=this._pageContext;if(t){var n=Number(t.webTemplate),i=n!==r.default.mySite&&n!==r.default.mySiteHost?t.groupColor:h;e=t.themedCssFolderUrl||i}return e};e.prototype.loadTheme=function(e){if(!e&&this._dataPromise)return this._dataPromise;if(!this.getCacheToken())return this._dataPromise=s.default.resolve();this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme();return this._dataPromise};e.prototype.needsRequestDigest=function(e){return!1};e.prototype.loadGeneratedTheme=function(){var e=this._pageContext.groupColor||h,t=u.default.fromHtmlColor(e);if(t){var n={backgroundImageUri:null,cacheToken:e,isDefault:!1,isInverted:!1,palette:o.default.generateFabricColors(t),version:"1"};return s.default.resolve(n)}return s.default.resolve()};e.prototype.loadServerTheme=function(){var e=this,t=n.getSafeWebServerRelativeUrl(this._pageContext),r=this._pageContext.currentUICultureName,i=this._pageContext.themedCssFolderUrl,s=!f.Killswitch.isActivated("D18277F9-2D5C-488B-98F2-90403DE467E7","02/26/2020","Specify theme folder override")&&this.getCacheToken()===i&&i||void 0,o=a.default.makeWebThemeRestUrl(t,r,s),u=this._dataRequestor.getData({url:o,parseResponse:function(t){e._data=a.default.processWebThemeRestResponse(t);return e._data},qosName:"WebThemeDataSource.LoadData",method:"GET"});u.done(null,function(){e._dataPromise=null});return u};return e})();t.default=p});
define("ait",["require","exports","ww","A","k","lj","Ge","We"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.odbFirstRun="sharePointOneDriveBusinessFirstRun";e.filtersPaneFirstRun="sharePointFiltersPaneFirstRun";e.teamsTeachingBubble="sharePointTeamsTeachingBubble";e.librariesFirstRun="sharePointLibrariesFirstRun";e.listsFirstRun="sharePointListsFirstRun";e.modernDocSetsFirstRun="sharePointModernDocSetsFirstRun"})(t.UserInfoFlag||(t.UserInfoFlag={}));var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{dataSourceName:"UserInfo",id:"UserInfo"},n)||this,i=r._pageContext,s=n.itemUrlHelper||new o.ItemUrlHelper({},{pageContext:i});r.apiUrlHelper=n.apiUrlHelper||new u.ApiUrlHelper({},{pageContext:i,itemUrlHelper:s});r._additionalHeaders={"X-ClientType":"SharePointFirstRunUserFlag"};return r}t.prototype.getUserFlagValue=function(e){var t=this;if(i.Killswitch.isActivated("AC6676C2-EA2E-4FFE-AAEA-E36483FB5552","03/29/2020","Disable Firstrun check"))return r.default.resolve(!0);if(!this._pageContext.userLoginName&&!this._pageContext.aadUserId)return r.default.resolve(!0);if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return r.default.resolve(!0);var s={url:this._getApiUrl()+"&$select="+e,qosName:"GetUserFlag",method:"GET",cacheRequestKey:e};return this.getDataUtilizingLegacyCache(n.__assign({onlyCache:!0,useStale:!0},s)).then(function(r){return r||t.getDataUtilizingLegacyCache(n.__assign(n.__assign({},s),{additionalHeaders:n.__assign({},t._additionalHeaders),parseResponse:function(t){var n=JSON.parse(t);if(n&&n.d&&void 0!==n.d[e])return!!n.d[e];throw new Error("Response did not contain flag: "+e)}}))}).catch(function(){return null})};t.prototype.setUserFlagValue=function(e,t){var r;return this.getDataUtilizingLegacyCache({url:this._getApiUrl(),qosName:"SetUserFlag",additionalPostData:JSON.stringify((r={},r[e]=t,r)),method:"POST",additionalHeaders:n.__assign({"X-HTTP-Method":"PATCH",Accept:"application/json; odata=minimalmetadata"},this._additionalHeaders),contentType:"application/json; odata=minimalmetadata",cacheRequestKey:e,bypassCache:!0,parseResponse:function(){return t}})};t.prototype._getApiUrl=function(){return this.apiUrlHelper.build().segment("SP.Directory.DirectorySession").methodWithAliases("User",this._pageContext.aadUserId?{id:this._pageContext.aadUserId}:{principalName:this._pageContext.userLoginName}).toString()};return t})(s.CachedDataSource);t.UserInfoDataSource=a;t.default=a});
define("uv",["require","exports","ww","fv","fv"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("y9",["require","exports","S9"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NoWarning=0]="NoWarning";e[e.Warning=1]="Warning";e[e.OverQuota=2]="OverQuota"})(t.SiteResourceQuotaState||(t.SiteResourceQuotaState={}));(function(e){e[e.Default=0]="Default";e[e.AllPages=1]="AllPages";e[e.ModernOnly=2]="ModernOnly";e[e.Hidden=3]="Hidden"})(t.SearchBoxInNavBarType||(t.SearchBoxInNavBarType={}));(function(e){e[e.None=0]="None";e[e.PrivateChannel=1]="PrivateChannel";e[e.SharedChannel=2]="SharedChannel";e[e.StandardChannel=3]="StandardChannel"})(t.TeamsChannelType||(t.TeamsChannelType={}));(function(e){e[e.Default=0]="Default";e[e.Tenant=1]="Tenant";e[e.Hub=2]="Hub";e[e.Site=3]="Site"})(t.SearchScopeType||(t.SearchScopeType={}));(function(e){e[e.FooterEnabled=2]="FooterEnabled";e[e.MegaMenuEnabled=128]="MegaMenuEnabled";e[e.FooterEmphasis0=256]="FooterEmphasis0";e[e.FooterEmphasis1=512]="FooterEmphasis1";e[e.FooterLayout0=1024]="FooterLayout0";e[e.FooterLayout1=2048]="FooterLayout1";e[e.HideTitleInHeader=33554432]="HideTitleInHeader"})(t.SPWebPropertyFlags2||(t.SPWebPropertyFlags2={}));t.DEFAULT_LOGO_URL="_layouts/15/images/siteicon.png";t.getServerUrl=function(e){var t=e.webAbsoluteUrl,n=e.webServerRelativeUrl;return"/"===n||""===n?t:t.substring(0,t.lastIndexOf(n))};t.getSafeWebServerRelativeUrl=function(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl};t.isGroupWebContext=function(e){return e&&!!e.groupId&&e.webAbsoluteUrl===e.siteAbsoluteUrl};function r(e){return e&&e.webAbsoluteUrl===e.siteAbsoluteUrl}t.isRootWebContext=r;t.isTeamsRootWebContext=function(e){return e&&r(e)&&e.groupId&&e.isTeamsConnectedSite&&!e.isTeamsChannelSite};t.isModernTemplate=function(e){return-1!==["STS#3","GROUP#0","SITEPAGEPUBLISHING#0","TEAMSCHANNEL#0","TEAMSCHANNEL#1"].indexOf(e.webTemplateConfiguration)};t.isHomePlusHubWithExtendedHeader=function(e){return!(e.headerLayout!==n.UnifiedHeaderLayout.extended||!i(e))};function i(e){return!(!s(e)||!e.isHubSite)}t.isHomePlusHub=i;function s(e){return!!(e.companyPortalReference&&e.companyPortalReference.SiteId&&e.siteId&&e.siteId.indexOf(e.companyPortalReference.SiteId)>=0)}t.isHomeSite=s;t.isAnonymousOrGuest=function(e){return!!(e.isAnonymousGuestUser||e.isExternalGuestUser||e.isEmailAuthenticationGuestUser||e.isNativeFederatedUser)}});
define("J9",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this._features=new Map;if(!e)throw new Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(var t in e)if(void 0!==t){var n=e[t];this._features.set(t,{version:n.Version,enabled:n.Enabled})}}e.prototype._serialize=function(){var e={};this._features.forEach(function(t,n){e[n]={Version:t.version,Enabled:t.enabled}});return e};e.prototype.get=function(e){if(!e||e&&0===e.length)throw new Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(e)};return e})();t.default=n});
define("wx",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.download=0]="download";e[e.open=1]="open";e[e.textContent=2]="textContent";e[e.viewInBrowser=3]="viewInBrowser";e[e.bingClickInstrumentation=4]="bingClickInstrumentation";e[e.original=5]="original";e[e.shortcutTarget=6]="shortcutTarget";e[e.video=7]="video";e[e.downloadAsZip=8]="downloadAsZip";e[e.itemUrl=9]="itemUrl";e[e.mediaBaseUrl=10]="mediaBaseUrl"})(n=t.UrlType||(t.UrlType={}));t.default=n});
define("yS",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.Text=0]="Text";e[e.Hyperlink=1]="Hyperlink";e[e.Image=2]="Image";e[e.User=3]="User";e[e.Boolean=4]="Boolean";e[e.DateTime=5]="DateTime";e[e.Currency=6]="Currency";e[e.Counter=7]="Counter";e[e.Number=8]="Number";e[e.Note=9]="Note";e[e.Computed=10]="Computed";e[e.Name=11]="Name";e[e.FileSize=12]="FileSize";e[e.Shared=13]="Shared";e[e.SharedWith=14]="SharedWith";e[e.FileIcon=15]="FileIcon";e[e.DotDotDot=16]="DotDotDot";e[e.Tag=17]="Tag";e[e.Lookup=18]="Lookup";e[e.Taxonomy=19]="Taxonomy";e[e.Hashtag=20]="Hashtag";e[e.Attachments=21]="Attachments";e[e.AverageRating=22]="AverageRating";e[e.Title=23]="Title";e[e.WorkflowStatus=24]="WorkflowStatus";e[e.ProgressBar=25]="ProgressBar";e[e.RatedBy=26]="RatedBy";e[e.Ratings=27]="Ratings";e[e.LikedBy=28]="LikedBy";e[e.Likes=29]="Likes";e[e.ComplianceRecordFlag=30]="ComplianceRecordFlag";e[e.Custom=31]="Custom";e[e.Activity=32]="Activity";e[e.Choice=33]="Choice";e[e.ClientSideCustom=34]="ClientSideCustom";e[e.FileActivity=35]="FileActivity";e[e.MruName=36]="MruName";e[e.ShareCommand=37]="ShareCommand";e[e.PinCommand=38]="PinCommand";e[e.Thumbnail=39]="Thumbnail";e[e.ImageSize=40]="ImageSize";e[e.Location=41]="Location";e[e.Geolocation=42]="Geolocation"})(n=t.ColumnFieldType||(t.ColumnFieldType={}));t.default=n});
define("CP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NONE=0]="NONE";e[e.VIEW=1]="VIEW";e[e.EDIT=2]="EDIT";e[e.OWNER=3]="OWNER";e[e.REVIEW=6]="REVIEW"})(t.UpdatePermissionsRole||(t.UpdatePermissionsRole={}))});
define("dP",["require","exports","CP","xP","IP","DP","SP","yP","vP","gP","bP","hP","_P","mP","pP","fP","uP","lP"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UpdatePermissionsRole=n.UpdatePermissionsRole;t.SharingLinkKind=r.SharingLinkKind;t.SharingLinkType=i.SharingLinkType;t.SharingInfoType=s.SharingInfoType;t.SharingRole=o.SharingRole;t.AccessStatus=u.AccessStatus;t.ClientId=a.default;t.Error=f.default;t.Category=f.Category;t.Mode=l.default;t.SharePermission=c.default;t.SharingAudience=h.default;t.SharingAudienceTemplates=p.SharingAudienceTemplates;t.SharingRoleV3=d.SharingRoleV3;t.SharingLinkExpressOptions=v.SharingLinkExpressOptions;t.SharingLinkStatus=m.SharingLinkStatus;t.SharingScope=g.SharingScope});
define("yP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.none=1]="none";e[e.pending=2]="pending";e[e.hasAccess=3]="hasAccess"})(t.AccessStatus||(t.AccessStatus={}))});
define("vP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos";e[e.onenote=25]="onenote";e[e.teamsIos=26]="teamsIos";e[e.teamsAndroid=27]="teamsAndroid";e[e.onenoteIos=28]="onenoteIos";e[e.visioIos=29]="visioIos";e[e.onenoteAndroid=30]="onenoteAndroid";e[e.visioAndroid=31]="visioAndroid";e[e.outlookWindows=32]="outlookWindows";e[e.outlookMac=33]="outlookMac";e[e.onenoteUWP=34]="onenoteUWP";e[e.officemobileIos=35]="officemobileIos";e[e.officemobileAndroid=36]="officemobileAndroid";e[e.odcWac=37]="odcWac";e[e.outlookGroupsWeb=38]="outlookGroupsWeb";e[e.fluid=39]="fluid";e[e.modernFileExplorer=40]="modernFileExplorer";e[e.listsHome=41]="listsHome";e[e.listsIos=42]="listsIos";e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp";e[e.officeFeed=44]="officeFeed";e[e.searchUx=45]="searchUx"})(n||(n={}));var r=void 0;t.getClientId=function(e){if(void 0===r){r={};for(var t in n){var i=parseInt(t);if(!isNaN(i)){var s=n[i].toLowerCase();r[s]=i}}}var o=e?e.toLowerCase():"";return r[o]||n.unknown};t.default=n});
define("gP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.authFailure=1]="authFailure";e[e.serverFailure=2]="serverFailure";e[e.invalidItem=3]="invalidItem";e[e.invalidWebAbsoluteUrl=4]="invalidWebAbsoluteUrl";e[e.generic=5]="generic";e[e.objectNotSupported=6]="objectNotSupported";e[e.invalidEmail=7]="invalidEmail";e[e.linkNoLongerAvailable=8]="linkNoLongerAvailable"})(n||(n={}));(function(e){e[e.generic=0]="generic";e[e.getSharingInformation=1]="getSharingInformation";e[e.shareLink=2]="shareLink";e[e.shareObject=3]="shareObject";e[e.permissions=4]="permissions";e[e.item=5]="item";e[e.me=6]="me";e[e.drive=7]="drive";e[e.invite=8]="invite"})(t.Category||(t.Category={}));t.default=n});
define("bP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"})(n||(n={}));t.default=n});
define("hP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.view=1]="view";e[e.edit=2]="edit";e[e.restrictedView=7]="restrictedView"})(n||(n={}));t.default=n});
define("_P",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex";e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"})(n||(n={}));t.default=n});
define("mP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.anyone=0]="anyone";e[e.organization=1]="organization";e[e.specificPeople=2]="specificPeople"})(t.SharingAudienceTemplates||(t.SharingAudienceTemplates={}))});
define("DP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Email=0]="Email";e[e.User=1]="User";e[e.Group=2]="Group";e[e.Link=3]="Link";e[e.Public=4]="Public";e[e.Friends=5]="Friends";e[e.Facebook=6]="Facebook";e[e.Application=7]="Application";e[e.GroupOwned=99]="GroupOwned"})(t.SharingInfoType||(t.SharingInfoType={}))});
define("fP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.uninitialized=0]="uninitialized";e[e.AddressBarLink=1]="AddressBarLink"})(t.SharingLinkExpressOptions||(t.SharingLinkExpressOptions={}))});
define("xP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.uninitialized=0]="uninitialized";e[e.direct=1]="direct";e[e.organizationView=2]="organizationView";e[e.organizationEdit=3]="organizationEdit";e[e.anonymousView=4]="anonymousView";e[e.anonymousEdit=5]="anonymousEdit";e[e.flexible=6]="flexible"})(t.SharingLinkKind||(t.SharingLinkKind={}))});
define("uP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.uninitialized=0]="uninitialized";e[e.created=1]="created";e[e.updated=2]="updated"})(t.SharingLinkStatus||(t.SharingLinkStatus={}))});
define("IP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Network=1]="Network";e[e.Embed=3]="Embed";e[e.App=4]="App";e[e.View=5]="View";e[e.Edit=6]="Edit";e[e.Form=7]="Form";e[e.Direct=8]="Direct";e[e.Organization=9]="Organization";e[e.AppAccess=10]="AppAccess"})(t.SharingLinkType||(t.SharingLinkType={}))});
define("SP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Owner=0]="Owner";e[e.View=1]="View";e[e.Edit=2]="Edit";e[e.Submitter=3]="Submitter";e[e.CoOwner=4]="CoOwner";e[e.None=5]="None";e[e.Review=6]="Review";e[e.Custom=7]="Custom"})(t.SharingRole||(t.SharingRole={}))});
define("pP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.none=0]="none";e[e.view=1]="view";e[e.edit=2]="edit";e[e.owner=3]="owner";e[e.review=6]="review";e[e.restrictedview=7]="restrictedview";e[e.submit=8]="submit"})(t.SharingRoleV3||(t.SharingRoleV3={}))});
define("lP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.uninitialized=-1]="uninitialized";e[e.anyone=0]="anyone";e[e.organization=1]="organization";e[e.specificPeople=2]="specificPeople"})(t.SharingScope||(t.SharingScope={}))});
define("LS",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.filters=0]="filters";e[e.sorts=1]="sorts";e[e.groupBy=2]="groupBy";e[e.fieldNames=3]="fieldNames";e[e.rowLimit=4]="rowLimit";e[e.columnWidth=5]="columnWidth";e[e.customFormatter=6]="customFormatter";e[e.newDocumentTemplates=7]="newDocumentTemplates";e[e.aggregations=8]="aggregations";e[e.viewType=9]="viewType";e[e.gridLayout=10]="gridLayout"})(t.ArrangeInfoType||(t.ArrangeInfoType={}))});
define("S9",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.HEADER=0]="HEADER";e[e.NAV=1]="NAV";e[e.FOOTER=2]="FOOTER";e[e.SEARCHBOX=3]="SEARCHBOX"})(t.ChromeControlType||(t.ChromeControlType={}));(function(e){e[e.LEFT=0]="LEFT";e[e.HORIZONTAL=1]="HORIZONTAL"})(t.NavPlacementType||(t.NavPlacementType={}));(function(e){e[e.FULLBLEED=0]="FULLBLEED";e[e.WITHLEFTNAV=1]="WITHLEFTNAV"})(t.HeaderLayoutType||(t.HeaderLayoutType={}));(function(e){e[e.none=0]="none";e[e.standard=1]="standard";e[e.compact=2]="compact";e[e.minimal=3]="minimal";e[e.extended=4]="extended"})(t.UnifiedHeaderLayout||(t.UnifiedHeaderLayout={}));(function(e){e[e.left=0]="left";e[e.middle=1]="middle";e[e.right=2]="right"})(t.LogoAlignment||(t.LogoAlignment={}));(function(e){e[e.SIMPLE=0]="SIMPLE";e[e.EXTENDED=1]="EXTENDED";e[e.STACKED=2]="STACKED"})(t.FooterLayout||(t.FooterLayout={}));(function(e){e[e.Strong=0]="Strong";e[e.Neutral=1]="Neutral";e[e.Soft=2]="Soft";e[e.None=3]="None"})(t.FooterEmphasis||(t.FooterEmphasis={}))});
define("pH",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FiltersPaneEvents={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged"};(function(e){e[e.user=0]="user";e[e.date=1]="date";e[e.fileType=2]="fileType";e[e.choice=3]="choice";e[e.hierarchy=4]="hierarchy"})(t.FilterSectionType||(t.FilterSectionType={}));(function(e){e[e.none=0]="none";e[e.last3Months=1]="last3Months";e[e.last30Days=2]="last30Days";e[e.last7Days=3]="last7Days";e[e.yesterday=4]="yesterday";e[e.today=5]="today";e[e.tomorrow=6]="tomorrow";e[e.next7Days=7]="next7Days";e[e.next30Days=8]="next30Days";e[e.next3Months=9]="next3Months";e[e.nextYear=10]="nextYear"})(t.DateTimeSliderValue||(t.DateTimeSliderValue={}))});
define("CS",["require","exports","ww","LS","M","xe","Ce","Ae","W","Oe","OS","k"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h,p,d=function(){var e=new(0,window.XMLSerializer);d=function(){return e};return e};(function(e){e[e.standard=1]="standard";e[e.datasheet=2048]="datasheet";e[e.calendar=524288]="calendar";e[e.recurrence=8193]="recurrence";e[e.chart=131072]="chart";e[e.gantt=67108864]="gantt";e[e.power=134217728]="power"})(h||(h={}));(function(e){e.tiles="TILES";e.compactList="COMPACTLIST";e.modernCalendar="MODERNCALENDAR";e.gridFixed="GRIDFIXED"})(p||(p={}));var v=(function(){function e(t){if("string"!=typeof t){var n=t;this.id=i.default.normalizeLower(n.Id,!1);this.title=n.Title;this.isDefault=n.DefaultView;this.isHidden=n.Hidden;this.isPersonal=!!n.PersonalView;this.isReadOnly=n.ReadOnlyView;this.modifiedInEditor=n.EditorModified;this.rowLimit=n.RowLimit;this.scope=n.Scope||0;this.serverRelativeUrl=n.ServerRelativeUrl;this.baseViewId=n.BaseViewId;this.baseViewXml=n.ListViewXml;this.customFormatter=n.CustomFormatter;this.viewData=n.ViewData;var r=n.TabularView,s=void 0===r||r;this.tabularView=s;if(e.isAppView(n)){this.isHidden=!1;this.viewType="POWER";this.visualizationInfo=n.VisualizationInfo}else if(n.ViewType)switch(n.ViewType.toLowerCase()){case"html":this.viewType="HTML";break;case"grid":this.viewType="GRID";break;case"calendar":this.viewType="CALENDAR";break;case"recurrence":this.viewType="RECURRENCE";break;case"chart":this.viewType="CHART";break;case"gantt":this.viewType="GANTT"}this._ensureDom();if(this._viewDom&&this._viewDom.viewType2){if("HTML"===this.viewType)switch(this._viewDom.viewType2.textContent.toLowerCase()){case"tiles":this.viewType="TILES";break;case"compactlist":this.viewType="COMPACTLIST";break;case"moderncalendar":this.viewType="MODERNCALENDAR";break;default:this.viewType="HTML"}if("GRID"===this.viewType)switch(this._viewDom.viewType2.textContent.toLowerCase()){case"gridfixed":this.viewType="GRIDFIXED";break;default:this.viewType="GRID"}}else 1===this.getEffectiveGridLayout()&&(this.viewType="GRIDFIXED")}else this.baseViewXml=t}e.isAppView=function(e){return!!(e&&e.Hidden&&e.VisualizationInfo&&2===e.VisualizationInfo.VisualizationType&&e.VisualizationInfo.VisualizationAppInfo&&e.VisualizationInfo.VisualizationAppInfo.Id)};e.prototype.canUserEdit=function(e){if(!e||this.isReadOnly)return!1;var t=e.managePersonalViews&&this.isPersonal;return e.manageLists||t};Object.defineProperty(e.prototype,"baseViewXml",{get:function(){return this._baseViewXml},set:function(e){this._baseViewXml=e;this.clearXmlOverrides()},enumerable:!0,configurable:!0});e.prototype.getEffectiveViewXml=function(){var e=d();return this.isDirty()&&this._viewDom?e.serializeToString(this._viewDom.view):this._baseViewXml};e.prototype.getEffectiveQueryXml=function(e){this._ensureDom();var t=d();if(this._viewDom){return this._viewDom.query?e?t.serializeToString(this._viewDom.query):(this._viewDom.where?t.serializeToString(this._viewDom.where):"")+(this._viewDom.orderBy?t.serializeToString(this._viewDom.orderBy):"")+(this._viewDom.groupBy?t.serializeToString(this._viewDom.groupBy):""):e?"<Query/>":""}};e.prototype.updateColumnWidths=function(e){this._ensureDom();var t=this._viewDom.view.getElementsByTagName("ColumnWidth"),n=t.length>0;this._viewDom.columnWidth=n?t[0]:this._xmlDoc.createElement(s.CamlTags.columnWidth);var i=c.Killswitch.isActivated("3D1A1888-230D-4B7B-B35B-40AB14EC5F11","10/19/2020","Column width query selector");for(var o in e){var a=e[o],f=i?"[Name="+o+"]":"[Name='"+o+"']",l=this._viewDom.columnWidth.querySelector(f);if(l)l.setAttribute(s.CamlAttributes.width,a);else{var h=u.getFieldRefDom(this._xmlDoc,{fieldName:o});h.setAttribute(s.CamlAttributes.width,a);this._viewDom.columnWidth.appendChild(h)}}n?this._viewDom.view.replaceChild(this._viewDom.columnWidth,t[0]):this._viewDom.view.appendChild(this._viewDom.columnWidth);this.setIsDirty(!0,r.ArrangeInfoType.columnWidth)};e.prototype.updateColumnAggregateType=function(e,t){this._ensureDom();if(this._viewDom){var n=this._viewDom.aggregations,i=this._viewDom.view,o=!1;if(n){n.setAttribute(s.CamlAttributes.value,"On");var u=n.querySelector("["+s.CamlAttributes.name+"="+e+"]");if(u){if(t)u.setAttribute(s.CamlAttributes.type,t);else{n.removeChild(u);if(0===n.childElementCount){this._viewDom.view.removeChild(n);this._viewDom.aggregations=void 0}}o=!0}else if(t){(a=this._xmlDoc.createElement(s.CamlTags.fieldRef)).setAttribute(s.CamlAttributes.name,e);a.setAttribute(s.CamlAttributes.type,t);n.appendChild(a);o=!0}}else if(t){(n=this._xmlDoc.createElement(s.CamlTags.aggregations)).setAttribute(s.CamlAttributes.value,"On");var a;(a=this._xmlDoc.createElement(s.CamlTags.fieldRef)).setAttribute(s.CamlAttributes.name,e);a.setAttribute(s.CamlAttributes.type,t);n.appendChild(a);this._viewDom.aggregations=n;i.appendChild(n);o=!0}o&&this.setIsDirty(!0,r.ArrangeInfoType.aggregations)}};e.prototype.updateViewType=function(e){this._ensureDom();if(this._viewDom){var t=void 0,n=void 0;switch(e){case"HTML":t=1;break;case"GRID":t=2048;break;case"CALENDAR":t=524288;break;case"RECURRENCE":t=8193;break;case"CHART":t=131072;break;case"GANTT":t=67108864;break;case"TILES":t=1;n="TILES";break;case"COMPACTLIST":t=1;n="COMPACTLIST";break;case"MODERNCALENDAR":t=1;n="MODERNCALENDAR";break;case"GRIDFIXED":t=2048;n="GRIDFIXED"}var i=this._viewDom.view,o=this._getViewTypeString(t);i.setAttribute("Type",o);if(this._viewDom.viewType2){this._viewDom.view.removeChild(this._viewDom.viewType2);this._viewDom.viewType2=void 0}if(n){var u=this._viewDom.view.getElementsByTagName(s.CamlTags.viewType2),a=u.length>0;this._viewDom.viewType2=a?u[0]:this._xmlDoc.createElement(s.CamlTags.viewType2);this._viewDom.viewType2.textContent=n;this._viewDom.view.appendChild(this._viewDom.viewType2)}if(2048===t&&this._viewDom.gridLayout){this._viewDom.view.removeChild(this._viewDom.gridLayout);this._viewDom.gridLayout=void 0}this.viewType=e;this.setIsDirty(!0,r.ArrangeInfoType.viewType)}};e.prototype.updateGridLayout=function(e){this._ensureDom();if(this._viewDom&&!isNaN(e)){var t=this._viewDom.view.getElementsByTagName(s.CamlTags.gridLayout),n=t&&t.length;n||(this._viewDom.gridLayout=this._xmlDoc.createElement(s.CamlTags.gridLayout));this._viewDom.gridLayout.setAttribute("Type",e.toString());n?this._viewDom.view.replaceChild(this._viewDom.gridLayout,t[0]):this._viewDom.view.appendChild(this._viewDom.gridLayout);this.setIsDirty(!0,r.ArrangeInfoType.gridLayout)}};e.prototype.replaceAggregates=function(e){this._ensureDom();if(this._viewDom){if(this._viewDom.aggregations){this._viewDom.view.removeChild(this._viewDom.aggregations);this._viewDom.aggregations=void 0}var t=this._viewDom.aggregations;if(e){var n=e[s.CamlAttributes.name],i=e[s.CamlAttributes.type];if(n&&i&&n.length===i.length)for(var o=0;o<n.length;o++){t||(t=this._xmlDoc.createElement(s.CamlTags.aggregations)).setAttribute(s.CamlAttributes.value,"On");var u=this._xmlDoc.createElement(s.CamlTags.fieldRef);u.setAttribute(s.CamlAttributes.name,n[o]);u.setAttribute(s.CamlAttributes.type,i[o]);t.appendChild(u)}}if(t){this._viewDom.aggregations=t;this._viewDom.view.appendChild(t)}this.setIsDirty(!0,r.ArrangeInfoType.aggregations)}};e.prototype.updateCustomFormatter=function(e){this._ensureDom();var t=this._viewDom.view.getElementsByTagName("CustomFormatter"),n=t.length>0;this._viewDom.customFormatter=n?t[0]:this._xmlDoc.createElement(s.CamlTags.customFormatter);if(c.Killswitch.isActivated("622E8315-E06C-4D51-93FC-8DDA27AD3C56","10/17/2018","KillSwitchUseCDATAForViewFormatter"))this._viewDom.customFormatter.textContent=e;else{this._viewDom.customFormatter.textContent="";e&&this._viewDom.customFormatter.appendChild(this._xmlDoc.createCDATASection(e))}n?this._viewDom.view.replaceChild(this._viewDom.customFormatter,t[0]):this._viewDom.view.appendChild(this._viewDom.customFormatter);this.setIsDirty(!0,r.ArrangeInfoType.customFormatter)};e.prototype.updateNewDocumentTemplates=function(e){this._ensureDom();var t=this._viewDom.view.getElementsByTagName(s.CamlTags.newDocumentTemplates),n=t.length>0;this._viewDom.newDocumentTemplates=n?t[0]:this._xmlDoc.createElement(s.CamlTags.newDocumentTemplates);this._viewDom.newDocumentTemplates.textContent=e;n?this._viewDom.view.replaceChild(this._viewDom.newDocumentTemplates,t[0]):this._viewDom.view.appendChild(this._viewDom.newDocumentTemplates);this.setIsDirty(!0,r.ArrangeInfoType.newDocumentTemplates)};e.prototype.getEffectiveGridLayout=function(){this._ensureDom();var e=this._viewDom&&this._viewDom.gridLayout&&u.getAttr(this._viewDom.gridLayout,s.CamlAttributes.type),t=parseInt(e);return t||void 0};e.prototype.getEffectiveFieldNames=function(){this._ensureDom();return this._viewDom&&this._viewDom.viewFields?o.parseViewFields(this._viewDom.viewFields):void 0};e.prototype.getEffectiveAggregatesData=function(){this._ensureDom();return this._viewDom&&this._viewDom.aggregations?o.parseAggregations(this._viewDom.aggregations):void 0};e.prototype.getEffectiveAggregatesFieldXml=function(){this._ensureDom();return this._viewDom&&this._viewDom.aggregations?o.parseAggregationsToGetEffectiveAggregatesFieldsXml(this._viewDom.aggregations):void 0};e.prototype.isDirty=function(e){return"number"==typeof e?!!this._modificationTypes&&-1!==this._modificationTypes.indexOf(e):this._isDirty};e.prototype.setIsDirty=function(e,t){this._isDirty=e;e?"number"==typeof t&&-1===this._modificationTypes.indexOf(t)&&this._modificationTypes.push(t):this._modificationTypes=[]};e.prototype.hasParseError=function(){return this._hasParseError};e.prototype.getDomParts=function(){this._ensureDom();return this._viewDom};e.prototype.clearXmlOverrides=function(){this._hasParseError=!1;this._xmlDoc=void 0;this._viewDom=void 0;this.setIsDirty(!1)};e.prototype.prepareForSaving=function(){this._ensureDom();if(this._viewDom&&this._viewDom.where)for(var e=this._viewDom.where.querySelectorAll("[id]"),t=0;t<e.length;t++){e[t].removeAttribute("id");this._isDirty||(this._isDirty=!0)}};e.prototype.updateSort=function(e,t){void 0===t&&(t={});this._ensureDom();var n=t.removeSort,i=t.overwriteAll,o=t.prepend,a=!e&&i;if(this._viewDom&&(a||e)&&(!n||this._viewDom.orderBy)){var l=this._viewDom.orderBy;if(a){l&&this._viewDom.query.removeChild(l);this._viewDom.orderBy=void 0;this.setIsDirty(!0,r.ArrangeInfoType.sorts)}else{var c=!1;if(!l&&!a){l=this._viewDom.orderBy=this._xmlDoc.createElement(s.CamlTags.orderBy);this._viewDom.query.appendChild(l);c=!0}var h=l.querySelector(f.format(s.CamlConstants.fieldNameQuery,e.fieldName));if(n){if(h){l.removeChild(h);c=!0;if(!l.childElementCount){this._viewDom.query.removeChild(l);this._viewDom.orderBy=void 0}}}else{c=!0;h&&u.updateBooleanAttr(h,s.CamlAttributes.ascending,e.isAscending);var p=void 0;if(i){for(var d=l.lastChild;d;d=l.lastChild)l.removeChild(d);p=!0}else p=!h;if(p){h=h||u.getFieldRefDom(this._xmlDoc,e);o?l.insertBefore(h,l.firstChild):l.appendChild(h)}}c&&this.setIsDirty(!0,r.ArrangeInfoType.sorts)}}};e.prototype.updateGroupBy=function(e){this._ensureDom();if(this._viewDom){var t=this._viewDom.query,n=this._viewDom.groupBy;if(e&&e.group1&&e.group1.fieldName){var i,o,a=e.isCollapsed,f=e.group1,l=e.group2;if(!n){this._viewDom.groupBy=n=this._xmlDoc.createElement(s.CamlTags.groupBy);t.appendChild(n)}u.updateBooleanAttr(n,s.CamlAttributes.collapse,a);n.childElementCount>0&&(o=(i=n.firstElementChild).nextElementSibling);u.replaceField(this._xmlDoc,f,i,n);l&&l.fieldName&&l.fieldName!==f.fieldName?u.replaceField(this._xmlDoc,l,o,n):o&&n.removeChild(o);this.setIsDirty(!0,r.ArrangeInfoType.groupBy)}else if(n){t.removeChild(n);this._viewDom.groupBy=void 0;this.setIsDirty(!0,r.ArrangeInfoType.groupBy)}}};e.prototype.updateGroupByCollapseAttribute=function(e){this._ensureDom();if(this._viewDom){var t=this._viewDom.groupBy;t&&u.updateBooleanAttr(t,s.CamlAttributes.collapse,e);this.setIsDirty(!0,r.ArrangeInfoType.groupBy)}};e.prototype.updateField=function(e,t){this._ensureDom();if(this._viewDom&&e){var n=!1,i=this._viewDom.viewFields,o=i.querySelector(f.format(s.CamlConstants.fieldNameQuery,e));if(o){n=!0;i.removeChild(o)}if("number"==typeof t){n=!0;o||(o=u.getFieldRefDom(this._xmlDoc,{fieldName:e}));t>=i.childElementCount?i.appendChild(o):t>=0&&l.default.insertAtIndex(i,o,t,s.CamlTags.fieldRef)}n&&this.setIsDirty(!0,r.ArrangeInfoType.fieldNames)}};e.prototype.replaceFields=function(e,t){this._ensureDom();if(this._viewDom&&e&&(e=e.filter(function(e){return!!e})).length){for(var n={},i=0;i<e.length;i++){n[e[i]]?n[e[i]].indexes.push(i):n[e[i]]={indexes:[i]};t&&"boolean"==typeof t[i]&&(n[e[i]].lookupId=t[i])}for(var o=this._viewDom.viewFields,a=o.firstElementChild;a;a=a.nextElementSibling){var f=u.getAttr(a,s.CamlAttributes.name);n[f]&&(n[f].elem=a)}var l=this._viewDom.viewFields=this._xmlDoc.createElement(s.CamlTags.viewFields);this._viewDom.view.replaceChild(l,o);for(var c=[],h=function(e){var t=n[e],r=t.elem;r||(r=u.getFieldRefDom(p._xmlDoc,{fieldName:e,lookupId:t.lookupId}));t.indexes.forEach(function(e,t){c[e]=0===t?r:r.cloneNode(!0)})},p=this,d=0,v=Object.keys(n);d<v.length;d++){h(f=v[d])}for(var m=0,g=c;m<g.length;m++){(a=g[m])&&l.appendChild(a)}this.setIsDirty(!0,r.ArrangeInfoType.fieldNames)}};e.prototype.clearFilters=function(){this._ensureDom();if(this._viewDom.where){this._viewDom.query.removeChild(this._viewDom.where);this._viewDom.where=void 0;this.setIsDirty(!0,r.ArrangeInfoType.filters)}};e.prototype.addFilters=function(e){this._ensureDom();if(this._viewDom&&e&&(e=e.filter(function(e){return!!e})).length){var t,n=u.combineFilters(e,s.CamlTags.and);if(!n)throw new Error("Invalid filter: must be defined and have values");this.setIsDirty(!0,r.ArrangeInfoType.filters);try{t=u.xmlToDom(n).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}var i=this._viewDom.where;if(!i){i=this._viewDom.where=this._xmlDoc.createElement(s.CamlTags.where);this._viewDom.query.appendChild(i)}if(i.childElementCount){var o=i.firstElementChild,a=this._xmlDoc.createElement(s.CamlTags.and);a.appendChild(o);a.appendChild(t);i.appendChild(a)}else i.appendChild(t)}};e.prototype.updateRowLimit=function(e){this._ensureDom();if(this._viewDom&&e&&"number"==typeof e.rowLimit){this.rowLimit=e.rowLimit;var t=this._viewDom.rowLimit;if(!t){this._viewDom.rowLimit=t=this._xmlDoc.createElement(s.CamlTags.rowLimit);this._viewDom.view.appendChild(t)}if(t.firstChild)t.firstChild.nodeValue=String(e.rowLimit);else{var n=this._xmlDoc.createTextNode(String(e.rowLimit));t.appendChild(n)}"boolean"==typeof e.isPerPage&&u.updateBooleanAttr(t,s.CamlAttributes.paged,e.isPerPage);this.setIsDirty(!0,r.ArrangeInfoType.rowLimit)}};e.prototype.updateAll=function(e){var t=e.fieldNames,n=e.groupBy,r=e.sorts,i=e.filters;t&&t.length&&this.replaceFields(t);n&&this.updateGroupBy(n);if(r&&r.length){this.updateSort(r[0],{overwriteAll:!0});for(var s=0,o=r.slice(1);s<o.length;s++){var u=o[s];this.updateSort(u)}}if(i&&i.length&&"string"==typeof i[0]){this.clearFilters();this.addFilters(i)}};e.prototype.compareTo=function(e){if(!e)return 1;if("POWER"===this.viewType&&"POWER"!==e.viewType)return 1;if("POWER"!==this.viewType&&"POWER"===e.viewType)return-1;var t=(this.title||"").toLocaleLowerCase(),n=(e.title||"").toLocaleLowerCase();return t===n?0:t<n?-1:1};e.prototype.clone=function(){var t;if(this.isDirty()){(t=new e(this.getEffectiveViewXml()))._ensureDom();t.setIsDirty(!0);t._modificationTypes=n.__spreadArrays(this._modificationTypes);t._baseViewXml=this.baseViewXml}else t=new e(this.baseViewXml);this._cloneViewProperties(t);return t};e.prototype.setDom=function(e){e&&this._parseXmlStringToEnsureDom(e)};e.prototype._cloneViewProperties=function(e){e.id=this.id;e.title=this.title;e.isDefault=this.isDefault;e.isHidden=this.isHidden;e.isPersonal=this.isPersonal;e.isReadOnly=this.isReadOnly;e.modifiedInEditor=this.modifiedInEditor;e.rowLimit=this.rowLimit;e.scope=this.scope;e.serverRelativeUrl=this.serverRelativeUrl;e.baseViewId=this.baseViewId;e.customFormatter=this.customFormatter;e.tabularView=this.tabularView;e.viewType=this.viewType;e.visualizationInfo=this.visualizationInfo};e.prototype._ensureDom=function(){if(this._baseViewXml&&!this._viewDom){this._isDirty=!1;this._hasParseError=!1;this._parseXmlStringToEnsureDom(this._baseViewXml)}};e.prototype._parseXmlStringToEnsureDom=function(e){var t=new a.Qos({name:"View.Parse"});try{this._viewDom=o.getViewDomParts(e);this._xmlDoc=this._viewDom.xmlDoc;t.end({resultType:a.ResultTypeEnum.Success})}catch(e){this._viewDom=void 0;this._xmlDoc=void 0;this._hasParseError=!0;t.end({resultType:a.ResultTypeEnum.Failure,error:e.message||JSON.stringify(e)})}};e.prototype._getViewTypeString=function(e){switch(e){case 1:return"HTML";case 2048:return"GRID";case 524288:return"CALENDAR";case 8193:return"RECURRENCE";case 131072:return"CHART";case 67108864:return"GANTT";default:return"HTML"}};return e})();t.default=v});
define("J9e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.needsAttentionViewId="f9ebc8b2-a976-48f0-a8fa-0846164c0466"});
define("wie",["require","exports","A","W","Die"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.InteractionRequired=10013]="InteractionRequired"})(t.TokenFetchServerErrorCodes||(t.TokenFetchServerErrorCodes={}));var i=(function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var i=new r.Qos({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){i.end({resultType:r.ResultTypeEnum.Success});return e},function(e){i.end({resultType:r.ResultTypeEnum.Failure});return n.default.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var i=new r.Qos({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){i.end({resultType:r.ResultTypeEnum.Success});return e},function(e){i.end({resultType:r.ResultTypeEnum.Failure});return n.default.reject(e)})};return e})();t.default=i});
define("ry",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.GetLoadPromise=function(){return window.o365ShellLoadPromise};e.GetRenderPromise=function(){return window.o365ShellRenderPromise};e.GetPostRenderPromise=function(){return window.o365ShellPostRenderPromise};return e})();t.O365ShellPromises=n});
define("$O",["require","exports","C","ry"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){var e=this;this._PostRenderSignal=new n.default;r.O365ShellPromises.GetLoadPromise()&&r.O365ShellPromises.GetLoadPromise().then(function(){e._signalAction(function(){})});r.O365ShellPromises.GetRenderPromise()&&r.O365ShellPromises.GetRenderPromise().then(function(){e._signalAction(function(){})});r.O365ShellPromises.GetPostRenderPromise()&&r.O365ShellPromises.GetPostRenderPromise().then(function(){e._signalAction(function(){})})}Object.defineProperty(e.prototype,"FlexPane",{get:function(){return O365Shell.FlexPane},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Header",{get:function(){return O365Shell.Header},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Navigation",{get:function(){return O365Shell.Navigation},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Settings",{get:function(){return O365Shell.Settings},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Theme",{get:function(){return O365Shell.Theme},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Search",{get:function(){return O365Shell.Search},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"NFD",{get:function(){return O365Shell.NFD},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Extensibility",{get:function(){return O365Shell.Extensibility},enumerable:!0,configurable:!0});e.prototype.SetData=function(e){O365Shell.SetData(e)};e.prototype.Render=function(e,t){var n=this;O365Shell.Render(e,function(){return n._signalAction(t)})};e.prototype.RenderAsync=function(e,t,n){var r=this;O365Shell.RenderAsync(e,function(){return r._signalAction(t)},function(){return r._signalAction(n)})};e.prototype.GetResourceLoader=function(){return O365Shell.GetResourceLoader()};e.prototype.OnDataChanged=function(e){return O365Shell.OnDataChanged(e)};e.prototype.OnSuiteAPILoaded=function(e){return O365Shell.OnSuiteAPILoaded(e)};e.prototype.LoadShellPlus=function(){O365Shell.LoadShellPlus()};e.prototype.Exists=function(){return"undefined"!=typeof O365Shell};e.prototype.HasMember=function(e){return this.Exists()&&!!O365Shell[e]};e.prototype.OnHasMember=function(e,t){var n=this;this.HasMember(e)?t():this._PostRenderSignal.getPromise().done(function(){return n.OnHasMember(e,t)})};e.prototype._signalAction=function(e){e();var t=this._PostRenderSignal;this._PostRenderSignal=new n.default;t.complete()};return e})();t.O365ShellWrapper=i});
define("ZO",["require","exports","A","C","q3","k","_e","K3","G3","ew","$O","P2","ry"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(){function e(t,n){this._cachePrefix="odSuiteNav";this._cacheDataKey="Data";this._cacheThemeDataKey="ThemeData";this._cacheDateKey="CacheDate";this._cacheVersionKey="CacheVersion";this._cacheSessionKey="CachedThisSession";this._cacheVersion=6;this._cacheExpire=24;this._cacheRenew=12;this._cache=new u.default(this._cachePrefix,a.default.local);this._dataSourceBasic=n.dataSource;this._engagementEvent=t.engagementEvent;this._qosEvents=t.qosEvents;this._capabilities=this._dataSourceBasic.getCapabilities();var r=n.require,i=void 0===r?e.require:r;this._require=i}Object.defineProperty(e.prototype,"suiteNavPlaceholder",{get:function(){return this._suiteNavPlaceholder},set:function(e){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=e)},enumerable:!0,configurable:!0});e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.getO365Shell=function(){var e=this,t=!s.Killswitch.isActivated("a7a53561-b4c1-4409-b23e-f6a209a0b840","06/10/2020","Reject promise instead of throw");if(!this._capabilities.supportsRealSuiteNav){if(t)return n.default.reject(new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true."));throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.")}if(i.default.isFeatureEnabled({ODB:1136})){var o=new l.O365ShellWrapper;return n.default.resolve().then(h.O365ShellPromises.GetLoadPromise).then(function(){return o})}var u=new r.default,a=this._qosEvents&&this._qosEvents[c.SuiteNavQosLabel.GET_O365_SHELL];this._getSuiteNavShellViaBootstrapper(u);u.getPromise().then(function(){e._qosRecordSuccess(a)},function(t){e._qosRecordError(a,t)});return u.getPromise()};e.prototype.getInitialRenderNavBarData=function(){return this._dataSourceBasic.getInitialRenderNavBarData()};e.prototype.getCachedData=function(){var e;if(this._capabilities.supportsCaching&&this._isCacheValid()){var t=this._cache.getValue(this._cacheDataKey);e=t&&t.data}return e};e.prototype.getCachedThemeData=function(){var e;if(this._capabilities.supportsCaching){var t=this._cache.getValue(this._cacheThemeDataKey);t&&t.themeData&&(e=t.themeData)}return e};e.prototype.updateCachedThemeData=function(e){var t={themeData:e,cacheDate:(new Date).toISOString()};this._cache.setValue(this._cacheThemeDataKey,t)};e.prototype._requestShellCore=function(t,n,i){var s=n?t+"?odb_cb="+(new Date).toISOString():t,o=new r.default;this._require(s,"SuiteNavShellCore",function(e){i&&i();var t=new l.O365ShellWrapper;t.Exists()?o.complete(t):o.error(d({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:s}}))},function(t,n){e.removeHeadScriptElement("SuiteNavShellCore");o.error(d({error:n||t.message,resultCode:"LoadScriptError",extraData:{shellUrl:s}}))});return o.getPromise()};e.removeHeadScriptElement=function(e){var t=document.head.querySelector("#"+e);t&&t.parentNode.removeChild(t)};e.prototype._isCacheValid=function(){var e=this._cache.getValue(this._cacheDataKey),t=this._cache.getValue(this._cacheVersionKey),n=Date.parse(this._cache.getValue(this._cacheDateKey)),r=this._capabilities.supportsRealSuiteNav,i=this._dataSourceBasic;return e&&e.data&&(!r||e.jsUrl)&&t===this._cacheVersion&&e.userIdentifier===i.getUserIdentifier()&&e.cacheToken===i.getCacheToken()&&this._isCacheNotExpired(n,this._cacheExpire)};e.prototype._qosRecordSuccess=function(e){e&&e.end({resultType:o.ResultTypeEnum.Success})};e.prototype._qosRecordError=function(e,t){e&&e.end(d({error:t}))};e.prototype._logEngagementData=function(e){this._engagementEvent&&this._engagementEvent.logData(e)};e.prototype._isCacheNotExpired=function(e,t){return!isNaN(e)&&Date.now()-e<60*t*60*1e3};e.prototype._getSuiteNavShellViaBootstrapper=function(e,t){var n=this;this._logEngagementData({name:"SuiteNavProvider.GetO365ShellByBootstrapper"});var r=this._dataSourceBasic.getReactShellBootstrapperUrl();this._requestShellCore(r,t).then(function(t){e.complete(t)},function(t){t=d({error:t});if(n._hasRetriedO365Shell)e.error(t);else{n._logEngagementData({name:"SuiteNavProvider.O365ShellRetry"});n._hasRetriedO365Shell=!0;n._getSuiteNavShellViaBootstrapper(e,!0)}})};e.require=function(t,n,r,i){var s=function(){return void 0!==window.O365Shell};if(s())r&&r(null);else{var o=document.head.querySelector("#"+n);if(o&&o.src===t)try{f.waitFor(s,300,3e4).then(function(){r(null)})}catch(e){i(null,"Unable to load O365Shell")}else{o&&o.src!==t&&e.removeHeadScriptElement(n);var u=document.createElement("script");u.id=n;u.src=t;r&&u.addEventListener("load",function(e){r(e)});i&&u.addEventListener("error",function(e){i(e)});document.head.appendChild(u)}}};return e})();t.SuiteNavProviderBasic=p;function d(e){var t=e.error;if(t&&t.resultCode)return t;var r=o.ResultTypeEnum.Failure;if(n.default.isCanceled(t)){r=o.ResultTypeEnum.ExpectedFailure;e.resultCode="Canceled"}return{resultType:r,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}t.getSuiteNavError=d;t.default=p});
define("P2",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUITE_NAV_QOS_LABEL={GET_O365_SHELL:"SuiteNavProvider.GetO365Shell",SUITE_NAV_PROVIDER_LOAD_DATA:"SuiteNavProvider.LoadData",SUITE_NAV_LOAD:"SuiteNav.Load",SUITE_NAV_RENDER:"SuiteNav.Render",SUITE_NAV_POSTRENDER:"SuiteNav.PostRender",REFRESH_CACHE_FOR_SHELL_DATA_CHANGED:"SuiteNav.RefreshCacheForShellDataChanged",REFRESH_CACHE_AFTER_INVALID_SHELL_DATA:"SuiteNav.RefreshCacheAfterInvalidShellData"};t.SuiteNavQosLabel=t.SUITE_NAV_QOS_LABEL});
define("ew",["require","exports","A","y9","k","fv","J9","ty"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.waitFor=function(e,t,r){var i=0;return new n.default(function(n,s){var o=setInterval(function(){if(!(i*t<=r)){clearInterval(o);throw"Timed out waiting for checker "+e}i++;if(e()){clearInterval(o);n()}},t)})};t.isCommSite=function(e){var t=i.Killswitch.isActivated("fcc930ba-8fe4-4065-b185-8b74488eba20","10/08/2019","SitePagePublishing_FeatureEnabled"),n=i.Killswitch.isActivated("1c067c05-41cd-48a7-bf78-bb398a461041","10/15/2019","Check comm site feature instead of template");if(t||n||!e.featureInfo)return Number(e.webTemplate)===s.default.sitePagePublishing;var r=new o.default(e.featureInfo);if(r){var u=r.get("SitePagePublishing");return!!u&&u.enabled}return!1};t.isAbleToManageGlobalNav=function(e){return!!(r.isHomeSite(e)&&r.isRootWebContext(e)&&u.PermissionMask.hasPermission(e.webPermMasks,u.PermissionMask.manageWeb))}});
define("gH",["require","exports","K","N5"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFolderPath=function(e,t){var r=n.deserializeQuery(e).id;t&&t.urlParts&&(r===t.urlParts.fullListUrl||r===t.urlParts.serverRelativeListUrl)&&(r=void 0);return r};t.buildItemKey=function(e,t){var n=e;0!==n.indexOf("id")&&(n=r.serializeQuery({id:e,listurl:t}));return n}});
define("$S",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.getItemKey=function(e,t){return t&&t.properties&&(e?t.properties.uniqueId:t.properties.ID)||t&&t.key||void 0};e.getWorkflowStatusFromRawHtml=function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector("a"),r=n.querySelector("span[value]");return{url:n.href,display:n.innerText,value:r&&r.getAttribute("value")}}})(n||(n={}));t.default=n});
define("Z7",["require","exports","ze","$7","Ae","k"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FILTER_USE_LOOKUPID_KEY="FilterLookupId";t.FILTER_FIELD_KEY="FilterField";t.FILTER_VALUE_KEY="FilterValue";t.FILTER_TYPE_KEY="FilterType";t.FILTER_OPERATOR_KEY="FilterOp";t.FILTER_DISPLAY_KEY="FilterDisplay";function o(e,t){t=n.default.encodeURIComponent(t);var r=e.match(new RegExp("FilterField([0-9]+)="+t+"&"));Boolean(r)||(r=e.match(new RegExp("FilterFields([0-9]+)="+t+"&")));return r}t.getFilterFieldByName=o;t.getFilterValueByName=function(e,t){t=n.default.encodeURIComponent(t);var r=e.match(new RegExp("FilterField([0-9]+)="+t+"&FilterValue([0-9]+)=([^&]+)"));Boolean(r)||(r=e.match(new RegExp("FilterFields([0-9]+)="+t+"&FilterValues([0-9]+)=([^&]+)")));return r?decodeURIComponent(r[r.length-1]):void 0};function u(e,n){return g(t.FILTER_FIELD_KEY,e,n)}t.getFilterFieldByIndex=u;function a(e,n){return g(t.FILTER_VALUE_KEY,e,n)}t.getFilterValueByIndex=a;function f(e,n){return g(t.FILTER_TYPE_KEY,e,n)}t.getFilterTypeByIndex=f;function l(e,n){return g(t.FILTER_DISPLAY_KEY,e,n)}t.getFilterDisplayByIndex=l;function c(e,n){return g(t.FILTER_USE_LOOKUPID_KEY,e,n)}t.getFilterUseLookupIdByIndex=c;function h(e,n){return g(t.FILTER_OPERATOR_KEY,e,n)}t.getFilterOperatorByIndex=h;t.getFilterParams=function(e,t){var n,r,s,o,p,d,m="",g=0;do{n=u(e,++g);r=a(e,g);s=f(e,g);o=l(e,g);p=c(e,g);d=h(e,g);var y=r&&r.toString(),b=s&&s.toString(),w=o&&o.toString(),E=p&&p.toString(),S=d&&d.toString();if(t&&b&&y){var x=String(b.substr(b.indexOf("=")+1)),T=String(y.substr(y.indexOf("=")+1));if("datetime"===(x&&x.toLowerCase())){var N=v(T,";#",!0);if(N&&N.length&&i.isTodayString(N[0]))continue}}null!==n&&null!==r&&(m+="&"+n.toString()+"&"+y);null!==s&&(m+="&"+b);w&&(m+="&"+w);E&&(m+="&"+E);S&&(m+="&"+S)}while(null!=n);return m};t.isFiltered=function(e){var t=!1;for(var n in e)if(0===n.indexOf("FilterField")){t=!0;break}return t};t.updateFilterInfoInQueryString=function(e,t){var n=t.filterField,r=t.filterValues;e=p(e,{filterField:n,filterValue:"",clearField:!0,filterType:t.filterType,useLookupId:t.useLookupId,filterOperator:t.filterOperator});if(r&&r.length>0){var i=0,s=[];do{s=u(e,++i)}while(Boolean(s));""!==e&&(e+="&");e+=y(i,t)}return e};t.addMultipleFilterInfo=function(e,t,n,r){var i=e,s={};r&&r.forEach(function(e){s[e.Name]=e});t.forEach(function(e,t){var r=s&&s[e];i=r?d(i,e,n[t],!1,r.FieldType):d(i,e,n[t])});return i};function p(e,n){var r=n.filterField,i=n.filterValue,s=n.filterDisplay,p=n.clearField,d=n.filterType,m=n.useLookupId,g=n.overrideExistingFilter,b=void 0===g||g,w=n.filterOperator,E=o(e,r);if(Boolean(E)&&b){var S=parseInt(E[1],10),x=a(e,S),T=f(e,S),N=l(e,S),C=c(e,S),k=h(e,S),L=E[0]+x[0];T&&(L+="&"+T[0]);N&&(L+="&"+N[0]);C&&(L+="&"+C[0]);k&&(L+="&"+k[0]);var A=L,O="";if(Boolean(p))A=new RegExp("(\\?|\\&)"+L);else{var M=String(x[0].substr(x[0].indexOf("=")+1)),_=String(N[0].substr(N[0].indexOf("=")+1)),D=[],P=[],H=!1,B=v(M,";#",!0),j=v(_,";#",!0);B&&(D=B);j&&(P=j);for(var F in B)if(F){if(B[F]===i){H=!0;continue}D.push(B[F]);P.push(j[F])}if(!H){D.push(i);s&&P.push(s)}D.length>0&&(O=y(E[1],{filterField:r,filterValues:D,filterType:d,useLookupId:m,filterOperator:w,filterDisplays:P}))}var I=e.replace(A,O);p&&I===e&&(I=e.replace(L,O));e=(function(e,n){var r=n+1,i=e.match(new RegExp("FilterField"+String(r)+"=[^&]*")),s=!1;if(!Boolean(i)){i=e.match(new RegExp("FilterFields"+String(r)+"=[^&]*"));s=Boolean(i)}for(var o=n;Boolean(i);o++){var a=s?"FilterFields"+String(o):"FilterField"+String(o),f=s?"FilterFields"+String(r):"FilterField"+String(r);e=e.replace(f,a);a=s?"FilterValues"+String(o):"FilterValue"+String(o);f=s?"FilterValues"+String(r):"FilterValue"+String(r);e=e.replace(f,a);a=s?"FilterTypes"+String(o):"FilterType"+String(o);f=s?"FilterTypes"+String(r):"FilterType"+String(r);e=e.replace(f,a);a=t.FILTER_USE_LOOKUPID_KEY+String(o);f=t.FILTER_USE_LOOKUPID_KEY+String(r);e=e.replace(f,a);a=t.FILTER_OPERATOR_KEY+String(o);f=t.FILTER_OPERATOR_KEY+String(r);e=e.replace(f,a);r++;i=u(e,r)}return e})(I,S)}else{var q=0,R=[];do{R=u(e,++q)}while(Boolean(R));if(!Boolean(p)){""!==e&&(e+="&");e+=y(q,{filterField:r,filterValues:[i],filterType:d,useLookupId:m,filterOperator:w,filterDisplays:s?[s]:void 0})}}return e}t.addFilterInfoInQueryString=p;function d(e,t,n,r,i,s){return p(e,{filterField:t,filterValue:n,clearField:r,filterType:i,useLookupId:s})}t.addFilterInfo=d;function v(e,t,n){var r=t.charAt(0),i=new RegExp(r+r,"g");n&&(e=decodeURIComponent(e));var s=e.split(t);return s=s.map(function(e){return e.replace(i,r)})}t.parseMultiColumnValue=v;t.isFieldValueInUrl=function(e,t,n,r){var i=o(e,t);if(Boolean(i)){var s=a(e,parseInt(i[1],10)),u=String(s[0].substr(s[0].indexOf("=")+1)),f=decodeURIComponent(u).split(";#");for(var l in f)if(f[l]===n||r&&f[l]===r)return!0}return!1};t.getText=function(e){return Boolean(e.innerText)?e.innerText.toString():Boolean(e.textContent)?e.textContent.toString():e.innerHTML.toString()};t.getFilterList=function(e,t,n,s,o){var p,d,m,g,y,b,w,E=[],S=0;do{p=u(e,++S);d=a(e,S);m=l(e,S);g=f(e,S);y=c(e,S);w=(b=h(e,S))&&b[0]?String(b[0].substr(b[0].indexOf("=")+1)):"Eq";if(null!==p&&null!==d){var x=String(p[0].substr(p[0].indexOf("=")+1)),T=String(d[0].substr(d[0].indexOf("=")+1)),N=m&&m.length&&String(m[0].substr(m[0].indexOf("=")+1)),C=decodeURIComponent(x),k=g&&g[0]?String(g[0].substr(g[0].indexOf("=")+1)):t?r.getFieldType(C,t):null,L=void 0;y&&y[0]&&"1"===y[0].substr(y[0].indexOf("=")+1)&&(L=!0);var A=v(T,";#",!0).map(function(e){return n?e:e||o}),O=N?v(N,";#",!0).map(function(e){return n?e:e||o}):void 0;if(k){"datetime"===k.toLowerCase()&&A&&A.length&&i.isTodayString(A[0])&&(w="Geq")}E.push({fieldName:C,values:A,displays:O,operator:w,type:k,id:s?C:void 0,lookupId:L})}}while(p);return E};t.formatBreadcrumbFilterValues=function(e,t,n){return e.map(function(e){return"Boolean"===t?"0"===e?n.booleanFalse:"1"===e?n.booleanTrue:e:new RegExp("^\\d*\\.0+$").test(e)?parseFloat(e).toString():e}).join(", ")};function m(e,t){var r=t.charAt(0),i=r+r,o=new RegExp(r,"g");(s.Killswitch.isActivated("763ABAA1-1F9D-4DA2-AAC3-975DD28DC3E3","2/28/2019","Only encode ; if multiple filter values")||e.length>1)&&(e=e.map(function(e){return e.replace(o,i)}));return n.default.encodeURIComponent(e.join(t))}function g(e,t,n){var r=t.match(new RegExp(e+String(n)+"=[^&#]*"));Boolean(r)||(r=t.match(new RegExp(e+"s"+String(n)+"=[^&#]*")));return r}function y(e,r){var i=r.filterField,s=r.filterValues,o=r.filterDisplays,u=r.filterType,a=r.useLookupId,f=r.filterOperator,l="FilterField",c="&FilterValue",h="&FilterType",p="&FilterDisplay";if(s.length>1){l="FilterFields";c="&FilterValues";h="&FilterTypes";p="&FilterDisplays"}var d=m(s,";#"),v=l+e+"="+n.default.encodeURIComponent(i)+c+e+"="+d;o&&(v+=p+e+"="+m(o,";#"));u&&(v+=h+e+"="+u);a&&(v+="&"+t.FILTER_USE_LOOKUPID_KEY+e+"=1");f&&(v+="&"+t.FILTER_OPERATOR_KEY+e+"="+f);return v}});
define("X7",["require","exports","Z7"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n});
define("Oie",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e})();t.default=n});
define("xie",["require","exports","Oie","Cie"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()};window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}e._getCorrelationId=function(e){return e.headers.get("sprequestguid")};e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})};e.prototype.getInstrumentedOAuthToken=function(e,t){var r=this;this._receiveMediaServiceFlushedToken();var i=this._getCachedTokenData(e);if(i&&!this._isExpiring(i)){var s={token:i.accessToken,isGuest:!1,expirationTimeMs:i.expiresOn};return Promise.resolve({tokenInfo:s,spRequestId:i.correlationId,spRequestTimestamp:i.requestTimestamp})}return this._retriableFetchWithDigest(e,n.default.retries,t).then(function(t){r._storeTokenData(e,t);return{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})};e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)};Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});e.prototype._retriableFetchWithDigest=function(t,n,i){var s=this,o=this._context.qosMonitor(),u=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(a){if(200!==a.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+a.statusText);var f=new r.default(r.OAuthUtilityErrorType.unknownError,{httpResponseStatus:a.status,message:a.statusText,correlationId:e._getCorrelationId(a)});if(400!==a.status){o.writeUnexpectedFailure("UnknownError",f);return Promise.reject(f)}return a.json().then(function(r){var u=e._extractRealError(r),a=s._getErrorCodeFromResponseCode(u);if(!s._isRetriableError(a)||0===n){var f=s._buildErrorFromResponse(u);o.writeUnexpectedFailure("SharepointServerError",f);return Promise.reject(f)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(t,n-1,i)})}return s._instrumentedParseResponseData(a,o,u)})};e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};e.prototype._getCacheKey=function(e){var t=["sp-client-shared",n.default.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<n.default.aboutToExpireIntervalSeconds};e.prototype._isRetriableError=function(e){return-1!==n.default.retriableErrorCodes.indexOf(e)};e.prototype._buildTokenRequest=function(e,t){var r=new Headers;r.append("Content-Type","application/json; charset=utf-8");r.append("Odata-Version","4.0");r.append("Accept","application/json;odata.metadata=minimal");var i={method:"POST",headers:r,body:JSON.stringify(this._buildRequestBody(e))},s=t;s&&s.lastIndexOf("/")===s.length-1&&(s=s.substr(0,s.length-1));return new Request(s+n.default.apiUrl,i)};e.prototype._buildRequestBody=function(e){return{resource:e}};e.prototype._buildErrorFromResponse=function(e){var t,i,s=this._getErrorCodeFromResponseCode(e);if(void 0===s)return new r.default(r.OAuthUtilityErrorType.malformedResponseBody,{httpResponseStatus:400,message:n.default.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;i=e.message.lang}return new r.default(r.OAuthUtilityErrorType.serverError,{httpResponseStatus:400,message:t,cultureName:i,serverErrorCode:s,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]})};e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(n=Number(t.substr(0,r)))}return n};e.prototype._instrumentedParseResponseData=function(t,i,s){try{return t.json().then(function(n){i.writeSuccess();return{accessToken:n.access_token,expiresOn:Number(n.expires_on),notBefore:Number(n.not_before),resource:n.resource,tokenType:n.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:s}})}catch(s){i.writeUnexpectedFailure("ResponseParseError",s);return Promise.reject(new r.default(r.OAuthUtilityErrorType.malformedResponseBody,{httpResponseStatus:200,message:n.default.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}};e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var r=n[t];window.sessionStorage.removeItem(r)}};e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e);window._spMSBT=void 0}};return e})();t.default=i});
define("Cie",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;(function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"})(r=t.OAuthUtilityErrorType||(t.OAuthUtilityErrorType={}));var i=(function(e){n.__extends(t,e);function t(n,r){var i=e.call(this,r.message)||this;i.__proto__=t.prototype;i._type=n;i._httpResponseStatus=r.httpResponseStatus;i._cultureName=r.cultureName;i._message=r.message;i._serverErrorCode=r.serverErrorCode;i._correlationId=r.correlationId;i._redirectUrl=r.redirectUrl;return i}Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==r.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return t})(Error);t.default=i});
define("Yy",["require","exports","ww","Jy","Jy"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(i,t);t.getFolderNameFromPath=function(e){var t=e.lastIndexOf("/");return t>=0?e.substring(t+1):e};t.getSharePointPath=function(e){return decodeURI(e)};t.canonicalizeUrl=function(e){var t;try{t=decodeURI(e)}catch(n){t=e}return e=t===e?r.encodePath(e,!0):e.replace("#","%23")};t.canonicalizeDecodedUrl=function(e){e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23"));return e};t.getDecodedUrl=function(e){var t=e.split("/");if(t.length>3){for(var n=3;n<t.length;n++)t[n]=decodeURIComponent(t[n]);return t.join("/")}return e}});
define("vse",["require","exports","A","q3","W","K3","G3"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeoplePickerGraph={ODB:387};var u=(function(){function e(e,t){this._pageContext=t.pageContext;this._sharingContextInformation=t.sharingContextInformation;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken);this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&r.default.isFeatureEnabled(t.PeoplePickerGraph);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableGraph",o.default.session));return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableGraph",!0,o.default.session)};e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return n.default.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new i.Qos({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken("https://graph.microsoft.com").then(function(e){t.end({resultType:i.ResultTypeEnum.Success});return e},function(r){if(n.default.isCanceled(r)){t.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return n.default.reject(r)}t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:i.ResultTypeEnum.Failure,extraData:{serverErrorCode:r._serverErrorCode,message:r.message}});e.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.default("PeoplePicker",o.default.session))};return e})();t.GraphPeoplePickerHelper=u});
define("tT",["require","exports","A","W","eM","K3","G3","q3","k"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUBSTRATE_SEARCH_URL="https://outlook.office.com/search";t.PeoplePickerSubstrate={ODB:1286};var f=(function(){function e(e,t){this._dataRequestor=new i.DataRequestor({},{});this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken);this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;if(this._pageContext&&!this._pageContext.isSPO)return e;if(this._pageContext&&this._pageContext.authToken)return e;this._pageContext&&this._oAuthTokenProvider&&u.default.isFeatureEnabled(t.PeoplePickerSubstrate)&&(e=!0);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",o.default.session));return e};e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableSubstrateSearch",!0,o.default.session)};e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return n.default.resolve(this._substrateToken);if(this._oAuthTokenProvider){var i=new r.Qos({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(t.SUBSTRATE_SEARCH_URL).then(function(e){i.end({resultType:r.ResultTypeEnum.Success});return e},function(t){if(n.default.isCanceled(t)){i.end({resultType:r.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return n.default.reject(t)}i.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:r.ResultTypeEnum.Failure,extraData:{serverErrorCode:t._serverErrorCode,message:t.message}});e.disableSubstrateCallsForPicker();return null})}return null};e.prototype.init=function(e){var n=t.SUBSTRATE_SEARCH_URL+"/api/v1/init?scenario=documentshare";a.Killswitch.isActivated("20373606-dfd1-4220-9a96-50f93570a877","07/03/2020","Removing litoken while calling Substrate.")?this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:n,headers:{Authorization:"Bearer "+e,"X-User-Context":"litoken="+e},needsAuthorization:!1}):this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:n,headers:{Authorization:"Bearer "+e},needsAuthorization:!1})};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.default("PeoplePicker",o.default.session))};return e})();t.SubstratePeoplePickerHelper=f});
define("RD",["require","exports","ty","Be"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.AddWopiPerfMarkToTargetUrl=function(t,n,i){try{var s=new r.default(i);s.setQueryParameter(e.param_CT,t,!0);s.setQueryParameter(e.param_OR,n,!0);return s.toString()}catch(e){}};e.AddWopiPerfMark=function(e,t,n){try{if("sessionStorage"in window&&window.sessionStorage){if(n){var r=decodeURIComponent(n),i=r&&r.indexOf("sourcedoc=");if(-1!==i){var s=r.substring(i).indexOf("&"),o=-1===s?r.substring(i):r.substring(i,i+s);o=escape(o);window.sessionStorage["WOPIPerf_UserClick_"+o]=t}}window.sessionStorage.WOPIPerf_UserClickOrigin=e}}catch(e){}};e.GetWopiFrameEditUrl=function(e){if(e.properties["serverurl.progid"]){var t=e.properties.ServerRedirectedEmbedUrl;t&&(t="ms-visio"!==e.appMap&&"ms-excel"!==e.appMap&&n.default.hasItemPermission(e,n.default.editListItems)?t.replace("action=interactivepreview","action=edit"):t.replace("action=interactivepreview","action=default"));return t}return""};e.GetWopiDocEditUrl=function(e,t,r){if(e.properties["serverurl.progid"]){var i=e.properties.ServerRedirectedEmbedUrl;if(i){i=this.ReplaceToDocAspx(i,e,t,r);i="ms-visio"!==e.appMap&&"ms-excel"!==e.appMap&&n.default.hasItemPermission(e,n.default.editListItems)?i.replace("action=interactivepreview","action=edit"):i.replace("action=interactivepreview","action=default")}return i}};e.ReplaceToDocAspx=function(e,t,n,i){e=e.replace("/WopiFrame.aspx?","/doc.aspx?");var s=new r.default(e);s.setQueryParameter("uid",t.properties.UniqueId);s.setQueryParameter("ListItemId",t.properties.ID);s.setQueryParameter("ListId",n);s.setQueryParameter("odsp","1");i&&i.length>0&&s.setQueryParameter("env",i);return s.toString()};e.param_CT="CT";e.param_OR="OR";return e})();t.WopiHelper=i;t.default=i});
define("tQ",["require","exports","ww","eM","r4"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("eM",["require","exports","ww","A","aM","me","Be","o2","nM","M","X","Te","tM","Le","k"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=window&&window.performance,m={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},g="Bearer",y=(function(){function e(e,t){var n=e.alwaysSendContentType,r=void 0!==n&&n,i=t.sessionManagementProvider,o=t.urlDataSource,u=t.apiEvent,a=void 0===u?s.Api:u,f=t.cookieOrigin,l=t.isOffline;this._sessionManagementProvider=i;this._alwaysSendContentType=r;this._apiEvent=a;this._apiName=o&&"function"==typeof o.getApiName?o.getApiName():"Vroom";this._apiBaseUrl=o?"function"==typeof o.getApiBaseUrl?o.getApiBaseUrl():o.getVroomApiBaseUrl():void 0;this._cookieOrigin=f;this._isOffline=l;this._encodingFixEnabled=!d.Killswitch.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!p.default.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"})}e.prototype.send=function(e){var t=this,p=e.headers,d=void 0===p?{}:p,y=e.path,w=e.endpoint,E=void 0===w?this._apiBaseUrl:w,S=e.driveUrl,x=e.apiName,T=e.disableLogging,N=void 0!==T&&T,C=e.timeout,k=e.onProgress,L=e.onUploadProgress,A=e.qosExtraData,O=e.apiVersion,M=void 0===O?"v2.0":O,_=e.needsAuthorization,D=void 0===_||_,P=e.useAuthorizationHeaders,H=void 0!==P&&P,B=e.accessToken,j=e.postProcessQos,F=e.breakCache,I=e.allowCookies,q=e.hasContentType,R=void 0===q||q,U=e.useMultiPart,z=void 0!==U&&U,W=e.getErrorAsMessage,X=void 0!==W&&W,V=e.expectedErrors,$=n.__assign(n.__assign({},m),e.expectedErrorCodes||{}),J=e.requestType,K=void 0===J?"GET":J,Q=this._cookieOrigin,G=new c.default(y).authority?y:""+E+y,Y=function(p){var m,g="",b={};b=z?{"Content-Type":"multipart/form-data;boundary="+(g=f.default.generate())}:n.__assign(n.__assign(n.__assign(n.__assign({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&R?{"Content-Type":"application/json"}:{}),p.useCookies&&p.digestValue?{"x-requestdigest":p.digestValue}:{}),X?{prefer:"rich-error-as-message"}:{}),d);if(p.sessionToken&&p.sessionToken.tokenUrl&&0===y.indexOf("/drive/"))m=new o.default(p.sessionToken.tokenUrl+"/"+y.substring(7));else{m=new o.default(y);E&&!m.getScheme()&&(m=new o.default(E+y))}if(z){m.setQueryParameter("ump","1");"POST"!==K&&(d["X-HTTP-Method-Override"]=K);K="POST"}var w,S=m.toString();if(!z&&p.sessionToken){var T=p.sessionToken,O=T.accessToken,M=T.proofToken,_=T.wlidToken,D=T.isBadger;if(_)b=n.__assign(n.__assign({},b),{Authorization:"wlid1.1 "+_});else if(H){O&&(b=D?n.__assign(n.__assign({},b),{Authorization:"badger "+O}):n.__assign(n.__assign({},b),{Authorization:"bearer "+O}));M&&(b=n.__assign(n.__assign({},b),{"X-PROOF_TOKEN":M}))}else{O&&m.setQueryParameter("access_token",O);M&&m.setQueryParameter("prooftoken",M)}}if(z){var P="";P+="--"+g+"\r\n";P+="Content-Disposition: form-data;name=data\r\n";if(d)for(var B=0,I=Object.keys(d);B<I.length;B++){var q=I[B];P+=q+": "+d[q]+"\r\n"}P+="Content-Type: application/json\r\n";P+="Authorization: bearer "+p.sessionToken.accessToken+"\r\n";X&&(P+="prefer: rich-error-as-message\r\n");P+="\r\n";P+=(void 0!==e.postData?e.postData:"")+"\r\n";P+="--"+g+"--"}F&&m.setQueryParameter("r",Math.random().toFixed(8));if(!N){var U=new c.default(S),W={url:U.authority+"/{ length: "+U.path.length+", segments: "+U.segments.length+" }",name:t._apiName+"DataRequest."+x,extraData:A};w=new t._apiEvent(W)}var J=m.toString(),Q=v&&v.now();return i.default.start({url:J,headers:b,method:K,json:P||e.postData||"",requestTimeoutInMS:C,withCredentials:p.useCookies,onProgress:k,onUploadProgress:L}).then(function(t){var n=u.getRequestEntryDurationMetrics(J,Q);if(w){var r={resultType:s.ResultTypeEnum.Success,extraData:{rawRequestDuration:n.duration,performanceEntry:JSON.stringify(n),requestId:t.getResponseHeader("request-id")||t.getResponseHeader("sprequestguid"),MSCorrelationVector:t.getResponseHeader("MS-CV")}};w.end(r)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var i,o=function(e,t){j&&(e=j(e,t));w&&w.end(e);return r.default.reject(t)},f=u.getRequestEntryDurationMetrics(J,Q);if(e instanceof Error){var c=r.default.isCanceled(e),d=c?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,v={error:e.message,resultCode:c?"Canceled":"",resultType:d,extraData:{rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)}};return o(v,e)}if(e.responseText)try{i=JSON.parse(e.responseText)}catch(e){}if(X)try{var g=t._encodingFixEnabled?JSON.parse(h.base64ToString(i.error.message)):JSON.parse(atob(i.error.message));i={error:g}}catch(e){}var y=e.status,b=e.statusText,E=(i||{}).error,S=void 0===E?{}:E,x=S.message,T=void 0===x?"":x,N=S.innerError,C=void 0===N?{}:N,k=C.stackTrace,L=void 0===k?"":k,O=C.debugMessage,M=void 0===O?"":O;return(y||!t._isOffline?r.default.resolve(!1):t._isOffline()).then(function(t){var r=t?"Offline":"",u=e.getResponseHeader("request-id")||e.getResponseHeader("sprequestguid"),c=t||!!a.getErrorResolutionFromResponse(i,y,function(e){return $[e]}),h=new a.GraphError(new Error(T||r),{response:i,status:y,request:e,correlationId:u,isExpected:c});V&&l.isExpectedError({code:h.code,message:T},V)&&(c=!0);var d={resultType:c?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,error:T,resultCode:h.code,extraData:n.__assign(n.__assign(n.__assign({},A||{}),a.getQosExtraDataFromError(h)),{stack:L,httpStatus:y,httpStatusText:b,requestId:u,MSCorrelationVector:e.getResponseHeader("MS-CV"),debugMessage:M,accessTokenLength:p.sessionToken&&p.sessionToken.accessToken?p.sessionToken.accessToken.length:-1,urlLength:m.toString().length,useCookies:!!p.useCookies,isOffline:t,rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)})};return o(d,h)})})},Z=this._sessionManagementProvider;if(D){if(B)return Y({sessionToken:B});var ee=new c.default(G).authority;if(I&&ee&&Q&&ee===Q)return Z&&Z.getFormDigest&&"GET"!==K?Z.getFormDigest().then(function(e){return Y({digestValue:e,useCookies:!0})}):Y({useCookies:!0});if(Z&&Z.getSessionToken){var te={apiVersion:M,endpoint:E,driveUrl:S,path:G};return r.default.resolve(Z.getSessionToken(te)).then(function(e){return Y({sessionToken:e}).catch(function(t){return e&&(function(e){if(e instanceof a.GraphError){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&n.slice(0,g.length)===g&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1})(t)?Z.getSessionToken(n.__assign(n.__assign({},te),{claimsChallenge:{sessionToken:e,claims:b(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?Y({sessionToken:n}):r.default.reject(t)}):r.default.reject(t)})})}if(Z&&Z.getToken)return Z.getToken(M,G).then(function(e){return Y({sessionToken:e})})}return Y({})};return e})();t.DataRequestor=y;t.default=y;function b(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate");if(t){var n=t.indexOf('claims="');if(n>-1){var r=t.indexOf('"',n+'claims="'.length);if(r>-1)return t.slice(n+'claims="'.length,r)}}}});
define("r4",["require","exports","Te"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._url=e}Object.defineProperty(e.prototype,"endpoint",{get:function(){return this._getEndpoint()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!0,configurable:!0});e.prototype._getEndpoint=function(){var e,t=(this._url+"/").indexOf("/drives/"),n=(this._url+"/").indexOf("/drive/"),r=(this._url+"/").indexOf("/me/");t>-1?e=this._url.substring(0,t):r>-1&&n>-1&&n>r?e=this._url.substring(0,r):n>-1&&(e=this._url.substring(0,n));e&&0===e.indexOf("https:")&&(e=e.replace(":443/","/"));this._getEndpoint=function(){return e};return e};e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment(),n=this._getIndexOfDriveSegment();if(t>-1){var r=this._getPathSegments();e=r[t+1]}else if(n>-1){"me"===(r=this._getPathSegments())[n-1]&&(e="me")}this._getDriveId=function(){return e};return e};e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(t>-1){var n=this._getPathSegments(),r=(e=n[t+1])?e.indexOf("?"):-1;-1!==r&&(e=e.substring(0,r))}else{var i=this._getIndexOfDrivesSegment(),s=this._getIndexOfDriveSegment();n=this._getPathSegments();i>-1?"root"===n[i+2]&&(e="root"):s>-1&&"root"===n[s+1]&&(e="root")}this._getItemId=function(){return e};return e};e.prototype._getPathSegments=function(){var e,t=this._url;e=t?new n.default(t).segments:[];this._getPathSegments=function(){return e};return e};e.prototype._getIndexOfDriveSegment=function(){var e=this._getPathSegments().indexOf("drive");this._getIndexOfDriveSegment=function(){return e};return e};e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");this._getIndexOfDrivesSegment=function(){return e};return e};e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");this._getIndexOfItemsSegment=function(){return e};return e};return e})();t.getUrlParts=function(e){return new r(e)}});
define("nM",["require","exports","ww","N"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t,r){var i=this,s=r.response,o=(void 0===s?{}:s).error,u=(void 0===o?{}:o).innerError,a=(void 0===u?{}:u).stackTrace,f=void 0===a?"":a,l=r.response,c=r.request,h=r.status,p=r.code,d=void 0===p?v(l,h,function(e){return""+e})||"unhandled":p,m=n.__assign({innerError:t,code:d},r);(i=e.call(this,m)||this).name="GraphError";i.response=l;i.status=h;i.serverStack=f;i.request=c;i.error=t;return i}return t})(r.ApiError);t.GraphError=i;var s="errorMessage",o="vroomStatus",u="vroomErrorCode",a="vroomErrorMessage",f="vroomErrorInnerCode",l="vroomErrorInnerMessage",c="vroomErrorInnerDebugMessage",h="vroomErrorInnerStack";t.getQosExtraDataFromError=function(e){var t={};t[s]=e.message;if(p(e)){t[o]=e.status;var n=e.response;if(n&&n.error){var r=n.error;t[u]=r.code;t[a]=r.message;var i=r.innerError||r.innererror;if(i){t[f]=i.code;t[l]=i.message;t[c]=i.debugMessage;t[h]=i.stackTrace}}}return t};function p(e){return e instanceof i}t.isGraphError=p;function d(e,t){if(p(e)){return v(e.response,e.status,function(n){return t(n,e)})}}t.getErrorResolution=d;t.getResultCodeFromError=function(e){return d(e,function(e){return""+e})||"unhandled"};function v(e,t,n){if(e){for(var r=[],i=e.error;i;){r.push(i);i=i.innerError||i.innererror}for(;i=r.pop();)if(void 0!==i.code){var s=n(i.code);if(void 0!==s)return s}}return n(t)}t.getErrorResolutionFromResponse=v});
define("k4",["require","exports","Ye"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){return t&&t[e].extensions||[]}t.doExtFiltersHaveMediaTypesOnly=function(e){var t=e.extFilters,i=e.allowedMediaTypes,s=e.fileTypeIconMap,o=[],u=[];if(!t||!t.filters||0===t.filters.length||0===i.length)return!1;if(1===t.filters.length&&t.filters.indexOf(n.ItemTypeFilter.folder)>-1)return!1;for(var a=r("vector",s),f=r("photo",s).concat(a),l=r("video",s),c=0,h=t.filters;c<h.length;c++){var p=h[c];if("string"!=typeof p){var d=p;switch(d){case n.ItemTypeFilter.folder:u.push("folder");o.push("folder");break;case n.ItemTypeFilter.photo:if(i.indexOf(d)>-1){o.push("photo");u.push("photo");u=u.concat(f)}break;case n.ItemTypeFilter.video:if(i.indexOf(d)>-1){o.push("video");u.push("video");u=u.concat(l)}break;default:return!1}}else{var v=p;"!"===v[0]&&(v=v.slice(1));u=u.concat(a);if("."===v[0]){var m=v.slice(1).toLowerCase();o.push(m);var g=i.indexOf(n.ItemTypeFilter.photo)>-1&&f.indexOf(m)>-1,y=i.indexOf(n.ItemTypeFilter.video)>-1&&l.indexOf(m)>-1,b=-1===u.indexOf(m);g&&b&&u.push(m);y&&b&&u.push(m)}}}return 0===(o=o.filter(Boolean)).filter(function(e){return-1===u.indexOf(e)}).length};t.getIItemTypeFilter=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var s=i[r],o=s;"!"===o[0]&&(o=o.slice(1));"."===o[0]?t.push(s):t.push(n.ItemTypeFilter[s])}return{filters:t}}});
define("mZ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CheckOutUserProperty="CheckedOutUserId";function n(e){return!!e.properties[t.CheckOutUserProperty]}t.isCheckedOut=n;function r(e,n){var r=Number(n);return!isNaN(r)&&Number(e.properties[t.CheckOutUserProperty])===r}t.isCheckedOutByUser=r;t.isCheckedOutByOther=function(e,t){return n(e)&&!r(e,t)}});
define("V8",["require","exports","Oe","_4"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(e,t,i,s){var o,u,a;switch(e){case-2147024894:o=t.ItemNotFoundTitle;u=t.ItemNotFoundSubText;break;case-2147024809:o=t.InvalidViewTitle;u=t.InvalidViewSubText;break;case-1:o=t.InvalidListTitle;u=t.InvalidListSubText;break;case-2147024860:o=t.DefaultTitle;var f='<a href="'+r.default.encodeText("https://support.office.com/en-us/article/Manage-lists-and-libraries-with-many-items-b8588dae-9387-48c2-9248-c24122f07c59")+'">'+t.QueryThrottledLinkText+"</a>";a=n.format(t.QueryThrottledSubText,f);break;case-4:o=null;a=null;break;default:o=t.DefaultTitle;u=s&&s.message&&("object"==typeof s.message?s.message.value:s.message.toString())||t.DefaultSubText}return{errorCode:e,errorDetailedText:u,errorTitle:o,errorDetailedHtml:a,correlationId:i}}t.generateError=i;t.default=i});
define("G4",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MediaTAUseVroomV21={ODB:620}});
define("g$e",["require","exports","ww","C","v$e"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i._baseInfoSetCallbacks=[];i._authDataSignalCompleted=!1;i._authDataSignal=new r.default;i._authTokenDataSource=n.authTokenDataSource;i._baseInfoSet=!1;return i}t.prototype.getAuthData=function(){var e=this;return this._authTokenDataSource&&this.hasAuthDataExpired()?this._authTokenDataSource.getAuthToken({}).then(function(t){e.setBaseInfo(t);return e._authDataSignal.getPromise()}):this._authDataSignal.getPromise()};t.prototype.hasAuthData=function(){return!!this._processor.getCommonAuthData()};t.prototype.hasAuthDataExpired=function(){var e=new Date;e.setMinutes(e.getMinutes()+5);var t=this._processor.getCommonAuthData();return!!t&&t.expirationTime<=e};t.prototype.setBaseInfo=function(e){this._baseInfoSet=!0;var t=this._processor.parseCommonData(e);if(t.authData)if(this._authDataSignalCompleted){this._authDataSignal=new r.default;this._authDataSignal.complete(t.authData)}else{this._authDataSignalCompleted=!0;this._authDataSignal.complete(t.authData)}this._cookieHelper.checkCookies(t.mediaUrl,t.authData);for(var n=0,i=this._baseInfoSetCallbacks;n<i.length;n++){(0,i[n])()}};t.prototype.hasSetBaseInfo=function(){return this._baseInfoSet};t.prototype.registerSetBaseInfoCallback=function(e){this._baseInfoSetCallbacks.push(e)};return t})(i.default);t.default=s});
define("p$e",["require","exports","ww","C","A","aM","Le","bTe","$Z","G4"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;(function(e){e[e.Failed=-1]="Failed";e[e.None=0]="None";e[e.Pending=1]="Pending";e[e.Success=2]="Success"})(l||(l={}));var c=(function(){function e(e,t){var n=this;this._platform=t.platformDetection;this.thumbnailHelper=t.thumbnailHelper;this._updateThumbnailUrlCallback=t.updateThumbnailUrlCallback;this._cookieState=0;this._haveCookies=new r.default;this.itemsWaitingForCookies=[];this._cookieAuthData={};a.default.registerCookieChecker({isApplicable:function(e){return!(e.indexOf("access_token")>0||e.indexOf(".svc.ms/transform/thumbnail")<0)},check:function(e){var t=new r.default;n._haveCookies.getPromise().done(function(e){return t.complete(e)},function(e){return t.error(e)});return t.getPromise()}})}e.prototype.canUseCookies=function(){return!(!this._cookieAuthData.active&&1!==this._cookieState)};e.prototype.trackItem=function(e){this._cookieAuthData.active||this.itemsWaitingForCookies.push(n.__assign({},e))};e.prototype.checkCookies=function(e,t){if(-1!==this._cookieState&&t&&t.supportsCookies){this._cookieAuthData.mostRecent=t;if(1!==this._cookieState)if(this._cookieAuthData.active){if(this._cookieAuthData.active!==t){var n=Date.now()-this._cookieAuthData.active.timeReceived.getTime();if(n>432e5){this._haveCookies=new r.default;this._cookieAuthData.active=void 0}n>72e5&&this._updateCookies(e,t)}}else this._updateCookies(e,t)}};e.prototype._updateCookies=function(e,t){var n=this,r=0===this._cookieState;this._cookieState=1;this._makeImageRequest(e,t,r).then(function(){n._cookieAuthData.active=t;n._cookieState=2;n.itemsWaitingForCookies.length=0;n._haveCookies.complete(!0)},function(){n._cookieState=-1;n._updateThumbnailUrls(t);n._haveCookies.error(!1)})};e.prototype._makeCorsRequest=function(e,t){var n,r=this;e+="/Auth/SetCookies?provider=spo";var s=o.default.isFeatureEnabled(f.MediaTAUseVroomV21),u=s?t.authTokenV21:t.authToken,a=s?t.proofTokenV21:t.proofToken;if(this._platform.isIE&&this._platform.browserMajor<=10){e+="&access_token="+u;e+="&prooftoken="+a}else n={spo_access_token:u,spo_prooftoken:a};return this.sendCorsRequest(e,n).then(function(t){if(!t.isOldCookiePresent)return r.sendCorsRequest(e,n).then(function(e){if(!e.isOldCookiePresent)return i.default.wrapError("Cookie request succeeded, but the cookies are not actually being set")})})};e.prototype.sendCorsRequest=function(e,t){return s.default.start({withCredentials:!0,url:e,headers:t,method:"POST"}).then(function(e){var t;try{t=JSON.parse(e.responseText)}catch(e){}return t||i.default.reject("Expected response object but received nothing")})};e.prototype._makeImageRequest=function(e,t,n){var r=o.default.isFeatureEnabled(f.MediaTAUseVroomV21),i=r?t.authTokenV21:t.authToken,s=r?t.proofTokenV21:t.proofToken;e+="/Auth/SetCookiesImg?provider=spo";e+="&access_token="+i;e+="&prooftoken="+s;return u.request(e).then(function(){if(n)return u.request(e+"&throwOnMissingCookies=true")})};e.prototype._updateThumbnailUrls=function(e){this.itemsWaitingForCookies.length&&this._updateThumbnailUrlCallback(this,e)};return e})();t.default=c});
define("u$e",["require","exports","K3","G3","Wq"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=t.dataStoreType,s=void 0===i?n.default:i;this._dataStore=new s("MediaAuthStore",r.default.session)}e.prototype.getToken=function(e,t){if(e){var n=this._dataStore.getValue(e);if(n&&!i.isTokenExpired(n,36e5))return n;this._dataStore.setValue(e,t)}return t};return e})();t.default=s});
define("fSe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["glb","gltf"],r=["cool","fbx","obj","ply","stl","3mf"];function i(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}t.canConvert=function(e){return i(r,e)};t.canRenderNative=function(e){return i(n,e)}});
define("uSe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["htm","html","svg"],r=["eml","msg","md","mdown","markdown"];function i(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}t.canConvert=function(e){return i(r,e)};t.canRenderNative=function(e){return i(n,e)}});
define("v$e",["require","exports","Ee","jP","q3","fSe","W4","lSe","G4","K4"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={ODC:"EnableAudioPlayer",ODB:841,OneDrive:!0},c={"ar-SA":!0,"he-IL":!0,"ja-JP":!0,"ko-KR":!0,"zh-CN":!0},h=/&(?:access_|proof)token=[^&]*/g,p=(function(){function e(e,t){this._processor=t.metaDataProcessor;this._cookieHelper=t.authCookieHelper;this._thumbnailHelper=t.thumbnailHelper;this._pageContext=t.pageContext;this._authTokenStore=t.authTokenStore}e.prototype.getVideoUrl=function(e){if("False"!==e.item[".hasVideoManifest"]||e.item[".videoManifestUrl"]||"audio"===r.getIconNameFromExtension(e.fileExtension)||i.default.isFeatureEnabled(l)){var t=this._processor.generateUrl(".videoManifestUrl",e.item);if(t){var n=e.item[".ctag"];n&&(t+="&cTag="+encodeURIComponent(n));t+="&action=Access"}return t}};e.prototype.getThumbnail=function(e){if(("False"!==e.item[".hasThumbnail"]||e.item[".thumbnailUrl"])&&this._thumbnailHelper.canProvideThumbnail(e.fileExtension)){var t=this._processor.generateUrl(".thumbnailUrl",e.item);t&&(t+="&encodeFailures=1");var n=e.allowCookieAuth,r=void 0===n||n,s=e.itemKey,o=e.fileExtension,u=e.mediaServiceMetadata;if(t&&r&&this._cookieHelper.canUseCookies()){t=t.replace(h,"");e.item[".ctag"]&&(t+="&ctag="+encodeURIComponent(e.item[".ctag"]));this._cookieHelper.trackItem({itemKey:s,thumbnailUrl:t,fileExtension:o,mediaServiceMetadata:u})}else if(t){var f=this._processor.getCommonAuthData();if(f){var l=i.default.isFeatureEnabled(a.MediaTAUseVroomV21),c={authToken:l?f.authTokenV21:f.authToken,proofToken:l?f.proofTokenV21:f.proofToken},p=this._authTokenStore.getToken(this._processor.getUniqueKey(),c);p&&p!==c&&(t=t.replace(h,"&access_token="+p.authToken+(p.proofToken?"&prooftoken="+p.proofToken:"")))}}return t?this._thumbnailHelper.getThumbnail({itemKey:s,fileExtension:o,baseUrl:t,mediaServiceMetadata:u}):void 0}};e.prototype.getDownloadAsZipUrl=function(e){var t=this._processor.getNormalUrl(".zipUrl",e);if(!t){e[".zipUrl"]=o.ZIP_URL;t=this._processor.getFallbackUrl(".zipUrl",e)}return t};e.prototype.getPassthroughUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"passthrough")};e.prototype.getPdfConversionUrl=function(e,t){var r=e.fileExtension;if((this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled)&&u.canRenderNative(r))return this.getPassthroughUrl(e);if(!c[n.default.language]){var s=i.default.isFeatureEnabled({ODB:1225});return u.canConvert(r,s)||t?this._processor.generateUrl(".pdfConversionUrl",e.item):void 0}};e.prototype.getFbxConversionUrl=function(e){return"True"===e.item[".hasBxf"]&&s.canConvert(e.fileExtension)?this._processor.generateUrl(".transformUrl",e.item,"bxf"):""};e.prototype.getHtmlConversionUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"html")};e.prototype.getZipMetaDataUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"zipmetadata")};e.prototype.getDownloadZipContentsUrl=function(e){return this._processor.generateUrl(".transformUrl",e,"zipcontent")};e.prototype.getOfficeBundleGenerateUrl=function(e){if("False"!==e.item[".hasOfficePreview"]||e.item[".officeBundleGenerate"]){var t=this._processor.generateUrl(".officeBundleGenerate",e.item),n=encodeURIComponent(e.item[".ctag"]);return t&&t.replace("Generate","")+"&minVersion={{minVersion}}&cTag="+n}};e.prototype.getOfficeBundleGetFragmentUrl=function(e){if("False"!==e.item[".hasOfficePreview"]||e.item[".officeBundleGetFragment"]){var t=this._processor.generateUrl(".officeBundleGetFragment",e.item);return t&&t.replace("Get","")+"&fragment={0}"}};e.prototype.getitemUrlWithToken=function(e){var t=this._processor.getCommonProperty(".driveAccessToken");return t&&f.getItemUrlWithToken(e,t)};e.prototype.getPushChannelUrl=function(){return this._processor.getCommonProperty(".pushChannelBaseUrl")};e.prototype.getGenerateTranscriptUrl=function(e){return this._processor.getAnalyzeUrl("transcriptinit",e.item)};e.prototype.getMediaBaseUrl=function(e){return this._processor.generateUrl(".mediaBaseUrl",e.item)};return e})();t.default=p});
define("_$e",["require","exports","ww","K","W4","G4","K4","q3"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t){this._properties={};this._authData=void 0;this._allowCookies=!t.platformDetection.isSafari;var n=t.pageContext,r=n.env,i=n.userEmail,s=n.viewOnlyExperienceEnabled;this._env=r;this._isViewOnly=!!s;this._userID=i}e.prototype.getCommonAuthData=function(){return this._authData};e.prototype.getCommonProperty=function(e){return this._properties[e]};e.prototype.parseCommonData=function(e){o.setMicroServiceProperties(this._properties,e.data,this._env);this._authData=this._getCurrentAuthData(e.allowCookies&&this._allowCookies);return{authData:this._authData,mediaUrl:this._properties[".mediaBaseUrl"]}};e.prototype.getUniqueKey=function(){var e=this._properties[".driveUrl"]||this._properties[".driveUrlV21"],t=this._userID;return t&&e?t+"-"+e:""};e.prototype.generateUrl=function(e,t,n){return this.getNormalUrl(e,t,n)||this.getFallbackUrl(e,t,n)};e.prototype.getAnalyzeUrl=function(e,t){return o.getNormalUrl(n.__assign({".analyzeUrl":"{.mediaBaseUrl}/analyze?provider=spo&profile="+e+"&extension={.fileType}&docid={.spItemUrl}&{.driveAccessToken"+(u.default.isFeatureEnabled(s.MediaTAUseVroomV21)?"V21":"")+"}"},this._properties),".analyzeUrl",t)};e.prototype.getNormalUrl=function(e,t,n){return o.getNormalUrl(this._properties,e,t,n,this._isViewOnly,this._authData&&this._authData.supportsCookies)};e.prototype.getFallbackUrl=function(e,t,n){var r=t[e];if(r){r=r.replace("{.method}",n);for(var s=0,u=i.FALLBACK_PROPERTIES;s<u.length;s++){var a=u[s],f=t[a];".mediaBaseUrl"===a&&(f=o.fixMediaBaseUrl(f,this._env));if(!f){if(".correlationId"===a){r=r.replace("&correlationId={.correlationId}","");continue}return}".spResourceUrl"===a&&(f=encodeURIComponent(f));r=r.replace("{"+a+"}",f)}this._isViewOnly&&(r+="&nocache=true");return r}};e.prototype._getCurrentAuthData=function(e){var t=f(this._properties[".driveAccessToken"]),n=f(this._properties[".driveAccessTokenV21"]);if(n&&t){var r=new Date;return{authToken:t.authToken,proofToken:t.proofToken,tokenUrl:this._properties[".driveUrl"],authTokenV21:n.authToken,proofTokenV21:n.proofToken,tokenUrlV21:this._properties[".driveUrlV21"],timeReceived:r,expirationTime:new Date(r.getTime()+216e5),supportsCookies:e}}};return e})();t.default=a;function f(e){if(e){var t=r.deserializeQuery(e);return t&&t.access_token?{authToken:t.access_token,proofToken:t.prooftoken}:void 0}}});
define("K4",["require","exports","ww","W4"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(e,t){return"https://media.cloudapp.net"===e?"edog"===t?"https://centralus1-mediad.svc.ms":"https://northcentralus1-medias.svc.ms":e}t.fixMediaBaseUrl=i;t.getItemUrlWithToken=function(e,t){var n=e.toLowerCase();if(n.indexOf("access_token=")>-1||n.indexOf("tempauth=")>-1)return e;var r=-1===e.indexOf("?")?"?":"&";return""+e+r+(t.indexOf("access_token")>-1?t:"access_token="+t)};function s(e,t,r,i,s,o){var u,a,f=n.__assign(n.__assign(n.__assign(n.__assign({},e),"string"==typeof i?{".method":i}:{}),".zipUrl"===t?((u={})[".fileType"]="zipfile",u):{}),r||{}),l=f[t];if(l)try{var c=(function e(t,n,r,i){return t.replace(/{([^\}]*)}/g,function(t,s){if(s in r){var o=r[s];if(void 0===o)throw new Error(" URI template contains recursion on variable "+s);return o}var u=n[s];if(void 0===u)throw new Error("URI template contains unknown variable "+s);if(".spItemUrl"===s||".spResourceUrl"===s){if((function(e,t){if(t)return!1;var n=e.indexOf("/",8);return e.substring(n).length>215})(u,i))throw new Error("URI template variable "+s+" is too long: "+u);return r[s]=encodeURIComponent(u)}r[s]=void 0;return r[s]=e(u,n,r,i)})})(l,f,((a={})[t]=void 0,a),!!o);return s?c+"&nocache=true":c}catch(e){return}}t.getNormalUrl=s;t.getDownloadAsZipUrl=function(e,t,n){var r={};o(r,e,n);return s(r,".zipUrl",void 0,void 0,t,!1)};function o(e,t,n){e[".zipUrl"]=r.ZIP_URL;for(var s=0,o=r.COMMON;s<o.length;s++){var u=o[s];t[u]&&(e[u]=t[u])}e[".mediaBaseUrl"]=i(e[".mediaBaseUrl"],n);e[".mediaBaseUrlSecondary"]=i(e[".mediaBaseUrlSecondary"],n)}t.setMicroServiceProperties=o});
define("lSe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["ai","pdf"],r=["doc","docx","odt","rtf","ods","xls","xlsm","xlsx","odp","ppt","pptx","pps","ppsx","tiff","tif","epub","htm","html","eml","msg","md","markdown"],i=["dwg","dxf"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}t.canConvert=function(e,t){return s(r,e)||!!t&&s(i,e)};t.canRenderNative=function(e){return s(n,e)}});
define("W4",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ZIP_URL="{.mediaBaseUrl}/transform/zip?cs={.callerStack}";(function(e){e.accessToken=".accessToken";e.callerStack=".callerStack";e.correlationId=".correlationId";e.mediaBaseUrl=".mediaBaseUrl";e.mediaBaseUrlSecondary=".mediaBaseUrlSecondary";e.pushChannelBaseUrl=".pushChannelBaseUrl";e.driveAccessToken=".driveAccessToken";e.driveAccessTokenV21=".driveAccessTokenV21";e.driveUrl=".driveUrl";e.driveUrlV21=".driveUrlV21";e.pdfConversionUrl=".pdfConversionUrl";e.thumbnailUrl=".thumbnailUrl";e.transformUrl=".transformUrl";e.videoManifestUrl=".videoManifestUrl";e.zipUrl=".zipUrl";e.officeBundleGenerate=".officeBundleGenerate";e.officeBundleGetFragment=".officeBundleGetFragment";e.resourceUrl=".spResourceUrl";e.fileType=".fileType";e.itemUrl=".spItemUrl";e.cTag=".ctag";e.hasBxf=".hasBxf";e.hasOfficePreview=".hasOfficePreview";e.hasPdf=".hasPdf";e.hasThumbnail=".hasThumbnail";e.hasVideoManifest=".hasVideoManifest";e.analyzeUrl=".analyzeUrl"})(t.ALL||(t.ALL={}));t.COMMON=[".accessToken",".callerStack",".mediaBaseUrl",".mediaBaseUrlSecondary",".pushChannelBaseUrl",".driveAccessToken",".driveUrl",".driveAccessTokenV21",".driveUrlV21",".zipUrl",".pdfConversionUrl",".thumbnailUrl",".transformUrl",".videoManifestUrl",".officeBundleGenerate",".officeBundleGetFragment"];t.FALLBACK_PROPERTIES=[".callerStack",".correlationId",".mediaBaseUrl",".spResourceUrl"]});
define("b$e",["require","exports","ww","zne","N5","Le"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UseThumbnailService={ODB:816,OneDrive:!0};t.ExpandThumbnailSupport={ODB:820};var o={".xls":!0,".xlsx":!0},u={".jpg":!0,".jpeg":!0,".png":!0,".gif":!0,".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},a=(function(){function e(e,t){this._apiUrlHelper=t.apiUrlHelper}e.prototype.getImageUrl=function(e){if(e.isCrossDomain){var t=this._apiUrlHelper.build().webByItemUrl(e);return(t=(t=t.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:e.serverRelativeItemUrl})).segment("OpenBinaryStream")).toString()}return e.fullItemUrl};return e})();t.CrossDomainImageHelper=a;var f=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._crossDomainImageHelper=e.crossDomainImageHelper}e.prototype.getThumbnail=function(e){var t,r,i=this,s=e.fileExtension,o=void 0===s?"":s,u=e.itemKey,a=e.baseUrl,f=e.mediaServiceMetadata,l=f&&f.photo,c=f&&f.video;if(l){t=l.width;r=l.height}else if(c){t=c.frameWidth;r=c.frameHeight}var h={width:t||0,height:r||0};if(".gif"===o.toLowerCase()){var p=this._itemUrlHelper.getItemUrlParts(u),d=this._crossDomainImageHelper.getImageUrl(p),v=n.__assign({url:d},h);return n.__assign(n.__assign({},v),{getAligned:function(){return v}})}if(a){var m=f&&f.lenses;m&&m.officeLens&&(a+="&lenses=OfficeLens");return n.__assign(n.__assign({url:this._getUrl({baseUrl:a})},h),{getAligned:function(e,s){return n.__assign({url:i._getUrl({baseUrl:a,desiredSize:e,alignment:s,width:t,height:r})},h)}})}};e.prototype.canProvideThumbnail=function(e){if(!e)return!1;"."===(e=e.toLowerCase())[0]&&(e=e.substring(1));return!o[e]&&(!!s.default.isFeatureEnabled(t.UseThumbnailService)||!!s.default.isFeatureEnabled(t.ExpandThumbnailSupport)&&(!!e&&!u[e]))};e.prototype._getUrl=function(e){var t,n=e.desiredSize,s=void 0===n?{width:1024,height:1024}:n,o=e.alignment,u=e.width,a=e.height;o&&(o.name===r.coverCenter.name?t="fill":o.name===r.fitWidth.name+"-"+r.top.name&&(t="dochead"));var f={width:Math.ceil(s.width),height:Math.ceil(s.height),srcWidth:u||"",srcHeight:a||""};t&&(f.cropMode=t);return e.baseUrl+"&"+i.serializeQuery(f)};return e})();t.default=f});
define("Wq",["require","exports","W2"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return n.parseTokenPayload(e)}t.parseToken=r;function i(e){try{return new Date(parseInt(e+"000",10))}catch(e){}}t.getDate=i;t.isTokenExpired=function(e,t){void 0===t&&(t=0);if(!e.expiry){var n=r(e.authToken);e.expiry=n&&i(n.exp)}return(e.expiry?e.expiry.getTime():0)-Date.now()<t}});
define("See",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"})(n||(n={}));t.default=n});
define("Qq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var i=void 0,s=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){i=0;s=parseInt(e,16)}else{i=parseInt(e.slice(0,-8),16);s=parseInt(e.slice(-8),16)}if(!isNaN(i)&&!isNaN(s)){n.High=i;n.Low=s}}return n};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}})(n=t.Double||(t.Double={}));t.default=n});
define("Vne",["require","exports","ww","zne"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("uB",["require","exports","he","W","_e"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=i.ResultTypeEnum;t.Action=n.createPairedEvent({eventName:"Action,Qos,",shortEventName:"Action",samplingFeature:{ODB:!0,ODC:"ActionEventLogging",Fallback:!1}},{pageType:1,queryType:1,logStartEnd:3},r.Qos);t.default=t.Action});
define("sw",["require","exports","ww","dw","A3","cw","Nx","I"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=window.history,f=window.applicationCache,l=a&&!!a.pushState&&(!f||f.status===f.UNCACHED),c=(function(){function e(e){void 0===e&&(e={});this._viewParamsString="";this._dontBlockNextNav=!1;var t=e.disableHashConversion,n=void 0!==t&&t;this._performHashConversion=!n;this.viewParams={};this._scope=new u.default;this.beforeUnload=new r.default;this._scope.attach(this.beforeUnload);this._events=new i.default(this);this._events.declare("change");this._events.on(window,"hashchange",this._updateUrlState);this._events.on(window,"popstate",this._updateUrlState);this._updateUrlState(null)}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.navigateTo=function(e){var t=this;if(this.beforeUnload.allowHashNav(function(){return t.navigateTo(e)},null)){var n="string"==typeof e?{url:e}:e,r=n.url,i=e.hasOwnProperty("viewParams")?e.viewParams:null,s=e.hasOwnProperty("directOpen")?e.directOpen:null,o=void 0,u=void 0;if(i&&"#"===i[0]){o=i.substr(1);u=r}else{o="#"===r[0]?r.substr(1):null;u=null}if(o)n.ignoreHistory?this._replaceState(o,!1,u):this._pushState(o,u);else{var a=void 0,f=!1;if(n&&n.frameId&&"_self"!==n.frameId)try{a=window.open(s?r:"",n.frameId);"_blank"===n.frameId&&(a.opener=null);s||(a.location.href=r);f=!0}catch(e){}if(!a&&!f)try{window.location.href=r}catch(e){}}}};e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});var r="string"==typeof e?o.deserializeQuery(e):e,i=n.__assign(n.__assign({},t.clearOtherParams?{}:this.viewParams),r);t.ignoreHistory?this._replaceState(i,t.clearPath):this._pushState(i)};e.prototype.reload=function(){window.location.reload()};e.prototype._updateUrlState=function(e){var t=this,n=!1,r=window.document.location,i=!1;if(this._dontBlockNextNav||this.beforeUnload.allowHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()})){this._dontBlockNextNav=!1;var u="";if(r.href.indexOf("#")>-1){u=r.hash.substr(1);i=!0}else r.search.length&&(u=r.search.substr(1));var a=this._tryGetViewParamsBasedOnState(e),f=o.deserializeQuery(u),c=o.deserializeQuery(a),h=c,p=a;for(var d in f)if(c[d]!==f[d]){h=f;p=u;break}if(p!==this._viewParamsString){this._viewParamsString=p||"";this.viewParams=h;n=!0}i&&this._performHashConversion&&l&&this._replaceState(p);if(n){s.Nav.logData({url:r.href,viewParams:this.viewParams});this._events.raise("change")}this._prevHash=r.hash}else{n=!1;e&&e.preventDefault()}return n};e.prototype._tryGetViewParamsBasedOnState=function(e){var t=null;if(e&&"popstate"===e.type&&e.state){var n=e.state,r=n.useViewParamsFromState,i=n.viewParams;r&&i&&(t=this._getViewParamsString(i))}return t};e.prototype._resetBeforeNavBlock=function(){this._dontBlockNextNav=!0;if(l)try{history.forward()}catch(e){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)};e.prototype._pushState=function(e,t){var n=this._getViewParamsString(e);if(l)try{history.pushState({},null,this._getStateUrl(n))}catch(e){this._hashNav(n)}else this._hashNav(n);this._updateUrlState(null);t&&this._setMaskUrl(t)};e.prototype._replaceState=function(e,t,n){var r=this._getViewParamsString(e);if(l)try{history.replaceState({},null,this._getStateUrl(r,t))}catch(e){this._hashNav(r)}else this._hashNav(r);this._updateUrlState(null);n&&this._setMaskUrl(n)};e.prototype._setMaskUrl=function(e){if(e&&l){var t={useViewParamsFromState:!0,viewParams:this.viewParams};history.replaceState(t,null,e)}};e.prototype._getViewParamsString=function(e){return"string"==typeof e?e:o.serializeQuery(e)};e.prototype._getStateUrl=function(e,t){return(t?"/":document.location.pathname)+(e.length>0?"?":"")+e};e.prototype._hashNav=function(e){document.location.hash=e};return e})();t.Navigation=c;t.default=c});
define("ow",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VALUE_KEY="value";var n=(function(){function e(){}e.prototype.getState=function(e){return this._getNormalizedWindowName()[e]};e.prototype.setState=function(e,t){var n=this._getNormalizedWindowName();n[e]=t;window.name=JSON.stringify(n)};e.prototype.removeState=function(e){var t=this._getNormalizedWindowName(),n=t[e];delete t[e];window.name=JSON.stringify(t);return n};e.prototype._getNormalizedWindowName=function(){var e,n;try{n=JSON.parse(name)||{}}catch(e){n={}}"object"!=typeof n&&(n=((e={})[t.VALUE_KEY]=n,e));return n};return e})();t.default=n});
define("lO",["require","exports","Le","U4"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(){return new Promise(function(t,n){e(["n"],t,n)})}var s=(function(){function e(){}e.Init=function(e,t,s){void 0===s&&(s=i);(t.forceEnabled||n.default.isFeatureEnabled(this.EnableAriaLogging))&&s().then(function(n){r.default.Init(e,t,n)},function(e){})};Object.defineProperty(e,"logStartEvents",{get:function(){return r.default.logStartEvents},set:function(e){r.default.logStartEvents=e},enumerable:!0,configurable:!0});e.getAriaTimeZone=function(e){var t=Math.abs(e),n=t%60,r=Math.floor(t/60);return(e>0?"-":"+")+(r>=10?r:"0"+r)+":"+(n>=10?n:"0"+n)};e.EnableAriaLogging={ODB:588,ODC:"EnableAriaLogging",Fallback:!1};return e})();t.default=s});
define("U4",["require","exports","ww","pe","ue","j4","fe","jv","N4","Te","H4","F4","A"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p,d="AriaBeacon",v={logStartEvents:!1,Init:function(e,t,n,r){void 0===r&&(r={});try{v.logStartEvents=!0;var u=g(t,r.platformDetection),l=new f.SimpleUri(t.completenessCallbackEndpoint),c={telemetryTenantToken:e,appVersion:t.version,environment:t.environment,workload:t.workload,farmLabel:t.farmLabel,farmName:t.farmName,callbackEndpoint:l},y=(p=new m({ariaLoader:function(){return h.default.resolve(n)},context:u,tenantToken:e,disableCookies:t.disableCookies,ariaLogConfiguration:{collectorUrl:t.collectorUrl},logStartEvents:v.logStartEvents,ariaQos:{isQosEvent:function(e){return s.Beacon.isTypeOf(e)&&!!e.data&&e.data.name===d},reportQos:function(e){var t=e.result,n=e.statusCode,r=e.events;new s.Beacon({name:d,retryCount:0,totalRetries:0,eventCount:r?r.length:0}).end({success:0===t,status:n+""});0;""!==l.authority&&new a.DataCompletenessInfo(c,t,n,(new Date).getTime(),r).send()}}})).attach(i.Manager);return function(){y();p=void 0}}catch(e){e instanceof n.Exception&&(e=new Error("Aria error: "+e.toString()));o.default.log(e);p=void 0;return function(){}}},updateContext:function(e,t){void 0===t&&(t={});if(p){var n=g(e,t.platformDetection);p.updateContext(n)}},isInitialized:function(e){return!!p}};t.default=v;var m=c.withPrivacyClassification("requiredService")(l.AriaTelemetryHandler);function g(e,t){void 0===t&&(t=new u.default);return n.__assign({AccountType:r.AccountType[e.accountType],BrowserIsMobile:t.isMobile,BrowserIsPWA:t.isPWA,BrowserMajVer:t.browserMajor,BrowserMinVer:t.browserMinor,BrowserName:t.browserName,BrowserUserAgent:t.userAgent,Environment:e.environment,FarmLabel:e.farmLabel,FarmName:e.farmName,IsAuthenticated:e.isAuthenticated?1:0,Market:e.market,Manifest:e.manifest,OSName:t.osName,OSVersion:t.osVersion,Session:e.session,SiteSubscriptionId:e.siteSubscriptionId||"",UserId:e.userId,Version:e.version,Workload:e.workload,SiteId:e.siteId,WebId:e.webId,WebTemplateId:e.webTemplateId},e.context||{})}});
define("s2",["require","exports","C"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t,r=e.adjustRetries,i=e.async,s=e.beforeRetry,o=e.callback,u=e.canRetry,a=void 0===u?function(){return!0}:u,f=e.delay,l=e.resetAttemptsOnRestart,c=e.retries,h=e.shouldRestart,p=0,d=new n.default(function(){t.cancel()});function v(e){if(h&&h()){l&&(p=0);g()}else d.complete(e)}function m(e){r&&(c=r(e));if(p<c&&a(e)){p++;s&&s();"number"==typeof f&&i?i.setTimeout(g,f):g()}else d.error(e)}function g(){(t=o()).then(v,m)}g();return d.getPromise()}});
define("Kk",["require","exports","A","C"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).then(this._promiseComplete,this._promiseComplete)}else{var i={callback:e,signal:null,canceled:!1,result:null};i.signal=new r.default(function(){i.canceled=!0;n.default.is(i.result)&&i.result.cancel()});this._queue.push(i);t=i.signal.getPromise()}return n.default.resolve(t)};e.prototype._promiseComplete=function(){var e=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;if(t){this._running++;t.result=t.callback();t.result.then(function(n){t.signal.complete(n);e._promiseComplete()},function(n){t.signal.error(n);e._promiseComplete()})}}};return e})();t.default=i});
define("$Z",["require","exports","A","C"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[],s=(function(){function e(e,t,n){this.complete=!1;this.pending=!1;this.eventName="cookieToss";this._lastAttempt=0;this.domainRegex=e;this.iframeSrc=t;this.complete=n}e.initializeAuthenticators=function(t,n){if(n)if(window.$Config.aadClientId&&"live.com"===window.$Config.domain);else{for(var r=n.s,s=n.r,o=0;r&&o<r.length;o++)i.push(new e(t[o],r[o],!s[o]));n.c=function(e){i[e].onAuthComplete()};e.authenticate("https://livefilestore.com/");e.authenticate("https://1drv.com/")}};e.authenticate=function(e){for(var t,r=0;r<i.length;r++){var s=i[r];if(s.requiresAuth(e)){t=s.authenticate(e);break}}for(var o=[t||n.default.wrap(!0)],u=0,a=this._cookieCheckers;u<a.length;u++){var f=a[u];f.isApplicable(e)&&o.push(f.check(e))}return n.default.all(o).then(function(e){return e.reduce(function(e,t){return e&&t})})};e.registerCookieChecker=function(e){this._cookieCheckers.push(e)};e.prototype.requiresAuth=function(e){return this.domainRegex.test(e)};e.prototype.authenticate=function(e){var t=(new Date).getTime();if(t-this._lastAttempt>6e5){this._authPromise=null;this._lastAttempt=t}if(!this._authPromise){this._authPromise=new r.default;var n=document.createElement("IFRAME");n.src=this.iframeSrc;n.style.display="none";document.body.appendChild(n)}return this._authPromise.getPromise()};e.prototype.onAuthComplete=function(){this._authPromise.complete(!0)};e._cookieCheckers=[];return e})();t.default=s});
define("dw",["require","exports","fe","Yb"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){this._localHandlers=[]}e.init=function(){var e=this;if(!this._initialized){this._initialized=!0;this._originalBeforeUnload=window.onbeforeunload;window.onbeforeunload=window.__onbeforeunload=function(t){return e._handleBeforeUnload(t)}}};e.registerHandler=function(e){this._handlers.push(e)};e.unRegisterHandler=function(e){for(var t=0;t<this._handlers.length;t++)if(this._handlers[t]===e){this._handlers.splice(t,1);break}};e.dispose=function(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null};e._handleBeforeUnload=function(e){var t=void 0;if(!this._allowNavs){for(var r=0;r<this._handlers.length;r++)try{if(t=this._handlers[r](!0))break}catch(e){n.default.log(e)}if(!t&&this._originalBeforeUnload)try{t=this._originalBeforeUnload(e)}catch(e){n.default.log(e)}}return t||void 0};e.prototype.registerHashNavDialogCallback=function(e){this._hashNavDialogCallback=e};e.prototype.allowHashNav=function(t,r){var i=void 0;if(!e._isDialogOpen&&!e._allowNavs){for(var s=0;s<e._handlers.length;s++)try{if(i=e._handlers[s](!1))break}catch(e){n.default.log(e)}if(i){e._isDialogOpen=!0;this._hashNavDialogCallback(i).then(function(){e._isDialogOpen=!1;e._allowNavs=!0;e._blockNavsAgainId||(e._blockNavsAgainId=e._async.setImmediate(function(){e._allowNavs=!1;e._blockNavsAgainId=null}));t&&t()},function(){e._isDialogOpen=!1;r&&r()})}}return!i&&!e._isDialogOpen};e.prototype.registerHandler=function(t){this._localHandlers.push(t);e.registerHandler(t)};e.prototype.unRegisterHandler=function(t){for(var n=0;n<this._localHandlers.length;n++)if(this._localHandlers[n]===t){this._localHandlers.splice(n,1);break}e.unRegisterHandler(t)};e.prototype.dispose=function(){for(var t=0,n=this._localHandlers;t<n.length;t++){var r=n[t];e.unRegisterHandler(r)}};e._handlers=[];e._async=new r.default;e._initialized=!1;return e})();t.default=i;i.init()});
define("FS",["require","exports","ww","GS","zS","Ee","Oe","Le","HS","HS"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,c,h,p,d,v,m,g,y,b,w=void 0,E={ODB:1469,ODC:"ChromiumDateFix"};t.createDateStringFormatter=function(e){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){var t;return function(n){t||(t=new Intl.DateTimeFormat(x(s.default.language),e));return t.format(n)}}return function(t){return t.toLocaleDateString(x(s.default.language),e)}};t.getRelativeDateTimeStringPast=function(e,t){void 0===t&&(t=!1);return a.getRelativeDateTimeStringPast(e,x(s.default.language),t)};t.getFriendlyDateTimeStringPast=function(e,t,n,o,u){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===o&&(o=!1);var f=Date.now()-e.getTime(),l=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),c=k(l,-1),h=k(l,-6),p=u||{},d=p.displayMinutesToOneHour,v=void 0===d||d,m=p.displayHoursToOneDay,g=void 0===m||m,y=p.displayHoursInDates,b=void 0===y||y,w=p.displayShortenedWeekday,E=void 0===w||w,S=x(s.default.language);if(v&&f<-5*a.ONE_MINUTE)return e.toLocaleDateString(S,A({month:"short",day:"numeric"},o));if(f<a.TWO_MINUTES)return n?i.default.FriendlyDateTime_JustNow_withinSentence:i.default.FriendlyDateTime_JustNow_asSentence;if(v&&f<a.ONE_HOUR)return L(f,i.default.FriendlyDateTime_minutesShort,a.ONE_MINUTE);if(a.isSameDay(l,e))return g?L(f,i.default.FriendlyDateTime_hoursShort,a.ONE_HOUR):a.getRelativeDateTimeResx("Today",n);if(e>=c)return t||!b?a.getRelativeDateTimeResx("Yesterday",n):a.getRelativeDateTimeResx("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(S,A({hour:"numeric",minute:"2-digit"},o)));if(e>=h){var T=e.toLocaleDateString(S,A({weekday:"short"},o));return t?T:E||b?r.default.RelativeDateTime_DayAndTime.replace("{0}",T).replace("{1}",e.toLocaleTimeString(S,A({hour:"numeric",minute:"2-digit"},o))):e.toLocaleDateString(S,A({weekday:"long"},o))}return a.isSameYear(l,e)?S.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(S,A({month:"long",day:"numeric"},o)):e.toLocaleDateString(S,A({month:"short",day:"numeric"},o)):e.toLocaleDateString(S,A({month:"short",day:"numeric",year:"numeric"},o))};t.getRelativeDateTimeStringPastWithHourMinute=function(e){return a.getRelativeDateTimeStringPastWithHourMinute(e,x(s.default.language))};function S(){var e=l(),t=T();if(window.Intl&&window.Intl.DateTimeFormat){var n={},r={hour:"2-digit",minute:"2-digit"};h=new Intl.DateTimeFormat(e,n);p=new Intl.DateTimeFormat(e,r);if(t){n.timeZone="UTC";r.timeZone="UTC"}d=new Intl.DateTimeFormat(e,n);v=new Intl.DateTimeFormat(e,r);m=h.format;g=p.format;y=d.format;b=v.format}else{m=y=function(t){return t.toLocaleDateString(e)};g=b=function(t){return t.toLocaleTimeString(e)}}}t.getShortDisplayDate=function(e,t){if(!e)return"";m||S();var n=a.isSameDay(new Date,e);return(t?n?b:y:n?g:m)(e)};t.getFileSafeShortDate=function(e,t){if(!e)return"";m||S();return(t?y:m)(e).replace(/[:\/\\]/g,"-")};t.getFullDisplayDate=function(e,t){m||S();var n=t?y(e):m(e),r=t?b(e):g(e);return o.format(i.default.DateAndTime,n,r)};t.toLocaleDateString=function(e,t){return a.toLocaleDateString(e,x(s.default.language),t)};t.toLocaleTimeString=function(e,t){return a.toLocaleTimeString(e,x(s.default.language),t)};function x(e){if(void 0===w)try{w=u.default.isFeatureEnabled(E)}catch(e){w=!1}return w&&(function(e){void 0===C&&(function(){C={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=N;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(C[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return C[e]}return})(e)?"en":e}t.getBrowserSafeLocale=x;l=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,s.default.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var r=n[t];try{(new Date).toLocaleDateString(r);e=r;break}catch(e){}}e=x(e);l=function(){return e};return e};function T(){if(void 0===c)try{var e=l();(new Date).toLocaleDateString(e,{timeZone:"UTC"});c=!0}catch(e){c=!1}return c}var N=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],C=void 0;function k(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function L(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function A(e,t){return T()&&t&&e?n.__assign(n.__assign({},e),{timeZone:"UTC"}):e}n.__exportStar(f,t)});
define("tM",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.base64ToString=function(e){return decodeURIComponent(escape(atob(e)))}});
define("_4",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/[<>&'"\\]/g,r={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","\\":"&#92;"};function i(e){return r[e]}var s=(function(){function e(){}e.encodeText=function(e){return e?e.replace(n,i):""};return e})();t.default=s});
define("bH",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.none=0]="none";e[e.replace=1]="replace";e[e.optional=2]="optional";e[e.remove=3]="remove";e[e.backup=4]="backup"})(t.GraftOperationType||(t.GraftOperationType={}));t.remove=function(){return{graftOperationType:3}};t.optional=function(e){return{graftOperationType:2,value:e}};t.backup=function(e){return{graftOperationType:4,value:e}};t.replace=function(e){return{graftOperationType:1,value:e}};t.default=function e(t,l){if(!r(t))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!r(l))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(l===t)return t;for(var c=0,h=Object.keys(l);c<h.length;c++){var p=h[c],d=l[p],v=t[p];if(d!==v){var m=d;if(o(m))if(1===m.graftOperationType){v=void 0;d=g=m.value}else if(u(m)){var g=m.value;if(void 0!==t[p])continue;d=g}else{if(!f(m)){if(a(m)){delete t[p];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(g=m.value))continue;d=g}var y=void 0;if(i(d))y=new Date(d.getTime());else if(s(d)){var b=v;s(b)||(b=[]);b.splice.apply(b,n.__spreadArrays([0,b.length],d));y=b}else if(r(d)){var w=v;r(w)||(w={});e(w,d);y=w}else y=d;t[p]=y}}return t};function r(e){return"object"==typeof e&&!!e}function i(e){return e instanceof Date}function s(e){return Array.isArray(e)}function o(e){return r(e)&&!!e.graftOperationType}function u(e){return 4===e.graftOperationType}function a(e){return 3===e.graftOperationType}function f(e){return 2===e.graftOperationType}});
define("bTe",["require","exports","C"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.request=function(e){var t=new n.default,r=document.createElement("img");r.onload=function(){t.complete()};r.onerror=function(){t.error()};r.src=e;return t.getPromise()}});
define("vH",["require","exports","Le"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i={ODB:563,ODC:null,Fallback:!1};(function(e){e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))};function t(e){return"url"===e||"website"===e}e.isShortcutFileType=t;e.isShortcutEnabled=function(){return n.default.isFeatureEnabled(i)};(function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"})(e.ShortcutErrors||(e.ShortcutErrors={}))})(r||(r={}));t.default=r});
define("dO",["require","exports","Be"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["guestaccesstoken","access_token","prooftoken","tempauth","share","auth_token","auth_key","originalPath","querytext","querytemplate","selectproperties","hithighlightedproperties","refiners","sortlist","refinementfilters","collapsespecification","hiddenconstraints","querytemplatepropertiesurl","zerotermsuggestions","pageinfo","immediacyquerystring","immediacytitle","immediacyurl","k","q","InplaceSearchQuery","Default"],i=["/_api/search/","/_api/searchsetting/","/results.aspx","/osssearchresults.aspx","/peopleresults.aspx","/conversationresults.aspx","/videoresults.aspx","/sharepoint.aspx","/search.aspx","RenderListDataAsStream"],s=/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/gi;t.cleanString=function(e,t,o){o&&o.isKey&&(e=e.replace(s,"<guid>"));if(e.indexOf("http")<0)return e;var u=new n.default(e);if(""===u.getAuthority())return e;for(var a=e,f=!1,l=0;l<i.length;l++)if(u.getPath().indexOf(i[l])>=0){f=!0;break}if(f)a=u.getScheme()+"://"+u.getAuthority()+u.getPath()+"<scrubbedquerystring>...";else{for(var c=u.getQueryAsObject(),h=0;h<r.length;h++){var p=r[h];c[p]&&(c[p]="<scrubbed>")}u.setQueryFromObject(c);a=u.getDecodedStringForDisplay()}return a}});
define("N4",["require","exports","B4","fe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t,n,r,i){this._endpointUrl=e.callbackEndpoint.authority+e.callbackEndpoint.path;var s={};if(i)for(var o=0;o<i.length;++o)s[i[o].EventType]=s[i[o].EventType]+1||1;var u={TelemetryTenantId:e.telemetryTenantToken.substring(0,32),AppVersion:e.appVersion,EventType:t,StatusCode:n,EventCount:i?i.length:0,Timestamp:r,Environment:e.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:s,Workload:e.workload||"",FarmLabel:e.farmLabel||"",FarmName:e.farmName||""};this._dataCompletenessJson=JSON.stringify(u)}Object.defineProperty(e.prototype,"endpointUrl",{get:function(){return this._endpointUrl},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"dataCompletenessJson",{get:function(){return this._dataCompletenessJson},enumerable:!0,configurable:!0});e.prototype.send=function(){new n.default({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start(function(e,t){},function(e,t,n){0})};return e})();t.DataCompletenessInfo=i});
define("crt",["require","exports","bv"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}e.registerClicks=function(t){if(t&&!e._appDictionary[t]){e._appDictionary[t]=!0;document&&document.body&&document.body.addEventListener("click",function(e){var t=e.target;if(t){var r=t.getAttribute("data-logging-id");r&&n.Engagement.logData({name:r+".Click"})}},!0)}};e._appDictionary={};return e})();t.EngagementHelpers=r});
define("ZC",["require","exports","ue","aO","nO","tO","A2","$C","pe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});0});
define("sO",["require","exports","ie","Le","cO"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.Manager.addFeatureEnabler(function(e){return r.default.isFeatureEnabled(e)})});
define("uO",["require","exports","fO","sO"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(function(){function e(){}e.init=function(){r||(r=n.PageInit.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0}));return r};return e})();t.default=i});
define("iO",["require","exports","fe","Yb","A","A3","je","rO"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=new((function(){function e(){this._outstandingPromiseErrors={};this._async=new r.default}e.prototype.log=function(e){var t=this,r=e.id;if(e.parent)e.handler&&delete this._outstandingPromiseErrors[r];else{this._outstandingPromiseErrors[r]=e;1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(function(){var e=t._outstandingPromiseErrors;t._outstandingPromiseErrors={};Object.keys(e).forEach(function(t){var r=e[t],s=r.exception?r.exception:r.error;s instanceof Error||s&&s.stack?i.default.isCanceled(r)||n.default.log(s):u.UnhandledPromise.logData({message:"Promise with no error callback",extraData:o.safeSerialize(s)});if(window.console&&console.log){var a="Promise with no error callback:"+r.id;console.warn?console.warn(a):console.log(a);console.log(r);s&&s.stack&&console.log(s.stack)}})},0)}};return e})());new s.default(a).on(i.default,"error",a.log)});
define("xw",["require","exports","Cw","ue","W","nO","A2","aO","ve","fe"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;(function(e){e[e.AppLoad=0]="AppLoad";e[e.PLT=1]="PLT";e[e.SessionError=2]="SessionError"})(l=t.Stages||(t.Stages={}));var c=!1,h=!1,p=-1;function d(){p===l.SessionError-1&&y.markStage(l.SessionError)}function v(e){if(i.Qos.isTypeOf(e)){if(e.data.resultType===i.ResultTypeEnum.Failure){h=!0;d();c=!0}}else if(s.default.isTypeOf(e)||o.default.isTypeOf(e)||u.default.isTypeOf(e)){h=!0;d();c=!0}else if(a.default.isTypeOf(e)){y.markStage(l.PLT);c&&d()}}for(var m=0,g=r.Manager.addLogHandler(v);m<g.length;m++){v(g[m])}var y=(function(){function e(){}e.markStage=function(e){if(e-1===p||e===l.AppLoad){n.default.logData({stage:l[e],errorBeforeStage:c,errorDuringStage:h});h=!1;p=e}else try{throw new Error("Stage "+l[e]+" - "+e+" came out of order - previous stage "+l[p]+" - "+p)}catch(e){f.default.log(e)}};e.reset=function(){p=-1;c=!1;h=!1};return e})();t.default=y;y.markStage(l.AppLoad)});
define("o2",["require","exports","Te"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRequestEntryDurationMetrics=function(e,t,r){var i,s,o,u,a,f,l,c=r||window;if(!(c&&c.performance&&e&&t))return{duration:-1};try{var h=performance.getEntriesByType("resource");if(!new n.SimpleUri(e).authority){e=(c.location&&new n.SimpleUri(c.location.href).authority)+e}for(var p=void 0,d=h.length-1;d>=0;d--){var v=h[d];if(v.startTime<t)break;decodeURIComponent(v.name)===decodeURIComponent(e)&&(p=v)}if(p){return s=(i=p).connectEnd,o=i.connectStart,u=i.decodedBodySize,a=i.domainLookupend,f=i.domainLookupStart,l=i.duration,{connectEnd:s,connectStart:o,decodedBodySize:u,domainLookupend:a,domainLookupStart:f,duration:void 0===l?-1:l,encodedBodySize:i.encodedBodySize,fetchStart:i.fetchStart,nextHopProtocol:i.nextHopProtocol,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,secureConnectionStart:i.secureConnectionStart,startTime:i.startTime,transferSize:i.transferSize,workerStart:i.workerStart}}return{duration:-1}}catch(e){return{duration:-1}}}});
define("oO",["require","exports","aO"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=10,i=50;t.MAXERRORS=100;var s=0;function o(e){var t;if(e){var n=e&&e.toString?e.toString():"InvalidMethod()",r=8===n.indexOf(" ")?9:0,s=n.indexOf(")")+1;if(0===(t=n.substring(r,s)).indexOf("function")||t.indexOf("(")<3){var o=s+i;t=(function(e,t){e&&e.length>t&&(e=e.substr(0,t-3)+"...");return e})(n=n.replace(/\s\s*/g," "),o)+(o<n.length?"}":"")}}return t}function u(e,i,a,f,l){try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[e,i,a,f,l])}catch(e){}var c=l&&l.stack,h=(function e(){var t,n=[];try{t=arguments.callee;for(;t===u||t===e;)t=t?t.caller:t}catch(e){t=null}var i=0;try{for(;t&&i<r;){n.push(o(t));t=t.caller;i++}}catch(e){}return n})().join("\n"),p={message:e,url:i,line:a,col:f,stack:c=c?c.replace(/[ \t]{2,}/g," "):"",builtStack:h=h.replace(/[ \t]{2,}/g," ")};s<t.MAXERRORS?n.UnhandledError.logData(p):s===t.MAXERRORS&&n.UnhandledError.logData({message:"Hit max error limit of "+t.MAXERRORS,url:"NA",line:0,col:0,stack:"",builtStack:""});s++}t.handleOnError=u;window.onerror=u});
define("UDe",["require","exports","dB"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.clickEngagementPart=new n.EngagementPart("Click",4);t.keyPressEngagementPart=new n.EngagementPart("KeyPress",4);t.dropEngagementPart=new n.EngagementPart("Drop",4)});
define("j4",["require","exports","he"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Beacon=n.createPairedEvent({eventName:"Beacon,",shortEventName:"Beacon",requiresParent:!1},{name:1,status:1,success:3,retryCount:2,totalRetries:2,eventCount:2});t.default=t.Beacon});
define("nO",["require","exports","ww","ae","ae"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.CaughtError});
define("cw",["require","exports","ge"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Nav=n.createSingleEvent({eventName:"Nav,",shortEventName:"Nav"},{viewParams:4,url:1});t.default=t.Nav});
define("fO",["require","exports","ge"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PageInit=n.createSingleEvent({eventName:"PageInit,",shortEventName:"PageInit",requiresParent:!1},{screenWidth:2,screenHeight:2,availableScreenWidth:2,availableScreenHeight:2,renderWidth:2,renderHeight:2,browserWidth:2,browserHeight:2,devicePixelRatio:2,referrer:1});t.default=t.PageInit});
define("Cw",["require","exports","ge"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Qoe=n.createSingleEvent({eventName:"Qoe,",shortEventName:"Qoe",requiresParent:!1},{stage:{isKey:!0,type:1},errorBeforeStage:3,errorDuringStage:3});t.default=t.Qoe});
define("tO",["require","exports","ww","ne","ne"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.QosError});
define("Vv",["require","exports","ww","zv","zv"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.RUMOneDataUpload});
define("aO",["require","exports","ge"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UnhandledError=n.createSingleEvent({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0,requiresParent:!1},{message:1,stack:1,builtStack:1,line:2,col:2,url:1,privacyClassification:{isPrefixingDisabled:!0,type:1}}).withData({privacyClassification:"requiredService"});t.default=t.UnhandledError});
define("rO",["require","exports","ge"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UnhandledPromise=n.createSingleEvent({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise",samplingFeature:{ODB:!0,ODC:"UnhandledPromiseLogging",Fallback:!1},requiresParent:!1},{message:1,extraData:1}).withData({privacyClassification:"requiredService"});t.default=t.UnhandledPromise});
define("lB",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Click=1]="Click";e[e.Tap=2]="Tap";e[e.Keyboard=3]="Keyboard";e[e.Drop=4]="Drop"})(t.UsageType||(t.UsageType={}))});
define("$C",["require","exports","ww","eO","eO"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.ValidationError});
define("eS",["require","exports","ww","$","$"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.Verbose});
define("trt",["require","exports","Mv"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n.APICallPerformanceData});
define("Pv",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.global="undefined"==typeof window?self:window;(function(e){e[e.xhr=0]="xhr";e[e.fetch=1]="fetch"})(t.APICallType||(t.APICallType={}));var n=(function(){function e(){this._requestIdGenerator=(e=0,function(){return(e++).toString()});var e}e.prototype.instrument=function(e){var n=this;if(!t.global.__RUMOneAPITrackerInstrumented){t.global.__RUMOneAPITrackerInstrumented=!0;var r=e.fetch,i=e.xhr;if("XMLHttpRequest"in t.global&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send;this._originalXhrOpen=XMLHttpRequest.prototype.open;var s=this;XMLHttpRequest.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.requestUrl=e[1];return s._originalXhrOpen.apply(this,e)};XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=s._requestIdGenerator();i.onRequest({request:this,id:r,type:0});this.addEventListener("readystatechange",function(){4===e.readyState&&i.onResponse({request:e,id:r,type:0})});return s._originalXhrSend.apply(this,t)}}if("fetch"in t.global&&void 0!==t.global.fetch){this._originalFetch=t.global.fetch.bind(t.global);t.global.fetch=function(e,t){return new Promise(function(i,s){var o=n._requestIdGenerator();r.onRequest({request:e,id:o,type:1});n._originalFetch(e,t).then(function(e){r.onResponse({response:e,id:o,type:1});i(e)},function(e){s(e)})})}}}};e.prototype.undoInstrument=function(){t.global.__RUMOneAPITrackerInstrumented=!1;this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen);this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend);this._originalFetch&&(t.global.fetch=this._originalFetch)};return e})();t.RUMOneAPITracker=n});
define("kv",["require","exports","Mv"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n.ControlPerformanceData});
define("Gv",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e[e.fullPageLoad=4]="fullPageLoad";e[e.onePageAppNavigation=5]="onePageAppNavigation"})(n||(n={}));t.default=n});
define("Mv",["require","exports","ww","Yb","Gv","Vv","jv","le","Tv","Pv","Be","Te"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h,p;(function(e){e[e.Incomplete=1]="Incomplete";e[e.ReadyToUpload=2]="ReadyToUpload";e[e.Uploaded=3]="Uploaded";e[e.TimeOut=4]="TimeOut";e[e.Skipped=5]="Skipped"})(h||(h={}));(function(e){e[e.own=0]="own";e[e.cors=1]="cors"})(p=t.APICallHostType||(t.APICallHostType={}));var d=function(e,t,n,r,i,s,o){this.url=e;this.duration=t;this.correlationId=n;this.status=r;this.startTime=i;this.endTime=s;this.name=o;this.clientDurationInMilliseconds=new Date(s).getTime()-new Date(i).getTime();this.origin=e&&new l.default(e).getHost()};t.APICallPerformanceData=d;var v=["EUPL","ScenarioId"],m=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,g=function(e,t,n,r,i,s,o){this.controlId=e;this.startTime=t;this.endTime=n;this.renderTimeCalculator=r;this.renderTimeRequiredDataChecker=i;this.ignoreForEUPL=void 0===s||s;this.needFlatten=void 0!==o&&o};t.ControlPerformanceData=g;function y(e){return null==e}var b={checkInterval:100,error_timeout:3e4,max_markers:200},w=(function(){function e(e,t,n){void 0===n&&(n=b);this._keyMetrics=v.slice(0);this.async=new r.default(this);this.dataStartTime=Date.now();this._rumoneData={};this.dataState=h.Incomplete;this.controls=[];this.apis=[];this._apiBuffer={};this._loggingFunctions=[];this.euplBreakDown={};this.ttiBreakDown={};this.serverMetrics={};this.isW3cTimingCollected=!1;this.isW3cResourceTimingCollected=!1;this.tempData={};this._settings={};this._emergencyUpdateFunc=this._emergencyUpload.bind(this);this._name=e;this.registerLoggingFunc(t);this._config=n;this.setPerfDataTimer();this._platformDetection=new o.default;this._hookUnloadEvent();this._apiTracker=new f.RUMOneAPITracker}e.getRUMOneLogger=function(t,n,r){void 0===t&&(t="__default_rumone__");void 0===r&&(r=b);var i=n||function(e,t){s.RUMOneDataUpload.logData({streamName:e,dictionary:t})};if(!e.Loggers[t])try{var o=new e(t,i,r);"__default_rumone__"===t&&(e.rumOneLogger=o);e.Loggers[t]=o}catch(e){}return e.Loggers[t]};e.prototype.registerLoggingFunc=function(e){var t=this,n=this._loggingFunctions.indexOf(e);n<0&&this._loggingFunctions.push(e);return function(){n>=0&&t._loggingFunctions.splice(n,1)}};Object.defineProperty(e.prototype,"KeyMetrics",{get:function(){if(this._TTIMeasurementEnabled()){this.addExpectedKeyMetric("TTI");this.addExpectedKeyMetric("FCI")}return this._keyMetrics},enumerable:!0,configurable:!0});e.prototype.getPerformanceData=function(){return this._rumoneData};e.prototype.startAPIMeasurement=function(e){var t=this,r=e&&e.ignore||function(e){return!1},i=e&&e.getAPIName||function(e){},s=function(e){var n=e.id,r=e.request,i=e.type,s=new d;s.startTime=(new Date).toISOString();s.startTimeRelative=t.now();1===i&&(s.url="string"==typeof r?r:r.url);t._apiBuffer[n]=s};this._apiTracker.instrument({fetch:{onRequest:s,onResponse:function(e){var s=e.response,o=e.id,u=t._apiBuffer[o];if(u&&!r(u.url)){var a=void 0;try{a=s.headers.get("SPClientServiceRequestDuration")}catch(e){}var f=void 0;try{f=s.headers.get("SPRequestGuid")}catch(e){}u.name=i(u.url);u=n.__assign(n.__assign({},u),n.__assign(n.__assign({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-u.startTimeRelative,status:s.status},a?{duration:Number(a)}:{}),f?{correlationId:f}:{}));t.apis.push(u)}}},xhr:{onRequest:s,onResponse:function(e){var s=e.request,o=e.id,u=t._apiBuffer[o],a=s.responseURL||s.requestUrl;if(u&&!r(a)){var f;f=s.getResponseHeader("SPClientServiceRequestDuration");var l;l=s.getResponseHeader("SPRequestGuid");u.name=i(a);u=n.__assign(n.__assign({},u),n.__assign(n.__assign(n.__assign({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-u.startTimeRelative,status:s.status},f?{duration:Number(f)}:{}),l?{correlationId:l}:{}),{url:a}));t.apis.push(u)}}}});return function(){t._apiTracker.undoInstrument()}};e.prototype.resetLogger=function(){this._emergencyUpload();this._apiBuffer={};this.dataStartTime=(new Date).getTime();this.dataState=h.Incomplete;this.isW3cTimingCollected=!1;this.isW3cResourceTimingCollected=!1;this.controls=[];this.apis=[];this.tempData={};this._rumoneData={};this._settings={};this._keyMetrics=v.slice(0);this.clearPerfDataTimer();this.setPerfDataTimer();this.euplBreakDown={};this.ttiBreakDown={};this.serverMetrics={};this.clearResourceTimings();u.clearMarks(this._getOwnMakers().map(function(e){return e.name}));e._markers[this._name]=[];this._unhookUnloadEvent();this._hookUnloadEvent();this._ttiPromise=void 0;this._fciPromise=void 0;this.logMessageInConsole("Reset performance Logger Done")};e.prototype.setSettings=function(e){this._settings=n.__assign(n.__assign({},this._settings),e)};e.prototype.excludePageForPerfData=function(){this.setSettings({excludePageData:!0})};e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]};e.prototype.setPerformanceDataPropertyValue=function(e,t){if(e&&m.test(e)){this._rumoneData[e]=t;return!0}console.error("key "+e+" does not confrim to the Regex "+m);return!1};e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t)};e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return this.controls.filter(function(e){return e.controlId===t.controlId}).length>0};e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e};e.prototype.writeServerUrl=function(){this._rumoneData.ServerUrl=this._processEUIIUrl(location.href)};e.prototype.writeServerSideLatency=function(e,t){if(!this.isCollected("ServerRequestDuration")){this._rumoneData.ServerRequestDuration=e;this._rumoneData.IISLatency=t}};e.prototype.writeControlPerformanceData=function(e){if(e){var t=this.controls.filter(function(t){return t.controlId===e.controlId})[0];if(t)t.data||(t.data=e);else{var n={controlId:e.controlId,data:e,ignoreForEUPL:e.ignoreForEUPL};this.controls.push(n)}}};e.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e)};e.prototype.readAPICallPerformanceData=function(){return this.apis};e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)};e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==i.default.fullPageLoad&&e!==i.default.none&&e!==i.default.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)};e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)};e.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=performance&&performance.timing;if(t){for(var n=0;n<e.length;n++){var r=t[e[n]];r&&this._logRUMOneData(this.getW3cTimingName(e[n]),Number(r))}this.isW3cTimingCollected=!0}}};e.prototype.collectW3cResourceTimings=function(){if(window.document&&!this.isW3cResourceTimingCollected&&performance&&performance.getEntriesByType){for(var e=performance.getEntriesByType("resource"),t=document.getElementsByTagName("iframe"),r=0;r<t.length;r++){var i=null;try{i=t[r].contentWindow.performance}catch(e){}i&&i.getEntriesByType&&e.concat(i.getEntriesByType("resource"))}var s={SharePoint:function(e){return 0===e.name.search(window.location.protocol+"//"+window.location.host)},CDN:function(e){var t=window._spPageContextInfo,n=e.name;return!(!t||!t.cdnPrefix||0!==n.search(window.location.protocol+"//"+t.cdnPrefix))||(!(!t||!t.cdnBaseUrl||0!==n.search(t.cdnBaseUrl))||/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net|akamai\.odsp\.cdn\.office\.net/i.test(n))},ThirdParty:function(e){return!s.SharePoint(e)&&!s.CDN(e)}},o={ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}},u=Object.keys(s);for(r=0;r<u.length;r++){var a=u[r],f=this.categorizeResourceRequests(e,{from:s[a],requestType:null});this._logRUMOneData(a+"RequestCountTotal",f.length);for(var l=Object.keys(o),c=0;c<l.length;c++){var h=l[c];this._logRUMOneData(a+"RequestCount"+h,this.categorizeResourceRequests(f,{from:null,requestType:o[h]}).length)}if(f.length>0){this._logRUMOneData(a+"RequestDownloadTime",Math.round(f.reduce(function(e,t){return e+t.duration},0)/f.length));if("CDN"===a){var p=JSON.stringify(f.map(function(e){return n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&e.length>0}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0,fetchStart:Math.round(e.fetchStart),requestStart:Math.round(e.requestStart)},E(e,"workerStart")),E(e,"connectionStart")),E(e,"connectionEnd")),E(e,"domainLookupStart")),E(e,"domainLookupEnd")),E(e,"responseStart")),E(e,"responseEnd")),E(e,"redirectStart")),E(e,"redirectEnd")),E(e,"secureConnectionStart"))}));this._logRUMOneData(a+"RequestNames",p)}}}this.isW3cResourceTimingCollected=!0}};e.prototype.saveTempData=function(e,t){this.tempData[e]=t};e.prototype.readTempData=function(e){return this.tempData[e]};e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)};e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)};e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)};e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)};e.prototype.writeAppInfo=function(e,t){this.isCollected("AppInfo")&&!t||(this._rumoneData.AppInfo=e)};e.prototype.isRunning=function(){return!(this.dataState===h.Uploaded||this.dataState===h.TimeOut||this.dataState===h.Skipped)};e.prototype.writeEUPLBreakdown=function(e,t){return this._writeBreakdown(this.euplBreakDown,e,t)};e.prototype.addEUPLBreakdown=function(e,t,n){return this._addBreakdown(this.euplBreakDown,e,t,n)};e.prototype.readEUPLBreakdown=function(e){return this._readBreakdown(this.euplBreakDown,e)};e.prototype.writeTTIBreakdown=function(e,t){return this._writeBreakdown(this.ttiBreakDown,e,t)};e.prototype.addTTIBreakdown=function(e,t,n){return this._addBreakdown(this.ttiBreakDown,e,t,n)};e.prototype.readTTIBreakdown=function(e){return this._readBreakdown(this.ttiBreakDown,e)};e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),n=0;n<e.length;n++){var r=e[n];r&&-1===t.indexOf(r)&&t.push(r)}this._rumoneData.Flights=JSON.stringify(t)}};e.prototype.collectSPClientFlights=function(e){for(var t="",n=0,r=e.ExpFeatures;n<r.length;n++){var i=r[n];t+=this._numberToBinString(i).split("").reverse().join("")}this._rumoneData.Flights=t};e.prototype.addServerMetrics=function(e,t){if(e)for(var n in e)n&&!y(e[n])&&(y(this.serverMetrics[n])||t)&&(this.serverMetrics[n]=e[n])};e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e};e.prototype.readControlPerformanceData=function(){return this.controls.filter(function(e){return!!e.data}).map(function(e){return e.data})};e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t);u.mark(t)};e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN};e.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e};e.prototype.registerErrorHandler=function(e){};e.prototype.getMarkerTime=function(e){return u.getMarkerTime(e)};e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&-1===this._keyMetrics.indexOf(e)&&this._keyMetrics.push(e)};Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{set:function(e){this.setSettings({waitOnAddingExpectedControl:e})},enumerable:!0,configurable:!0});e.prototype._measureTTI=function(){var e=this;this._rumoneData.TTISupported=a.TTIIsSupported();if(this._TTIPolyfillEnabled()&&!this._ttiPromise){this._ttiPromise=a.measureTTI(this._settings.TTISettings.TTIPolyfillSettings.options);this._ttiPromise.then(function(t){var n=t||{},r=n.tti,i=n.longTasks;if(y(r))r=NaN;else{var s=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;s&&(r=s(Math.round(r),e._rumoneData,"TTI"))}e._rumoneData.TTI=r;i&&(e._rumoneData.TTILongTasks=JSON.stringify(i))})}if(this._TTIPolyfillEnabled()&&!this._fciPromise){this._fciPromise=a.measureFCI();this._fciPromise.then(function(t){var n=t||{},r=n.fci,i=n.longTasks;if(y(r))r=NaN;else{var s=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;s&&(r=s(Math.round(r),e._rumoneData,"FCI"))}e._rumoneData.FCI=r;i&&(e._rumoneData.FCILongTasks=JSON.stringify(i))})}};e.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return""+Array(32-t.length+1).join("0")+t};e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)};e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()};e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten};e.prototype.collectMarks=function(){var e=this,t={},n=0;this._getOwnMakers().forEach(function(r){if(n<e._config.max_markers){var i=r.name.substr(u.MARKER_PREFIX.length)+".mark"+n++;t[i]=Math.round(r.startTime)}});this.writeEUPLBreakdown(JSON.stringify(t))};e.prototype._getOwnMakers=function(){var t=this,n=e._markers,r=[].concat.apply([],Object.keys(n).filter(function(e){return n.hasOwnProperty(e)&&e!==t._name}).map(function(e){return n[e]}));return u.getAllMarks().filter(function(e){return-1===r.indexOf(e.name)})};e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)};Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!0,configurable:!0});e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var n=this._name+" "+e+" : "+JSON.stringify(t);console.log(n)}};e.prototype.isCollected=function(e){return!y(this.getPerformanceDataPropertyValue(e))};e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e};e.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,this._config.checkInterval)};e.prototype.clearPerfDataTimer=function(){if(!y(this.perfDataTimer)){this.async.clearTimeout(this.perfDataTimer);this.perfDataTimer=null}};e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)};e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)};e.prototype.categorizeResourceRequests=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];t.from&&!t.from(i)||t.requestType&&!t.requestType(i)||n.push(i)}return n};e.prototype._setFCP=function(){var e=NaN,t=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(t&&t.length>0){var n=t.filter(function(e){return"first-contentful-paint"===e.name});if(n&&1===n.length)e=n[0].startTime;else{var r=t.filter(function(e){return"first-paint"===e.name});r&&1===r.length&&(e=r[0].startTime)}}isNaN(e)||(this._rumoneData.FCP=Math.round(e))};e.prototype.collectSupplementaryData=function(){this._setFCP();this.setAPIDataToRUMOne();this.collectMarks();this.writeServerUrl();this.setBrowseInfo();this.setReferrer();this._collectMemoryData();this._collectPageServerData();this._setAppInfo();this._setTestName();this._collectExperiments();this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics);this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown);this._rumoneData.TTIBreakdown=JSON.stringify(this.ttiBreakDown)};e.prototype._collectExperiments=function(){var e=window.ODSP_EXPERIMENTS||{},t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r&&r._serverTime&&Date.now()-new Date(r._serverTime).getTime()<1296e6&&(t[n]=e[n])}this._rumoneData.SPExperiments=JSON.stringify(t)};e.prototype._setTestName=function(){var e=new l.default(location.href).getQueryParameter("perftest");e&&!this._rumoneData.TestName&&(this._rumoneData.TestName=e)};e.prototype.loopForDataCompleteness=function(){this.clearPerfDataTimer();if(!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("====================================================================");this.logObjectForDebugging("RUMONE: ",this._rumoneData);this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState)));this.logObjectForDebugging("Controls: ",this.controls);this.logObjectForDebugging("API Performance Data: ",this.apis);this.logObjectForDebugging("Temp Data: ",this.tempData);this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown);this.logObjectForDebugging("TTIBreakdown: ",this.ttiBreakDown);this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics);this.logMessageInConsole("====================================================================\n\n")}if(!this.isRunning())return;this._updateState()}this._checkTimeout();this.isRunning()&&this.setPerfDataTimer()};e.prototype._updateState=function(){switch(this.dataState){case h.Incomplete:this.processControlRenderTime();this.readyToComputeEUPL()&&this.setEUPL();var e=this._getMissedControls();this._TTIMeasurementEnabled()&&this.isCollected("EUPL")&&0===e.length&&this._measureTTI();0===this._getMissedKeyMetrics().length&&0===e.length&&(this.dataState=h.ReadyToUpload);break;case h.ReadyToUpload:this._uploadPerfData({emergency:!1})}};e.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==h.ReadyToUpload){var e=Date.now();if(!(this.dataState===h.Incomplete&&e-this.dataStartTime<=this._config.error_timeout)){var t={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(t);this.dataState=h.TimeOut;this._uploadPerfData({emergency:!1})}}};e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this.KeyMetrics.length;t++){y(this.getPerformanceDataPropertyValue(this.KeyMetrics[t]))&&e.push(this.KeyMetrics[t])}return e};e.prototype._getMissedControls=function(){return this.controls.filter(function(e){return!e.data||!e.data.renderTime})};e.prototype._emergencyUpload=function(){this.isRunning()&&this._uploadPerfData({emergency:!0})};e.prototype._uploadPerfData=function(e){this.writeControlDataToRUMOne();this.collectSupplementaryData();var t,n=e.emergency;this._rumoneData.EmergencyUploaded=!!n;try{if(this._settings.excludePageData){this.dataState=h.Skipped;this.logMessageInConsole("Uploading perf data skipped as requested by the consumer")}else if(n||this.dataState===h.ReadyToUpload||this.dataState===h.TimeOut)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){var r=this.getPerformanceData();this._loggingFunctions.forEach(function(e){e("RUMOne",r)});this.dataState=h.Uploaded;if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("Final Data uploaded");this.logObjectForDebugging("RUMONE: ",r);this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState))}}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state "+this.dataState)}catch(e){t="PerformanceLogger error writing RUMOne data: "+e,"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{if(!this.isRunning()){this._unhookUnloadEvent();this._apiTracker.undoInstrument()}}};e.prototype._TTIPolyfillEnabled=function(){return!!(this._settings.TTISettings&&this._settings.TTISettings.TTIPolyfillSettings&&this._settings.TTISettings.TTIPolyfillSettings.enabled)};e.prototype._TTIMeasurementEnabled=function(){return this._TTIPolyfillEnabled()};e.prototype.getReadableDataState=function(e){for(var t in h)if(e===Number(h[t]))return t;return"NaN"};e.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime});for(var t=0;t<10&&t<e.length;t++){this._logRUMOneData("Control"+(t+1)+"Id",e[t].controlId);this._logRUMOneData("Control"+(t+1)+"RenderTime",e[t].data.renderTime)}var n={};this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){n[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}});Object.keys(n).length>0&&this.writeEUPLBreakdown(JSON.stringify(n),!0)}};e.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var n=t[e];n.data&&!n.data.renderTime&&n.data.renderTimeRequiredDataChecker(this,n.data)&&(n.data.renderTime=n.data.renderTimeCalculator(this,n.data))}};e.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter(function(e){return!e.ignoreForEUPL}),t=e.length>0,n=0,r=e;n<r.length;n++){var i=r[n];if(!i.data||!i.data.renderTime){t=!1;break}}return t};e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,n=this.controls;t<n.length;t++){var r=n[t];!r.ignoreForEUPL&&r.data&&r.data.renderTime&&e<r.data.renderTime&&(e=r.data.renderTime)}this._rumoneData.EUPL=e;"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}};e.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor;this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile};e.prototype._collectMemoryData=function(){if(!this.isCollected("UsedJSHeapSize")&&"undefined"!=typeof performance&&void 0!==performance.memory){this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize;this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize}};e.prototype._collectPageServerData=function(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})};e.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,r=[],i=0;i<this.apis.length;i++){var s=this.apis[i];if(s){e++;t+=s.duration;s.origin||(s.origin=new l.default(s.url).getHost());s.hostType=new l.default(window.location.href).getHost()===s.origin?p.own:p.cors;s.url;var o=n.__rest(s,["url"]);r.push(o)}}this._rumoneData.APICallCount=e;this._rumoneData.APICallDurationSum=t;this._rumoneData.APICalls=JSON.stringify(r)};e.prototype.setReferrer=function(){this._rumoneData.Referrer=this._processEUIIUrl(document.referrer)};e.prototype._setAppInfo=function(){if(!this._rumoneData.AppInfo){var e=window._spModuleLink;if(e){var t=e.buildNumber,n=e.manifestName,r=e.scenarioName,i=JSON.stringify({buildNumber:t,manifestName:n,scenarioName:r});this._rumoneData.AppInfo=i}}};e.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"};e.prototype._writeBreakdown=function(e,t,n){if(t)try{var r=JSON.parse(t);for(var i in r)r.hasOwnProperty(i)&&this._addBreakdown(e,i,r[i],n)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}};e.prototype._addBreakdown=function(e,t,n,r){if(t&&!y(n)){if(y(e[t])||r){var i=this._isBreakdownValue(n)?n.data:n;e[t]=i}this._isBreakdownValue(n)&&n.needFlatten&&(!this.isCollected(t)||r)&&this._logRUMOneData(t,n.data)}};e.prototype._readBreakdown=function(e,t){return t?e[t]:e};e.prototype._processEUIIUrl=function(e){var t=new c.default(e||"");return t.authority+"/{ length: "+t.path.length+", segments: "+t.segments.length+" }"};e.rumOneLogger=void 0;e.Loggers={};e._markers={};return e})();t.RUMOneLogger=w;t.default=w;function E(e,t){return t in e?{propertyName:Math.round(e[t])}:{}}});
define("Tv",["require","exports","ww","Bv","Uv"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.restartLongTaskObserver=i.restartLongTaskObserver;t.measureTTI=function(t){return n.__awaiter(this,void 0,void 0,function(){var i;return n.__generator(this,function(s){switch(s.label){case 0:i=n.__assign({minValue:r.now(),useMutationObserver:!1,trackNetworkRequests:!1,requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3},t);return[4,new Promise(function(t,n){e(["Uv"],t,n)})];case 1:return[2,s.sent().getFirstConsistentlyInteractive(i)]}})})};t.measureFCI=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t={measurementStartTime:r.now(),requiredMainThreadCPUIdleDurationInMilliseconds:1e3};return[4,new Promise(function(t,n){e(["Pq"],t,n)})];case 1:return[2,n.sent().getFirstCPUIdle(t)]}})})};t.TTIIsSupported=function(){return"PerformanceLongTaskTiming"in window}});
define("Iq",["require","exports","AS","wS"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){void 0===e&&(e=new n.default);void 0===t&&(t=1);this.translate=e;this.scale=t}e.areEqual=function(e,t,r){void 0===r&&(r=1e-6);return n.default.areEqual(e.translate,t.translate,r)&&Math.abs(Math.log(e.scale/t.scale))<r};e.zoom=function(t,n,r){return new e(t.subtract(n).scale(r-1),r)};e.centerWithinBounds=function(t,i,s){return new e(new r.default(n.default.ORIGIN,t).getCenter().subtract(n.default.getCenter([i,s])))};e.prototype.apply=function(e){return e.scale(this.scale).add(this.translate)};e.prototype.multiply=function(t){return new e(this.translate.add(t.translate.scale(this.scale)),this.scale*t.scale)};e.prototype.invert=function(){return new e(this.translate.scale(-1/this.scale),1/this.scale)};e.IDENTITY=new e;return e})();t.default=i});
define("Jy",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.splitFileName=function(e){var t=n(e);return{name:t?e.substring(0,e.length-t.length):e,extension:t}};function n(e,t){void 0===t&&(t=!1);var n="";if(e){var r=e.lastIndexOf(".");r>=0&&(n=t?e.substr(r+1):e.substr(r))}return n}t.getFileExtension=n;t.encodePath=function(e,t){void 0===t&&(t=!0);e=encodeURI(e);t&&e&&(e=e.replace(/#/g,"%23"));return e}});
define("Bv",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.now=function(){return window.performance&&performance.now?Math.round(performance.now()):Date.now()};t.mark=function(e){window.performance&&performance.mark&&performance.mark(e)}});
define("qD",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e[e.encodeUrl=1]="encodeUrl";e[e.encodeCommand=2]="encodeCommand"})(n=t.ProtocolHandlerEncodeOption||(t.ProtocolHandlerEncodeOption={}));var r=(function(){function e(){}e.CreateProtocolHandlerUrl=function(e,t,r,i,s,o){var u=[],a=e.split("|");if(2===a.length){u.push(a[0]);u.push(":");u.push(t);return u.join("")}3===a.length&&(e=a[0]);u.push(e);u.push(":");u.push(r);o&&"ms-excel"===e&&r!==this.protocolCommand.New&&u.push(s===n.encodeCommand?"%7Cofc":"|ofc");u.push(s===n.encodeCommand?"%7Cu%7C":"|u|");u.push(t);if(r===this.protocolCommand.New){u.push(s===n.encodeCommand?"%7Cs%7C":"|s|");u.push(i)}var f=u.join("");return s===n.encodeUrl?encodeURI(f):f};e.protocolCommand={View:"ofv",Edit:"ofe",New:"nft"};return e})();t.ProtocolHandlerHelper=r;t.default=r});
define("lie",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.addConfig=function(e){window.require.config(e)};e.addPaths=function(e){window.require.config({paths:e})};e.addShims=function(e){window.require.config({shim:e})};return e})();t.default=n});
define("ZS",["require","exports","Tm","Ee"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=1024,o=1048576,u=1073741824,a=1099511627776,f=1.2.toLocaleString(r.default.language).replace(/\d+/g,""),l=/\.?0+$/;(function(e){e.getDisplayString=function(e,r){void 0===r&&(r={});if("number"!=typeof e||isNaN(e)||r.ignoreZero&&0===e||e<0)return"";var i=r.trimDecimal;return 1===e?n.default.fileSizeBytesSingular:e<s?t(n.default.fileSizeBytesPlural,e,i):e<1e3*s?t(n.default.fileSizeKB,e/s,i):e<1e3*o?t(n.default.fileSizeMB,e/o,i):e<1e3*u?t(n.default.fileSizeGB,e/u,i):t(n.default.fileSizeTB,e/a,i)};function t(e,t,n){return e.replace("{0}",(function(e,t){if(e>=100||e===Math.floor(e))return e.toFixed(0);var n=e.toFixed(e>=10?1:2);return(t?n.replace(l,""):n).replace(".",f)})(t,n))}})(i||(i={}));t.default=i});
define("eT",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(t){var n;this._raw=t;if(t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var r,i,s=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,u=e.EmailMatchTypes.None;null!==(i=s.exec(t));){var a=i[0],f=a.charAt(0),l=a.charAt(a.length-1);if((u="<"===f&&">"===l?e.EmailMatchTypes.Bracketed:'"'===f&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o){r=i;o=u;if(u===e.EmailMatchTypes.Bracketed)break}}var c=t;if(r){n=r[0];var h=r.index,p=h+n.length,d=h>0?t.substr(0,h).trim():"",v=p<t.length?t.substr(p):"";if("'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&v&&"'"===v.charAt(0)){n=n.slice(1);v=v.slice(1).trim()}c=""===d?v:d;this._email=n.trim()}(c=c.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==c.charAt(c.length-2)&&(c=c.replace(/\s*"$/,""));""!==(c=c.replace(/\//g,""))&&c!==n&&(this._name=c)}}e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())};e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),r=[],i=0,s=n.length;i<s;i++)r.push(new e(n[i]));return r};e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1};e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),r=n.length-1;r>=0;r--){n[r]=n[r].trim();0===n[r].length&&n.splice(r,1)}return n};e.prototype.getEmail=function(){return this._email};e.prototype.getName=function(){return this._name};e.prototype.getRaw=function(){return this._raw};e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?";e.EmailRegex=new RegExp(e.EmailRegexPattern,"i");e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i");e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/;e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/;e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3};return e})();t.default=n});
define("gB",["require","exports","Tw","vB"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.generateFabricColors=function(t,i){void 0===i&&(i=!1);var s={themeDarker:r.Shade.Shade8,themeDark:r.Shade.Shade7,themeDarkAlt:r.Shade.Shade6,themeLight:r.Shade.Shade3,themeLighter:r.Shade.Shade2,themeLighterAlt:r.Shade.Shade1,themePrimary:r.Shade.Unshaded,themeAccent:r.Shade.Unshaded,themeSecondary:r.Shade.Shade5,themeTertiary:r.Shade.Shade4},o=e._getDefaultThemeTokenMap(),u=n.default.fromRgba(t.R,t.G,t.B);for(var a in s){var f=s[a];o[a]=r.getShade(u,f,i)}var l=o.themeAccent;o.themeAccentTranslucent10=l?n.default.fromRgba(l.R,l.G,l.B,.1*n.default.maxComponent):null;if(i){var c={black:"#fff",blackTranslucent40:"#66ffffff",neutralDark:"#f4f4f4",neutralPrimary:"#fff",neutralPrimaryTranslucent50:"#7fffffff",neutralPrimaryAlt:"#dadada",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#6d6d6d",neutralQuaternary:"#4f4f4f",neutralQuaternaryAlt:"#484848",cmdbarSelected:"#4f4f4f",cmdbarSelectedHover:"#484848",neutralLight:"#3f3f3f",neutralLighter:"#313131",neutralLighterAlt:"#282828",white:"#1f1f1f",whiteTranslucent40:"#661f1f1f",error:"#f00",errorBackground:"#7e3333"};for(var h in c)c.hasOwnProperty(h)&&(o[h]=n.default.fromHtmlColor(c[h]))}return o};e._getDefaultThemeTokenMap=function(){return{backgroundOverlay:null,themeDarker:null,themeDark:null,themeDarkAlt:null,themePrimary:null,themeSecondary:null,themeTertiary:null,themeLight:null,themeLighter:null,themeLighterAlt:null,black:null,cmdbarSelected:null,cmdbarSelectedHover:null,neutralDark:null,neutralPrimary:null,neutralPrimaryAlt:null,neutralPrimaryTranslucent50:null,neutralSecondary:null,neutralSecondaryAlt:null,neutralTertiary:null,neutralTertiaryAlt:null,neutralQuaternary:null,neutralQuaternaryAlt:null,neutralLight:null,neutralLighter:null,neutralLighterAlt:null,white:null,blackTranslucent40:null,whiteTranslucent40:null,yellow:null,yellowLight:null,orange:null,orangeLight:null,redDark:null,red:null,magentaDark:null,magenta:null,magentaLight:null,purpleDark:null,purple:null,purpleLight:null,blueDark:null,blueMid:null,blue:null,blueLight:null,tealDark:null,teal:null,tealLight:null,greenDark:null,green:null,greenLight:null,error:null,errorBackground:null,success:null,successBackground:null,alert:null,alertBackground:null,infoBackground:null,info:null,orangeLighter:null}};return e})();t.default=i});
define("vB",["require","exports","Tw"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=[.537,.349,.216,.184,.145,.082,.043,.027],s=[.537,.45,.349,.216,.184,.145,.082,.043],o=[.88,.77,.66,.55,.44,.33,.22,.11],u=[.11,.22,.33,.44,.55,.66,.77,.88],a=[.96,.84,.7,.4,.12],f=[.1,.24,.44],l=.2,c=.8;(function(e){e[e.Unshaded=0]="Unshaded";e[e.Shade1=1]="Shade1";e[e.Shade2=2]="Shade2";e[e.Shade3=3]="Shade3";e[e.Shade4=4]="Shade4";e[e.Shade5=5]="Shade5";e[e.Shade6=6]="Shade6";e[e.Shade7=7]="Shade7";e[e.Shade8=8]="Shade8"})(r=t.Shade||(t.Shade={}));function h(e){return"number"==typeof e&&e>=r.Unshaded&&e<=r.Shade8}t.isValidShade=h;function p(e,t){return{h:e.h,s:e.s,v:e.v-e.v*t}}function d(e,t){return{h:e.h,s:e.s-e.s*t,v:e.v+(100-e.v)*t}}t.getShade=function(e,t,v){if(!e||t===r.Unshaded||!h(t))return e;var m=d,g=p;if(v){m=p;g=d}var y=(function(e){var t,n,r=NaN,i=e.R,s=e.G,o=e.B,u=Math.max(i,s,o),a=Math.min(i,s,o),f=u-a;0===f?r=0:i===u?r=(s-o)/f%6:s===u?r=(o-i)/f+2:o===u&&(r=(i-s)/f+4);(r=Math.round(60*r))<0&&(r+=360);t=Math.round(100*(0===u?0:f/u));n=Math.round(u/255*100);return{h:r,s:t,v:n}})(e),b=(function(e){var t=e.h,n=e.s,r=e.v,i=(2-(n/=100))*(r/=100),s=n*r;return{h:t,s:100*(s=(s/=i<=1?i:2-i)||0),l:100*(i/=2)}})(y),w=t-1;return(function(e){var t=e.h,r=e.s,i=e.v,s=[],o=(i/=100)*(r/=100),u=t/60,a=o*(1-Math.abs(u%2-1)),f=i-o;switch(Math.floor(u)){case 0:s=[o,a,0];break;case 1:s=[a,o,0];break;case 2:s=[0,o,a];break;case 3:s=[0,a,o];break;case 4:s=[a,0,o];break;case 5:s=[o,0,a]}return n.default.fromRgba(Math.round(255*(s[0]+f)),Math.round(255*(s[1]+f)),Math.round(255*(s[2]+f)))})(y=(function(e){return 255===e.R&&255===e.G&&255===e.B})(e)?p(y,i[w]):(function(e){return 0===e.R&&0===e.G&&0===e.B})(e)?d(y,s[w]):b.l/100>c?g(y,u[w]):b.l/100<l?m(y,o[w]):w<a.length?m(y,a[w]):g(y,f[w-a.length]))}});
define("QN",["require","exports","nt"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadFallbackShellThemableCss=function(){n.loadStyles(".o365cs-base .o365cs-nav-contextMenu {    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base-visibility{  visibility: visible;}\n.o365cs-base .ms-fcl-tdr,.o365cs-base .ms-fcl-tdr-h:hover,.o365cs-base .ms-fcl-tdr-f:focus{    color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bgc-tdr,.o365cs-base .ms-bgc-tdr-h:hover,.o365cs-base .ms-bgc-tdr-f:focus{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bcl-tdr,.o365cs-base .ms-bcl-tdr-h:hover,.o365cs-base .ms-bcl-tdr-f:focus{    border-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-fcl-td,.o365cs-base .ms-fcl-td-h:hover,.o365cs-base .ms-fcl-td-f:focus{    color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bgc-td,.o365cs-base .ms-bgc-td-h:hover,.o365cs-base .ms-bgc-td-f:focus{    background-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bcl-td,.o365cs-base .ms-bcl-td-h:hover,.o365cs-base .ms-bcl-td-f:focus{    border-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-fcl-tda,.o365cs-base .ms-fcl-tda-h:hover,.o365cs-base .ms-fcl-tda-f:focus{    color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bgc-tda,.o365cs-base .ms-bgc-tda-h:hover,.o365cs-base .ms-bgc-tda-f:focus{    background-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bcl-tda,.o365cs-base .ms-bcl-tda-h:hover,.o365cs-base .ms-bcl-tda-f:focus{    border-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-fcl-tp,.o365cs-base .ms-fcl-tp-h:hover,.o365cs-base .ms-fcl-tp-f:focus{    color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bgc-tp,.o365cs-base .ms-bgc-tp-h:hover,.o365cs-base .ms-bgc-tp-f:focus,.o365cs-base.ms-bgc-tp{    background-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bcl-tp,.o365cs-base .ms-bcl-tp-h:hover,.o365cs-base .ms-bcl-tp-f:focus{    border-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-fcl-ts,.o365cs-base .ms-fcl-ts-h:hover,.o365cs-base .ms-fcl-ts-f:focus{    color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bgc-ts,.o365cs-base .ms-bgc-ts-h:hover,.o365cs-base .ms-bgc-ts-f:focus{    background-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bcl-ts,.o365cs-base .ms-bcl-ts-h:hover,.o365cs-base .ms-bcl-ts-f:focus{    border-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-fcl-tt,.o365cs-base .ms-fcl-tt-h:hover,.o365cs-base .ms-fcl-tt-f:focus{    color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bgc-tt,.o365cs-base .ms-bgc-tt-h:hover,.o365cs-base .ms-bgc-tt-f:focus{    background-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bcl-tt,.o365cs-base .ms-bcl-tt-h:hover,.o365cs-base .ms-bcl-tt-f:focus{    border-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-fcl-tl,.o365cs-base .ms-fcl-tl-h:hover,.o365cs-base .ms-fcl-tl-f:focus{    color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bgc-tl,.o365cs-base .ms-bgc-tl-h:hover,.o365cs-base .ms-bgc-tl-f:focus{    background-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bcl-tl,.o365cs-base .ms-bcl-tl-h:hover,.o365cs-base .ms-bcl-tl-f:focus{    border-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-fcl-tlr,.o365cs-base .ms-fcl-tlr-h:hover,.o365cs-base .ms-fcl-tlr-f:focus{    color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bgc-tlr,.o365cs-base .ms-bgc-tlr-h:hover,.o365cs-base .ms-bgc-tlr-f:focus{    background-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bcl-tlr,.o365cs-base .ms-bcl-tlr-h:hover,.o365cs-base .ms-bcl-tlr-f:focus{    border-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-fcl-tlra,.o365cs-base .ms-fcl-tlra-h:hover,.o365cs-base .ms-fcl-tlra-f:focus{    color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bgc-tlra,.o365cs-base .ms-bgc-tlra-h:hover,.o365cs-base .ms-bgc-tlra-f:focus{    background-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bcl-tlra,.o365cs-base .ms-bcl-tlra-h:hover,.o365cs-base .ms-bcl-tlra-f:focus{    border-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-fcl-w,.o365cs-base .ms-fcl-w-h:hover,.o365cs-base .ms-fcl-w-f:focus{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bgc-w,.o365cs-base .ms-bgc-w-h:hover,.o365cs-base .ms-bgc-w-f:focus,.o365cs-base.ms-bgc-w{    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bcl-w,.o365cs-base .ms-bcl-w-h:hover,.o365cs-base .ms-bcl-w-f:focus{    border-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-fcl-b,.o365cs-base .ms-fcl-b-h:hover,.o365cs-base .ms-fcl-b-f:focus{    color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-b.o365cs-nav-closeButton{    color: #000000;}\n.o365cs-base .ms-bgc-b,.o365cs-base .ms-bgc-b-h:hover,.o365cs-base .ms-bgc-b-f:focus,.o365cs-base.ms-bgc-b{    background-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-bcl-b,.o365cs-base .ms-bcl-b-h:hover,.o365cs-base .ms-bcl-b-f:focus{    border-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-nd,.o365cs-base .ms-fcl-nd-h:hover,.o365cs-base .ms-fcl-nd-f:focus{    color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bgc-nd,.o365cs-base .ms-bgc-nd-h:hover,.o365cs-base .ms-bgc-nd-f:focus{    background-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bcl-nd,.o365cs-base .ms-bcl-nd-h:hover,.o365cs-base .ms-bcl-nd-f:focus{    border-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-fcl-np,.o365cs-base .ms-fcl-np-h:hover,.o365cs-base .ms-fcl-np-f:focus{    color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bgc-np,.o365cs-base .ms-bgc-np-h:hover,.o365cs-base .ms-bgc-np-f:focus{    background-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bcl-np,.o365cs-base .ms-bcl-np-h:hover,.o365cs-base .ms-bcl-np-f:focus{    border-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-fcl-ns,.o365cs-base .ms-fcl-ns-h:hover,.o365cs-base .ms-fcl-ns-f:focus{    color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-ns.o365cs-nav-moduleLabel{    color: #666666;}\n.o365cs-base .ms-bgc-ns,.o365cs-base .ms-bgc-ns-h:hover,.o365cs-base .ms-bgc-ns-f:focus{    background-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-bcl-ns,.o365cs-base .ms-bcl-ns-h:hover,.o365cs-base .ms-bcl-ns-f:focus{    border-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-nsa,.o365cs-base .ms-fcl-nsa-h:hover,.o365cs-base .ms-fcl-nsa-f:focus{    color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bgc-nsa,.o365cs-base .ms-bgc-nsa-h:hover,.o365cs-base .ms-bgc-nsa-f:focus{    background-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bcl-nsa,.o365cs-base .ms-bcl-nsa-h:hover,.o365cs-base .ms-bcl-nsa-f:focus{    border-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-fcl-nt,.o365cs-base .ms-fcl-nt-h:hover,.o365cs-base .ms-fcl-nt-f:focus{    color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bgc-nt,.o365cs-base .ms-bgc-nt-h:hover,.o365cs-base .ms-bgc-nt-f:focus{    background-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bcl-nt,.o365cs-base .ms-bcl-nt-h:hover,.o365cs-base .ms-bcl-nt-f:focus{    border-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-fcl-nta,.o365cs-base .ms-fcl-nta-h:hover,.o365cs-base .ms-fcl-nta-f:focus{    color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bgc-nta,.o365cs-base .ms-bgc-nta-h:hover,.o365cs-base .ms-bgc-nta-f:focus{    background-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bcl-nta,.o365cs-base .ms-bcl-nta-h:hover,.o365cs-base .ms-bcl-nta-f:focus{    border-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-fcl-nl,.o365cs-base .ms-fcl-nl-h:hover,.o365cs-base .ms-fcl-nl-f:focus{    color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bgc-nl,.o365cs-base .ms-bgc-nl-h:hover,.o365cs-base .ms-bgc-nl-f:focus{    background-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bcl-nl,.o365cs-base .ms-bcl-nl-h:hover,.o365cs-base .ms-bcl-nl-f:focus{    border-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-fcl-nlr,.o365cs-base .ms-fcl-nlr-h:hover,.o365cs-base .ms-fcl-nlr-f:focus{    color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bgc-nlr,.o365cs-base .ms-bgc-nlr-h:hover,.o365cs-base .ms-bgc-nlr-f:focus,.o365cs-base.ms-bgc-nlr{    background-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bcl-nlr,.o365cs-base .ms-bcl-nlr-h:hover,.o365cs-base .ms-bcl-nlr-f:focus{    border-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-fcl-nlra,.o365cs-base .ms-fcl-nlra-h:hover,.o365cs-base .ms-fcl-nlra-f:focus{    color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bgc-nlra,.o365cs-base .ms-bgc-nlra-h:hover,.o365cs-base .ms-bgc-nlra-f:focus,.o365cs-base.ms-bgc-nlra{    background-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bcl-nlra,.o365cs-base .ms-bcl-nlra-h:hover,.o365cs-base .ms-bcl-nlra-f:focus{    border-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .o365cs-topnavLinkBackground-2{    background-color: transparent;}\n.o365cs-base .o365cs-topnavText,.o365cs-base .o365cs-topnavText:hover{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base .o365cs-appLauncherBackground{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-nav-header16 .o365cs-navMenuButton{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .o365cs-navMenuButton{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base.o365cs-topnavBGImage{    background-position: center top;    background-repeat: repeat-x;    background-image: none;}\n.o365cs-base.o365cs-topnavBGColor-2{    background-color: '[theme:suiteBarBackground, default:#000000]';}\n")}});
define("bB",["require","exports","gB","Tw","ze"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){}e.makeWebThemeRestUrl=function(e,t,n){var r=e;r&&"/"===r[r.length-1]&&(r=r.substring(0,r.length-1));r=i.default.escapeUrlForCallback(r);var s=i.default.escapeUrlForCallback(r)+"/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid="+i.default.encodeURIComponent(t);n&&(s+="&ThemeOverride="+i.default.encodeURIComponent(n));return s};e.processWebThemeRestResponse=function(t){var n,r=JSON.parse(t);r&&r.d&&r.d.GetContextWebThemeData&&(n=JSON.parse(r.d.GetContextWebThemeData));return e.processRawThemeData(n)};e.processRawThemeData=function(t){if(t){var i,s=e.coerceToColor,o=e.SetColorIfMissing,u=t.Palette?t.Palette.Colors:{};i=e.convertColorsToRgba(u);var a=n.default.generateFabricColors(i.ContentAccent1,t.IsInverted),f=s(i.PageBackground)||s(t.IsInverted?"#1b1a19":"#ffffff"),l=s(i.BackgroundOverlay)||null,c=Math.round(.4*r.default.maxComponent);for(var h in a)o(i,h,a[h]);o(i,"white",f);o(i,"primaryBackground",r.default.clone(f));o(i,"primaryText",a.primaryText||s("#333"));o(i,"whiteTranslucent40",f&&r.default.fromRgba(f.R,f.G,f.B,c));o(i,"backgroundOverlay",l);o(i,"suiteBarBackground",s(i.SuiteBarBackground)||null);o(i,"suiteBarText",s(i.SuiteBarText)||null);o(i,"suiteBarDisabledText",s(i.SuiteBarDisabledText)||null);o(i,"topBarBackground",s(i.TopBarBackground)||null);o(i,"topBarText",s(i.TopBarText)||null);o(i,"topBarHoverText",s(i.TopBarHoverText)||null);o(i,"dialogBorder",s(i.DialogBorder)||null);return{backgroundImageUri:t.BackgroundImageUri,cacheToken:t.ThemeCacheToken,isDefault:t.IsDefault,isInverted:t.IsInverted,palette:i,version:t.Version}}return{backgroundImageUri:"",cacheToken:"",isDefault:!0,isInverted:!1,palette:{},version:""}};e.convertColorsToRgba=function(t){var n={};for(var r in t)if(t.hasOwnProperty(r)){var i=e.coerceToColor(t[r]);i&&(n[r]=i)}return n};e.coerceToColor=function(t){var n;t?"string"==typeof t||t instanceof String?n=r.default.fromHtmlColor(String(t)):"DefaultColor"in t?n=e.coerceToColor(t.DefaultColor):"R"in t&&"G"in t&&"B"in t&&(n=r.default.fromRgba(t.R,t.G,t.B,t.A)):n=null;return n};e.SetColorIfMissing=function(e,t,n){e[t]||(e[t]=n)};return e})();t.default=s});
define("B4",["require","exports","Yb","fe","je"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.blocked=0]="blocked";e[e.exception=-1]="exception";e[e.timeout=-2]="timeout";e[e.abort=-3]="abort"})(t.XHRStatus||(t.XHRStatus={}));var s=(function(){function e(t){this._async=new n.default(this);var r=t.url,i=t.requestTimeoutInMS,s=void 0===i?e.DEFAULT_TIMEOUT_MS:i,o=t.json,u=t.responseType,a=void 0===u?"":u,f=t.headers,l=void 0===f?{}:f,c=t.withCredentials,h=void 0!==c&&c,p=t.needsCors,d=void 0!==p&&p,v=t.onProgress,m=t.onUploadProgress,g=t.method,y=void 0===g?o?"POST":"GET":g;this._url=r;this._requestTimeoutInMS=s;this._postData=o;this._headers=l;this._method=y;this._withCredentials=h;this._needsCors=d;this._responseType=a;this._progressCallback=v;this._uploadProgressCallback=m}e.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,-3,!1)};e.prototype.start=function(e,t){var n=this;this._successCallback=e;this._failureCallback=t;var s=this._method,o=this._headers;try{this._request=this._getRequest();var u=this._progressCallback,a=this._uploadProgressCallback,f=this._request,l=this._responseType;u&&(f.onprogress=function(e){try{u(e)}catch(e){r.default.logError(e)}});a&&(f.upload.onprogress=function(e){try{a(e)}catch(e){r.default.logError(e)}});this._async.setTimeout(function(){n._completed||n._timeoutCallback()},this._requestTimeoutInMS);f.onreadystatechange=function(){if(!n._completed){var e=4;try{e=f.DONE||4}catch(e){}f.readyState===e&&n._requestEndCallback()}};f.open(s,this._url,!0);"withCredentials"in f&&(f.withCredentials=this._withCredentials);f.responseType=l;for(var c in o)f.setRequestHeader(c,o[c]);f.send(this._postData)}catch(e){r.default.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:i.safeSerialize(o),method:s});this._abortRequest();this._callFailureCallback(this._request,-1,!1)}};e.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;t.setRequestHeader=function(){};t.onprogress=function(){};t.ontimeout=function(){};t.onload=function(){e._requestEndCallback()};return t};e.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0;this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e};e.prototype._timeoutCallback=function(){if(!this._completed){this._abortRequest();this._callFailureCallback(this._request,-2,!0)}};e.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){r.default.log(e)}};e.prototype._callFailureCallback=function(e,t,n){try{this._failureCallback&&this._failureCallback(e,t,n)}catch(e){r.default.log(e)}};e.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var e=-1;try{this._async.dispose();try{e=this._request.status}catch(e){}}catch(t){e=-1;r.default.log(t)}e<400&&e>0?this._callSuccessCallback(this._request,e):this._callFailureCallback(this._request,e,!1)}};e.DEFAULT_TIMEOUT_MS=3e4;return e})();t.default=s});
define("aM",["require","exports","B4","A"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.start=function(e){var t=new n.default(e);return new r.default(function(e,n){t.start(e,n)},function(){t.abort(!0)})};e.startAndPostProcess=function(e,t){var i=new n.default(e);return new r.default(function(e,n){i.start(function(n,r){e(t(n,r))},n)},function(){i.abort(!0)})};return e})();t.default=i});
define("Dj",["require","exports","ww","gj"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=0,s=(function(){function e(){this._queue={}}e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],r=!0,i=[];if(n.length>0)if(n[0].schedule){i=n.slice(1);this._queue[e]=[n[0]];r=!1}else{i=this._queue[e];this._queue[e]=[]}var s=this._createUpateTask(e,t);i.length>0&&(s.signal=i[0].signal);this._queue[e].push(s);r&&this._scheduleTask(e);return s};e.prototype._createUpateTask=function(e,t){var r=this,s={};s.promise=new Promise(function(e,t){s.resolve=e;s.reject=t});var o={execute:function(){return n.__awaiter(r,void 0,void 0,function(){var e;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,3,4]);return[4,t()];case 1:n.sent();return[3,4];case 2:e=n.sent();o.error=e;return[3,4];case 3:this._completeTask(o);return[7];case 4:return[2]}})})},schedule:0,id:i++,key:e,signal:s};return o};e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=r.global.setTimeout(n.execute,5)}};e.prototype._completeTask=function(e){var t=e.id,n=e.key,r=this._queue[n],i=r[0],s=r.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=s;this._scheduleTask(n);e.error?e.signal.reject(e.error):e.signal.resolve()};return e})();t.CacheUpdateTaskManager=s});
define("_j",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.localStorage=0]="localStorage";e[e.indexedDB=1]="indexedDB";e[e.none=2]="none"})(t.PersistentCacheType||(t.PersistentCacheType={}))});
define("hj",["require","exports","ww","Sj","yj","vj","Dj","bj","Q"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f={cacheType:1},l=(function(){function e(e){var t=e.cacheType,r=void 0===t?f.cacheType:t,i=n.__rest(e,["cacheType"]);this._config=n.__assign(n.__assign({},i),{cacheType:r});this._cacheSecret=this._config.secret;this._dataIsEncrypted=!!this._cacheSecret;this._crypto=this._config.crypto;if(this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType;this._app=e.app;this._cacheUpdateTaskManager=new o.CacheUpdateTaskManager;this._qos=this._config.telemetry&&this._config.telemetry.qos;this._initLocalStorage(this._cacheType)}Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!0,configurable:!0});e.prototype.read=function(t){return n.__awaiter(this,void 0,void 0,function(){var r,i,o,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return n.__generator(this,function(n){switch(n.label){case 0:r=this._logQos({name:"PersistentCache.read"});l=u.now();c=Date.now();n.label=1;case 1:n.trys.push([1,12,,13]);p=this._getCacheKey(t);d=!1;v={lastModified:NaN,lastRead:c,reads:1};m=void 0;if(!p)return[3,11];g=u.now();return[4,this._storage.read(p)];case 2:h=n.sent();f=Math.round(u.now()-g);if(!h)return[3,11];y=h.data;v={lastModified:h.lastModified,lastRead:c,reads:h.reads+1};if(!(i=e._buffer[p])||i.cacheStats.lastModified!==h.lastModified)return[3,3];i.app=h.app||this._app;i.key={original:t,encoded:h.key||p};i.cacheStats.lastRead=c;i.cacheStats.reads++;i.performance={total:Math.round(u.now()-l)};return[3,11];case 3:i=void 0;if(void 0===y)return[3,11];if(!this._dataIsEncrypted)return[3,10];b=y;w=this._cacheSecret,E=w.CurrentKey.Key,S=w.PreviousKey.Key;x=u.now();n.label=4;case 4:n.trys.push([4,6,,9]);return[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:E})];case 5:m=n.sent();return[3,9];case 6:return(T=n.sent())&&T.message&&T.message.indexOf(s.CryptoErrors.secretError)>=0?[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:S})]:[3,8];case 7:m=n.sent();d=void 0!==m;r({resultType:a.ResultTypeEnum.ExpectedFailure,error:T.message,extraData:{cacheResult:"hit"}});n.label=8;case 8:return[3,9];case 9:o=Math.round(u.now()-x);return[3,11];case 10:m=y;n.label=11;case 11:i=i||{key:{original:t,encoded:h&&h.key||p},app:h&&h.app||this._app,data:m,cacheStats:v,cacheType:this._cacheType,performance:{crypto:o,io:f,total:Math.round(u.now()-l)}};e._buffer[p]=i;d&&this.update(t,m);return[3,13];case 12:N=n.sent();r({resultType:a.ResultTypeEnum.Failure,error:N.message?N.message:N.toString(),extraData:{cacheResult:"miss"}});throw N;case 13:r({resultType:a.ResultTypeEnum.Success,extraData:{cacheResult:void 0!==i.data?"hit":"miss"}});return[2,Promise.resolve(i)]}})})};e.prototype.rangeQuery=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s,o,f,l,c=this;return n.__generator(this,function(n){if(1!==this._cacheType)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"});r=0;i=u.now();s=Date.now();f={lastModified:NaN,lastRead:s,reads:1};try{l=u.now();o=this._storage.rangeQuery(e).then(function(e){r=Math.round(u.now()-l);return{key:void 0,app:void 0,data:e.map(function(e){return{original:c._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:f,cacheType:c._cacheType,performance:{io:r,total:Math.round(u.now()-i)}}})}catch(e){t({resultType:a.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()});throw e}t({resultType:a.ResultTypeEnum.Success});return[2,o||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:f,cacheType:this._cacheType,performance:{io:r,total:Math.round(u.now()-i)}})]})})};e.prototype.update=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,i=this;return n.__generator(this,function(n){switch(n.label){case 0:r=this._getCacheKey(e);return[4,this._cacheUpdateTaskManager.enqueue(r,function(){return i._doCacheUpdate(e,t)}).signal.promise];case 1:n.sent();this._logCacheStats();return[2]}})})};e.prototype.remove=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.update(e,void 0)]})})};e.prototype.freeSpace=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._storage.freeSpace(e,t)]})})};e.prototype.readAndUpdate=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,i,s,o,f,l,c=this;return n.__generator(this,function(n){switch(n.label){case 0:r=u.now();i=Date.now();s=this._logQos({name:"PersistentCache.readAndUpdate"});o=t().then(function(t){var n={app:c._app,key:{original:e,encoded:c._getCacheKey(e)},data:t,cacheType:2,cacheStats:{lastModified:void 0,lastRead:i,reads:1},performance:{total:Math.round(u.now()-r)}};c.update(e,t);return n});n.label=1;case 1:n.trys.push([1,8,,9]);n.label=2;case 2:n.trys.push([2,4,,5]);return[4,Promise.race([this.read(e),o])];case 3:f=n.sent();return[3,5];case 4:n.sent();return[3,5];case 5:return!f||2!==f.cacheType&&void 0===f.data?[4,o]:[3,7];case 6:f=n.sent();n.label=7;case 7:return[3,9];case 8:l=n.sent();s({resultType:a.ResultTypeEnum.Failure,error:l.message?l.message:l.toString()});throw l;case 9:s({resultType:a.ResultTypeEnum.Success});return[2,f]}})})};e.prototype._initLocalStorage=function(e){switch(e){case 0:this._storage=new i.PersistentCacheLocalStorage;break;case 1:default:try{this._storage=new r.PersistentCacheIndexedDB(this._logQos.bind(this))}catch(e){if(e.message===r.indexedDBErrors.notSupported){this._storage=new i.PersistentCacheLocalStorage;this._cacheType=0}}}};e.prototype._getCacheKey=function(e){var t=encodeURIComponent(e.key+(e.user?"_____"+e.user:""));return"_odspcache_"+(this._dataIsEncrypted?btoa(t):t)};e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace("_odspcache_",""),n=this._dataIsEncrypted?atob(t):t,r=decodeURIComponent(n);if(r.indexOf("_____")>=0){var i=r.split("_____");return{key:i[0],user:i[1]}}return{key:r}};e.prototype._doCacheUpdate=function(t,r){return n.__awaiter(this,void 0,void 0,function(){var i,s,o,f,l,c,h;return n.__generator(this,function(p){switch(p.label){case 0:i=this._logQos({name:"PersistentCache.update"});p.label=1;case 1:p.trys.push([1,9,,10]);s=this._getCacheKey(t);if(void 0===r)return[3,6];(o=e._buffer[s]=n.__assign(n.__assign({},e._buffer[s]),{data:r,cacheType:this._cacheType})).cacheStats||(o.cacheStats={lastModified:NaN,lastRead:u.now(),reads:1});f=r;l=NaN;if(!this._dataIsEncrypted)return[3,3];c=this._cacheSecret.CurrentKey.Key;return[4,this._crypto.encrypt({encryptionSecret:c,data:r,doSerialize:0===this._cacheType})];case 2:f=p.sent();l=f.cipherText?f.cipherText.byteLength:0;return[3,4];case 3:try{l="string"==typeof r?r.length:JSON.stringify(r).length}catch(e){}p.label=4;case 4:return[4,this._storage.write({app:this._app,key:s,data:f,lastRead:o.cacheStats.lastRead,parentKey:t.parentKey,reads:o.cacheStats.reads,size:l})];case 5:p.sent();return[3,8];case 6:delete e._buffer[s];return[4,this._storage.write({key:s,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:p.sent();p.label=8;case 8:return[3,10];case 9:h=p.sent();i({resultType:a.ResultTypeEnum.Failure,error:h.message?h.message:h.toString()});throw h;case 10:i({resultType:a.ResultTypeEnum.Success});return[2]}})})};e.prototype._logCacheStats=function(){return n.__awaiter(this,void 0,void 0,function(){var e=this;return n.__generator(this,function(t){this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:e.sent();return[2]}})})},3e4));return[2]})})};e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={});e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={});e.extraData.alias=e.extraData.alias||t;n.end(e)}}return function(e){}};e._buffer={};return e})();t.PersistentCache=l});
define("mj",["require","exports","ww","Dj","hj","_j"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("Sj",["require","exports","ww","Gp","P","gj","q"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u;(function(e){e.success="success";e.error="error"})(u||(u={}));var a=(new r.PlatformDetection).isFirefox;t.indexedDBErrors={notSupported:"indexedDB is not supported"};var f=(function(){function e(n){if(!("indexedDB"in s.global&&s.global.indexedDB))throw new Error(t.indexedDBErrors.notSupported);this._logger=n;e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){e._db=t;return t}))}e.prototype.freeSpace=function(t,r){return n.__awaiter(this,void 0,void 0,function(){var i,s,o,u=this;return n.__generator(this,function(n){switch(n.label){case 0:s=e;return(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=n.sent();n.label=2;case 2:i=s._db=o;return[2,new Promise(function(e,n){var s=i.transaction(["ODSP_DB_TABLE"],"readwrite").objectStore("ODSP_DB_TABLE").index("app_lastRead").openCursor();s.onsuccess=function(n){var i=s.result;if(i){if(i.value.app===t&&r>0){r-=i.value.size;i.delete()}r>0?i.continue():e()}else e()};s.onerror=function(e){u._errorHandling(e,n)}})]}})})};e.prototype.read=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._readInternal("ODSP_DB_TABLE",function(t){return t.get(e)})]})})};e.prototype.rangeQuery=function(t){return n.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u,a,f,l,c,h,p,d,v,m=this;return n.__generator(this,function(n){switch(n.label){case 0:r={};s=e;return(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=n.sent();n.label=2;case 2:i=s._db=o;u=i.transaction(["ODSP_DB_TABLE"],"readonly");a=u.objectStore("ODSP_DB_TABLE");f=[];l=t.index,c=t.range,h=t.direction,p=t.count;d=a.index(l);(v=d.openKeyCursor(c,h)).onerror=function(e){m._errorHandling(e,r.reject)};v.onsuccess=function(e){var t=e.target.result;if(t){f.push(t.primaryKey);f.length>=p?r.resolve(f):t.continue()}else r.resolve(f)};return[2,new Promise(function(e,t){r.resolve=e;r.reject=t})]}})})};e.prototype.write=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(r){t=e.key;return void 0!==e.data?[2,this._writeInternal({tableName:"ODSP_DB_TABLE",key:t,row:n.__assign(n.__assign({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:"ODSP_DB_TABLE",key:t,row:void 0})]})})};e.prototype.statistics=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent();this._dbMetaData=e;n.label=2;case 2:return[4,this._iterate("ODSP_DB_TABLE",function(e){return e.size})];case 3:t=n.sent();return[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})};e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,r){if(e._db)n(e._db);else{var i=a?indexedDB.open("ODSP_DB",{version:4,storage:"temporary"}):indexedDB.open("ODSP_DB",4);i.onerror=function(e){t._errorHandling(e,r)};i.onsuccess=function(t){var r=e._db=i.result;n(r)};i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,r)};var s=e.oldVersion;t._handleDBUpgrade(i,n,s)}}})};e.prototype._handleDBUpgrade=function(e,t,n){var r;if(n<1){(r=t.createObjectStore("ODSP_DB_TABLE",{keyPath:"key"})).createIndex("lastModified","lastModified",{unique:!1});r.createIndex("reads","reads",{unique:!1});t.createObjectStore("ODSP_DB_METADATA_TABLE",{keyPath:"key"})}if(n<2){(r=r||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("app","app",{unique:!1});r.createIndex("lastRead","lastRead",{unique:!1});r.createIndex("app_lastRead",["app","lastRead"],{unique:!1})}if(n<3){(r=r||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("app_lastModified",["app","lastModified"],{unique:!1});r.createIndex("app_reads",["app","reads"],{unique:!1})}if(n<4){(r=r||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("parentKey","parentKey",{unique:!1});r.createIndex("parentKey_app",["parentKey","app"],{unique:!1});r.createIndex("parentKey_app_lastModified",["parentKey","app","lastModified"],{unique:!1});r.createIndex("parentKey_app_lastRead",["parentKey","app","lastRead"],{unique:!1});r.createIndex("parentKey_app_reads",["parentKey","app","reads"],{unique:!1})}};e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal("ODSP_DB_METADATA_TABLE",function(e){return e.get("database_metadata")}).then(function(t){if(t)return t.data;var n={id:i.generate(),created:Date.now(),cacheType:1};return e._writeInternal({tableName:"ODSP_DB_METADATA_TABLE",key:"database_metadata",row:{key:"database_metadata",data:n}}).then(function(){return n})})};e.prototype._readInternal=function(t,r){return n.__awaiter(this,void 0,void 0,function(){var i,s,u,a=this;return n.__generator(this,function(n){switch(n.label){case 0:s=e;return(u=e._db)?[3,2]:[4,e._openDBPromise];case 1:u=n.sent();n.label=2;case 2:i=s._db=u;return[2,new Promise(function(e,n){var s=a._logger({name:"PersistentCacheIDB.readInternal"}),u=Date.now(),f=i.transaction([t],"readonly").objectStore(t),l=r(f);l.onsuccess=function(t){s({resultType:o.ResultTypeEnum.Success,extraData:{io:Math.round(Date.now()-u)}});e(l.result)};l.onerror=function(e){s({resultType:o.ResultTypeEnum.Failure,extraData:{io:Math.round(Date.now()-u)}});a._errorHandling(e,n)}})]}})})};e.prototype._iterate=function(t,r){return n.__awaiter(this,void 0,void 0,function(){var i,s,o,u,a=this;return n.__generator(this,function(n){switch(n.label){case 0:s=e;return(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=n.sent();n.label=2;case 2:i=s._db=o;u=[];return[2,new Promise(function(e,n){var s=i.transaction([t],"readonly").objectStore(t).openCursor();s.onsuccess=function(t){var n=s.result;if(n){u.push(r(n.value));n.continue()}else e(u)};s.onerror=function(e){a._errorHandling(e,n)}})]}})})};e.prototype._writeInternal=function(t){return n.__awaiter(this,void 0,void 0,function(){var r,i,s,o,u,a,f=this;return n.__generator(this,function(n){switch(n.label){case 0:r=t.tableName,i=t.key,s=t.row;u=e;return(a=e._db)?[3,2]:[4,e._openDBPromise];case 1:a=n.sent();n.label=2;case 2:o=u._db=a;return[2,new Promise(function(e,t){try{var n=o.transaction([r],"readwrite"),u=n.objectStore(r);n.oncomplete=function(){};n.onerror=function(e){f._errorHandling(e,t)};var a=s?u.put(s):u.delete(i);a.onsuccess=function(t){e()};a.onerror=function(e){f._errorHandling(e,t)}}catch(e){throw e}})]}})})};e.prototype._deleteDataRows=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r=this;return n.__generator(this,function(n){t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1);return[2,this.rangeQuery({index:"parentKey",range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return r._writeInternal({tableName:"ODSP_DB_TABLE",key:e,row:void 0})}))}).then(function(){})]})})};e.prototype._errorHandling=function(e,t){if(e.type===u.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}};return e})();t.PersistentCacheIndexedDB=f});
define("yj",["require","exports","ww","P","gj"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="PersistentCache_metadata";t.localStorageErrors={notSupported:"localStorage is not supported"};var o=(function(){function e(){try{if("localStorage"in i.global&&i.global.localStorage){this._localStorage=i.global.localStorage;if(!this._localStorage.getItem(s)){var e={id:r.generate(),created:Date.now(),cacheType:0};this._localStorage.setItem(s,JSON.stringify(e))}}}catch(e){}if(!this._localStorage)throw new Error(t.localStorageErrors.notSupported)}e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")};e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))};e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var r=n.__assign(n.__assign({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(r))}else this._localStorage.removeItem(t)};e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf("PersistentCache")){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(s)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}};e.prototype.rangeQuery=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,void 0]})})};e.prototype._cacheKey=function(e){return"PersistentCache_"+e};return e})();t.PersistentCacheLocalStorage=o});
define("gj",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.global="undefined"==typeof window?self:window});
define("bj",["require","exports","gj"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.now=function(){return n.global.performance&&performance.now?Math.round(performance.now()):Date.now()};t.mark=function(e){n.global.performance&&performance.mark&&performance.mark(e)}});
define("XC",["require","exports","uO","lO","M","pe","ue","dO","sO","oO","E2","iO","ZC"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o.Manager.cleanString=u.cleanString;n.default.init();function a(){var e,t=window._spPageContextInfo&&window._spPageContextInfo.env||"devbox",n="",r="",i=window._spModuleLink;if(i){n=i.buildNumber;r=i.manifestName;if(!i.usingRedirectCookie)switch(t.toLowerCase()){case"prod":case"dprod":e="prod";break;default:case"edog":case"prodbubble":e="ppe"}}return{version:n,manifest:r,appEnvironment:t,ariaEnvironment:e}}t.getAriaInfo=a;t.default=function(e){var t=a(),n=t.version,o=t.manifest,u=t.appEnvironment,l=t.ariaEnvironment,c=(function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableAriaUpload;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1})();c&&(l="ppe");var h=l&&e.tokens[l],p=window._spPageContextInfo,d=p.isAnonymousGuestUser,v=p.currentUICultureName,m=p.systemUserKey,g=p.userLoginName,y=p.siteSubscriptionId,b=p.farmLabel,w=p.farmName,E=p.siteId,S=p.webTemplate,x=p.webId,T=p.ariaCollectorUrl;(c||h&&"dev"!==n)&&r.default.Init(h,{isAuthenticated:!d,market:v,session:i.default.generate(),version:n,manifest:o,userId:m,accountType:g?s.AccountType.Business:s.AccountType.BusinessAnonymous,siteSubscriptionId:y,farmLabel:b,farmName:w,collectorUrl:T,environment:u,workload:e.workload,disableCookies:d,siteId:f(E),webTemplateId:S,webId:f(x),context:e.context},e.ariaLoader)};function f(e){e.length>36&&(e=e.replace(/[{}]/g,""));return e}});
define("Iw",["require","exports","XC","T4","xw"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){void 0===e&&(e={});n.default({workload:"ODB",tokens:r.ODBTenantTokens,context:e.context})}});
define("T4",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SPOTenantTokens={ppe:"3620e5572cf04917bf4993285ebe4e15-d5c60963-35a1-45e2-9430-928e0656b9cd-6718",prod:"a9e9a63d9df4411ebbf89297947d7666-b5f0498b-a808-4b74-bb7b-2b33f7971660-7417"};t.ODBTenantTokens={ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"}});
define("R4",["require","exports","oe","we","X"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e){var t={CorrelationVector:e.vector.toString(),ValidationErrors:e.validationErrors,WebLog_FullName:e.eventName,WebLog_EventType:n.ClonedEventType[e.eventType]};e.eventType===n.ClonedEventType.End&&(t.Duration=e.endTime-e.startTime);for(var i=e.eventName.split(","),s=0,o=i;s<o.length;s++){var u=o[s];u&&(t["WebLog_Type_"+u]=1)}var a=e.data,f=e.context;if(f)for(var l in f)if(Object.prototype.hasOwnProperty.call(f,l)){if(null==(h=f[l]))continue;t[d=r.capitalize(l)]=h}if(a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var h;if(null==(h=a[c]))continue;var p=e.metadata[c];if(p){var d=p.isPrefixingDisabled?r.capitalize(c):r.capitalize(p.definedInName)+"_"+c,v=p.type;if(4===v){for(var m in h)if(Object.prototype.hasOwnProperty.call(h,m)){var g=h[m];if(null!=g&&""!==g){var y=void 0;if("object"==typeof g)try{y=JSON.stringify(g)}catch(e){y=g}else y=g;t[d+"_"+m.replace(/\./g,"_")]=y}}}else t[d]=6===v?p.typeRef[h]:h}}return{name:e.isEventTypePrefixingDisabled?i[i.length-2]:"ev_"+i[i.length-2],values:t}}t.getAriaEventInfo=s;t.buildAriaEvent=function(e,t){var n=s(t),r=n.name,o=n.values,u=new e.EventProperties;u.name=r;(function(e,t,n){var r;try{for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){r=s;t.setProperty(s,n[s])}}catch(t){var o=void 0,u=void 0;if(t instanceof e.Exception){o=t.ErrorCode();u=new Error("Aria error: "+t.toString())}if(u){t.handled=!0;i.logError(u,{errorCode:o,propertyKey:r})}throw t}})(e,u,o);return u}});
define("H4",["require","exports","ww","oe","R4","X","we"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e){var t=this;this.logEvent=function(e){var n=t._onLogEvent?t._onLogEvent(e):e;t._createLogHandler().then(function(e){return e(n)})};this._getAria=f(function(){return e.ariaLoader().then(function(t){(function(e,t){if(!e.LogManager.isInitialized()){e.LogManager.initialize(t.tenantToken,n.__assign(n.__assign({disableCookies:t.disableCookies},t.offlineCache?{browserOverrides:{onGetData:t.offlineCache.getData,onSaveData:t.offlineCache.saveData}}:{}),t.ariaLogConfiguration||{}));"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(){e.LogManager.flush()})}e.LogManager.addCallbackListener(function(e,n,r,i){r===t.tenantToken&&t.ariaQos&&t.ariaQos.reportQos({result:e,statusCode:n,events:i})})})(t,e);return t})});this._getLogger=f(function(){return t._getAria().then(function(t){return[(function(e,t,n){void 0===n&&(n={});var r=new e.Logger(t);a(r,n);return r})(t,e.tenantToken,e.context),t]})});this._createLogHandler=f(function(){return t._getLogger().then(function(t){var n=t[0];return(function(e,t,n,o){void 0===n&&(n=!0);void 0===o&&(o=void 0);return function(u){try{if(u.enabled&&(u.eventType!==r.ClonedEventType.Start||n)&&(!o||!o.isQosEvent(u))){var a=i.buildAriaEvent(e,u);t.logEvent(a)}}catch(t){var f=void 0;t instanceof e.Exception&&(f=new Error("Aria error: "+t.toString()));t&&t.handled||s.log(f||t)}}})(t[1],n,e.logStartEvents,e.ariaQos)})});this._onLogEvent=e.onLogEvent}e.prototype.attach=function(e){this._createLogHandler();var t=this.logEvent;e.addLogHandler(t).forEach(t);return function(){return e.removeLogHandler(t)}};e.prototype.updateContext=function(e){this._getLogger().then(function(t){return a(t[0],e)})};return e})();t.AriaTelemetryHandler=u;function a(e,t){var r=t.Session,i=t.Version,s=t.OSName,u=t.OSVersion,a=t.Market,f=t.UserId,l=t.Manifest,c=n.__rest(t,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),h=e.getSemanticContext();r&&e.setContext("AppInfo.Session",r);l&&e.setContext("AppInfo.Manifest",l);i&&h.setAppVersion(i);h.setUserLanguage(a||"");f&&h.setUserId(f);s&&h.setDeviceOsName(s);u&&h.setDeviceOsVersion(u);for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var d=c[p];if(null==d)continue;var v=o.capitalize(p);e.setContext(v,c[p])}}function f(e){var t=void 0;return function(){t||(t=e());return t}}});
define("F4",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withPrivacyClassification=function(e){return function(t){var r="function"==typeof e?e:function(){return e};return((function(e){n.__extends(t,e);function t(t){var i=t.onLogEvent;return e.call(this,n.__assign(n.__assign({},t),{onLogEvent:function(e){var t=i?i(e):e;if(t.data)return n.__assign(n.__assign({},t),{data:n.__assign(n.__assign({},t.data),{privacyClassification:r(t)})})}}))||this}return t})(t))}}});
define("cO",["require","exports","ie","oe","eO"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.Manager.addValidationErrorLogger(function(e,t){var s=r.ValidationErrorType[t];i.ValidationError.enabled()&&i.ValidationError.logData({message:"Validation error for "+e.shortEventName+" of type "+s,validatedEventName:e.shortEventName,validatedFullEventName:e.eventName,validationType:s,stack:n.Manager.getStack()||""},e)})});
define("zv",["require","exports","te"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RUMOneDataUpload=n.createSingleEvent({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:1,dictionary:4,privacyClassification:{isPrefixingDisabled:!0,type:1}}).withData({privacyClassification:"requiredService"})});
define("eO",["require","exports","te"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ValidationError=n.createSingleEvent({eventName:"ValidationError,",shortEventName:"ValidationError",samplingFeature:{ODB:-1,ODC:"ValidationErrorSampling",Fallback:!1},critical:!0,requiresParent:!1},{message:1,validationType:1,validatedEventName:1,validatedFullEventName:1,stack:1,privacyClassification:{isPrefixingDisabled:!0,type:1}}).withData({privacyClassification:"requiredDiagnostic"})});
define("Nv",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=0;t.patchXMLHTTPRequest=function(e,t){var r=XMLHttpRequest.prototype.send,i=n++;XMLHttpRequest.prototype.send=function(){for(var n=this,s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];e(i.toString());this.addEventListener("readystatechange",function(){4===n.readyState&&t(i.toString())});return r.apply(this,s)}};t.patchFetch=function(e,t){var r=window.fetch;window.fetch=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return new Promise(function(s,o){var u=n++;e(u.toString());r.apply(void 0,i).then(function(e){t(u.toString());s(e)},function(e){t(e);o(e)})})}};var r=["img","script","iframe","link","audio","video","source"];function i(e,t){for(var n=0,r=e;n<r.length;n++){var s=r[n];if(t.includes(s.nodeName.toLowerCase())||i(s.children,t))return!0}return!1}t.observeResourceFetchingMutations=function(e){var t=new MutationObserver(function(t){for(var n=0,s=t;n<s.length;n++){var o=s[n];"childList"===o.type&&i(o.addedNodes,r)?e(o):"attributes"===o.type&&r.includes(o.target.tagName.toLowerCase())&&e(o)}});t.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]});return t}});
define("Rv",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableTTILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1})()&&console.log.apply(console,e)}});
define("Hv",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.computeFirstConsistentlyInteractive=function(e,t,n,r,i,s,o,u){if(s&&r-n<u)return null;var a=0===i.length?e:i[i.length-1].end;if(r-a<o)return null;if(a&&i.length>0){var f=i[i.length-1].endMarkName;f&&performance.measure("TTI",void 0,f)}return Math.max(a,t)};t.computeLastKnownNetwork2Busy=function(e,t){if(e.length>2)return performance.now();for(var n=[],r=0,i=t;r<i.length;r++){var s=i[r];n.push({timestamp:s.start,type:"requestStart"});n.push({timestamp:s.end,type:"requestEnd"})}for(var o=0,u=e;o<u.length;o++){var a=u[o];n.push({timestamp:a,type:"requestStart"})}n.sort(function(e,t){return e.timestamp-t.timestamp});for(var f=e.length,l=n.length-1;l>=0;l--){var c=n[l];switch(c.type){case"requestStart":f--;break;case"requestEnd":if(++f>2)return c.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0}});
define("Fv",["require","exports","ww","Nv","Rv","Hv"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.restartLongTaskObserver=function(){window.__tti&&window.__tti.o.observe({entryTypes:["longtask"]})};var o=(function(){function e(e){var t=this;void 0===e&&(e={});this._useMutationObserver=!!e.useMutationObserver;this._trackNetworkRequests=!!e.trackNetworkRequests;this._minValue=e.minValue||null;this._requiredMainThreadQuietnessDurationInMilliseconds=e.requiredMainThreadQuietnessDurationInMilliseconds||5e3;this._requiredNetworkQuietnessDurationInMilliseconds=e.requiredNetworkQuietnessDurationInMilliseconds||5e3;var n=window.__tti&&window.__tti.e,r=window.__tti&&window.__tti.o;this._longTaskId=0;if(n){i.log("Consuming the long task entries already recorded.");this._longTasks=n.map(function(e){return t._createLongTask(e)});window.__tti.e=[]}else this._longTasks=[];r&&r.disconnect();this._networkRequests=[];this._incompleteJSInitiatedRequestStartTimes=new Map;this._timerId=void 0;this._timerActivationTime=-1/0;this._scheduleTimerTasks=!1;this._firstConsistentlyInteractiveResolver=null;this._performanceObserver=null;this._mutationObserver=null;this._registerListeners(this._trackNetworkRequests)}e.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise(function(t,n){e._firstConsistentlyInteractiveResolver=t;"complete"===document.readyState?e.startSchedulingTimerTasks():window.addEventListener("load",function(){e.startSchedulingTimerTasks()})})};e.prototype.startSchedulingTimerTasks=function(){i.log("Enabling FirstConsistentlyInteractiveDetector");this._scheduleTimerTasks=!0;var e=this._longTasks.length>0?this._longTasks[this._longTasks.length-1].end:0,t=s.computeLastKnownNetwork2Busy(this._incompleteRequestStarts(),this._networkRequests);this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,e))};e.prototype._rescheduleTimer=function(e){var t=this;if(this._scheduleTimerTasks){i.log("Attempting to reschedule FirstConsistentlyInteractive check to "+e);i.log("Previous timer activation time: "+this._timerActivationTime);if(this._timerActivationTime>e)i.log("Current activation time is greater than attempted reschedule time. No need to postpone.");else{clearTimeout(this._timerId);this._timerId=setTimeout(function(){t._checkTTI()},Math.max(0,e-performance.now()));this._timerActivationTime=e;i.log("Rescheduled firstConsistentlyInteractive check at "+e)}}else i.log("startSchedulingTimerTasks must be called before calling rescheduleTimer")};e.prototype._disable=function(){i.log("Disabling FirstConsistentlyInteractiveDetector");clearTimeout(this._timerId);this._scheduleTimerTasks=!1;this._unregisterListeners()};e.prototype._registerPerformanceObserver=function(e){var t=this;void 0===e&&(e=!0);this._performanceObserver=new PerformanceObserver(function(n){for(var r=0,i=n.getEntries();r<i.length;r++){var s=i[r];"resource"===s.entryType&&e&&t._networkRequestFinishedCallback(s);"longtask"===s.entryType&&t._longTaskFinishedCallback(s)}});this._performanceObserver.observe({entryTypes:e?["longtask","resource"]:["longtask"]})};e.prototype._registerListeners=function(e){void 0===e&&(e=!0);if(e){r.patchXMLHTTPRequest(this._beforeJSInitiatedRequestCallback.bind(this),this._afterJSInitiatedRequestCallback.bind(this));r.patchFetch(this._beforeJSInitiatedRequestCallback.bind(this),this._afterJSInitiatedRequestCallback.bind(this))}this._registerPerformanceObserver(e);this._useMutationObserver&&(this._mutationObserver=r.observeResourceFetchingMutations(this._mutationObserverCallback.bind(this)))};e.prototype._unregisterListeners=function(){this._performanceObserver&&this._performanceObserver.disconnect();this._mutationObserver&&this._mutationObserver.disconnect()};e.prototype._beforeJSInitiatedRequestCallback=function(e){i.log("Starting JS initiated request. Request ID: "+e);this._incompleteJSInitiatedRequestStartTimes.set(e,performance.now());i.log("Active XHRs: "+this._incompleteJSInitiatedRequestStartTimes.size)};e.prototype._afterJSInitiatedRequestCallback=function(e){i.log("Completed JS initiated request with request ID: "+e);this._incompleteJSInitiatedRequestStartTimes.delete(e);i.log("Active XHRs: "+this._incompleteJSInitiatedRequestStartTimes.size)};e.prototype._networkRequestFinishedCallback=function(e){i.log("Network request finished",e);this._networkRequests.push({start:e.fetchStart,end:e.responseEnd});this._rescheduleTimer(s.computeLastKnownNetwork2Busy(this._incompleteRequestStarts(),this._networkRequests)+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._longTaskFinishedCallback=function(e){i.log("Long task finished",e);var t,n=this._createLongTask(e),r="longTaskEnd"+n.id;t=r,window.performance&&performance.mark&&performance.mark(t);n.endMarkName=r;this._longTasks.push(n);this._rescheduleTimer(n.end+this._requiredMainThreadQuietnessDurationInMilliseconds)};e.prototype._mutationObserverCallback=function(e){i.log("Potentially network resource fetching mutation detected",e);i.log("Pushing back FirstConsistentlyInteractive check by "+this._requiredNetworkQuietnessDurationInMilliseconds+" milliseconds.");this._rescheduleTimer(performance.now()+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._getMinValue=function(){return this._minValue?this._minValue:performance.timing.domContentLoadedEventEnd?performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart:null};e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}};e.prototype._incompleteRequestStarts=function(){return n.__spreadArrays(Array.from(this._incompleteJSInitiatedRequestStartTimes.values()))};e.prototype._checkTTI=function(){i.log("Checking if First Consistently Interactive was reached...");var e=performance.timing.navigationStart,t=s.computeLastKnownNetwork2Busy(this._incompleteRequestStarts(),this._networkRequests),n=(window.chrome&&window.chrome.loadTimes?1e3*window.chrome.loadTimes().firstPaintTime-e:0)||performance.timing.domContentLoadedEventEnd-e,r=this._getMinValue(),o=performance.now();if(null!==r){i.log("Parameter values:");i.log("NavigationStart",e);i.log("lastKnownNetwork2Busy",t);i.log("Search Start",n);i.log("Min Value",r);i.log("Last busy",t);i.log("Current time",o);i.log("Long tasks",this._longTasks);i.log("Incomplete JS Request Start Times",this._incompleteRequestStarts());i.log("Network requests",this._networkRequests);var u=s.computeFirstConsistentlyInteractive(n,r,t,o,this._longTasks,this._trackNetworkRequests,this._requiredMainThreadQuietnessDurationInMilliseconds,this._requiredNetworkQuietnessDurationInMilliseconds);if(u&&this._firstConsistentlyInteractiveResolver){i.log("maybeFCI",u);this._firstConsistentlyInteractiveResolver({tti:u,longTasks:this._longTasks});this._disable()}else{i.log("Could not detect First Consistently Interactive. Retrying in 1 second.");this._rescheduleTimer(performance.now()+1e3)}}else{i.log("No usable minimum value yet. Postponing check.");this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,o+1e3))}};return e})();t.FirstConsistentlyInteractiveDetector=o});
define("Uv",["require","exports","Fv"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.restartLongTaskObserver=n.restartLongTaskObserver;t.getFirstConsistentlyInteractive=function(e){void 0===e&&(e={});if("PerformanceLongTaskTiming"in window){return new n.FirstConsistentlyInteractiveDetector(e).getFirstConsistentlyInteractive()}return Promise.resolve(null)}});
define("vj",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CryptoErrors={secretError:"wrong secret or signature.",unsupportedError:"Crypto operations not supported.",deserializationError:"Data serialization/deserialization error."}});
define("VS",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=621355968e5;t.getDateFromDotNetTicks=function(e){return new Date(e/1e4-n)}});
define("BS",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ONE_SECOND=1e3;t.ONE_MINUTE=60*t.ONE_SECOND;t.TWO_MINUTES=2*t.ONE_MINUTE;t.ONE_HOUR=60*t.ONE_MINUTE;t.TWO_HOURS=2*t.ONE_HOUR;t.ONE_DAY=24*t.ONE_HOUR;t.TWO_DAYS=2*t.ONE_DAY;t.ONE_WEEK=7*t.ONE_DAY;t.ONE_MONTH=32*t.ONE_DAY;t.isSameDay=function(e,n){return e.getDate()===n.getDate()&&Math.abs(n.getTime()-e.getTime())<t.ONE_DAY};t.isSameMonth=function(e,t){return e.getFullYear()===t.getFullYear()&&t.getMonth()===e.getMonth()};t.isSameYear=function(e,t){return e.getFullYear()===t.getFullYear()};t.isThisWeek=function(e,n){n=n||new Date;var r=new Date(n.getTime()-n.getDay()*t.ONE_DAY),i=new Date(r.getTime()+t.ONE_WEEK-t.ONE_DAY);return r.getTime()<=e.getTime()&&e.getTime()<=i.getTime()};t.isLastWeek=function(e,n){n=n||new Date;var r=new Date(n.getTime()-n.getDay()*t.ONE_DAY-t.ONE_WEEK),i=new Date(r.getTime()+t.ONE_WEEK-t.ONE_DAY);return r.getTime()<=e.getTime()&&e.getTime()<=i.getTime()};t.getLastDayOfMonth=function(e){var t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0));t.setUTCMonth(t.getUTCMonth()+1);t.setUTCDate(t.getUTCDate()-1);t.setUTCHours(23,59,59,999);return t};t.toLocaleDateString=function(e,t,n){if(e)try{return e.toLocaleDateString(t,n)}catch(t){return e.toLocaleDateString([],n)}};t.toLocaleTimeString=function(e,t,n){if(e)try{return e.toLocaleTimeString(t,n)}catch(t){return e.toLocaleTimeString([],n)}};t.isLastAFewDays=function(e,n,r){r=r||new Date;return new Date(r.getTime()-t.ONE_DAY*n).getTime()<=e.getTime()&&e.getTime()<=r.getTime()}});
define("HS",["require","exports","ww","VS","jS","BS","NS","RS"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t)});
define("NS",["require","exports","we"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.iso8601DateTimeToJsDate=function(e){return new Date(e)};t.convertDateToISOString=function(e,t){void 0===t&&(t=!1);var r=new Date(e),i=r.getTimezoneOffset()<0,s=r.getFullYear()+"",o=n.leftPad(r.getMonth()+1+"",2),u=n.leftPad(r.getDate()+"",2),a=n.leftPad(r.getHours()+"",2),f=n.leftPad(r.getMinutes()+"",2),l=n.leftPad(r.getSeconds()+"",2),c=(i?"+":"-")+n.leftPad(i?(Math.ceil(r.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(r.getTimezoneOffset()/60)+"",2)+n.leftPad((r.getTimezoneOffset()%60).toString().replace("-",""),2);return t?s+"-"+o+"-"+u+"T"+a+":"+f+":"+l+c:s+o+u+"T"+a+f+l+c}});
define("jS",["require","exports","we","BS","GS"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t,n){void 0===n&&(n=!1);var i=Date.now()-e.getTime();if(i<-5*r.ONE_MINUTE)return f(e,t);if(i<r.ONE_MINUTE)return o("LessThanAMinute",n);if(i<r.TWO_MINUTES)return o("AboutAMinute",n);if(i<r.ONE_HOUR){return u(Math.floor(i/r.ONE_MINUTE),"XMinutes")}if(i<r.TWO_HOURS)return o("AboutAnHour",n);if(i<r.ONE_DAY){return u(Math.floor(i/r.ONE_HOUR),"XHours")}if(i<r.TWO_DAYS){var s=e.toLocaleTimeString(t);return o("YesterdayAndTime",n).replace("{0}",s)}if(i<r.ONE_MONTH){return u(Math.floor(i/r.ONE_DAY),"XDays")}return f(e,t)}t.getRelativeDateTimeStringPast=s;t.getRelativeDateTimeStringPastWithHourMinute=function(e,t){var o=Date.now()-e.getTime(),u=e.toLocaleDateString(t),a=e.toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"});return o<r.ONE_DAY?s(e,t):o<r.TWO_DAYS?n.format(i.default.RelativeDateTime_YesterdayAndTime,a):n.format(i.default.DateTime_DateAndTime,u,a)};function o(e,t,n,r){return i.default[["RelativeDateTime_",e,n?"Future":"",r?"Intervals":"",t?"_StartWithLowerCase":""].join("")]}t.getRelativeDateTimeResx=o;function u(e,t,r,i){var s=o(t,!!i&&r,i),u=o(t,!1,i,!0);return(n.getLocalizedCountValue(s,u,e)||"").replace("{0}",e+"")}t.getRelativeDateTimeIntervalString=u;var a={};function f(e,t){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){a[t]||(a[t]=new Intl.DateTimeFormat(t));return a[t].format(e)}return e.toLocaleDateString(t)}});
define("RS",["require","exports","we","jS","GS"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRelativeDateTimeStringForLists=function(e,t){void 0===t&&(t=!1);var s=e.split("|");if("0"===s[0])return e.substring(2);var o="1"===s[1],u=s[2],a=s[3]||"",f=s[4]||"";switch(u){case"1":return r.getRelativeDateTimeResx("AFewSeconds",t,o);case"2":return r.getRelativeDateTimeResx("AboutAMinute",t,o);case"3":return r.getRelativeDateTimeIntervalString(Number(a),"XMinutes",t,o);case"4":return r.getRelativeDateTimeResx("AboutAnHour",t,o);case"5":return a?n.format(r.getRelativeDateTimeResx(o?"TomorrowAndTime":"YesterdayAndTime",t),a):r.getRelativeDateTimeResx(o?"Tomorrow":"Yesterday",t);case"6":return r.getRelativeDateTimeIntervalString(Number(a),"XHours",t,o);case"7":return f?n.format(i.default.RelativeDateTime_DayAndTime,a,f):a;case"8":return r.getRelativeDateTimeIntervalString(Number(a),"XDays",t,o);case"9":return r.getRelativeDateTimeResx("Today",t)}return null}});
define("N",["require","exports","ww","B"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r.name="ApiError";var i=t.innerError,s=i||void 0,o=s?n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},"string"==typeof s.correlationId?{correlationId:s.correlationId}:{}),"boolean"==typeof s.isExpected?{isExpected:s.isExpected}:{}),"string"==typeof s.name?{code:s.name}:{}),"string"==typeof s.code?{code:s.code}:{}),"object"==typeof s.extraData?{extraData:s.extraData}:{}):{},u=t.correlationId,a=void 0===u?o.correlationId:u,f=t.isExpected,l=void 0===f?o.isExpected:f,c=t.extraData;r.correlationId=a;r.isExpected=!!l;r.code=t.code||o.code||"";r.extraData=n.__assign(n.__assign({},o.extraData||{}),c||{});return r}return t})(r.CustomError);t.ApiError=i});
define("B",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);this.message=t.message;this.innerError=e.innerError;this.stack=t.stack;this.name=t.name;for(var n in this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var r=Object.getPrototypeOf(this);Error.captureStackTrace&&Error.captureStackTrace(t,r);if(Object.setPrototypeOf){Object.setPrototypeOf(t,r);return t}};t.CustomError=n;if(Object.setPrototypeOf){n.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}});Object.setPrototypeOf(n,Error)}});
define("zne",["require","exports","Iq","AS"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e[e.cover=0]="cover";e[e.center=1]="center";e[e.fit=2]="fit";e[e.fitExpand=3]="fitExpand";e[e.fitExpandHeight=4]="fitExpandHeight";e[e.fitExpandWidth=5]="fitExpandWidth";e[e.fitWidth=6]="fitWidth";e[e.fitHeight=7]="fitHeight";e[e.top=8]="top"})(i=t.AlignmentType||(t.AlignmentType={}));var s=function(e,t){this.name=e;this.getTransform=t};function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new s(e.map(function(e){return e.name}).join("-"),function(t,r){for(var i=n.default.IDENTITY,s=0,o=e;s<o.length;s++){var u=o[s],a={width:t.width*i.scale,height:t.height*i.scale};i=u.getTransform(a,r).multiply(i)}return i})}t.center=new s(i[i.center],function(e,t){var i=new r.default((t.width-e.width)/2,(t.height-e.height)/2);return new n.default(i)});t.top=new s(i[i.top],function(e,t){var i=new r.default((t.width-e.width)/2,0);return new n.default(i)});t.fitWidth=new s(i[i.fitWidth],function(e,t){var i=t.width/e.width;return new n.default(r.default.ORIGIN,Math.min(i,1))});t.fitHeight=new s(i[i.fitHeight],function(e,t){var i=t.height/e.height;return new n.default(r.default.ORIGIN,Math.min(i,1))});t.fit=new s(i[i.fit],function(e,n){return(e.width/e.height>n.width/n.height?t.fitWidth:t.fitHeight).getTransform(e,n)});t.fitExpandWidth=new s(i[i.fitExpandWidth],function(e,t){var i=t.width/e.width;return new n.default(r.default.ORIGIN,i)});t.fitExpandHeight=new s(i[i.fitExpandHeight],function(e,t){var i=t.height/e.height;return new n.default(r.default.ORIGIN,i)});t.fitExpand=new s(i[i.fitExpand],function(e,n){return(e.width/e.height>n.width/n.height?t.fitExpandWidth:t.fitExpandHeight).getTransform(e,n)});t.cover=new s(i[i.cover],function(e,n){return(e.width/e.height>n.width/n.height?t.fitHeight:t.fitWidth).getTransform(e,n)});t.fitCenter=o(t.fit,t.center);t.fitExpandCenter=o(t.fitExpand,t.center);t.coverCenter=o(t.cover,t.center);function u(e){var n,r;if("string"==typeof e)n=i[e];else{if((function(e){return"object"==typeof e})(e))return e;n=e}switch(n){case i.top:r=t.top;break;case i.fitHeight:r=t.fitHeight;break;case i.fitWidth:r=t.fitWidth;break;case i.fit:r=t.fitCenter;break;case i.fitExpand:r=t.fitExpandCenter;break;case i.center:r=t.center;break;default:r=t.coverCenter}return r}t.getAlignment=u;t.createAlignment=function(e){var t;t=e instanceof Array?e:[e];return o.apply(void 0,t.map(u))}});
define("W2",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}t.parseTokenHeader=function(e){return e?n(decodeURIComponent(e).split(".")[0]):{}};t.parseTokenPayload=function(e){return e?n(decodeURIComponent(e).split(".")[1]):{}};t.isHashedProofToken=function(e){return!!e&&"hashedprooftoken"===e.ver};t.getAppId=function(e){if(e){var t=e.azp||e.appid;if(t)return t;var n=e.nameid;return n&&"true"!==e.isuser&&n.split("@")[0]||void 0}};t.getTenantId=function(e){if(e){if(e.tid)return e.tid;var t=e.nameid;return t&&t.split("@")[1]||void 0}};t.parseTimestamp=function(e){return isNaN(e)?NaN:1e3*e};t.isTokenValid=function(e,t){void 0===t&&(t=Date.now());var n=t/1e3;if(!e)return!1;var r=e.exp,i=e.nbf;return("number"!=typeof i||n>=i)&&("number"!=typeof r||n<r)}});
define("V2",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){var e=[];return{register:function(t){return""+(e.push(t)-1)},unregister:function(t){e[parseInt(t,10)]=0},dispatch:function(t){e.forEach(function(e){return e&&e(t)})}}}});
var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};define("B2",["require","exports","V2","j2"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["markAppBoot","markHeaderBoot","markSbInteractive","markSbReady","markZeroQueryReady","markSearchLayoutMount","markSearchLayoutRenderStart"],s={markAppBoot:[],markHeaderBoot:["markAppBoot"],markSbInteractive:["markHeaderBoot"],markSbReady:["markSbInteractive"],markZeroQueryReady:["markSbReady"],SbQuerySubmitted:["markSbReady"],SerpRouteChange:[],SerpFetchStart:["SbQuerySubmitted"],SerpAnswerFetchDone:["SerpFetchStart"],SerpFetchDone:["SerpFetchStart"],SerpAnswersRenderDone:["markAppBoot","SbQuerySubmitted","SerpRouteChange","SerpFetchStart","SerpAnswerFetchDone"],SerpDataReady:["SerpFetchStart","SerpFetchDone"],SerpRenderDone:["markAppBoot","SbQuerySubmitted","markSearchLayoutMount","markSearchLayoutRenderStart","SerpPrefetchStart","SerpPrefetchDone","SerpConfigStart","SerpConfigDone","SerpRouteChange","SerpFetchStart","SerpDataReady","SerpFetchDone","SerpFullPageLoad","SerpInPlaceNavigation","RouterHistoryChange"],markSearchLayoutMount:["SbQuerySubmitted"],markSearchLayoutRenderStart:["SbQuerySubmitted","markSearchLayoutMount"],SerpPrefetchStart:[],SerpPrefetchDone:["SerpPrefetchStart"],SerpConfigStart:[],SerpConfigDone:["SerpConfigStart"],SerpFullPageLoad:[],SerpInPlaceNavigation:[],RouterHistoryChange:[],SetRefinersFromDeepLinkQueryStart:[],SetRefinersFromDeepLinkQueryDone:[],CreateCustomAggregationsStart:[],CreateCustomAggregationsDone:[],UpdateAvailableRefinersStart:[],UpdateAvailableRefinersDone:[],UpdateRefinersStart:[],ClearRefinersStart:[],SerpOldRefinerButtonClick:[],SerpRefinersCheck:["UpdateAvailableRefinersStart"],SerpRefinersRenderDone:["SerpConfigStart","SerpConfigDone","SerpFetchStart","SerpRouteChange","SerpDataReady","SerpFetchDone","UpdateRefinersStart","ClearRefinersStart","SetRefinersFromDeepLinkQueryStart","SetRefinersFromDeepLinkQueryDone","CreateCustomAggregationsStart","CreateCustomAggregationsDone","UpdateAvailableRefinersStart","UpdateAvailableRefinersDone","SerpOldRefinerButtonClick"]},o=function(){var e,t,n=function(){var e={},t=!1,n=function(t){var n=r.default();e[t]=n;return n};return{conversationId:r.default(),creationTime:Date.now(),getSubmittedState:function(){return t},submit:function(){t=!0},createLogicalSearchId:n,getLogicalSearchId:function(t){return e[t]||n(t)}}},i=function(){e&&e.getSubmittedState()&&(t=e);var r=n();e=r;return r};return{startConversation:i,getActiveConversation:function(){return!e||e.getSubmittedState()?i():e},getLastSubmittedConversation:function(){if(e&&e.getSubmittedState())return e;if(!t){var r=n();r.submit();t=r}return t}}};t.default=function(e){var t=e,r={},u=i.reduce(function(e,n,s){e[n]=function(){if(!r[n]){r[n]=!0;t.perf.mark(n)}if(s)try{t.perf.measure(i[s-1]+"-"+n,i[s-1],n)}catch(e){}};return e},{}),a={};return __assign(__assign(__assign({},n.default()),u),{conversationManager:o(),props:t,setProps:function(e){this.props=t=__assign(__assign({},this.props),e);this.dispatch(e);return t},mark:function(e){var n=[];t.perf.mark(e);for(var r=0,i=s[e]||[];r<i.length;r++){var o=i[r];try{var u=o+"-"+e;t.perf.measure(u,o,e);var f=t.perf.getEntriesByName(u).pop();f&&f.startTime>(a[e]||0)&&n.push(f)}catch(e){}}if(n.length>0){var l=Math.max.apply(Math,n.map(function(e){return e.startTime}));a[e]=l}return n}})}});
define("j2",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}});
define("Ia",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileTypeIconMap={accdb:{extensions:["accdb","mdb"]},archive:{extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{extensions:["aif","aiff","aac","alac","amr","ape","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","oga","ra","rm","wav","wma","wv"]},calendar:{extensions:["ical","icalendar","ics","ifb","vcs"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","cbl","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","h","h++","haml","handlebars","hbs","hcp","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsproj","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","ps1xml","psd1","psm1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","shtml","sml","svn-base","swift","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},contact:{extensions:["vcf"]},csv:{extensions:["csv"]},desktopfolder:{},docset:{},documentfolder:{},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{extensions:["eml","msg","ost","pst"]},exe:{extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},folder:{},font:{extensions:["ttf","otf","woff"]},fluid:{extensions:["b","fluid"]},genericfile:{},html:{extensions:["htm","html","mht"]},link:{extensions:["lnk","link","url","website","webloc"]},linkedfolder:{},listitem:{},officescript:{extensions:["osts"]},splist:{extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layer","layout","max","mtl","obj","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},multiple:{},one:{extensions:["note","one"]},onetoc:{extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pbiapp:{},pdf:{extensions:["pdf"]},photo:{extensions:["arw","bmp","cr2","crw","dic","dicm","dcm","dcm30","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psb","psd","raw","tga","tif","tiff","wdp"]},photo360:{},picturesfolder:{},potx:{extensions:["pot","potm","potx"]},powerbi:{extensions:["pbids","pbix"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx","classifier"]},sponews:{},spreadsheet:{extensions:["odc","ods","gsheet","numbers","tsv"]},stream:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{},sway:{},sysfile:{extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","ldt","lrprev","pkpass","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xlb","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vaultclosed:{},vaultopen:{},vector:{extensions:["ai","ait","cvs","dgn","gdraw","pd","emf","eps","fig","ind","indd","indl","indt","indb","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vdx","vsd","vsdm","vsdx","vsw","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx","vsx"]},xlsx:{extensions:["xlc","xls","xlsb","xlsm","xlsx","xlw"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{extensions:["zip"]}}});
(function(g,f){"use strict";var h=function(e){if("object"!==typeof e.document)throw Error("Cookies.js requires a `window` with a `document` object");var b=function(a,d,c){return 1===arguments.length?b.get(a):b.set(a,d,c)};b._document=e.document;b._cacheKeyPrefix="cookey.";b._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC");b.defaults={path:"/",secure:!1};b.get=function(a){b._cachedDocumentCookie!==b._document.cookie&&b._renewCache();return b._cache[b._cacheKeyPrefix+a]};b.set=function(a,d,c){c=b._getExtendedOptions(c); c.expires=b._getExpiresDate(d===f?-1:c.expires);b._document.cookie=b._generateCookieString(a,d,c);return b};b.expire=function(a,d){return b.set(a,f,d)};b._getExtendedOptions=function(a){return{path:a&&a.path||b.defaults.path,domain:a&&a.domain||b.defaults.domain,expires:a&&a.expires||b.defaults.expires,secure:a&&a.secure!==f?a.secure:b.defaults.secure}};b._isValidDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)&&!isNaN(a.getTime())};b._getExpiresDate=function(a,d){d=d||new Date; "number"===typeof a?a=Infinity===a?b._maxExpireDate:new Date(d.getTime()+1E3*a):"string"===typeof a&&(a=new Date(a));if(a&&!b._isValidDate(a))throw Error("`expires` parameter cannot be converted to a valid Date instance");return a};b._generateCookieString=function(a,b,c){a=a.replace(/[^#$&+\^`|]/g,encodeURIComponent);a=a.replace(/\(/g,"%28").replace(/\)/g,"%29");b=(b+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent);c=c||{};a=a+"="+b+(c.path?";path="+c.path:"");a+=c.domain?";domain="+c.domain: "";a+=c.expires?";expires="+c.expires.toUTCString():"";return a+=c.secure?";secure":""};b._getCacheFromString=function(a){var d={};a=a?a.split("; "):[];for(var c=0;c<a.length;c++){var e=b._getKeyValuePairFromCookieString(a[c]);d[b._cacheKeyPrefix+e.key]===f&&(d[b._cacheKeyPrefix+e.key]=e.value)}return d};b._getKeyValuePairFromCookieString=function(a){var b=a.indexOf("="),b=0>b?a.length:b;return{key:decodeURIComponent(a.substr(0,b)),value:decodeURIComponent(a.substr(b+1))}};b._renewCache=function(){b._cache= b._getCacheFromString(b._document.cookie);b._cachedDocumentCookie=b._document.cookie};b._areEnabled=function(){var a="1"===b.set("cookies.js",1).get("cookies.js");b.expire("cookies.js");return a};b.enabled=b._areEnabled();return b},e="object"===typeof g.document?h(g):h;"function"===typeof define&&define.amd?define("Uxe",["require","exports","module"],function(){return e}):"object"===typeof exports?("object"===typeof module&&"object"===typeof module.exports&&(exports=module.exports=e),exports.Cookies=e):g.Cookies=e})("undefined"===typeof window? this:window);
define("XPe",["require","exports","ZPe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){this.AddCoverPhotoAction=n.default;this.AddExistingAppViewAction=n.default;this.AddFlowAction=n.default;this.AddPhotosToAlbumAction=n.default;this.AddToAlbumAction=n.default;this.AddToBundleAction=n.default;this.AddToFolderAction=n.default;this.AddToFolderAction=n.default;this.AddToQuickLaunchAction=n.default;this.AddToSharedListAction=n.default;this.AddToSpotlightAction=n.default;this.AlertAction=n.default;this.ApplyOfficeLensAction=n.default;this.ApproveRejectAction=n.default;this.AuthenticationPolicyWarningAction=n.default;this.AutoExecuteAction=n.default;this.CancelEditAction=n.default;this.ChangeAppViewVisibilityAction=n.default;this.ChangeFolderTypeAction=n.default;this.CheckInAction=n.default;this.CheckOutAction=n.default;this.ClearFilterAction=n.default;this.ClearSelectionAction=n.default;this.ComplianceDetailsAction=n.default;this.ContentTypeNavigationAction=n.default;this.LaunchConfigureFlowsPanelAction=n.default;this.CopyFieldAction=n.default;this.CopyFormAction=n.default;this.CreateAlbumAction=n.default;this.CreateAlbumFromFolderAction=n.default;this.CreateAppViewAction=n.default;this.CreateColumnAction=n.default;this.CreateCustomDocumentAction=n.default;this.CreateDocumentAction=n.default;this.CreateFileRequestAction=n.default;this.CreateFolderAction=n.default;this.CreateItemAction=n.default;this.CreateMountPointAction=n.default;this.CreateNewFolderAction=n.default;this.CreateSitePageAction=n.default;this.CustomActionNavigationAction=n.default;this.CustomizeClientFormAction=n.default;this.CustomizeFormsNavigationAction=n.default;this.CustomizeViewAction=n.default;this.DefaultClickAction=n.default;this.DeleteAction=n.default;this.DeleteTemplateAction=n.default;this.DeleteAppAction=n.default;this.DeleteViewAction=n.default;this.DiscardAutoAlbumAction=n.default;this.DownloadAction=n.default;this.DownloadZipContentsAction=n.default;this.EditAction=n.default;this.EditItemAction=n.default;this.EditItemCancelAction=n.default;this.EditItemSaveAction=n.default;this.EditNewAppViewAction=n.default;this.EditNewMenuAction=n.default;this.EditNewMenuPaneAction=n.default;this.EditRenditionsAction=n.default;this.EditTagsAction=n.default;this.EmbedAction=n.default;this.EmptyRecycleBinAction=n.default;this.ExportListAction=n.default;this.ExternalNavigateAction=n.default;this.FeedbackAction=n.default;this.FileHandlerOpenAction=n.default;this.FilterAction=n.default;this.FilterSearchAction=n.default;this.FilterSearchByDateAction=n.default;this.GetLinkAction=n.default;this.GroupItemsAction=n.default;this.ImplicitSaveAutoAlbumAction=n.default;this.InvokeFirstRunExperienceAction=n.default;this.LanguagePickerAction=n.default;this.LaunchChangeTheLookPanelAction=n.default;this.LaunchColumnCustomizationPaneAction=n.default;this.LaunchColumnManagementPanelAction=n.default;this.LaunchCreateAppViewPanelAction=n.default;this.LaunchCreateGroupPanelAction=n.default;this.LaunchCreateListDialog=n.default;this.LaunchCreateShortcutPanel=n.default;this.LaunchFilterPanelAction=n.default;this.LaunchFlowWidgetPanelAction=n.default;this.LaunchFormatViewPaneAction=n.default;this.LaunchGroupifyPanelAction=n.default;this.LaunchGroupMembershipPanelAction=n.default;this.LaunchListCreationPanelAction=n.default;this.LaunchListFormAction=n.default;this.LaunchMoveCopyPanelAction=n.default;this.LaunchSitePermissionsPanelAction=n.default;this.LaunchSiteSettingsPanelAction=n.default;this.LaunchGlobalNavSettingsPanelAction=n.default;this.LaunchWebTemplatesGalleryAction=n.default;this.LaunchUserExpirationPanelAction=n.default;this.ListFormActivityPaneToggleAction=n.default;this.MakeHomepageAction=n.default;this.VaultAction=n.default;this.ModifyColumnAction=n.default;this.ModifyShowInFiltersPaneAction=n.default;this.MoveCopyAction=n.default;this.MoveLeftSpotlightAction=n.default;this.MoveRightSpotlightAction=n.default;this.NavigateToItemAction=n.default;this.NavigateToSharePointHomeAction=n.default;this.NavigationAction=n.default;this.OneDriveSortAction=n.default;this.OpenAction=n.default;this.OpenChatAction=n.default;this.OpenAppAction=n.default;this.OpenHyperlinkAction=n.default;this.OpenInExplorerAction=n.default;this.OpenInfoPathAction=n.default;this.OpenInOfficeClientAction=n.default;this.OpenInOfficeOnlineAction=n.default;this.OpenInSharePointAction=n.default;this.OpenInDesktopAction=n.default;this.OpenInTextEditorAction=n.default;this.OpenNeedsAttentionViewAction=n.default;this.OpenPdfInBrowserAction=n.default;this.OpenInPowerBIAction=n.default;this.OpenShortcutAction=n.default;this.OpenSiteAction=n.default;this.OrderPrintsAction=n.default;this.PinToMruAction=n.default;this.PlayAudioAction=n.default;this.PlaySlideShowAction=n.default;this.PolicyTipAction=n.default;this.PreviewAction=n.default;this.PrintPdfAction=n.default;this.PublishAction=n.default;this.RearrangeAction=n.default;this.RedeemAction=n.default;this.RedeemCodeAction=n.default;this.RemoveCoverPhotoAction=n.default;this.RemoveFromAlbumAction=n.default;this.RemoveFromBundleAction=n.default;this.RemoveFromRecentAction=n.default;this.RemoveFromSharedListAction=n.default;this.RemoveFromSpotlightAction=n.default;this.RemoveMountPointAction=n.default;this.RemoveOfficeLensAction=n.default;this.RemoveTagAction=n.default;this.RemoveTagFromItemAction=n.default;this.RenameAction=n.default;this.RenameColumnAction=n.default;this.ReportAbuseAction=n.default;this.RequestReviewAction=n.default;this.RestoreAction=n.default;this.RestoreAllAction=n.default;this.RestoreFilesAction=n.default;this.RotateAction=n.default;this.SaveAction=n.default;this.SaveAutoAlbumAction=n.default;this.SaveSortOrderAction=n.default;this.SaveViewAction=n.default;this.SeeAllAppsAction=n.default;this.SelectAction=n.default;this.SelectAllAction=n.default;this.SetAlbumCoverPhotoAction=n.default;this.SetDefaultViewAction=n.default;this.SetFocusAction=n.default;this.SetPhotosRootAction=n.default;this.SetUpApprovalFlowAction=n.default;this.SetUpReminderFlowAction=n.default;this.ShareAction=n.default;this.ShareByLinkAction=n.default;this.ShowExistingFlowsAction=n.default;this.ShowFiltersAction=n.default;this.ShowItemAnalyticsAction=n.default;this.ShowSuggestedFilesAction=n.default;this.ShowKeyPointsAction=n.default;this.ShowKeyboardMapAction=n.default;this.ShowMalwareDetectedAction=n.default;this.ShowOperationsAction=n.default;this.ShowPermissionsAction=n.default;this.ShowPropertiesAction=n.default;this.ShowRunReportAction=n.default;this.ShowSelectionAction=n.default;this.ShowVersionHistoryAction=n.default;this.SignOutAction=n.default;this.StopSlideShowAction=n.default;this.SurveyAction=n.default;this.SwitchPhotoFolderLayoutTypeAction=n.default;this.SwitchSharingLinkAction=n.default;this.SwitchViewAction=n.default;this.SyncAction=n.default;this.SynchronizeAppViewAction=n.default;this.LaunchTeamChannelAction=n.default;this.ToggleAction=n.default;this.ToggleDebugWindowAction=n.default;this.ToggleListLayoutAction=n.default;this.ToggleSelectionModeAction=n.default;this.TriggerFlowAction=n.default;this.TriggerFlowByIdAction=n.default;this.TriggerODBConvertToPdfFlowAction=n.default;this.TriggerODBRequestSignOffFlowAction=n.default;this.TriggerSignoffFlowAction=n.default;this.UndoCheckOutAction=n.default;this.UnPublishAction=n.default;this.UpdateCaptionAction=n.default;this.UpdatePermissionsAction=n.default;this.UploadAction=n.default;this.UploadTemplateAction=n.default;this.QuotaBlockAction=n.default;this.ViewInFolderAction=n.default;this.ViewItemAction=n.default;this.ViewOriginalAction=n.default;this.WorkflowAction=n.default};t.default=r});
define("QPe",["require","exports","ww","oB","W","LO","Ex","pO","T2","A","rB","EI","dz","p$","UDe","cB","sB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openEngagementPart=void 0;t.openEngagementPart=new v.EngagementPart("Open",2);var g=(function(e){n.__extends(r,e);function r(n,r){void 0===r&&(r={});var i=e.call(this,n,r)||this;i.name="DefaultClick";i.isQosLogged=!1;var o=n.item,f=n.userInvokedItem,c=void 0!==f&&f,p=n.hideIfDefaultIsDownload,d=void 0!==p&&p,m=n.sourceEngagement,g=void 0===m?"":m,y=i,b=y.resources,w=y.observables;b.expose(v.engagementSourceResourceKey,b.consume(v.engagementSourceResourceKey).withPart(t.openEngagementPart));i._itemSelectionHelper=new(i.child(h.typeResourceKey))({overrideItem:o,allowMultiSelect:!1,canFallback:!1});i.item=i._itemSelectionHelper.firstItem;i.sourceEngagement=g;i.userInvokedItem=c;i.hideIfDefaultIsDownload=d;i.actionMap=b.consume(s.actionMap);i.urlDataSource=b.consume(u.url);i.viewParams=b.consume(s.viewParams);i._isFilePickerPage=w.pureCompute(i._computeIsFilePickerPage);i._action=w.pureCompute(i._computeAction);i._action.equalityComparer=l.objectStrictEquality;i._instrumentationProvider=b.consume(a.instrumentation);return i}r.prototype.onIsAvailable=function(){var e=this.observables.peekUnwrap(this._action);return!!e&&e.isAvailable()};r.prototype.onExecute=function(e){var t=this.observables,n=t.peekUnwrap(this.item);this._logEngagement(n,e);var r=this._instrumentationProvider;r&&n&&r.userClickItem(n);var s=t.peekUnwrap(this._action);return s&&s.execute(e)||f.default.resolve({resultType:i.ResultTypeEnum.ExpectedFailure})};r.prototype.onComputeAction=function(){return new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item})};r.prototype._computeIsFilePickerPage=function(){return this.urlDataSource.getPageType(this.viewParams())===c.default.FilePicker};r.prototype._computeAction=function(){var e,t=this._lastAction;if(t){t.dispose();this._lastAction=void 0}var n=this.item();this._isFilePickerPage()&&n&&n.type!==o.default.Folder||(e=this.onComputeAction());this._lastAction=e;return e};r.prototype._logEngagement=function(e,t){var n=this.sourceEngagement;if(n){var r;if(e)switch(e.type){case o.default.File:r="FileOpen."+n;break;case o.default.Folder:r="FolderOpen."+n;break;case o.default.App:r="AppOpen."+n;break;case o.default.Subsite:r="SubsiteOpen."+n;break;default:r="Open."+n}else r="Open."+n;this.resources.consume(m.resourceKey).withPart(d.clickEngagementPart).withPart(p.itemEngagementPart,{item:e}).logData({name:r,extraData:{action:t?t.type:"unknown"}})}};return r})(r.default);t.default=g});
define("JPe",["require","exports","ww","oB","A","C","See","T2"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.create=void 0;var a=(function(e){n.__extends(t,e);function t(t){var n=this,r=t.load,o=t.actionParams,a=(n=e.call(this,o)||this).resources.consume(u.bundleLoader.optional);n.isQosLogged=!1;n.name=("Deferred"+t.modulePath).replace(/Action|\.|\//g,"");n._action=n.createObservable();var f=new s.default;(a?a.waitForPLT().then(r):i.default.resolve(r())).done(function(e){return f.complete(e)},function(e){return f.error(e)});n._getActionPromise=n.trackPromise(f.getPromise().then(function(e){return new(n.managed(e))(o)}));n._getActionPromise.done(function(e){return n._action(e)});n.inputType=n.createPureComputed(n._computeInputType);return n}t.prototype.onIsAvailable=function(){return!!this._action()&&this._action().isAvailable()};t.prototype.onIsToggled=function(){return!!this._action()&&this._action().isToggled()};t.prototype.onExecute=function(e,t){return this._getActionPromise.then(function(t){return t.execute(e)})};t.prototype._computeInputType=function(){var e=this._action();return e&&e.inputType?e.inputType():o.default.none};return t})(r.default);t.create=function(e,t){var r;function i(){return r||(r=t())}return(function(t){n.__extends(r,t);function r(n){return t.call(this,{load:i,modulePath:e,actionParams:n})||this}return r})(a)}});
define("qX",["require","exports","ww","oB","A","W","tg","LO","Nx","je","v"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=void 0;var c=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Navigation";var i=t.url,s=t.viewParams,a=t.target,f=void 0===a?"_top":a,l=t.forceNavigation,c=void 0!==l&&l,h=t.ignoreHistory,p=t.beforeNavigation,d=t.afterNavigation,v=t.postProcessUrl,m=n.navigation,g=void 0===m?r.resources.consume(o.navigation):m,y=n.viewParamsObservable,b=void 0===y?r.resources.consume(u.viewParams):y;r._navigation=g;r._viewParams=b;r._url=r.wrapObservable(i);r._inputViewParams=r.wrapObservable(s);r._target=r.wrapObservable(f);r._forceNavigation=c;r._ignoreHistory=h;r._beforeNavigation=p;r._afterNavigation=d;r._postProcessUrl=v;return r}t.prototype.onExecute=function(e,t){var n=this._url.peek(),r=this._inputViewParams.peek(),o=this._beforeNavigation;o&&o(this._navigation);var u=this._postProcessUrl?this._postProcessUrl(n):n;(this._forceNavigation||n)&&this._navigation.navigateTo({url:u,viewParams:r,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory});this._afterNavigation&&this._afterNavigation(this._navigation);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),r="#"+a.serializeQuery(n),i=t&&0===t.indexOf("#")?t.substring(1):"",s=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(s){var o=a.deserializeQuery(s);return!f.deepCompare(n,o)}return e!==r};t.dependencies={resources:l.resourceScopeKey,navigation:o.navigation,viewParamsObservable:u.viewParams};return t})(r.default);t.default=c;t.typeResourceKey=l.createResolvedTypeResourceKey(e("module").id,c)});
define("G$",["require","exports","ww","oB","A","W","p$","sz","LO","Ex","dz","je"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenAction=void 0;var h=new u.default,p=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Open";var i=t.item,s=t.openRelation,o=void 0===s?0:s,u=t.ignoreHistory,f=void 0!==u&&u,c=t.itemSet,h=t.openLocal,p=void 0!==h&&h,d=t.focusUrl,v=void 0!==d&&d,m=t.preserveAction,g=void 0!==m&&m,y=t.nonFoldersOnly,b=void 0!==y&&y;r._openRelation=o;r._nonFoldersOnly=b;r._focusUrl=r.wrapObservable(v);r._itemSelectionHelper=new(r.child(l.typeResourceKey))({overrideItem:2===o?i:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o});r.item=r.createComputed(r._computeItem,{deferEvaluation:!0,pure:!0});var w=r.resources.consume(a.actionMap);r._navigateToItemAction=new(r.managed(w.NavigateToItemAction))({item:r.item,itemSet:c,parentItem:r._itemSelectionHelper.currentItem,forceAsFocusItem:r.createPureComputed(r._computeForceAsFocusItem),forceInSameWindow:p,isRedirect:f,shouldPreserveAction:g});return r}t.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||!!e&&!e.folder)&&this._navigateToItemAction.isAvailable()};t.prototype.onExecute=function(e,t){var n=this.item.peek();if(!n)return i.default.resolve({resultType:s.ResultTypeEnum.ExpectedFailure});n.type===f.default.Folder&&t&&t.data&&(t.data.folder=!0);t.data.extraData||(t.data.extraData={});c.extend(t.data.extraData,{uniqueId:n.properties?n.properties.uniqueId:void 0});return this._navigateToItemAction.execute(e).then(function(){var e={fileType:f.default[n.type||f.default.Unknown],extension:n.extension||""};return i.default.resolve({resultType:s.ResultTypeEnum.Success,extraData:e})})};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(o.itemEngagementPart,{item:this.item.peek()})};t.prototype.trackUserAction=function(t){var n=this.item.peek();if(n)switch(n.type){case f.default.File:e.prototype.trackUserAction.call(this,"Open.File");break;case f.default.Media:e.prototype.trackUserAction.call(this,"Open.Media");break;default:e.prototype.trackUserAction.call(this,t)}};t.prototype._computeItem=function(){var e,t=this._itemSelectionHelper.firstItem();switch(this._openRelation){case 3:e=t&&t.parent;break;case 1:case 2:e=t;break;default:case 0:e=t}return e||h};t.prototype._computeForceAsFocusItem=function(){return this._focusUrl()};return t})(r.default);t.OpenAction=p;t.default=p});
define("V$",["require","exports","ww","oB","A","W","dz","pO","Ex","wx","xv"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DesktopActionType=void 0;var c;(function(e){e[e.DefaultClick=0]="DefaultClick";e[e.OpenInOfficeOnline=1]="OpenInOfficeOnline";e[e.OpenFileLocation=2]="OpenFileLocation";e[e.OpenItemActivityItem=3]="OpenItemActivityItem";e[e.OpenPdfInBrowser=4]="OpenPdfInBrowser"})(c=t.DesktopActionType||(t.DesktopActionType={}));var h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.item,i=t.openRelation,s=void 0===i?0:i,a=t.actionType;n.name="OpenInDesktop";n._itemSelectionHelper=new(n.child(o.typeResourceKey))({overrideItem:2===s?r:void 0,allowMultiSelect:!1,canFallback:0!==s,ignoreSelection:0!==s});n._urlDataSource=n.resources.consume(u.url);n._actionType=a;return n}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem(),r={id:n.id,name:n.name,actionType:c[this._actionType],queryType:l.default[n.queryType],itemType:a.default[n.type],openUrl:n.openUrl,parentUrl:n.parentLink,shortcutUrl:n.urls[f.default.shortcutTarget],siteUrl:this._urlDataSource.getCurrentSiteUrl(),fullItemUrl:this._urlDataSource.getItemUrl(n.key),extension:n.extension};window.external.notify(JSON.stringify(r));return i.default.wrap({resultType:s.ResultTypeEnum.Success})};return t})(r.default);t.default=h});
define("NPe",["require","exports","ww","oB","p$","pO","QX","N$","dz","LO","dv","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h="4DF83139-3BF3-4543-81F8-8AE4BF66F8B3",p=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInOfficeOnline";var r=t.openLocal,i=void 0!==r&&r,u=t.forceReadOnly,p=void 0!==u&&u,d=t.useDefaultAction,v=void 0!==d&&d;n._forceReadOnly=p;n._useDefaultAction=v;n._urlDataSource=n.resources.consume(s.url);n._viewParams=n.resources.consume(f.viewParams);n._itemSelectionHelper=new(n.child(a.typeResourceKey))({overrideItem:t.item});n._itemCommandHelper=n.resources.consume(o.resourceKey);n.item=n._itemSelectionHelper.firstItem;n._url=n.createPureComputed(n._computeUrl);var m=!1;c.default.isActivated(h,"09/03/2018","Teams Open Office Online In-App")||(m=l.isTeamsWebView());var g=n.resources.consume(f.actionMap);n._navigationAction=new(n.managed(g.NavigationAction))({url:n._url,target:i||m?void 0:"_blank",postProcessUrl:function(e){return n._postProcessUrl(e)}});return n}t.prototype._postProcessUrl=function(e){return e};t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._itemCommandHelper.isCommandSupported(e,u.openOnline)&&this._navigationAction.isAvailable()};t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(i.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})};return t})(r.default);t.default=p});
define("UPe",["require","exports","ww","oB","A","W","dz","HPe","FPe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.item,i=t.openRelation,s=void 0===i?0:i;n.name="OpenInTeamsPreview";n._itemSelectionHelper=new(n.child(o.typeResourceKey))({overrideItem:2===s?r:void 0,allowMultiSelect:!1,canFallback:0!==s,ignoreSelection:0!==s});return n}t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.firstItem(),o={id:r.id,name:r.name||r.displayName,openUrl:r.openUrl,extension:r.extension,type:r.type};this.resources.consumeAsync(u.teamsHostedApplicationResourceKey).then(function(e){n._teamsHostedApplication=e(a.PagesAppConstants.AppType);n._teamsHostedApplication.openOneDriveItemInFilePreview(o)});return i.default.wrap({resultType:s.ResultTypeEnum.Success})};return t})(r.default);t.default=f});
define("kPe",["require","exports","ww","QX","dz","oB","C$","LO","pO","h$","dv","V$","p$"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenPdfInBrowserAction";var s=n,o=s.observables,f=s.resources;n._itemCommandHelper=f.consume(r.resourceKey);n._itemSelectionHelper=new(n.child(i.typeResourceKey))({overrideItem:t.item});n._urlDataSource=f.consume(a.url);var h=o.pureCompute(function(){var e=n._itemSelectionHelper.firstItem();return e&&e.openUrl}),p=f.consume(u.actionMap);n._navigationAction=new(n.managed(p.NavigationAction))({url:h,target:"_blank"});l.isOneDriveWinApp()&&(n._openInDesktopAction=new(n.managed(p.OpenInDesktopAction))({openRelation:2,item:n._itemSelectionHelper.firstItem,actionType:c.DesktopActionType.OpenPdfInBrowser}));return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&(!!e&&f.canListItemBeOpened(e,this._urlDataSource)&&this._itemCommandHelper.isCommandSupported(e,o.openPdfInBrowser)&&".pdf"===e.extension.toLowerCase())};t.prototype.onExecute=function(e,t){return this._openInDesktopAction?this._openInDesktopAction.execute(e):this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};return t})(s.default);t.default=p});
define("EPe",["require","exports","ww","A","W","LO","oB","dz"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="SelectAction";var i=n.itemSelectionHelperType,o=void 0===i?r.resources.consume(u.typeResourceKey):i,a=n.actionMap,f=void 0===a?r.resources.consume(s.actionMap):a;r._item=t.item;r._selectItems=t.selectItems;r._itemSelectionHelper=new o({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1});t.showProperties&&(r._showPropertiesAction=new(r.managed(f.ShowPropertiesAction))({}));return r}t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!!e&&!e.isPlaceholder};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var t,r=this;return n.__generator(this,function(n){switch(n.label){case 0:if(this._selectItems){t=this._selectItems.map(function(e){return r.observables.peekUnwrap(e)});this._itemSelectionHelper.selectItems(t)}else this._item&&this._itemSelectionHelper.selectItems([this.observables.peekUnwrap(this._item)]);return this._showPropertiesAction?[4,this._showPropertiesAction.execute(e)]:[3,2];case 1:n.sent();n.label=2;case 2:return[2,{resultType:i.ResultTypeEnum.Success}]}})})};return t})(o.default);t.default=a});
define("wPe",["require","exports","ww","A","W","LO","oB"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="SelectAll";r._selectionModel=r.resources.consume(s.itemsSelection);return r}t.prototype.onIsAvailable=function(){return 0===this._selectionModel.mode};t.prototype.onExecute=function(e,t){this._selectionModel.selectAll();return r.default.resolve({resultType:i.ResultTypeEnum.Success})};return t})(o.default);t.default=u});
define("OPe",["require","exports","ww","nZ","A","OS","W"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SetFocus";n._selector=t.selector;n._shouldClick=t.shouldClick;return n}t.prototype.onExecute=function(e,t){var n=document.querySelector(this._selector);if(n){n.focus();this._shouldClick&&s.default.clickElement(n)}return i.default.wrap({resultType:o.ResultTypeEnum.Success})};return t})(r.default);t.default=u});
define("ZPe",["require","exports","ww","oB"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.name="Unsupported";return t}t.prototype.onIsAvailable=function(){return!1};return t})(r.default);t.default=i});
define("BX",["require","exports","ww","oB","W","jX"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.create=t.ControlExecutorAction=void 0;var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.name,i=t.source,o=t.handlerType,u=t.actionParams,a=t.useToggleBehavior,f=void 0!==a&&a;n.name=r;var l=o?new(n.managed(o))(u):void 0,c=l&&l.state||n.createObservable({isAvailable:!0}),h=l&&l.getParams?function(){return l.getParams()}:function(){};n._controlExecutorLoader=new(n.managed(s.default))({source:i,state:c,useToggleBehavior:f,getParams:h});return n}t.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()};t.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()};t.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return t})(r.default);t.ControlExecutorAction=o;t.create=function(e){var t=e.name,r=e.source,i=e.useToggleBehavior,s=e.handlerType;return(function(e){n.__extends(o,e);function o(n){return e.call(this,{name:t,source:r,useToggleBehavior:i,actionParams:n,handlerType:s})||this}return o})(o)}});
define("jX",["require","exports","ww","tB","A","C","C2","VX"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.state,s=t.source,a=t.useToggleBehavior,f=t.getParams;if((function(e){return!!e.moduleDefinition})(s)){var l=s.moduleDefinition;n._getComponentDefinition=function(){return o.loadModule(l)}}else{var c=s.component;n._getComponentDefinition=function(){return i.default.wrap(c)}}n._useToggleBehavior=a;n._state=r;n._getParams=f;n._action=n.createObservable();n._hiddenDomProvider=n.resources.consume(u.resourceKey);n.isAvailable=n.createPureComputed(n._computeIsAvailable);n.isToggled=n.createPureComputed(n._computeIsToggled);return n}t.prototype.execute=function(e){var t,r=this;if(this._useToggleBehavior){var o=this._action.peek();if(o){o.cancel();return i.default.wrap()}}var u=new s.default,a={complete:function(){u.complete()},fail:function(e){u.error(e)},cancel:function(){u.cancel()}};this._useToggleBehavior&&this._action(a);return i.default.as(this._getParams()).then(function(i){return r._getComponentDefinition().then(function(s){t={name:s.tagName,params:n.__assign(n.__assign({action:a,event:e},i||{}),{resources:r.resources})};r._hiddenDomProvider.requestControl(t);return u.getPromise()})}).then(function(){t&&r._hiddenDomProvider.disposeControl(t);r._action.peek()===a&&r._action(void 0)},function(e){t&&r._hiddenDomProvider.disposeControl(t);r._action.peek()===a&&r._action(void 0);return i.default.wrapError(e)})};t.prototype._computeIsAvailable=function(){return this._state().isAvailable};t.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()};return t})(r.default);t.default=a});
define("QX",["require","exports","ww","tB","YX","v"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,s=n.itemCommandProvider,o=void 0===s?r.resources.consume(i.resourceKey):s;r._itemCommandProvider=o;return r}t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)};t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,r=n&&n.getCommand(e,t);return r&&r.behavior};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemCommandProvider:i.resourceKey});return t})(r.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("dz",["require","exports","ww","A","tB","LO","lz","v","sz"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=t.ItemSelectionHelper=void 0;var f=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,u=i.resources,f=i.observables,l=n.getCurrentItem,c=void 0===l?u.consume(s.currentItem.lazy.optional):l,h=n.getItemSetSelectionModel,p=void 0===h?u.consume(s.itemsSelection.lazy.optional):h,d=n.getSelectionHelper,v=void 0===d?u.consume(o.resourceKey.lazy.optional):d,m=t.allowMultiSelect,g=void 0!==m&&m,y=t.canFallback,b=void 0!==y&&y,w=t.ignoreSelection,E=void 0!==w&&w,S=t.overrideItem,x=t.useCurrentSelectionGroup,T=void 0!==x&&x;r._allowMultiSelect=g;r._overrideItem=S;r._ignoreSelection=E;r._useCurrentSelectionGroup=T;r._placeholder=r.observables.create(new a.default);r._getSelectionModel=p;S||(r._selectionHelper=v&&v());b&&c&&(r._fallback=c());r.selection=f.pureCompute(r._computeSelection);r.firstItem=f.pureCompute(r._computeFirstItem);r.currentItem=f.pureCompute(function(){return(c&&c()||r._placeholder)()});return r}t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,r=0,i=t;r<i.length;r++){var s=i[r],o=n.unwrap(s);if(!o)return!0;if(!e(o))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})};t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))};t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()};t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]);return e};t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return r.default.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return r.default.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():r.default.reject(new Error("Unable to resolve selection."))};return t})(i.default);t.ItemSelectionHelper=f;t.typeResourceKey=u.createResolvedTypeResourceKey(e("module").id,f,n.__assign(n.__assign({},i.default.dependencies),{currentItem:s.currentItem.lazy.optional,itemSetSelectionModel:s.itemsSelection.lazy.optional,selectionHelper:o.resourceKey.lazy.optional}));t.default=f});
define("qbe",["require","exports","ww","oB","W","dz","A","yne","Pee"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileHandlerOpenAction=void 0;var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="FileHandlerOpen";var r=n._fileHandlerAction=t.fileHandlerAction;n._fileHandlerProvider=n.resources.consume(u.resourceKey);n._itemSelectionHelper=new(n.child(s.typeResourceKey))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});n._defaultHandlerAction=n.observables.pureCompute(n._computeDefaultHandlerAction);r&&r.handler&&r.handler.isPromoted&&(n.name="PromotedFileHandlerOpen");return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e||!e.graph)return!1;var t=e.extension,n=this._fileHandlerProvider,r=this._fileHandlerAction;return r?n.isActionForExtension(r,t):!!this._defaultHandlerAction()};t.prototype.onExecute=function(e){var t,n=this,r=this._fileHandlerAction;if(!r||!r.handler.isPromoted){if(!(t=window.open("","_blank")))return o.default.reject({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"window.open"});t.opener=null}return this._itemSelectionHelper.resolveFirst().then(function(e){var i=r||n._defaultHandlerAction.peek();return i?n.resources.consumeAsync(a.fileHandlerHelper).then(function(n){return n.invokeAction({items:[e],action:i,target:t})}):o.default.reject("No action available for file handler")}).then(function(){return o.default.wrap({resultType:i.ResultTypeEnum.Success})},function(e){return o.default.wrap({resultType:o.default.isCanceled(e)?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure})})};t.prototype._computeDefaultHandlerAction=function(){if(!this._fileHandlerAction){var e=this._itemSelectionHelper.firstItem();if(e&&e.graph)return this._fileHandlerProvider.getDefaultOpenHandler(e.extension)}};return t})(r.default);t.FileHandlerOpenAction=f;t.default=f});
define("zPe",["require","exports","ww","oB","LO","pO","dz"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t)||this;r.name="NavigateToItem";r._urlDataSource=r.resources.consume(s.url);r._viewParams=r.resources.consume(i.viewParams);var u=t.item,a=t.itemSet,f=void 0===a?r.resources.consume(i.currentItemSet.optional):a,l=t.parentItem,c=t.forceAsFocusItem,h=void 0!==c&&c,p=t.isRedirect,d=void 0!==p&&p,v=t.forceInSameWindow,m=void 0!==v&&v,g=t.shouldPreserveAction,y=void 0!==g&&g;r._itemSet=f;r._parentItem=l;r._forceAsFocusItem=r.wrapObservable(h);r._isRedirect=d;r._forceInSameWindow=r.wrapObservable(m);r._shouldPreserveAction=r.wrapObservable(y);var b=n.itemSelectionHelperType,w=void 0===b?r.resources.consume(o.typeResourceKey):b;r._itemSelectionHelper=new(r.scope.attached(w))({overrideItem:u,allowMultiSelect:!1,canFallback:!0});r._url=r.createPureComputed(r._computeUrl);r._target=r.createPureComputed(r._computeTarget);var E=r.resources.consume(i.actionMap);r._navigationAction=new(r.managed(E.NavigationAction))({url:r._url,ignoreHistory:r._isRedirect,target:r._target});return r}t.prototype.onIsAvailable=function(){return this._navigationAction.isAvailable()};t.prototype.onExecute=function(e){return this._navigationAction.execute(e)};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._urlDataSource.getDefaultClickUrl(e,{focusUrl:this._forceAsFocusItem(),preserveAction:this._shouldPreserveAction(),itemSet:this._itemSet&&this._itemSet(),parentItem:this._parentItem&&this._parentItem(),viewParams:this._viewParams()})||""};t.prototype._computeTarget=function(){var e;return!this._forceInSameWindow()&&(e=this._url())&&0!==e.indexOf("#")?"_blank":"_top"};return t})(r.default);t.default=u});
define("IPe",["require","exports","ww","XPe","JPe","YPe","WPe","GPe","qbe","zPe","qX","z$","jPe","BPe","H$","RPe","V$","UPe","PPe","MPe","kPe","sie","APe","EPe","wPe","OPe","CPe","xPe","O2"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function A(e,t){return i.create(e,function(){return t().then(L.getDefaultExport)})}var O=(function(t){n.__extends(r,t);function r(){var n=t.call(this)||this;n.CreateCustomDocumentAction=s.default;n.DefaultClickAction=o.default;n.ExternalNavigateAction=u.default;n.FileHandlerOpenAction=a.default;n.NavigateToItemAction=f.default;n.NavigationAction=l.default;n.OpenAction=c.default;n.OpenInExplorerAction=h.default;n.OpenInfoPathAction=p.default;n.OpenInOfficeClientAction=d.default;n.OpenInOfficeOnlineAction=v.default;n.OpenInDesktopAction=m.default;n.OpenInTeamsPreviewAction=g.default;n.OpenInTextEditorAction=y.OpenInTextEditorAction;n.OpenInImageEditorAction=b.default;n.OpenPdfInBrowserAction=w.default;n.OpenShortcutAction=E.default;n.PreviewAction=S.default;n.SelectAction=x.default;n.SelectAllAction=T.default;n.SetFocusAction=N.default;n.ShowOperationsAction=C.default;n.ToggleSelectionModeAction=k.default;n.AddFlowAction=A("VZ",function(){return new Promise(function(t,n){e(["VZ"],t,n)})});n.AddToOneDriveAction=A("../AddToOneDriveAction",function(){return new Promise(function(t,n){e(["mie"],t,n)})});n.SetUpReminderFlowAction=A("HZ",function(){return new Promise(function(t,n){e(["HZ"],t,n)})});n.LaunchConfigureFlowsPanelAction=A("BZ",function(){return new Promise(function(t,n){e(["BZ"],t,n)})});n.AlertAction=A("zee",function(){return new Promise(function(t,n){e(["zee"],t,n)})});n.AuthenticationPolicyWarningAction=A("tae",function(){return new Promise(function(t,n){e(["tae"],t,n)})});n.CheckInAction=A("cee",function(){return new Promise(function(t,n){e(["cee"],t,n)})});n.CheckOutAction=A("uat",function(){return new Promise(function(t,n){e(["uat"],t,n)})});n.ClearFilterAction=A("Q$",function(){return new Promise(function(t,n){e(["Q$"],t,n)})});n.ClearSelectionAction=A("Y$",function(){return new Promise(function(t,n){e(["Y$"],t,n)})});n.ContentTypeNavigationAction=A("Bee",function(){return new Promise(function(t,n){e(["Bee"],t,n)})});n.CreateDocumentAction=A("Wne",function(){return new Promise(function(t,n){e(["Wne"],t,n)})});n.CreateFolderAction=A("eae",function(){return new Promise(function(t,n){e(["eae"],t,n)})});n.CreateFileRequestAction=A("vie",function(){return new Promise(function(t,n){e(["vie"],t,n)})});n.CreateNewFolderAction=A("yNe",function(){return new Promise(function(t,n){e(["yNe"],t,n)})});n.CustomActionNavigationAction=A("I$",function(){return new Promise(function(t,n){e(["I$"],t,n)})});n.DeleteAction=A("fne",function(){return new Promise(function(t,n){e(["fne"],t,n)})});n.DownloadAction=A("lne",function(){return new Promise(function(t,n){e(["lne"],t,n)})});n.DownloadZipContentsAction=A("ene",function(){return new Promise(function(t,n){e(["ene"],t,n)})});n.EditAction=A("Gee",function(){return new Promise(function(t,n){e(["Gee"],t,n)})});n.EmptyRecycleBinAction=A("M$",function(){return new Promise(function(t,n){e(["M$"],t,n)})});n.FilterAction=A("q$",function(){return new Promise(function(t,n){e(["q$"],t,n)})});n.GetLinkAction=A("Ree",function(){return new Promise(function(t,n){e(["Ree"],t,n)})});n.GroupItemsAction=A("d$",function(){return new Promise(function(t,n){e(["d$"],t,n)})});n.LaunchColumnManagementPanelAction=A("yxe",function(){return new Promise(function(t,n){e(["yxe"],t,n)})});n.LaunchColumnCustomizationPaneAction=A("Pxe",function(){return new Promise(function(t,n){e(["Pxe"],t,n)})});n.LaunchCreateGroupPanelAction=A("mPt",function(){return new Promise(function(t,n){e(["mPt"],t,n)})});n.LaunchCreateShortcutPanel=A("pne",function(){return new Promise(function(t,n){e(["pne"],t,n)})});n.LaunchFlowWidgetPanelAction=A("jZ",function(){return new Promise(function(t,n){e(["jZ"],t,n)})});n.LaunchGroupifyPanelAction=A("lat",function(){return new Promise(function(t,n){e(["lat"],t,n)})});n.LaunchMoveCopyPanelAction=A("U$",function(){return new Promise(function(t,n){e(["U$"],t,n)})});n.LaunchTeamChannelAction=A("vxe",function(){return new Promise(function(t,n){e(["vxe"],t,n)})});n.LaunchUserExpirationPanelAction=A("zX",function(){return new Promise(function(t,n){e(["zX"],t,n)})});n.MoveCopyAction=A("DNe",function(){return new Promise(function(t,n){e(["DNe"],t,n)})});n.NavigateToSharePointHomeAction=A("cie",function(){return new Promise(function(t,n){e(["cie"],t,n)})});n.OpenInPowerBIAction=A("ODe",function(){return new Promise(function(t,n){e(["ODe"],t,n)})});n.OpenSiteAction=A("YCe",function(){return new Promise(function(t,n){e(["YCe"],t,n)})});n.PinToMruAction=A("K$",function(){return new Promise(function(t,n){e(["K$"],t,n)})});n.PolicyTipAction=A("v9e",function(){return new Promise(function(t,n){e(["v9e"],t,n)})});n.PrintPdfAction=A("x$",function(){return new Promise(function(t,n){e(["x$"],t,n)})});n.RemoveFromSharedListAction=A("$ae",function(){return new Promise(function(t,n){e(["$ae"],t,n)})});n.RemoveTagAction=A("dat",function(){return new Promise(function(t,n){e(["dat"],t,n)})});n.RenameAction=A("W$",function(){return new Promise(function(t,n){e(["W$"],t,n)})});n.RestoreAction=A("k$",function(){return new Promise(function(t,n){e(["k$"],t,n)})});n.SaveAction=A("O$",function(){return new Promise(function(t,n){e(["O$"],t,n)})});n.ShareAction=A("$te",function(){return new Promise(function(t,n){e(["$te"],t,n)})});n.ShareByLinkAction=A("Nee",function(){return new Promise(function(t,n){e(["Nee"],t,n)})});n.ShowPermissionsAction=A("S$",function(){return new Promise(function(t,n){e(["S$"],t,n)})});n.ShowRunReportAction=A("NX",function(){return new Promise(function(t,n){e(["NX"],t,n)})});n.ShowItemAnalyticsAction=A("v$",function(){return new Promise(function(t,n){e(["v$"],t,n)})});n.ShowKeyPointsAction=A("b$",function(){return new Promise(function(t,n){e(["b$"],t,n)})});n.ShowShareAction=A("u$",function(){return new Promise(function(t,n){e(["u$"],t,n)})});n.ShowKeyboardMapAction=A("F$",function(){return new Promise(function(t,n){e(["F$"],t,n)})});n.ShowExistingFlowsAction=A("FZ",function(){return new Promise(function(t,n){e(["FZ"],t,n)})});n.ShowFiltersAction=A("oie",function(){return new Promise(function(t,n){e(["oie"],t,n)})});n.ShowPropertiesAction=A("Tee",function(){return new Promise(function(t,n){e(["Tee"],t,n)})});n.ShowSelectionAction=A("kee",function(){return new Promise(function(t,n){e(["kee"],t,n)})});n.ShowVersionHistoryAction=A("rie",function(){return new Promise(function(t,n){e(["rie"],t,n)})});n.ShowMalwareDetectedAction=A("JX",function(){return new Promise(function(t,n){e(["JX"],t,n)})});n.ViewInFolderAction=A("j$",function(){return new Promise(function(t,n){e(["j$"],t,n)})});n.OneDriveSortAction=A("Aee",function(){return new Promise(function(t,n){e(["Aee"],t,n)})});n.SortAction=A("Eee",function(){return new Promise(function(t,n){e(["Eee"],t,n)})});n.SyncAction=A("Rte",function(){return new Promise(function(t,n){e(["Rte"],t,n)})});n.ToggleListLayoutAction=A("xee",function(){return new Promise(function(t,n){e(["xee"],t,n)})});n.TriggerFlowAction=A("TZ",function(){return new Promise(function(t,n){e(["TZ"],t,n)})});n.TriggerFlowByIdAction=A("_Z",function(){return new Promise(function(t,n){e(["_Z"],t,n)})});n.TriggerODBConvertToPdfFlowAction=A("fZ",function(){return new Promise(function(t,n){e(["fZ"],t,n)})});n.TriggerODBRequestSignOffFlowAction=A("aZ",function(){return new Promise(function(t,n){e(["aZ"],t,n)})});n.UndoCheckOutAction=A("mee",function(){return new Promise(function(t,n){e(["mee"],t,n)})});n.UpdatePermissionsAction=A("r2e",function(){return new Promise(function(t,n){e(["r2e"],t,n)})});n.UploadAction=A("_ee",function(){return new Promise(function(t,n){e(["_ee"],t,n)})});n.ViewOriginalAction=A("GX",function(){return new Promise(function(t,n){e(["GX"],t,n)})});n.BackToClassicAction=A("Txe",function(){return new Promise(function(t,n){e(["Txe"],t,n)})});return n}return r})(r.default);t.default=O});
define("YPe",["require","exports","ww","nZ","g","W","A","xv","Z$","tg"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="CreateCustomDocument";n.openInNewTab=!1;n.fileCreationMenu=t.fileCreationMenu;n.entryIndex=t.entryIndex;n.navigation=n.resources.consume(f.navigation);n.itemProvider=n.resources.consume(a.resourceKey);return n}t.prototype.onIsAvailable=function(){return this.item().queryType===u.default.Files};t.prototype.onExecute=function(e,t){var n=this.item.peek();return this._createCustomDocument(n)};t.prototype._createCustomDocument=function(e,t){var n=this,r=null,u=this.fileCreationMenu.createNewFileControl(this.entryIndex),a=u.get_fileExtension(),f=this.itemProvider.createCustomDocument(e.key,a,t).then(function(e){if(e){r=e.id;return o.default.wrap({resultType:s.ResultTypeEnum.Success})}return o.default.wrap({resultType:s.ResultTypeEnum.Failure})});f.done(function(e){if(r&&null!=u){var t=n.resources.consume(i.pageContext);u.set_itemUrl(r);u.set_httpRoot(t.webAbsoluteUrl);var s=u.getRedirectUrl();null!=s&&n.async.setImmediate(function(){return n.navigation.navigateTo({url:s,frameId:n.openInNewTab?"_blank":null})})}});return f};return t})(r.default);t.default=l});
define("WPe",["require","exports","ww","QPe","wq","Ex","xv","fB","g","vH","yne","qPe","dv","V$","mv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._pageContext=n.resources.consume(a.pageContext);n.itemParentHelper=n.resources.consume(i.resourceKey);n._defaultClickType=n.createPureComputed(n._computeDefaultClickType);n._fileHandlerProvider=n.resources.consume(l.resourceKey.optional);n._isOneDriveWinApp=h.isOneDriveWinApp();n._isTeamsPageApp=u.isFeatureEnabled(u.SPTeamsPagesDocumentPreview)&&d.isTeamsPageApp();return n}t.prototype.onComputeAction=function(){var t,n=this._defaultClickType();switch(n){case 1:t=new(this.managed(this.actionMap.OpenShortcutAction))({item:this.item});break;case 2:t=new(this.managed(this.actionMap.OpenInOfficeClientAction))({item:this.item,retryWithWac:!0});break;case 14:t=new(this.managed(this.actionMap.OpenInTeamsPreviewAction))({openRelation:2,item:this.item});break;case 3:t=new(this.managed(this.actionMap.OpenInOfficeOnlineAction))({useDefaultAction:!0,item:this.item});break;case 4:t=new(this.managed(this.actionMap.OpenSiteAction))({item:this.item});break;case 5:t=new(this.managed(this.actionMap.AuthenticationPolicyWarningAction));break;case 8:t=new(this.managed(this.actionMap.ExternalNavigateAction))({item:this.item});break;case 6:case 11:var r=new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,focusUrl:!0});t=6===n?r:new(this.managed(this.actionMap.OpenInfoPathAction))({fallbackOpenAction:r,item:this.item});break;case 7:t=new(this.managed(this.actionMap.FileHandlerOpenAction))({item:this.item});break;case 9:t=new(this.managed(this.actionMap.OpenHyperlinkAction))({item:this.item});break;case 10:t=new(this.managed(this.actionMap.ShowMalwareDetectedAction))({item:this.item});break;case 12:t=new(this.managed(this.actionMap.OpenInDesktopAction))({openRelation:2,item:this.item,actionType:p.DesktopActionType.DefaultClick});break;case 13:t=new(this.managed(this.actionMap.OpenPdfInBrowserAction))({item:this.item});break;case 0:t=e.prototype.onComputeAction.call(this)}return t};t.prototype._computeDefaultClickType=function(){return this.item()?this._malwareDetected()?10:this._blockedByConditionalAccess()?5:this._openInOneDriveWinApp()?12:this._openInTeamsPreview()?14:this._openAsShortcut()?1:this._openAsSite()?4:this._openInClient()?2:this._openInOfficeOnline()?3:this._external()?8:this._infoPath()?11:this._nativePdf()?13:this._preview()?6:this._openWithFileHandler()?7:this._openAsHyperlink()?9:0:0};t.prototype._openAsShortcut=function(){var e=this.item();return u.isFeatureEnabled(u.ShortcutLink)&&f.default.isShortcutItem(e)};t.prototype._openAsHyperlink=function(){var e=this.item(),t=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list;return n&&n.isPromotedLinks};t.prototype._openInClient=function(){if(!this._openInOffice())return!1;var e=this.item(),t=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return!!t&&(t.list.openInClient||"ms-project"===e.appMap||"ms-publisher"===e.appMap)};t.prototype._openInOfficeOnline=function(){if(this._isOneDriveWinApp||this._isTeamsPageApp)return!1;var e=this.item();return c.isUnifiedAppSupportedFile(e)};t.prototype._openInOffice=function(){var e=this.item();return c.openInOffice(e)};t.prototype._openAsSite=function(){var e=this.item();return!!e&&e.subsite&&this._pageContext.isNoScriptEnabled};t.prototype._blockedByConditionalAccess=function(){var e=this.item();return 3===e.itemStatus&&e.type!==s.default.Folder};t.prototype._external=function(){var e=this.item();return!this._isOneDriveWinApp&&(!(e.appMap&&".pdf"!==e.extension)&&!!e.external)};t.prototype._infoPath=function(){var e=this.item(),t=e.properties&&e.properties.ProgId;return!!t&&0===t.toLowerCase().indexOf("infopath.document")};t.prototype._nativePdf=function(){var e=this.item(),t=e&&e.extension;return!!t&&".pdf"===t.toLowerCase()&&u.isFeatureEnabled(u.DefaultPdfToNative)};t.prototype._preview=function(){var e=this.item();if(this._isOneDriveWinApp&&e&&e.type!==s.default.Folder)return!0;if(e.preview)return!0;var t=this._fileHandlerProvider;return!!t&&!!t.getDefaultPreviewHandler(e.extension)};t.prototype._openWithFileHandler=function(){var e=this._fileHandlerProvider;return!!e&&!!e.getDefaultOpenHandler(this.item().extension)};t.prototype._malwareDetected=function(){var e=this.item();return e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};t.prototype._openInOneDriveWinApp=function(){var e=this.item();if(u.isFeatureEnabled(u.EnableOneUpInSwmPwa)){if(this._isOneDriveWinApp){if(e.type===s.default.Folder&&e.queryType===o.default.SharedWithMe||e.queryType===o.default.Search||e.queryType===o.default.DetailsPane)return!0;if(e.type===s.default.Shortcut)return!0}return!1}return this._isOneDriveWinApp&&(e.type===s.default.Shortcut||e.queryType!==o.default.Files&&e.queryType!==o.default.SharedByMe&&e.queryType!==o.default.Recent)};t.prototype._openInTeamsPreview=function(){if(this._isTeamsPageApp){var e=this.item();return e.type!==s.default.Folder&&e.type!==s.default.Shortcut&&e.queryType!==o.default.DetailsPane}return!1};return t})(r.default);t.default=v});
define("GPe",["require","exports","ww","W","oB","p$","KPe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="ExternalNavigate";n._item=t.item;return n}t.prototype.onIsAvailable=function(){return!0};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(s.itemEngagementPart,{item:this._item.peek()})};t.prototype.onExecute=function(e){var t=this,n=window.open("","_blank");return this.resources.consumeAsync(o.resourceKey).then(function(e){return e.getItemUrl(t._item.peek())}).then(function(e){n.location.href=e;return{resultType:r.ResultTypeEnum.Success}},function(){n.close();return{resultType:r.ResultTypeEnum.Failure}})};return t})(i.default);t.default=u});
define("z$",["require","exports","ww","G$","QX","C$","R$","fB"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemCommandHelper=n.resources.consume(i.resourceKey);return n}t.prototype.onIsAvailable=function(){var t=this.item();return!!t&&(!!this._itemCommandHelper.isCommandSupported(t,s.open)&&e.prototype.onIsAvailable.call(this))};t.prototype.onExecute=function(t,n){if(u.isOneDrive){var r=this.item.peek();this.resources.consumeAsync(o.resourceKey).then(function(e){e.isInRecentView(r)&&e.fireOpenItemEvent(r)})}return e.prototype.onExecute.call(this,t,n)};return t})(r.default);t.default=a});
define("H$",["require","exports","ww","A","ey","je","W","tg","k3","B$","fB","g","LO","oB","pO","QX","D7","wq","N$","R$","dz","p$"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="OpenInOfficeClient";var i=t.url,s=t.appMap,o=t.callback,f=t.isTemplate,l=void 0!==f&&f,p=t.retryWithWac,y=void 0!==p&&p;r._url=i;r._callback=o;r._appMap=s;r._isTemplate=l;r._retryWithWac=y;r._navigation=r.resources.consume(u.navigation);r._platform=r.resources.consume(a.platformDetection);r._itemUrlHelper=r.resources.consume(m.resourceKey);r._itemParentHelper=r.resources.consume(g.resourceKey);r._itemCommandHelper=r.resources.consume(v.resourceKey);r._actionMap=r.resources.consume(h.actionMap);r._pageContext=r.resources.consume(c.pageContext);r._urlDataSource=r.resources.consume(d.url);r._itemSelectionHelper=new(r.child(w.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._platform,t=this._itemSelectionHelper.firstItem();if(!(e.isMac||e.isWindows||e.isIOS||e.isWinPhone||e.isAndroid)||!t||!this._itemCommandHelper.isCommandSupported(t,y.openInClient))return!1;var n=this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list")),r=!0;n&&n.list&&n.list.permissions&&(r=!(!n.list.permissions.useClientIntegration||!i.PermissionMask.hasItemPermission(t,i.PermissionMask.openItems)));return r&&!(!t.openUrl||!t.appMap)&&3!==t.itemStatus&&4!==t.itemStatus};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var i,u,a,c,h,p,d,v,m,g,y,w,E=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(i=n.sent()))return[2,r.default.resolve({resultCode:"EmptySelection",resultType:o.ResultTypeEnum.Failure})];l.isOneDrive&&this.resources.consumeAsync(b.resourceKey).then(function(e){e.isInRecentView(i)&&e.fireOpenItemEvent(i)});u=function(){if(E._callback)E._callback();else{var t=E._actionMap;new(E.managed(t.OpenInOfficeOnlineAction))({item:E.observables.create(i)}).execute(e)}};a=function(e){E._callback?E._callback():E._doNavigation(e)};t.data.extraData||(t.data.extraData={});c=this._pageContext.userDisplayName;h=this._pageContext.userLoginName;p=h&&-1!==h.lastIndexOf("@")?h.substring(0,h.lastIndexOf("@")):void 0;d=void 0;if(i&&i.sharingType){v=i&&i.sharingType;d=v===f.default.Shared||v===f.default.Public||v===f.default.PublicUnlisted}s.extend(t.data.extraData,{uniqueId:i.properties?i.properties.uniqueId:void 0,fileType:i.extension?i.extension.toLowerCase():void 0,isInODB:i.itemFromServer&&i.itemFromServer.SiteTitle&&c?-1!==i.itemFromServer.SiteTitle.indexOf(c):void 0,isInODBv2:i.openUrl&&p?-1!==i.openUrl.toLowerCase().indexOf(p.toLowerCase()):void 0,isItemShared:d});m=this._itemSelectionHelper.currentItem.peek();g=this._itemUrlHelper.getItemUrlParts(m.key);y=g.fullItemUrl;w="";this._url&&this._appMap&&(this._isTemplate&&this._urlDataSource.getOpenTemplateInOfficeClientUrl?w=this._urlDataSource.getOpenTemplateInOfficeClientUrl(this._appMap,this._url):y&&(w=this._urlDataSource.getNewInOfficeClientUrl(this._appMap,this._url,y)));w||(w=this._urlDataSource.getOpenInOfficeClientUrl(i,this._navigation.viewParams));this._retryWithWac?"function"!=typeof navigator.msLaunchUri||this._platform.isWinPhone?a(w):navigator.msLaunchUri(w,null,u):a(w);return[2,r.default.resolve({resultType:o.ResultTypeEnum.Success})]}})})};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(E.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};t.prototype._doNavigation=function(e){this._navigation.navigateTo({url:e,frameId:null})};return t})(p.default);t.default=S});
define("RPe",["require","exports","ww","NPe","W","HD","je","Je","g","B$","dv","LO","V$"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._pageContext=n.resources.consume(a.pageContext);var r=n.resources.consume(c.actionMap);l.isOneDriveWinApp()&&(n._openInDesktopAction=new(n.managed(r.OpenInDesktopAction))({openRelation:2,item:n.item,actionType:h.DesktopActionType.OpenInOfficeOnline}));return n}t.prototype._postProcessUrl=function(e){if(!u.default.isActivated("1D0FB1DD-A268-4326-A1A0-4474D5B42967","1/3/2018","New UserClick queryString")){var t=(new Date).getTime().toString();return s.WopiHelper.AddWopiPerfMarkToTargetUrl(t,"DocLib",e)}};t.prototype.onIsAvailable=function(){return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&e.prototype.onIsAvailable.call(this)};t.prototype.onExecute=function(t,n){var r=this.item.peek();n.data.extraData||(n.data.extraData={});if(this._openInDesktopAction)return this._openInDesktopAction.execute(t);var a=this._pageContext.userDisplayName,l=this._pageContext.userLoginName,c=l&&-1!==l.lastIndexOf("@")?l.substring(0,l.lastIndexOf("@")):void 0,h=void 0;if(r&&r.sharingType){var p=r&&r.sharingType;h=p===f.default.Shared||p===f.default.Public||p===f.default.PublicUnlisted}o.extend(n.data.extraData,{uniqueId:r.properties?r.properties.uniqueId:void 0,fileType:r.extension?r.extension.toLowerCase():void 0,isInODB:r.itemFromServer&&r.itemFromServer.SiteTitle&&a?-1!==r.itemFromServer.SiteTitle.indexOf(a):void 0,isInODBv2:r.openUrl&&c?-1!==r.openUrl.toLowerCase().indexOf(c.toLowerCase()):void 0,isItemShared:h});if(u.default.isActivated("1D0FB1DD-A268-4326-A1A0-4474D5B42967","1/3/2018","New UserClick queryString")){var d=(new Date).getTime();s.WopiHelper.AddWopiPerfMark(1,d,this._url.peek())}return e.prototype.onExecute.call(this,t,n).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return t})(r.default);t.default=p});
define("BPe",["require","exports","ww","oB","LO","T2","A","K"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInfoPathAction=void 0;var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._fallbackAction=t.fallbackOpenAction;n._item=t.item;n._actionMap=n.resources.consume(i.actionMap);n._customActionProvider=n.resources.consume(s.customAction.optional);return n}t.prototype.onExecute=function(e,t){var n=this,r=this._item.peek();return(this._customActionProvider?this._customActionProvider.getCustomActionData().then(function(e){for(var t=0,i=e.ContextMenu||[];t<i.length;t++){var s=i[t];if(!s.children){var o=s;if(f(o.action)&&"function"==typeof o.isEnabled&&o.isEnabled(r))return new(n.managed(n._actionMap.CustomActionNavigationAction))({customAction:o,item:n._item})}}return n._fallbackAction}).catch(function(){return n._fallbackAction}):o.default.resolve(this._fallbackAction)).then(function(t){return t.execute(e)})};return t})(r.default);t.OpenInfoPathAction=a;function f(e){if(!(e=(e||"").toLowerCase())||0!==e.indexOf("~site/_layouts/15/formserver.aspx"))return!1;var t=e.substring(e.indexOf("?")+1),n=u.deserializeQuery(t);return"{itemurl}"===n.xmllocation&&"browser"===n.openin}t.default=a});
define("sie",["require","exports","ww","W","A","wz","mz","_z","uz","_ne","sB","LO","pO","nZ","D7","p$"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="OpenShortcut";r._shortcutProvider=r.resources.consume(f.resourceKey.optional);r._dialogProvider=r.resources.consume(s.resourceKey);r._urlDataSource=r.resources.consume(h.url);r._itemUrlHelper=r.resources.consume(d.resourceKey);r._url=r.createPureComputed(r._computeTargetUrl);r._actionMap=r.resources.consume(c.actionMap);return r}t.prototype.onIsAvailable=function(){return!!this._shortcutProvider&&(!!this.unwrapObservable(this.item)&&!!this._url.peek())};t.prototype.onExecute=function(e){var t=this,n=this.item.peek();this.resources.consume(l.resourceKey).logData({name:"ShortcutLink.ItemRow.Click",isIntentional:!0});if(n.shortcutInfo&&n.shortcutInfo.shortcutLinkRewritten){return new(this.managed(this._actionMap.NavigationAction))({url:this._url,target:this.wrapObservable("_blank")}).execute(e)}var s=this._itemUrlHelper.getItemUrlParts(n.key),f=this._shortcutProvider;return f?f.getShortcutTargetData(s.fullItemUrl,!0).then(function(n){var r;if(n.isInternal)r=i.default.wrap();else{r=t._dialogProvider.requestDialog({title:o.default.confirmNavigateDialogTitle,component:{name:u.default.tagName,params:{text:o.default.openShortcutNavigateToExternalWarning}},actions:[{name:o.default.navigationDialogConfirmButtonLabel,execute:function(){return i.default.wrap(2)},isAvailable:t.observables.create(!0),icon:new a.default("Forward"),isDefault:!0}]}).wait()}return r.then(function(){return new(t.managed(t._actionMap.NavigationAction))({url:t.wrapObservable(n.url),target:t.wrapObservable("_blank")}).execute(e)})},function(n){new(t.managed(t._actionMap.NavigationAction))({url:t._url,target:t.wrapObservable("_blank")}).execute(e);return i.default.wrap({resultType:r.ResultTypeEnum.Failure})}):i.default.wrap({resultType:r.ResultTypeEnum.ExpectedFailure})};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(v.itemEngagementPart,{item:this.item.peek()})};t.prototype._computeTargetUrl=function(){return this._urlDataSource.getDefaultClickUrl(this.item(),{})};return t})(p.default);t.default=m});
define("VPe",["require","exports","ww","tB","zi","tg","k3","wq","D7","Nx","pO","dz","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._navigation=n.resources.consume(s.navigation);n._platformDetection=n.resources.consume(o.platformDetection);n._urlDataSource=n.resources.consume(l.url);n._selectionHelper=new(n.child(c.typeResourceKey))({canFallback:!1,allowMultiSelect:!0});n._currentItem=n._selectionHelper.currentItem;n._itemParentHelper=n.resources.consume(u.resourceKey);n._itemUrlHelper=n.resources.consume(a.resourceKey);return n}t.prototype.canOpenInExplorer=function(){var e=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._currentItem(),"list"));return!!e&&(!!e.list.isDocumentLibrary&&(e.list.templateType!==i.default.webPageLibrary&&(3!==e.itemStatus&&4!==e.itemStatus&&this._platformDetection.isIE)))};t.prototype.navigateToClassic=function(){var e=this._currentItem.peek(),t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=this._urlDataSource.getKeyParams(e.key).id,r=this._itemUrlHelper.getItemUrlParts(t.key),i={ExplorerWindowUrl:n};h.default.isActivated("5924661A-1CC2-43BB-B508-25B4BEF86C42","10/20/2020","Navigate to the specific folder in case of list view threshold throttling")||(i.rootFolder=n);var s=r.fullItemUrl+"?"+f.serializeQuery(i);this._navigation.navigateTo({url:s,frameId:"_blank"})};return t})(r.default);t.default=p});
define("jPe",["require","exports","ww","Uxe","A","oB","W","VPe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInExplorer";n._helper=new(n.managed(u.default));return n}t.prototype.onExecute=function(e,t){if(!this.onIsAvailable())return i.default.wrap({resultType:o.ResultTypeEnum.ExpectedFailure});r.set("odbnu","0");this._helper.navigateToClassic();return i.default.wrap({resultType:o.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return this._helper.canOpenInExplorer()};t.prototype.onIsToggled=function(){return!1};return t})(s.default);t.default=a});
define("MPe",["require","exports","ww","k3","oB","pO","dz","QX","p$","LO","xv","dv","C$","fB","bv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInImageEditorAction=void 0;var v=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this;i.name="OpenInImageEditor";var a=i.resources,l=n.urlDataSource,h=void 0===l?a.consume(s.url):l,p=n.viewParams,d=void 0===p?a.consume(f.viewParams):p,v=n.itemCommandHelper,m=void 0===v?a.consume(u.resourceKey):v,g=n.platformDetection,y=void 0===g?a.consume(r.platformDetection):g,b=n.actionMap,w=void 0===b?a.consume(f.actionMap):b;i._urlDataSource=h;i._viewParams=d;i._itemCommandHelper=m;i._platformDetection=y;i._url=i.createPureComputed(i._computeUrl);i.itemSelectionHelper=new(i.child(o.typeResourceKey))({overrideItem:t.item});i._navigationAction=new(i.managed(w.NavigationAction))({url:i._url,target:"_parent",ignoreHistory:!0});i._isOneDriveWinApp=c.isOneDriveWinApp();return i}t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;if(e.video&&e.video.burstPhotoType)return!1;var t=this.itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key),r=this._urlDataSource.getQueryType(n);return p.isFeatureEnabled(p.EnableEditUtilityControl)&&this._itemCommandHelper.isCommandSupported(e,h.openInImageEditor)&&(!this._platformDetection.isIE||p.isFeatureEnabled(p.EnableEditUtilityControlIE))&&(!this._platformDetection.isSafari||p.isFeatureEnabled(p.EnableEditUtilityControlSafari))&&(!this._platformDetection.isMobile||p.isFeatureEnabled(p.EnableEditUtilityControlMobile))&&this._navigationAction.isAvailable()&&!!e&&r!==l.default.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(r)&&4!==e.itemStatus&&3!==e.itemStatus};t.prototype.onExecute=function(e){d.default.logData({name:"ImageEditButton.Click",isIntentional:!0,currentPage:"Photos-AllPhotos-OneUp-Edit"});return this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(a.itemEngagementPart,{item:this.itemSelectionHelper.firstItem.peek()})};t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();return e?this._urlDataSource.getImageEditorItemUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams()}):""};return t})(i.default);t.OpenInImageEditorAction=v;t.default=v});
define("TPe",["require","exports","ww","k3","oB","pO","Cx","dz","QX","C$","p$","LO","xv","dv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInTextEditorAction=void 0;var d=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this;i.name="OpenInTextEditor";var o=i.resources,f=n.urlDataSource,l=void 0===f?o.consume(s.url):f,h=n.viewParams,d=void 0===h?o.consume(c.viewParams):h,v=n.itemCommandHelper,m=void 0===v?o.consume(a.resourceKey):v,g=n.platformDetection,y=void 0===g?o.consume(r.platformDetection):g,b=n.actionMap,w=void 0===b?o.consume(c.actionMap):b;i._urlDataSource=l;i._viewParams=d;i._itemCommandHelper=m;i._platformDetection=y;i._url=i.createPureComputed(i._computeUrl);i.itemSelectionHelper=new(i.child(u.typeResourceKey))({overrideItem:t.item});i._navigationAction=new(i.managed(w.NavigationAction))({url:i._url,target:"_blank"});i._isOneDriveWinApp=p.isOneDriveWinApp();return i}t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;var t=this.itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key),r=this._urlDataSource.getQueryType(n);return this._itemCommandHelper.isCommandSupported(e,f.openInTextEditor)&&!this._platformDetection.isMobile&&this._navigationAction.isAvailable()&&!!e&&!!e.parent&&o.canOpenItemInMonaco(e)&&r!==h.default.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(r)&&4!==e.itemStatus&&3!==e.itemStatus};t.prototype.onExecute=function(e){return this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(l.itemEngagementPart,{item:this.itemSelectionHelper.firstItem.peek()})};t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();return e&&e.parent?this._urlDataSource.getTextEditorItemUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams()}):""};return t})(i.default);t.OpenInTextEditorAction=d;t.default=d});
define("PPe",["require","exports","ww","Ge","D7","TPe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInTextEditorAction=void 0;var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,s=r.resources,o=n.itemUrlHelper,u=void 0===o?s.consume(i.resourceKey):o;r._itemUrlHelper=u;return r}t.prototype.onIsAvailable=function(){if(!e.prototype.onIsAvailable.call(this))return!1;var t=this.itemSelectionHelper.firstItem();return!!t&&!(this._itemUrlHelper.getItemUrlParts(t.key).geoRelation!==r.GeoRelation.sameGeo)};return t})(s.OpenInTextEditorAction);t.OpenInTextEditorAction=o});
define("LPe",["require","exports","ww","oB","LO","K3","G3","dz","xv","p$","wq","xx"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Preview";var r=n.resources.consume(i.actionMap);n._dataStore=new s.default("",o.default.local);n._itemSelectionHelper=new(n.child(u.typeResourceKey))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1});n._openAction=new(n.managed(r.OpenAction))({focusUrl:n.observables.compute(n._computeFocusUrl),item:t.item,openRelation:t.item?2:void 0,nonFoldersOnly:!0});n._itemParentHelper=n.resources.consume(l.resourceKey);return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=null;e&&(t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")));return e&&!e.external&&this._openAction.isAvailable()&&(!c.isGallatin()||e.queryType!==a.default.SharedWithMe)&&(!t||!t.list||t.list.isDocumentLibrary)};t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem.peek();!n||"ms-word"!==n.appMap&&"ms-powerpoint"!==n.appMap?this._dataStore.setValue("OfficeDocClickTime",""):this._dataStore.setValue("OfficeDocClickTime",new Date);return this._openAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(f.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};t.prototype._computeFocusUrl=function(){var e=this._itemSelectionHelper.firstItem();return!(e&&e.queryType===a.default.Recent)};return t})(r.default);t.default=h});
define("APe",["require","exports","ww","LPe","g","dz","je","B$","fB","dv","mv"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._isOneDriveWinApp=f.isOneDriveWinApp();n._pageContext=n.resources.consume(i.pageContext);n._itemSelectionHelp=new(n.child(s.typeResourceKey))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1});return n}t.prototype.onIsAvailable=function(){return!this._isOneDriveWinApp&&!(a.isFeatureEnabled(a.SPTeamsPagesDocumentPreview)&&l.isTeamsPageApp())&&this._pageContext.isSPO&&e.prototype.onIsAvailable.call(this)};t.prototype.onExecute=function(t,n){var r=this._itemSelectionHelp.firstItem.peek();n.data.extraData||(n.data.extraData={});var i=this._pageContext.userDisplayName,s=this._pageContext.userLoginName,a=s&&-1!==s.lastIndexOf("@")?s.substring(0,s.lastIndexOf("@")):void 0,f=void 0;if(r&&r.sharingType){var l=r&&r.sharingType;f=l===u.default.Shared||l===u.default.Public||l===u.default.PublicUnlisted}o.extend(n.data.extraData,{isInODB:r.itemFromServer&&r.itemFromServer.SiteTitle&&i?-1!==r.itemFromServer.SiteTitle.indexOf(i):void 0,isInODBv2:r.openUrl&&a?-1!==r.openUrl.toLowerCase().indexOf(a.toLowerCase()):void 0,isItemShared:f});return e.prototype.onExecute.call(this,t,n)};return t})(r.default);t.default=c});
define("CPe",["require","exports","ww","A","tB","BX","gQ","OQ"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowOperationsHandler=void 0;var a=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._operationProvider=n.resources.consume(o.resourceKey);n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeState=function(){return{isAvailable:this._operationProvider.overall.state()!==u.default.expired,isToggled:this._operationProvider.isLocked()}};return t})(i.default);t.ShowOperationsHandler=a;var f=s.create({name:"ShowOperations",source:{moduleDefinition:{path:"PVe",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["PVe"],t,n)}))}}},handlerType:a});t.default=f});
define("ZN",["require","exports","ww","oB","W","A","eB","$N"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.name="InvokeFirstRunExperience";return t}t.prototype.onExecute=function(e,t){var n=this.resources.consume(o.resourceKey),r=n.peek()===u.FirstRunExperienceStatus.visible?u.FirstRunExperienceStatus.notVisible:u.FirstRunExperienceStatus.visible;n(r);return s.default.wrap({resultType:i.ResultTypeEnum.Success})};return t})(r.default);t.default=a});
define("xPe",["require","exports","ww","oB","dz","A","W","k3","Mee","dv"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ToggleSelectionModeAction";n._platformDetection=n.resources.consume(u.platformDetection);n._isSelectionModal=n.resources.consume(a.isSelectionModalResourceKey);n._selectionHelper=new(n.child(i.typeResourceKey))({});n._isOneDriveXboxApp=f.isOneDriveXboxApp();return n}t.prototype.onIsAvailable=function(){return this._isOneDriveXboxApp||this._platformDetection.isMobile&&!this._isSelectionModal()&&!this._selectionHelper.firstItem()};t.prototype.onExecute=function(e){var t=this._isSelectionModal.peek();this._isSelectionModal(!t);return s.default.wrap({resultType:o.ResultTypeEnum.Success})};t.prototype.onIsToggled=function(){return this._isSelectionModal()};return t})(r.default);t.default=l});
define("oB",["require","exports","ww","uB","lB","tB","pO","A","fe","EI","xv","W","T2","sB","N","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="BaseAction";var i=r,s=i.resources,u=i.observables,a=n.urlDataSource,f=void 0===a?s.consume(o.url.optional):a,l=n.instrumentationProvider,c=void 0===l?s.consume(h.instrumentation.optional):l;r._BaseAction_urlDataSource=f;r._BaseAction_instrumentationProvider=c;r.isQosLogged=!0;r.logStartEnd=!1;r._executingInstanceCount=u.create(0);var p={deferEvaluation:!0};r.isAvailable=u.pureCompute(r._computeIsAvailable,p);r.isToggled=u.pureCompute(r._computeIsToggled,p);r.isExecuting=u.pureCompute(r._computeIsExecuting,p);return r}t.prototype.execute=function(e){var t,n,r=this,i=this.isQosLogged?this.onCreateQosEvent(e):void 0,s=i&&!v.default.isActivated("E25DF3CA-AF06-4063-A8AE-BC792E58E3BB","5/7/2020","Obtain Engagement before launching action")?this.getEngagement():void 0,o=!v.default.isActivated("14943A66-AD8E-448D-84E4-A073B4A2EB23","5/21/2020","Log engagement before executing action"),f=!v.default.isActivated("BD7EDAD8-6C11-4782-B305-09BA04E543A7","6/23/2020","Call trackUserAction before executing action");try{if(i&&o){this._logEngagementEvent(i.data.extraData,s);f&&this.trackUserAction(this.name)}if(!(t=this.onExecute(e,i)))throw new Error("Action did not return a promise")}catch(e){a.default.log(e);n=e}if(t){this._executingInstanceCount(this._executingInstanceCount.peek()+1);t.then(function(e){r._executingInstanceCount(r._executingInstanceCount.peek()-1);if(i){if(!o){r._logEngagementEvent(i.data.extraData,s);r.trackUserAction(r.name)}i.end(e)}},function(t){r._executingInstanceCount(r._executingInstanceCount.peek()-1);t&&!u.default.isCanceled(t)&&a.default.log(t);if(i){o||r._logEngagementEvent(i.data.extraData,s);i.end(r.onCreateErrorEventArg(e,t,!1))}})}else{i&&i.end(this.onCreateErrorEventArg(e,n,!0));t=u.default.reject(n)}return t};t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new r.Action({name:this.name,pageType:t&&f.default[t.getPageType()]||"",queryType:t&&l.default[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&u.default.isCanceled(t)?{resultType:c.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:t instanceof d.ApiError?{resultType:t.isExpected?c.ResultTypeEnum.ExpectedFailure:c.ResultTypeEnum.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:c.ResultTypeEnum.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?""+(t.message||""):void 0}};t.prototype.onExecute=function(e,t){var n={resultType:c.ResultTypeEnum.Failure};return u.default.resolve(n)};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return!1};t.prototype.getEngagement=function(){return this.resources.consume(p.resourceKey)};t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}};t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};t.prototype._computeIsToggled=function(){return!!this.onIsToggled()};t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0};t.prototype._logEngagementEvent=function(e,t){void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0);if(t){var r=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:i.UsageType[i.UsageType.Click],currentPage:r&&r.currentPageName()||"NA",previousPage:r&&r.previousPageName()||"NA",extraData:n.__assign(n.__assign({},e||{}),r&&r.getEngagementData()||{})})}};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{urlDataSource:o.url,instrumentationProvider:h.instrumentation.optional});return t})(s.default);t.default=m});
define("nZ",["require","exports","ww","oB","wq","dz"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,o=t.item,u=n.getItemSelectionHelperType,a=void 0===u?r.resources.consume(s.typeResourceKey.lazy):u,f=n.itemParentHelper,l=void 0===f?r.resources.consume(i.resourceKey):f;r.isItemSpecified=!!o;r.item=o||new(r.scope.attached(a()))({canFallback:!0,ignoreSelection:!0}).currentItem;r.itemParentHelper=l;return r}t.prototype.onIsAvailable=function(){return!!this.item()};t.prototype.getParent=function(e,t,n){var r=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(r):this.unwrapObservable(r)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{getItemSelectionHelperType:s.typeResourceKey.lazy,itemParentHelper:i.resourceKey});return t})(r.default);t.default=o});
define("eW",["require","exports","fB"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isProgIdTeamChannelFolder=t.isTeamChannelBannerEnabled=t.isTeamChannelFolder=void 0;t.isTeamChannelFolder=function(e){var t=!!e&&!!e.folder,n=e&&e.properties.ProgId;return r()&&t&&i(n)};function r(){return n.isFeatureEnabled(n.TeamChannelFolder)}t.isTeamChannelBannerEnabled=r;function i(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}t.isProgIdTeamChannelFolder=i});
define("jat",["require","exports","Kat","zat","hz","ODBOneDrive_mini_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-drag-and-drop-hint",template:n.default,viewModel:r.default});t.default=s});
define("Kat",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:showDropHint()--\x3e<div class="od-DragAndDropHint" data-bind="css:{\'od-DragAndDropHint--grid\':isGridView,\'ms-slideLeftIn40\':isAnimationClassApplicable()&&isGridView,\'ms-slideUpIn20\':isAnimationClassApplicable()&&!isGridView,\'is-animating\':isReady()&&(isAnimationApplicable&&!isAnimationClassApplicable())}"><div class="od-DragAndDropHint-box" data-bind="css:{\'od-DragAndDropHint-box--grid\':isGridView,\'od-DragAndDropHint-box--robot\':isRobotVisible}">\x3c!--ko if:isGridView--\x3e<div class="od-DragAndDropHint-fileContainer"><img class="od-DragAndDropHint-file" data-bind="attr:{src:fileImageUrl}"></div>\x3c!--/ko--\x3e<div class="od-DragAndDropHint-text" data-bind="text:dropSuggestionText,css:{\'od-DragAndDropHint-text--grid\':isGridView}"></div></div>\x3c!--ko if:isRobotVisible--\x3e<div class="od-DragAndDropHint-robot" data-bind="style:{\'background-image\':robotImageUrl},css:{\'od-DragAndDropHint-robot--grid\':isGridView,\'od-DragAndDropHint-robotAnimation\':isReady()&&isAnimationApplicable}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});
define("zat",["require","exports","ww","gz","Iee","jxe","k3","sB","Gat","eB","$N","dv","LO","T2"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d="DragAndDropRobot",v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(h.actionMap);n._isItemSetRendered=n.resources.consume(h.isItemSetRendered);n._platformDetection=n.resources.consume(o.platformDetection);n._bundleLoader=n.resources.consume(p.bundleLoader);var r=n.resources.consume(u.resourceKey),a=new(n.managed(n._actionMap.UploadAction))({uploadProcessorType:i.UploadProcessorType.Html5file});n._isUploadAvailable=a.isAvailable;n._firstRunExperienceStatus=n.resources.consume(f.resourceKey);n._isOneDriveXboxApp=c.isOneDriveXboxApp();n.isGridView=t.isGridView;n.showDropHint=n.createPureComputed(n._computeShowDropHint);n.dropSuggestionText=n.isRobotVisible?s.default.DragAndDropHintEmptyRobotText:s.default.DragAndDropHintText;n.fileImageUrl=window.require.toUrl("odsp-media/images/odrobot/dragfilegrid.svg");n.isAnimationApplicable=!1;n.isAnimationClassApplicable=n.createObservable(!1);n.isReady=n.createObservable(!1);n.isRobotVisible=t.isRobotVisible;if(n.isRobotVisible){n.createBackgroundComputed(n._computeShowRobotAnimation);n.robotImageUrl=n.createPureComputed(n._computeRobotImageUrl)}else n.isReady(!0);n.createBackgroundComputed(function(){n.showDropHint()&&n.isRobotVisible&&r.logData({name:d+".Show",extraData:{isGridView:n.isGridView}})});return n}t.prototype._computeShowRobotAnimation=function(){var e=this;this._isBundleLoaded=this._bundleLoader.getBundleInfo(1).isLoaded();this.resources.consumeAsync(a.resourceKey).then(function(t){if(e._isBundleLoaded)if(!t.getInitialized()&&e.isRobotVisible&&e._firstRunExperienceStatus()!==l.FirstRunExperienceStatus.visible){t.setIsInitialized(!0);t.setIntializeTime();e.isAnimationApplicable=!0;e._setAnimationTimer();e.isReady(!0)}else if(t.getInitialized()){e.isAnimationApplicable=!0;e.isReady(!0);e._setAnimationTimer()}})};t.prototype._computeShowDropHint=function(){return this._isUploadAvailable()&&!this._platformDetection.isMobile&&!this._isOneDriveXboxApp&&this._isItemSetRendered()&&this.isReady()};t.prototype._setAnimationTimer=function(){var e=this;this.async.setTimeout(function(){e.isAnimationClassApplicable(!0)},500)};t.prototype._computeRobotImageUrl=function(){if(this.isReady()){return"url('"+window.require.toUrl("odsp-media/images/odrobot/"+(this.isAnimationApplicable?"robotlistv2.gif":"robotlistv2.svg"))+"')"}return""};return t})(r.default);t.default=v});
define("$N",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FirstRunExperienceStatus=void 0;(function(e){e[e.notConfigured=0]="notConfigured";e[e.visible=1]="visible";e[e.notVisible=2]="notVisible"})(t.FirstRunExperienceStatus||(t.FirstRunExperienceStatus={}))});
define("eB",["require","exports","tB","v","$N"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new r.ResourceKey({name:e("module").id+".FirstRunExperienceStatus",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(i.FirstRunExperienceStatus.notConfigured),disposable:t}}}})});
define("Mee",["require","exports","ww","tB","hc","_c","Eq","Pee","LO","v"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hasSelectionResourceKey=t.resourceKey=t.isSelectionModalResourceKey=t.selectionModeResourceKey=t.getKeyResourceKey=t.selectionManagerResourceKey=t.SelectionManager=void 0;var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,o=r.observables;r._selectionModel=n.itemSetSelectionModel;r._clientSideExtensionHelper=n.clientSideExtensionHelper;r._itemsStore=n.itemsStore;var u=r.selection=new s.Selection({selectionMode:1===r._selectionModel.mode?i.SelectionMode.single:i.SelectionMode.multiple,onSelectionChanged:r._onSelectionChange.bind(r),getKey:r.getKey.bind(r),canSelectItem:r._canSelectItem.bind(r)});r._isModal=o.create(!!u.isModal&&u.isModal());o.compute(r._computeUpdateItems);o.backgroundCompute(r._computeUpdateReactSelection);r.isModal=o.compute({read:function(){return r._isModal()},write:function(e){return u&&u.setModal(e)},pure:!0});return r}t.prototype.getKey=function(e,t){return e&&this._selectionModel.getItemKey(this._itemsStore.getItem(""+e.key))||""+t};t.prototype._computeUpdateReactSelection=function(){var e=this,t=this._selectionModel,n=this.selection,r=t.selection();this.observables.ignore(function(){if(e._shouldUpdateSelection())if(0===t.mode&&(t.isAllSelected()&&!n.isAllSelected()||0===t.selectedCount()&&n.isAllSelected()))n.setAllSelected(t.isAllSelected()&&!n.isAllSelected());else{n.setChangeEvents(!1);n.setAllSelected(!1);for(var i=0,s=r;i<s.length;i++){var o=s[i];n.setKeySelected(t.getItemKey(o),!0,!1)}n.setChangeEvents(!0)}})};t.prototype._shouldUpdateSelection=function(){var e=this._selectionModel,t=this.selection,n=!1;if(e.selectedCount()!==t.count||0===e.mode&&e.isAllSelected()!==t.isAllSelected())n=!0;else if(!t.isAllSelected()||1===e.mode)for(var r=0,i=e.selection();r<i.length;r++){var s=i[r];if(!t.isKeySelected(e.getItemKey(s))){n=!0;break}}return n};t.prototype._onSelectionChange=function(){var e=this;this.observables.ignore(function(){var t=e._selectionModel,n=e.selection;e._isModal(!!n.isModal&&n.isModal());if(e._shouldUpdateSelection()){if(n.mode===i.SelectionMode.multiple&&(!t.isAllSelected()&&n.isAllSelected()||t.isAllSelected()&&0===n.count))!t.isAllSelected()&&n.isAllSelected()?t.selectAll():t.clear();else{for(var r=[],s=0,o=n.getSelection();s<o.length;s++){var u=o[s],a=e.getKey(u);r.push(a)}t.setSelectedKeys(r)}var f=e._clientSideExtensionHelper;f&&f.raiseListChangeEvent(n.getSelection())}})};t.prototype._computeUpdateItems=function(){var e=this,t=this._selectionModel.itemSet(),n=[];if(t)for(var r=0,i=t.content().items;r<i.length;r++){var s=i[r],o=this.observables.peekUnwrap(s);o?n.push(o):n.push(void 0)}this.observables.ignore(function(){var r=t&&e.observables.peekUnwrap(t.item);(t&&!t.isPlaceholder||r&&r.isStub)&&e.selection.setItems(n,!1)})};t.prototype._canSelectItem=function(e){var t=this;return this.observables.ignore(function(){return t._selectionModel.canSelectItem(t._itemsStore.getItem(e.key))})};return t})(r.default);t.SelectionManager=l;t.selectionManagerResourceKey=new f.ResourceKey({name:e("module").id+".selectionManager",factory:new f.ResolvedResourceFactory(l,n.__assign(n.__assign({},r.default.dependencies),{itemSetSelectionModel:a.itemsSelection,clientSideExtensionHelper:u.clientSideExtensionHelper.optional,itemsStore:o.resourceKey}))});t.getKeyResourceKey=new f.ResourceKey({name:e("module").id+".getKey",factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){var t=e.selectionManager;return{instance:function(e,n){return t.getKey(e,n)}}}}});t.selectionModeResourceKey=new f.ResourceKey({name:e("module").id+".selectionMode",factory:{dependencies:{itemSetSelectionModel:a.itemsSelection},create:function(e){return{instance:0===e.itemSetSelectionModel.mode?i.SelectionMode.multiple:i.SelectionMode.single}}}});t.isSelectionModalResourceKey=new f.ResourceKey({name:e("module").id+".getKey",factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){return{instance:e.selectionManager.isModal}}}});t.resourceKey=new f.ResourceKey({name:e("module").id,factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){return{instance:e.selectionManager.selection}}}});t.hasSelectionResourceKey=new f.ResourceKey({name:e("module").id+".hasSelection",factory:{dependencies:{itemSetSelectionModel:a.itemsSelection,isSelectionModal:t.isSelectionModalResourceKey,observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType,n=e.itemSetSelectionModel,r=e.isSelectionModal;return{instance:t.pureCompute(function(){return r()||n.selectedCount()>0}),disposable:t}}}})});
define("yse",["require","exports","v","Dse","Sse","eM"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=n.createResolvedResourceKey(e("module").id,s.DataRequestor,{sessionManagementProvider:r.resourceKey,urlDataSource:i.resourceKey});t.default=s.DataRequestor});
define("Y2",["require","exports","t2","g","v"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=t.DataRequestor=void 0;t.DataRequestor=n.default;t.typeResourceKey=i.createResolvedTypeResourceKey(e("module").id,n.default,{pageContext:r.pageContext});t.default=n.default});
define("LZ",["require","exports","ww","tB","Y2","g","je"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,void 0,n)||this;r._pageContext=t||r.resources.consume(s.pageContext);r.dataRequestor=new i.default({qosName:r.getDataSourceName()},{pageContext:r._pageContext});return r}t.prototype.getDataSourceName=function(){return"DataSource"};t.prototype.updateContext=function(e){o.extend(this._pageContext,e);this.dataRequestor=new i.default({},{pageContext:this._pageContext})};return t})(r.default);t.default=u});
define("jne",["require","exports","Vne"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.previewImageUrlFromUrl=t.previewImageUrlFromProps=t.previewImageUrl=void 0;t.previewImageUrl=function(e,t,n,s){if(n.isSPO){var o=e.SiteId||e.SiteID||e.siteId||n.siteId,u=e.WebId||e.webId||n.webId,a=e.UniqueId||e.UniqueID||e.uniqueId,f=e.Url||e.url||e.Path;return a&&o&&u&&!s?r(o,u,a,t,n):i(f,t,n)}};function r(e,t,n,r,i){if(i.isSPO){var o;n&&(o=s(function(s){var o=s?"":"&resolution=Width1024";return r+"/"+i.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&guidFile="+n+"&guidSite="+e+"&guidWeb="+t+o}));return o}}t.previewImageUrlFromProps=r;function i(e,t,n){if(n.isSPO){var r;e&&(r=s(function(r){var i=r?"":"&resolution=Width1024";return t+"/"+n.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&path="+e+i}));return r}}t.previewImageUrlFromUrl=i;function s(e){return{url:e(!0),width:0,height:0,getAligned:function(t,r){return{url:e(r.name===n.cover.name),width:0,height:0}}}}});
define("J8e",["require","exports","Mne","Pe","Oe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isFolderContentType=t.FOLDER_CONTENT_TYPE_PREFIX=t.getOcrFromHtmlString=t.getModifiedByFromString=t.getModifiedByUserFromObject=t.getModifiedByFromObject=t.getGridSubTitleTextFromModifiedBy=void 0;t.getGridSubTitleTextFromModifiedBy=function(e){return e?i.format(n.default.gridViewSubTitle,e):""};t.getModifiedByFromObject=function(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""};t.getModifiedByUserFromObject=function(e){var t=e&&e[e.length-1];return{title:t&&t.title,email:t&&t.email,picture:t&&r.getUserPhotoUrl({userLoginName:t.email})}};t.getModifiedByFromString=function(e){return e?e.substr(e.lastIndexOf("\n")+1):""};t.getOcrFromHtmlString=function(e){if(!e)return"";try{var t=window.DOMParser,n=t&&(new t).parseFromString(e,"text/html");return n&&n.body&&n.body.innerText}catch(e){return""}};t.FOLDER_CONTENT_TYPE_PREFIX="0x0120";t.isFolderContentType=function(e){return e&&e.slice(0,6)===t.FOLDER_CONTENT_TYPE_PREFIX}});
define("_5e",["require","exports","Nx","v","Y2","m5e","g","fB"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.isOLSQueryEnabledResourceKey=t.FullResults=t.QueryBoxSkyDrive=t.DEFAULT_SELECT_PROPERTIES=void 0;var a='[\\.\\;\\,\\s-_\\(\\)\\/\\"\\u201c\\xab\\!\\&\\+\\¤\\<\\>\\@\\+\\=]',f=new RegExp(a,"g"),l=new RegExp("^"+a+"+|"+a+"+$|"+a+"+(?="+a+")","g");t.DEFAULT_SELECT_PROPERTIES=["Path","SecondaryFileExtension","FileExtension","ParentLink","Size","Description","CreatedBy","Created","ModifiedBy","LastModifiedTime","IsContainer","Filename","Title","LinkingUrl","SharedWithDetails","ListID","SiteID","WebId","UniqueID","piPageImpression","piPageImpressionBlockType","piSearchResultId",".mediaBaseUrl",".spResourceUrl",".callerStack",".correlationId",".thumbnailUrl",".videoManifestUrl",".pdfConversionUrl"];u.isFeatureEnabled(u.ODBSearchLocationColumn)&&t.DEFAULT_SELECT_PROPERTIES.push("SPWebUrl","SiteTemplateId","SiteTitle");t.QueryBoxSkyDrive="QueryBoxSkyDrive";t.FullResults="FullResults";t.isOLSQueryEnabledResourceKey=new r.ResourceKey({name:e("module").id+".isOLSQueryEnabled",factory:new r.ConstantResourceFactory(!1)});var c=(function(){function e(e,t){void 0===e&&(e={});this._isOLSQueryEnabled=t.isOLSQueryEnabled;this._dataRequestor=new t.dataRequestorType({});this._pageContext=t.pageContext;this._searchSession=t.searchSession}e.prototype.query=function(e,r){void 0===r&&(r={});var i=r.pageSize,s=void 0===i?50:i,o=r.startRow,u=void 0===o?0:o,a=r.qosName,c=r.clientType,p=void 0===c?"OneDriveWeb":c,d=r.clientFunction,v=r.clientFunctionDetails,m=r.timeout,g=r.filterQuery,y=r.selectProperties,b=void 0===y?t.DEFAULT_SELECT_PROPERTIES:y,w='(({searchTerms}) OR ({searchTerms}*)) (path:"'+this._pageContext.webAbsoluteUrl.replace("'","''")+'" OR SharedWithUsersOWSUser:{User.EncodedLoginName}) (ContentTypeId:0x010100* OR ContentTypeId:0x012000*) -ContentClass=STS_List_* -ContentClass=STS_Site -ContentClass=STS_Web -ContentClass=STS_ListItem_544 -ContentClass=STS_ListItem_550',E=this._isOLSQueryEnabled,S=E?e:(function(e){var t;if(e){f.test(e)&&(e=(n=e,n.replace(l,"").split(f)).join(" "));e=e.replace(/\'/g,"''");t=e.lastIndexOf("*")===e.length-1||e.lastIndexOf(" ")===e.length-1?(function(e){return e.replace(/^\s+|\s+$|\s+(?=\s)/g,"")})(e):"(("+e+") OR ("+e+"*))"}else t="*";var n;return t})(e);g&&(S+=" AND "+g);var x={clientType:"'"+p+"'",EnableQueryRules:!1,queryTemplate:"'"+w+"'",querytext:"'"+S+"'",rowLimit:s,culture:this._pageContext.currentLanguage,startRow:u,properties:"'"+h({ClientFunction:d,ClientFunctionDetails:v})+"'",selectProperties:"'"+b.join(",")+"'"};E&&d===t.FullResults&&(x.useOLSQuery=1);x.OLSQuerySession="'"+this._searchSession+"'";var T=this._pageContext.webAbsoluteUrl+"/_api/search/query?"+n.serializeQuery(x);return this._dataRequestor.getData({url:T,method:"GET",qosName:a||"Odb.SearchService.query",timeout:m,noRedirect:!0}).then(function(e){return e.d.query})};e.prototype.getSearchResultsForUrl=function(e,t){e=this._pageContext.webAbsoluteUrl+e;return this._dataRequestor.getData({url:e,method:"GET",qosName:t,noRedirect:!0}).then(function(e){return e.d.query})};e.prototype.getSearchInstrumentationUrl=function(e){var t,r=e.itemFromServer.piSearchResultId,i=e.pageImpression,s=e.pageImpressionBlockType,o=e.index;if(r){var u={pageInfo:"'"+i+"'",clickType:"'0'",subResultIndex:o,clickedResultId:"'"+r+"'",blockType:s};t=this._pageContext.webAbsoluteUrl+"/_api/search/recordpageclick?"+n.serializeQuery(u)}return t};e.dependencies={isOLSQueryEnabled:t.isOLSQueryEnabledResourceKey,dataRequestorType:i.typeResourceKey,pageContext:o.pageContext,searchSession:s.resourceKey};return e})();t.default=c;function h(e){var t=[];for(var n in e){e[n]&&t.push(n+":"+e[n])}return t.join(",")}t.resourceKey=r.createResolvedResourceKey(e("module").id,c)});
define("Jit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["$Ce"],t,n)}).then(function(e){return e.resourceKey})})})});
define("lit",["require","exports","ww","tB"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._fileSystemItemIdMapping={};return n}t.prototype.getPathFromItemId=function(e){return this._fileSystemItemIdMapping[e]};t.prototype.setFileSystemIdMapping=function(e,t){this._fileSystemItemIdMapping[e]=t};return t})(r.default);t.default=i});
define("eQ",["require","exports","v","pO","nQ","tQ"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o=new n.ResourceKey({name:"cookieOrigin",factory:new n.ConstantResourceFactory(window.location.origin)});t.resourceKey=n.createResolvedResourceKey(e("module").id,s.DataRequestor,{sessionManagementProvider:i.resourceKey,urlDataSource:r.url,cookieOrigin:o})});
define("Lq",["require","exports","ww","A","tB"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(t){n.__extends(i,t);function i(){return null!==t&&t.apply(this,arguments)||this}i.prototype.getBundles=function(){var t;return(t={})[1]={path:"$Le",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["$Le"],t,n)}))},isLoaded:this.createObservable(!1)},t};return i})(i.default);t.default=s});
define("sTe",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Rwe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("$at",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.prototype.getEncoding=function(){return null};return e})();t.default=n});
define("uit",["require","exports","ww","tB"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getAction=function(e){return{text:null,url:null,hideButton:!0}};return t})(r.default);t.default=i});
define("ZAe",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey(e("module").id)});
define("xit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["SLe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("git",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["eFe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("rrt",["require","exports","ww","tB","Aq","D7","Y2","v"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var a=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataRequestor=new(r.scope.attached(n.dataRequestorType))({});r._apiUrlHelper=n.apiUrlHelper;r._itemUrlHelper=n.itemUrlHelper;return r}t.prototype.getFolderId=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key),n=this._apiUrlHelper.build().webByItemUrl(t).methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl});return this._dataRequestor.getData({url:n.toString(),qosName:"GetFolderId"}).then(function(e){return e.d.UniqueId})};t.prototype.getFolderItemId=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key),n=this._apiUrlHelper.build().webByItemUrl(t).methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl}).oDataParameter("$Expand","ListItemAllFields");return this._dataRequestor.getData({url:n.toString(),qosName:"GetFolderItemId"}).then(function(e){return e.d.ListItemAllFields.ID})};t.prototype.getFolderChannelUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key),n=this._apiUrlHelper.build().webByItemUrl(t).oDataParameter("$Expand","Properties").methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl});return this._dataRequestor.getData({url:n.toString(),qosName:"getFolderFromWeb"}).then(function(e){return e.d.Properties.vti_x005f_teamchannelurl})};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{dataRequestorType:o.typeResourceKey,apiUrlHelper:i.resourceKey,itemUrlHelper:s.resourceKey});return t})(r.default);t.default=a;t.resourceKey=u.createResolvedResourceKey(e("module").id,a)});
define("Hat",["require","exports","ww","tB","Aq","D7","Y2"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._dataRequestor=new(n.child(o.typeResourceKey))({qosName:"FolderItemCountDataSource"});n._apiUrlHelper=n.resources.consume(i.resourceKey);n._itemUrlHelper=n.resources.consume(s.resourceKey);return n}t.prototype.getFolderItemCountInfo=function(e){return this._dataRequestor.getData({url:this._getQueryUrl(e),qosName:"GetFolderItemCountInfo"}).then(function(e){var t=(void 0===e?{}:e).d,n=(void 0===t?{}:t).ItemCount,r=void 0===n?void 0:n;return"number"==typeof r?{itemCount:r}:void 0})};t.prototype._getQueryUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(t).method("GetFolderByServerRelativeUrl",t.serverRelativeItemUrl).segment("ItemCount").toString()};return t})(r.default);t.default=u});
define("cit",["require","exports","ww","tB","dit","xv","EI","pO","fTe","Oe","LO","g"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=a.default.getQueryUrl(o.default.Files,s.default.SecondStageRecycleBin),u=i.default.SecondStageRecycleBinLink,l=f.format(i.default.SecondStageRecycleBinInfoText,'<a title="'+u+'" href="'+r+'">'+u+"</a>");n._recycleBinFooters=[{encodedText:l}];return n}t.prototype.showLanguageLink=function(){return!1};t.prototype.showConfidentialText=function(){return!1};t.prototype.getLanguageText=function(){return""};t.prototype.getFooterLinks=function(){var e=this.resources.consume(c.pageContext);this.resources.consume(l.viewParams)();this._urlDataSource=this.resources.consume(u.url);return e.isSiteAdmin&&this._urlDataSource.isCurrentQuery(s.default.RecycleBin)?this._recycleBinFooters:[]};return t})(r.default);t.default=h});
define("Sse",["require","exports","v","fB","dv"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.GraphUrlDataSource=void 0;var s=(function(){function e(){}e.prototype.getApiName=function(){return"Graph"};e.prototype.getApiBaseUrl=function(){return!r.isFeatureEnabled(r.UseNewShareDialog)||i.isOneDriveWinApp()&&!r.isFeatureEnabled(r.UseNewShareDialogForWinApp)?"https://graph.microsoft.com/v1.0":"https://graph.microsoft.com/beta"};return e})();t.GraphUrlDataSource=s;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:new n.SimpleResourceFactory(s)})});
define("Lit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["TLe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("J2",["require","exports","K3","G3"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataStoreIdentityCache=t.IdentityCache=void 0;var i=(function(){function e(){this._state={}}e.prototype.getValue=function(e,t){var n=this._state[e];if(n&&t<n.expiration)return n;delete this._state[e]};e.prototype.setValue=function(e,t){this._state[e]=t};return e})();t.IdentityCache=i;var s=(function(){function e(e){var t=e.userId;this._store=new n.default("Identity.OAuth."+t,r.default.local)}e.prototype.getValue=function(e,t){var n=this._store.getValue(e);if(n&&t<n.expiration)return n;this._store.remove(e)};e.prototype.setValue=function(e,t){this._store.setValue(e,t)};return e})();t.DataStoreIdentityCache=s});
define("X2",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SubstrateTokenType=void 0;(function(e){e[e.STI=1]="STI";e[e.Default=2]="Default"})(t.SubstrateTokenType||(t.SubstrateTokenType={}))});
define("K2",["require","exports","ww","Z2","ey","g","A","v","Te","Ow","X2","J2","Y2","We","Q2","q2","Je","fv","W2","W"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.tokenFetcherResourceKey=void 0;var w=m.default.isActivated("70E79C4A-4303-45E7-A936-9B89FE84DE7F","8/25/2020","Use injectable Token Fetcher for OAuth tokens"),E=(function(){function e(e,t){this._dataRequestor=new t.dataRequestorType({qosName:"IdentityDataSource"});this._apiUrlHelper=new p.ApiUrlHelperBasic({webAbsoluteUrl:t.pageContext.webAbsoluteUrl})}e.prototype.getToken=function(e){var t=e.name,r={resource:e.resource,tokenType:e.tokenType},i=this._apiUrlHelper.build().segment("SP.OAuth.Token").method("Acquire").toString();return this._dataRequestor.getData({url:i,method:"POST",qosName:"AcquireToken."+t,additionalHeaders:{Accept:"application/json;odata.metadata=minimal","Odata-Version":"4.0"},additionalPostData:JSON.stringify(r),telemetryHandler:function(e){var t=e.errorData,r=e.eventData;if(t){var i=t.code;if(i&&(i.indexOf("0x80070005")>-1||i.indexOf("10012")>-1))return{eventData:n.__assign(n.__assign({},r),{resultType:b.ResultTypeEnum.ExpectedFailure})}}return{eventData:r}}})};return e})();t.tokenFetcherResourceKey=u.createResolvedResourceKey(e("module").id+".tokenFetcher",E,{dataRequestorType:h.typeResourceKey,pageContext:s.pageContext});var S=(function(e){n.__extends(u,e);function u(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._dataRequestor=n.dataRequestorType?new n.dataRequestorType({qosName:"IdentityDataSource"}):new h.default({qosName:"IdentityDataSource"});r._cache=m.default.isActivated("C31A4871-75DE-406F-9E23-CB2D40E9F29E","3/30/2020","User persistent store for user OAuth tokens")?new c.IdentityCache:new c.DataStoreIdentityCache({userId:r._pageContext.systemUserKey});r._promiseCache=new Map;r._apiUrlHelper=new p.ApiUrlHelperBasic({webAbsoluteUrl:r._pageContext.webAbsoluteUrl});r._tokenFetcher=n.tokenFetcher;return r}u.prototype.getIdentity=function(){var e=i.IdentityType.aad,t=this._pageContext;!0!==t.isAnonymousGuestUser&&!0!==t.isEmailAuthenticationGuestUser||(e=i.IdentityType.anonymous);var n=this._getUserId(),r=t.userLoginName,s=t.webPermMasks;return{email:t.userEmail,id:n,loginName:r,type:e,sessionState:"",webPermMasks:s}};u.prototype.getSignInUrl=function(){throw new Error("Not Implemented")};u.prototype.getGraphToken=function(e){var t=e.resource;return!t||this._isGraphEndpoint(t)||m.default.isActivated("B60AB760-65F0-45C7-8F22-0F07B3541F8F","1/1/2020","Fall back to SharePoint token for non-Graph endpoints")?this._getTokenForResource("ms-graph",{resource:t&&new a.SimpleUri(t).authority||"https://graph.microsoft.com"}):this.getSharePointToken(t)};u.prototype.getLokiToken=function(){return this._getTokenForResource("ms-loki",{resource:"https://loki.delve.office.com"})};u.prototype.getOfficeToken=function(){return this._getTokenForResource("ms-officeapps",{resource:"https://officeapps.live.com"})};u.prototype.getSubstrateToken=function(e){void 0===e&&(e=l.SubstrateTokenType.Default);var t="ms-substrate",n={resource:"https://substrate.office.com"};if(e===l.SubstrateTokenType.STI){n.tokenType="STI";t+="-sti"}return this._getTokenForResource(t,n)};u.prototype.getSharePointToken=function(e){var t=/https:\/\/(.*).svc.ms/.test(e),n=Number(this._pageContext.webTemplate)===g.default.mySite&&f.isFeatureEnabled(f.SupportMountPointInMoveCopyPanel);if(!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isEmailAuthenticationGuestUser&&f.isFeatureEnabled(f.UseSelfIssuedTokenForSPOWebAuth)&&!t||n)return this._getTokenForResource("SharePoint_SelfIssued",{resource:e,tokenType:"SPO"});if(this._isGraphEndpoint(e)||t){var r=this._isGraphEndpoint(e)?"-graph":t?"-media":"";return this._getTokenForResource("SharePoint"+r,{resource:e})}return this.resources.consumeAsync(d.resourceKey.bypass).then(function(t){return t.fetchToken(e)}).then(function(e){return{accessToken:e}})};u.prototype.getPowerBIToken=function(e){return this._getTokenForResource("power-bi",{resource:e})};u.prototype.getYammerToken=function(e){return this._getTokenForResource("yammer",{resource:e})};u.prototype.getOAuthToken=function(e){var t=this;this._getTokenForResource("oAuth",{resource:e}).then(function(e){t.resources.consumeAsync(v.resourceKey).then(function(t){var n={command:"OAuthTokenCommand",token:e.accessToken};t.sendCommand(n)})},function(e){t.resources.consumeAsync(v.resourceKey).then(function(t){var n={command:"OAuthTokenCommand",errorMessage:e.message||""};t.sendCommand(n)})})};u.prototype.getFormDigest=function(e){var t=e||this.getContextInfoUrl();return this._dataRequestor.getData({url:t,qosName:"IdentityDataSource.getFormDigest",method:"POST"}).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})};u.prototype.getContextInfoUrl=function(){return this._apiUrlHelper.build().segment("contextInfo").toString()};u.prototype._getTokenForResource=function(e,t){var n=this,r=e+"|"+t.resource+"|"+(t.tokenType||""),i=this._cache.getValue(r,Date.now());if(i)return o.default.resolve({accessToken:i.value,tokenExpiry:i.expiration});var s=this._promiseCache.get(r);if(s)return s;var u=this._apiUrlHelper.build().segment("SP.OAuth.Token").method("Acquire").toString(),a=(this._tokenFetcher?this._tokenFetcher.getToken({name:e,resource:t.resource,tokenType:t.tokenType}):this._dataRequestor.getData({url:u,method:"POST",qosName:"AcquireToken."+e,additionalHeaders:{Accept:"application/json;odata.metadata=minimal","Odata-Version":"4.0"},additionalPostData:JSON.stringify(t)})).then(function(e){var t=e.access_token,i=e.expires_on,s=1e3*(Number(i||y.parseTokenPayload(t).exp)-300);n._cache.setValue(r,{value:t,expiration:s});n._promiseCache.delete(r);return{accessToken:t,tokenExpiry:s}},function(e){n._promiseCache.delete(r);return o.default.reject(e)});this._promiseCache.set(r,a);return a};u.prototype._getUserId=function(){var e=this._pageContext,t=e&&e.systemUserKey;return t&&t.substring(t.lastIndexOf("|")+1).replace("@live.com","")||""};u.prototype._isGraphEndpoint=function(e){var t=this._pageContext.msGraphEndpointUrl+"/";return(e+"/").slice(0,t.length)===t};u.dependencies=n.__assign(n.__assign(n.__assign({},r.default.dependencies),{dataRequestorType:h.typeResourceKey,pageContext:s.pageContext}),w?{}:{tokenFetcher:t.tokenFetcherResourceKey.optional});return u})(r.default);t.default=S;t.resourceKey=u.createResolvedResourceKey(e("module").id,S)});
define("P0e",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=void 0;t.typeResourceKey=new n.ResourceKey(e("module").id)});
define("yit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=void 0;t.typeResourceKey=new n.ResourceKey({name:""+e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["XSe"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("Fat",["require","exports","ww","Z2","m5e","EI","ey","git","f8e","K2","fTe","eB","$N","rOe","T2","p$","U3","fB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources;n._searchSession=r.consume(i.resourceKey);n._newNpsSessionLogged=!1;n._firstRunExperienceStatus=n.resources.consume(c.resourceKey);n._identityDataSource=n.resources.consume(f.resourceKey);n._urlDataSource=n.resources.consume(l.resourceKey);n._teachingBubbleProvider=n.resources.consume(p.resourceKey);n._userInfoProvider=n.resources.consume(d.userInfo);return n}t.prototype.getEngagementData=function(e){var t;return(t={}).olsSearchSessionId=this._searchSession,t};t.prototype.userExecuteAction=function(e){var t=e.engagement;if(t)for(var n=function(t){if(v.itemEngagementPart.matches(t)){var n=t.item;if(n&&m.isSearchType(n.queryType)){var i=n.tsTraceId,s=n.tsReferenceId,o=n.itemFromServer,u=o&&o.TsLogicalSearchId;if(!i&&o){i=o.TsTraceId;s=o.TsReferenceId}i&&s&&r.resources.consumeAsync(a.resourceKey).then(function(t){t.userExecuteActionOnEntity(i,s,e.name,u)})}}},r=this,i=0,s=t.contexts;i<s.length;i++){n(s[i])}this._logActionToFloodgate(e)};t.prototype.userSeeItem=function(e){m.isSearchType(e.queryType)&&this.resources.consumeAsync(a.resourceKey).then(function(t){t.resultRendered(e)})};t.prototype._logActionToFloodgate=function(e){var t=this;if(g.isFeatureEnabled(g.EnableFloodgate)&&e){var n=e.name;this.resources.consumeAsync(u.resourceKey).then(function(e){0===n.indexOf("Upload")&&(n="Upload");if(t._identityDataSource.getIdentity().type!==o.IdentityType.anonymous){if(!t._newNpsSessionLogged&&t._isValidNpsSurveyContext()){e.recordUserAction("NewNpsSession");t._newNpsSessionLogged=!0}t._isMeaningfulNpsAction(n)&&e.recordUserAction("MeaningfulNpsAction")}e.recordUserAction(n)})}};t.prototype._isValidNpsSurveyContext=function(){var e=this._urlDataSource.getPageType(),t=e===s.default.Files||e===s.default.Photos;return!this._teachingBubbleProvider.currentBubble.peek()&&this._firstRunExperienceStatus.peek()!==h.FirstRunExperienceStatus.visible&&this._userInfoProvider.getGuidedTourCompleted()&&t};t.prototype._isMeaningfulNpsAction=function(e){return"Open.File"===e||"Open.Media"===e||/OpenIn[a-zA-z]+/.test(e)||"Upload"===e||"CreateFolder"===e||"NavigatePage"===e||/Create[a-zA-Z]+DocumentAction/.test(e)};return t})(r.default);t.default=y});
define("I5e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ITaskStatuses=void 0;(function(e){e[e.notStarted=0]="notStarted";e[e.NotStarted=0]="NotStarted";e[e.inProgress=1]="inProgress";e[e.InProgress=1]="InProgress";e[e.completed=2]="completed";e[e.Completed=2]="Completed";e[e.cancelled=3]="cancelled";e[e.Cancelled=3]="Cancelled";e[e.failed=4]="failed";e[e.Failed=4]="Failed";e[e.unknown=5]="unknown";e[e.Unknown=5]="Unknown"})(t.ITaskStatuses||(t.ITaskStatuses={}))});
define("zq",["require","exports","ww","tB","Gq","sz","Eq","bH","bH","v"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ItemTaskObserver=t.Graft=t.Task=void 0;t.Task=i.default;t.Graft=a;var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemsStore,s=void 0===i?r.resources.consume(o.resourceKey):i;r._itemsStore=s;r._itemUpdatesByKey={};return r}t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,r=e;n<r.length;n++){var i=r[n];this._processTask(i)}};t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,r=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,o=r;i<o.length;i++){var a=o[i],f=t[a],l=new s.default(a),c=this._getStoreItem(a);if(c){c.parent;var h=n.__rest(c,["parent"]);u.default(l,h)}u.default(l,{revision:0});for(var p=0,d=f.item;p<d.length;p++){var v=d[p];u.default(l,v)}e[a]=l}for(var m=0,g=r;m<g.length;m++){var y=(l=e[a=g[m]]).parentKey;if(y){var b=e[y]||this._getStoreItem(y)||new s.default(y);e[y]=b;l.parent=b}else delete l.parent}this._pushItemsToStore(e);for(var w=0,E=r;w<E.length;w++){a=E[w];delete(f=t[a]).item}};t.prototype.reset=function(){this._itemUpdatesByKey={}};t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};t.prototype.getChildren=function(e){var t,n,r,i=e.parentKey,s=e.startIndex,o=e.endIndex,u=[],a=this._itemUpdatesByKey[i];if(a){var f=a.set;if(f)if(f.childrenByIndex){s=void 0===(n=(t={startIndex:s,endIndex:o}).startIndex)?f.startIndex:n,o=void 0===(r=t.endIndex)?f.endIndex:r;for(var l=s;l<o;l++){var c=f.childrenByIndex[l],h=this._getStoreItem(c);u.push(h)}}else if(f.childrenBySibling)for(var p={},d="";d=f.childrenBySibling[d];){if(p[d])throw new Error("Circular reference encountered enumerating the children of '"+i+"'.");p[d]=!0;h=this._getStoreItem(d);u.push(h)}}return u};t.prototype._processTask=function(e){var t=e.key,n=e.output,r=n.item,i=n.set,s=this._itemUpdatesByKey,o=s[t];o||(o=s[t]={});if(r){o.item||(o.item=[]);o.item.push(r)}if(i){var u=s[i.parent.key];u||(u=s[i.parent.key]={});u.set||(u.set={});var a=u.set;if(void 0!==i.index){a.childrenByIndex||(a.childrenByIndex=[]);void 0===a.startIndex?a.startIndex=i.index:a.startIndex=Math.min(a.startIndex,i.index);var f=a.childrenByIndex.length;a.childrenByIndex[i.index]=t;void 0===a.endIndex?a.endIndex=i.index+1:a.endIndex>i.index+1?a.endIndex+=a.childrenByIndex.length-f:a.endIndex=Math.max(a.endIndex,i.index+1)}else if(i.after){a.childrenBySibling||(a.childrenBySibling={});a.childrenBySibling[i.after.key]=t}}};t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};t.prototype._pushItemsToStore=function(e){var t={};for(var n in e){(s=t[i=e[(a=e[n]).parentKey]&&a.parentKey||""]||(t[i]=[])).push(n)}for(var r=[""];r.length;){var i,s;if(s=t[i=r.shift()]){for(var o=0,u=s;o<u.length;o++){var a;if(!(a=e[n=u[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(a,n)}r.push.apply(r,s)}}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemsStore:o.resourceKey});return t})(r.default);t.ItemTaskObserver=l;t.resourceKey=new f.ResourceKey({name:e("module").id,factory:new f.ResolvedResourceTypeFactory(l)});t.default=l});
define("N8e",["require","exports","ww","t","yS","LO","g","uv","k3","B8e"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getListSchema=void 0;t.getListSchema=function(e){var t=e.listSchema,n=e.resources,r=e.groupSchema,i=e.hasFixedSchema,l=e.listContext,h=e.getItemContext,p=e.sortFallback,d=n.consume(s.disableShareHeroCommand.optional),v=n.consume(a.platformDetection).isMobile&&n.consume(s.useMobileList.optional);l||(l=n.consume(o.listContext));var m={hasFixedSchema:i,serverSupportsAutoHyperLink:!1,useCustomColumn:v,disableShareHeroCommand:d},g=f.SchemaBuilder.buildSchema(t,l,m,r,h),y=n.consume(o.pageContext),b=Number(y.webTemplate)===u.default.mySite;return g.filter(function(e){return!b||"ItemChildCount"!==e.internalName&&"FolderChildCount"!==e.internalName}).map(function(e){e.groupable=!b&&e.groupable;if(p.sortField===e.internalName&&p.sortDirection){e.isSorted=!0;e.isAscending="ascending"===p.sortDirection}return c(e,l)})};var l=(function(){function e(){}e.getCustomColumns=function(e,t,n){var r=this,i=this._convertToSPColumn(e),s=t.map(function(e){return e.map(function(e){return r._convertToSPColumn(e)})}),o=n.map(function(e){return r._convertToSPColumn(e)});return f.SchemaBuilder.getCustomColumns(i,s,o).map(function(e){return c(e)})};e.getMappedColumnType=function(e){return f.SchemaBuilder.getMappedColumnType(e)};e.getIconColumnWidth=function(e){return e.consume(a.platformDetection).isMobile&&e.consume(s.useMobileList.optional)?48:16};e.getIconColumnMinWidth=function(e){return e.consume(a.platformDetection).isMobile&&e.consume(s.useMobileList.optional)?48:16};e.fillColumnDefinitionDefaults=function(e,t,s){void 0===t&&(t={});void 0===s&&(s={});var o=t.isCollapsible,u=void 0===o||o;return e.map(function(e,o){var a=e.isIcon,f=void 0!==a&&a,l=e.sortable,c=void 0===l?!!t.sortable:l,h=e.resizable,p=void 0===h?!!t.resizable:h,d=e.isCollapsable,v=void 0===d?u:d,m=e.fieldType,g=void 0===m?i.ColumnFieldType.Text:m,y=e.name,b=e.getValue,w=e.key,E=e.width,S=!!s.sortField&&s.sortField===e.internalName,x=!!s.groupBy&&s.groupBy===e.internalName;return n.__assign(n.__assign({},e),{key:w,name:y,width:E,index:o,fieldType:g,isCollapsable:v,isIcon:f,isVisible:!0,isVisibleMobile:!0,isGrouped:x,sortable:c,isSorted:S,isAscending:S&&s.isAscending,filterable:!1,isFocused:r.observable(!1),getValue:b,resizable:p})})};e._convertToSPColumn=function(e){var t=this;return n.__assign(n.__assign({},e),{isFiltered:e.isFiltered&&e.isFiltered.peek(),filterValues:e.filterValues&&e.filterValues.peek(),customWidth:e.customWidth&&e.customWidth.peek(),clientSideColumnAdapter:e.clientSideColumnAdapter,customFields:e.customFields&&e.customFields.map(function(e){return t._convertToSPColumn(e)})})};return e})();t.default=l;function c(e,t){return n.__assign(n.__assign({},e),{key:h(e.key),clientSideColumnAdapter:e.clientSideColumnAdapter,isFiltered:r.observable(e.isFiltered),isMenuOpen:r.observable(!1),isFocused:r.observable(!1),customWidth:r.observable(0),filterValues:r.observable(e.filterValues),customFields:e.customFields?e.customFields.map(function(e){return c(e,t)}):void 0})}function h(e){var t;switch(e){case"FileSizeDisplay":t="size";break;default:t=e}return t}});
define("b5e",["require","exports","K2","v","qe","Ge","k","fe","Te","A","D7","fB"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var h=o.Killswitch.isActivated("6198356a-cc00-418b-97a3-3694d1f41512","10/14/2020","Use cross-geo specific urls"),p=(function(){function e(e,t){void 0===e&&(e={});this._identityDataSource=t.identityDataSource;this._itemUrlHelper=t.itemUrlHelper;this._isCrossGeoSupported=!h&&c.isFeatureEnabled(c.UseItemsScopeInSitesForODB)}e.prototype.getApiUrl=function(e,t){if(this._isCrossGeoSupported){var n=this._itemUrlHelper.getItemUrlParts(e.parentKey);if(n&&n.fullWebUrl&&n.geoRelation===s.GeoRelation.crossGeo)return new i.ApiUrlHelperBasic({webAbsoluteUrl:n.fullWebUrl})}return t};e.prototype.getWebAbsouluteUrl=function(e,t){if(this._isCrossGeoSupported){var n=this._itemUrlHelper.getItemUrlParts(e.parentKey);if(n&&n.fullWebUrl&&n.geoRelation===s.GeoRelation.crossGeo)return n.fullWebUrl}return t};e.prototype.getAuthToken=function(e){var t=f.default.resolve(void 0);if(e.authToken)t=f.default.resolve(e.authToken);else if(this._isCrossGeoSupported){var n=this._itemUrlHelper.getItemUrlParts(e.parentKey);n&&n.fullWebUrl&&n.geoRelation===s.GeoRelation.crossGeo&&(t=this._identityDataSource.getSharePointToken(new a.SimpleUri(n.fullItemUrl).authority).then(function(e){return e.accessToken}).catch(function(e){u.default.logError(e)}))}return t};e.dependencies={identityDataSource:n.resourceKey,itemUrlHelper:l.resourceKey};return e})();t.resourceKey=r.createResolvedResourceKey(e("module").id,p)});
define("bit",["require","exports","ww","tB","nB","v","qe","eQ","D7","wq","Ex","pO","g","Y2","Te","W","nM","uv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var y=(function(){function e(e,t){this._vroomDataRequestor=t.vroomDataRequestor;this._graphDataSource=t.graphDataSource;this._dataRequestor=new t.dataRequestorType({qosName:"ItemMuteNotificationDataSource"});this._itemUrlHelper=t.itemUrlHelper;this._itemParentHelper=t.itemParentHelper;this._identityDataSource=t.identityDataSource;this._pageContext=t.pageContext}e.prototype.getNotificationState=function(e){this._item=e;var t=this._graphDataSource.getItemUrl(e,{apiVersion:"v2.1",useDirectEndpoint:!0})+"/?$expand=notificationPreferences";return this._vroomDataRequestor.send({apiName:"ItemMuteNotificationDataSource.getState",path:t,requestType:"GET",apiVersion:"v2.1",useAuthorizationHeaders:!0,postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return e.notificationPreferences?e.notificationPreferences.every(function(e){return"None"!==e.name}):void 0}).catch(function(e){})};e.prototype.updateNotificationState=function(e,t,n,r){var i=this,s=this._getWebAbsoluteUrl(),u=new o.ApiUrlHelperBasic({webAbsoluteUrl:s}).build().segment("web").segment("ActivityLogger").segment("FeedbackDirect").toString(),a=new d.default(u);return this._identityDataSource.getSharePointToken(a.authority).then(function(t){return i._dataRequestor.getData({url:u,qosName:"ItemMuteNotificationDataSource.postState",method:"POST",additionalPostData:i._getAdditionalPostData(e,r),noRedirect:!0,authToken:t.accessToken}).catch(function(e){})})};e.prototype._getWebAbsoluteUrl=function(){var e=i.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(this._item,"subsite"));if(e&&e.subsite&&e.subsite.serverRelativeUrl)return e.subsite.serverRelativeUrl;var t=this._item.parentKey&&this._itemUrlHelper.getItemUrlParts(this._item.parentKey);return t&&t.fullWebUrl?t.fullWebUrl:this._pageContext.webAbsoluteUrl};e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var r=m.getErrorResolution(t,function(e){switch(e){case"notSupported":return{resultType:v.ResultTypeEnum.ExpectedFailure}}});return n.__assign(n.__assign({},e),r||{})};e.prototype._getNotificationPreferenceState=function(e){return e?"None":"Comments"};e.prototype._getItemType=function(){switch(this._item.type){case l.default.Subsite:case l.default.Shortcut:return"Web";case l.default.Folder:return"Folder";case l.default.File:case l.default.Media:case l.default.OneNote:case l.default.Unknown:case l.default.App:default:return"File"}};e.prototype._getAdditionalPostData=function(e,t){var n,r,i,s,o,u,a={},f=new Date,l=null===(n=this._itemParentHelper.getFacetedAncestorOrSelf(this._item,"subsite"))||void 0===n?void 0:n.peek(),c=l?l.subsite:void 0,h=null===(r=this._itemParentHelper.getFacetedAncestorOrSelf(this._item,"list"))||void 0===r?void 0:r.peek(),p=(null==c?void 0:c.siteCollectionId)?null==c?void 0:c.siteCollectionId:null==t?void 0:t.siteId,d=(null==c?void 0:c.id)?null==c?void 0:c.id:null==t?void 0:t.webId;a.ListId=null===(s=null===(i=null==h?void 0:h.list)||void 0===i?void 0:i.id)||void 0===s?void 0:s.replace("{","").replace("}","");a.ListItemUniqueId=this._item.properties?this._item.properties.uniqueId:void 0;a.Operation="NotificationPreferenceChanged";a.AffectedResourceUrl=this._itemUrlHelper.getItemUrlParts(this._item.key).fullItemUrl;a.ItemType=this._getItemType();var v=Number(this._pageContext.webTemplate)===g.default.mySite,m={Scenario:"NotificationPreference",NotificationPreference:this._getNotificationPreferenceState(e),ClientUTCOffsetInMinutes:f.getTimezoneOffset(),ClientApplication:v?"ODBWeb":"SPListWeb",ClientVersion:"1",Workload:"ODB",Canvas:"DetailsPane",SiteId:null===(o=null==p?void 0:p.replace("{",""))||void 0===o?void 0:o.replace("}",""),WebId:null===(u=null==d?void 0:d.replace("{",""))||void 0===u?void 0:u.replace("}",""),SiteUrl:this._getWebAbsoluteUrl(),SourceRelativeUrl:null==h?void 0:h.name,SourceFileExtension:this._item.extension?this._item.extension.replace(".",""):"",SourceFileName:this._item.name};a.json=JSON.stringify(m);return JSON.stringify(a)};e.dependencies=n.__assign(n.__assign({},r.default.dependencies),{vroomDataRequestor:u.resourceKey,graphDataSource:c.graph,itemParentHelper:f.resourceKey,dataRequestorType:p.typeResourceKey,itemUrlHelper:a.resourceKey,identityDataSource:c.identity,pageContext:h.pageContext});return e})();t.default=y;t.resourceKey=s.createResolvedResourceKey(e("module").id,y,n.__assign(n.__assign({},r.default.dependencies),{vroomDataRequestor:u.resourceKey,graphDataSource:c.graph,itemParentHelper:f.resourceKey,dataRequestorType:p.typeResourceKey,itemUrlHelper:a.resourceKey,identityDataSource:c.identity,pageContext:h.pageContext}))});
define("uTe",["require","exports","ww","y9","Z2","g"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n,i=e.call(this)||this,o=i.listUrl;i._pageContext=t.pageContext||i.resources.consume(s.pageContext);if(t.listRootFolderWebRelativeUrl||t.listRootFolderServerRelativeUrl||!t.listFullUrl)t.listRootFolderWebRelativeUrl?n=r.getSafeWebServerRelativeUrl(i._pageContext)+"/"+t.listRootFolderWebRelativeUrl:t.listRootFolderServerRelativeUrl&&(n=t.listRootFolderServerRelativeUrl);else{n=decodeURIComponent(t.listFullUrl).split(r.getServerUrl(i._pageContext))[1]}if(!o||n!==o){for(var u=0,a=Object.keys(i);u<a.length;u++){delete i[a[u]]}i.listUrl=n;i.listId=t.listId}!i.listTitle&&i._pageContext&&(i.listTitle=i._pageContext.listTitle);i.customWidthDictionary||(i.customWidthDictionary={});return i}return t})(i.default);t.default=o});
define("Kit",["require","exports","ww","N8e","LZ","ye","y5e","Mne","w5e","CS","xv","U3","$q","Xq","Ex","zi","Eq","uv","ey","pO","g","mx","v","A","ze","fB","M","X7","sB","W","me","trt","Mv","Oe","t$e","n$e","Kq","ZCe","zq","Gq","D7","Yq","De","ert","$it","rKe","Wx","Zit","Xit","Jit","Yit","Qit","qit","lTe","Nx","B8e","de","eS","Y9e","Ce","Ae","xe","Pee","Be","OZ","Wit","V8","LO","Aq","D7","wq","qb","WB","eW","O2","xx","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge,ye,be,we,Ee,Se){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var xe=new XMLSerializer,Te=Se.default.isActivated("D349E556-140B-4BFA-8B14-5DD337AAFB41","7/2/2020","Use per-list store for MicroServiceDataSource"),Ne=(function(t){n.__extends(S,t);function S(e,n){var r=t.call(this,n.pageContext,n)||this,i=new A.Qos({name:r.getDataSourceName()+".constructor"});ye.ABExperiment.Init(r._pageContext);try{r._itemsStore=n.itemsStore;r.apiUrlHelper=n.apiUrlHelper;r.itemUrlHelper=n.itemUrlHelper;r.itemParentHelper=n.itemParentHelper;r._urlDataSource=n.urlDataSource;r._engagement=r.resources.consume(L.resourceKey);r._useFolderScopedSearch=r.resources.consume(Z.useFolderScopedSearchKey);r._alwaysRenderFilesTitle=r.resources.consume(Z.listShouldRenderFilesTitleKey);r._microServiceDataSource=n.microServiceDataSource;r._microServiceDataSourceStore=n.microServiceDataSourceStore;r._listDataSource=n.listDataSource;r._listContext=n.listContext;r._itemsPerGroup=r.createObservable(-1);r.resources.isExposed(w.itemsPerGroup)||r.resources.expose(w.itemsPerGroup,r._itemsPerGroup);r.resources.isExposed(pe.disableShareHeroCommand)||r.resources.expose(pe.disableShareHeroCommand,!1);r._enableComments=N.isFeatureEnabled(N.EnableCommentsInActivityFeed);var s=[r._urlDataSource.getRootItemKey(l.default.Files),r._urlDataSource.getRootItemKey(l.default.Recent),r._urlDataSource.getRootItemKey(l.default.SharedWithMe),r._urlDataSource.getRootItemKey(l.default.RecycleBin)],o=new(r.resources.consume(F.resourceKey));o.update(s.map(function(e){return new I.default(e).succeed({item:{key:e,type:d.default.Folder,isRootFolder:!0}})}));o.flush();r._listItemBuilder=n.listItemBuilder;r._listItemResultProcessor=n.listItemResultProcessor;r._subsiteItemResultProcessor=n.subsiteItemResultProcessor;n.identity&&(r._userIsAnonymous=n.identity.getIdentity().type===y.IdentityType.anonymous);r._spotlightDataSource=n.spotlightDataSource;r._onePageContext=n.onePageContext;r._contentTypes=n.contentTypes;i.end({resultType:A.ResultTypeEnum.Success})}catch(e){var u=void 0;u=e.message?e.message+" "+e.stack:"object"==typeof e?JSON.stringify(e):e;i.end({resultType:A.ResultTypeEnum.Failure,error:u})}return r}S.prototype.restoreAll=function(e){return null};S.prototype.createMountPoint=function(e){return null};S.prototype.removeMountPoint=function(e){return x.default.wrap(!1)};S.prototype.changeFolderType=function(e){return null};S.prototype.saveSortOrder=function(e){return null};S.prototype.addCoverPhotos=function(e){return null};S.prototype.removeCoverPhotos=function(e){return null};S.prototype.getOpenInClientDetails=function(e){return null};S.prototype.removeFromRecent=function(e){return x.default.wrap(!1)};S.prototype.rotateItems=function(e){return x.default.wrap()};S.prototype.updateBundle=function(e){return null};S.prototype.reportAbuse=function(e){return null};S.prototype.requestReview=function(e){return null};S.prototype.updateItemOcrInfo=function(e,t,n){return null};S.prototype.getItemOcrTextContent=function(e){var t=e.properties.MediaServiceOCR||"";return x.default.wrap(t)};S.prototype.updateItemProperty=function(e){return null};S.prototype.redeemPermissionToken=function(e){return x.default.wrap(null)};S.prototype.updateViewCount=function(e){return x.default.wrap(null)};S.prototype.processReferral=function(e,t){return null};S.prototype.getItem=function(e){function t(t){return t.then(function(t){return t.getItem(e)})}var n=this._urlDataSource.getKeyParams(e.parentKey),r=this._urlDataSource.getQueryType(n);e.qosName=e.qosName||"Odb."+l.default[r]+".ListItemsDataSource.getItem";switch(r){case l.default.RecycleBin:case l.default.SecondStageRecycleBin:return t(this._getRecycleBinDataSource());case l.default.Search:return this._useFolderScopedSearch?this._getItem(e):t(this._getSearchDataSource());case l.default.SearchOdbScope:return t(this._getSearchDataSource());case l.default.SharedWithMe:return t(this._pageContext.groupId?this._getSharedItemDataSource():this._getVroomSharedItemDataSource());case l.default.SharedByMe:case l.default.DocsInCommon:return t(this._getSharedItemDataSource());case l.default.Recent:return t(Number(this._pageContext.webTemplate)===g.WebTemplateType.mySite?this.resources.consumeAsync(ce.resourceKey.bypass):this.resources.consumeAsync(W.resourceKey.bypass));case l.default.Popular:case l.default.RecentUnpopular:return t(this.resources.consumeAsync(z.resourceKey.bypass));case l.default.DocumentLibraries:return t(this.resources.consumeAsync($.resourceKey.bypass));case l.default.Subsites:return t(this.resources.consumeAsync(J.resourceKey.bypass));default:return this._getItem(e)}};S.prototype.getSpecifiedItems=function(e){var t=this,r={parentKey:e.parentKey||this._urlDataSource.getDefaultRootItemId(),itemKeys:e.itemKeys,recurseInFolders:e.recurseInFolders,getRootFolderFromParentKey:e.getRootFolderFromParentKey,viewId:null,needContentTypes:e.needContentTypes,itemSetKey:""},i=n.__assign({itemIds:null,recurseInFolders:!1,folderPath:null},this._listContext);this._listContext.itemIds=e.itemKeys;this._listContext.recurseInFolders=e.recurseInFolders;this._listContext.needSchema=!!e.needSchema;this._listContext.needForm=!!e.needForm;this._listContext.isGrouped=!1;this._listContext.group=null;this._listContext.groupBy=null;this._listContext.groupByOverride=null;this._listContext.groupLevel=null;this._listContext.groupSchema=null;this._listContext.isGrouped=!1;this._listContext.lastGroup=null;this._listContext.viewResult=null;this._listContext.viewIdForRequest=null;this._listContext.viewXmlForRequest=null;this._listContext.filterParams="";this._listContext.sortField=null;this._listContext.searchTerm=null;this._listContext.requestToken=null;r.parentKey&&(this._listContext.folderPath=this._getFolderPath(r.parentKey));var s=new A.Qos({name:this.getDataSourceName()+".GetSpecifiedItems"});return this._getItemInternal(r).then(function(e){e.children&&e.children[0]?s.end({resultType:A.ResultTypeEnum.Success}):s.end({resultType:A.ResultTypeEnum.Failure,resultCode:"ItemNotFound"});for(var n=0,r=Object.keys(i);n<r.length;n++){var o=r[n];t._listContext[o]=i[o]}return e},function(e){s.end({resultType:A.ResultTypeEnum.Failure,resultCode:"ServerError",extraData:{error:e}});for(var n,r=0,o=Object.keys(t._listContext);r<o.length;r++){n=o[r];t._listContext[n]=null}for(var u=0,a=Object.keys(i);u<a.length;u++){n=a[u];t._listContext[n]=i[n]}return e})};S.prototype.getFilterData=function(e,t,n,r){if(this._urlDataSource.isCurrentQuery(l.default.SharedWithMe))return x.default.wrap();var i=this._urlDataSource.getCurrentItemKey(ee.deserializeQuery(t)),s=this._getFolderPath(i);return new ie.ListFilterDataSource({parentKey:i,listContext:this._listContext,pageContext:this._pageContext,folderPath:s,itemUrlHelper:this.itemUrlHelper,apiUrlHelper:this.apiUrlHelper}).getFilterData(e,t,n,r)};S.prototype.createDocument=function(e,t,n,r){return this._getDeferredDataSource().then(function(i){return i.createDocument(e,t,n,r)})};S.prototype.createCustomDocument=function(e,t,n){return this._getDeferredDataSource().then(function(r){return r.createCustomDocument(e,t,n)})};S.prototype.createFolder=function(e){return this._getDeferredDataSource().then(function(t){return t.createFolder(e)})};S.prototype.deleteItems=function(e){return this._getRecycleBinDataSource().then(function(t){return t.deleteItems(e)})};S.prototype.moveItems=function(e){return this._getDeferredDataSource().then(function(t){return t.moveItems(e)})};S.prototype.copyItems=function(e){return this._getDeferredDataSource().then(function(t){return t.copyItems(e)})};S.prototype.getWorkProgress=function(e){return this._getDeferredDataSource().then(function(t){return t.getWorkProgress(e)})};S.prototype.cancelWork=function(e){return this._getDeferredDataSource().then(function(t){return t.cancelWork(e)})};S.prototype.restoreItems=function(e){return this._getRecycleBinDataSource().then(function(t){return t.restoreItems(e)})};S.prototype.renameItem=function(e){return this._getDeferredDataSource().then(function(t){return t.renameItem(e)})};S.prototype.removeFromSharedList=function(e){return this._getDeferredDataSource().then(function(t){return t.removeFromSharedList(e)})};S.prototype.updateContentType=function(e,t,n){return this._getDeferredDataSource().then(function(r){return r.updateContentType(e,t,n)})};S.prototype.getDataSourceName=function(){return"ListItemDataSource"};S.prototype._isRequestingListViewData=function(e){return new RegExp("web/.*?/RenderListDataAsStream").test(e)};S.prototype._getPostDataContext=function(e){var t=!!this._listContext.needSchema||!this._listContext.listSchema||this._listContext.isGrouped&&!this._isExpandingGroup()||e.isGrouped,n=!!e.needContentTypes||!!this._listContext.needContentTypes,r=this._needsQuickLaunch();this._isFirstGroupOnlyQuery=!this._supportsNestedGroups&&0===this._listContext.groupLevel&&this._listContext.groupBy&&this._listContext.groupBy.length>1;var i=!1;if(e.parentKey&&this._spotlightDataSource&&!this._isSpecifiedItemRequest()){var s=this._listContext.viewIdForRequest;i=this._spotlightDataSource.shouldFetchSpotlight(e.parentKey,s,this._listContext)}var o=!!this._listContext.viewIdForRequest&&!this._listContext.viewResult,u=this._userIsAnonymous,a=this._fetchNextGroup(),f=e.additionalFiltersXml;if(a){var l=U.getFilterXmlToFetchNextGroup(this._listContext.lastGroup);if(this._listContext.viewXmlForRequest){var c=se.getViewDomParts(this._listContext.viewXmlForRequest);if(c&&c.where){var h=c.where.innerHTML?oe.combineFilters([c.where.innerHTML,l]):l,p=D.format("<{0}>{1}</{0}>",ue.CamlTags.where,h),d=xe.serializeToString(c.where);this._listContext.viewXmlForRequest=this._listContext.viewXmlForRequest.replace(d,p)}}else f=f?"<And>"+f+l+"</And>":l}var v=!(e.sortField||Number(this._pageContext.webTemplate)!==g.WebTemplateType.mySite||!this._pageContext.isSiteAdmin||this.itemUrlHelper.getItemUrlParts(e.parentKey).isCrossList),m=!this._listContext.needUpdatePageContext&&e.needClientSideComponentManifest,y=!!e.needsMountPoint;return{needsSchema:t,needsContentTypes:n,needsForms:!!this._listContext.needForm,needsQuickLaunch:r,needsSpotlight:i,needsViewMetadata:o,needsParentInfo:u,viewXml:this._getViewXml(),firstGroupOnly:this._isFirstGroupOnlyQuery,expandGroups:this._expandGroup,allowMultipleValueFilterForTaxonomyFields:!!this._pageContext.isSPO||void 0,fieldNames:this._listContext.fieldNames,requestToken:this._listContext.requestToken,isListDataRenderOptionChangeFeatureEnabled:N.isFeatureEnabled(N.ListDataRenderOptionChange),isSpotlightFeatureEnabled:N.isFeatureEnabled(N.Spotlight),groupByOverride:this._listContext.groupByOverride,requestDatesInUtc:Number(this._pageContext.webTemplate)===g.WebTemplateType.mySite&&N.isFeatureEnabled(N.RequestDatesInUtc),needUpdatePageContext:!!this._listContext.needUpdatePageContext,needClientSideComponentManifest:m,groupReplace:!!this._groupReplace,additionalFiltersXml:f,webId:e.webId,siteId:e.siteId,mergeDefaultView:v,needsMountPoint:y}};S.prototype._processData=function(e,t,i){ne.default.mark("EUPL.ListItemDataSource.ProcessData.Start");var s,o=e.parentKey,u=i.ListData||i,a=u.Row,f=this._urlDataSource.getKeyParams(o),l=f.id,h=this._listContext.listSchema,p=i.ListContenTypes,d=this._onePageContext,m=d&&d.handleOnePageNavigationFallback,g=null;e.itemSetKey&&(s=this._itemsStore.getItemSet(e.itemSetKey));i.ListSchema&&(g=i.ListSchema.CustomFormatter);var y=i.NewExperienceRendering,b=void 0===y||y,w=i.ListSchema,E=i.ListData;if(!b&&m){m("modern UX is not supported");throw{code:"-4, onePageNavigationError"}}i.PageContextInfo&&this._updatePageContextInfo(i.PageContextInfo);te.ListItemBuilderHelpers.updateListContext(i,this._listContext);if(w){var S={};h=this._listContext.listSchema=r.getListSchema({listSchema:w,resources:this.resources,groupSchema:S,hasFixedSchema:this._listContext.listTemplateType===v.ListTemplateType.mySiteDocumentLibrary,listContext:this._listContext,getItemContext:e,sortFallback:{sortField:E.SortField,sortDirection:E.SortDir}});w.group1&&(this._listContext.groupSchema=S)}else s&&s.schema&&s.schema.peek()&&(h=this._listContext.listSchema=s.schema.peek());i.Navigation&&(this._listContext.leftNavigationData={quickLaunchNodes:i.Navigation.Nodes});if(i.ViewMetadata&&d){var x=this._listContext.viewResult.serverRelativeUrl,T=this._listContext.viewResult.id,k=d.newTargetListViewUrl,L=d.newTargetListViewId;if(x&&k&&-1===k.toLowerCase().indexOf(x.toLowerCase())&&T&&L!==T&&m){m("view does not match");throw{code:"-4, onePageNavigationError"}}d.newTargetListViewId=d.newTargetListViewUrl=void 0}var A=w&&"TRUE"===w.Collapse,O=!A&&a?a.slice(0):[];l&&l!==this._urlDataSource.getDefaultRootItemId()||(l=this._listContext.listUrl);var M="";u.NextHref&&(M=(M=u.NextHref).replace("&View="+C.default.Empty,""));var _=new(this.resources.consume(F.resourceKey));this._processResponse({response:i,observer:_,requestKey:o});this.resources.consumeAsync(P.resourceKey.optional).then(function(e){e&&e.trackListToken(o)});var D={id:f.id,folder:{childCount:O.length,children:O},nextRequestToken:M,PermMask:u.FolderPermissions,groups:A?a:null,isRootFolder:!1};if(be.isTeamChannelBannerEnabled()){var H=i&&i.ListData&&i.ListData.CurrentFolderProgId;D.ProgId=H}c.isSearchType(t)&&this._engagement.logData({name:"Search.InpageNumResults",extraData:{count:O.length}});var B=null;if(this._listContext.groupByOverride)B=[this._listContext.groupByOverride];else if(this._listContext.rawListSchema&&this._listContext.rawListSchema.group1){(B=[]).push(this._listContext.rawListSchema.group1);this._listContext.rawListSchema.group2&&B.push(this._listContext.rawListSchema.group2);this._isFirstGroupOnlyQuery||(this._listContext.groupBy=B)}this._listContext.groupLevel=this._getGroupLevel();this._listContext.isGrouped=!!B;1===e.groupingType&&(B=["__ItemType"]);this._contentTypes&&(p?this._contentTypes(p):p=this._contentTypes.peek());if(h&&p){for(var j={},I=0,q=h;I<q.length;I++){var R=q[I];j[R.internalName]=n.__assign(n.__assign({},R),{requiredForContentTypes:{}})}for(var U=0,z=p;U<z.length;U++){if(Z=(Y=z[U]).requiredFields&&Y.requiredFields.split(","))for(var W=0,X=Z;W<X.length;W++){var V=X[W];j[V]&&(j[V].requiredForContentTypes[Y.contentTypeId]=!0)}}h=h.map(function(e){return j[e.internalName]})}if(p&&p.length>0){for(var $={},J={},K={},Q=0,G=p;Q<G.length;Q++){var Y,Z=(Y=G[Q]).requiredFields&&Y.requiredFields.split(","),ee=Y.requiredLookups&&Y.requiredLookups.split(",");$[Y.contentTypeId]=Z;if(Z)for(var re=0;re<Z.length;re++){var ie=Z[re];J[ie]||(J[ie]=!0);K[ie]=ee&&"True"===ee[re]}}this._listContext.contentTypeRequiredFields=$;this._listContext.requiredFieldsAreLookups=K;this._listContext.requiredFields=Object.keys(J);this._listContext.needContentTypes=!1}var se=this._listItemBuilder.getItemResult({requestKey:o,queryType:t,itemFromServer:D,groupBy:B,itemGroups:null,contentTypes:p,supportsNestedGroups:this._supportsNestedGroups,observer:_}),oe=se.children,ue=se.item,ae=se.groupings,fe=se.totalChildren;this._processListTitleOverride({response:i,listUrl:this._getListUrl(o),requestKey:o,observer:_});e.skipStoreResults||_.flush();N.isFeatureEnabled(N.Spotlight)&&this._cacheSpotlightItemsFromServerData({requestKey:o,parentItem:this._itemsStore.getItem(o),queryType:t,spdata:i});var le,ce,he=this._itemsStore.getItem(ue.key);if(oe){le=[];for(var pe=0,de=oe;pe<de.length;pe++){var ve=de[pe];le.push(this.peekUnwrapObservable(this._itemsStore.getItem(ve.key)))}}if(ae&&ae[0]){var me=ae[0].itemGroups,ge=me[me.length-1];ge.fieldSchema&&this._listContext.groupSchema[ge.fieldSchema.Name]&&(this._listContext.lastGroup=ge)}for(var ye=0,we=h;ye<we.length;ye++){if((R=we[ye]).internalName===this._listContext.sortField){ce=R.key;break}}var Ee={item:this.peekUnwrapObservable(he),groupings:ae,children:le,totalChildren:fe,schema:h,contentTypes:p,nextRequestToken:M,sortField:ce,isAscending:"true"===this._listContext.isAscending,customViewRenderer:g,viewId:this._listContext.viewResult?this._listContext.viewResult.id:void 0};this._listContext.group?Ee.startIndex=this._listContext.group.startIndex:u.FirstRow&&(Ee.startIndex=u.FirstRow-1);i.isFromServiceWorkerCache?Ee.isFromBrowserCache=!0:Ee.isFromBrowserCache=!1;ne.default.mark("EUPL.ListItemDataSource.ProcessData.End");return Ee};S.prototype._processResponse=function(e){var t,n,r=e.response,i=e.requestKey,s=e.observer,o=this.itemUrlHelper.getItemUrlParts(i);if(Ce(r)){t=r;n=r.ListSchema}else t={ListData:r};var u=this._listItemResultProcessor.processResponse({response:t,requestKey:i,observer:s}).listRootItemKey;if(n){var a={data:n,allowCookies:this._isOneDrive(o.normalizedListUrl)};if(!Te){this._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(u).setBaseInfo(a)}this._microServiceDataSource.setBaseInfo(a)}};S.prototype._updatePageContextInfo=function(e){try{var t=JSON.parse(e);t.serverRequestPath=void 0;this.updateContext(t);this._defaultListUrl=t.listUrl}catch(e){}};S.prototype._getFolderPath=function(e,t){var n=this._urlDataSource.getKeyParams(e).id;return n&&n!==this._urlDataSource.getDefaultRootItemId()?n:null};S.prototype._getListUrl=function(e){var t=this._urlDataSource.getKeyParams(e),n=t&&t.listurl;n||(n=this._listContext.listUrl);return n};S.prototype._isOneDrive=function(e){return!this.itemUrlHelper.getItemUrlParts(e).isCrossList&&this._listContext.listTemplateType===v.ListTemplateType.mySiteDocumentLibrary};S.prototype._processListTitleOverride=function(e){var t,r,i=e.response,s=e.requestKey,o=e.observer;r=Ce(i)?i:{ListData:i};var f,c,h=this._urlDataSource.getKeyParams(s),p=h.q,d=this.itemUrlHelper.getItemUrlParts(s),m=this.itemUrlHelper.getUrlParts({path:d.serverRelativeListUrl,listUrl:d.fullListUrl}),g=r.ListTemplateType;if(this._urlDataSource.isCurrentQuery(l.default.Search,h)&&p){!Se.default.isActivated("5631af76-a985-4c61-8139-789b19820d3d","9/21/2020","Align SP list search result title with odb shared library")&&N.isFeatureEnabled(N.CSISpoScopeControl)||(f=D.format(a.default.SearchResultsTitle,p));c=l.default.Search}else(this._alwaysRenderFilesTitle||Number(g)===v.ListTemplateType.mySiteDocumentLibrary)&&(f=u.default.Files);if(f){var y=this._urlDataSource.getKey(((t={}).id=m.serverRelativeItemUrl,t.listurl=m.normalizedListUrl,t.view=h.view,t.q=h.q,t.typeFilters=h.typeFilters,t));o.update([new I.default(y).succeed({item:n.__assign({key:y,name:f,displayName:f},void 0!==c?{queryType:c}:{})})])}};S.prototype._setContext=function(e){var t=this,n=this._urlDataSource.getKeyParams(e.parentKey),r=e.newTargetListUrl||n.listurl||this._defaultListUrl,i=this._urlDataSource.getItemTypeFilter(n);this._supportsNestedGroups=e.supportsNestedGroups;this._expandGroup=e.expandGroup;this._groupReplace=e.groupReplace;var s=e.baseViewId,o=e.viewXml,u=e.filters,a=void 0===u?{}:u,f=e.sortField,l=e.isAscending,c=e.requestToken,h=e.needSchema,p=e.pageSize,d=void 0===p?30:p,v=e.parentKey,m=e.groupBy,g=e.group,y=e.query,b=e.queryType,w=e.needUpdatePageContext,E=e.resultSetOptions,S=(void 0===E?{}:E).fieldNames,x=void 0===S?[]:S,N=e.viewPath;r&&(this._listContext.listUrl=r);this._listContext.filterParams=Object.keys(a||{}).map(function(e){return"&"+e+"="+T.default.encodeURIComponent(a[e])}).join("");this._listContext.itemIds=null;this._listContext.requestToken=c;this._listContext.needSchema=!!h;this._listContext.pageSize=d;this._listContext.folderPath=this._getFolderPath(v,e);this._listContext.groupByOverride=m;this._listContext.groupLevel=this._getGroupLevel();this._listContext.group=g;this._listContext.searchTerm=y;this._listContext.queryType=b;this._listContext.typeFilter=i;this._listContext.fieldNames=x;var C=this._urlDataSource.getKeyParams(v);!C.listurl&&e.newTargetListUrl&&(C.listurl=e.newTargetListUrl);var k=this._urlDataSource.getKey(C);this._listContext.urlParts=this.itemUrlHelper.getItemUrlParts(k);this._listContext.needUpdatePageContext=!!w;!this._listContext.refreshClientForm&&this._listContext.needUpdatePageContext&&(this._listContext.refreshClientForm=!0);try{var L=JSON.stringify({defaultFullWebUrl:this._pageContext.webAbsoluteUrl,defaultListUrl:this._pageContext.listUrl,keyParts:n});re.Verbose.logData({name:"ListItemsDataSource._setContext",message:L})}catch(e){}return this._loadRemoteParentWeb({parentKey:v,remoteWebUrl:e.remoteWebUrl}).then(function(){return t._loadView({fieldNames:x,typeFilter:i,baseViewId:s,viewXml:o,viewPath:N,listFullUrl:t._listContext.urlParts.fullListUrl})}).then(function(){if(f){t._listContext.sortField=f;t._listContext.isAscending=!1===l?"false":"true"}else if(t._isUsingView()){t._listContext.sortField=null;t._listContext.isAscending=null}})};S.prototype._loadRemoteParentWeb=function(e){var t,n=this,r=e.parentKey,i=e.remoteWebUrl;delete this._listContext.remoteParentWeb;var s=this.itemUrlHelper.getItemUrlParts(r),o=s.fullListUrl;if(i){var u=new URL(i).origin;o=u+s.serverRelativeListUrl}s.isCrossList&&s.siteRelation!==q.SiteRelation.sameSite&&(t=this.resources.consumeAsync(K.resourceKey.bypass).then(function(e){return e.getSiteForList(o,s.siteRelation)}).then(function(e){n._listContext.remoteParentWeb=e;var t=new(n.resources.consume(F.resourceKey));n._subsiteItemResultProcessor.processSubsite({subsite:e,requestKey:r,observer:t});t.flush()},function(e){}));return x.default.as(t).then(function(){})};S.prototype._loadView=function(e){var t,n=this,r=e.fieldNames,i=e.typeFilter,s=e.baseViewId,o=e.viewXml,u=e.viewPath,a=e.listFullUrl;this._setViewIdAndPath(s,u);var f=r.filter(function(e){return"name.FileSystemItemId"!==e});(i.filters.length||f.length)&&s&&!o&&(t=this._listDataSource.getView({id:s},a).then(function(e){o=e.getEffectiveViewXml();n._listContext.viewResult=e}));return x.default.as(t).then(function(){n._listContext.viewXmlForRequest=o})};S.prototype._getViewXml=function(){var e=this._listContext,t=e.fieldNames,r=void 0===t?[]:t,i=e.typeFilter,s=void 0===i?{filters:[]}:i,o=e.viewXmlForRequest,u=e.sortField,a=e.isAscending,l=e.groupByOverride;if(!u&&!this._isUsingView()&&!this._isTeamSiteLike()){u="LinkFilename";a="true"}var c=r.filter(function(e){return"name.FileSystemItemId"!==e}),h="";if(this._isSpecifiedItemRequest()||!this._isUsingView())h=U.getViewXml({sortField:u,itemIds:this._listContext.itemIds,isAscending:a,pageSize:this._listContext.pageSize,fetchNextGroup:void 0,lastGroup:this._listContext.lastGroup,recurseInFolders:this._listContext.recurseInFolders,fieldNames:c,typeFilter:s,groupBy:this._listContext.groupByOverride?[this._listContext.groupByOverride]:this._listContext.groupBy,userIsAnonymous:this._userIsAnonymous,requestMetaInfo:N.isFeatureEnabled(N.EnablePowerPointWrsPreview)||N.isFeatureEnabled(N.EnableWordWrsPreview),requestCommentFlags:this._enableComments});else if(o)if(u||l||s.filters.length||c.length){var p=new f.default(o);u&&p.updateSort(null,{overwriteAll:!0});l&&p.updateGroupBy({isCollapsed:!1,group1:{fieldName:l}});s.filters.length&&p.addFilters([U.getTypeFilterViewXml(s)]);c.length&&p.replaceFields(n.__spreadArrays(p.getEffectiveFieldNames(),c));h=p.getEffectiveViewXml()}else h=this._listContext.viewXmlForRequest;return h};S.prototype._getItem=function(e){var t=this,n=this.itemUrlHelper.getItemUrlParts(e.parentKey),r=this.peekUnwrapObservable(this._itemsStore.getItem(e.parentKey));if(e.newTargetListUrl||e.requestToken||r&&r.type===d.default.Folder||n.fullItemUrl===n.fullListUrl||r&&r.remoteItem||e.remoteItem||e.isMountPointFolder)return this._getAsFolder(e);if(r&&(r.type===d.default.File||r.type===d.default.Media||r.type===d.default.Unknown||r.type===d.default.Shortcut)||e.ignoreChildren){ne.default.mark("EUPL.OneUP.GetSingleItem.Start");return this._getSingleItem(e)}return this._getAsFolder(e).then(function(n){var r=t.peekUnwrapObservable(t._itemsStore.getItem(n.item.key));if(!y.PermissionMask.hasPermission(r.permissions,y.PermissionMask.openItems)&&!n.totalChildren){ne.default.mark("EUPL.NoOneUP.GetSingleItem.Start");return t._getSingleItem(e).then(function(e){var r=n&&t.peekUnwrapObservable(t._itemsStore.getItem(n.item.key));return r&&r.type!==d.default.Folder?e:n})}t._listContext.listTemplateType===v.ListTemplateType.mySiteDocumentLibrary&&t._getSingleItem(e).done();return n})};S.prototype._getAsFolder=function(e){var t=this,n=this._listContext;e.ignoreListContext&&(this._listContext={});return this._setContext(e).then(function(){return t._getItemInternal(e).then(function(r){e.ignoreListContext&&(t._listContext=n);return r})})};S.prototype._getRemoteItemUrl=function(e){return e.SiteUrl+"/_api/web/Lists/GetById(@a1)/RenderListDataAsStream?@a1="+e.ListId+"&RootFolderUniqueId=$"+e.UniqueId};S.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})};S.prototype._getSingleItem=function(e){var t,n=this,r=this.itemUrlHelper.getItemUrlParts(e.parentKey),i=new R.SPListItemRetriever({pageContext:this._pageContext}),s=this.itemUrlHelper.getUrlParts({path:r.serverRelativeListUrl,listUrl:r.fullListUrl}),o=this._urlDataSource.getKey(((t={}).id=s.serverRelativeItemUrl,t.listurl=s.normalizedListUrl,t)),u=U.getViewXml({sortField:void 0,itemIds:void 0,itemRefs:[r.serverRelativeItemUrl],isAscending:void 0,recurseInFolders:!0,requestMetaInfo:!0,requestCommentFlags:this._enableComments,pageSize:1}),a=new A.Qos({name:"GetSingleItem"}),f={viewXml:u,needsSchema:!0,needsParentInfo:!0,isListDataRenderOptionChangeFeatureEnabled:N.isFeatureEnabled(N.ListDataRenderOptionChange)},c={urlParts:s},h=e.remoteItem?this._getRemoteItemUrl(e.remoteItem):i.getUrl(c,e),p=e.remoteItem?this._getRemoteItemPostData():i.getAdditionalPostData(f);return this._tryGetPrefetchedListViewData({url:h,parseResponse:function(e){var t=e.listData;return JSON.parse(t)},qosName:"GetSingleItemFromPrefetchedData",qos:a,additionalPostData:p,fallbackGetData:function(){var t={parentKey:o,postDataContext:f,skipServiceWorkerCache:!1,remoteItem:e.remoteItem,authToken:e.authToken,siteUrl:e.remoteWebUrl};e.skipCache&&(t.skipServiceWorkerCache=!0);var n={qosEvent:a,qosName:"GetData"};return i.getItem(t,c,n)}}).then(function(t){var r=new(n.resources.consume(F.resourceKey));n._processResponse({response:t,requestKey:o,observer:r});var i=t.ListData.Row,s=!i.length&&n._getError(-2147024894);if(s)r.update([new I.default(e.parentKey).succeed({item:{key:e.parentKey,type:d.default.Error,error:{type:2,data:s},isPlaceholder:!1}})]);else for(var u=(function(e){var t=e.ListTemplateType,n=Number(t);return isNaN(n)?void 0:n})(t),f=0,c=i;f<c.length;f++){var h=c[f];n._listItemBuilder.getItemResult({requestKey:o,queryType:l.default.Files,itemFromServer:h,listTemplateType:u,supportsNestedGroups:!1,observer:r})}n._processListTitleOverride({response:t,listUrl:n._getListUrl(o),requestKey:o,observer:r});r.flush();a.end({resultType:A.ResultTypeEnum.Success});return s?x.default.wrapError(s):{item:{key:e.parentKey},children:[],totalChildren:0}},function(t){var r=t?"string"==typeof t.code?t.code.split(","):t.error.code.split(","):[],i=r.length>1?Number(r[0]):-1,s=n._getError(i,void 0,t),o=new(n.resources.consume(F.resourceKey));o.update([new I.default(e.parentKey).succeed({item:{key:e.parentKey,type:d.default.Error,isPlaceholder:!1,error:{type:2,data:s}}})]);o.flush();return x.default.wrapError(s)})};S.prototype._isUsingView=function(){return!(!this._listContext.viewXmlForRequest&&!this._listContext.viewIdForRequest)};S.prototype._isTeamSiteLike=function(){return g.isTeamSiteLike(this._pageContext.webTemplate)};S.prototype._getItemInternal=function(e){var t=this,r=this._urlDataSource.getKeyParams(e.parentKey),i=this._urlDataSource.getQueryType(r),s=new A.Qos({name:"GetPrefetchedListViewData"}),o=new R.SPListItemRetriever({pageContext:this._pageContext}),u=i===l.default.Files,a=c.isSearchType(i),f=this._getPostDataContext(e),h=function(e){e.resultCode&&(e.resultCode="GetData."+e.resultCode);switch(e.resultType){case A.ResultTypeEnum.ExpectedFailure:ge.logExpectedFailure(e);break;case A.ResultTypeEnum.Failure:ge.logUnexpectedFailure(e)}},p=function(){var r=n.__assign({},e);r.postDataContext=t._getPostDataContext(e);e.skipCache&&(r.skipServiceWorkerCache=!0);var u={qosEvent:s,qosName:a?"SearchGetData":"GetData"};return o.getItem(r,t._listContext,u,h).then(function(n){return t._handleDataProcessing(n,i,e)})},d=o.getUrl(this._listContext,e);return(u&&this._isRequestingListViewData(d)?this._tryGetPrefetchedListViewData({url:d,parseResponse:function(n){var r,i=n.listData;try{"string"==typeof i&&(r=JSON.parse(i))}catch(e){if("{}"!==i.substring(0,2)){s.end({resultType:A.ResultTypeEnum.Failure,resultCode:"BadJSON",extraData:{responseText:i,prefetch:"true"}});throw e}r=JSON.parse(i.substring(2))}return t._handleDataProcessing(r,e.queryType,e)},qosName:"GetItemFromPrefetchedData",qos:s,additionalPostData:o.getAdditionalPostData(f),fallbackGetData:p}):p()).then(function(e){return e},function(e){if(void 0===e.code&&void 0===e.error)return x.default.wrapError(e);var n="string"==typeof e.code?e.code.split(","):e.error.code.split(","),r=n.length>1?Number(n[0]):-1;return x.default.wrapError(t._getError(r,void 0,e))})};S.prototype._tryGetPrefetchedListViewData=function(e){var t=this;0;ne.default.mark("EUPL.GetPrefetch.Start");var n=e.url,r=e.qos,i=e.fallbackGetData,o=e.additionalPostData,u=s.default.createHashCode(n,o);window.ListDataActualHash=u;var a=s.default.prefetchData(u);if(!a){if(s.default.shouldLogError){var f=-1===n.indexOf("?")?null:ee.deserializeQuery(n.substring(n.indexOf("?")+1));r.end({resultType:A.ResultTypeEnum.Failure,resultCode:"PrefetchNotStartedOrUrlOrPayLoadNotMatch",extraData:{AdditionalPostData:o||"null",QueryStrings:f?Object.getOwnPropertyNames(f):"null"}});s.default.shouldLogError=!1}0;return i()}s.default.shouldLogError=!1;var l=function(){var e=s.default.createHashCode("ListContenTypes","ListContenTypes"),n=s.default.prefetchData(e);n&&n.listData?t._contentTypes&&t._contentTypes(n.listData):a&&(a.contentTypesCallback=l)};l();var c=function(t,f){var l=function(l,c){if(200===l||c){r.end({resultType:A.ResultTypeEnum.Success});var h=ne.default.getResponseEnd();if(l&&!c){ne.default.summary.dataFetchServerTime=a.serverDuration;if(window.performance&&performance.timing){ne.default.summary.prefetchStart=a.startTimeMark-h;window.g_prefetchStart=ne.default.summary.prefetchStart}var p=_.default.getRUMOneLogger();if(p){var d=a.correlationId,v=new M.default(n,a.serverDuration,d,l,null,(new Date).toISOString());p.writeAPICallPerformanceData(v)}ne.default.mark("EUPL.Prefetch.End")}else if(c){if(window.g_deferDataLoadTime&&window.performance&&performance.timing){ne.default.summary.deferredListDataRender=Number(window.g_deferDataLoadTime)-h;window.g_deferredListDataRender=ne.default.summary.deferredListDataRender}ne.default.mark("EUPL.DeferredListData.End")}try{var m=e.parseResponse(a);t(m)}catch(e){f(e)}}else{(403===l?{resultType:A.ResultTypeEnum.ExpectedFailure,resultCode:"PrefetchUnauthorized"}:{resultType:A.ResultTypeEnum.Failure,resultCode:"PrefetchFailed"}).extraData={AdditionalPostData:o||"null",ResponseStatusCode:l};0;i().then(t,f)}s.default.clearPrefetchData(u)};a.responseCode||a.deferredListData?l(a.responseCode,a.deferredListData):a.completedCallback=l};return O.Api.instrumentPromise({url:n,name:this.getDataSourceName()+"."+e.qosName},function(){return new x.default(c)},null,function(e){return e&&"Canceled"===e.name?{error:e,resultCode:"Canceled",resultType:A.ResultTypeEnum.ExpectedFailure}:{error:e,resultType:A.ResultTypeEnum.Failure}})};S.prototype._setViewIdAndPath=function(e,t){if(e){e=C.default.normalizeLower(e,!1);this._listContext.viewIdForRequest=e;this._listContext.viewResult&&this._listContext.viewResult.id!==e&&(this._listContext.viewResult=null)}e&&e!==C.default.Empty||!t||(this._listContext.viewPathForRequest=t)};S.prototype._getError=function(e,t,n){var r=n&&n.correlationId,i={ItemNotFoundTitle:o.default.ItemNotFoundTitle,ItemNotFoundSubText:o.default.ItemNotFoundSubText,InvalidViewTitle:o.default.InvalidViewTitle,InvalidViewSubText:o.default.InvalidViewSubText,InvalidListTitle:o.default.InvalidListTitle,InvalidListSubText:o.default.InvalidListSubText,QueryThrottledSubText:o.default.QueryThrottledSubText,QueryThrottledLinkText:o.default.QueryThrottledLinkText,DefaultTitle:o.default.DefaultTitle,DefaultSubText:o.default.DefaultSubText};-2147024860===e&&this._engagement.logData({name:"listView.Throttled",extraData:{correlationId:n.correlationId}});return he.generateError(e,i,r)};S.prototype._fetchNextGroup=function(){return this._listContext.isGrouped&&this._listContext.group&&"__next__"===this._listContext.group.groupingId&&!(this._groupReplace&&this._listContext.lastGroup&&this._listContext.lastGroup.count<this._itemsPerGroup.peek())&&!this._isSpecifiedItemRequest()};S.prototype._isSpecifiedItemRequest=function(){return this._listContext.itemIds&&this._listContext.itemIds.length>0};S.prototype._needsQuickLaunch=function(){return!N.isFeatureEnabled(N.DoNotIncludeQuickLaunchInDeferredListData)&&!this._listContext.leftNavigationData&&this._isTeamSiteLike()&&N.isFeatureEnabled(N.RenderListDataAsStreamLeftNavOpt)};S.prototype._isExpandingGroup=function(){return this._listContext.group&&"__next__"!==this._listContext.group.groupingId};S.prototype._getGroupLevel=function(){var e=-1,t=this._listContext.groupByOverride?[this._listContext.groupByOverride]:this._listContext.groupBy,n=this._listContext.rawListSchema&&"TRUE"===this._listContext.rawListSchema.Collapse;if(t&&t.length>0){e=0;if(this._supportsNestedGroups){if(this._listContext.filterParams&&!n){var r=(i=k.default.getFilterFieldByName(this._listContext.filterParams,t[0]))&&t[1]&&k.default.getFilterFieldByName(this._listContext.filterParams,t[1]);(i&&1===t.length||r&&2===t.length)&&(e=-1)}}else if(this._listContext.filterParams){var i;if(i=k.default.getFilterFieldByName(this._listContext.filterParams,t[0])){e=(r=k.default.getFilterFieldByName(this._listContext.filterParams,t[1]))&&!n?-1:1}}}return e};S.prototype._cacheSpotlightItemsFromServerData=function(e){var t=e.requestKey,n=e.parentItem,r=e.queryType,i=e.spdata;if(this._spotlightDataSource&&i.SpotlightInfo&&this._listContext.viewIdForRequest&&n&&n.peek()&&n.peek().key){var s=[],o=this._spotlightDataSource;if(i.SpotlightInfo.Items&&i.SpotlightInfo.Items.Row&&i.SpotlightInfo.Order&&i.SpotlightInfo.Order.length){for(var u=i.SpotlightInfo.Items.Row,a=i.SpotlightInfo.Order,f=new(this.resources.consume(F.resourceKey)),l=[],c=0,h=u;c<h.length;c++){var p=h[c];l.push(this._listItemBuilder.getItemResult({requestKey:t,queryType:r,itemFromServer:p,groupBy:null,itemGroups:null,contentTypes:[],supportsNestedGroups:this._supportsNestedGroups,observer:f}).item)}f.flush();for(var d={},v=0,m=l;v<m.length;v++){var g=m[v].key;(w=this._itemsStore.getItem(g))&&(d[w.peek().properties.ID]=w)}for(var y=0,b=a;y<b.length;y++){var w;(w=d[b[y]])&&s.push(w)}}var E=this._listContext.viewIdForRequest===C.default.Empty?this._listContext.viewResult.id:this._listContext.viewIdForRequest;o.cacheSpotlightItems(n,E,s)}};S.prototype._getDeferredDataSource=function(){return this.resources.consumeAsync(Y.resourceKey)};S.prototype._getSearchDataSource=function(){return this.resources.consumeAsync(V.resourceKey.bypass)};S.prototype._getSharedItemDataSource=function(){return this.resources.consumeAsync(G.resourceKey.bypass)};S.prototype._getVroomSharedItemDataSource=function(){return Ee.isGallatin()?this._getSharedItemDataSource():this.resources.consumeAsync(Q.resourceKey.bypass)};S.prototype._getRecycleBinDataSource=function(){return this.resources.consumeAsync(X.resourceKey.bypass)};S.prototype._handleDataProcessing=function(e,t,n){var r=this;n.remoteItem&&(n.parentKey=e&&e.rootFolder?e.rootFolder:n.parentKey);var i,s=n.parentKey,o=e.ShouldLoadSPFramework,u=void 0!==o&&o,a=this._onePageContext&&this._onePageContext.handleOnePageNavigationFallback,f=!1;if(u){if(e.SPFrameworkClientInfo){this._clientSideExtensionHelper||(this._clientSideExtensionHelper=this.resources.consume(ae.clientSideExtensionHelper));i=this._clientSideExtensionHelper.loadSPFrameworkForOnePageNavigation(e.SPFrameworkClientInfo)}else f=!0;if(f&&a){a("SPFramework");throw{code:"-4, onePageNavigationError"}}}var l=function(e){r._engagement.logData({name:"List."+e});e="EUPL."+e+".LoadModule.";ne.default.mark(e+"Start")},c=function(){var i=r._loadClientSideCustomizer(e,n.parentKey),o=r._getCustomFormatterModule(e);if(o||i){if(o&&i){l("MultipleCustomizers");return x.default.all([i,o]).then(function(e){var i=e[0],o=e[1],u=i;window.CustomFormatter=o.CustomFormatter;return r._onCustomLoadersEnd(n,u,t,s,void 0)},function(i){return r._onCustomLoadersEnd(n,e,t,s,void 0)})}if(o){l("CustomFormatter");return o.then(function(i){window.CustomFormatter=i.CustomFormatter;return r._onCustomLoadersEnd(n,e,t,s,void 0)},function(i){return r._onCustomLoadersEnd(n,e,t,s,void 0)})}l("ClientSideCustomizer");return i.then(function(e){return r._onCustomLoadersEnd(n,e,t,s,void 0)},function(i){return r._onCustomLoadersEnd(n,e,t,s,void 0)})}return r._processData(n,t,e)};return i?i.then(function(){return c()}).catch(function(e){a("SPFramework");throw{code:"-4, onePageNavigationError"}}):c()};S.prototype._onCustomLoadersEnd=function(e,t,n,r,i){ne.default.mark(i+"End");return this._processData(e,n,t)};S.prototype._getCustomFormatterModule=function(t){if(t&&t.ListSchema&&t.ListSchema.Field){for(var n=t.ListSchema.Field,r=!1,i=0;i<n.length;i++){var s=n[i];if(s.CustomFormatter){r=!0;this._engagement.logData({name:"CustomFormatterField."+s.FieldType,extraData:{templateId:this._getTemplateIdFromFormatter(s.CustomFormatter)}})}}if(t.ListSchema.CustomFormatter){r=!0;this._engagement.logData({name:"CustomFormatterViewLoad",extraData:{templateId:this._getTemplateIdFromFormatter(t.ListSchema.CustomFormatter)}})}if(r){this._engagement.logData({name:"CustomFormatterLoad"});return x.default.resolve(new Promise(function(t,n){e(["DWt"],t,n)})).then(we.getDefaultExport)}}return null};S.prototype._getTemplateIdFromFormatter=function(e){try{var t=JSON.parse(e);if(t.templateId)return t.templateId}catch(e){}};S.prototype._loadClientSideCustomizer=function(e,t){var n,r=this,i=this._engagement;if(e.ListSchema)n=e.ListSchema.Field;else{var s=this._listContext.listSchema;n=s&&s.map(function(e){return{RealFieldName:e.realFieldName||e.internalName,ID:e.id,Type:e.serverFieldType,DisplayName:e.name,Name:e.name,ClientSideComponentId:e.clientSideComponentId,ClientSideComponentProperties:e.clientSideComponentProperties}})}if(n&&!(n.length<1)){if(this._prepareClientSideCustomizedFields(e,n)){var o=new A.Qos({name:"LoadFieldCustomizers"});ne.default.mark("EUPL.LoadFieldCustomizers.Start");this._clientSideExtensionHelper||(this._clientSideExtensionHelper=this.resources.consume(ae.clientSideExtensionHelper));if(!this._clientSideExtensionHelper){console.log("Error on consuming ClientSideExtensionHelper");o.end({resultType:A.ResultTypeEnum.Failure,resultCode:"ConsumeClientSideExtensionHelperFailed"});ne.default.mark("EUPL.LoadFieldCustomizers.NoClientSideExtensionHelper.End");return x.default.wrap(e)}if(!window.moduleLoaderPromise){i.logData({name:"LoadSpfx.moduleLoaderPromiseNotFound",extraData:{SpModuleLoaderExists:!!window.spModuleLoader}});console.log("sp-client module loader promise does not exist")}return this._clientSideExtensionHelper.getListViewAdapter().then(function(t){try{if(!t){console.log("sp-client listViewHostApp failed to create listViewAdapter");o.end({resultType:A.ResultTypeEnum.Failure,resultCode:"FailToCreateListViewAdapter"});ne.default.mark("EUPL.LoadFieldCustomizers.Error.FailListViewAdapter.End");return e}ne.default.mark("EUPL.LoadFieldCustomizers.GotListViewAdapter");n.forEach(function(e,n,r){try{var i={id:e.ID,internalName:e.RealFieldName||e.Name,fieldType:e.FieldType,isRequired:!!e.Required&&"TRUE"===e.Required.toUpperCase(),isVisible:!0,displayName:e.DisplayName,clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties,onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(t){console.log("Fail to load customizer for column: "+e.Name+", componentId: "+e.ClientSideComponentId+", error: "+t.message)}},s=t.addColumnAdapter(i);if(!s)throw"addColumnAdapter returns null";if(i.clientSideComponentId&&i.clientSideComponentId!==C.default.Empty){e.ClientSideColumnAdapter=s;console.log("Add Spfx column adapter for "+e.RealFieldName)}}catch(t){console.log("Error on addColumnAdapter for column: "+e.Name+", error: "+t)}});return t.loadFieldCustomizers().then(function(t){console.log("fieldCustomizers loaded");o.end({resultType:A.ResultTypeEnum.Success});ne.default.mark("EUPL.LoadFieldCustomizers.End");r._logLoadFieldCustomizersResult(e);return e},function(t){console.log("fieldCustomizers failed to load, error: "+t);o.end({resultType:A.ResultTypeEnum.Failure,resultCode:"ListViewHostAppFailedToLoadCustomizersPromiseError",error:t});ne.default.mark("EUPL.LoadFieldCustomizers.PromiseError.End");return e})}catch(t){o.end({resultType:A.ResultTypeEnum.Failure,resultCode:"ListViewHostAppFailedToLoadCustomizersCatch",error:t});ne.default.mark("EUPL.LoadFieldCustomizers.Error.End");return e}})}return null}i.logData({name:"LoadSpfx.ListFieldsNotAvailable"})};S.prototype._logLoadFieldCustomizersResult=function(e){(e.ListSchema?e.ListSchema.Field:[]).forEach(function(e,t,n){if(e.ClientSideComponentId&&e.ClientSideColumnAdapter){var r="EUPL.LoadFieldCustomizers."+e.ClientSideComponentId+".";r+=e.ClientSideColumnAdapter.fieldCustomizerLoaded?"Loaded":"Failed";ne.default.mark(r)}})};S.prototype._prepareClientSideCustomizedFields=function(e,t){var n,r={},i=new fe.default(document.location.href),s=i.getQueryParameter("fieldCustomizers");try{if(n=JSON.parse(s))for(var o in n){var u=n[o],a="",f="";if("string"==typeof u)a=u;else if("object"==typeof u){u.id&&(a=u.id);if(u.properties){var l="";"object"==typeof u.properties&&(l=JSON.stringify(u.properties));f=l}}r[o]={internalName:o,clientSideComponentId:a,clientSideComponentProperties:f}}}catch(e){console.log("Error when parse query parameter: fieldCustomizers, error: "+e)}for(var c=!1,h=!1,p=0,d=t;p<d.length;p++){var v=d[p],m=v.RealFieldName,g=void 0;r.hasOwnProperty(m)&&(g=r[m]);if(g&&!v.CustomFormatter){v.ClientSideComponentId=g.clientSideComponentId;v.ClientSideComponentProperties=g.clientSideComponentProperties;c=!0}v.ClientSideComponentId&&v.ClientSideComponentId!==C.default.Empty&&!v.CustomFormatter&&(h=!0)}if(!h&&c){i.getQueryParameter("loadSPFX")||console.log("WARNING! SPFX is required to be loaded. Add 'loadSPFX=true' query parameter")}return c||h};S.dependencies=n.__assign(n.__assign({},i.default.dependencies),{itemsStore:m.resourceKey,pageContext:w.pageContext,listContext:w.listContext,apiUrlHelper:de.resourceKey,itemUrlHelper:ve.resourceKey,itemParentHelper:me.resourceKey,urlDataSource:b.url,microServiceDataSource:h.resourceKey,microServiceDataSourceStore:p.resourceKey,listDataSource:le.resourceKey,listItemBuilder:H.resourceKey,listItemResultProcessor:B.resourceKey,subsiteItemResultProcessor:j.resourceKey,rumOneHelper:E.rumOneHelper,identity:b.identity.optional,spotlightDataSource:b.spotlight.optional,onePageContext:w.onePageContext.optional,contentTypes:w.contentTypes.optional});return S})(i.default);t.default=Ne;function Ce(e){return!!e.ListData}t.resourceKey=S.createResolvedResourceKey(e("module").id,Ne)});
define("dTe",["require","exports","v","lTe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.listItemsDataSourceAsyncKey=t.listShouldRenderFilesTitleKey=t.useFolderScopedSearchKey=void 0;Object.defineProperty(t,"useFolderScopedSearchKey",{enumerable:!0,get:function(){return r.useFolderScopedSearchKey}});Object.defineProperty(t,"listShouldRenderFilesTitleKey",{enumerable:!0,get:function(){return r.listShouldRenderFilesTitleKey}});t.listItemsDataSourceAsyncKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Kit"],t,n)}).then(function(e){return e.resourceKey})})})});
define("qit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["h5e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("lTe",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.listShouldRenderFilesTitleKey=t.useFolderScopedSearchKey=void 0;t.useFolderScopedSearchKey=new n.ResourceKey({name:e("module").id+".useFolderScopedSearch",factory:new n.ConstantResourceFactory(!0)});t.listShouldRenderFilesTitleKey=new n.ResourceKey({name:e("module").id+".listShouldRenderFilesTitle",factory:new n.ConstantResourceFactory(void 0)})});
define("aTe",["require","exports","ww","LZ","pO","fB","I5e","A","eS","k","b5e"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=f.Killswitch.isActivated("2B543B44-7037-4528-BE89-FFD3EFB509F1","10/21/2020","enable by pass shared lock"),h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._getRemoteItemDestUrl=function(e){var t=e.remoteItem.SiteUrl,n=new URL(t).origin,r=e.remoteItem.ParentFolderUrl;return encodeURI(n+r)};n._urlDataSource=n.resources.consume(i.url);n._crossGeoMoveCopyHelper=n.resources.consume(l.resourceKey);return n}t.prototype.getCapabilities=function(){this._capabilities={supportsMoveCopy:!0,supportsMoveCopyOnShared:!1,supportsMoveCopyFilterParams:!0,supportsCopyCrossSite:s.isFeatureEnabled(s.CopyCrossSiteFromTeamSite),supportsMoveCrossSite:s.isFeatureEnabled(s.MoveCrossSite),supportsThrottling:!0,supportsProgressCaching:!0};return this._capabilities};t.prototype.copyItemsAsync=function(e){var t=this,n=e.isMove?"Move":"Copy",r=e.keepSharing?"_KeepSharing":"",i=this._pageContext.webAbsoluteUrl,o=u.default.resolve(e.authToken);if(s.isOneDrive&&s.isFeatureEnabled(s.UseItemsScopeInSitesForODB)&&!f.Killswitch.isActivated("600bd785-1e33-44f9-9e01-2cac9d0e592b","08/05/2020","Get the site web absolute url for cross-geo sites ")&&(!e.authToken||!s.isFeatureEnabled(s.SupportMountPointInMoveCopyPanel))){o=this._crossGeoMoveCopyHelper.getAuthToken(e);i=this._crossGeoMoveCopyHelper.getWebAbsouluteUrl(e,i)}e.remoteWebUrl&&s.isFeatureEnabled(s.SupportMountPointInMoveCopyPanel)&&(i=e.remoteWebUrl);return o.then(function(s){return t.dataRequestor.getData({url:i+"/_api/site/CreateCopyJobs",parseResponse:t._parseCopyResponse,qosName:n+"CrossSiteAsync"+r,additionalPostData:t._getCopyItemsAsyncPostData(e),method:"POST",noRedirect:!0,authToken:s,telemetryHandler:function(e){return t.handleTelemetry(e)}})}).then(function(e){return e},function(e){var t=e.code?e.code.split(","):e.error.code.split(","),n={code:Number(t[0]),message:e.message&&e.message.value};return u.default.wrapError(n)})};t.prototype.hasMatchingId=function(e,t){return t&&t.properties.ID&&t.properties.ID===e};t.prototype.handleTelemetry=function(e){return{eventData:e.eventData}};t.prototype._parseCopyResponse=function(e){var t;try{t=JSON.parse(e)}catch(e){a.Verbose.logData({name:"MoveCopyDataSource._parseCopyResponse.InvalidJson",message:e})}var n=t&&t.d&&t.d.CreateCopyJobs&&t.d.CreateCopyJobs.results,r=n&&n[0]&&n[0].JobId;return{id:r,jobInfo:{spData:n},progress:[{id:r,status:o.ITaskStatuses[o.ITaskStatuses.NotStarted]}]}};t.prototype._getCopyItemsAsyncPostData=function(e){for(var t={exportObjectUris:[]},n=0,r=e.items;n<r.length;n++){var i=r[n];t.exportObjectUris.push(this._urlDataSource.getItemUrl(i.key))}(e.remoteItem||e.isMountPointFolder)&&s.isFeatureEnabled(s.SupportMountPointInMoveCopyPanel)?t.destinationUri=this._getRemoteItemDestUrl(e):t.destinationUri=this._urlDataSource.getItemUrl(e.targetKey);t.options={IgnoreVersionHistory:!0};if(e.isMove){t.options.IsMoveMode=!0;t.options.IncludeItemPermissions=e.keepSharing}e.allowSchemaMismatch&&(t.options.AllowSchemaMismatch=!0);1===e.nameConflict?t.options.NameConflictBehavior=1:2===e.nameConflict&&(t.options.NameConflictBehavior=2);e.allowSmallerVersionLimit&&(t.options.AllowSmallerVersionLimitOnDestination=!0);c||(t.options.BypassSharedLock=!0);return JSON.stringify(t)};return t})(r.default);t.default=h});
define("Wit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id+".mruRecentListDataSource",loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["M8e"],t,n)}).then(function(e){return e.resourceKey})})});t.default=t.resourceKey});
define("ert",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["qzt"],t,n)}).then(function(e){return e.resourceKey})})})});
define("$it",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["KFt"],t,n)}).then(function(e){return e.resourceKey})})})});
define("rKe",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["j8e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Wx",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["n5e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Nne",["require","exports","ww","tB","FS","M","A","Kk","Be","ze","Te","jne","vH","zq","Gq","wx","Aq","D7","Y2","g","v","Bne","Rq"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var x=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._shortcutResolverQueue=new u.default;r._pageContext=n.pageContext;r._apiUrlHelper=n.apiUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._dataRequestor=new(r.scope.attached(n.dataRequestorType))({qosName:"ShortcutLinkDataSource"});return r}t.isSharePointUrl=function(e){var t=new a.default(e).getHost().toLowerCase();return t.indexOf("spoppe.com")>=0||(t.indexOf("sharepoint.com")>=0||t.indexOf("sharepoint.cn")>=0)};t.prototype.isInternal=function(e,t){if(t&&t!==s.default.Empty&&/@"^[{|\(]?[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}[\)|}]?$/i.test(t))return!0;if(!this._itemUrlHelper.getUrlParts({path:e}).isCrossDomain)return!0;var n=new a.default(e).getHost().toLowerCase(),r=new a.default(this._pageContext.webAbsoluteUrl).getHost().toLowerCase();if(n===r)return!0;var i=void 0,o=/(?:(.+?)(-my)??(\.[^\/]*))|(?:([^\.]*)$)/i.exec(r);if(!o)return!1;if(void 0!==o[2])i=o[1]+o[3];else if(void 0!==o[3])i=o[1]+"-my"+o[3];else if(void 0!==o[4])return!1;return n===i};t.prototype.createShortcut=function(e,t,n){var r=this._itemUrlHelper.getItemUrlParts(e),i=this._apiUrlHelper.build().webByItemUrl(r).methodWithAliases("GetFolderByServerRelativePath",{decodedUrl:r.serverRelativeItemUrl}).segment("Files").methodWithAliases("AddUsingPath",{decodedUrl:t,overwrite:!1});return this._dataRequestor.getData({url:i.toString(),parseResponse:function(e){return e},qosName:"CreateShortcut",method:"POST",additionalPostData:this._getCreateShortcutPostBody(n)}).then(void 0,function(e){var t=e.code;return/^\-2130575257,/.test(t)?o.default.wrapError(h.default.ShortcutErrors.NewFileCreationFileAlreadyExistsError):/^\-2130575245,/.test(t)?o.default.wrapError(h.default.ShortcutErrors.InvalidCharacterError):o.default.wrapError(h.default.ShortcutErrors.UnknownError)})};t.prototype.getShortcutTargetData=function(e,n){var r=this,i=this._itemUrlHelper.getUrlParts({path:e}),u=this._apiUrlHelper.build().method("SP.Utilities.ShortcutLink.GetShortcutLink",i.fullItemUrl);return this._dataRequestor.getData({url:u.toString(),qosName:"GetShortcutTargetData",method:"GET",noRedirect:!0}).then(function(e){return{url:e.d.url,siteId:e.d.siteId!==s.default.Empty?e.d.siteId:null,webId:e.d.webId!==s.default.Empty?e.d.webId:null,uniqueId:e.d.uniqueId!==s.default.Empty?e.d.uniqueId:null,isInternal:r.isInternal(e.d.url,e.d.uniqueId),webUrl:void 0}},function(e){return null}).then(function(e){return e.uniqueId||n?o.default.wrap(e):t.isSharePointUrl(e.url)?r.getFileByUrl(e.url).then(function(t){var n=!!t&&t.UniqueId&&s.default.normalizeLower(t.UniqueId);n&&(e.uniqueId=n);return e}):o.default.wrap(e)})};t.prototype.generateShortcutsOpenUrl=function(e,t,n,r,i,s){if(r&&i&&s&&-1===n.toLowerCase().indexOf("guestaccess.aspx")){var o="",u="?";if(n){var a=n.indexOf("?");-1!==a&&(u=n.substring(a)+"&")}o=e+"/"+t+"/ShortcutLink.aspx";o+=u+"siteid="+f.default.encodeURIComponent(r);o+="&webid="+f.default.encodeURIComponent(i);return o+="&uniqueid="+f.default.encodeURIComponent(s)}return n};t.prototype.enqueueParseShortcut=function(e,t){var n=this,r=this._itemUrlHelper.getItemUrlParts(e);this.trackPromise(this._shortcutResolverQueue.enqueue(function(){var i=new(n.managed(p.default));return n.getShortcutTargetData(r.fullItemUrl,!0).then(function(r){var s,o=n.generateShortcutsOpenUrl(n._pageContext.webAbsoluteUrl,n._pageContext.layoutsUrl,r.url,r.siteId,r.webId,r.uniqueId),u={key:e,shortcutInfo:{shortcutLinkRewritten:!0},urls:(s={},s[v.default.shortcutTarget]=o,s)};r.uniqueId&&(u.thumbnail=c.previewImageUrl(r,n._pageContext.webAbsoluteUrl,n._pageContext));i.update([new d.default(e).succeed({item:u})]);i.flush();n.resources.consume(S.isItemsScopeEnabledResourceKey)&&t&&n.resources.consumeAsync(E.resourceKey).then(function(n){n.updateItemShortcutValues(e,t,r)})}).then(function(){i.dispose()},function(e){i.dispose();return o.default.wrapError(e)})}))};t.prototype.getFileByUrl=function(e){var t,n=this,r=this._itemUrlHelper.getUrlParts({path:e});if(r.isCrossDomain||r.siteRelation===g.SiteRelation.sameSite)t=o.default.wrap(e);else{var i=this._apiUrlHelper.contextInfoUrl(r.fullItemUrl);t=this._dataRequestor.getData({url:i,method:"POST",qosName:"GetContextInfo"}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl})}return t.then(function(t){var r=n._apiUrlHelper.build().webByUrl({path:t,webUrl:t}).method("GetFileByUrl",e);return n._dataRequestor.getData({url:r.toString(),qosName:"GetFileByUrl",method:"GET",noRedirect:!0}).then(function(t){return n._parseGetFileResponse(t,e)})})};t.prototype._getCreateShortcutPostBody=function(e){return"[InternetShortcut]\nURL="+e+"\n"};t.prototype._parseGetFileResponse=function(e,t){return{CheckInComment:e.d.CheckInComment,CheckOutType:parseInt(e.d.CheckOutType,10),ContentTag:e.d.ContentTag,CustomizedPageStatus:e.d.CustomizedPageStatus,ETag:e.d.ETag,Exists:!!e.d.Exists,IrmEnabled:!!e.d.IrmEnabled,Length:parseInt(e.d.Length,10),Level:parseInt(e.d.Level,10),LinkingUrl:e.d.LinkingUrl,MajorVersion:parseInt(e.d.MajorVersion,10),MinorVersion:parseInt(e.d.MinorVersion,10),Name:e.d.Name,ServerRelativeUrl:e.d.ServerRelativeUrl,ServerUrl:new l.default(t).authority,TimeCreated:i.iso8601DateTimeToJsDate(e.d.TimeCreated),TimeLastModified:i.iso8601DateTimeToJsDate(e.d.TimeLastModified),Title:e.d.Title,UIVersion:parseInt(e.d.UIVersion,10),UIVersionLabel:e.d.UIVersionLabel,UniqueId:e.d.UniqueId}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pageContext:b.pageContext,apiUrlHelper:m.resourceKey,itemUrlHelper:g.resourceKey,dataRequestorType:y.typeResourceKey});return t})(r.default);t.default=x;t.resourceKey=w.createResolvedResourceKey(e("module").id,x)});
define("iTe",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Nne"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Zit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["JCe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("n$e",["require","exports","ww","tB","wx","jne","xv","Be","s$e","jP","Yy","B$","o$e","r$e","Ex","FS","iTe","vH","Qq","fB","Sne","J8e","ze","M","zi","pO","Y8e","g","i$e","tg","Gq","bH","D7","qq","$q","je","B8e","v","Je","fe","fSe","uSe","wCe","a$e","ty","lSe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var V=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;r._listContext=n.listContext;r._navigation=n.navigation;r._microServiceDataSource=n.microServiceDataSource;r._vroomUrlHelper=n.vroomUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._vroomDataContext=n.vroomDataContext;r._shortcutLinkDataSource=n.shortcutLinkDataSource;r._isActivityFeatureEnabled=n.isActivityFeatureEnabled;r._allowWrsExcel=!F.default.isActivated("4F4F63D5-6B0D-4B6E-B98F-93975947DEED","6/13/2019","Use OneUpWrs instead of OneUpWAC for Excel");r._allowWrsVisio=!1;r._htmlDecodeDiv=document.createElement("textarea");return r}t.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){I.default.log(e,"ListItemBuilder.getItemResult");throw e}};t.prototype._getItemResult=function(e){var t,r,a,m,N=e.itemFromServer;if(!N)return null;var k,L=e.microServiceDataSource||this._microServiceDataSource,A=this._urlDataSource,_=e.requestKey,D=e.parentItemKey,P=e.queryType,j=void 0===P?A.getQueryType():P,I=e.groupBy,q=e.itemGroups,U=e.contentTypes,X=e.supportsNestedGroups,V=e.isItemDataOnly,J=e.listTemplateType,K=void 0===J?this._listContext.listTemplateType:J,Q=e.observer,G=A.getKeyParams(_),Y=this._itemUrlHelper.getUrlParts({path:N.id||N.FileRef||N.ServerRelativeUrl,listUrl:G.listurl});k=((t={}).id=Y.serverRelativeItemUrl,t.listurl=Y.normalizedListUrl,t);var Z=N.File_x0020_Type,ee=Z?"."+Z:"",te=this._parseMediaServiceMetadata(N.MediaServiceFastMetadata),ne=this._parseMediaServiceMetadata(N.MediaServiceMetadata),re=this._getItemType({itemFromServer:N,listTemplateType:K,microServiceDataSource:L,mediaServiceFastMetadata:te});if(re===d.default.Folder){var ie=G.id===k.id,se=A.getItemTypeFilter(G),oe={};if(ie)oe=((r={}).view=G.view,r.q=G.q,r.typeFilters=G.typeFilters,r);else{j!==o.default.Search&&(oe=((a={}).view=j,a));se&&H.extend(oe,A.saveItemTypeFilter(se))}H.extend(k,oe)}var ue=A.getKey(k),ae={key:ue,extension:ee},fe=N.id||N.FileRef;ae.id=fe;var le,ce,he=y.default.fromHexString(N.PermMask),pe=W.PermissionMask.hasPermission(he,W.PermissionMask.openItems),de=this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||!pe,ve=N[".spItemUrl"];if(ve){var me=this._vroomUrlHelper.getUrlParts(ve);le=me.itemId;ce=me.driveId}else le=N["name.FileSystemItemId"]||(N.isRootFolder?"root":void 0);this._vroomDataContext&&le&&this._vroomDataContext.setFileSystemIdMapping(le,fe);var ge=N[".etag"];ge&&(ae.eTag=ge);ae.itemId=M.optional(le);var ye=K===T.ListTemplateType.mySiteDocumentLibrary;ae.graph=M.optional(le&&{itemId:le,driveId:ce,driveType:K?ye?"business":"documentLibrary":void 0});var be=Number(N._ip_UnifiedCompliancePolicyUIAction)||0;"1"===this._navigation.viewParams.showpolicytips&&(be=Number(N.ID)%6);ae.policyTip=M.optional(be);var we=C.isDicomFile(ee);(we||".ai"===ee||".eps"===ee||".psd"===ee)&&L.getThumbnail({fileExtension:ee,item:N,itemKey:ue,mediaServiceMetadata:te})&&(re=d.default.Media);if(R.canRenderNative(ee))ae.htmlConversion={};else if(R.canConvert(ee)){if(Ee=L.getHtmlConversionUrl({fileExtension:ee,item:N,mediaServiceMetadata:te})){re=d.default.Media;ae.htmlConversion={url:Ee+"&inlineImages=true"}}}if(b.isFeatureEnabled(b.EnableZipFilePreviewing)&&(".zip"===ee||".rar"===ee)){var Ee=L.getZipMetaDataUrl({fileExtension:ee,item:N,mediaServiceMetadata:te}),Se=L.getDownloadZipContentsUrl(N);if(Ee&&Se){re=d.default.Media;ae.zip={zipMetaDataUrl:Ee,downloadZipContentsUrl:Se}}}var xe,Te,Ne,Ce,ke,Le,Ae={},Oe=L.getDownloadAsZipUrl(N);Oe&&(Ae[i.default.downloadAsZip]=Oe);ve&&(Ae[i.default.itemUrl]=ve);var Me=this._listContext,_e=Number(N.File_x0020_Size)||Number(N.FileSizeDisplay)||void 0,De=te&&te.video,Pe=".ts"===ee&&_e<1<<19&&!De;Pe&&(re=d.default.File);var He=te&&te.media,Be=F.default.isActivated("AE18621B-70BE-46AB-B681-F87FE63EBAA4","12/10/2019","Obtain item openUrl from full item path")?this._itemUrlHelper.getUrlParts({path:N.FileRef,listUrl:Y.normalizedListUrl}).normalizedItemUrl:Y.fullItemUrl,je=Be?l.canonicalizeDecodedUrl(Be):void 0;if(re===d.default.Folder)xe=N.ProgId&&"sharepoint.documentset"===N.ProgId.toLowerCase();else if(re!==d.default.Media&&!te||T.isPromotedLinksList(K))re===d.default.File&&Me&&void 0!==Me.isDocLib&&!Me.isDocLib&&(Te={});else{var Fe=f.getIconNameFromExtension(ee),Ie=te&&te.photo||(we||"photo"===Fe?{}:void 0),qe=De||("video"===Fe?{}:void 0),Re=te&&te.audio||("audio"===Fe?{}:void 0);if(Ie){Ne={originalUrl:M.optional("photo"===Fe?je:void 0),width:Ie.width||0,height:Ie.height||0};b.isFeatureEnabled(b.Image360Viewer)&&le&&(Ce=this._getImage360(N,te,Ie,ne))}qe&&(ke={fourCC:M.optional(qe.fourCC||(".mp4"===ee.toLowerCase()?"H264":void 0)),bitrate:M.optional(qe.encodingBitrate),width:qe.frameWidth||0,height:qe.frameHeight||0,duration:$(He&&He.duration),audioFormat:M.optional(Re&&Re.format),manifestMetadata:qe.manifestMetadata,altManifestMetadata:qe.altManifestMetadata});Re&&(Le={duration:$(He&&He.duration)})}var Ue=He&&He.title;ae.caption=M.optional(Ue);ae.photo=M.optional(Ne);ae.image360=M.optional(Ce);ae.video=M.optional(ke);ae.audio=M.optional(Le);ae.listItem=M.optional(Te);D&&(ae.parentKey=D);ae.isDocSet=M.optional(xe);Y.serverRelativeItemUrl===Y.serverRelativeListUrl&&(ae.isRootFolder=!0);var ze,We=B.ListItemBuilderHelpers.getItemName(N,re,Me);ae.name=M.optional(We);ae.displayName=M.optional(We);var Xe,Ve=!0;if(N.Modified&&"21"===this._pageContext.webTemplate&&b.isFeatureEnabled(b.RequestDatesInUtc))try{var $e=new Date(N.Modified);ae.dateModifiedTime=$e;ae.dateModifiedValue=$e.getTime();ze=v.getShortDisplayDate($e);Ve=!1}catch(e){}if(Ve){ae.dateModifiedValue=M.optional(N.Modified);ze=N["Modified.FriendlyDisplay"]?v.getRelativeDateTimeStringForLists(N["Modified.FriendlyDisplay"]):N.Modified?""+N.Modified:""}ae.dateModified=M.optional(ze||void 0);ae.permissions=M.optional(he);if(q&&I&&I.length>0)if(X){q[0]||(q[0]=[]);var Je=q[0]&&q[0].length>0?q[0][q[0].length-1]:null,Ke=I[0],Qe=I[1];if(Ke&&"1"===N[Ke+".newgroup"]){var Ge=Je?Je.startIndex+Je.count:0,Ye=B.GroupBuilder.buildGroup(Me,N,Ke,0,!1,Ge),Ze=this._convertToODNGroup(Ye);q[0].push(Ze);Je=Ze}if(Qe&&"1"===N[Qe+".newgroup"]){var et=Je&&Je.children&&Je.children.length>0?Je.children[Je.children.length-1]:null;Ge=et?et.startIndex+et.count:Je?Je.startIndex:0;B.GroupBuilder.buildGroup(Me,N,Qe,1,!1,Ge,Je);var tt=Je.children.pop();Je.children.push(this._convertToODNGroup(tt))}}else for(var nt=0;nt<I.length;nt++){var rt=I[nt];if(rt){var it=q[nt]&&q[nt].length>0?q[nt][q[nt].length-1]:null;if("1"===N[rt+".newgroup"]){Ge=it?it.startIndex+it.count:0,Ze=B.GroupBuilder.buildGroup(Me,N,rt,nt,!1,Ge);q[nt]||(q[nt]=[]);q[nt].push(this._convertToODNGroup(Ze))}}}if(U&&U.length>0&&N.ContentTypeId)for(var st=0,ot=U;st<ot.length;st++){var ut=ot[st];if(N.ContentTypeId===ut.contentTypeId){Xe=!1;if(ut.requiredFields)for(var at=0,ft=ut.requiredFields.split(",");at<ft.length;at++){var lt=N[ft[at]];if(!lt||Array.isArray(lt)&&0===lt.length){Xe=!0;break}}}}ae.hasMissingMetadata=M.optional(Xe);ae.contentTypeId=M.optional(N.ContentTypeId);var ct,ht,pt,dt,vt,mt=N.folder,gt=[];if(mt){ae.folder={};ae.isDropEnabled=!0;ct=[];if(mt.children){for(var yt=0,bt=mt.children,wt=bt.length,Et=0,St=0;St<wt;St++){var xt=this.getItemResult({requestKey:_,queryType:j,itemFromServer:bt[St],groupBy:I,itemGroups:gt,contentTypes:U,listTemplateType:K,supportsNestedGroups:X,isItemDataOnly:V,observer:Q});if(xt){ct[St]=xt.item;Et<10&&xt.itemType===d.default.Media&&yt++;Et++}}wt>0&&(yt>=10||yt>=wt)&&(ae.displayType=o.default.Photos)}}else{pt=(pt=N["serverurl.progid"])?pt.substring(1):je;Ae[i.default.original]=pt;if(b.isFeatureEnabled(b.ShortcutLink)&&g.default.isShortcutItem({key:ue,extension:ee})){re=d.default.Shortcut;if(N._ShortcutUrl){ae.shortcutInfo={shortcutLinkRewritten:!0};Ae[i.default.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,N._ShortcutUrl,N._ShortcutSiteId,N._ShortcutWebId,N._ShortcutUniqueId);N._ShortcutUniqueId&&(ht=s.previewImageUrl({url:N._ShortcutUrl,siteId:N._ShortcutSiteId,webId:N._ShortcutWebId,uniqueId:N._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))}else{ae.shortcutInfo=M.backup({shortcutLinkRewritten:!1});this._shortcutLinkDataSource.enqueueParseShortcut(ue,e.itemFromServer.ID);Ae[i.default.shortcutTarget]=u.default.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+S.default.encodeURIComponent(N.FileRef)}}Ae[i.default.open]=pt;dt=N["File_x0020_Type.mapapp"]||N["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];if(Y.isCrossDomain&&Y.isCrossList){var Tt=N[".fileType"],Nt=w.getOfficeFileType(Tt||"");dt=void 0===Nt?Tt?void 0:dt:Nt;"OneNote.Notebook"===N.HTML_x0020_File_x0020_Type&&(dt="onenote|UsePlain");"pdf"===N.File_x0020_Type&&(dt=void 0)}ae.size=M.optional(_e);ae.totalSize=M.optional(Number(N.SMTotalSize)||void 0);ht||(ht=this._getThumbnail({itemFromServer:N,listTemplateType:K,extension:ee,key:ue,type:re,mediaServiceFastMetadata:te,microServiceDataSource:L}));ae.openUrl=pt;var Ct=N["IconOverlay.mapoly"];Ct&&(ae.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+Ct);ae.thumbnail=ht;var kt=this._getPdfConversionFacet({extension:ee,blockDownload:de,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te});kt&&(ae.pdfConversion=kt);var Lt=this._get3dFacet({extension:ee,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te});Lt&&(ae.model3d=Lt);if(re===d.default.Folder){var At=Number(N.ItemChildCount)+Number(N.FolderChildCount);ae.childCount=At;var Ot=Number(N.SMTotalFileCount);ae.folder={totalCount:Ot>0?Ot:At,childCount:At};ae.isDropEnabled=!0}var Mt=N.ServerRedirectedEmbedUrl;Mt&&(this._itemUrlHelper.getUrlParts({path:Mt}).isCrossDomain||(vt=Mt))}ae.previewIFrameUrl=vt;ae.type=re;ae.appMap=M.optional(dt);this._pageContext.blockDownloadsExperienceEnabled&&(ae.type===d.default.Media||pt&&dt)?ae.itemStatus=4:this._pageContext.blockDownloadsExperienceEnabled&&re!==d.default.Folder?ae.itemStatus=3:this._pageContext.viewOnlyExperienceEnabled&&(ae.itemStatus=4);var _t={};for(var Dt in N)N.hasOwnProperty(Dt)&&(_t[Dt]=N[Dt]);var Pt=x.default.normalizeLower(N.UniqueId)||void 0;Pt&&(_t.uniqueId=Pt);var Ht=N.RemoteItem;ae.remoteItem=Ht&&JSON.parse(Ht);ae.reputationProperties=this.getReputationProperties(N);var Bt,jt=We;ee&&(jt=We.substring(0,We.toLowerCase().lastIndexOf(ee.toLowerCase())));ae.sharingRole=0;Bt=Number(N.PrincipalCount)>0?c.default.Shared:void 0===N.PrincipalCount?b.isOneDrive?void 0:c.default.Unknown:c.default.Private;ae.sharingType=M.optional(Bt);_t.FileName=jt;var Ft=f.getIconNameFromItem({extension:ee,isDocSet:xe,listItem:Te,sharingType:Bt,type:re,textEditorMimeType:Pe?"text/typescript":void 0,panorama:Ce});ae.iconName=Ft;var It="ms-excel"===dt,qt="ms-powerpoint"===dt,Rt="ms-visio"===dt,Ut="ms-word"===dt;if(pt&&(Ut||It||qt||Rt)){var zt=this._getOfficeBundleFacet({isWord:Ut,extension:ee,itemUrlParts:Y,isPowerPoint:qt,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te});!zt||It&&!this._allowWrsExcel||Rt&&!this._allowWrsVisio||(ae.officeBundle=zt);zt&&(Ut||qt)&&(Ae[i.default.viewInBrowser]=L.getPdfConversionUrl({fileExtension:ee,item:N,mediaServiceMetadata:te},!0));ae.wopiFrameUrl=pt}ae.defaultSubText=E.getGridSubTitleTextFromModifiedBy(E.getModifiedByFromObject(N.Editor));ae.isPlaceholder=!N.PermMask;ae.queryType=j;ae.displayType=M.backup(ae.queryType);ae.isDraggable=ae.queryType===o.default.Files;N.folder||(_t.modifiedByUser=E.getModifiedByUserFromObject(N.Editor));_t.MediaServiceOCR=E.getOcrFromHtmlString(N.MediaServiceOCR);ae.properties=_t;ae.lifeCycleStatus=M.optional(this._getItemLifeCycleStatus(N));ae.comments={settings:z.getCommentFlags(N._CommentFlags)};ae.urls=n.__assign(n.__assign(n.__assign({},Ae),this._getVideoUrl({extension:ee,itemFromServer:N,microServiceDataSource:L,mediaServiceFastMetadata:te})),((m={})[i.default.mediaBaseUrl]=L.getMediaBaseUrl({fileExtension:ee,item:N,mediaServiceMetadata:te}),m));Q.update([new O.default(ue).succeed({item:ae})]);b.isFeatureEnabled(b.ItemAnalytics)&&b.isFeatureEnabled(b.EnableTrendingSignalInListView)&&ue&&this.resources.consumeAsync(h.resourceKey).then(function(e){e.queueNewItem(ue)});var Wt=this._isActivityFeatureEnabled;F.default.isActivated("5FB0B159-1F05-4A77-99C9-AF50F3EC8435","4/2/2020","Use ItemsScope activity column")&&Wt&&!V&&Pt&&le&&!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isEmailAuthenticationGuestUser&&!this._pageContext.isExternalGuestUser&&this.resources.consumeAsync(p.resourceKey).then(function(e){e.enqueue(ue)});var Xt=this._getGroupings({itemFromServer:N,supportsNestedGroups:X,groupBy:I,groups:gt}),Vt=Xt.groupings,$t=Xt.totalChildren;return{item:{key:ue},itemType:re,children:ct,groupings:Vt,totalChildren:$t,nextRequestToken:N.nextRequestToken}};t.prototype._getItemLifeCycleStatus=function(e){var t={};1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0);var n=Number(e._VirusStatus)||0;b.isFeatureEnabled(b.EnableATPFilesListView)&&0!==n&&3!==n&&(t.isMalwareDetected=!0);return t};t.prototype._getGroupings=function(e){var t=this,n=e.itemFromServer,r=e.supportsNestedGroups,i=e.groupBy,s=e.groups,o=null,u=this._listContext.groupLevel,a=n.folder?n.folder.childCount:0;if(n.folder&&n.folder.children&&i&&"__ItemType"===i[0])o=this._getItemTypeGroupings({itemFromServer:n});else if(-1!==u)if(n.groups){var f=[],l=0;if(r){var c=B.GroupBuilder.buildCollapsedGroups(n.groups,this._listContext,i),h=c.groups,p=c.totalCount;f=h.map(function(e){return t._convertToODNGroup(e)});l=p}else for(var d=0,v=n.groups;d<v.length;d++){var m=v[d],g=i[u];if(m[g+".newgroup"]){var y=B.GroupBuilder.buildGroup(this._listContext,m,g,u,!0,l);f.push(this._convertToODNGroup(y));l+=y.count}}if(f&&f.length>0){o=[{name:void 0,itemGroups:f,isAllCollapsed:this.createObservable(!0)}];a=l}}else s&&s.length>0&&s[u]&&s[u].length>0&&(o=[{name:void 0,itemGroups:s[u],isAllCollapsed:this.createObservable(!1)}]);return{groupings:o,totalChildren:a}};t.prototype._getItemTypeGroupings=function(e){for(var t,n=e.itemFromServer,r=[],i=n.folder.children,s=n.nextRequestToken?2:0,o=i.length+s,u=0;u<o;u++){var a=i[u];if(a){if(!(this._getItemTypeOneNoteOrFolder(a)===d.default.Folder)){t=u;break}}}(void 0===t&&o>0||t>0)&&r.push({count:void 0!==t?t:o,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})});void 0!==t&&r.push({count:o-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})});return r.length?[{name:"FoldersDocumentsPhotos",itemGroups:r,isAllCollapsed:this.createObservable(!1)}]:void 0};t.prototype._getImage360=function(e,t,n,r){var i,s=t&&t.panorama,o=!1;if(s&&"equirectangular"===s.projectionType){i={projectionType:s.projectionType};o=!0}else e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:n.width>0&&n.height>0&&n.width/n.height==2&&(o=!0);if(o&&r){var u=r.panorama;if(u)i={projectionType:M.optional(s.projectionType||void 0),croppedAreaImageHeightPixels:M.optional(u.croppedAreaImageHeightPixels||void 0),croppedAreaImageWidthPixels:M.optional(u.croppedAreaImageWidthPixels||void 0),croppedAreaLeftPixels:M.optional(u.croppedAreaLeftPixels||void 0),croppedAreaTopPixels:M.optional(u.croppedAreaTopPixels||void 0),fullPanoHeightPixels:M.optional(u.fullPanoHeightPixels||void 0),fullPanoWidthPixels:M.optional(u.fullPanoWidthPixels||void 0),initialHorizontalFOVDegrees:M.optional(u.initialHorizontalFOVDegrees||void 0),initialVerticalFOVDegrees:M.optional(u.initialVerticalFOVDegrees||void 0),initialViewHeadingDegrees:M.optional(u.initialViewHeadingDegrees||void 0),initialViewPitchDegrees:M.optional(u.initialViewPitchDegrees||void 0),initialViewRollDegrees:M.optional(u.initialViewRollDegrees||void 0),poseHeadingDegrees:M.optional(u.poseHeadingDegrees||void 0),posePitchDegrees:M.optional(u.posePitchDegrees||void 0),poseRollDegrees:M.optional(u.poseRollDegrees||void 0)};else{var a=r.photo;if(a&&a.cameraModel){var f=a.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro – 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(f)>=0&&(i={projectionType:"equirectangular"})}}}return i};t.prototype.getReputationProperties=function(e){for(var t={},n=0,r=a.default;n<r.length;n++){var i=r[n];t[i]=M.optional(e[i])}return t};t.prototype._getPdfConversionFacet=function(e){var t,n={fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata};if(t=e.blockDownload&&X.canRenderNative(e.extension)?e.microServiceDataSource.getPassthroughUrl(n):e.microServiceDataSource.getPdfConversionUrl(n))return{url:t}};t.prototype._get3dFacet=function(e){if(this._pageContext.isSPO){var t=e.microServiceDataSource.getFbxConversionUrl({fileExtension:e.extension,item:e.itemFromServer}),n=q.canRenderNative(e.extension);if(t||n)return{canConvert:!0,canRenderNative:n,conversionUrl:t&&t.replace("/bxf?","/glb?")}}};t.prototype._getOfficeBundleFacet=function(e){var t=e.isWord,n=e.extension,r=e.itemUrlParts,i=e.isPowerPoint,s=e.itemFromServer,o=e.microServiceDataSource,u=e.mediaServiceFastMetadata,a=r.isCrossDomain;if(!a&&("21"===this._pageContext.webTemplate||b.isFeatureEnabled(b.EnableWrsPreviewOutsideODB))){var f,l,c,h=!a&&(t&&b.isFeatureEnabled(b.EnableWordWrsPreview)||i&&b.isFeatureEnabled(b.EnablePowerPointWrsPreview)),p=t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:s,mediaServiceMetadata:u}):"",d=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:s,mediaServiceMetadata:u}),v=!1,m="",g=s[".ctag"],y=u&&u.officeBundle;if(y){f=y.ctag;c=y.version;v=y.fatalError||!1;y.generationTime&&(l=new Date(y.generationTime));m=y.errorInfo||""}return{officeBundleGenerateUrl:p,officeBundleGetFragmentUrl:d,bundleCTag:f,bundleVersion:c,hasBundleGenerationFailed:v,bundleErrorInfo:m,generationTime:l,cTag:g,enableDefaultClick:h}}};t.prototype._getThumbnail=function(e){var t=e.itemFromServer;if(e.type!==d.default.Folder){if(T.isPromotedLinksList(e.listTemplateType))return{url:t.BackgroundImageLocation,width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===T.ListTemplateType.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;if(C.fileTypeSupportsPreview(e.extension)){if(this._listContext.remoteParentWeb){var r=new u.default(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(u.UriPartial.authority),i=encodeURI(t.FileRef);return s.previewImageUrlFromUrl(S.default.encodeURIComponent(r+i),this._pageContext.webAbsoluteUrl,this._pageContext)}return s.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}};t.prototype._getVideoUrl=function(e){var t=e.microServiceDataSource.getVideoUrl({fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata}),n={};t&&(n[i.default.video]=t);return n};t.prototype._getItemType=function(e){var t=e.itemFromServer,n=e.listTemplateType,r=e.microServiceDataSource,i=e.mediaServiceFastMetadata,s=this._getItemTypeOneNoteOrFolder(t);if(s===d.default.Unknown){var o=t.File_x0020_Type,u=o?"."+o:"";if(b.isFeatureEnabled(b.ShortcutLink)&&g.default.isShortcutFileType(o))return d.default.Shortcut;if(b.isFeatureEnabled(b.UseWebPdfViewer)&&("pdf"===o||this._getPdfConversionFacet({itemFromServer:t,extension:u,mediaServiceFastMetadata:i,blockDownload:!0,microServiceDataSource:r})))return d.default.Media;if(this._get3dFacet({itemFromServer:t,extension:u,microServiceDataSource:r,mediaServiceFastMetadata:i}))return d.default.Media;if("audio"===f.getIconNameFromExtension(u))return d.default.Media;if(i)return d.default.Media;if((s=f.getItemTypeFromExtension(u))===d.default.Unknown)return T.isGenericList(n)?d.default.File:T.isPromotedLinksList(n)?d.default.Media:s}return s||d.default.File};t.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=d.default.Folder;else if("1"===e.FSObjType){var n=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],r=e["File_x0020_Type.mapapp"];t=r&&"onenote"===r.substring(0,7)||n&&-1!==n.indexOf("onenote")?d.default.OneNote:d.default.Folder}else t=d.default.Unknown;return t};t.prototype._convertToODNGroup=function(e){var t=this,n=e;n.state=this.createObservable({isCollapsed:e.isCollapsed});n.children&&n.children.length>0&&(n.children=e.children.map(function(e){return t._convertToODNGroup(e)}));return n};t.prototype._parseMediaServiceMetadata=function(e){if(e&&"{}"!==e)try{var t=e;if("&"===e[1]){this._htmlDecodeDiv.innerHTML=e;t=this._htmlDecodeDiv.innerText}return JSON.parse(t)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pageContext:k.pageContext,urlDataSource:N.url,listContext:k.listContext,navigation:A.navigation,microServiceDataSource:P.resourceKey,vroomUrlHelper:D.resourceKey,itemUrlHelper:_.resourceKey,vroomDataContext:L.dataContext.optional,shortcutLinkDataSource:m.resourceKey,isActivityFeatureEnabled:U.isActivityFieldEnabledResourceKey});return t})(r.default);t.default=V;function $(e){return"number"!=typeof e||F.default.isActivated("7F572FB6-3D81-4762-8499-379671FD5F86","9/20/2017","Convert 100ns video durations to ms")?e:e/1e4}t.resourceKey=j.createResolvedResourceKey(e("module").id,V)});
define("Kq",["require","exports","bv","xv","pO","Gq","Nz","g","je","Ex","Qq","zi","bH","D7","qq","Yy","Nx","v","Wq","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var w=!1;var E=(function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._pageContext=t.pageContext;this._itemUrlHelper=t.itemUrlHelper;this._vroomUrlHelper=t.vroomUrlHelper}e.prototype.processResponse=function(e){var t=e.response,n=e.response,r=n.WebUrl,i=n.HttpRoot,s=n.ListData,u=n.rootFolder,a=n.ListSchema,f=(void 0===a?{}:a).Collapse,c=void 0===f?"FALSE":f,h=e.requestKey,p=e.observer,d=this._urlDataSource.getKeyParams(h),v="TRUE"===c,m=this._itemUrlHelper.getItemUrlParts(h),g=this._itemUrlHelper.getUrlParts({path:m.serverRelativeListUrl,listUrl:m.fullListUrl});(r||i)&&this._processWeb({list:t,requestKeyParts:d,observer:p});var y=this._processList({list:t,listUrlParts:g,requestKeyParts:d,observer:p}).listRootItemKey,b=[];if(u){var w=this._processRootFolder({list:t,listUrlParts:g,requestKeyParts:d,observer:p});b.push.apply(b,w.parentItemUrls)}if(s&&!v){w=this._processListData({listData:s,listUrlParts:g,parentKey:h,requestKeyParts:d,observer:p});b.push.apply(b,w.parentItemUrls)}var E={};if(t.ParentInfo)for(var S=0,x=t.ParentInfo.ParentFolderInfo;S<x.length;S++){var T=x[S];E[T.ServerRelativeUrl]=l.default.fromHexString(T.Permissions)}for(var N=0,C=o.removeDuplicates(b);N<C.length;N++){var k=C[N];this._processParentItem({itemUrl:k,listUrlParts:g,parentInfo:E,requestKeyParts:d,observer:p})}return{listRootItemKey:y}};e.prototype._processListData=function(e){for(var t=e.listData.Row,n=e.parentKey,r=e.requestKeyParts,i=e.listUrlParts,o=e.observer,u=[],a="",f=0,l=t;f<l.length;f++){var c=l[f],h=c.FileRef,p=this._processRow({row:c,observer:o,requestKeyParts:r,listUrlParts:i}).key;u.push.apply(u,this._getParentItemUrls({listUrlParts:i,itemUrl:h}));o.update([new s.default(p).succeed({set:{parent:{key:n},after:{key:a}}})]);a=p}return{parentItemUrls:u}};e.prototype._processRow=function(e){var t,n,i=e.row,o=e.row.FileRef,u=e.listUrlParts,f=e.requestKeyParts,l=e.observer,c=this._itemUrlHelper.getUrlParts({path:o,listUrl:u.fullListUrl});n=((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t);if(this._isFolder(i)){var h={},p=this._urlDataSource.getQueryType(f),d=f.typeFilters;p!==r.default.Search&&(h.view=f.view);d&&(h.typeFilters=d);a.extend(n,h)}var v=this._urlDataSource.getKey(n),m=this._getParentKeyForListItem({listUrlParts:u,itemUrl:o,requestKeyParts:f}),g={key:v};m&&(g.parentKey=m);l.update([new s.default(v).succeed({item:g})]);return{key:v}};e.prototype._processRootFolder=function(e){var t,n,r,i=e.list,o=e.listUrlParts,u=e.requestKeyParts,a=e.observer,l=i.rootFolder,c=this._itemUrlHelper.getUrlParts({path:l,listUrl:o.fullListUrl}),p=this._urlDataSource.getKey(((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t.view=u.view,t.q=u.q,t.typeFilters=u.typeFilters,t)),d=this._getParentKeyForListItem({listUrlParts:o,itemUrl:l,requestKeyParts:u}),v={key:p,type:f.default.Folder,newWOPIDocumentEnabled:h.optional(i.NewWOPIDocumentEnabled)};d&&(v.parentKey=d);var m=!b.default.isActivated("D661752A-9F1F-4AF8-89A9-2C0CA6688A00","03/19/2019","Infer rootFolder content-type");if(i.ListData){n=i.ListData.FolderId;if(m&&"Sharepoint.DocumentSet"===i.ListData.CurrentFolderProgId){v.isDocSet=!0;if(i.AvailableContentTypes)for(var g=0,y=i.AvailableContentTypes;g<y.length;g++){var w=y[g],E=w.contentTypeId;if(E&&0===E.indexOf("0x0120D520")){v.contentTypeId=E;r=w.displayName;break}}}if(i.ListData.CurrentFolderSpItemUrl){var S=this._vroomUrlHelper.getUrlParts(i.ListData.CurrentFolderSpItemUrl);v.itemId=h.optional(S.itemId);v.graph={itemId:h.optional(S.itemId),driveId:h.optional(S.driveId)}}}m&&r&&v.contentTypeId?v.properties={ID:h.optional(n),ContentType:r,ContentTypeId:v.contentTypeId}:v.properties={ID:h.optional(n)};if(!this._isListRoot({itemUrl:l,listUrlParts:o})){var x=l.split("/").slice(-1)[0];v.name=x;v.displayName=x}a.update([new s.default(p).succeed({item:v})]);return{parentItemUrls:this._getParentItemUrls({listUrlParts:o,itemUrl:l})}};e.prototype._processWeb=function(e){var t,n=e.list,i=e.requestKeyParts,o=e.observer,u=n.HttpRoot,a=n.SiteTitle,l=n.WebUrl||u&&v.getSharePointPath(decodeURIComponent(u)),c=this._itemUrlHelper.getUrlParts({path:l,webUrl:l}),h=this._urlDataSource.getKey(((t={}).id=c.normalizedItemUrl,t.view=r.default.DocumentLibraries,t.typeFilters=i.typeFilters,t)),p={},d={key:h,type:f.default.Folder,subsite:p};if(this._pageContext.webAbsoluteUrl===l){d.name=a;d.displayName=a;p.webTemplateId=Number(this._pageContext.webTemplate);p.serverRelativeUrl=this._pageContext.webAbsoluteUrl;p.id=this._pageContext.webId;p.siteCollectionId=this._pageContext.siteId;p.title=this._pageContext.webTitle;p.icon=this._pageContext.webLogoUrl}o.update([new s.default(h).succeed({item:d})])};e.prototype._processList=function(e){var t,i,o,u,a,l=e.list,p=e.listUrlParts,d=e.requestKeyParts,g=e.observer,b=l.ListTitle,E=l.HttpRoot,S=l.ListUrl,x=l.listUrlDir,T=S||x&&decodeURIComponent(x),N=this._urlDataSource.getKey(((t={}).id=p.serverRelativeItemUrl,t.listurl=p.normalizedListUrl,t.view=d.view,t.q=d.q,t.typeFilters=d.typeFilters,t)),C=l.AllowCreateFolder,k=l.EnableMinorVersions,L=l.verEnabled,A=l.AllowGridMode,O=l.DisableGridEditing,M=l.ListTemplateType,_=l.BasePermissions,D=void 0===_?{}:_,P=D.ManageLists,H=void 0===P?void 0:P,B=D.ManagePersonalViews,j=void 0===B?void 0:B,F=D.OpenItems,I=void 0===F?void 0:F,q=D.UseClientIntegration,R=void 0===q?void 0:q,U=l.ListSchema,z=void 0===U?{}:U,W=z.DefaultItemOpen,X=void 0===W?void 0:W,V=z[".driveAccessTokenV21"],$=void 0===V?void 0:V,J=z[".driveAccessToken"],K=void 0===J?void 0:J,Q=z[".driveUrl"],G=void 0===Q?void 0:Q,Y=z[".driveUrlV21"],Z=void 0===Y?void 0:Y,ee=l.ExcludeFromOfflineClient,te=l.WebExcludeFromOfflineClient,ne=l.listBaseType,re=K,ie=$,se=G,oe=Z,ue=this._pageContext.driveInfo;if(l.isFromServiceWorkerCache&&T===this._pageContext.listUrl&&ue){ue[".driveAccessToken"]&&(re=ue[".driveAccessToken"]);ue[".driveAccessTokenV21"]&&(ie=ue[".driveAccessTokenV21"]);ue[".driveUrl"]&&(se=ue[".driveUrl"]);ue[".driveUrlV21"]&&(oe=ue[".driveUrlV21"])}if(re){o={accessToken:(ae=m.deserializeQuery(re)).access_token,proofToken:ae.prooftoken,tokenUrl:se}}if(ie){var ae;u={accessToken:(ae=m.deserializeQuery(ie)).access_token,proofToken:ae.prooftoken,tokenUrl:oe}}var fe=l.WebUrl||E&&v.getSharePointPath(decodeURIComponent(E));if(fe){var le=this._itemUrlHelper.getUrlParts({path:fe,webUrl:fe});a=this._urlDataSource.getKey(((i={}).id=le.normalizedItemUrl,i.view=r.default.DocumentLibraries,i.typeFilters=d.typeFilters,i))}var ce="string"==typeof X?"0"===X:void 0;ce&&(function(){if(!w){n.Engagement.logData({name:"List.openInClient"});w=!0}})();var he=se&&this._vroomUrlHelper.getUrlParts(se)||void 0;o&&y.isTokenExpired({authToken:o.accessToken,proofToken:o.proofToken})&&(o=void 0);u&&y.isTokenExpired({authToken:u.accessToken,proofToken:u.proofToken})&&(u=void 0);var pe="number"==typeof ne?c.isDocLib(String(ne)):void 0;g.update([new s.default(N).succeed({item:{key:N,parentKey:h.optional(a),itemId:h.backup("root"),graph:{itemId:h.backup("root"),driveId:h.optional((null==he?void 0:he.driveId)||void 0),sessionToken:h.optional(o),sessionTokenV21:h.optional(u)},type:f.default.Folder,name:h.optional(b),displayName:h.optional(b),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:h.optional(l.rootFolder?void 0:l.NewWOPIDocumentEnabled),list:{id:h.optional(l.listName),allowGridMode:"boolean"==typeof A?A:h.backup(!0),allowCreateFolder:h.optional(C),disableGridEditing:"boolean"==typeof O?O:h.backup(!1),enableMinorVersions:h.optional(k),enableVersions:h.optional(L),templateType:h.optional("string"==typeof M?Number(M):void 0),isDocumentLibrary:h.optional(pe),isPromotedLinks:h.optional("string"==typeof M?c.isPromotedLinksList(M):void 0),isModerated:h.optional(l.isModerated),newWOPIDocumentEnabled:h.optional(l.NewWOPIDocumentEnabled),newWOPIDocumentTypes:h.optional(l.NewWOPIDocumentTypes),permissions:{manageLists:h.optional(H),managePersonalViews:h.optional(j),openItems:h.optional(I),useClientIntegration:h.optional(R)},openInClient:h.optional(ce),excludeFromOfflineClient:h.optional("boolean"==typeof ee||"boolean"==typeof te?ee||te:void 0),contentTypesEnabled:h.optional(l.ContentTypesEnabled),metadataNavFeatureEnabled:h.optional(l.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:h.optional(l.canUserCreateMicrosoftForm),itemCount:h.optional(l.ListSchema&&l.ListSchema.ItemCount),rowLimit:h.optional(l.ListData.RowLimit),listUrlDir:T,createdFromExcel:h.optional(l.CreatedFromExcel),createdFromExisting:h.optional(l.CreatedFromExisting)},properties:{commandsSupported:h.optional(l.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]);return{listRootItemKey:N}};e.prototype._processParentItem=function(e){var t,n=e.itemUrl,r=e.listUrlParts,i=e.parentInfo,o=e.requestKeyParts,u=e.observer,a=this._itemUrlHelper.getUrlParts({path:n,listUrl:r.fullListUrl}),l=this._urlDataSource.getKey(((t={}).id=a.serverRelativeItemUrl,t.listurl=a.normalizedListUrl,t.view=o.view,t.q=o.q,t.typeFilters=o.typeFilters,t)),c={key:l,parentKey:this._getParentKeyForListItem({listUrlParts:r,itemUrl:n,requestKeyParts:o}),queryType:this._urlDataSource.getQueryType(o)};if(this._isListRoot({itemUrl:n,listUrlParts:r}))c.list={};else{var h=v.getFolderNameFromPath(n);c.name=h;c.displayName=h;c.type=f.default.Folder;c.isDropEnabled=!0;c.folder={};i&&i[n]&&(c.permissions=i[n])}u.update([new s.default(l).succeed({item:c})])};e.prototype._getParentKeyForListItem=function(e){var t,n,r=e.listUrlParts,i=e.itemUrl,s=e.requestKeyParts;if(r.serverRelativeListUrl!==i){var o=i.split("/").slice(0,-1).join("/"),u=this._itemUrlHelper.getUrlParts({path:o,listUrl:r.fullListUrl});n=this._urlDataSource.getKey(((t={}).id=u.serverRelativeItemUrl,t.listurl=u.normalizedListUrl,t.view=s.view,t.q=s.q,t.typeFilters=s.typeFilters,t))}return n};e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,n=e.itemUrl,r=[],i=t.serverRelativeListUrl;if(0===n.indexOf(i))for(var s="",o=0,u=n.substring(i.length).split("/").slice(1,-1);o<u.length;o++){var a=""+i+(s+="/"+u[o]);r.push(a)}return r};e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t};e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var n=e["File_x0020_Type.mapapp"],r=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(n&&"onenote"===n.substring(0,7)||r&&-1!==r.indexOf("onenote"))}else t=!1;return t};e.dependencies={urlDataSource:i.url,pageContext:u.pageContext,itemUrlHelper:p.resourceKey,vroomUrlHelper:d.resourceKey,resources:g.resourceScopeKey};return e})();t.default=E;t.resourceKey=g.createResolvedResourceKey(e("module").id,E)});
define("o$e",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["T4e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Qit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["z8e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Xit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["eOe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("ZCe",["require","exports","Gq","pO","xv","Ex","jP","D7","v"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var f=(function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._itemUrlHelper=t.itemUrlHelper}e.prototype.processSubsite=function(e){var t,r=e.subsite,u=e.requestKey,a=e.unique,f=e.observer,l=this._urlDataSource.getKeyParams(u),c=this._itemUrlHelper.getUrlParts({path:r.serverRelativeUrl,webUrl:r.serverRelativeUrl}),h=this._urlDataSource.getKey(((t={}).id=c.normalizedItemUrl,t.view=i.default.DocumentLibraries,t.typeFilters=l.typeFilters,t.u=a,t)),p=o.getIconNameFromItem({type:s.default.Folder}),d={key:h,isRootFolder:!0,isPlaceholder:!1,name:r.title,displayName:r.title,type:s.default.Folder,iconName:p,subsite:r,queryType:i.default.DocumentLibraries};f.update([new n.default(h).succeed({item:d})]);return{key:h}};e.dependencies={urlDataSource:r.url,itemUrlHelper:u.resourceKey};return e})();t.default=f;t.resourceKey=a.createResolvedResourceKey(e("module").id,f)});
define("Yit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Z8e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Wat",["require","exports","ww","tB","A","Ex","pO","ey","Pe","Aq","D7","Y2","Te","Eq","wq","fB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(o.url);n._itemsStore=n.resources.consume(p.resourceKey);n._apiUrlHelper=n.resources.consume(f.resourceKey);n._itemUrlHelper=n.resources.consume(l.resourceKey);n._itemParentHelper=n.resources.consume(d.resourceKey);n._dataRequestor=new(n.child(c.typeResourceKey))({qosName:"ItemActivityDataSource"});return n}t.prototype.getItemActivities=function(e,t,n){var r=this;return u.PermissionMask.hasItemPermission(e,u.PermissionMask.openItems)?v.isFeatureEnabled(v.UseActivitiesApi)?this._dataRequestor.getData({url:this._getItemNewActivitiesUrl(e,n,t),qosName:"Activities"}).then(function(t){return r._transformNewActivitiesData(t,e)}):this._dataRequestor.getData({url:this._getItemActivitiesUrl(e,n),qosName:"GetChanges",additionalPostData:this._constructPostBody(t)}).then(function(i){return r._transformData(i,t,n,e)}):i.default.wrap(new Array)};t.prototype._getItemActivitiesUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key),r=this._apiUrlHelper.build().webByItemUrl(n);if(e.type===s.default.Folder&&!e.isRootFolder&&t)r=r.method("GetFolderByServerRelativeUrl",n.serverRelativeItemUrl).segment("GetListItemChanges");else{r=r.method("GetList",n.serverRelativeListUrl);r=e.isRootFolder?r.segment("RootFolder").segment("GetListItemChanges"):r.method("Items",e.properties.ID).segment("GetChanges")}return(r=r.oDataParameter("$Expand","RelativeTime")).toString()};t.prototype._getItemNewActivitiesUrl=function(e,t,n){var r=this._itemUrlHelper.getItemUrlParts(e.key),i=this._apiUrlHelper.build().webByItemUrl(r);if(e.type===s.default.Folder&&!e.isRootFolder&&t)i=i.method("GetFolderByServerRelativeUrl",r.serverRelativeItemUrl);else{i=i.method("GetList",r.serverRelativeListUrl);e.isRootFolder||(i=i.method("Items",e.properties.ID))}return(i=i.segment("Activities").parameter("$top",n.fetchLimit)).toString()};t.prototype._transformData=function(e,t,n,r){for(var i,s=e.d.results,o=[],u=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(r,"list")),a=this._itemUrlHelper.getItemUrlParts(r.key),f=0;f<s.length;f++){var l=s[f],c=l.ItemId,p=l.ServerRelativeUrl,d=this._itemUrlHelper.getUrlParts({path:p,listUrl:a.fullListUrl}),v=this._urlDataSource.getKey(((i={}).id=d.serverRelativeItemUrl,i.listurl=d.normalizedListUrl,i)),m=new h.default(d.webRelativeItemUrl),g=this._mapActivityChangeType(l.ChangeType);if(0!==g){var y=this._getSharedWith(l,g),b=this._getEditor(l,g),w={id:c,changeToken:l.ChangeToken.StringValue,date:new Date(l.Time),relativeTime:l.RelativeTime,editor:b,itemActivityChangeType:g,latestName:!u||u.list.isDocumentLibrary?this._getFileName(m):this._getListItemName(v),latestFolder:this._getFolderPath(m),sharedWith:y,type:0,navigateToOptions:5!==g?this._getNavigateToOptions(v,u):void 0,serverRelativeUrl:p};if(f===s.length-1){s.length<t.fetchLimit&&o.push(w);break}if(!n){var E=s[f+1].ServerRelativeUrl,S=this._itemUrlHelper.getUrlParts({path:E,listUrl:a.fullListUrl}),x=new h.default(S.webRelativeItemUrl);w.previousName=this._getFileName(x);w.previousFolder=this._getFolderPath(x)}6===g&&(n?w.itemActivityChangeType=7:w.previousFolder!==w.latestFolder&&(w.itemActivityChangeType=4));o.push(w)}}return o};t.prototype._transformNewActivitiesData=function(e,t){for(var n,r=e.d.results,i=[],s=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list")),o=this._itemUrlHelper.getItemUrlParts(t.key),u=0,a=r;u<a.length;u++){var f=a[u],l=void 0,c=void 0;if(f.resource){l=f.resource.itemId;c=f.resource.serverRelativePath.DecodedUrl}else{l=parseInt(t.itemId,10);c=o.serverRelativeItemUrl}var p=this._itemUrlHelper.getUrlParts({path:c,listUrl:o.fullListUrl}),d=this._urlDataSource.getKey(((n={}).id=p.serverRelativeItemUrl,n.listurl=p.normalizedListUrl,n)),v=new h.default(p.webRelativeItemUrl),m=this._mapNewActivityType(f);if(0!==m){var g=this._getActor(f),y={id:l,changeToken:f.id,date:new Date(f.times.recordedTime),editor:g,itemActivityChangeType:m,latestName:!s||s.list.isDocumentLibrary?this._getFileName(v):this._getListItemName(d),latestFolder:this._getFolderPath(v),type:0,navigateToOptions:5!==m?this._getNavigateToOptions(d,s):void 0,serverRelativeUrl:c};6===m&&(y.previousName=f.action.rename.oldName);i.push(y)}}return i};t.prototype._getNavigateToOptions=function(e,t){var n,r=this.peekUnwrapObservable(this._itemsStore.getItem(e));if(t&&t.list.isDocumentLibrary)n=r?{url:this._urlDataSource.getDefaultClickUrl(r)}:{url:this._urlDataSource.getItemUrl(e)};else if(r){n={url:this._urlDataSource.getDisplayFormUrl(r),frameId:"_blank"}}return n};t.prototype._getSharedWith=function(e,t){var n=[];if(9===t)if(e.SharedWithUsers&&e.SharedWithUsers.Items&&e.SharedWithUsers.Items.results){(r=e.SharedWithUsers.Items.results)&&n.push.apply(n,this._createSharedWith(r))}else if(e.SharedWithUsersHint&&e.SharedWithUsersHint.results){var r;if(r=e.SharedWithUsersHint.results)for(var i=0;i+1<r.length;i+=2){var s={email:r[i+1],name:r[i],image:a.getUserPhotoUrl({userLoginName:r[i+1]}),userId:"invalid"};n.push(s)}}return n};t.prototype._getEditor=function(e,t){return 9===t&&e.SharedByUser?{email:e.SharedByUser.Email,name:e.SharedByUser.Name,image:a.getUserPhotoUrl({userLoginName:e.SharedByUser.Email}),userId:"invalid"}:{email:e.EditorEmailHint,name:e.Editor,image:a.getUserPhotoUrl({userLoginName:e.EditorEmailHint}),userId:"invalid"}};t.prototype._getActor=function(e){var t=e.actor,n=t.email;return{email:n,name:t.name,image:a.getUserPhotoUrl({userLoginName:n}),userId:"invalid"}};t.prototype._createSharedWith=function(e){return e.map(function(e){return{email:e.Email,name:e.Name,image:a.getUserPhotoUrl({userLoginName:e.Email}),userId:"invalid"}})};t.prototype._getFolderPath=function(e){return"/"+e.segments.slice(0,-1).join("/")};t.prototype._getFileName=function(e){return e.segments[e.segments.length-1]};t.prototype._getListItemName=function(e){var t=this.peekUnwrapObservable(this._itemsStore.getItem(e));return t?t.name:"a list item"};t.prototype._mapActivityChangeType=function(e){var t;switch(e){case 1:t=1;break;case 2:t=3;break;case 3:t=5;break;case 4:t=6;break;case 7:t=8;break;case 11:t=9;break;case 0:t=12;break;default:t=0}return t};t.prototype._mapNewActivityType=function(e){return e.action.create?1:e.action.edit?3:e.action.rename?6:e.action.comment?2:e.action.version?11:0};t.prototype._constructPostBody=function(e){var t=""+(e.fetchLimit+1),n={query:{Add:e.add,DeleteObject:e.deleteObject,FetchLimit:t,Group:e.group,Item:e.item,LatestFirst:e.latestFirst,Move:e.move,Rename:e.rename,Restore:e.restore,RoleAssignmentAdd:e.roleAssignmentAdd,RoleDefinitionAdd:e.roleDefinitionAdd,Update:e.update,User:e.user}};return JSON.stringify(n)};return t})(r.default);t.default=m});
define("Oit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["C4e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Tat",["require","exports","Te"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._pageContext=e;var t=(e&&new n.default(e.webAbsoluteUrl)).authority;this._itemUrlBase=t+this._pageContext.listUrl}e.prototype.getActivityItemUrl=function(e){var t=e&&e.driveItem;return t&&t.webUrl?t.webUrl:t&&e&&void 0!==e.relativePath?this._itemUrlBase+e.relativePath:void 0};e.prototype.getPageContextForRenderUser=function(){return this._pageContext};return e})();t.default=r});
define("Eit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["w4e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Pit",["require","exports","ww","tB","yS","U5e","v"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ActivityColumnBuilder=void 0;var u=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,t,n)||this}t.prototype.createActivityColumn=function(){return{key:"activity",name:s.default.ActivityColumnName,fieldType:i.default.Activity,minWidth:140,width:300,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,isIcon:!1,sortable:!1,filterable:!1,isSorted:!1,isFocused:this.observables.create(!1),isAscending:!1}};return t})(r.default);t.ActivityColumnBuilder=u;t.resourceKey=o.createResolvedResourceKey(e("module").id,u,n.__assign({},r.default.dependencies))});
define("r$e",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["k4e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("wit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["eMt"],t,n)}).then(function(e){return e.resourceKey})})})});
define("q0e",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Pge"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Nit",["require","exports","v","Bit","DZ","C$","X$","N$","KX","m$","yee","g","ey","fB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d,v,m;Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var g=p.isFeatureEnabled(p.EnableCommentsForSPCustomList),y=((d={})[s.moveTo.id]=!0,d[s.copyTo.id]=!0,d[o.checkout.id]=!0,d[o.quickEdit.id]=!0,d[s.createShortcut.id]=!0,d[u.contentTypeNavigation.id]=!0,d[u.editNewMenu.id]=!0,d[u.openInClient.id]=!0,d[u.uploadTemplate.id]=!0,d[l.sync.id]=!0,d[s.rename.id]=!0,d[f.share.id]=!0,d[o.editItem.id]=!0,d[o.exportList.id]=!0,d[o.viewItem.id]=!g,d[i.createWorkflow.id]=!0,d[i.baseFlow.id]=!0,d),b=((v={})[o.checkout.id]=!0,v[s.createShortcut.id]=!0,v[l.sync.id]=!0,v[i.createWorkflow.id]=!0,v[i.baseFlow.id]=!0,v[u.openInClient.id]=!0,v[o.versionHistory.id]=!0,v[o.exportList.id]=!0,v[f.alertItem.id]=!0,v),w=((m={})[s.deleteItem.id]=!0,m),E=(function(){function e(e,t){this._pageContext=t.pageContext}e.prototype.getCommand=function(e,t){var n,c;switch(t){case s.restoreItem:c=this._isRestoreEnabled(e);break;case s.open:c=!this._pageContext.isAnonymousGuestUser||h.PermissionMask.hasItemPermission(e,h.PermissionMask.openItems);break;case a.viewOriginal:c=!this._pageContext.blockDownloadsExperienceEnabled&&!this._pageContext.viewOnlyExperienceEnabled&&h.PermissionMask.hasItemPermission(e,h.PermissionMask.openItems);break;case o.versionHistory:case o.quickEdit:case o.editItem:case o.checkout:case o.exportList:case s.copyTo:case s.moveTo:case s.rename:case s.pinToMru:case s.openInTextEditor:case s.openPdfInBrowser:case s.createFolder:case s.printPdf:case u.openInClient:case u.openOnline:case u.openInPowerBI:case u.contentTypeNavigation:case u.editNewMenu:case u.uploadTemplate:case f.share:case f.alertItem:case f.addToSpotlight:case s.createShortcut:case l.sync:case l.upload:case l.download:case o.viewItem:case i.createWorkflow:case i.baseFlow:c=!0}this._pageContext.isAnonymousGuestUser&&y[t.id]?c=!1:this._pageContext.isEmailAuthenticationGuestUser&&b[t.id]&&(c=!1);e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected&&(c=c&&w[t.id]);c&&(n=new r.default);return n};e.prototype._isRestoreEnabled=function(e){return!!e.recycleBinProperties.itemState};return e})();t.default=E;t.resourceKey=n.createResolvedResourceKey(e("module").id,E,{pageContext:c.pageContext})});
define("Ete",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["qZe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("zC",["require","exports","WC"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getTypeFilter=void 0;t.getTypeFilter=function(e){void 0===e&&(e="");var t;if(e){for(var r=[],i=0,s="string"==typeof e?e.split(","):e;i<s.length;i++){var o=s[i];if("."===o.charAt(0)){var u=o.toLowerCase();r.indexOf(u)<0&&r.push(u)}else{var a=void 0;switch(o){case"folder":a=n.ItemTypeFilter.folder;break;case"photo":a=n.ItemTypeFilter.photo;break;case"video":a=n.ItemTypeFilter.video}a&&r.push(a)}}r.length&&r.push(n.ItemTypeFilter.folder);t={filters:r}}return t}});
define("KC",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PICKER_PARAM_KEY=t.MESSAGE_TO_PICKER_PREFIX=t.MESSAGE_FROM_PICKER_PREFIX=void 0;t.MESSAGE_FROM_PICKER_PREFIX="[OneDrive-FromPicker]";t.MESSAGE_TO_PICKER_PREFIX="[OneDrive-ToPicker]";t.PICKER_PARAM_KEY="picker"});
define("Bne",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["YZe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Uat",["require","exports","Ee","g","v"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var s=(function(){function e(e,t){this._pageContext=t.pageContext}e.prototype.getCurrentLanguage=function(){return n.default.language};e.prototype.getCurrentLanguageCode=function(){return this._pageContext.currentUICultureName};return e})();t.default=s;t.resourceKey=i.createResolvedResourceKey(e("module").id,s,{pageContext:r.pageContext})});
define("OZ",["require","exports","ww","tB","CS","LZ","zi","Aq","D7","Ux","AZ","fB","wZ","A","W","v","g","ze","Te","K2","Je","qe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var S=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(","),x=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,n.pageContext)||this;r._apiUrlHelper=n.apiUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._identityDataSource=n.identityDataSource;return r}t.prototype.getView=function(e,t){var n=this;return this.dataRequestor.getData({url:this._getViewApiUrl(e,t).oDataParameter("$select",S).toString(),parseResponse:function(e){var t=JSON.parse(e);return n._viewFromServerView(t.d,!0)},qosName:"GetView",method:"GET"})};t.prototype.getViews=function(e,t){var n=this;return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("Views").oDataParameter("$select",S).toString(),parseResponse:function(e){return JSON.parse(e).d.results.map(function(e){return n._viewFromServerView(e,!1,t)}).filter(function(e){return!!e})},qosName:"GetViews",method:"GET"})};t.prototype.createView=function(e,t){var n,r=this,i=e.viewParams,s=e.sourceView,o=i.useFiltersInViewXml?void 0:this._getFilterParams(i),u=!1,a=!1,f=!1,l=!1;return d.Qos.instrumentPromise({name:"ListDataSource.CreateView"},function(){return r._addView(e,t).then(function(e){if(!e)throw new Error("No view returned by /Views/Add");n=e;u=!0;if(o){l=!0;return r._saveLegacyFilters(n,o,t)}}).then(function(){a=!0;if(s.scope){l=!0;return r.modifyView({id:n.id,scope:s.scope},t)}}).then(function(){f=!0;return l?r.getView({id:n.id},t):n}).then(null,function(e){u&&o&&!a&&r.deleteView(n.id,t);return e})},null,function(e){return p.default.isCanceled(e)?{resultType:d.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:d.ResultTypeEnum.Failure,resultCode:u?a?f?l?"SecondGetView":"Unknown":"SaveScope":"SaveFilters":"CreateView",error:e}})};t.prototype.saveView=function(e,t,n){var r=this,i=e.sourceView,s=e.viewParams,o=e.updateViewXml,u=s.useFiltersInViewXml?void 0:this._getFilterParams(s),a=!1,f=!1;return d.Qos.instrumentPromise({name:"ListDataSource.SaveView"},function(){return r._setViewXml(e,t,n).then(function(){a=!0;if(u)return r._saveLegacyFilters(i,u,t)}).then(function(){f=!0;return o?r.getView({id:i.id},t):null}).then(function(e){o&&e&&(i.baseViewXml=e.baseViewXml);return{}})},null,function(e){return p.default.isCanceled(e)?{resultType:d.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:d.ResultTypeEnum.Failure,resultCode:a?f?"UpdateView":"SaveAsNewView":"SetViewXml",error:e}}).then(function(){})};t.prototype.deleteView=function(e,t){return this.dataRequestor.getData({url:this._getViewApiUrl({id:e},t).toString(),qosName:"DeleteView",method:"POST",additionalHeaders:{"X-HTTP-Method":"DELETE"}})};t.prototype.modifyView=function(e,t){var n={__metadata:{type:"SP.View"},DefaultView:e.isDefault,Title:e.title};"number"==typeof e.scope&&(n.Scope=e.scope);return this.dataRequestor.getData({url:this._getViewApiUrl({id:e.id},t).toString(),parseResponse:function(e){return e},qosName:"ModifyView",additionalPostData:JSON.stringify(n),method:"PATCH",additionalHeaders:{"X-HTTP-Method":"PATCH"}})};t.prototype.createMappedView=function(e,t,n){var r=this,i={appViewCreationInfo:{Title:e.title,AppId:e.appId,IsPrivate:e.isPrivate},visualizationTarget:t};return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("CreateMappedView").toString(),parseResponse:function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},qosName:"CreateMappedView",additionalPostData:JSON.stringify(i),method:"POST"})};t.prototype.getMappedApp=function(e,t,n){var r=this;return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("GetMappedApp").oDataParameter("$expand","AppMappedViews").toString(),parseResponse:function(e){return r.appSynchronizationResultFromMappedApps(e,!0)},qosName:"GetMappedApp",additionalPostData:JSON.stringify({appId:e,visualizationAppTarget:t}),method:"POST"})};t.prototype.getMappedApps=function(e,t){var n=this;return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("GetMappedApps").oDataParameter("$expand","AppMappedViews").toString(),parseResponse:function(e){return n.appSynchronizationResultFromMappedApps(e,!1)},qosName:"GetMappedApps",additionalPostData:JSON.stringify({visualizationAppTarget:e}),method:"POST"})};t.prototype.publishMappedView=function(e,t,n){var r=this;return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("PublishMappedView").toString(),parseResponse:function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},qosName:"PublishMappedView",additionalPostData:JSON.stringify({appId:e,visualizationTarget:t}),method:"POST"})};t.prototype.unpublishMappedView=function(e,t,n){var r=this;return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("UnpublishMappedView").toString(),parseResponse:function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},qosName:"UnpublishMappedView",additionalPostData:JSON.stringify({appId:e,visualizationTarget:t}),method:"POST"})};t.prototype.getFlowTemplates=function(e,t){var n=t?JSON.stringify({category:t}):void 0;return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("SyncFlowTemplates").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowTemplates",additionalPostData:n,method:"POST",noRedirect:!0})};t.prototype.getFlowInstance=function(e,t){return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("SyncFlowInstance").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowInstance",additionalPostData:JSON.stringify({flowID:e}),method:"POST",noRedirect:!0})};t.prototype.getFlowInstances=function(e){return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("SyncFlowInstances").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowInstances",method:"POST",noRedirect:!0})};t.prototype.getFlowCallbackUrl=function(e,t){return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("SyncFlowCallbackUrl").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowCallbackUrl",additionalPostData:JSON.stringify({flowId:e}),method:"POST",noRedirect:!0})};t.prototype.ensureSignoffStatusField=function(e){return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("EnsureSignoffStatusField").toString(),parseResponse:function(e){return JSON.parse(e).d},qosName:"EnsureSignoffStatusField",method:"POST"})};t.prototype.modifyFieldProperties=function(e,t,r,i,s){var o=this,u=e.id,a=e.displayName,f=e.fieldDescription,l=e.showInFiltersPane,c=new y.SimpleUri(s).authority,h=function(e,t){var c={__metadata:{type:"SP.Field"},Title:a,SchemaXml:f,ShowInFiltersPane:l},h=n.__assign({"X-HTTP-Method":"MERGE"},i),p=o.getListApiUrl(e).method("Fields",u).toString();if(!w.default.isActivated("5d911417-d0d1-4989-9ec5-5cf2ecdf8e97","4/23/2020","Retreve list by name")&&r){var d=o._apiUrlHelper;s&&(d=new E.ApiUrlHelperBasic({webAbsoluteUrl:s}));p=d.build().segment("web").methodWithAliases("GetListUsingPath",{DecodedUrl:e}).method("Fields",u).toString()}return o.dataRequestor.getData({url:p,qosName:"ModifyFieldProperties",additionalPostData:JSON.stringify(c),method:"POST",additionalHeaders:h,authToken:t})};return s&&new y.SimpleUri(this._pageContext.webAbsoluteUrl).authority!==c?p.default.resolve(this._identityDataSource.getSharePointToken(c).then(function(e){var n=e&&e.accessToken||"";return h(t,n)})):h(t)};t.prototype.setContentApproval=function(e,t){var n={__metadata:{type:"SP.List"},EnableModeration:e};return this.dataRequestor.getData({url:this.getListApiUrl(t).toString(),qosName:"SetContentApproval",additionalPostData:JSON.stringify(n),method:"POST",additionalHeaders:{"IF-MATCH":"*","X-HTTP-Method":"MERGE"}})};t.prototype.setListPropertiesAsString=function(e,t,r){var i=this,s=r,o=new y.SimpleUri(e).authority,u=function(r,s){var o=n.__assign({__metadata:{type:"SP.List"}},t),u=i._itemUrlHelper.getUrlParts({path:e,listUrl:e}),a=r+"/_api/web/GetList(@a1)?@a1='"+g.default.encodeRestUriStringToken(""+u.serverRelativeListUrl)+"'";return i.dataRequestor.getData({url:a,parseResponse:function(e){return e},qosName:"setListPropertiesAsString",additionalPostData:JSON.stringify(o),method:"POST",additionalHeaders:{"IF-MATCH":"*","X-HTTP-Method":"MERGE"},authToken:s})},a=function(t){return s?u(s,t):p.default.resolve(i._getWebUrlPromise(e,t).then(function(e){return u(e,t)}))};return new y.SimpleUri(this._pageContext.webAbsoluteUrl).authority!==o?p.default.resolve(this._identityDataSource.getSharePointToken(o).then(function(e){var t=e&&e.accessToken||"";return a(t)})):a()};t.prototype.appSynchronizationResultFromMappedApps=function(e,t){var n=this,r=JSON.parse(e),i=r&&r.d;if(!i)return null;var s=[];i.AppMappedViews&&i.AppMappedViews.results&&(s=i.AppMappedViews.results.map(function(e){return n._viewFromServerView(e)}));var o=null;try{o=JSON.parse(i.SynchronizationData);(t?o&&o.name&&o.properties:o&&o.value)||(o={id:null,name:null,properties:{createdBy:null,createdTime:null,displayName:null,isPrivate:!0,permissions:null}});for(var u=t?[o]:o.value,a=0,f=u;a<f.length;a++){var l=f[a].properties;l.isPrivate=!l.permissions||!l.permissions.some(function(e){return e.properties&&e.properties.principal&&"Tenant"===e.properties.principal.type})}}catch(e){}return{appMappedViews:s,synchronizationData:r.d.SynchronizationData,synchronizationDataObject:o,synchronizationStatus:r.d.SynchronizationStatus}};t.prototype.getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e,listUrl:e});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};t.prototype.getDataSourceName=function(){return"ListDataSource"};t.prototype._addView=function(e,t){var n=e.title,r=e.sourceView,s=e.viewParams,o=e.isPublic,u=this._combineViewParamsAndXml(r,s);u.prepareForSaving();return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("Views").segment("Add").toString(),parseResponse:function(e){var t=JSON.parse(e);return new i.default(t.d)},qosName:"AddView",additionalPostData:JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:n,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:r.getEffectiveFieldNames()},Query:u.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!o,RowLimit:r.rowLimit}})})};t.prototype._combineViewParamsAndXml=function(e,t){var n=new i.default(e.getEffectiveViewXml());if(t){if(t.sortField){var r={fieldName:t.sortField,isAscending:"false"!==t.isAscending};n.updateSort(r,{overwriteAll:!0})}t.groupBy&&n.updateGroupBy({group1:{fieldName:t.groupBy,isAscending:!0}});var s=localStorage.getItem("SPColumnSize-Unsaved-"+e.id);if(s){n.updateColumnWidths(JSON.parse(s));localStorage.removeItem("SPColumnSize-Unsaved-"+e.id)}var o=e.customFormatter;n.updateCustomFormatter(o)}return n};t.prototype._getFilterParams=function(e){for(var t={},n=!1,r=0,i=Object.keys(e||{});r<i.length;r++){var s=i[r];if(f.filterKeyRegex.test(s)){n=!0;t[s]=e[s]}}return n?t:void 0};t.prototype._saveLegacyFilters=function(e,t,n){return this.dataRequestor.getData({url:this.getListApiUrl(n).methodWithAliases("SaveAsNewView",{oldName:e.id,newName:e.title,privateView:!!e.isPersonal,uri:this._pageContext.webAbsoluteUrl+h.default.getInplviewHash(e.id,t)}).toString(),parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.SaveAsNewView},qosName:"SaveViewFilters"})};t.prototype._setViewXml=function(e,t,n){var r=e.sourceView,i=e.viewParams,s=this._combineViewParamsAndXml(r,i);s.prepareForSaving();return r.isDirty()||s.isDirty()?this.dataRequestor.getData({url:this._getViewApiUrl({id:r.id},t,n).method("SetViewXml").toString(),qosName:"UpdateView",additionalPostData:JSON.stringify({viewXml:s.getEffectiveViewXml()})}):p.default.wrap()};t.prototype._getViewApiUrl=function(e,t,n){return n?this.getListApiUrl(t).segment("DefaultView"):l.isViewById(e)?this.getListApiUrl(t).method("Views",e.id):l.isViewByUrl(e)?this._apiUrlHelper.build().webByUrl({path:t,listUrl:t}).method("GetViewFromUrl",e.url):this.getListApiUrl(t).method("Views",e.title)};t.prototype._viewFromServerView=function(e,t,n){if(e.ViewType&&e.Id){var r=c.isFeatureEnabled(c.PowerApps)&&i.default.isAppView(e),s=e.Hidden&&!r,u=n===o.default.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!s&&!u){var a=new i.default(e);if(a.viewType)return a}}return null};t.prototype._getWebUrlPromise=function(e,t){return this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(e),parseResponse:function(e){return JSON.parse(e).d.GetContextWebInformation.WebFullUrl},qosName:"GetContextInfoInListDataSource",method:"POST",authToken:t})};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pageContext:m.pageContext,apiUrlHelper:u.resourceKey,itemUrlHelper:a.resourceKey,identityDataSource:b.resourceKey});return t})(s.default);t.default=x;t.resourceKey=v.createResolvedResourceKey(e("module").id,x)});
define("$q",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey(e("module").id)});
define("jq",["require","exports","A","v","$q","Xq","Vq","g","D7","HO","fB","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var h=c.default.isActivated("D349E556-140B-4BFA-8B14-5DD337AAFB41","7/2/2020","Use per-list store for MicroServiceDataSource"),p=l.isFeatureEnabled(l.UseSelfIssuedTokenForSPOWebAuth)&&l.isFeatureEnabled(l.UseIdentityAuthForVroom),d=(function(){function e(e,t){this._authTokenDataSource=t.authTokenDataSource;this.itemUrlHelper=t.itemUrlHelper;this._pageContext=t.pageContext;this._microServiceDataSource=t.microServiceDataSource;this._microServiceDataSourceStore=t.microServiceDataSourceStore;this._pendingListResponse=t.pendingListResponse;this._getAuthTokenPromises={}}e.prototype.ensureAuthToken=function(e){var t=this;return n.default.resolve().then(function(){var e=t._pendingListResponse.response;if(e)return e}).then(function(){var r=h?void 0:t._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(e);return p||(!r||r.hasAuthData()&&!r.hasAuthDataExpired())&&t._microServiceDataSource.hasAuthData()&&!t._microServiceDataSource.hasAuthDataExpired()?n.default.wrap(void 0):t._pageContext.isSPO?t._getAuthTokenWithDebounce(e).then(function(i){if(!i)return n.default.wrapError("The list response did not contain a list schema value.");r&&r.setBaseInfo(i);t._microServiceDataSource.setBaseInfo(i);var s=h?"":e;delete t._getAuthTokenPromises[s]}):n.default.resolve()})};e.prototype.getAuthToken=function(e){return p?n.default.reject(new Error("AuthTokenFetcher: drive tokens should no longer be used")):this._pageContext.isSPO?this._authTokenDataSource.getAuthToken({key:e}):n.default.reject(new Error("getAuthToken is not supported OnPrem"))};e.prototype._getAuthTokenWithDebounce=function(e){var t=h?"":e;return this._getAuthTokenPromises[t]||(this._getAuthTokenPromises[t]=this.getAuthToken(e))};return e})();t.default=d;t.resourceKey=r.createResolvedResourceKey(e("module").id,d,{authTokenDataSource:o.resourceKey,itemUrlHelper:a.resourceKey,pageContext:u.pageContext,microServiceDataSource:i.resourceKey,microServiceDataSourceStore:s.resourceKey,pendingListResponse:f.resourceKey})});
define("d$e",["require","exports","ww","v","g$e","g","h$e","m$e","f$e","l$e","Vq"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.typeResourceKey=void 0;var c=new r.ResolvedResourceFactory(i.default,{pageContext:s.pageContext,thumbnailHelper:o.resourceKey,metaDataProcessor:u.resourceKey,authCookieHelper:a.resourceKey,authTokenStore:f.resourceKey,authTokenDataSource:l.resourceKey});t.typeResourceKey=new r.ResourceKey({name:e("module").id+".type",factory:{dependencies:{resources:r.resourceScopeKey},create:function(e){return{instance:(function(t){n.__extends(i,t);function i(){var n=this,i=new r.ResourceScope(e.resources);i.bind(u.resourceKey);(n=t.call(this,{},i.resolve(c.dependencies))||this)._resources=i;return n}i.prototype.dispose=function(){this._resources.dispose()};return i})(i.default)}}}});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:c})});
define("Zq",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["d$e"],t,n)}).then(function(e){return e.resourceKey})})});t.typeResourceKey=new n.ResourceKey({name:e("module").id+".type",loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["d$e"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("Xq",["require","exports","Zq","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var i=(function(){function e(e,t){this._microServiceDataSourceType=t.microServiceDataSourceType;this._store=new Map}e.prototype.getOrCreateMicroServiceDataSource=function(e){var t=this._store.get(e);if(!t){t=new this._microServiceDataSourceType;this._store.set(e,t)}return t};return e})();t.resourceKey=r.createResolvedResourceKey(e("module").id,i,{microServiceDataSourceType:n.typeResourceKey})});
define("HO",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{},create:function(){return{instance:{response:void 0}}}}})});
define("f$e",["require","exports","bH","v","k3","p$e","h$e","fB","zq"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var f=new r.ResourceKey({name:"updateThumbnailUrlCallback",factory:{dependencies:{itemTaskObserverType:a.resourceKey},create:function(e){return{instance:function(t,r){var i=new e.itemTaskObserverType;i.update(t.itemsWaitingForCookies.map(function(e){var i=e.itemKey,s=u.isFeatureEnabled(u.MediaTAUseVroomV21),o=s?r.authTokenV21:r.authToken,f=s?r.proofTokenV21:r.proofToken,l=e.thumbnailUrl+"&access_token="+o+"&prooftoken="+f,c=t.thumbnailHelper.getThumbnail({baseUrl:l,itemKey:i,fileExtension:e.fileExtension,mediaServiceMetadata:e.mediaServiceMetadata});return new a.Task(i).succeed({item:{key:i,thumbnail:n.replace(c)}})}));t.itemsWaitingForCookies.length=0;i.flush()}}}}});t.resourceKey=r.createResolvedResourceKey(e("module").id,s.default,{thumbnailHelper:o.resourceKey,platformDetection:i.platformDetection,updateThumbnailUrlCallback:f})});
define("Vq",["require","exports","ww","A","W","Yq","tB","v","De","Kq","zq","g","pO","D7"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var d=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t)||this;r._itemTaskObserverType=n.itemTaskObserverType;r._itemUrlHelper=n.itemUrlHelper;r._listItemResultProcessor=n.listItemResultProcessor;r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;return r}t.prototype.getAuthToken=function(e){var t=this;if(!this._pageContext.isSPO)return r.default.reject(new Error("getAuthToken is not supported OnPrem"));var o=new s.SPListItemRetriever({pageContext:this._pageContext}),u=e&&e.key||this._urlDataSource.getRootItemKey(),f=this._itemUrlHelper.getItemUrlParts(u),l=this._itemUrlHelper.getUrlParts({path:f.serverRelativeListUrl,listUrl:f.fullListUrl}),c=a.getViewXml({pageSize:1}),h={parentKey:u,postDataContext:{viewXml:c,needsSchema:!0,isListDataRenderOptionChangeFeatureEnabled:!0},skipServiceWorkerCache:!0},p={urlParts:l},d={qosEvent:new i.Qos({name:"FetchAuthToken"}),qosName:"AuthToken.GetData"};return o.getItem(h,p,d).then(function(e){var r=new t._itemTaskObserverType;t._listItemResultProcessor.processResponse({response:n.__assign(n.__assign({},e),{ListData:n.__assign(n.__assign({},e.ListData),{Row:[]})}),requestKey:u,observer:r});r.flush();if(e&&e.ListSchema)return{data:e.ListSchema,allowCookies:!1}})};t.dependencies=n.__assign(n.__assign({},o.default.dependencies),{itemTaskObserverType:l.resourceKey,itemUrlHelper:p.resourceKey,listItemResultProcessor:f.resourceKey,pageContext:c.pageContext,urlDataSource:h.url});return t})(o.default);t.default=d;t.resourceKey=u.createResolvedResourceKey(e("module").id,d)});
define("l$e",["require","exports","v","u$e"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{})});
define("m$e",["require","exports","v","_$e","k3","g"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{pageContext:s.pageContext,platformDetection:i.platformDetection})});
define("h$e",["require","exports","v","Aq","D7","b$e"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o={crossDomainImageHelper:n.createResolvedResourceKey(e("module").id+".crossDomainImageHelper",s.CrossDomainImageHelper,{apiUrlHelper:r.resourceKey}),itemUrlHelper:i.resourceKey};t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:o,create:function(e){var t=new s.default(e);return{instance:t,disposable:t}}}})});
define("Nat",["require","exports","ww","Oe","tB"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.FIRST_PARM_FORMAT="{0}?{1}";return t}t.prototype.getPath=function(){return r.format(this.FIRST_PARM_FORMAT,t.APP_PATH_PRE_FIX,t.APP_PATH_POST_FIX)};t.prototype.getStorePath=function(){return"https://itunes.apple.com/us/app/onedrive/id477537958?mt=8"};t.APP_PATH_PRE_FIX="ms-onedrive://";t.APP_PATH_POST_FIX="from=web";return t})(i.default);t.default=s});
define("tTe",["require","exports","v","EI","fB","Oee"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ModuleLoaderDataSource=void 0;var o={base:s.withLoaderCache(function(){return new Promise(function(t,n){e(["BPt"],t,n)})}),settings:s.withLoaderCache(function(){return new Promise(function(t,n){e(["DTt"],t,n)})}),share:s.withLoaderCache(function(){return new Promise(function(t,n){e(["XPt"],t,n)})}),mobileUpsell:s.withLoaderCache(function(){return new Promise(function(t,n){e(["rTt"],t,n)})}),picker:s.withLoaderCache(function(){return new Promise(function(t,n){e(["GPt"],t,n)})}),textEditor:s.withLoaderCache(function(){return new Promise(function(t,n){e(["zMe"],t,n)})}),fileRequest:s.withLoaderCache(function(){return new Promise(function(t,n){e(["kPt"],t,n)})}),embed:s.withLoaderCache(function(){return new Promise(function(t,n){e(["Jkt"],t,n)})}),oneUp:s.withLoaderCache(function(){return new Promise(function(t,n){e(["aEe"],t,n)})}),files:s.withLoaderCache(function(){return new Promise(function(t,n){e(["pkt"],t,n)})}),error:s.withLoaderCache(function(){return new Promise(function(t,n){e(["E1t"],t,n)})}),mobileUpsellInner:s.withLoaderCache(function(){return new Promise(function(t,n){e(["sTt"],t,n)})}),settingsInner:s.withLoaderCache(function(){return new Promise(function(t,n){e(["WTt"],t,n)})}),restore:s.withLoaderCache(function(){return new Promise(function(t,n){e(["x9t"],t,n)})}),commands:s.withLoaderCache(function(){return new Promise(function(t,n){e(["Eae"],t,n)})})},u=(function(){function e(){}e.prototype.getPageModuleLoader=function(e){if(e===r.default.MobileAppUpsell&&i.isFeatureEnabled(i.EnableMobileWebOfficeAppUpsell))return o.mobileUpsell;switch(e){case r.default.Error:case r.default.Restore:return o.base;case r.default.Settings:return o.settings;case r.default.Share:return o.share;case r.default.FilePicker:return o.picker;case r.default.TextFileEditor:return o.textEditor;case r.default.FileRequest:return o.fileRequest;case r.default.Embed:return o.embed;case r.default.OneUp:return o.oneUp;default:return o.files}};e.prototype.getInnerPageModuleLoader=function(e){switch(e){case r.default.MobileAppUpsell:return o.mobileUpsellInner;case r.default.Settings:return o.settingsInner;case r.default.Restore:return o.restore;case r.default.Error:default:return o.error}};e.prototype.getCommandSetModuleLoader=function(){return o.commands};return e})();t.ModuleLoaderDataSource=u;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:new n.SimpleResourceFactory(u)})});
define("jit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["P8e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Ait",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["fct"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Dit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["KTt"],t,n)}).then(function(e){return e.resourceKey})})})});
define("hse",["require","exports","v","$P","Aq","g","yse","Sie","gse","bse"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=n.createResolvedResourceKey(e("module").id,r.PeoplePickerDataSource,{apiUrlHelper:i.resourceKey,pageContext:s.pageContext,dataRequestor:o.resourceKey,oAuthTokenProvider:u.resourceKey,graphPeoplePickerHelper:a.resourceKey,substratePeoplePickerHelper:f.resourceKey})});
define("Oq",["require","exports","ww","tB","A","v","Aq","D7","Y2","LO","wq","g"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var h=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._apiUrlHelper=n.apiUrlHelper;r._dataRequestor=r.scope.attach(new n.dataRequestorType({qosName:"PolicyTipDataSource"}));r._itemParentHelper=n.itemParentHelper;r._itemUrlHelper=n.itemUrlHelper;r._viewParams=n.viewParams;r._sharingContextInformation=n.sharingContextInformation;return r}t.prototype.getExternalSharingStatus=function(){return this._isPseudo()?i.default.wrap({isExternalSharingTipEnabled:!0,externalSharingTipsLearnMoreUrl:"http://bing.com"}):this._dataRequestor.getData({url:this._apiUrlHelper.build().segments("web","DataLeakagePreventionStatusInfo").toString(),qosName:"GetExternalSharingStatus"}).then(function(e){var t=e&&e.d;return t?{isExternalSharingTipEnabled:t.ExternalSharingTipsEnabled,externalSharingTipsLearnMoreUrl:t.ExternalSharingTipsLearnMoreUrl}:null})};t.prototype.getPolicyTip=function(e){if(this._isPseudo())return i.default.wrap({issueDescriptions:["Item contains the following sensitive information: U.S. Social Security Number (SSN)","Item is shared with people outside your organization","Item contains sensitive document properties"],overrideOption:2,lastScanned:new Date,policyInfoUrl:"http://bing.com",explanationText:"This item conflicts with a policy in your organization. Access to this item is blocked for everyone except its owner, last modifier, and the site owner."});if(!this._sharingContextInformation&&!e)return i.default.wrap(null);var t=this._getApiRoot(e).segment("getdlppolicytip");return this._dataRequestor.getData({url:t.toString(),qosName:"GetPolicyTip"}).then(function(e){var t=e&&e.d;if(!t||null===t.GetDlpPolicyTip)return i.default.wrap(null);var n=t.MatchedConditionDescriptions,r=t.OverrideOptions,s=void 0===r?0:r,o=t.GeneralText,u=t.AppliedActionsText,a=Date.parse(t.LastProcessedTime);return{issueDescriptions:n&&n.results,overrideOption:Number(s),policyInfoUrl:t.ComplianceUrl,explanationText:o&&u?o+" "+u:o||u||"",lastScanned:isNaN(a)?void 0:new Date(a)}})};t.prototype.updatePolicy=function(e){if(this._isPseudo())return i.default.wrap(0===e.action?2:1===e.action?3:0);var t=this._getApiRoot(e.item).segment("overridepolicytip");return this._dataRequestor.getData({url:t.toString(),additionalPostData:JSON.stringify({userAction:e.action,justification:e.justification}),method:"POST",qosName:"UpdatePolicyTip"}).then(function(e){var t=e&&e.d,n=t&&t.OverridePolicyTip;return"number"==typeof n?n:null})};t.prototype._getApiRoot=function(e){var t;if(this._sharingContextInformation)if(this._sharingContextInformation.uniqueId){var n=this._sharingContextInformation.isFolder?"GetFolderById":"GetFileById",r={guid:this._sharingContextInformation.uniqueId};t=this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method(n,r).segment("ListItemAllFields")}else t=this._sharingContextInformation.listUrl?this._apiUrlHelper.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",this._sharingContextInformation.itemUrl).segment("ListItemAllFields"):this._sharingContextInformation.listId&&this._sharingContextInformation.listItemId?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("Lists",this._sharingContextInformation.listId).method("GetItemById",this._sharingContextInformation.listItemId):this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId);else{var i=this._itemUrlHelper.getItemUrlParts(e.key),s=this._getParentListId(e);t=this._apiUrlHelper.build().webByItemUrl(i).method("Lists",s).method("GetItemById",e.properties.ID)}return t};t.prototype._getParentListId=function(e){var t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return t?t.list.id:e&&e.properties&&e.properties.listId};t.prototype._isPseudo=function(){return"1"===this._viewParams.peek().showpolicytips};return t})(r.default);t.default=h;t.resourceKey=s.createResolvedResourceKey(e("module").id,h,{apiUrlHelper:o.resourceKey,dataRequestorType:a.typeResourceKey,itemParentHelper:l.resourceKey,itemUrlHelper:u.resourceKey,viewParams:f.viewParams,sharingContextInformation:c.sharingContextInformation.optional})});
define("Hit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["aMt"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Qat",["require","exports","ww","tB","pO","bH","wq","Ex","D7","sz","xv","g"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(i.url);n._itemParentHelper=n.resources.consume(o.resourceKey);n._itemUrlHelper=n.resources.consume(a.resourceKey);n._pageContext=n.resources.consume(c.pageContext);return n}t.prototype.getRecycleBinItem=function(e){var t,n,r=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"subsite"));if(r&&r.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl){var i=this._urlDataSource.getKeyParams(r.key),o=this._itemUrlHelper.getItemUrlParts(r.key).fullItemUrl+"/_layouts/15/RecycleBin.aspx";n=this._urlDataSource.getKey(((t={}).id=i.id,t.view=l.default.RecycleBin,t));var a=new f.default(n);s.default(a,{key:n,openUrl:o,queryType:l.default.RecycleBin});return a}n=this._urlDataSource.getRootItemKey(l.default.RecycleBin);a=new f.default(n);s.default(a,{key:n,queryType:l.default.RecycleBin,type:u.default.Folder,isRootFolder:!0});return a};return t})(r.default);t.default=h});
define("kit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Hq"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Cit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["iQ"],t,n)}).then(function(e){return e.resourceKey})})})});
define("SZ",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey("rootItems")});
define("art",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey(e("module").id)});
define("nrt",["require","exports","ww","tB","v","zq","Ex","xv","fv","zi","pO","zq","D7","Eq","art","Nte","aw","Qb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var y={itemTaskObserverType:c.resourceKey,itemUrlHelper:h.resourceKey,itemsStore:p.resourceKey,observablesFactoryType:r.observablesFactoryTypeResourceKey,rootItemsTypeFilter:d.resourceKey.optional,urlDataSource:l.url,webDataSource:v.resourceKey};t.resourceKey=new i.ResourceKey({name:e("module").id+".rootItems",factory:{dependencies:y,create:function(e){var t=e.itemUrlHelper,r=e.itemsStore,i=e.rootItemsTypeFilter,l=e.urlDataSource,c=new g.default,p=c.attach(new e.observablesFactoryType).create();c.trackPromise(e.webDataSource.getMyOneDriveUrl()).then(function(c){var d,v,g=t.getUrlParts({path:c,webUrl:c}),y=t.getUrlParts({path:c+"/Documents",listUrl:c+"/Documents",webUrl:c}),b=new e.itemTaskObserverType,w=l.getKey(((d={}).id=g.normalizedItemUrl,d.view=u.default.DocumentLibraries,d)),E=l.getKey(n.__assign(((v={}).id=y.serverRelativeItemUrl,v.listurl=y.normalizedListUrl,v),l.saveItemTypeFilter(i))),S=l.getKey(n.__assign(n.__assign({},l.getKeyParams(l.getRootItemKey(u.default.Recent))),l.saveItemTypeFilter(i)));b.update([new s.Task(w).succeed({item:{key:w,subsite:{webTemplateId:a.default.mySite,serverRelativeUrl:g.fullItemUrl}}}),new s.Task(E).succeed({item:{key:E,name:s.Graft.backup(y.siteRelation===h.SiteRelation.sameSite?m.default.Files:m.default.oneDriveGroupTitle),displayName:s.Graft.backup(y.siteRelation===h.SiteRelation.sameSite?m.default.Files:m.default.oneDriveGroupTitle),type:o.default.Folder,parentKey:w,list:{templateType:f.default.mySiteDocumentLibrary},folder:{}}}),new s.Task(S).succeed({item:{key:S,name:s.Graft.backup(m.default.Recent),displayName:s.Graft.backup(m.default.Recent),type:o.default.Folder,folder:{}}})]);b.flush();p({files:r.getItem(E),recent:r.getItem(S)})});return{instance:p,disposable:c}}}})});
define("GK",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:new n.ConstantResourceFactory({postProcessSchema:function(e,t){return t}})})});
define("Mit",["require","exports","ww","tB","wq","xte","zi","Pit","wCe","xv","g","fv","v"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.DetailsListSchemaDataSource=void 0;var p=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._itemParentHelper=n.itemParentHelper;r._activityColumnBuilder=n.activityColumnBuilder;r._isActivityFieldEnabled=n.isActivityFieldEnabled;r._isActivityFieldVisible=n.isActivityFieldVisible;r._pageContext=n.pageContext;return r}t.prototype.postProcessSchema=function(e,t){var r=this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));r&&r.list.isDocumentLibrary&&e.queryType===f.default.Files&&(s.isOutOfTheBoxList(t)||r.list.templateType===o.default.mySiteDocumentLibrary||Number(this._pageContext.webTemplate)===c.default.mySite)&&this._isActivityFieldEnabled&&this._isActivityFieldVisible()&&(t=n.__spreadArrays(t,[this._activityColumnBuilder.createActivityColumn()]));return t};return t})(r.default);t.DetailsListSchemaDataSource=p;t.resourceKey=h.createResolvedResourceKey(e("module").id,p,n.__assign(n.__assign({},r.default.dependencies),{itemParentHelper:i.resourceKey,activityColumnBuilder:u.resourceKey,isActivityFieldEnabled:a.isActivityFieldEnabledResourceKey,isActivityFieldVisible:a.isActivityFieldVisibleResourceKey.lazy,pageContext:l.pageContext}))});
define("EK",["require","exports","k","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isUsingScopingControlDataSource=t.resourceKey=void 0;t.resourceKey=new r.ResourceKey("scopingControlDataSource");t.isUsingScopingControlDataSource=function(){return!n.Killswitch.isActivated("2ad9cd06-c387-4d25-a121-879b1b7ea5ff","9/14/20","Use ScopingControlDataSource")}});
define("O5e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n){switch(n){case"odbMyFiles":case"odbAllFiles":return e;case"spDocLib":return t.serverRelativeListUrl;case"spSiteSite":return t.normalizedItemUrl.replace("/"+t.webRelativeItemUrl,"");default:return}}});
define("xat",["require","exports","$2"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getScopes=t.siteScope=t.docLibScope=t.docLibFolderScope=t.orgScope=t.odbAllFilesScope=t.odbOtherPeopleScope=t.odbMyFilesScope=t.odbFolderScope=void 0;t.odbFolderScope={id:"odbFolder",name:n.default.CurrentFolderSearchScope};t.odbMyFilesScope={id:"odbMyFiles",name:n.default.ScopedFolderSearchMyOdb};t.odbOtherPeopleScope={id:"odbOtherPeople",name:n.default.ScopedFolderSearchOtherPeopleOdb};t.odbAllFilesScope={id:"odbAllFiles",name:n.default.OdbRootSearchItemName};t.orgScope={id:"org",name:n.default.WholeOrgSearchScope};t.docLibFolderScope={id:"spDocLibFolder",name:n.default.CurrentFolderSearchScope};t.docLibScope={id:"spDocLib",name:n.default.CurrentLibrarySearchScope};t.siteScope={id:"spSiteSite",name:n.default.CurrentSiteSearchScope};t.getScopes=function(e){switch(e){case"odbFolder":return[t.odbFolderScope,t.odbMyFilesScope,t.odbAllFilesScope,t.orgScope];case"odbOtherPeople":return[];case"odbMyFiles":case"odbAllFiles":return[t.odbMyFilesScope,t.odbAllFilesScope,t.orgScope];case"spFolder":case"spDocLibFolder":return[t.docLibFolderScope,t.docLibScope,t.siteScope,t.odbAllFilesScope,t.orgScope];case"spDocLib":return[t.docLibScope,t.siteScope,t.odbAllFilesScope,t.orgScope];case"spSiteSite":return[t.siteScope,t.odbAllFilesScope,t.orgScope];default:throw new Error("Invalid scope")}}});
define("x5e",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["C5e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("YO",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey("searchBoxConfig")});
define("wK",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey("searchBoxDataSource")});
define("N2",["require","exports","k","B2"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var s,o,u,a,f,l=(u=e.env,a=e.webAbsoluteUrl,u&&"prodbubble"===u&&a&&(a.toLowerCase().indexOf("microsoft.sharepoint-df.com")>-1||a.toLowerCase().indexOf("microsoft-my.sharepoint-df.com")>-1)?"spdf":u),c={id:t.getScenarioName(),version:e.siteClientTag,userRing:i(l)};n.Killswitch.isActivated("26b4aee9-fbae-481d-87da-b4bff0b3886f","09/29/2020","Use existing instrumenter between SPHome and SPLists if available.")||(f=null===(o=null===(s=window.mssearchux)||void 0===s?void 0:s.header)||void 0===o?void 0:o.getInstrumenter());f||(f=r.default({perf:{mark:function(){return 0},measure:function(){return 0},now:function(){return 0},getEntriesByName:function(){return[]}},hostAppInfo:c}));f.setProps({hostAppId:"SharePointShared",hostAppVersion:e.siteClientTag,hostAppEnvironment:e.env,spSiteSubscriptionId:e.siteSubscriptionId,spEnvironment:l,scenario:t.getScenarioName(),hostAppInfo:c});return f};function i(e){return"spdf"===e||"edog"===e?"inner":"prodbubble"===e?"outer":"generalAudience"}});
define("Eat",["require","exports","ww","zi","Pe","Nx","r","Sne","Je"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getViewParams=void 0;t.default=function(e){return{id:"fileSuggestionClickUpdater",groupUpdaters:l(e)}};function f(e,t,n){var r={},s=new i.SimpleUri(e),o=s.path.indexOf("?"),u=s.path.substring(0,-1!==o?o:s.path.length);r.id=u;n&&(r.listurl=n);t||(r.parent=u.substring(0,u.lastIndexOf("/")));return r}t.getViewParams=f;function l(e){return[{groupId:"file",createUpdater:c(e)},{groupId:"app",createUpdater:c(e)}]}function c(e){return function(){return{component:function(t){return function(l){return o.createElement(t,n.__assign(n.__assign({},l),{onClick:function(t){(function(e,t,n){n.engagement.logData({name:"InlineResult.Search.Click",isIntentional:!0});!a.default.isActivated("D3DC0B5E-DF1B-4535-A18D-FCD7E397EF4A","06/30/2020","Activate this if A2OD-specific logic broke other search suggestions")&&(function(e){var t=e.fileExtension,n=e.fileType;return void 0===t&&"File"===n})(t)&&h(e,t.url);if((function(e){return a.default.isActivated("F0803D82-EE28-4750-BAE5-CB8D5F00541C","05/20/2020","list item suggestion click fix")?e.fileType&&"folder"===e.fileType.toLowerCase()||!e.fileExtension:!!e.fileType&&"folder"===e.fileType.toLowerCase()&&!v(e)})(t))(function(e,t,n){e.preventDefault();e.stopPropagation();var r;n.pageContext.listUrl&&!d(t.url,n.pageContext.listUrl)&&(r=t.url.substring(0,t.url.lastIndexOf("/")));n.navigation.updateViewParams(f(t.url,!0,r),{clearOtherParams:!0})})(e,t,n);else if((function(e,t){return!(!e.url||(function(e){return!a.default.isActivated("31d4a0b9-e9f7-4b89-a452-b27b0222793d")&&-1!==e.indexOf("/_layouts/15/")})(e.url)||(function(e,t){return!!e&&!!e.listTemplateType&&r.isGenericList(e.listTemplateType)&&t.url.toLowerCase().indexOf("dispform.aspx")>=0})(t.listContext,e)||(function(e){return("aspx"===e.fileExtension||!e.fileExtension)&&e.url.toLowerCase().indexOf(".aspx")>=0})(e)||(n=e.fileExtension,n&&u.getOfficeFileType(n.toLowerCase()))||v(e));var n})(t,n)&&!(function(e){var t=e.indexOf("?")>-1?s.deserializeQuery(e.substring(e.indexOf("?")+1)):void 0;return!!t&&!!t.id&&!!t.parent})(t.url)){var o=(function(e,t){if(!a.default.isActivated("D5CB3817-13D8-4C8A-ABFB-D375FE82FD80","11/9/2020","use web=1 to for oneup urls"))return e.url.indexOf("&web=1")>=0||e.url.indexOf("?web=1")>=0?e.url:e.url.indexOf("?")>=0?e.url+"&web=1":e.url+"?web=1";var n,r,o=p(t),u=t.pageContext.webAbsoluteUrl;n=a.default.isActivated("e567d108-6349-46a5-9851-49f3abf8baa4","09/16/2020","Fix url for oneup viewer")?(o?u:new i.SimpleUri(u).authority)+t.pageContext.serverRequestPath:(function(e){if(p(e))return e.pageContext.webAbsoluteUrl;var t=window.location.href,n=t.indexOf("?");n>-1&&(t=t.substring(0,n));return t})(t);if(o&&t.pageContext.listUrl&&!d(e.url,t.pageContext.listUrl)&&!(r=t.navigation.viewParams.listurl||(function(e,t){if(t.indexOf(e)>-1){var n=e.length+1,r=t.substring(n);return t.substring(0,n+r.indexOf("/"))}return})(t.navigation.viewParams.id,e.url)))return;return n+"?"+s.serializeQuery(f(e.url,!1,r))})(t,n);o&&h(e,o)}t.onClick&&t.onClick(e)})(t,l,e)}}))}}}}}function h(e,t){e.preventDefault();e.stopPropagation();window.open(t,"_blank")}function p(e){return e.pageContext.listBaseTemplate===r.ListTemplateType.mySiteDocumentLibrary}function d(e,t){return e.indexOf(t)>-1}function v(e){return e.url.toLowerCase().indexOf("docsethome.aspx")>=0}});
define("G2",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){return e.viewParams.q||""}});
define("z2",["require","exports","W"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){return{Substrate:r(e),Loki:i(e)}};function r(e){return function(){var t=new n.Qos({name:"SuiteNavSearchBox.GetSubstrateToken"});return e.getSubstrateToken().then(function(e){t.end({resultType:n.ResultTypeEnum.Success});return e.accessToken}).catch(function(e){t.end({resultType:n.ResultTypeEnum.Failure,error:e.message});throw e})}}function i(e){return function(){var t=new n.Qos({name:"SuiteNavSearchBox.GetLokiToken"});return e.getLokiToken().then(function(e){t.end({resultType:n.ResultTypeEnum.Success});return e.accessToken}).catch(function(e){t.end({resultType:n.ResultTypeEnum.Failure,error:e.message});throw e})}}});
define("wat",["require","exports","Yb","A","Ee","W","Oe","jS","n0e","pO","Je"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=new n.default,h={},p=(function(){function e(e,t,n,r){this._resources=e;this._id=t;this._getScope=n;this.rx=r;this._useSuggestionDelay=!l.default.isActivated("9cc31224-b284-4b1f-b13e-54bcc113ef26","11/20/2020","Add delay to suggestion queries while user types.")}e.prototype.getId=function(){return this._id};e.prototype.createStream=function(e){var t,n=this,r=e+"*";t=this._useSuggestionDelay?this._updateDelayedQuery(r):this._getSuggestionResultPromise(r);return this.rx.Observable.fromPromise(t).selectMany(function(e){return n.rx.Observable.fromArray(e)}).select(function(t){return n.transform(t,e)})};e.prototype._getSuggestionResultPromise=function(e){var t=this,n=new s.Qos({name:this._id});return this._resources.consumeAsync(f.search).then(function(r){var i,o=null===(i=t._getScope())||void 0===i?void 0:i.id;return r.getItems(e,void 0,o).then(function(e){n.end({resultType:s.ResultTypeEnum.Success});return l.default.isActivated("c5c83aed-810b-44bb-95a9-32939d9698db","11/20/2020","when searchData.container undefined, just return undefined")?e.containers[0].results:e.containers[0]&&e.containers[0].results||void 0}).catch(function(e){n.end({resultType:s.ResultTypeEnum.Failure,error:e.message});throw e})})};e.prototype._updateDelayedQuery=function(e){var t=this;if(h.delayTimeoutId){c.clearTimeout(h.delayTimeoutId);h.rejectQuery&&h.rejectQuery();h={}}return new r.default(function(n,r){h.delayTimeoutId=c.setTimeout(function(){h={};n(t._getSuggestionResultPromise(e))},200);h.rejectQuery=r})};e.prototype.transform=function(e,t){var n=o.format(a.default.fileActivityContent,e.lastModifiedBy,u.getRelativeDateTimeStringPast(e.lastModifiedDate,i.default.language)),r=document.createElement("textarea");r.innerHTML=e.titleText;var s,f=r.value;s=l.default.isActivated("3ab5e273-4fc3-4aaa-8051-90bd6413c878","2020/02/27","Use available file extension")?-1!==f.lastIndexOf(".")?f.substring(f.lastIndexOf(".")+1):"":e.fileExtension||-1!==f.lastIndexOf(".")?f.substring(f.lastIndexOf(".")+1):"";var c=e.isContainer?"folder":"file",h=this._highlight(f,t);n=this._highlight(n,t);return{id:e.url,searchText:t,displayText:h,secondaryDisplayText:n,title:h,icon:e.iconUrl,iconUrl:e.iconUrl,lastModifiedBy:e.lastModifiedBy,lastModifiedTime:u.getRelativeDateTimeStringPast(e.lastModifiedDate,i.default.language),url:this._fixUrl(e,f,s),fileExtension:s,fileType:c}};e.prototype._highlight=function(e,t){var n=new RegExp(t,"i");return e.replace(n,"<mark>$&</mark>")};e.prototype._fixUrl=function(e,t,n){var r=e.parentUrl?decodeURI(e.parentUrl):"";r=r&&r.replace("/Forms/AllItems.aspx","");var i=e.url;(r&&n&&i.indexOf("/Forms/DispForm.aspx?ID=")>=0||!l.default.isActivated("e1899a3b-18e7-400a-a174-f99c02cd817f","2020/10/13","Fix folder link with # character")&&e.isContainer&&i.indexOf(t)<0)&&(i=r+"/"+t);return i};return e})();t.default=p});
define("Oat",["require","exports","k","wat"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,i){return{id:"scopedFileSuggestionProvider",groupUpdaters:[{groupId:"file",createUpdater:function(){var s;if(t()){var o,u=r.default.bind(null,e,"SuiteNavSearchBox.ScopedFileSuggestionProvider",i);u.__parameters=[{index:0,name:"rxjs"}];o=n.Killswitch.isActivated("2b8cfc76-fa08-4dd7-9c50-ed05463fb535","08/10/2020","Remove suggestions for Whole org scope")?[u]:"org"===(null===(s=i())||void 0===s?void 0:s.id)?[]:[u];return{providers:function(e){return o}}}return{}}}]}}});
define("R2",["require","exports","ey","tg","v","$2","K2","dv","Ow","G2","z2","g","N2"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var p=(function(){function e(e,t){this._navigation=t.navigation;this._identityDataSource=t.identityDataSource;this.getSearchText=this.getSearchText.bind(this);this.getTokenProviders=this.getTokenProviders.bind(this);this._pageContext=t.pageContext}e.prototype.isEnabled=function(){var e=u.isOneDriveWinApp(),t=this._identityDataSource.getIdentity().type===n.IdentityType.anonymous,r=a.isFeatureEnabled(a.SPPagesSuiteSearchBox);return!e&&!t&&r};e.prototype.getPlaceholderText=function(){return s.default.SearchPlaceholder};e.prototype.getSearchText=function(){return f.default(this._navigation)};e.prototype.getTokenProviders=function(){return l.default(this._identityDataSource)};e.prototype.getScenarioName=function(){return"onedriveweb"};e.prototype.getInstrumenter=function(){!this._searchInstrumenter&&this.isEnabled()&&(this._searchInstrumenter=h.default(this._pageContext,this));return this._searchInstrumenter};e.prototype.isScopeControlEnabled=function(){return a.isFeatureEnabled(a.ODBSubstrateSearchQueryV2)&&a.isFeatureEnabled(a.CSIOdbScopedSearch)&&a.isFeatureEnabled(a.CSIOdbScopeControl)};e.dependencies={navigation:r.navigation,identityDataSource:o.resourceKey,pageContext:c.pageContext};return e})();t.default=p;t.resourceKey=i.createResolvedResourceKey(e("module").id,p)});
define("Cat",["require","exports","zi","tg","k","je","v","sB","Gz","pO","T2","g","g","fB","K2","O5e","xat","EK","Dat","D7","xv","U3","Eat","YO","Oat"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var N=(function(){function e(e,t){this._deps=t;this._folderSearchEnabled=p.isFeatureEnabled(p.ODBSubstrateSearchQueryV2)&&p.isFeatureEnabled(p.CSIOdbScopedSearch);this._otherPeopleOdb3SSearchEnabled=p.isFeatureEnabled(p.ODBSubstrateSearchQueryV2)&&p.isFeatureEnabled(p.CSIOdbNotMyFiles3S)}e.prototype.getSuiteNavProviderKey=function(){return!i.Killswitch.isActivated("11ecefe9-d065-47b1-b0a8-13be0038aa7f","06/30/2020","Use SuiteNavProviderBasic")&&this._deps.resources.isExposed(l.suiteNavBasic)?l.suiteNavBasic:a.resourceKey};e.prototype.getTokenProviders=function(){return this._deps.searchBoxConfig.getTokenProviders()};e.prototype.getProviderConfigUpdaters=function(e){var t=[S.default(this._deps)];!i.Killswitch.isActivated("2f3e8ab0-e6fb-4e8d-a5d7-8299aff9beb7","10/19/2020","killSwitch to turn scoped suggestion query off")&&!p.isFeatureEnabled(p.CSIOdbScopedSuggestionQueryOff)&&(i.Killswitch.isActivated("d3da2475-d230-4208-a87f-11ec46db6e83","09/18/2020","Check for useTsQuery flight")?this._folderSearchEnabled||this._otherPeopleOdb3SSearchEnabled:p.isFeatureEnabled(p.UseTsQuery)&&(this._folderSearchEnabled||this._otherPeopleOdb3SSearchEnabled))&&(g.isUsingScopingControlDataSource()?e?t.push(T.default(this._deps.resources,this._isScopeUseSuggestionProvider.bind(this,e),e.bind(this))):t.push(T.default(this._deps.resources,this._isUsingSuggestionProvider.bind(this),function(){})):t.push(T.default(this._deps.resources,this._isUsingSuggestionProvider.bind(this),this._getSelectedScope.bind(this))));return t};e.prototype.onSubmitSearchCallback=function(e,t,n){var r,i=this;this._deps.instrumentationProvider.logStartSearchOnSubmit();if("org"===(null==(r=g.isUsingScopingControlDataSource()?n:this._selectedScope)?void 0:r.id))e&&this._deps.searchUpscopeDataSource.getTenantUpscopeUrl(e).then(function(e){i._deps.navigation.navigateTo(e)});else{this._deps.engagement.logData({name:"Upscope.Search.Click",isIntentional:!0});var s=t(),o=this._getSearchItemId(s,r);(0,this._deps.getSearchDataSource)().then(function(t){t.upscopeSearch(e,i._buildViewParams(s,i._getQueryType(r),o,r))})}};e.prototype.getScope=function(){var e=this._deps.navigation.viewParams,t=this._deps.urlDataSource.getKey(e),n=this._isCurrentUserODB();return this.isSearchResultsPage()?this._getScopeForSearch(e,t,n):this._getScopeForNonSearch(t,n)};e.prototype.getAvailableScopes=function(){return m.getScopes(this.getScope().id)};e.prototype.updateSelectedScope=function(e){this._selectedScope=e};e.prototype.isSearchResultsPage=function(){var e=this._deps.navigation.viewParams;return E.isSearchType(this._deps.urlDataSource.getQueryType(e))};e.prototype.getScopeControlScenario=function(e){if(this.isSearchResultsPage())return"ODB.Search";switch(e){case m.odbFolderScope:return"ODB.Folder";case m.odbOtherPeopleScope:return"ODB.OtherPeople";case m.odbAllFilesScope:return"ODB.Root";case m.docLibFolderScope:return"ODB.Library.Folder";case m.docLibScope:return"ODB.Library.Root";case m.siteScope:return"ODB.Site";default:throw new Error('Unsupported scope: "'+e.id+'"')}};e.prototype._isScopeUseSuggestionProvider=function(e){return!!e()&&"odbAllFiles"!==e().id};e.prototype._getSearchItemId=function(e,t){var n;n=g.isUsingScopingControlDataSource()?t:this._selectedScope;var r,i=this._deps.urlDataSource.getKey(e),s=this._deps.itemUrlHelper.getItemUrlParts(i),o=this._isCurrentUserODB();if((g.isUsingScopingControlDataSource()?!!t:this._deps.searchBoxConfig.isScopeControlEnabled())&&o){var u=this._deps.urlDataSource.getDefaultRootItemId();r=v.default(u,s,null==n?void 0:n.id)}else!this._otherPeopleOdb3SSearchEnabled||o||this._folderSearchEnabled||(r=s.serverRelativeListUrl);return r||e.id};e.prototype._getSelectedScope=function(){return this._selectedScope};e.prototype._isCurrentUserODB=function(){return Number(this._deps.pageContext.listBaseTemplate)===n.ListTemplateType.mySiteDocumentLibrary&&!!this._deps.pageContext.isSiteOwner};e.prototype._isUsingSuggestionProvider=function(){return this._getQueryType()===w.default.SearchOdbScope};e.prototype._buildViewParams=function(e,t,n,r){var i=s.extend({},e);i.view=""+t;i.id=n;this._shouldRemoveListUrl(r)&&delete i.listurl;return i};e.prototype._getItemKeyQueryType=function(){var e=this._isCurrentUserODB(),t=this._deps.urlDataSource.getKey(this._deps.navigation.viewParams);return(e?this._folderSearchEnabled&&!this._deps.urlDataSource.isSearchItemOdbRoot(t):this._otherPeopleOdb3SSearchEnabled)?w.default.SearchOdbScope:w.default.Search};e.prototype._getQueryType=function(e){var t;return(null==(t=g.isUsingScopingControlDataSource()?e:this._selectedScope)?void 0:t.id)&&"odbOtherPeople"!==t.id?"odbAllFiles"===t.id?w.default.Search:w.default.SearchOdbScope:this._getItemKeyQueryType()};e.prototype._getScopeForSearch=function(e,t,n){return n?this._deps.urlDataSource.getQueryType(e)===w.default.Search?m.odbAllFilesScope:this._isDocLib(t)?this._getDocLibSearchScope(t):this._deps.urlDataSource.isSearchItemOdbRoot(t)?m.odbMyFilesScope:m.odbFolderScope:m.odbOtherPeopleScope};e.prototype._getScopeForNonSearch=function(e,t){return t?this._isDocLib(e)?this._getDocLibSearchScope(e):this._deps.urlDataSource.isSearchItemOdbRoot(e)?m.odbAllFilesScope:m.odbFolderScope:m.odbOtherPeopleScope};e.prototype._getDocLibSearchScope=function(e){return this._deps.urlDataSource.isSPSiteRoot(e)?m.siteScope:this._deps.urlDataSource.isSPListRoot(e)?m.docLibScope:m.docLibFolderScope};e.prototype._shouldRemoveListUrl=function(e){var t,n;return!!(n=g.isUsingScopingControlDataSource()?null==e?void 0:e.id:null===(t=this._selectedScope)||void 0===t?void 0:t.id)&&("spSiteSite"===n||"odbAllFiles"===n)};e.prototype._isDocLib=function(e){return this._deps.urlDataSource.isItemCrossList(e)};e.dependencies={resources:o.resourceScopeKey,navigation:r.navigation,instrumentationProvider:l.instrumentation,engagement:u.resourceKey,identityDataSource:d.resourceKey,getSearchDataSource:f.search.async,searchBoxConfig:x.resourceKey,listContext:h.listContext,pageContext:c.pageContext,urlDataSource:f.url,itemUrlHelper:b.resourceKey,searchUpscopeDataSource:y.resourceKey};return e})();t.default=N;t.resourceKey=o.createResolvedResourceKey(e("module").id,N)});
define("Dat",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey("searchUpscopeDataSource")});
define("yat",["require","exports","ww","tB","v","Te","XN","Sat","g","fB"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._sharepointUrl=n.sharepointUrl;return r}t.prototype.getTenantUpscopeUrl=function(e){var t=this._sharepointUrl.peek();if(f.isFeatureEnabled(f.SearchAppClientFlight)){var n=new s.SimpleUri(t).authority;return Promise.resolve(n+"/"+this._pageContext.layoutsUrl+"/Search.aspx?q="+e)}return Promise.resolve(t+"?q="+e+"&v=search")};t.prototype.getLabel=function(){return u.default.expandSearch};t.prototype.getAriaLabel=function(){return u.default.expandSearch+" "+u.default.expandSearchOpensInNewTab};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pageContext:a.pageContext,sharepointUrl:o.sharepointUrl});return t})(r.default);t.default=l;t.resourceKey=i.createResolvedResourceKey(e("module").id,l)});
define("cTe",["require","exports","lie"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this.mediaBaseUrl="odsp-media";n.default.addPaths({"@ms/odsp-media/lib":e})};t.default=r});
define("qat",["require","exports","ww","LZ","y9"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._connectionUrl="";n._connectionUrl=i.getSafeWebServerRelativeUrl(n._pageContext)+"/_api/Site/ShareByLinkEnabled";return n}t.prototype.getShareByLinkInfo=function(){return this.dataRequestor.getData({url:this._connectionUrl,parseResponse:function(e){var t=JSON.parse(e);return t&&t.d?{isExternalSharingTipEnabled:!!t.d.ShareByLinkEnabled}:null},qosName:"GetShareByLinkInfo"})};t.prototype.getDataSourceName=function(){return"ShareByLinkDataSource"};return t})(r.default);t.default=s});
define("Jat",["require","exports","ww","Pe","nT","uv","y9","Aq","LZ","fB","A","_$","ze","Ex","Q3e","_P"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=d.default.Edit,g=d.default.View,y=d.default.Review,b=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._apiUrlHelper=n.resources.consume(u.resourceKey);n._sharingDataSourceHelper=new(n.managed(c.default));var r=o.getSafeWebServerRelativeUrl(n._pageContext);n._getPermissionsUrl=r+"/_api/SP.ObjectSharingInformation.GetObjectSharingInformationByUrl?$expand=SharedWithUsersCollection";n._getSharingSettingsUrl=r+"/_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation,SharePointSettings,SharePointSettings/PickerProperties,ObjectSharingInformation/SharedWithUsersCollection";return n}t.prototype.getRawResponse=function(e){var t,n=e.item,r=this._sharingDataSourceHelper.canUseSecurable(n),i="GetSharingInformationOld",s={};if(f.isFeatureEnabled(f.EnableGetSharingInformation)&&r){t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n).segment("GetSharingInformation").oDataParameter("$Expand","permissionsInformation,pickerSettings").toString()}else if(r){t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n).segment("GetObjectSharingSettings").oDataParameter("$Expand","ObjectSharingInformation,SharePointSettings,SharePointSettings/PickerProperties,ObjectSharingInformation/SharedWithUsersCollection").toString();s.useSimplifiedRoles=!0;i="GetObjectSharingSettings"}else{t=this._getSharingSettingsUrl;s.useSimplifiedRoles=!0;s.objectUrl=this._sharingDataSourceHelper.getFileUrl(n);i="SP.Web.GetObjectSharingSettings"}return this.dataRequestor.getData({url:t,parseResponse:function(e){return JSON.parse(e).d},qosName:i,additionalPostData:JSON.stringify(s),method:"POST",noRedirect:!0})};t.prototype.getSettings=function(e){var t=this;return e.getRawResponse().then(function(n){return t._parseSettings(n,e.item)},function(e){return t._parseError(e)})};t.prototype.getPermissions=function(e){var t=this;return f.isFeatureEnabled(f.EnableGetSharingInformation)&&this._sharingDataSourceHelper.canUseSecurable(e.item)?e.getRawResponse().then(function(n){return t._parsePermissions(n,e.item)}):this._getPermissions(e.item).then(function(n){return t._parsePermissions(n,e.item)})};t.prototype.getBestSharingLink=function(e,t){var n=this;return e.getLinks().then(function(e){return e&&e.length>0?l.default.wrap(n._getDefaultSharingLink(e,t)):null},function(e){return null})};t.prototype.getLinks=function(e){var t=this;return e.getRawResponse().then(function(n){return t._parseLinks(n,e.item)})};t.prototype.doSharingScopesContainLinks=function(){return!1};t.prototype.mappingSharingRole=function(e){var t;switch(e){case 0:t=5;break;case 3:t=0;break;case 5:t=3;break;default:t=e}return t};t.prototype.getDataSourceName=function(){return"SharingDataDataSource"};t.prototype._getPermissions=function(e){var t,n=this,r=this._sharingDataSourceHelper.canUseSecurable(e);if(r){t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e).segment("GetObjectSharingInformation").oDataParameter("$Expand","SharedWithUsersCollection").toString()}else t=this._getPermissionsUrl;return this.dataRequestor.getData({url:t,parseResponse:function(e){return JSON.parse(e).d},qosName:"GetItemPermissions",additionalPostData:(function(){var t={excludeCurrentUser:!1,excludeSiteAdmin:!1,excludeSecurityGroups:!1,retrieveAnonymousLinks:!0,retrieveUserInfoDetails:!0,checkForAccessRequests:!0,retrievePermissionLevels:!0};r||(t.objectUrl=n._sharingDataSourceHelper.getFileUrl(e));return JSON.stringify(t)})(),method:"POST",noRedirect:!0})};t.prototype._parsePermissions=function(e,t){var n=[],r=[];if(f.isFeatureEnabled(f.EnableGetSharingInformation)&&this._sharingDataSourceHelper.canUseSecurable(t))n=this._processAllPrincipals(e,t,e.canAddExternalPrincipal||e.canAddInternalPrincipal);else{e.SharedWithUsersCollection&&e.SharedWithUsersCollection.results&&(r=e.SharedWithUsersCollection.results);n=this._processPeople(r,t,e.CanManagePermissions)}for(var i=0,s=n;i<s.length;i++){var o=s[i];2===o.entityType&&o.email&&(o.image=this._getGroupImage(o.email))}var u=0===this.mappingSharingRole(e.currentRole)&&t.type!==p.default.Folder&&t.type!==p.default.OneNote;return[{item:t,people:n,hasPendingAccessRequests:e.HasPendingAccessRequests,pendingAccessRequestsLink:e.PendingAccessRequestsLink,canUnshare:e.CanBeUnshared||u}]};t.prototype._getGroupImage=function(e){return e?r.getUserPhotoUrl({userLoginName:e}):null};t.prototype._parseError=function(e){var t={};t.sharingApiErrorMessage=e.message.value;return t};t.prototype._parseSettings=function(e,t){var n={};n.canSendEmail=e.canSendEmail;n.pickerProperties={};n.itemUrl=this._sharingDataSourceHelper.getFileUrl(t);n.networkLinksEnabled=!1;n.mailSettings={defaultCharacterLimit:500};if(f.isFeatureEnabled(f.EnableGetSharingInformation)&&this._sharingDataSourceHelper.canUseSecurable(t)){n.itemId=t.properties.ID||t.properties.uniqueId;n.itemName=t.displayName;n.canManagePermissions=0===this.mappingSharingRole(e.currentRole);n.canManageReadWriteLink=this._isLinkKindEnabled(5,e.permissionsInformation.links);n.canManageOrganizationalReadWriteLink=this._isLinkKindEnabled(3,e.permissionsInformation.links);n.canManageLinks=this._isLinkKindEnabled(5,e.permissionsInformation.links)||this._isLinkKindEnabled(3,e.permissionsInformation.links)||this._isLinkKindEnabled(4,e.permissionsInformation.links)||this._isLinkKindEnabled(2,e.permissionsInformation.links);n.canSendLink=this._isLinkKindEnabled(4,e.permissionsInformation.links)||this._isLinkKindEnabled(5,e.permissionsInformation.links);n.supportsSharingPropagation=t.type===p.default.Folder;n.anonymousLinksEnabled=this._isLinkKindEnabled(4,e.permissionsInformation.links);n.organizationLinksEnabled=this._isLinkKindEnabled(2,e.permissionsInformation.links);n.showAdditionalExternalWarning=e.showExternalSharingWarning;n.sharedWithMany=this._isSharedWithMany(e);n.hasInheritedLink=e&&e.permissionsInformation&&e.permissionsInformation.hasInheritedLinks;n.blockPeoplePickerAndSharing=e.blockPeoplePickerAndSharing;n.canCurrentUserShareExternally=e.canAddExternalPrincipal;n.defaultLinkType=e.defaultLinkKind;e.permissionsInformation&&e.permissionsInformation.principals&&e.permissionsInformation.principals.results&&(n.sharedWith=this._processAllPrincipals(e,t,n.canManagePermissions));var r=t.properties.listId||this._sharingDataSourceHelper.getParentListId(t),i=[e.webUrl],s=t.properties.ID;null!==s&&(s=t.properties.ID.toString());this._setAdvancedLink(r,i,s,n);e.pickerSettings&&this._setPickerProperties(e.pickerSettings,e.pickerSettings.PrincipalAccountType,n);var o=[],u={};u.name=m;u.value="role:1073741827";o.push(u);var a={};a.name=g;a.value="role:1073741826";o.push(a);if(f.isFeatureEnabled(f.ReviewPermissionUI)&&t.appMap&&"ms-word"===t.appMap){var l={};l.name=y;l.value="roletype:Reviewer";o.push(l)}n.sharingRoles=o;this._setAnonymousLinkExpirationInDays(e.anonymousLinkExpirationRestrictionDays,n)}else{n.itemId=e.ItemId;n.itemName=e.ItemName;n.canManagePermissions=e.ObjectSharingInformation.CanManagePermissions;n.canManageLinks=this._canManageLinks(e);n.canManageReadWriteLink=e.CanCurrentUserManageReadWriteLink;n.canManageOrganizationalReadWriteLink=e.CanCurrentUserManageOrganizationReadWriteLink;n.canSendEmail=e.CanSendEmail;n.canSendLink=e.CanSendLink;n.pickerProperties={};n.supportsSharingPropagation=e.SupportsAclPropagation;n.anonymousLinksEnabled=e.CanCurrentUserRetrieveReadonlyLink;n.organizationLinksEnabled=e.CanCurrentUserRetrieveOrganizationReadonlyLink;n.showAdditionalExternalWarning=e.ShowExternalSharingWarning;n.sharedWithMany=e.ObjectSharingInformation.IsSharedWithSecurityGroup||e.ObjectSharingInformation.IsSharedWithMany;n.blockPeoplePickerAndSharing=e.BlockPeoplePickerAndSharing;n.canCurrentUserShareExternally=e.CanCurrentUserShareExternally;n.defaultLinkType=this._getMostPermissiveLinkKind(n,e.DefaultShareLinkType);e.ObjectSharingInformation&&e.ObjectSharingInformation.SharedWithUsersCollection&&e.ObjectSharingInformation.SharedWithUsersCollection.results&&(n.sharedWith=this._processPeople(e.ObjectSharingInformation.SharedWithUsersCollection.results,t,e.CanManagePermissions));i=[e.WebUrl];this._setAdvancedLink(e.ListId,i,e.ItemId,n);e.SharePointSettings&&e.SharePointSettings.PickerProperties&&this._setPickerProperties(e.SharePointSettings.PickerProperties,e.SharePointSettings.PickerProperties.PrincipalAccountType,n);o=[];if(e.SimplifiedRoles&&e.SimplifiedRoles.results)for(var c=0;c<e.SimplifiedRoles.results.length;c++){var h={};h.name=e.SimplifiedRoles.results[c].Key;h.value=e.SimplifiedRoles.results[c].Value;o.push(h)}n.sharingRoles=o;this._setAnonymousLinkExpirationInDays(e.RequiredAnonymousLinkExpirationInDays,n)}n.showAdvanced=n.canManagePermissions;return n};t.prototype._setAnonymousLinkExpirationInDays=function(e,t){var n=parseInt(e,10);t.requiredAnonymousLinkExpirationInDays=NaN!==n?n:0};t.prototype._setPickerProperties=function(e,t,n){n.pickerProperties=e;n.pickerProperties.PrincipalAccountType=this._convertPrincipalType(t)};t.prototype._setAdvancedLink=function(e,t,n,r){t.push("/_layouts/15/user.aspx");t.push("?List="+h.default.encodeURIComponent(e));e&&t.push("&obj=",h.default.encodeURIComponent(e),",",h.default.encodeURIComponent(n),",LISTITEM");if(Number(this._pageContext.webTemplate)===s.default.group){t.push("&noredirect=true");r.advancedUrlOpenInPlace=!0}r.advancedUrl=t.join("")};t.prototype._getMostPermissiveLinkKind=function(e,t){var n=t,r=3===(n=0===n?5:n)||2===n;if(5===n||4===n){if(e.anonymousLinksEnabled&&e.canManageReadWriteLink)return n;if(e.organizationLinksEnabled&&e.canManageOrganizationalReadWriteLink)return 3}else if(r&&e.organizationLinksEnabled&&e.canManageOrganizationalReadWriteLink)return n;return 1};t.prototype._parseLinks=function(e,t){var n=this,r=[];if(f.isFeatureEnabled(f.EnableGetSharingInformation)){if(e.permissionsInformation&&e.permissionsInformation.links){[{linkDetails:{Url:e.directUrl,IsActive:!0,LinkKind:1}}].concat(e.permissionsInformation.links.results).forEach(function(e){if(!e.isInherited){var i=n._initSharingLinkFromServerData(e.linkDetails);i.item=t;i.isInherited=e.isInherited;i.linkMembers=n._convertPrincipalToPeople(e.linkMembers);i.shareId=e.linkDetails?e.linkDetails.ShareId:"";i.kind=e.linkDetails?e.linkDetails.LinkKind:0;i.linkInvitees=n._getLinkInvitees(e.linkDetails);r.push(i)}});var i=e.canAddExternalPrincipal||e.canAddInternalPrincipal;r=r.filter(function(e){return!!((2!==n.mappingSharingRole(e.role)||i)&&(1!==n.mappingSharingRole(e.role)||i)||e.url&&e.isActive)&&(!!(i||e.url&&e.isActive)&&!(1===n.mappingSharingRole(e.role)&&5===e.type&&!i||2===n.mappingSharingRole(e.role)&&6===e.type&&!i))})}}else if(e.ObjectSharingInformation&&e.ObjectSharingInformation.SharingLinks){e.ObjectSharingInformation.SharingLinks.results.forEach(function(e){var i=n._initSharingLinkFromServerData(e);i.item=t;r.push(i)});var s=this._canManageLinks(e);r=r.filter(function(t){return!!((2!==t.role||e.CanCurrentUserManageReadWriteLink||e.CanCurrentUserManageOrganizationReadWriteLink)&&(1!==t.role||e.CanCurrentUserManageReadonlyLink||e.CanCurrentUserManageOrganizationReadonlyLink)||t.url&&t.isActive)&&(!!(s||t.url&&t.isActive)&&!(1===t.role&&5===t.type&&!e.CanCurrentUserRetrieveReadonlyLink||2===t.role&&6===t.type&&!e.CanCurrentUserRetrieveReadWriteLink))})}return r};t.prototype._getLinkInvitees=function(e){var t=this,n=e.Invitations;if(!n)return[];for(var r=[],i=0,s=n.results;i<s.length;i++){var o=s[i];r.push(o.invitee)}return r.map(function(e){return{userId:e.userId,name:e.name,email:e.email,image:t._getGroupImage(e.email),isExternal:e.isExternal}})};t.prototype._processPeople=function(e,t,n){var r=this;return e.map(function(e){var t={userId:e.LoginName,name:e.Name,email:e.Email,job:e.JobTitle,department:e.Department,image:e.Picture,sip:e.SipAddress,isExternal:e.isExternal};0===t.image.length&&(t.image=r._placeholderImage);var i={};if(e.IsSiteAdmin)i.role=0;else if(void 0!==e.CustomRoleNames&&""!==e.CustomRoleNames){i.role=7;i.customRole=e.CustomRoleNames}else e.HasEditPermission?i.role=2:e.HasViewPermission&&(i.role=1);i.isChangeable=n;t.sharingInfo=i;e.IsDomainGroup?t.entityType=2:e.IsExternalUser&&(t.entityType=1);return t})};t.prototype._getAllSharedUsers=function(e){for(var t=e.permissionsInformation.siteAdmins.results,n=e.permissionsInformation.principals.results,r={},i=0,s=t;i<s.length;i++){r[(a=s[i]).principal.loginName]=!0}for(var o=0,u=n;o<u.length;o++){var a;r[(a=u[o]).principal.loginName]||t.push(a)}return t};t.prototype._processAllPrincipals=function(e,t,n){var r=this;return this._getAllSharedUsers(e).map(function(e){var t=e.principal,s={userId:t.loginName,name:t.name,email:t.email,job:t.jobTitle,image:r._getGroupImage(t.email),principalType:t.principalType,isExternal:t.isExternal},o={};o.role=r.mappingSharingRole(e.role);o.isChangeable=n;s.sharingInfo=o;t.principalType===i.default.securityGroup||t.principalType===i.default.sharePointGroup?s.entityType=2:t.isExternal&&(s.entityType=1);return s})};t.prototype._convertPrincipalType=function(e){if(!e)return 0;for(var t=0,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i?t|=1:"DL"===i?t|=2:"SecGroup"===i?t|=4:"SPGroup"===i&&(t|=8)}return t};t.prototype._convertPrincipalToPeople=function(e){var t=this;return(e&&e.results||[]).map(function(e){return{userId:e.loginName,name:e.name,email:e.email,job:e.jobTitle,image:t._getGroupImage(e.email)}})};t.prototype._initSharingLinkFromServerData=function(e){if(!e)return null;var t={};switch(e.LinkKind){case 1:t={type:8,role:5,displayPriority:0,tag:"Direct",supportsExpiration:!1};break;case 2:t={type:9,role:1,displayPriority:1,tag:"OrganizationView",supportsExpiration:!1,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case 3:t={type:9,role:2,displayPriority:2,tag:"OrganizationEdit",supportsExpiration:!1,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case 4:t={type:5,role:1,displayPriority:3,tag:"AnonymousView",supportsExpiration:!0,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case 5:t={type:6,role:2,displayPriority:4,tag:"AnonymousEdit",supportsExpiration:!0,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case 6:t={type:6,role:e.IsEditLink?2:e.IsReviewLink?6:1,displayPriority:5,tag:"Flexible",supportsExpiration:!0,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case 0:default:t={}}t.audience=this._getSharingLinkAudience(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);return n.__assign({role:5,url:f.isFeatureEnabled(f.EnableGetSharingInformation)?e.Url:this._sharingDataSourceHelper.encodeSharingLink(e.Url),isActive:e.IsActive,expiration:t.supportsExpiration?this._sharingDataSourceHelper.getExpirationFromSharingLinkInfo(e.Expiration):null},t)};t.prototype._getSharingLinkAudience=function(e,t,n){return 5===e||4===e?v.default.anyone:3===e||2===e?v.default.organization:1===e?v.default.specificPeople:6===e?t?v.default.anyone:!1===n?v.default.organization:v.default.specificPeopleFlex:void 0};t.prototype._getDefaultSharingLink=function(e,t){if(!e||e.length<1)return null;var n,r,i;if(1===t){r=8;i=5}else if(2===t){r=9;i=1}else if(3===t){r=9;i=2}else if(4===t){r=5;i=1}else if(5===t){r=6;i=2}for(var s=0,o=e;s<o.length;s++){var u=o[s];8===u.type&&(n=u);if(u.type===r&&u.role===i)return u}return n};t.prototype._isLinkKindEnabled=function(e,t){return t.results.some(function(t){return t.linkDetails.LinkKind===e})};t.prototype._canManageLinks=function(e){return e.CanCurrentUserManageReadWriteLink||e.CanCurrentUserManageOrganizationReadWriteLink||e.CanCurrentUserManageReadonlyLink||e.CanCurrentUserManageOrganizationReadonlyLink};t.prototype._isSharedWithMany=function(e){if(this._getAllSharedUsers(e).length>30)return!0;for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r.principal.principalType===i.default.securityGroup||r.principal.principalType===i.default.sharePointGroup)return!0}return!1};return t})(a.default);t.default=b});
define("rit",["require","exports","ww","FS","Aq","LZ","fB","y9","wq","Ex","A","_$","h$","oP","uv","g","zi","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._apiUrlHelper=n.resources.consume(i.resourceKey);n._itemParentHelper=n.resources.consume(a.resourceKey);n._sharingDataSourceHelper=new(n.managed(c.default));n._sharingContextInformation=n.resources.consume(v.sharingContextInformation.optional);var r=n._askParentForAuthToken,s=n._sharingContextInformation;n._sharingDataSourceCommon=new p.SharingDataSource({pageContext:t,getParentListId:n._getParentListId.bind(n),apiUrlHelper:n._apiUrlHelper,sharingContextInformation:s,isItemUrlEncoded:!0},{tokenProvider:!g.default.isActivated("9ae8d943-f979-46ac-9ffc-0d301b739437","7/17/2020","LLT/SSM support in sharing iframe")&&s&&s.hasTokenProvider?{getAuthToken:function(e){return r(e).then(function(e){s.authToken=e;return e})}}:void 0,pageContext:t});var o=u.getSafeWebServerRelativeUrl(n._pageContext);n._createAnonymousLinkMethodName="CreateAnonymousLink";n._createAnonymousLinkUrl=o+"/_api/SP.Web."+n._createAnonymousLinkMethodName;n._createAnonymousLinkWithExpirationMethodName="CreateAnonymousLinkWithExpiration";n._createAnonymousLinkWithExpirationUrl=o+"/_api/SP.Web."+n._createAnonymousLinkWithExpirationMethodName;n._createOrganizationLinkMethodName="CreateOrganizationSharingLink";n._createOrganizationLinkUrl=o+"/_api/SP.Web."+n._createOrganizationLinkMethodName;n._disableAnonymousLinkMethodName="DeleteAnonymousLinkForObject";n._disableAnonymousLinkUrl=o+"/_api/SP.Web."+n._disableAnonymousLinkMethodName;n._disableOrganizationLinkMethodName="DestroyOrganizationSharingLink";n._disableOrganizationLinkUrl=o+"/_api/SP.Web."+n._disableOrganizationLinkMethodName;n._managePermissionsUrl=o+"/_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo";n._unshareUrl=o+"/_api/SP.Web.UnshareObject";return n}t.prototype.getSharingInformation=function(e,t,n,r,i,s){if(r){var o=r.method("Lists",this._getParentListId(h.convertToISPListItem(e))).method("GetItemById",i);return this._sharingDataSourceCommon.getSharingInformation(h.convertToISPListItem(e),t,n,o,s)}return this._sharingDataSourceCommon.getSharingInformation(h.convertToISPListItem(e),t,n,null,s)};t.prototype.getShareLinkApi=function(e,t,n){return t.method("Lists",this._getParentListId(h.convertToISPListItem(e))).method("GetItemById",n).segment("ShareLink")};t.prototype.emailWithoutPermissioning=function(e,t,n){return this._sharingDataSourceCommon.emailWithoutPermissioning(e,h.convertToISPListItem(t),n)};t.prototype.checkPermissions=function(e,t){return this._sharingDataSourceCommon.checkPermissions(e,h.convertToISPListItem(t))};t.prototype.share=function(e,t){var n={items:t.items.map(function(e){return h.convertToISPListItem(e)}),roleValue:t.roleValue,message:t.message,subject:t.subject,sendEmail:t.sendEmail,requireSignIn:t.requireSignIn,propagateSharing:t.propagateSharing,linkType:t.linkType,expiration:t.expiration};return this._sharingDataSourceCommon.share(e,n)};t.prototype.unshare=function(e){var t,n=this,r=this._sharingDataSourceHelper.canUseSecurable(e);if(r){t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e).segment("UnshareObject").toString()}else t=this._unshareUrl;return this.dataRequestor.getData({url:t,parseResponse:function(t){var n=JSON.parse(t).d,r={};r.statusCode=n.StatusCode;r.errorMessage=n.ErrorMessage;r.itemId=e.id;return r},qosName:"StopSharing",additionalPostData:(function(){var t={};r||(t.url=n._sharingDataSourceHelper.getFileUrl(e));return JSON.stringify(t)})()})};t.prototype.updatePermissions=function(e,t,n){var r,i=this,s=this._sharingDataSourceHelper.canUseSecurable(t);if(s){r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t).segment("UpdateDocumentSharingInfo").toString()}else r=this._managePermissionsUrl;return this.dataRequestor.getData({url:r,parseResponse:function(e){var n=JSON.parse(e).d,r=[];n.UpdateDocumentSharingInfo&&n.UpdateDocumentSharingInfo.results&&(r=n.UpdateDocumentSharingInfo.results);var i={statusCode:0,errorMessage:null};i.people=p.SharingDataSource.parsePeople(r);i.itemId=t.id;return i},qosName:"ManagePermissions",additionalPostData:(function(){var r,u=[];switch(n){case 5:r=0;break;case 1:r=1;break;case 6:r=6;break;case 2:r=2;break;default:r=1}for(var a=0;a<e.length;a++){var l={UserId:e[a].userId,Role:r};u.push(l)}var c={userRoleAssignments:u,validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:t.type===f.default.Folder&&o.isFeatureEnabled(o.RecursiveUnsharing)};s||(c.resourceAddress=i._sharingDataSourceHelper.getFileUrl(t));return JSON.stringify(c)})()})};t.prototype.updatePermissions2=function(e,t,n){return this._sharingDataSourceCommon.updatePermissions2(e,h.convertToISPListItem(t),n)};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){return this._sharingDataSourceCommon.updatePermissionsMultiple(e,h.convertToISPListItem(t),n,r,i)};t.prototype.parseRawSharingInformation=function(e){return this._sharingDataSourceCommon.parseRawSharingInformation(e)};t.prototype.setAddressBarLinkCapability=function(e,t){return this._sharingDataSourceCommon.setAddressBarLinkCapability(h.convertToISPListItem(e),t)};t.prototype.manageSharingLinks=function(e,t){var n=this,i=this._createAnonymousLinkUrl,s="CreateAnonymousSharingLink",o=this._createAnonymousLinkMethodName;if(this._sharingDataSourceHelper.canUseSecurable(e[0].item)){var u={items:[e[0].item],expiration:t.expiration,linkType:t.type,roleValue:t.role.toString()};return(t.create?this._getSharingLink.bind(this):this._deleteSharingLink.bind(this))(u,e[0],t.role)}if(t.expiration){i=this._createAnonymousLinkWithExpirationUrl;s="CreateAnonymousSharingLinkWithExpiration";o=this._createAnonymousLinkWithExpirationMethodName}if(!t.create){i=this._disableAnonymousLinkUrl;s="DisableAnonymousSharingLink";o=this._disableAnonymousLinkMethodName}if(9===t.type){i=t.create?this._createOrganizationLinkUrl:this._disableOrganizationLinkUrl;s=t.create?"CreateOrganizationSharingLink":"DisableOrganizationSharingLink";o=t.create?this._createOrganizationLinkMethodName:this._disableOrganizationLinkMethodName}return this.dataRequestor.getData({url:i,parseResponse:function(r){var i=JSON.parse(r).d,s=[],u={};u.url=i[o]?n._sharingDataSourceHelper.encodeSharingLink(i[o]):"";u.type=t.type;u.role=t.role;u.expiration=n._sharingDataSourceHelper.getExpirationFromLink(u.url);u.isActive=!!u.url;e[0].setLink(u);i[o]&&s.push(u);return s},qosName:s,additionalPostData:(function(){var i={url:n._sharingDataSourceHelper.getFileUrl(e[0].item),isEditLink:2===t.role};t.expiration&&(i.expirationString=r.convertDateToISOString(t.expiration));return JSON.stringify(i)})()})};t.prototype.unshareLink=function(e){var t={item:h.convertToISPListItem(e.item),kind:e.kind,shareId:e.shareId};return this._sharingDataSourceCommon.unshareLink(t)};t.prototype.shareLink=function(e){var t={emailData:e.emailData,emailSubject:e.emailSubject,items:e.items.map(function(e){return h.convertToISPListItem(e)}),recipients:e.recipients,settings:e.settings};return this._sharingDataSourceCommon.shareLink(t)};t.prototype.supportsExistingAccessOption=function(e){var t=!0;if(e){var n=this._getRootItem(e,"list");n&&(t=n.list.templateType===m.default.mySiteDocumentLibrary)}var r=Number(this._pageContext.webTemplate);return r===d.default.teamSite||r===d.default.group||!t};t.prototype.getClientId=function(){return this._sharingDataSourceCommon.getClientId()};t.prototype.getDataSourceName=function(){return"SharingDataSource"};t.prototype._deleteSharingLink=function(e,t,n){var r,i=this,s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0]).segment("DeleteLinkByKind").toString();return this.dataRequestor.getData({url:s,parseResponse:function(r){var s=JSON.parse(r).d,o=[],u={};u.url=s.DeleteLinkByKind?i._sharingDataSourceHelper.encodeSharingLink(s.DeleteLinkByKind.sharingLinkInfo.Url):"";u.type=e.linkType;u.role=n;u.expiration=i._sharingDataSourceHelper.getExpirationFromLink(u.url);u.isActive=!!u.url;t.setLink(u);s.DeleteLinkByKind&&o.push(u);return o},qosName:"DeleteLinkByKind",additionalPostData:(r={linkKind:i._getSharingLinkKind(e.linkType,e.roleValue)},JSON.stringify(r))})};t.prototype._getSharingLink=function(e,t,n){var i=this,s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0]).segment("ShareLink").toString();return this.dataRequestor.getData({url:s,parseResponse:function(r){var s=JSON.parse(r).d,o=[],u={};u.url=s.ShareLink?i._sharingDataSourceHelper.encodeSharingLink(s.ShareLink.sharingLinkInfo.Url):"";u.type=e.linkType;u.role=n;u.expiration=i._sharingDataSourceHelper.getExpirationFromLink(u.url);u.isActive=!!u.url;t.setLink(u);s.ShareLink&&o.push(u);return o},qosName:"GetLinkViaShareLink",additionalPostData:(function(){var t=null;e.expiration&&(t=r.convertDateToISOString(e.expiration));var n={request:{emailData:null,linkKind:i._getSharingLinkKind(e.linkType,e.roleValue),createLink:!0,expiration:t}};return JSON.stringify(n)})()})};t.prototype._getSharingLinkKind=function(e,t){var n=1;6===e?n=5:5===e?n=4:9===e&&(n=t===2..toString()?3:2);return n};t.prototype._getRootItem=function(e,t){var n=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,t));return n||null};t.prototype._getParentListId=function(e){var t=h.convertToIOneDriveItem(e);return this._sharingDataSourceHelper.getParentListId(t)};t.prototype._askParentForAuthToken=function(e){return new l.default(function(t,r){var i=function(e){if(e.data&&"string"==typeof e.data){var n;try{n=JSON.parse(e.data)}catch(e){return}var s=!1;switch(n.name){case"share_newToken":s=!0;var o=n;if(o.error){r(o.error);break}if(!o.token){r("invalid_token");break}t(o.token)}s&&window.removeEventListener("message",i)}};window.addEventListener("message",i,!1);var s=n.__assign(n.__assign({},e),{name:"share_getToken"});window.parent.postMessage(JSON.stringify(s),"*")})};return t})(s.default);t.default=y});
define("_$",["require","exports","ww","g","tB","wq","D7","sP","h$","Yy","Be","fB"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemParentHelper=n.resources.consume(s.resourceKey);n._itemUrlHelper=n.resources.consume(o.resourceKey);n._sharingContextInformation=n.resources.consume(r.sharingContextInformation.optional);n._sharingDataSourceHelperCommon=new u.default({itemUrlHelper:n._itemUrlHelper,sharingContextInformation:n._sharingContextInformation});return n}t.prototype.encodeSharingLink=function(e){if(!e)return e;var t=e.split("?");return f.encodePath(t[0],!0)+(t[1]?"?"+t[1]:"")};t.prototype.getApiRoot=function(e,t){var n=this.getParentListId(t);c.isFeatureEnabled(c.ShareControlListSharingUI)&&this._sharingContextInformation&&t.isRootFolder&&(this._sharingContextInformation.isListSharing=!0);return this._sharingDataSourceHelperCommon.getApiRoot(e,a.convertToISPListItem(t),n)};t.prototype.getExpirationFromLink=function(e){if(e&&e.indexOf("expiration=")>-1){var t=new l.default(e).getQueryParameter("expiration");t.indexOf("Z")!==t.length-1&&(t=t.replace(/\+/g," ")+" UTC");var n=Date.parse(t);if(n)return new Date(n).toString()}return null};t.prototype.getExpirationFromSharingLinkInfo=function(e){return""!==e?e:null};t.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};t.prototype.getParentListId=function(e){var t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return t?t.list.id:e&&e.properties?e.properties.listId:null};t.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(c.isFeatureEnabled(c.ShareControlListSharingUI)&&e.isRootFolder?!!e.list&&!!e.list.id:!!t.ID||!!t.uniqueId)};return t})(i.default);t.default=h});
define("Bie",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey(e("module").id)});
define("hit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["GAe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Q2",["require","exports","ww","v","Je"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var s=i.default.isActivated("723526D9-B1A5-4ADC-81B1-B7D1B4934EBB","9/23/2020","Workaround for loading sp-http in AMD builds");t.resourceKey=new r.ResourceKey({name:e("module").id,loader:new r.AliasResourceLoader(function(){var t;if("undefined"==typeof __webpack_public_path__&&!s){window.spScriptNamePattern="sp-webpack";window.__setWebpackPublicPathLoaderSrcRegistry__=n.__assign(n.__assign({},window.__setWebpackPublicPathLoaderSrcRegistry__||{}),((t={})[""+window.require.toUrl("chunks/"+window.spScriptNamePattern)]=!0,t))}return new Promise(function(t,n){e(["_Ae"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Tit",["require","exports","ww","A","tB","v","eQ"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var u=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._vroomDataRequestor=n.vroomDataRequestor;return r}t.prototype.getSubscriptions=function(e,t){var n=this;return e.itemId?this._vroomDataRequestor.send({apiName:t?t+"subscriptions":"subscriptions",path:"/drive/items/"+e.itemId+"/subscriptions"}).then(function(e){return e.value.map(function(e){return n._translateToSubscriptionModel(e)})}):r.default.wrap([])};t.prototype.updateSubscription=function(e){var t=this,n=new Date;n.setMonth(n.getMonth()+1);var r={notificationUrl:"ActivityService://activity",expirationDateTime:n.toISOString(),scenarios:["FollowAFile"],muted:!e.isOn};return this._vroomDataRequestor.send({apiName:e.apiNamePrefix?e.apiNamePrefix+"subscriptions":"subscriptions",path:"/drives/"+e.item.ownerId+"/items/"+e.item.itemId+"/subscriptions",requestType:"POST",postData:JSON.stringify(r)}).then(function(e){return t._translateToSubscriptionModel(e)})};t.prototype.getRootSubscriptions=function(){var e=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0}).then(function(t){return t.value.map(function(t){return e._translateToSubscriptionModel(t)})})};t.prototype.createRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0,requestType:"POST",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})};t.prototype.updateRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions/"+e.id,useAuthorizationHeaders:!0,requestType:"PATCH",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})};t.prototype.deleteRootSubscription=function(e){return this._vroomDataRequestor.send({apiName:"deleteSubscription",requestType:"DELETE",path:"/drive/root/subscriptions/"+e.id,useAuthorizationHeaders:!0})};t.prototype._translateToSubscriptionModel=function(e){if(!e)return null;var t={id:e.id,muted:e.muted,expirationDateTime:e.expirationDateTime,notificationUrl:e.notificationUrl,resource:e.resource,scenarios:e.scenarios};e.createdBy&&e.createdBy.user&&(t.createdBy={user:{id:e.createdBy.user.id}});return t};t.prototype._getPostData=function(e){var t={notificationUrl:e.notificationUrl};if(e.expirationDateTime)t.expirationDateTime=e.expirationDateTime.toISOString();else{if(!e.expiresAfterDuration)throw new Error("Invalid expiration time");t.expiresAfterDuration=e.expiresAfterDuration}return t};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{vroomDataRequestor:o.resourceKey});return t})(i.default);t.default=u;t.resourceKey=s.createResolvedResourceKey(e("module").id,u)});
define("XN",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.suiteNavRendered=t.sharepointUrl=t.isTenantAdmin=void 0;t.isTenantAdmin=new n.ResourceKey("app.admin");t.sharepointUrl=new n.ResourceKey("app.spourl");t.suiteNavRendered=new n.ResourceKey("app.suitenavrendered")});
define("Kz",["require","exports","qN","g","v"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=void 0;t.typeResourceKey=i.createResolvedTypeResourceKey(e("module").id,n.SuiteNavDataSource,{pageContext:r.pageContext})});
define("YN",["require","exports","ww","pB","QO","qN","y9","v","g","zi","ey","Je","uv","fB","dv","bv","LO","ZN","XN","gy","JN","C2"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.SuiteNavDataUpdater=void 0;var S=(function(){function t(e,t){this._resources=t.resources;this._pageContext=this._resources?this._resources.consume(a.pageContext):t.pageContext}t.prototype.updateSuiteNavData=function(t){var s=this,u=n.__assign({},t.suiteNavData);this._suiteNavContext=t.suiteNavContext;var f=this._pageContext.isSPO;this._isODB=Number(this._pageContext.webTemplate)===h.default.mySite;u.CurrentMainLinkElementID=this._suiteNavContext.currentMainLinkElementID||this._suiteNavContext.workloadId;u.ActionsMap={};var l=this._resources?this._resources.consume(y.isTenantAdmin.optional):void 0;l&&l(!!u.AdminLink);var p=this._resources?this._resources.consume(y.sharepointUrl.optional):void 0;if(p)for(var d=0,b=n.__spreadArrays(u.AppsLinks||[],u.WorkloadLinks||[]);d<b.length;d++){var w=b[d];if("ShellSites"===w.Id){p(w.Url);break}}if(f&&this._pageContext.isAnonymousGuestUser)try{var S={Text:this._pageContext.userDisplayName||u.UserDisplayName||"",Url:null},x=JSON.parse(u.ClientData);x.SignInLink=S;u.ClientData=JSON.stringify(x);u.SignOutLink=null;u.AboutMeLink=null;u.IsAuthenticated=!1;u.O365SettingsLink=null;u.UserDisplayName=null}catch(e){}else{u.ActionsMap[i.SUITE_NAV_LINK_IDS.SIGN_OUT]=function(){v.Engagement.logData({name:"SuiteNav.SignOut.Click"});try{delete localStorage["onedrive.autoredirect"]}catch(e){}return!0};if(f&&this._pageContext.isEmailAuthenticationGuestUser){u.CurrentWorkloadSettingsSubLinks=null;u.LogoNavigationUrl=null}else u.CurrentWorkloadSettingsSubLinks=this._getSettingsLinks();if(this._isSiteInformationLinkEnabled()){u.ActionsMap[i.SUITE_NAV_LINK_IDS.SITE_INFORMATION]=function(e){var t=e.resources.consume(m.actionMap);new(e.resources.injected(t.LaunchSiteSettingsPanelAction))({}).execute(null);return!1};!c.default.isActivated("2781b0f8-8acd-4fa2-9d9b-66f250bfbc27","10/31/2019","Global function for HubsBasic TAB")&&window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchSiteSettings=function(){var e=s._resources.consume(m.actionMap);new(s._resources.injected(e.LaunchSiteSettingsPanelAction))({}).execute(null)})}if(this._isHubSettingsLinkEnabled()){u.ActionsMap[i.SUITE_NAV_LINK_IDS.HUB_SETTINGS]=function(e){var t=e.resources.consume(m.actionMap);new(e.resources.injected(t.LaunchHubSettingsPanelAction))({}).execute(null);return!1};!c.default.isActivated("2781b0f8-8acd-4fa2-9d9b-66f250bfbc27","10/31/2019","Global function for HubsBasic TAB")&&this._pageContext.isHubSite&&window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchHubSettings=function(){var e=s._resources.consume(m.actionMap);new(s._resources.injected(e.LaunchHubSettingsPanelAction))({}).execute(null)})}this._isChangeTheLookLinkEnabled()&&(u.ActionsMap[i.SUITE_NAV_LINK_IDS.CHANGE_THE_LOOK]=function(e){var t=e.resources.consume(m.actionMap);new(e.resources.injected(t.LaunchChangeTheLookPanelAction))({}).execute(null);return!1});this._isSitePermissionsLinkEnabled()&&(u.ActionsMap[i.SUITE_NAV_LINK_IDS.SITE_PERMISSIONS]=function(e){var t=e.resources.consume(m.actionMap);new(e.resources.injected(t.LaunchSitePermissionsPanelAction))({}).execute(null);return!1});if(this._isSiteDesignsLinkEnabled())if(c.default.isActivated("C3CDEA35-BD3B-404E-93E5-D0E7E1ACACDF","01/31/2019","SiteScriptPanel test should not depend on suitenav"))u.ActionsMap[i.SUITE_NAV_LINK_IDS.SITE_DESIGNS]=function(t){Promise.resolve(new Promise(function(t,n){e(["ode"],t,n)})).then(E.getDefaultExport).then(function(e){e.SiteScriptProgressStateManager.getInstance({pageContext:t.resources.consume(a.pageContext)}).triggerOpenPanelAction()});return!1};else{var T=function(){Promise.resolve(new Promise(function(t,n){e(["ode"],t,n)})).then(E.getDefaultExport).then(function(e){e.SiteScriptProgressStateManager.getInstance({pageContext:s._pageContext}).triggerOpenPanelAction()})};u.ActionsMap[i.SUITE_NAV_LINK_IDS.SITE_DESIGNS]=function(e){T();return!1};window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchSiteDesignProgress=T)}this._shouldShowGroupifyLink()&&(u.ActionsMap.Groupify=function(e){var t=e.resources.consume(m.actionMap);new(e.resources.injected(t.LaunchGroupifyPanelAction))({}).execute(null);return!1});this._isGlobalNavSettingsPanelEnabled()&&(u.ActionsMap.GLOBALNAV_SETTINGS_SUITENAVID=function(e){var t=e.resources.consume(m.actionMap);new(e.resources.injected(t.LaunchGlobalNavSettingsPanelAction))({}).execute(null);return!1});if(this._isWebTemplatesGalleryEnabled()){u.ActionsMap.SuiteMenu_MenuItem_WebTempaltesGallery=function(e){var t=e.resources.consume(m.actionMap),n=new(e.resources.injected(t.LaunchWebTemplatesGalleryAction))({});v.Engagement.logData({name:"SiteTemplates.Panel.Click​"});n.execute(null);return!1};window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchWebTemplatesGallery=function(){var e=s._resources.consume(m.actionMap);new(s._resources.injected(e.LaunchWebTemplatesGalleryAction))({}).execute(null)})}if(u.SignOutLink||!f){u.SignOutLink.Url=o.getSafeWebServerRelativeUrl(this._pageContext)+"/_layouts/15/SignOut.aspx";u.SignOutLink.Text||(u.SignOutLink.Text=r.default.SignOut)}u.UserDisplayName=this._pageContext.userDisplayName||u.UserDisplayName||this._pageContext.webTitle||null}u.FeedbackLink=null;if(this._suiteNavContext.firstRunScenarioType){u.CurrentWorkloadHelpSubLinks=[{Id:i.SUITE_NAV_LINK_IDS.FIRSTRUN,Text:r.default.ShowFirstRun,Url:"#"}];u.ActionsMap[i.SUITE_NAV_LINK_IDS.FIRSTRUN]=function(e){new(e.resources.injected(g.default))({}).execute(null);return!1}}if(!f){u.StringsOverride=u.StringsOverride||{};u.StringsOverride.l_ShellCore_O365_Text="SharePoint"}this._suiteNavContext.helpNamespace&&this._suiteNavContext.helpId?u.HelpLink.Url="https://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?p1="+this._suiteNavContext.helpNamespace+"&clid="+this._pageContext.currentLanguage+"&ver="+(f?"16":"19")+"&HelpId="+this._suiteNavContext.helpId:u.HelpLink.Url="https://support.microsoft.com";if(!f){if(u.HelpLink){var N=this._suiteNavContext.helpIdOnPrem||"WSSEndUser",C=this._pageContext.currentLanguage;u.HelpLink.Url="https://support.office.com/client/results?helpid="+N+"&NS=WSSEndUser&lcid="+C+"&SYSLCID="+C+"&UILCID="+C+"&Version=19"}u.ActionsMap[i.SUITE_NAV_LINK_IDS.HELP]=function(){var e=window.open("","_blank","resizable=1,location=0,width=400,height=500");e.opener=null;e.location.href=u.HelpLink.Url;return!1}}u.HelpLink.Text||(u.HelpLink.Text=r.default.Help);var k=Number(this._pageContext.webTemplate),L=k===h.default.mySite||k===h.default.mySiteHost;u.UseSPOBehaviors=!L;return u};t.prototype._getSettingsLinks=function(){var e=this._pageContext.webAbsoluteUrl,t=!c.default.isActivated("14B5B459-D1FD-44F9-8BDB-1500644ED3C5","07/05/2019","Use isDocLib API")&&this._pageContext.listBaseType?f.isDocLib(this._pageContext.listBaseType):f.isDocumentLibrary(this._pageContext.listBaseTemplate),n=f.ListTemplateType.documentLibrary===Number(this._pageContext.listBaseTemplate),o={Id:i.SUITE_NAV_LINK_IDS.LIBRARY_SETTINGS,Text:t?r.default.LibrarySettings:r.default.ListSettings,Url:e+"/_layouts/15/listedit.aspx?List="+encodeURIComponent(this._pageContext.listId),Hidden:!this._pageContext.listId,IsMySiteSettingLink:!1,ListPermissions:[l.PermissionMask.manageLists]},u=[];if(this._suiteNavContext.currentMainLinkElementID===i.SUITE_NAV_LINK_IDS.LISTS){d.isWebViewHostedList(this._pageContext)&&u.push(o);return u}if(this._suiteNavContext.showMySiteSettings||this._suiteNavContext.showTrimmedSettings){var a=this._pageContext.listPermsMask||l.PermissionMask.fullMask,h=this._pageContext.webPermMasks,v=!1,m=this._pageContext.MenuData&&this._pageContext.MenuData.SettingsData;if(m&&!this._isODB){for(var g=this._suiteNavContext.showTrimmedSettings&&!o.Hidden&&l.PermissionMask.hasAny(a,o.ListPermissions),y=function(e){return{Id:e.Id,Text:e.Text,Url:e.Url}},b=0,w=m;b<w.length;b++){var E=w[b];if(E){if(v){u.push(null);v=!1}if(E.Id===o.Id)g=!1;else if(g&&E.Id===i.SUITE_NAV_LINK_IDS.SITE_SETTINGS){u.push(y(o));g=!1}u.push(y(E))}else v=!0}g&&u.push(y(o));p.isFeatureEnabled(p.ShowSharepointRestoreLink)&&this._pageContext.isSiteAdmin&&n&&u.push(y({Id:"Document_Library_Restore",Text:r.default.RestoreDocLib,Url:"?p=18"}))}else for(var S=0,x=[{Id:i.SUITE_NAV_LINK_IDS.ADD_APP,Text:r.default.AddAnApp,Url:e+"/_layouts/15/addanapp.aspx",IsMySiteSettingLink:!0,WebPermissions:[l.PermissionMask.manageLists,l.PermissionMask.manageSubwebs],Hidden:this._isODB},{Id:i.SUITE_NAV_LINK_IDS.SITE_CONTENTS,Text:r.default.SiteContents,Url:e+"/_layouts/15/viewlsts.aspx",IsMySiteSettingLink:!0,WebPermissions:[l.PermissionMask.viewFormPages],Hidden:this._isODB},null,o,{Id:i.SUITE_NAV_LINK_IDS.SITE_SETTINGS,Text:r.default.SiteSettings,Url:e+"/_layouts/15/settings.aspx",IsMySiteSettingLink:!0,WebPermissions:s.SuiteNavDataSource.siteSettingsPermissions.concat(),Hidden:this._isODB}];S<x.length;S++){var T=x[S];v=v||!T;if(T&&!T.Hidden){if(this._suiteNavContext.showMySiteSettings?T.IsMySiteSettingLink:l.PermissionMask.hasAny(h,T.WebPermissions)||l.PermissionMask.hasAny(a,T.ListPermissions)){if(v){u.push(null);v=!1}u.push({Id:T.Id,Text:T.Text,Url:T.Url})}}}}this._isGlobalNavSettingsPanelEnabled()&&u.push({Id:"GLOBALNAV_SETTINGS_SUITENAVID",Text:r.default.GlobalNavSettingsPanel,Url:"#"});this._isHubSettingsLinkEnabled()&&u.push({Id:i.SUITE_NAV_LINK_IDS.HUB_SETTINGS,Text:r.default.HubSettings,Url:"#"});this._isSiteInformationLinkEnabled()&&(u=u.filter(function(e){return!e||e.Id!==i.SUITE_NAV_LINK_IDS.SITE_SETTINGS})).push({Id:i.SUITE_NAV_LINK_IDS.SITE_INFORMATION,Text:r.default.SiteInformation,Url:"#"});this._isSitePermissionsLinkEnabled()&&u.push({Id:i.SUITE_NAV_LINK_IDS.SITE_PERMISSIONS,Text:r.default.SitePermissions,Url:"#"});this._isWebTemplatesGalleryEnabled()&&u.push({Id:"SuiteMenu_MenuItem_WebTempaltesGallery",Text:r.default.SiteTemplatesGallery,Url:"#"});if(this._isODB&&this._pageContext.isSiteAdmin){p.isFeatureEnabled(p.OneDriveSettings)&&u.push({Id:"OneDrive_Settings",Text:r.default.OneDriveSettings,Url:e+"/_layouts/15/onedrive.aspx?p=22"});u.push({Id:"OneDrive_Restore",Text:r.default.RestoreOneDrive,Url:e+"/_layouts/15/onedrive.aspx?p=18"})}this._isSiteAnalyticsLinkEnabled()&&u.push({Id:"Site_Analytics",Text:r.default.SiteAnalytics,Url:e+"/_layouts/15/siteanalytics.aspx"});this._isChangeTheLookLinkEnabled()&&u.push({Id:i.SUITE_NAV_LINK_IDS.CHANGE_THE_LOOK,Text:r.default.ChangeTheLookPanel,Url:"#"});this._isSiteDesignsLinkEnabled()&&u.push({Id:i.SUITE_NAV_LINK_IDS.SITE_DESIGNS,Text:r.default.SiteScriptProgress,Url:"#"});this._shouldShowGroupifyLink()&&u.push({Id:"Groupify",Text:r.default.GroupifySettingLinkTitle,Url:"#"});return u.length>0?u:null};t.prototype._isSiteAnalyticsLinkEnabled=function(){return!this._isODB&&p.isFeatureEnabled(p.SiteAnalyticsV3)};t.prototype._isSiteInformationLinkEnabled=function(){var e=Number(this._pageContext.webTemplate)===h.default.mySite||Number(this._pageContext.webTemplate)===h.default.mySiteHost;return l.PermissionMask.hasPermission(this._pageContext.webPermMasks,l.PermissionMask.manageWeb)&&(o.isGroupWebContext(this._pageContext)||!e)};t.prototype._isHubSettingsLinkEnabled=function(){return this._pageContext.isSiteAdmin&&this._pageContext.isHubSite};t.prototype._isSitePermissionsLinkEnabled=function(){var e=Number(this._pageContext.webTemplate);return!this._isODB&&!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isExternalGuestUser&&e!==h.default.teamChannel};t.prototype._isChangeTheLookLinkEnabled=function(){var e=Number(this._pageContext.webTemplate);if(c.default.isActivated("B1529C2B-3774-4936-9637-AE8EC7223B8F","04/15/2018","use feature check for changethelookpanel availability ")){var t="STS#3"===this._pageContext.webTemplateConfiguration,n=e===h.default.group||e===h.default.sitePagePublishing||t;return l.PermissionMask.hasPermission(this._pageContext.webPermMasks,l.PermissionMask.applyThemeAndBorder)&&e!==h.default.mySite&&e!==h.default.mySiteHost&&n}return this._pageContext.modernThemingEnabled&&l.PermissionMask.hasPermission(this._pageContext.webPermMasks,l.PermissionMask.applyThemeAndBorder)&&e!==h.default.mySite&&e!==h.default.mySiteHost};t.prototype._isSiteDesignsLinkEnabled=function(){if(p.isFeatureEnabled(p.SiteScriptProgressIndicator)){if(this._pageContext.isSiteAdmin||l.PermissionMask.hasPermission(this._pageContext.webPermMasks,{High:2147483647,Low:4294705151})){var e=Number(this._pageContext.webTemplate);return e===h.default.group||e===h.default.sitePagePublishing||"STS#3"===this._pageContext.webTemplateConfiguration}}return!1};t.prototype._isWebTemplatesGalleryEnabled=function(){return("MSIT_SPDF_1_Content"===this._pageContext.farmLabel||1===b.getVariantAndLogExposure(90020,this._pageContext))&&p.isFeatureEnabled(p.EnableWebTemplatesGallery)&&l.PermissionMask.hasPermission(this._pageContext.webPermMasks,l.PermissionMask.manageWeb)&&o.isModernTemplate({webTemplateConfiguration:this._pageContext.webTemplateConfiguration})};t.prototype._isGlobalNavSettingsPanelEnabled=function(){var e=this._pageContext;return p.isFeatureEnabled(p.SPAppBarClient)&&o.isRootWebContext(e)&&e.companyPortalReference&&e.companyPortalReference.SiteId&&e.siteId.indexOf(e.companyPortalReference.SiteId)>=0&&l.PermissionMask.hasPermission(e.webPermMasks,l.PermissionMask.manageWeb)};t.prototype._shouldShowGroupifyLink=function(){return w.OdspSuiteNavShouldShowGroupifyLink(this)};return t})();t.SuiteNavDataUpdater=S;t.resourceKey=u.createResolvedResourceKey(e("module").id,S,{resources:u.resourceScopeKey});t.default=S});
define("JN",["require","exports","fB","uv","Je"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OdspSuiteNavShouldShowGroupifyLink=void 0;t.OdspSuiteNavShouldShowGroupifyLink=function(e){return n.isFeatureEnabled(n.GroupifyFromModernPages)&&e._pageContext.isSPO&&e._pageContext.isSiteAdmin&&!e._pageContext.restrictedToRegion&&"/"!==e._pageContext.siteServerRelativeUrl&&e._pageContext.siteServerRelativeUrl===e._pageContext.webServerRelativeUrl&&Number(e._pageContext.webTemplate)===r.default.teamSite&&!e._pageContext.groupId&&(i.default.isActivated("08E00586-844B-4F0A-872E-7ACF6879294A","11/15/2019","Respect isGroupifyDisabled setting")||!e._pageContext.isGroupifyDisabled)&&(i.default.isActivated("616A3856-3AB2-4319-BB53-F25B63B5FC02","10/03/2020","Respect isGroupifyMenuButtonFeatureOff in Suite Nav")||!e._pageContext.isGroupifyMenuButtonFeatureOff)}});
define("Rat",["require","exports","ww","tB"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getMaxDisplayBubbleCount=function(){return 1};return t})(r.default);t.default=i});
define("YLt",["require","exports","hB"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n.default});
define("pTe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ACTION_MAPPING=t.AutoActionType=void 0;var n;(function(e){e[e.none=0]="none";e[e.locate=1]="locate";e[e.defaultClick=2]="defaultClick";e[e.download=3]="download";e[e.share=4]="share";e[e.sharing=5]="sharing";e[e.sendSurvey=6]="sendSurvey";e[e.createTextDocument=7]="createTextDocument";e[e.createWord=8]="createWord";e[e.createExcel=9]="createExcel";e[e.createExcelForm=10]="createExcelForm";e[e.createPowerPoint=11]="createPowerPoint";e[e.createOneNote=12]="createOneNote";e[e.openInExcel=13]="openInExcel";e[e.openInWord=14]="openInWord";e[e.openInPowerPoint=15]="openInPowerPoint";e[e.openInOneNote=16]="openInOneNote";e[e.openInVisio=17]="openInVisio";e[e.openInProject=18]="openInProject";e[e.openInPublisher=19]="openInPublisher";e[e.openInOffice=20]="openInOffice";e[e.embed=21]="embed";e[e.reportAbuse=22]="reportAbuse";e[e.addToShared=23]="addToShared";e[e.editBrowser=24]="editBrowser";e[e.feedback=25]="feedback";e[e.versionHistory=26]="versionHistory";e[e.showProperties=27]="showProperties"})(n=t.AutoActionType||(t.AutoActionType={}));t.ACTION_MAPPING={};for(var r in n)if("number"==typeof n[r]){var i=r,s=n[i];t.ACTION_MAPPING[i.toLowerCase()]=s}t.default=n});
define("mTe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.iosappstore=0]="iosappstore"})(n||(n={}));t.default=n});
define("U3",["require","exports","xv"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isSearchType=void 0;t.isSearchType=function(e){return e===n.default.Search||e===n.default.SearchOdbScope}});
define("Aq",["require","exports","g","D7","We","v","Je"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.encodeWebAbsoluteUrlHelperKey=void 0;var u=o.default.isActivated("335D0ECA-48E7-459E-9687-BE609CBBC94E","10/24/2018","Encode webUrl for api of $batch's additionalPostData");t.encodeWebAbsoluteUrlHelperKey=new s.ResourceKey({name:e("module").id+".encodeWebAbsoluteUrl",factory:new s.ConstantResourceFactory(!u)});t.resourceKey=s.createResolvedResourceKey(e("module").id,i.ApiUrlHelper,{itemUrlHelper:r.resourceKey,pageContext:n.pageContext,encodeWebAbsoluteUrl:t.encodeWebAbsoluteUrlHelperKey});t.default=i.ApiUrlHelper});
define("KPe",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["XDe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Ox",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[".aspx",".ascx",".master",".xsf",".xap",".swf",".jar",".asmx",".htc",".ashx",".json",".soap",".svc",".xamlx"],r=(function(){function e(){}e.isAllowed=function(e){return!(n.indexOf(e.toLocaleLowerCase())>=0)};return e})();t.default=r});
define("Ix",["require","exports","Ge","N5","K","uv","Be","wx","Yy","dv","Ow","Ex","xv","EI","Ox","Cx","Je","xx","se","LI"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isRepostPage=t.ensureLayouts15=t.getOneUpUrl=t.getTextEditorItemUrl=t.getDefaultClickUrl=t.wopiDocUrl=t.wopiFrameUrl=void 0;t.wopiFrameUrl="wopiframe.aspx";t.wopiDocUrl="doc.aspx";t.getDefaultClickUrl=function(e){var i,y=e.defaultRootItemId,N=e.pageContext,C=e.isDocSet,k=e.listId,L=e.listItemId,A=e.itemKey,O=e.itemType,M=e.itemList,_=e.itemOpenUrl,D=e.itemOpenInOfficeOnlineUrl,P=e.itemPreviewIFrameUrl,H=e.itemQueryType,B=e.itemOfficeBundle,j=e.itemContentTypeId,F=e.itemUrls,I=e.itemUrlHelper,q=e.itemSubsite,R=e.itemExtension,U=e.itemFSObjType,z=e.itemTranslationLanguages,W=e.isUnifiedAppSupportedFile,X=e.welcomePageCustomized,V=e.viewParams,$=e.parentItemKey,J=e.parentItemLink,K=e.supportsOneUp,Q=e.preferCurrentView,G=void 0!==Q&&Q,Y=e.focusUrl,Z=void 0!==Y&&Y,ee=e.useOneUpTextEditor,te=e.page,ne=void 0===te?b.getPageType(V):te,re=b.getKeyParams(A),ie=b.getItemQueryParams({key:A,viewParams:V,defaultRootItemId:y}),se=e.getMediaUrl||function(){return E({itemKey:A,parentItemKey:$,params:ie,supportsOneUp:K,itemUrlHelper:I})},oe=!!l.isOneDrive&&l.isFeatureEnabled(l.UseItemsScopeInSitesForODB),ue=l.isOneDrive?l.isFeatureEnabled(l.UseItemsScopeInOneDrive):l.isFeatureEnabled(l.UseItemsScopeInTeamSites),ae=l.isFeatureEnabled(l.UseLeftNavInODApp),fe=ne===p.default.FilePicker||ne===p.default.FileBrowser;fe&&(ie.p=ne);if(ne===p.default.FilePicker&&O!==c.default.Folder)return"";if(H&&b.isRecycleBin(H)&&!b.isRecycleBin(b.getQueryType(re)))return"";var le=I.getItemUrlParts(A),ce=Z&&!(B&&le.isCrossDomain)||l.isFeatureEnabled(l.EnableOneUpInSwmPwa)&&H===h.default.SharedWithMe&&B&&f.isOneDriveWinApp(),he=g.isGallatin()&&H===h.default.SharedWithMe,pe=le.fullItemUrl;if(b.getFocusItemKey(V)&&G||ce)i=se();else if(W)i=D||"";else if(B&&B.enableDefaultClick)i=se();else switch(O){case c.default.Media:i=he?_||A&&"#"+A:se();break;case c.default.Folder:var de=oe,ve=!m.default.isActivated("D027972B-2F8A-4759-9512-EF33F1F5AFFC","4/8/2020","Account for geo-relation of sites for navigation")&&le.geoRelation!==n.GeoRelation.sameGeo;if(f.isOneDriveWinApp()&&!ae&&le.isCrossList)return"";if(!fe&&q&&(ve||q.isExternal)&&!de)return q.serverRelativeUrl;if(!fe&&M&&(ve||M.isExternal)&&!de)return le.fullItemUrl||"";if(C&&(!l.isFeatureEnabled(l.DocumentSetsModernView)||!ue||X))return _||"";if(fe||!le.isCrossList&&le.siteRelation===n.SiteRelation.sameSite||Number(N.webTemplate)===s.default.mySite&&N.isNoScriptEnabled&&le.isCrossDomain&&(!ve||de))i="#"+r.serializeQuery(ie,void 0,!1);else if(ie.remoteItem)i="#"+r.serializeQuery(ie);else{if(_){if(new o.default(_).getScheme()){i=_;break}}i=a.canonicalizeDecodedUrl(le.fullItemUrl||"")}break;case c.default.Shortcut:i=F&&F[u.default.shortcutTarget]||_||"";break;case c.default.File:if(he)i=_||A&&"#"+A;else if(R&&v.canOpenInMonacoForExtension(R,O))i=ee&&ne!==p.default.TextFileEditor||!d.default.isAllowed(R||"")?se():w({itemKey:A,parentItemKey:$,parentItemLink:J,viewParams:V,supportsOneUp:K});else if(!m.default.isActivated("a417d44c-dcd1-4632-8c6e-482c3a98cef0","5/14/2020","Do not redirect multilingual default page")&&z&&z.length>0||x(j))if(_){var me=new o.default(_);me.setQueryParameter("stay","true");i=me.toString()}else i="";else if(l.isFeatureEnabled(l.PreviewUnknownFileTypes)&&T(_,pe)){if(!m.default.isActivated("5c0e1884-60b9-446d-a9dd-0f040c570875","2/19/2020","Always use absolute openUrl for ASPX items")&&".aspx"===(""+R).toLowerCase()&&_)return _;i=se()}else i=_||A&&"#"+A;break;default:i=!he&&l.isFeatureEnabled(l.PreviewUnknownFileTypes)&&T(_,pe)&&R?se():_||A&&"#"+A}if(k&&(O===c.default.File&&P&&(-1!==P.toLowerCase().indexOf(t.wopiFrameUrl)||-1!==P.toLowerCase().indexOf(t.wopiDocUrl))||O===c.default.OneNote)){var ge=new o.default(i);if(ge.getLastPathSegment().toLowerCase()===t.wopiFrameUrl||ge.getLastPathSegment().toLowerCase()===t.wopiDocUrl){ge.setQueryParameter("1"===U?"IsFolder":"IsList","1");ge.setQueryParameter("ListId",k);ge.setQueryParameter("ListItemId",L||"");i=ge.toString()}}return i=S(i)};function w(e){var t=e.itemKey,n=e.parentItemKey,s=e.parentItemLink,o=e.viewParams,u=e.supportsOneUp,a=b.getItemQueryParams({key:t,viewParams:o}),f=i.deserializeQuery(n||""),l=f.id;if("root"===l){var c=i.deserializeQuery(t).listurl;c&&(l=c)}a.parent=l;a.parentview=f.view;a.p=p.default.TextFileEditor;delete a.view;var h="";if(!u&&s){delete a.parentview;h=s;return s+"?"+r.serializeQuery(a,void 0,!0)}Number(o.p)!==p.default.TextFileEditor&&(h=b.getCurrentPageBaseUrl()+window.location.pathname);return h+"#"+r.serializeQuery(a,void 0,!0)}t.getTextEditorItemUrl=w;function E(e){var t,n=e.itemKey,s=e.params,o=void 0===s?{}:s,u=e.parentItemKey,a=e.supportsOneUp,f=e.itemUrlHelper;if(!a){var l=f.getItemUrlParts(n),c=l.serverRelativeItemUrl||"",h=((t={}).id=c,t.parent=c.substring(0,c.lastIndexOf("/")),t);return l.fullListUrl+"?"+r.serializeQuery(h,void 0)}var p=i.deserializeQuery(u||"");o.parent=p.id;var d=b.getRemoteItemFromViewParams(o);if(d){var v=d.mountPoint,g=d.remoteSpItem;if(g){var w={mountPoint:v,remoteSpItem:{listFullUrl:g.listFullUrl,rootFolder:p.id,webAbsoluteUrl:g.webAbsoluteUrl}};y.assign(o,b.saveRemoteItemToViewParams(w))}}o.parentview=p.view;delete p.id;delete p.view;delete p.u;var E=!m.default.isActivated("FFF446A0-8928-488F-8835-3021B2FB652F","07/01/2019","Allow blank filter values");if(E)for(var S in o){var x=o[S];(null==x||""===x&&S.indexOf("FilterValue")<0)&&delete o[S]}return"#"+r.serializeQuery(o,p,!E)}t.getOneUpUrl=E;function S(e){e&&-1!==e.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(e=(e=e.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx"));return e}t.ensureLayouts15=S;function x(e){return!!e&&e.indexOf("0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B")>-1}t.isRepostPage=x;function T(e,t){return e===(t&&!m.default.isActivated("1F4B039C-1C07-4A8C-A850-5DD01A6DE4FC","1/31/2020","Test against encoded URL for preview behavior")?a.canonicalizeDecodedUrl(t):t)}});
define("kI",["require","exports","xv"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getQueryType=void 0;t.getQueryType=function(e,t){void 0===t&&(t=!1);var r=e.view;!r&&t&&(r=e.parentview);return r?Number(r):n.default.Files}});
define("D7",["require","exports","g","Ge","v"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ItemUrlHelper=t.GeoRelation=t.SiteRelation=void 0;Object.defineProperty(t,"ItemUrlHelper",{enumerable:!0,get:function(){return r.ItemUrlHelper}});Object.defineProperty(t,"SiteRelation",{enumerable:!0,get:function(){return r.SiteRelation}});Object.defineProperty(t,"GeoRelation",{enumerable:!0,get:function(){return r.GeoRelation}});t.resourceKey=i.createResolvedResourceKey(e("module").id,r.ItemUrlHelper,{pageContext:n.pageContext});t.default=r.ItemUrlHelper});
define("rw",["require","exports","ow","Je","Nx","bv"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateViewParamsFromWindowName=void 0;t.updateViewParamsFromWindowName=function(e,t){void 0===t&&(t=s.Engagement);var o=(new n.default).removeState("ODBParams");if(o){t.logData({name:"Picker.UpdateViewParamsFromWindowName"});r.default.isActivated("101A6D89-37F5-4764-814D-C730423F6A2D","3/6/2020","Force full-page load when routing to file picker")||e.navigateTo("?"+i.serializeQuery(o));e.updateViewParams(o,{ignoreHistory:!0,clearOtherParams:!1});return!0}return!1}});
define("fTe",["require","exports","ww","tB","xv","EI","Nx","g","pO","mTe","Be","ey","t","qPe","fB","qne","mZ","pTe","HD","y9","ze","WC","pH","D7","tg","k3","Yy","h$","v","wq","PO","LI","Je","Ix","rw","mv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.supportsOneUpResourceKey=t.useOneUpTextEditorResourceKey=void 0;t.useOneUpTextEditorResourceKey=new L.ResourceKey({name:e("module").id+".useOneUpTextEditor",factory:new L.ConstantResourceFactory(d.isFeatureEnabled(d.UseOneUpTextEditor))});t.supportsOneUpResourceKey=new L.ResourceKey({name:e("module").id+".supportsOneUp",factory:new L.ConstantResourceFactory(!0)});var B=(function(e){n.__extends(L,e);function L(n,r){void 0===n&&(n={});void 0===r&&(r={});var i=e.call(this,n,r)||this,s=r.navigation,o=void 0===s?i.resources.consume(T.navigation):s,a=r.platform,f=void 0===a?i.resources.consume(N.platformDetection):a,l=r.pageContext,c=void 0===l?i.resources.consume(u.pageContext):l,h=r.itemUrlHelper,p=void 0===h?i.resources.consume(x.resourceKey):h,d=r.itemParentHelper,v=void 0===d?i.resources.consume(A.resourceKey):d,m=r.useOneUpTextEditor,g=void 0===m?i.resources.consume(t.useOneUpTextEditorResourceKey):m,y=r.supportsOneUp,b=void 0===y?i.resources.consume(t.supportsOneUpResourceKey):y,w=r.urlDataSourceLite,E=void 0===w?i.resources.consume(O.resourceKey):w;i._navigation=o;i._platform=f;i._pageContext=c;i._itemUrlHelper=p;i._itemParentHelper=v;i._useOneUpTextEditor=g;i._supportsOneUp=b;i._urlDataSourceLite=E;!_.default.isActivated("DC916452-C5D8-462D-9448-DD68346DF568","7/3/2020","Skip when hosted in Teams")&&H.isTeamsPageApp()||P.updateViewParamsFromWindowName(i._navigation);return i}L.getKey=function(e,t){return O.default.getKey(e,t)};L.getKeyParams=function(e){return O.default.getKeyParams(e)};L.getQueryUrl=function(e,t){var n={};e!==s.default.Files&&(n.p=e);n.view=""+(t||"");return"#"+o.serializeQuery(n,null,!0)};L.prototype.getDefaultRootItemId=function(){return this._urlDataSourceLite.getDefaultRootItemId()};L.prototype.getQueryType=function(e){void 0===e&&(e=this._navigation.viewParams);return M.getQueryType(e)};L.prototype.getPageType=function(e){void 0===e&&(e=this._navigation.viewParams);return this._urlDataSourceLite.getPageType(e)};L.prototype.isCurrentQuery=function(e,t){void 0===t&&(t=this._navigation.viewParams);return t.view?e===i.default.Files?0===Object.keys(t).length||t.view.toString()===i.default.Files.toString():t.view.toString()===e.toString():e===i.default.Files};L.prototype.isRecycleBin=function(e){return M.isRecycleBin(e)};L.prototype.getKey=function(e){return this._urlDataSourceLite.getKey(e)};L.prototype.getKeyParams=function(e){return L.getKeyParams(e)};L.prototype.getFocusItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return M.getFocusItemKey(e)||null};L.prototype.getCurrentItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return this._urlDataSourceLite.getCurrentItemKey(e)};L.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),r=this.getKeyParams(t);delete n.listurl;delete r.listurl;delete n.u;delete r.u;return this.getKey(n)===this.getKey(r)};L.prototype.getRootItemKey=function(e){void 0===e&&(e=i.default.Files);return this._urlDataSourceLite.getRootItemKey(e)};L.prototype.getQueryUrl=function(e,t){return L.getQueryUrl(e,t)};L.prototype.getSearchQueryUrl=function(e,t,n,r,s,u){var a,f=i.default.Search.toString(),l="",c="";if((d.isFeatureEnabled(d.CSIOdbScopedSearch)||d.isFeatureEnabled(d.CSIOdbNotMyFiles3S))&&(f=(null==u?void 0:u.view)||i.default.Search.toString())===i.default.SearchOdbScope.toString()){l=(null==u?void 0:u.id)||"";c=(null==u?void 0:u.listurl)||""}return"#"+o.serializeQuery(((a={}).view=f,a.q=e,a.id=l,a.listurl=c,a),void 0,!0)};L.prototype.getQueryParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.q};L.prototype.getCommentIdParamValue=function(e){void 0===e&&(e=this._navigation.viewParams)};L.prototype.isItemCrossList=function(e){return this._itemUrlHelper.getItemUrlParts(e).isCrossList};L.prototype.getSearchItemId=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return t.serverRelativeListUrl?t.serverRelativeItemUrl:t.normalizedItemUrl};L.prototype.isSearchItemOdbRoot=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return!this.isItemCrossList(e)&&!t.listRelativeItemUrl};L.prototype.isSPSiteRoot=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return t.isCrossList&&(!t.normalizedListUrl||!t.webRelativeItemUrl)};L.prototype.isSPListRoot=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return t.isCrossList&&t.normalizedListUrl===t.normalizedItemUrl};L.prototype.getLayoutContentType=function(e){void 0===e&&(e=this._navigation.viewParams);return""};L.prototype.getItemTypeFilter=function(e){for(var t=[],n=0,r=(e.typeFilters||"").split(",");n<r.length;n++){var i=r[n];if("."===i[0])t.push(i);else{var s=E.ItemTypeFilter[i];s&&t.push(s)}}return{filters:t}};L.prototype.saveItemTypeFilter=function(e){void 0===e&&(e={filters:[]});for(var t=[],n=0,r=e.filters;n<r.length;n++){var i=r[n];"string"==typeof i?t.push(i):t.push(E.ItemTypeFilter[i])}var s=t.join(","),o={};s&&(o.typeFilters=s);return o};L.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")};L.prototype.saveUsersFilter=function(e){var t={};t.userFilters=e&&e.join(";#");return t};L.prototype.getDateDurationFilter=function(e){return e.dateFilter};L.prototype.saveDateDurationFilter=function(e){var t={},n="string"==typeof e?e:S.DateTimeSliderValue[e];t.dateFilter=n;return t};L.prototype.getOwnerId=function(){return""};L.prototype.getRootUrl=function(){return this._pageContext&&this._pageContext.listUrl||"/"};L.prototype.getSharedByUrl=function(e,t,n){return""};L.prototype.getExternalUrl=function(e){return"/externalredirector?alias="+f.default[e]};L.prototype.getAppSubfolder=function(){return"odb"};L.prototype.getUploadStorageUrl=function(e,t){return""};L.prototype.getVideoPlayerUrl=function(e){return""};L.prototype.getTaggingOptionsUrl=function(){return""};L.prototype.getAllPhotosForPlaceUrl=function(e,t){return""};L.prototype.getSearchFilterQueryUrl=function(e){return""};L.prototype.isSearchFilterApplied=function(e){return!1};L.prototype.isSearchPassThrough=function(){return!1};L.prototype.getItemHintRedirectViewParams=function(e){return e};L.prototype.getDefaultClickUrl=function(e,t){var n=this;void 0===t&&(t={});if(!e||!e.key)return"";var r,i=t.preferCurrentView,s=void 0!==i&&i,o=t.itemSet,u=t.parentItem,a=t.page,f=t.focusUrl,l=void 0!==f&&f,c=t.viewParams,h=void 0===c?this._navigation.viewParams:c,d=this._getItemQueryParams(e.key,{viewParams:h}),v=o&&o.item.peek();r=u||(v&&v.key!==e.key&&v||e.parent);var m=p.isUnifiedAppSupportedFile(e)?this.getOpenInOfficeOnlineUrl(e,h,{}):void 0,g={itemKey:e.key,viewParams:h,itemUrlHelper:this._itemUrlHelper,pageContext:this._pageContext,useOneUpTextEditor:this._useOneUpTextEditor,isDocSet:e.isDocSet,listId:this._listContext()&&this._listContext().listId,listItemId:e.properties&&e.properties.ID,itemType:e.type,itemList:e.list,itemOpenUrl:e.openUrl,itemOpenInOfficeOnlineUrl:m,itemPreviewIFrameUrl:e.previewIFrameUrl,itemQueryType:e.queryType,itemOfficeBundle:e.officeBundle,itemContentTypeId:e.contentTypeId,itemUrls:e.urls,itemSubsite:e.subsite,itemExtension:e.extension,itemFSObjType:e.properties&&e.properties.FSObjType,itemTranslationLanguages:!_.default.isActivated("a417d44c-dcd1-4632-8c6e-482c3a98cef0","5/14/2020","Do not redirect multilingual default page")&&e.properties&&e.properties._SPTranslatedLanguages,isUnifiedAppSupportedFile:p.isUnifiedAppSupportedFile(e),welcomePageCustomized:e.properties&&e.properties.WelcomePageCustomized,getMediaUrl:function(){return n._getMediaUrl(e,{params:d,parentItem:r})},parentItemKey:r&&r.key,parentItemLink:e.parentLink,supportsOneUp:this._supportsOneUp,preferCurrentView:s,focusUrl:l,defaultRootItemId:this.getDefaultRootItemId(),page:a};return D.getDefaultClickUrl(g)};L.prototype.getTagUrl=function(e){return""};L.prototype.getRecycleBinQueryUrl=function(){return this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/AdminRecycleBin.aspx?mysite=1"};L.prototype.getRecentQueryUrl=function(){return this.getQueryUrl(this.getPageType(),i.default.Recent)};L.prototype.getDateTimeControlIframeUrl=function(){return b.getSafeWebServerRelativeUrl(this._pageContext)+"/"+this._pageContext.layoutsUrl+"/iframe.aspx"};L.prototype.getNewFormRichTextEditorIFrameUrl=function(e,t,n){var r=t?"&ContentTypeId="+t:"",i=n?this.getKeyParams(n).id:this._navigation.viewParams.RootFolder,s=i?"&RootFolder="+w.default.encodeURIComponent(i):"";return this._listContext().listUrl+"/NewForm.aspx?OnlyIncludeOneField="+e+"&ClientFormOverwriteSave=1&IsDlg=1"+r+s};L.prototype.getEditFormRichTextEditorIFrameUrl=function(e,t,n){var r=n?this.getKeyParams(n).id:this._navigation.viewParams.RootFolder,i=r?"&RootFolder="+w.default.encodeURIComponent(r):"";return this._listContext().listUrl+"/EditForm.aspx?OnlyIncludeOneField="+e+"&ID="+t+"&IsDlg=1"+i};L.prototype.getEditFormUrl=function(e){return this._getListItemFormUrl(this._listContext().editFormUrl,e)};L.prototype.getDisplayFormUrl=function(e){return this._getListItemFormUrl(this._listContext().displayFormUrl,e)};L.prototype.getOneDriveAppsUrl=function(){return"https://www.onedrive.com/download"};L.prototype.handleFatalErrorDuringViewLoad=function(){};L.prototype.getAutoActionType=function(e){return g.default.none};L.prototype.getPhotoType=function(e){return null};L.prototype.getItemUrl=function(e){void 0===e&&(e="");var t=this._itemUrlHelper.getItemUrlParts(e);return C.canonicalizeDecodedUrl(t.fullItemUrl)};L.prototype.qualifyUrl=function(e){var t;if(0===e.indexOf("#")){var n=e.substring(1);t=""+this.getCurrentPageBaseUrl()+window.location.pathname+(n?"?"+n:"")}else t=e;return t};L.prototype.getNavLinkClickUrl=function(e){return""};L.prototype.getApiName=function(){return"Vroom"};L.prototype.getApiBaseUrl=function(e){return this._urlDataSourceLite.getApiBaseUrl(e)};L.prototype.getSearchByDateFilterQueryUrl=function(e){return""};L.prototype.isSearchByDateFilterApplied=function(e){return!1};L.prototype.getResourcePreloadUrl=function(){return""};L.prototype.getHipCheckUrl=function(){return""};L.prototype.getVerifyAccountUrl=function(){return""};L.prototype.getCurrentPageBaseUrl=function(){return M.getCurrentPageBaseUrl()};L.prototype.getCurrentSiteUrl=function(){return this._pageContext.webAbsoluteUrl};L.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var r,i=n.useDefaultAction,s=void 0!==i&&i,o=k.convertToISPListItem(e),u=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));r="ms-word"!==(e.appMap?e.appMap.toLowerCase():void 0)?p.isUnifiedAppSupportedFile(e)?y.WopiHelper.GetWopiDocEditUrl(o,u&&u.list.id||"",this._pageContext.env):!s&&y.WopiHelper.GetWopiFrameEditUrl(o):p.isUnifiedAppSupportedFile(e)?!s&&y.WopiHelper.GetWopiDocEditUrl(o,u&&u.list.id||"",this._pageContext.env):!s&&y.WopiHelper.GetWopiFrameEditUrl(o);return this._ensureLayouts15(r||e.openUrl)};L.prototype.getOpenInOfficeClientUrl=function(e,t,n){var r=e.appMap,s=e.properties&&e.properties.path||this.getItemUrl(e.key),o=e.extension||"",u=-1!==[".jpg",".jpeg",".bmp",".png",".gif",".onetoc2",".one",".odc"].indexOf(o.toLowerCase()),a=e.queryType===i.default.SharedWithMe&&("ms-word"===e.appMap||"ms-powerpoint"===e.appMap),f=c.PermissionMask.hasItemPermission(e,c.PermissionMask.editListItems)&&!u&&(!m.isCheckedOut(e)||m.isCheckedOutByUser(e,this._pageContext.userId))||a;return v.createProtocolHandlerUrl(r,s,f?v.protocolCommand.Edit:v.protocolCommand.View,"",this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)};L.prototype.getOpenTemplateInOfficeClientUrl=function(e,t){return v.createProtocolHandlerUrl(e,t,v.protocolCommand.Edit,"",this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)};L.prototype.getNewInOfficeClientUrl=function(e,t,n){return v.createProtocolHandlerUrl(e,t,v.protocolCommand.New,n,this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)};L.prototype.getNewPlaceholderItemKey=function(){var e;return o.serializeQuery(((e={}).id="placeHolder "+L.placeholderId++,e))};L.prototype.getWACResourcesPreloadUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/wopihiddenframe.aspx"};L.prototype.getWopiDocUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/doc.aspx"};L.prototype.getMyRestorePageUrl=function(){var e=this;return this.resources.consumeAsync(a.web).then(function(e){return e.getMyOneDriveUrl()}).then(function(t){return t+"/"+e.getLayoutsUrl()+"/onedrive.aspx?p="+s.default.Restore})};L.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,r=t.viewParams,i=this._getItemQueryParams(e.key,{viewParams:r}),u=n||e.parent,a=o.deserializeQuery(u&&u.key||""),f=a.id;if("root"===f){var l=o.deserializeQuery(e.key).listurl;l&&(f=l)}i.parent=f;i.parentview=a.view;i.p=s.default.TextFileEditor;delete i.view;var c="";if(!this._supportsOneUp&&e.parentLink){delete i.parentview;c=e.parentLink;return e.parentLink+"?"+o.serializeQuery(i,null,!0)}Number(r.p)!==s.default.TextFileEditor&&(c=this.getCurrentPageBaseUrl()+window.location.pathname);return c+(c?"?":"#")+o.serializeQuery(i,null,!0)};L.prototype.getImageEditorItemUrl=function(e,t){var n=t.parentItem,r=t.viewParams,i=this._getItemQueryParams(e.key,{viewParams:r}),u=n||e.parent,a=o.deserializeQuery(u&&u.key||""),f=a.id;if("root"===f){var l=o.deserializeQuery(e.key).listurl;l&&(f=l)}i.parent=f;i.parentview=a.view;i.p=s.default.ImageFileEditor;delete i.view;var c="";if(!this._supportsOneUp&&e.parentLink){delete i.parentview;c=e.parentLink;return e.parentLink+"?"+o.serializeQuery(i,null,!0)}Number(r.p)!==s.default.ImageFileEditor&&(c=this.getCurrentPageBaseUrl()+window.location.pathname);return c+(c?"?":"#")+o.serializeQuery(i,null,!0)};L.prototype.getCanonicalUrl=function(e){return this.getItemUrl(e)};L.prototype.getLayoutsUrl=function(){return this._pageContext.layoutsUrl};L.prototype._listContext=function(){var e=this.resources.consume(u.listContext);this._listContext=function(){return e};return e};L.prototype.getWebUrl=function(){return this._pageContext.webAbsoluteUrl};L.prototype._getListItemFormUrl=function(e,t){if(!this._listContext().listUrl||!e)return"";var n,r,i;if(t&&t.properties){n=t.properties.ID;r=t.properties.ContentTypeId;i=this.getKeyParams(t.parentKey).id}var s={Source:w.default.encodeURIComponent(window.location.href),RootFolder:w.default.encodeURIComponent(i||this._listContext().folderPath)};n&&(s.ID=n);r&&(s.ContentTypeId=r);var o=new l.default(e);for(var u in s)s.hasOwnProperty(u)&&o.setQueryParameter(u,s[u]);return o.toString()};L.prototype._ensureLayouts15=function(e){e&&-1!==e.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(e=(e=e.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx"));return e};L.prototype._getItemQueryParams=function(e,t){var n=t.viewParams,r=void 0===n?this._navigation.viewParams:n,s=(t.currentViewId,o.deserializeQuery(e));delete s.u;var u=h.utils.extend({},r);delete u.id;delete u.RootFolder;delete u.view;delete u.q;delete u.listurl;delete u.typeFilters;h.utils.extend(u,s);delete u.parent;delete u.parentview;delete u.p;if(s.id===this.getDefaultRootItemId()){delete u.id;delete u.RootFolder}u.listurl===r.listurl&&this.getQueryType(s)===i.default.Files&&(this._pageContext.viewId||"").replace("{","").replace("}","")!==u.viewid||delete u.viewid;if(!_.default.isActivated("B18F1E9C-10C2-4D06-A126-19459E1894C9","06/25/2019","remove uncessary view params to improve prefetch")&&u.newTargetListUrl===this._pageContext.listUrl){delete u.newTargetListUrl;delete u.viewpath}return u};L.prototype._getMediaUrl=function(e,t){var n,r=t.params,i=void 0===r?{}:r,s=t.itemSet,u=t.parentItem;if(!this._supportsOneUp){var a=this._itemUrlHelper.getItemUrlParts(e.key),f=a.serverRelativeItemUrl,l=((n={}).id=f,n.parent=f.substring(0,f.lastIndexOf("/")),n);return a.fullListUrl+"?"+o.serializeQuery(l,null)}var c=u||(s?s.item.peek():e.parent);if(!c)return"";var h=c&&c.key||"",p=o.deserializeQuery(h);i.parent=p.id;i.parentview=p.view;delete p.id;delete p.view;delete p.u;var d=!_.default.isActivated("FFF446A0-8928-488F-8835-3021B2FB652F","07/01/2019","Allow blank filter values");if(d)for(var v in i){var m=i[v];(null==m||""===m&&v.indexOf("FilterValue")<0)&&delete i[v]}return"#"+o.serializeQuery(i,p,!d)};L.dependencies=n.__assign(n.__assign({},r.default.dependencies),{navigation:T.navigation,platform:N.platformDetection,pageContext:u.pageContext,itemUrlHelper:x.resourceKey,itemParentHelper:A.resourceKey,useOneUpTextEditor:t.useOneUpTextEditorResourceKey,supportsOneUp:t.supportsOneUpResourceKey,urlDataSourceLite:O.resourceKey});L.placeholderId=0;return L})(r.default);t.default=B;t.resourceKey=L.createResolvedResourceKey(e("module").id,B)});
define("PO",["require","exports","zi","y9","tg","Nx","je","v","Be","xv","g","A3","LI"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.UrlDataSourceLite=void 0;var p=(function(){function e(e,t){var n=this;this._pageContext=t.pageContext;this._navigation=t.navigation;this._resources=t.resources;this._events=new c.default(this);(this._mayBeFastOneUp=!!this.getFocusItemKey(this._navigation.viewParams))&&this._events.on(this._navigation,"change",function(){if(!n.getFocusItemKey(n._navigation.viewParams)){n._mayBeFastOneUp=!1;n._events.off(n._navigation)}})}e.prototype.getCurrentItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return h.getCurrentItemKey({listUrl:this._pageContext.listUrl,groupId:this._pageContext.groupId,viewParams:e,itemKeyParams:{},defaultRootItemId:this.getDefaultRootItemId()})};e.prototype.getKey=function(e){return h.getKey({listUrl:this._pageContext.listUrl,groupId:this._pageContext.groupId,viewParams:this._navigation.viewParams,itemKeyParams:e,defaultRootItemId:this.getDefaultRootItemId()})};e.prototype.getKeyParams=function(e){return h.getKeyParams(e)};e.prototype.getQueryType=function(e,t){void 0===e&&(e=this._navigation.viewParams);void 0===t&&(t=!1);return h.getQueryType(e,t)};e.prototype.getPageType=function(e,t){void 0===e&&(e=this._navigation.viewParams);return h.getPageType(e,this._mayBeFastOneUp||t)};e.prototype.getFocusItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return h.getFocusItemKey(e)};e.prototype.getRootItemKey=function(e){var t;void 0===e&&(e=f.default.Files);return this.getKey(((t={}).view=e,t))};e.prototype.getDefaultRootItemId=function(){var e,t;return this._pageContext.listUrl?this._pageContext.listUrl:this._listContext()&&(null===(e=this._listContext())||void 0===e?void 0:e.listUrl)?null===(t=this._listContext())||void 0===t?void 0:t.listUrl:"root"};e.prototype.getApiBaseUrl=function(e){var t="v2.1"===e?e:"v2.0";return r.getServerUrl(this._pageContext)+"/_api/"+t};e.prototype.getNavLinkClickUrl=function(e,t){var r,i,u;void 0===t&&(t="#");if(e.isDocLib){var f=e.url.toLowerCase(),l=f.lastIndexOf("/forms/");-1!==l?u=e.url.substring(0,l):-1===f.indexOf(".aspx")&&(u=e.url.endsWith("/")?e.url.substr(0,e.url.length-1):e.url)}else if(n.isGenericList(e.listTemplateType)){var c=e.url.match(/\/[^/]*?\.aspx/i);c?u=e.url.substring(0,c.index):/\.aspx/i.test(e.url)||(u=e.url.endsWith("/")?e.url.substr(0,e.url.length-1):e.url)}if(u){var h=((r={}).id=u,r.newTargetListUrl=u,r),p=new a.default(e.url),d=p.getPath();d&&d.indexOf(".aspx")>=0&&(h.viewpath=d);var v=s.deserializeQuery(p.getQuery(!0));o.extend(h,v);h.RootFolder&&(h.id=h.RootFolder);i=t+s.serializeQuery(h,void 0,!0)}return i};e.prototype._listContext=function(){var e=this._resources.consume(l.listContext.optional);this._listContext=function(){return e};return e};e.dependencies={navigation:i.navigation,pageContext:l.pageContext,resources:u.resourceScopeKey};e.getKey=h.getKeyFromQueryParams;e.getKeyParams=h.getKeyParams;return e})();t.UrlDataSourceLite=p;t.default=p;t.resourceKey=u.createResolvedResourceKey(e("module").id,p)});
define("Ux",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filterKeyRegex=t.sortGroupKeyRegex=void 0;t.sortGroupKeyRegex=/^(sortField|isAscending|groupBy)$/;t.filterKeyRegex=/^Filter(Field|Value|Type|Op|LookupId|Display)(s?)([1-9]|10)$/});
define("LI",["require","exports","ww","K","N5","je","Ue","EI","xv","Je","Ow","kI"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isCurrentItemOnRemoteSite=t.getExpandRowLimitFromViewParams=t.getGroupFromViewParams=t.getSortFromViewParams=t.getFiltersFromViewParams=t.getQueryParamValue=t.getSearchQueryUrl=t.getCurrentPageBaseUrl=t.isRecycleBin=t.getRootItemKey=t.saveRemoteItemToViewParams=t.getRemoteItemFromViewParams=t.getPageType=t.getFocusItemKey=t.getKeyFromQueryParams=t.getKey=t.getCurrentItemKey=t.getItemQueryParams=t.getQueryType=t.getKeyParams=void 0;Object.defineProperty(t,"getKeyParams",{enumerable:!0,get:function(){return r.deserializeQuery}});Object.defineProperty(t,"getQueryType",{enumerable:!0,get:function(){return c.getQueryType}});var h="fileName",p="dateModified",d="sharedByName";t.getItemQueryParams=function(e){var t=e.defaultRootItemId,n=e.viewParams,i=e.listUrl,o=e.viewId,u=e.key,l=r.deserializeQuery(u),h=s.extend({},n);delete h.id;delete h.RootFolder;delete h.view;delete h.q;delete h.listurl;delete h.typeFilters;s.extend(h,l);delete h.parent;delete h.parentview;delete h.p;delete h.sharedLibraryCreated;if(!h.fileBrowser&&l.id===t){delete h.id;delete h.RootFolder}h.listurl===n.listurl&&c.getQueryType(l)===a.default.Files&&(o||"").replace("{","").replace("}","")!==h.viewid||delete h.viewid;if(!f.default.isActivated("B18F1E9C-10C2-4D06-A126-19459E1894C9","06/25/2019","remove uncessary view params to improve prefetch")&&h.newTargetListUrl===i){delete h.newTargetListUrl;delete h.viewpath}delete h.u;return h};t.getCurrentItemKey=function(e){var t,r=e.viewParams,i=e.itemKeyParams,s=n.__assign(n.__assign(n.__assign({},i),r),!r.id&&r.RootFolder?((t={}).id=r.RootFolder,t):{}),o=s.parent,u=s.parentview;if(o||u){delete s.id;o&&(s.id=o);if(u){s.view=u;delete s.listurl}delete s.parent;delete s.parentview}return v(n.__assign(n.__assign({},e),{itemKeyParams:s}))};function v(e){var t=e.defaultRootItemId,n=e.groupId,r=e.listUrl,i=e.itemKeyParams,s=e.getViewParams,o=s?s():e.viewParams;(i.listurl===r||f.default.isActivated("9FA9EFD3-16F5-4D1D-AAC3-8DB2472C33D7","6/19/2020","Only assign list URL for OneDrive if not present")&&!r&&n&&!o.newTargetListUrl)&&delete i.listurl;i.newTargetListUrl&&delete i.newTargetListUrl;return m(i,t)}t.getKey=v;function m(e,t){var n,r=Number(e.view)||a.default.Files,s=((n={}).id=e.id||t||"",n.listurl=e.listurl||"",n.view=""+(r||""),n.q=e.q||"",n.typeFilters=e.typeFilters||"",n.userFilters=e.userFilters||"",n.dateFilter=e.dateFilter||"",n.u=e.u||"",n);return i.serializeQuery(s,void 0,!0)}t.getKeyFromQueryParams=m;function g(e){var t,n=e.parent,r=e.parentview;if(n||r){(t={}).id=e.id;t.listurl=e.listurl;r&&(t.view=e.view)}return t?i.serializeQuery(t,void 0,!0):""}t.getFocusItemKey=g;t.getPageType=function(e,t){var n=Number(e.p);switch(n){case u.default.FilePicker:case u.default.FileBrowser:case u.default.TextFileEditor:case u.default.Error:case u.default.Share:case u.default.Embed:case u.default.Restore:case u.default.Settings:case u.default.MobileAppUpsell:case u.default.FileRequest:return n}return g(e)&&t?u.default.OneUp:u.default.Files};t.getRemoteItemFromViewParams=function(e){var t=e.remoteItem;if(t){var n=JSON.parse(""+(t||""));return{mountPoint:n.mp,remoteSpFolderById:n.rsf,remoteSpItem:n.rsi}}};t.saveRemoteItemToViewParams=function(e){var t;if(!e)return{};var n={mp:e.mountPoint,rsf:e.remoteSpFolderById,rsi:e.remoteSpItem};return(t={}).remoteItem=JSON.stringify(n),t};t.getRootItemKey=function(e,t){var r;return v(n.__assign({itemKeyParams:(r={},r.view=e,r)},t))};t.isRecycleBin=function(e){return e===a.default.RecycleBin||e===a.default.SecondStageRecycleBin};t.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host};t.getSearchQueryUrl=function(e){var t,n=e.query,r=e.baseItemViewParams,s=a.default.Search.toString(),o="",u="";if((l.isFeatureEnabled(l.CSIOdbScopedSearch)||l.isFeatureEnabled(l.CSIOdbNotMyFiles3S))&&(s=(null==r?void 0:r.view)||a.default.Search.toString())===a.default.SearchOdbScope.toString()){o=(null==r?void 0:r.id)||"";u=(null==r?void 0:r.listurl)||""}return"#"+i.serializeQuery(((t={}).view=s,t.q=n,t.id=o,t.listurl=u,t),void 0,!0)};t.getQueryParamValue=function(e){return e.q};t.getFiltersFromViewParams=function(e){var t=e.typeFilters&&e.typeFilters.split(","),n=e.dateFilter&&e.dateFilter.split(","),r=e.userFilters&&e.userFilters.split(";#"),i=[];t&&i.push({type:h,values:t});n&&i.push({type:p,values:n});r&&i.push({type:d,values:r});return i};t.getSortFromViewParams=function(e){return{sortField:e.sortField||"",isAscending:!("true"!==e.isAscending)}};t.getGroupFromViewParams=function(e){return{groupField:e.groupBy||""}};t.getExpandRowLimitFromViewParams=function(e){var t=e.rowLimit;return t?Number(t):0};t.isCurrentItemOnRemoteSite=function(e){var t=e.listurl;return!!t&&!!new o.SPResourcePath(t).authority}});
define("qq",["require","exports","ww","tB","Be","v"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getUrlParts=function(e){return new u(e)};return t})(r.default);t.default=o;var u=(function(){function e(e){this._url=e}Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!1,configurable:!0});e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}this._getDriveId=function(){return e};return e};e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}this._getItemId=function(){return e};return e};e.prototype._getPathSegments=function(){var e,t=this._url;e=t?new i.default(t).getPathSegments():[];this._getPathSegments=function(){return e};return e};e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");this._getIndexOfDrivesSegment=function(){return e};return e};e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");this._getIndexOfItemsSegment=function(){return e};return e};return e})();t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("Sit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["lCe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("nit",["require","exports","g","v","ait"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var s={pageContext:n.pageContext};t.resourceKey=r.createResolvedResourceKey(e("module").id,i.UserInfoDataSource,s)});
define("tit",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GuidedTourDataHelper=void 0;var n=(function(){function e(){this.resetGuidedTourUserFact()}e.prototype.getGuidedTourData=function(){return this._guidedTourData};e.prototype.setGuidedTourData=function(e){this._guidedTourData=e};e.prototype.getGuidedTourCompleted=function(){var e=this._guidedTourData;return!(!e||!e.c)};e.prototype.getGuidedTourViewCount=function(){var e=this._guidedTourData.v;return void 0===e?0:e};e.prototype.updateGuidedTourData=function(e,t){var n=this._guidedTourData;e&&(n.c=!0);t&&(n.v=(n.v||0)+1)};e.prototype.completeGuidedTourAction=function(e){var t=this._guidedTourData;switch(e){case 0:t.u=!0;break;case 1:t.m=!0;break;case 2:t.s=!0;break;case 3:t.sh=!0;break;case 4:t.f=!0;break;default:return}};e.prototype.getCompletedGuidedTourActions=function(){var e=this._guidedTourData,t=[];e.u&&t.push(0);e.m&&t.push(1);e.s&&t.push(2);e.sh&&t.push(3);e.f&&t.push(4);return t};e.prototype.resetGuidedTourUserFact=function(){this._guidedTourData={c:!1,v:0,u:!1,m:!1,s:!1,sh:!1,f:!1}};return e})();t.GuidedTourDataHelper=n;t.default=n});
define("eit",["require","exports","ww","A","K3","tB","uv","G3","aee","g","nit","eQ","tit","tg","fe","pO","jq","v","k"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.UserInfoDataSource=void 0;var b=["guidedTour_oneDrive","teachingBubbles_oneDrive","surveyStatus_oneDrive","upsells_oneDrive"],w=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.userSettingsStoreKey="userinfo_odb_key";var s=y.Killswitch.isActivated("8dba7267-c081-480e-9601-f659d6395db5","09/09/2020","Add dependencies to UserInfoProvider and UserInfoDataSource");r.userSettingsStore=!s&&n.userSettingsStore||r.resources.consume(a.userSettingsStore.optional);r.dataStore=new i.default("UserInfo",u.default.local);r._pageContext=!s&&n.pageContext||r.resources.consume(f.pageContext);r.commonUserInfoDS=!s&&n.commonUserInfoDS||r.resources.consume(l.resourceKey);r._guidedTourDataHelper=new h.default;r._urlDataSource=!s&&n.urlDataSource||r.resources.consume(v.url);r._checkForParamOverrides();r._teachingBubbles={};r._surveyStatuses={};r._upsells={};return r}t.prototype.canPersistUserInfo=function(){var e=this._pageContext;return e&&Number(e.webTemplate)===o.default.mySite&&e.isSiteAdmin};t.prototype.getAnid=function(){return null};t.prototype.getMarket=function(){return null};t.prototype.getLanguage=function(){return null};t.prototype.isNewUser=function(){return null};t.prototype.isAuthenticated=function(){return!this._pageContext.isAnonymousGuestUser};t.prototype.getUserInfo=function(e){var t=this.userSettingsStore.getValue(this.userSettingsStoreKey);return r.default.resolve(t)};t.prototype.setUserInfo=function(e){var t=this.mergeUserInfo(e);this.userSettingsStore.setValue(this.userSettingsStoreKey,t);return r.default.resolve(!0)};t.prototype.setUserInfoWithUserFacts=function(e,t,n,r,i){var s={type:e,action:t};n&&(s.param=n);i&&(s.data=i);r&&(s.id=r);return this.setUserInfo(s)};t.prototype.sendShowUpsell=function(e,t,n){return r.default.resolve(!1)};t.prototype.sendCloseUpsell=function(e,t,n){return r.default.resolve(!1)};t.prototype.resetUpsellUserFact=function(){return r.default.resolve(!1)};t.prototype.updateUpsellData=function(e,t,n){return r.default.resolve(!1)};t.prototype.hasUserFact=function(e){return r.default.resolve(!1)};t.prototype.getUserFact=function(e){return r.default.resolve(null)};t.prototype.getIsPremium=function(e){return r.default.resolve(!1)};t.prototype.getUpsellToShow=function(e){return r.default.resolve(null)};t.prototype.getUpsellViewCount=function(e){return r.default.resolve(0)};t.prototype.getUpsellDismissed=function(e){return r.default.resolve(!1)};t.prototype.getUpsellIframeSrc=function(e,t){return r.default.resolve(null)};t.prototype.getFirstRunExperienceViewCount=function(){return r.default.resolve(0)};t.prototype.hasPositioningBeenViewed=function(){return r.default.resolve(!0)};t.prototype.datePositioningViewed=function(){return r.default.resolve(new Date)};t.prototype.getPremiumUpsellsViewed=function(){return r.default.resolve({hasPositioningViewed:!0,hasNewFeaturesViewed:!0,hasWelcomeToPremiumViewed:!0})};t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){return r.default.resolve(!0)};t.prototype.getWelcomeToPremiumViewed=function(){return r.default.resolve(!0)};t.prototype.setPositioningUserFactWithParams=function(e){return r.default.resolve(!0)};t.prototype.getExpiringSharingLinksSeen=function(){return r.default.wrap(!1)};t.prototype.setExpiringSharingLinksSeen=function(){};t.prototype.getGuidedTourCompleted=function(){var e=this;return this._populateCustomFacets().then(function(){return e._guidedTourDataHelper.getGuidedTourCompleted()},function(e){return!0})};t.prototype.getGuidedTourViewCount=function(){var e=this;return this._populateCustomFacets().then(function(){return e._guidedTourDataHelper.getGuidedTourViewCount()})};t.prototype.updateGuidedTourData=function(e,t){this._guidedTourDataHelper.updateGuidedTourData(e,t);return this._setCustomFacet("guidedTour_oneDrive",this._guidedTourDataHelper.getGuidedTourData())};t.prototype.completeGuidedTourAction=function(e){this._guidedTourDataHelper.completeGuidedTourAction(e);return this._setCustomFacet("guidedTour_oneDrive",this._guidedTourDataHelper.getGuidedTourData())};t.prototype.getCompletedGuidedTourActions=function(){var e=this;return this._populateCustomFacets().then(function(){return e._guidedTourDataHelper.getCompletedGuidedTourActions()})};t.prototype.resetGuidedTourUserFact=function(){var e=this;return this._populateCustomFacets().then(function(){e._guidedTourDataHelper.resetGuidedTourUserFact();return e._setCustomFacet("guidedTour_oneDrive",e._guidedTourDataHelper.getGuidedTourData())})};t.prototype.resetSurveyStatus=function(e){var t=this;return this._populateCustomFacets().then(function(){return t._setCustomFacet("surveyStatus_oneDrive",{campaignId:{a:!1,t:new Date}})})};t.prototype.getFirstRunExperienceDismissed=function(){return this.isAuthenticated()?this.getUserFlagValue("sharePointOneDriveBusinessFirstRun"):r.default.resolve(!0)};t.prototype.updateFirstRunExperienceData=function(e,t){return e?this.updateUserFlagValue("sharePointOneDriveBusinessFirstRun",!0):r.default.wrap(!1)};t.prototype.getBubbleUserFact=function(e,t){var n=this;return this._populateCustomFacets().then(function(){return n._teachingBubbles[e.campaignGuid]||{d:!1,v:0}},function(e){d.default.logError(e);return{d:!0,v:1}})};t.prototype.setBubbleUserFact=function(e,t){var n=this;return this._populateCustomFacets().then(function(){n._teachingBubbles[e.campaignGuid]=t;return n._setCustomFacet("teachingBubbles_oneDrive",n._teachingBubbles)})};t.prototype.getSurveyStatusUserFact=function(e){var t=this;return this._populateCustomFacets().then(function(){return t._surveyStatuses[e]?{activated:t._surveyStatuses[e].a,dateLastModified:new Date(t._surveyStatuses[e].t)}:{activated:!1,dateLastModified:new Date}},function(e){d.default.logError(e);return{activated:!0,dateLastModified:new Date}})};t.prototype.setSurveyStatusUserFact=function(e,t){var n=this;return this._populateCustomFacets().then(function(){n._surveyStatuses[e]={a:t.activated,t:t.dateLastModified.toISOString()};return n._setCustomFacet("surveyStatus_oneDrive",n._surveyStatuses)})};t.prototype.getUpsellDismissedById=function(e,t){return this._getUpsellUserFact(e,t).then(function(e){return!!e.d})};t.prototype.getUpsellViewCountById=function(e,t){return this._getUpsellUserFact(e,t).then(function(e){return e.v})};t.prototype.markUpsellAsSeen=function(e){var t=this;return this._getUpsellUserFact(e).then(function(n){n.v++;return t._setUpsellUserFact(e,n)})};t.prototype.markUpsellAsDismissed=function(e){var t=this;return this._getUpsellUserFact(e).then(function(n){n.d=!0;return t._setUpsellUserFact(e,n)})};t.prototype.getEXPExperimentVariation=function(e){return r.default.wrap(0)};t.prototype.setEXPExperimentVariation=function(e,t,n){return r.default.wrap(!1)};t.prototype.mergeUserInfo=function(e){var t=this.userSettingsStore.getValue(this.userSettingsStoreKey);if(t&&t.info&&t.info.length>0){for(var n=!1,r=0;r<t.info.length;r++){var i=t.info[r];if(i&&e&&i.type===e.type&&i.id===e.id){t.info[r]=e;n=!0;break}}n||t.info.push(e)}else t={info:[e]};return t};t.prototype.getUserFlagValue=function(e){return this.commonUserInfoDS.getUserFlagValue(e).then(function(e){return"boolean"!=typeof e||e})};t.prototype.updateUserFlagValue=function(e,t){return this.commonUserInfoDS.setUserFlagValue(e,t)};t.prototype._getUpsellUserFact=function(e,t){var n=this;return this._populateCustomFacets().then(function(){return n._upsells[e]||{d:!1,v:0}},function(e){d.default.logError(e);return{d:!0,v:1}})};t.prototype._setUpsellUserFact=function(e,t){var n=this;return this._populateCustomFacets().then(function(){n._upsells[e]=t;return n._setCustomFacet("upsells_oneDrive",n._upsells)})};t.prototype._populateCustomFacets=function(){var e=this;if(this._pendingRequest)return this._pendingRequest;var t=this._urlDataSource.getRootItemKey(),n=this.resources.consumeAsync(m.resourceKey.optional).then(function(n){return n?n.ensureAuthToken(t).then(function(){return e._populateCustomFacetInternal()},function(t){delete e._pendingRequest;return r.default.wrapError(t)}):e._populateCustomFacetInternal()},function(t){delete e._pendingRequest;return r.default.wrapError(t)});this._pendingRequest=n;return n};t.prototype._populateCustomFacetInternal=function(){var e=this;return this.resources.consume(c.resourceKey).send({path:"/drive/root?$select="+b.join(","),apiName:"CustomFacets.Get",apiVersion:"v2.1"}).then(function(t){e._updateCustomFacetCache(t)},function(t){delete e._pendingRequest;return r.default.wrapError(t)})};t.prototype._setCustomFacet=function(e,t){var n=this,r=this._urlDataSource.getRootItemKey();return this.resources.consumeAsync(m.resourceKey.optional).then(function(i){i&&i.ensureAuthToken(r).then(function(){return n._getCustomFacetInternal(e,t)},function(e){return!1});return n._getCustomFacetInternal(e,t)},function(e){return!1})};t.prototype._getCustomFacetInternal=function(e,t){var n,r=this,i=((n={})[e]=t,n);return this.resources.consume(c.resourceKey).send({path:"/drive/root",apiName:"CustomFacets.Set",requestType:"PATCH",postData:JSON.stringify(i),apiVersion:"v2.1"}).then(function(e){r._updateCustomFacetCache(e);return!0},function(e){return!1})};t.prototype._updateCustomFacetCache=function(e){e.guidedTour_oneDrive&&this._guidedTourDataHelper.setGuidedTourData(e.guidedTour_oneDrive);e.teachingBubbles_oneDrive&&(this._teachingBubbles=e.teachingBubbles_oneDrive);e.upsells_oneDrive&&(this._upsells=e.upsells_oneDrive);e.surveyStatus_oneDrive&&(this._surveyStatuses=e.surveyStatus_oneDrive)};t.prototype._checkForParamOverrides=function(){var e=this.resources.consume(p.navigation).viewParams;e.resetGuidedTour&&this.resetGuidedTourUserFact();e.resetFre&&this.updateUserFlagValue("sharePointOneDriveBusinessFirstRun",!1);e.resetSurveyStatus&&this.resetSurveyStatus(e.resetSurveyStatus)};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{userSettingsStore:a.userSettingsStore.optional,pageContext:f.pageContext,commonUserInfoDS:l.resourceKey,urlDataSource:v.url});return t})(s.default);t.UserInfoDataSource=w;t.default=w;t.resourceKey=g.createResolvedResourceKey(e("module").id,w)});
define("oTe",["require","exports","ww","tB","ze","M","fB","D7","Aq","Y2","g"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._pageContext=n.resources.consume(l.pageContext);n._dataRequestor=new(n.child(f.typeResourceKey))({qosName:"VersionControlDataSource"});n._itemUrlHelper=n.resources.consume(u.resourceKey);n._apiUrlHelper=n.resources.consume(a.resourceKey);return n}t.prototype.checkOutItem=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.item.key),n=this._apiUrlHelper.build().webByItemUrl(t);n=(n=n.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl})).segment("CheckOut");return this._dataRequestor.getData({url:n.toString(),qosName:"CheckOutItem"})};t.prototype.undoCheckOutItem=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.item.key),n=this._apiUrlHelper.build().webByItemUrl(t);n=(n=n.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl})).segment("UndoCheckOut");return this._dataRequestor.getData({url:n.toString(),qosName:"UndoCheckOutItem"})};t.prototype.checkInItem=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.item.key),n=this._apiUrlHelper.build().webByItemUrl(t);n=(n=n.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl})).methodWithAliases("CheckIn",{comment:e.comments,checkintype:0});return this._dataRequestor.getData({url:n.toString(),qosName:"CheckInItem"})};t.prototype.getVersionHistoryUrl=function(e,t,n){var r=[i.default.escapeUrlForCallback(this._pageContext.webAbsoluteUrl),"/",this._pageContext.layoutsUrl,n?"/DocSetVersions.aspx?ID=":"/Versions.aspx?FileName=",i.default.encodeURIComponent(e),"&IsDlg=1"];if(t){r.push("&list=");r.push(i.default.encodeURIComponent(s.default.normalizeUpper(t,!0)))}return r.join("")};t.prototype.supportsDocSetVersioning=function(){return o.isFeatureEnabled(o.DocumentSetsModernView)&&o.isFeatureEnabled(o.UseItemsScopeInTeamSites)};return t})(r.default);t.default=c});
define("rTe",["require","exports","ww","A","ey","Yy","tB","Je","D7","Aq","Y2"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=!u.default.isActivated("AF81BA9B-0BB4-4CEE-84DD-4145A9A2D19E","07/19/2019","Switch to a newer API for getting version information"),h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._dataRequestor=new(n.child(l.typeResourceKey))({qosName:"VersionHistoryDataSource"});n._itemUrlHelper=n.resources.consume(a.resourceKey);n._apiUrlHelper=n.resources.consume(f.resourceKey);return n}t.prototype.getVersionHistoryInfo=function(e){var t=this;return c?this._getVersionHistory(e):r.default.all({vh:this._getOldVersionHistory(e),cv:this._getCurrentVersion(e)}).then(function(n){var r=n.vh,i=n.cv,s=t._parseVersionHistory(r,e),o=t._parseCurrentVersion(i,e);s.push(o);return s.reverse()})};t.prototype.restoreVersionByLabel=function(e,t){return this._restoreVersion(e,t)};t.prototype.deleteVersionByLabel=function(e,t){return this._deleteVersion(e,t)};t.prototype.canRestoreVersions=function(e){return this.canDeleteVersions(e)};t.prototype.canDeleteVersions=function(e){var t=!1;e&&(t=i.PermissionMask.hasItemPermission(e,i.PermissionMask.deleteVersions));return t};t.prototype.showVersionLabel=function(){return!0};t.prototype._getApiUrlForItem=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(t).methodWithAliases("GetFileByServerRelativePath",{decodedUrl:t.serverRelativeItemUrl})};t.prototype._getOldVersionHistory=function(e){var t=this._getApiUrlForItem(e).segment("versions").oDataParameter("$expand","CreatedBy");return this._dataRequestor.getData({url:t.toString(),qosName:"getVersionHistory",method:"GET"}).then(function(e){return e.d})};t.prototype._getVersionHistory=function(e){var t=this,n=this._itemUrlHelper.getItemUrlParts(e.key),r=this._apiUrlHelper.build().webByItemUrl(n).methodWithAliases("GetListItemUsingPath",{decodedUrl:n.serverRelativeItemUrl}).segment("versions").oDataParameter("$select","VersionId,VersionLabel,Created,CreatedBy/Title,CreatedBy,FileVersion/Url,FileVersion/Length,SMTotalFileStreamSize,IsCurrentVersion").oDataParameter("$expand","CreatedBy,FileVersion");return this._dataRequestor.getData({url:r.toString(),qosName:"getVersionHistory",method:"GET"}).then(function(n){return n.d.results.map(function(n){var r="z"===n.Created[n.Created.length-1].toLowerCase()?n.Created:n.Created+"Z";return{created:new Date(r),id:""+n.VersionId,isCurrentVersion:n.IsCurrentVersion,size:n.FileVersion.Length?Number(n.FileVersion.Length):Number(n.SMTotalFileStreamSize),url:n.FileVersion.Url?t._getUrl(e,n.FileVersion.Url):e.openUrl,versionLabel:n.VersionLabel,appMap:e.appMap,createdBy:n.CreatedBy}})})};t.prototype._getCurrentVersion=function(e){var t=this._getApiUrlForItem(e).oDataParameter("$expand","ModifiedBy");return this._dataRequestor.getData({url:t.toString(),qosName:"getCurrentVersion",method:"GET"}).then(function(e){return e.d})};t.prototype._restoreVersion=function(e,t){var n=this._getApiUrlForItem(e).segment("versions").methodWithAliases("RestoreByLabel",{versionLabel:t});return this._dataRequestor.getData({url:n.toString(),qosName:"restoreVersionByLabel",method:"POST"}).then(function(e){return!!e.d},function(e){alert(e.message.value);return!1})};t.prototype._deleteVersion=function(e,t){var n=this._getApiUrlForItem(e).segment("versions").methodWithAliases("RecycleByLabel",{versionLabel:t});return this._dataRequestor.getData({url:n.toString(),qosName:"deleteVersionByLabel",method:"POST"}).then(function(e){return!!e.d},function(e){alert(e.message.value);return!1})};t.prototype._parseCurrentVersion=function(e,t){return{created:new Date(e.TimeLastModified),id:e.UIVersion,isCurrentVersion:!0,size:Number(e.Length),url:e.LinkingUri||t.openUrl,versionLabel:e.UIVersionLabel,appMap:t.appMap,createdBy:e.ModifiedBy}};t.prototype._parseVersionHistory=function(e,t){var n=this;return e.results.map(function(e){return{created:new Date(e.Created),id:e.ID,isCurrentVersion:e.IsCurrentVersion,size:e.Size,url:n._getUrl(t,e.Url),versionLabel:e.VersionLabel,appMap:t.appMap,createdBy:e.CreatedBy}})};t.prototype._getUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return s.encodePath(n.fullItemUrl.replace(n.webRelativeItemUrl,t))};return t})(o.default);t.default=h});
define("Vit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["ITe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Nte",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["uCe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Iit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["JPt"],t,n)}).then(function(e){return e.resourceKey})})})});
define("_Pe",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var r=(function(){function e(e,t){}e.prototype.isWIPEnabled=function(){return!1};return e})();t.default=r;t.resourceKey=n.createResolvedResourceKey(e("module").id,r,{})});
define("Git",["require","exports","k3","v","Je"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var s=(function(){function e(e,t){var n=t.platformDetection;this._wordAction=n.isMobile&&!n.isIPad?"mobileview":"embedview"}e.prototype.getWopiFrameUrl=function(e,t){var n="ms-word"===e.appMap,r=e.wopiFrameUrl,s=n?this._wordAction:"embedview",o=r&&r.replace(/action=([^&]+)/,"action="+s+"&wdnc=1&nobg=1"),u=!i.default.isActivated("39DAEB9C-30C1-475B-8697-193E51D49CD3","4/17/2019","Use doc.aspx for hosting WAC");return o?o.replace(/\/_layouts\/[^?]+/i,"/_layouts/15/"+(t?"WopiEmbedFrame":u?"doc":"WopiFrame")+".aspx"):void 0};return e})();t.default=s;t.resourceKey=r.createResolvedResourceKey(e("module").id,s,{platformDetection:n.platformDetection})});
define("ort",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Bwe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("GC",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FILE_PICKER_PARAM_KEY=void 0;t.FILE_PICKER_PARAM_KEY="filePicker"});
define("KK",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey("correlationId")});
define("a$e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isCommentDisabled=t.getCommentFlags=void 0;var n=1;t.getCommentFlags=function(e){var t={};t.isCommentDisabled=r(e);return t};function r(e){return void 0===e||null==e||(e&n)>0}t.isCommentDisabled=r});
define("WC",["require","exports","Ye"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemTypeFilter=void 0;Object.defineProperty(t,"ItemTypeFilter",{enumerable:!0,get:function(){return n.ItemTypeFilter}})});
define("wq",["require","exports","Eq","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var i=(function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),r=n&&(n.parentKey||n.parent&&n.parent.key);return r?this._itemsStore.getItem(r):void 0}};e.prototype.getFacetedAncestorOrSelf=function(e,t,n){void 0===n&&(n="");return this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var n,r=e&&e.key;r;){var i=this._itemsStore.getItem(r),s=i&&i.peek();if(!s)break;if(t(s)){n=i;break}r=s&&(s.parentKey||s.parent&&s.parent.key)}return n};e.dependencies={itemsStore:n.resourceKey};return e})();t.default=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i)});
define("s$e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"]});
define("Ex",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.File=0]="File";e[e.Folder=1]="Folder";e[e.Media=2]="Media";e[e.OneNote=3]="OneNote";e[e.Unknown=4]="Unknown";e[e.Error=5]="Error";e[e.App=6]="App";e[e.Subsite=7]="Subsite";e[e.Shortcut=8]="Shortcut"})(n||(n={}));t.default=n});
define("sz",["require","exports","xv"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){void 0===e&&(e="");this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=n.default.Files;this.displayType=n.default.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.default=r});
define("B$",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"})(n||(n={}));t.default=n});
define("DZ",["require","exports","WX"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.baseFlow=t.createWorkflow=void 0;t.createWorkflow=new n.default("createWorkflow");t.baseFlow=new n.default("baseFlow")});
define("C$",["require","exports","WX"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.printPdf=t.pinToMru=t.createShortcut=t.editItem=t.quickEdit=t.openPdfInBrowser=t.openInImageEditor=t.openInTextEditor=t.open=t.changeExpiration=t.createText=t.restoreAllItems=t.deleteAllItems=t.restoreItem=t.deleteItem=t.copyTo=t.moveTo=t.copyFrom=t.moveFrom=t.rename=t.createFolder=void 0;t.createFolder=new n.default("createFolder");t.rename=new n.default("rename");t.moveFrom=new n.default("moveFrom");t.copyFrom=new n.default("copyFrom");t.moveTo=new n.default("moveTo");t.copyTo=new n.default("copyTo");t.deleteItem=new n.default("deleteItem");t.restoreItem=new n.default("restoreItem");t.deleteAllItems=new n.default("deleteAllItems");t.restoreAllItems=new n.default("restoreAllItems");t.createText=new n.default("createText");t.changeExpiration=new n.default("changeExpiration");t.open=new n.default("open");t.openInTextEditor=new n.default("openInTextEditor");t.openInImageEditor=new n.default("openInImageEditor");t.openPdfInBrowser=new n.default("openPdfInBrowser");t.quickEdit=new n.default("quickEdit");t.editItem=new n.default("editItem");t.createShortcut=new n.default("createShortcut");t.pinToMru=new n.default("pinToMru");t.printPdf=new n.default("printPdf")});
define("Bit",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){void 0===e&&(e={});var t=e.behavior;this.behavior=t};t.default=n});
define("WX",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(t){this.id=""+ ++e._lastId;this.name=t}e.prototype.matches=function(e){return e===this};e._lastId=0;return e})();t.default=n});
define("X$",["require","exports","WX"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.exportList=t.versionHistory=t.viewItem=t.editItem=t.quickEdit=t.checkout=void 0;t.checkout=new n.default("checkout");t.quickEdit=new n.default("quickEdit");t.editItem=new n.default("editItem");t.viewItem=new n.default("viewItem");t.versionHistory=new n.default("versionHistory");t.exportList=new n.default("exportList")});
define("N$",["require","exports","WX"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadTemplate=t.editNewMenu=t.contentTypeNavigation=t.openInPowerBI=t.viewVersionHistory=t.openInClient=t.openOnline=t.publishSurvey=t.editSurvey=t.viewSurvey=t.createSurvey=t.createWord=t.createPowerPoint=t.createOneNote=t.createExcel=void 0;t.createExcel=new n.default("createExcel");t.createOneNote=new n.default("createOneNote");t.createPowerPoint=new n.default("createPowerPoint");t.createWord=new n.default("createWord");t.createSurvey=new n.default("createSurvey");t.viewSurvey=new n.default("viewSurvey");t.editSurvey=new n.default("editSurvey");t.publishSurvey=new n.default("publishSurvey");t.openOnline=new n.default("openOnline");t.openInClient=new n.default("openInClient");t.viewVersionHistory=new n.default("viewVersionHistory");t.openInPowerBI=new n.default("openInPowerBI");t.contentTypeNavigation=new n.default("contentTypeNavigation");t.editNewMenu=new n.default("editNewMenu");t.uploadTemplate=new n.default("uploadTemplate")});
define("KX",["require","exports","WX"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addPhotosToAlbum=t.removeFromAlbum=t.addToAlbum=t.removeOfficeLens=t.applyOfficeLens=t.viewOriginal=t.removeTags=t.editTags=t.editCaption=t.rotate=t.play=void 0;t.play=new n.default("play");t.rotate=new n.default("rotate");t.editCaption=new n.default("editCaption");t.editTags=new n.default("editTags");t.removeTags=new n.default("removeTags");t.viewOriginal=new n.default("viewOriginal");t.applyOfficeLens=new n.default("applyOfficeLens");t.removeOfficeLens=new n.default("removeOfficeLens");t.addToAlbum=new n.default("addToAlbum");t.removeFromAlbum=new n.default("removeFromAlbum");t.addPhotosToAlbum=new n.default("addPhotosToAlbum")});
define("m$",["require","exports","WX"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToSpotlight=t.alertItem=t.requestReview=t.reportAbuse=t.removeAsMountPoint=t.addAsMountPoint=t.removeFromShared=t.comment=t.embed=t.addToShared=t.share=void 0;t.share=new n.default("share");t.addToShared=new n.default("addToShared");t.embed=new n.default("embed");t.comment=new n.default("comment");t.removeFromShared=new n.default("removeFromShared");t.addAsMountPoint=new n.default("addAsMountPoint");t.removeAsMountPoint=new n.default("removeAsMountPoint");t.reportAbuse=new n.default("reportAbuse");t.requestReview=new n.default("requestReview");t.alertItem=new n.default("alertItem");t.addToSpotlight=new n.default("alertItem")});
define("yee",["require","exports","WX"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sync=t.download=t.upload=void 0;t.upload=new n.default("upload");t.download=new n.default("download");t.sync=new n.default("sync")});
define("p$",["require","exports","cB"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemEngagementPart=void 0;t.itemEngagementPart=new n.EngagementPart("Item",1)});
define("wCe",["require","exports","Ow","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isActivityFieldEnabledResourceKey=t.isActivityFieldVisibleResourceKey=void 0;t.isActivityFieldVisibleResourceKey=new r.ResourceKey({name:e("module").id+".isActivityFieldVisible",factory:new r.ConstantResourceFactory(n.isFeatureEnabled(n.ItemActivityColumn))});t.isActivityFieldEnabledResourceKey=new r.ResourceKey({name:e("module").id+".isActivityFieldEnabled",factory:new r.ConstantResourceFactory(n.isFeatureEnabled(n.ItemActivityColumn))})});
define("ZK",["require","exports","XK","t","rB"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t,s){this.key=e||"";this.content=r.observable(new n.default(s));this.content.equalityComparer=i.objectStrictEquality;this.schema=r.observableArray([]);this.schema.equalityComparer=i.arrayStrictEquality;this.context=r.utils.extend({},t);this.contentTypes=r.observableArray([]);this.isPlaceholder=!0;this.version=0};t.default=s});
define("XK",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0};t.default=n});
define("Rq",["require","exports","v","Ow","k3"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isVroomEnabledInItemsScopeSinglePlaceViewResourceKey=t.isVroomEnabledInItemsScopeSingleTagViewResourceKey=t.isVroomEnabledInItemsScopeAllPhotosPivotResourceKey=t.isItemsScopeEnabledInAllAlbumsPivotResourceKey=t.isItemsScopeEnabledInAllPlacesPivotResourceKey=t.isItemsScopeEnabledInAllTagsPivotResourceKey=t.isItemsScopeEnabledInAllPhotosFilePickerResourceKey=t.isItemsScopeEnabledInSinglePlaceViewResourceKey=t.isItemsScopeEnabledInSingleTagViewResourceKey=t.isItemsScopeEnabledInSingleAlbumViewResourceKey=t.isItemsScopeEnabledInAllPhotosPivotResourceKey=t.isItemsScopeEnabledInCrossSitePivotsResourceKey=t.isItemsScopeEnabledInSharedPivotResourceKey=t.isItemsScopeEnabledInRecentPivotResourceKey=t.isItemsScopeEnabledInFilesPivotResourceKey=t.isItemsScopeEnabledResourceKey=void 0;t.isItemsScopeEnabledResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabled",factory:{dependencies:{},create:function(e){return{instance:r.isOneDrive?r.isFeatureEnabled(r.UseItemsScopeInOneDrive)||r.isFeatureEnabled(r.UseItemsScopeInSitesForODB):r.isFeatureEnabled(r.UseItemsScopeInTeamSites)}}}});t.isItemsScopeEnabledInFilesPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInFilesPivot",factory:{dependencies:{},create:function(){return{instance:r.isOneDrive?r.isFeatureEnabled(r.UseItemsScopeInOneDrive):r.isFeatureEnabled(r.UseItemsScopeInTeamSites)}}}});t.isItemsScopeEnabledInRecentPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInRecentPivot",factory:{dependencies:{},create:function(){return{instance:r.isFeatureEnabled(r.EnableRecentWithGraphAddon)}}}});t.isItemsScopeEnabledInSharedPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInSharedPivot",factory:{dependencies:{},create:function(){return{instance:r.isFeatureEnabled(r.UseItemsScopeInShared)}}}});t.isItemsScopeEnabledInCrossSitePivotsResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInCrossSitePivots",factory:{dependencies:{},create:function(){return{instance:!!r.isOneDrive&&r.isFeatureEnabled(r.UseItemsScopeInSitesForODB)}}}});t.isItemsScopeEnabledInAllPhotosPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInAllPhotosPivot",factory:{dependencies:{platformDetection:i.platformDetection},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInAllPhotos)&&(!e.platformDetection.isIE||r.isFeatureEnabled(r.UseItemsScopeInAllPhotosEnableIE))&&(!e.platformDetection.isSafari||r.isFeatureEnabled(r.UseItemsScopeInAllPhotosEnableSafari))&&(!e.platformDetection.isMobile||r.isFeatureEnabled(r.UseItemsScopeInAllPhotosEnableMobile))}}}});t.isItemsScopeEnabledInSingleAlbumViewResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInSingleAlbumView",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInSingleAlbum)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInSingleTagViewResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInSingleTagView",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInSingleTag)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInSinglePlaceViewResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInSinglePlace",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInSinglePlace)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInAllPhotosFilePickerResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInAllPhotosFilePicker",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInAllPhotosEnableInFilePicker)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInAllTagsPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInAllTagsPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInAllTags)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInAllPlacesPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInAllPlacesPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInPlaces)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInAllAlbumsPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInAllAlbumsPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInAlbums)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isVroomEnabledInItemsScopeAllPhotosPivotResourceKey=new n.ResourceKey({name:e("module").id+".isVroomEnabledInAllPhotosPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseVroomInItemsScopeAllPhotos)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isVroomEnabledInItemsScopeSingleTagViewResourceKey=new n.ResourceKey({name:e("module").id+".isVroomEnabledInSingleTagView",factory:{dependencies:{isItemsScopeEnabledInSingleTagView:t.isItemsScopeEnabledInSingleTagViewResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseVroomInItemsScopeSingleTag)&&e.isItemsScopeEnabledInSingleTagView}}}});t.isVroomEnabledInItemsScopeSinglePlaceViewResourceKey=new n.ResourceKey({name:e("module").id+".isVroomEnabledInSinglePlaceView",factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:t.isItemsScopeEnabledInSinglePlaceViewResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseVroomInItemsScopeSinglePlace)&&e.isItemsScopeEnabledInSinglePlaceView}}}})});
define("AZ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isViewByTitle=t.isViewByUrl=t.isViewById=void 0;t.isViewById=function(e){return e&&!!e.id};t.isViewByUrl=function(e){return e&&!!e.url};t.isViewByTitle=function(e){return e&&!!e.title}});
define("WK",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.allowInfectedFileDownloadsResourceKey=void 0;t.allowInfectedFileDownloadsResourceKey=new n.ResourceKey({name:e("module").id+".allowInfectedFileDownloads",factory:new n.ConstantResourceFactory(!1)})});
define("UZ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OperationError=void 0;var n=function(e){this.errorType=e.errorType||0;this.message=e.message;this.payloads=e.payloads||{}};t.OperationError=n;t.default=n});
define("v4e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DisplayType=void 0;var n;(function(e){e[e.Page=0]="Page";e[e.Card=1]="Card"})(n=t.DisplayType||(t.DisplayType={}));t.default=n});
define("xte",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isOutOfTheBoxList=void 0;var n="_shareHeroCommand",r="_calloutInvoker",i=["DocIcon","LinkFilename",n,r,"Modified","Editor"];t.isOutOfTheBoxList=function(e,t){if(e.length===i.length){for(var s=0;s<i.length;s++){var o=i[s];if(!(t&&o===n||o===r)&&e[s].internalName!==o)return!1}return!0}return!1}});
define("Qb",["require","exports","ww","I"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.trackPromise=function(e){var t=!1,n=this.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),r=function(){t=!0;n.dispose()};e.done(r,r);return e};t.prototype.trackSignal=function(e){this.attach({dispose:function(){e.cancel()}});return e};return t})(r.default);t.default=i});
define("m5e",["require","exports","M","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory(n.default.generate())})});
define("Eq",["require","exports","ww","sz","K3","nB","v","Nx","rB","Ex","Nz","bH","fB","rt"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ItemsStore=void 0;var d=h.isFeatureEnabled(h.ReadOnlyItemsStore);function v(e){return e&&e.item&&e.item.peek().key}function m(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null;n.items=[];t.valueHasMutated()}var g=(function(e){n.__extends(t,e);function t(){var t=e.call(this,"ItemsStore")||this;t._itemSetsKeys={};t._observables=new s.default({owner:t});t._vaultItemsToPurge=[];window.odstore=t;return t}t.prototype.dispose=function(){this._observables.dispose()};t.prototype.setItem=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this._handleSetItem.apply(this,n.__spreadArrays([e],t))};t.prototype.getItem=function(e){return this.getValue("item="+e)};t.prototype.setItemSet=function(e,t){var n="result="+e;this.setValue(n,t);this._itemSetsKeys[n]=1};t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var r=(t=this.getValue(n)).content&&t.content.peek(),i=r&&r.items;if(i)for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u&&u.peek().parentKey===e)return t}}};t.prototype.getItemSet=function(e){return this.getValue("result="+e)};t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice("result=".length));return e};t.prototype.setNextRequestToken=function(e,t,n){var r="token="+t;n?this.setValue(r,n):this.remove(r)};t.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,r=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),r)};t.prototype.invalidateItemSet=function(e){var t=this.getValue("result="+e);t&&m(t)};t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&m(t)};t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var r=v(t=this.getValue(n));if(r){var i=u.deserializeQuery(r),s=i&&i.locationFilter;s&&s.indexOf(e)>=0&&(t.isExpired=!0)}}};t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var r=v(t=this.getValue(n));if(r){var i=u.deserializeQuery(r);i&&i.tagFilter===e&&(t.isExpired=!0)}}};t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();if(n&&n.key&&n.key.indexOf("allmyphotos")>=0){e.isExpired=!0;this._invalidateItem(n)}}};t.prototype.invalidateAllVault=function(){for(var e=0,t=n.__spreadArrays(this._vaultItemsToPurge);e<t.length;e++){var i=t[e],s=void 0;if(i.vault&&i.vault.root){(s=new r.default(i.key)).name=i.name;s.displayName=i.displayName;s.dateModified=" ";s.folder={};s.vault={isLocked:!0,root:{}}}this._purgeItem(i,s)}this._vaultItemsToPurge=[]};t.prototype._handleItemInvalidation=function(e,t,n){var r=this;if(t){var i=t.peek(),s=!1,o=[];if(i){o.push(i);switch(i.type){case f.default.Folder:case f.default.Media:s=!0}}for(var u in this._itemSetsKeys){var a=this.getValue(u),l=a.item&&a.item.peek(),c=l&&l.key;if(c&&(c===e||s&&c.indexOf("allmyphotos")>-1)){c===e?this.setNextRequestToken(e,a.key,""):o.push(l);a.isExpired=!0}}o.forEach(n?function(e){return r._purgeItem(e)}:function(e){return r._invalidateItem(e)})}};t.prototype._purgeItem=function(e,t){var n=t||new r.default(e.key);this.setItem(n)};t.prototype._invalidateItem=function(e){var t=new r.default(e.key);c.default(t,e);c.default(t,{revision:e.revision+1});this.setItem(t)};t.prototype._handleSetItem=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i=[];d&&!Object.isFrozen(e)&&Object.freeze(e);e.vault&&this._vaultItemsToPurge.push(e);e.remoteItem&&(e.iconUrl=p.ITEM_TYPES+"20/linkedfolder.svg");for(var s=function(t){var n="item="+t,r=d?"item_write="+t:n,s=o.getValue(n),u=o.getValue(r);if(u)u(e);else{(u=o._observables.create(e)).equalityComparer=a.objectStrictEquality;o.setValue(r,u);s=d?o._observables.pureCompute(function(){return u()}):u;o.setValue(n,s)}i.push(s)},o=this,u=0,f=l.removeDuplicates(n.__spreadArrays([e.key],t));u<f.length;u++){var c=f[u];s(c)}return i[0]};return t})(i.default);t.ItemsStore=g;t.resourceKey=new o.ResourceKey({name:e("module").id,factory:new o.SimpleResourceFactory(g)});t.default=g});
define("Mat",["require","exports","ww","t","K3"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return e.call(this,"UserInfoStore")||this}t.prototype.getUserInfo=function(){var e=this.getValue("userInfo");if(!e){e=r.observable(null);this.setValue("userInfo",e)}return e};return t})(i.default);t.default=s});
define("Lat",["require","exports","ww","K3","G3"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,"UserSettingsStore",i.default.local)||this;n._defaultRootItemId=t&&t.defaultRootItemId||"";n._viewerId=t&&t.viewerId||"";return n}t.prototype.setAllPhotosUserSettings=function(e){this.setValue(this._getLocalStorageKey(),e)};t.prototype.getAllPhotosUserSettings=function(){var e=this.getValue(this._getLocalStorageKey());if(!e){e={isAscending:!1,rootId:this._defaultRootItemId};this.setAllPhotosUserSettings(e);e=this.getValue(this._getLocalStorageKey())}return e};t.prototype._getLocalStorageKey=function(){return"allPhotosUserSettings&viewerId="+this._viewerId};return t})(r.default);t.default=s});
define("qO",["require","exports","QO"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n.SUITE_NAV_LINK_IDS});
define("Gq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){if((function(e){return!!e&&"object"==typeof e})(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e})();t.default=n});
define("pit",["require","exports","mit","kq","fB"],function(e,t,n,r,i){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0});t.baseUrl=t.intBaseUrl=void 0;var o=window.$Config&&window.$Config.isINT;t.intBaseUrl="https://messaging-int.msonerm.com/";t.baseUrl="https://dynmsg.modpim.com/";var u=((s={})[r.default.NewBrandFRE]={id:r.default.NewBrandFRE,type:n.default.FRE,checkThrottle:function(e){return e.viewCount<=2&&!e.didUserDismiss},getUpsellIframeUrl:function(e){return(o?t.intBaseUrl:t.baseUrl)+"api/v1/messaging/web/message?puid="+e.upsellUserId+"&locale="+e.market+"&Source=OneDriveFRE"},shouldSendMessageOnClose:!0,renderType:0},s[r.default.OneRmO365Upsell]={id:r.default.OneRmO365Upsell,type:n.default.ONEUNIT,ramp:i.OneRmO365UpsellEnabled,checkThrottle:function(e){return i.isFeatureEnabled(i.OneRmO365UpsellEnabled)},getUpsellIframeUrl:function(e){return(o?t.intBaseUrl:t.baseUrl)+"api/v1/messaging/web/message?puid="+e.upsellUserId+"&locale="+e.market+"&data="+encodeURIComponent(JSON.stringify({isO365:e.isO365,bytesUsed:e.bytesUsed,bytesAvailable:e.bytesAvailable}))+"&Source=OneDriveWebBanner"},shouldSendMessageOnClose:!0,renderType:1},s);t.default=u});
define("mit",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.FRE=0]="FRE";e[e.ONEUNIT=1]="ONEUNIT"})(n||(n={}));t.default=n});
define("kq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.None=0]="None";e[e.NewBrandFRE=1]="NewBrandFRE";e[e.MusicFolderCreationOld=2]="MusicFolderCreationOld";e[e.MusicFolderCreation=3]="MusicFolderCreation";e[e.OneUnitUpsell=4]="OneUnitUpsell";e[e.OneDriveBusinessUpsell=5]="OneDriveBusinessUpsell";e[e.TenGigMaxFileSize=6]="TenGigMaxFileSize";e[e.PreviewTagsView=7]="PreviewTagsView";e[e.XboxMusic=8]="XboxMusic";e[e.O365Upsell1=9]="O365Upsell1";e[e.O365Upsell2=10]="O365Upsell2";e[e.O365Upsell3=11]="O365Upsell3";e[e.O365Upsell4=12]="O365Upsell4";e[e.OneRmO365Upsell=13]="OneRmO365Upsell";e[e.FirstRunExperienceDialog=14]="FirstRunExperienceDialog";e[e.ExpiringSharingLinks=15]="ExpiringSharingLinks";e[e.MobileUpsell=16]="MobileUpsell";e[e.WrsIntroduction=17]="WrsIntroduction"})(n||(n={}));t.default=n});
define("Cq",["require","exports","tB","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new r.ResourceKey({name:e("module").id+".useItemCacheData",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})});
define("zie",["require","exports","tB","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new r.ResourceKey({name:e("module").id+".useItemsScope",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})});
define("srt",["require","exports","ww","v","xv","g","LO","DPe","Aq","D7","wq","Y2","zi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var p=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._currentItem=n.currentItem;r._apiUrlHelper=n.apiUrlHelper;r._pageContext=n.pageContext;r._itemUrlHelper=n.itemUrlHelper;r._itemParentHelper=n.itemParentHelper;var i=n.dataRequestorType;r._dataRequestor=r.scope.attach(new i({qosName:"SortManager"}));return r}t.prototype.updateSort=function(t,n){e.prototype.updateSort.call(this,t,n);var r=this._currentItem.peek(),s=r.queryType===i.default.Files,o=this._itemUrlHelper.getItemUrlParts(r.key),u=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(r,"list")),a=!u.list.isExternal&&u.list&&u.list.templateType===h.ListTemplateType.mySiteDocumentLibrary;if(this._pageContext.isSiteAdmin&&s&&a&&!o.isCrossList){var f=n?"TRUE":"FALSE",l=this._apiUrlHelper.build().webByItemUrl(o).method("GetList",this._pageContext.listUrl).segment("DefaultView").segment("SetViewXml");this._dataRequestor.getData({url:l.toString(),method:"POST",qosName:"SetDefaultView",noRedirect:!0,additionalPostData:JSON.stringify({viewXml:'<View><Query><OrderBy><FieldRef Name="'+t+'" Ascending="'+f+'" /></OrderBy></Query></View>'})})}};t.dependencies=n.__assign(n.__assign({},u.default.dependencies),{apiUrlHelper:a.resourceKey,pageContext:s.pageContext,dataRequestorType:c.typeResourceKey,currentItem:o.currentItem,itemUrlHelper:f.resourceKey,itemParentHelper:l.resourceKey});return t})(u.default);t.default=p;t.resourceKey=r.createResolvedResourceKey(e("module").id,p)});
define("vit",["require","exports","ww","v","tB","EI","pO","LO","xv","fB","D7","Rq","Ny"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.useItemsScopeResourceKey=t.resourceKey=t.UseItemsScopeWatch=void 0;var p=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this)||this;r._resources=n.resources;r._isItemsScopeEnabledInFilesPivot=n.isItemsScopeEnabledInFilesPivotResource;r._isItemsScopeEnabledInCrossSitePivots=n.isItemsScopeEnabledInCrossSitePivotsResource;r._itemUrlHelper=n.itemUrlHelper;r.useItemsScope=r.createPureComputed(r._getUseItemsScope);return r}t.prototype._getUseItemsScope=function(){var e=this._resources.consume(u.viewParams),t=this._resources.consume(o.url),n=e(),r=n.parent?n.parentview:n.view,i=r?Number(r):a.default.Files,l=Number(n.p);if(!isNaN(l)&&l!==s.default.Files)return!1;var c=t.getCurrentItemKey(n);if(i===a.default.Files){if(this._itemUrlHelper.getItemUrlParts(c).isCrossDomain){if(this._isItemsScopeEnabledInCrossSitePivots())return!0}else if(this._isItemsScopeEnabledInFilesPivot())return!0}return!(i!==a.default.DocumentLibraries||!this._isItemsScopeEnabledInCrossSitePivots())||(!(i!==a.default.Recent||!f.isFeatureEnabled(f.EnableRecentWithGraphAddon))||(!(i!==a.default.SharedWithMe||!f.isFeatureEnabled(f.SharedWithMeItemsScope))||(!(i!==a.default.SharedByMe||!f.isFeatureEnabled(f.SharedByMeItemsScope))||!(i!==a.default.SavedForLater||!h.isSavedForLaterEnabled()))))};t.dependencies={resources:r.resourceScopeKey,urlDataSource:o.url,viewParams:u.viewParams,itemUrlHelper:l.resourceKey,isItemsScopeEnabledInFilesPivotResource:c.isItemsScopeEnabledInFilesPivotResourceKey.lazy,isItemsScopeEnabledInCrossSitePivotsResource:c.isItemsScopeEnabledInCrossSitePivotsResourceKey.lazy};return t})(i.default);t.UseItemsScopeWatch=p;t.resourceKey=r.createResolvedResourceKey(e("module").id,p,{resources:r.resourceScopeKey,urlDataSource:o.url,viewParams:u.viewParams,itemUrlHelper:l.resourceKey,isItemsScopeEnabledInFilesPivotResource:c.isItemsScopeEnabledInFilesPivotResourceKey.lazy,isItemsScopeEnabledInCrossSitePivotsResource:c.isItemsScopeEnabledInCrossSitePivotsResourceKey.lazy});t.useItemsScopeResourceKey=new r.ResourceKey({name:e("module").id+".useItemsScope",factory:{dependencies:{useItemsScopeWatch:t.resourceKey},create:function(e){return{instance:e.useItemsScopeWatch.useItemsScope}}}})});
define("DPe",["require","exports","ww","tB","tg","v"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._navigation=n.navigation;return r}t.prototype.updateSort=function(e,t){var n,r=this._navigation,i=((n={}).sortField=e,n.isAscending=t,n);r.updateViewParams(i)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{navigation:i.navigation});return t})(r.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("nee",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resultSetHasData=void 0;t.resultSetHasData=function(e,t){for(var n=t.start,r=Math.min(t.end,e.length),i=n;i<r;i++)if(!e[i])return!1;return!0}});
define("vTe",["require","exports","ww","A","tB","STe","pO","yTe","Kb","nt"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._queue=new s.default;var r=n._pageLoadMonitor=n.resources.consume(a.resourceKey),i=n.isPageLoaded=n.observables.create(r.isPageLoaded),u=n.isPageRenderingComplete=n.observables.create(r.isPageRenderingComplete);r.isPageLoaded?n._onPageLoaded():r.waitForPLT().then(function(){i(r.isPageLoaded);n._onPageLoaded()});r.isPageRenderingComplete||r.waitForPageRenderingComplete().then(function(){u(r.isPageRenderingComplete)});if(n.resources.isExposed(o.bundle)){var f=n.resources.consume(o.bundle);n._bundles=f.getBundles()}else n._bundles={};return n}t.prototype.pageLoaded=function(e){f.configureRunMode(0);this._pageLoadMonitor.pageLoaded(e)};t.prototype.pageRenderingIsComplete=function(e){this._pageLoadMonitor.pageRenderingIsComplete(e)};t.prototype.queueLoad=function(e,t){return this._queue.queueLoad(e,0,t)};t.prototype.queueBundle=function(e,t){var n=this.getBundleInfo(e);this.queueLoad(n.path,t||n.getModule).then(function(){n.isLoaded(!0)})};t.prototype.createDeferredContext=function(e){var t=this.getBundleInfo(e),n=new(this.managed(u.default))({});t.path&&this._queue.queueLoad(t.path,1,t.getModule).then(function(){n.finishedProcessing.then(function(){t.isLoaded(!0)});n.isLoaded(!0)});return n};t.prototype.waitFor=function(e,t){return this._queue.waitFor(e,t)};t.prototype.loadNow=function(e,t){return this._queue.loadNow(e,t)};t.prototype.getBundleInfo=function(e){if(e){var t=this._bundles[e];if(!t){t={path:"",getModule:function(){return r.default.as(void 0)},isLoaded:this.createObservable(!1)};this._bundles[e]=t}return t}};t.prototype.waitForPLT=function(){return this._pageLoadMonitor.waitForPLT()};t.prototype.waitForPageRenderingComplete=function(){return this._pageLoadMonitor.waitForPageRenderingComplete()};t.prototype._onPageLoaded=function(){this._queue.hasStarted||this._queue.start()};return t})(i.default);t.default=l});
define("STe",["require","exports","Yb","C","A","C2","W"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=[1,0],a=new n.default,f=(function(){function e(){this._started=!1;this._done=!1;this._bundleGroups={};this._queuedBundles=[]}Object.defineProperty(e.prototype,"hasStarted",{get:function(){return this._started},enumerable:!1,configurable:!0});e.prototype.start=function(){var e=this;if(!this._started){this._started=!0;a.setTimeout(function(){return e._next()},1e3)}};e.prototype.queueLoad=function(e,t,n){var r=this._getGroup(e,n),i=this._generateModuleRequest(r,e,t,n);this._queueBundle(r);return i.signal.getPromise()};e.prototype.waitFor=function(e,t){var n=this._getGroup(e,t);return this._generateModuleRequest(n,e,0,t).signal.getPromise()};e.prototype.loadNow=function(e,t){var n=this._getGroup(e,t),r=this._generateModuleRequest(n,e,0,t);n.isResolved||this._requestBundle(n).done();return r.signal.getPromise()};e.prototype._getGroup=function(e,t){var n=window.require.toUrl(e),r=this._bundleGroups[n];if(!r){r=this._createGroup(e,n,t);this._bundleGroups[n]=r}return r};e.prototype._createGroup=function(e,t,n){var r=window.require.specified(t),i={bundleUrl:t,requestedPath:e,getModule:n,modules:r?null:{},isResolved:r,isQueued:!1};if(!r)for(var s=0,o=u;s<o.length;s++){var a=o[s];i.modules[a]=[]}return i};e.prototype._createModuleRequest=function(e,t){return{path:e,getModule:t,signal:new r.default,isResolved:!1}};e.prototype._addNewModule=function(e,t,n,r){var i=this._createModuleRequest(t,r);e.modules[n].push(i);return i};e.prototype._generateModuleRequest=function(e,t,n,r){var i;if(e.isResolved){i=this._createModuleRequest(t,r);this._resolveModule(i)}else i=this._addNewModule(e,t,n,r);return i};e.prototype._queueBundle=function(e){if(!e.isQueued){this._queuedBundles.push(e);e.isQueued=!0;if(this._done){this._done=!1;this._next()}}};e.prototype._next=function(){var e=this;if(this._started){var t=this._getNextGroup();if(t){var n=this._requestBundle(t);n&&n.then(function(){a.setTimeout(function(){return e._next()},500)}).done()}}};e.prototype._getNextGroup=function(){for(var e=this._queuedBundles.shift();e;){if(!e.isResolved)return e;e=this._queuedBundles.shift()}this._done=!0};e.prototype._processBundlePriorityLevel=function(e,t){if(!e.modules)return i.default.wrap();for(var n=[],r=0,s=e.modules[t];r<s.length;r++){var o=s[r];this._resolveModule(o);n.push(o.signal.getPromise())}return i.default.all(n).then(function(){},function(){})};e.prototype._processBundle=function(e){for(var t=this,n=function(n,r){return r.then(function(){return t._processBundlePriorityLevel(e,n)})},r=i.default.wrap(),s=0,o=u;s<o.length;s++){r=n(o[s],r)}return r.then(function(){e.isResolved=!0;e.modules=null})};e.prototype._requestBundle=function(e){var t=this,n=new o.Qos({name:"DeferredBundleLoad"});return s.loadModule({path:e.requestedPath,getModule:e.getModule}).then(function(){n.end({resultType:o.ResultTypeEnum.Success,extraData:{path:e.requestedPath,url:e.bundleUrl}});return t._processBundle(e)},function(t){n.end({resultType:o.ResultTypeEnum.Failure,error:t,extraData:{path:e.requestedPath,url:e.bundleUrl}})})};e.prototype._resolveModule=function(e){e.isResolved=!0;e.path&&s.loadModule({path:e.path,getModule:e.getModule}).then(function(t){e.signal.complete(t)})};return e})();t.default=f});
define("yTe",["require","exports","ww","C","A","tB","fe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._resources=[];n._finished=new r.default;n.finishedProcessing=n._finished.getPromise();n.isLoaded=n.createObservable(!1);n.createBackgroundComputed(n._computeShouldProcess);return n}t.prototype.expose=function(e,t){this._resources.push({key:e,getModule:t});this.isLoaded.peek()&&this._processResources()};t.prototype._processResources=function(){for(var e=this,t=i.default.resolve(),n=0,r=this._resources;n<r.length;n++){var s=r[n];t=this._processResource(t,s)}t.then(function(){e._resources.length=0;e._finished.complete()})};t.prototype._processResource=function(e,t){var n=this;return e.then(function(){return t.getModule()}).then(function(e){try{var r=new(n.managed(e.default))({});n.resources.expose(t.key,r)}catch(n){o.default.logError(n,{rawResult:"("+typeof e+"): "+e.default,resourceKey:"("+t.key.id+"): "+t.key.name})}})};t.prototype._computeShouldProcess=function(){this.isLoaded()&&this._processResources()};return t})(s.default);t.default=u});
define("Kb",["require","exports","ww","Yb","A","C","de","v","Qb","qb","Wb","W"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var h=(function(){function e(e,t){this.isPageLoaded=!1;this.isPageRenderingComplete=!1;this._pltSignal=new s.default;this._renderingCompleteSignal=new s.default;this._async=new r.default;this._resources=t.resources;this._immediatePageLoadedCallbacks=[];this._scope=new a.default;this._scope.attach(this._async);this._scope.trackSignal(this._pltSignal);this._scope.trackSignal(this._renderingCompleteSignal)}e.prototype.pageLoaded=function(e){var t,r,s=this;if(e)if("string"==typeof e)t=e;else{t=e.name;r=e.workload}if(!this.isPageLoaded){t&&o.default.plt(t);f.logSuccess(n.__assign({resultType:c.ResultTypeEnum.Success},r?{workload:r}:{}));this.isPageLoaded=!0;var u=this._resources.consume(l.resourceKey.optional);u&&u.onEUPL&&u.onEUPL();for(var a=[],h=this._immediatePageLoadedCallbacks.shift();h;){a.push(this._scope.trackPromise(h()));h=this._immediatePageLoadedCallbacks.shift()}i.default.all(a).then(function(){s._async.setImmediate(function(){return s._pltSignal.complete()})})}};e.prototype.pageRenderingIsComplete=function(e){var t=this;this._async.setImmediate(function(){return t._renderingCompleteSignal.complete()})};e.prototype.waitForPLT=function(){return this._pltSignal.getPromise()};e.prototype.waitForPageRenderingComplete=function(){return this._renderingCompleteSignal.getPromise()};e.prototype.addImmediatePageLoadedCallback=function(e){if(this.isPageLoaded)throw"Cannot add immediate page loaded call back after page has already loaded";if(this._immediatePageLoadedCallbacks.length>3)throw"Too many callbacks registered!";this._immediatePageLoadedCallbacks.push(e)};e.prototype.dispose=function(){this._scope.dispose()};return e})();t.resourceKey=u.createResolvedResourceKey(e("module").id,h,{resources:u.resourceScopeKey})});
define("Zat",["require","exports","ww","Z2","pO"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,t,n)||this}t.prototype.initialize=function(){this._dataPromise=null};t.prototype.getCustomActionData=function(){this._dataPromise||(this._dataPromise=this.resources.consumeAsync(i.customAction).then(function(e){return e.getCustomActionData()}));return this._dataPromise};t.prototype.isGroup=function(e){return"children"in e};return t})(r.default);t.default=s});
define("Bat",["require","exports","ww","tB","jat","Ez"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DragAndDropRobotProvider=void 0;var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.getGridHintComponent=function(e,t){return t()?{component:this._getDragAndDropHintComponent(e,t),aspectRatio:2}:null};t.prototype.getFooterHintComponent=function(e,t){return t()&&e()?null:this._getDragAndDropHintComponent(e,t)};t.prototype._getDragAndDropHintComponent=function(e,t){this._needsOverlayContent.needsOverlayContent(!0);return{name:i.default.tagName,params:{isRobotVisible:t(),isGridView:e()}}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{needsOverlayContent:s.resourceKey});return t})(r.default);t.DragAndDropRobotProvider=o;t.default=o});
define("Dse",["require","exports","ww","tB","v","pO"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;return r}t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{identityDataSource:s.identity});return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("VX",["require","exports","ww","t","tB","v"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this,s=i._controls=i.observables.createArray([]),o=document.createElement("div");o.style.display="none";var u=document.createElement("div");u.setAttribute("data-bind","component: $data");document.body.appendChild(o);r.applyBindingsToNode(o,{template:{nodes:[u],foreach:s}});return i}t.prototype.requestControl=function(e){this._controls.push(e);return e};t.prototype.disposeControl=function(e){var t=this._controls,n=t.indexOf(e);t.splice(n,1)};return t})(i.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("_Te",["require","exports","ww","Z2","K3","G3","wx","lB","W","W","bTe","pO","sB","hTe","U3","m5e","T2","fB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y={".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},b=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.searchSessionStarted=!1;n._dataStore=new i.default("",s.default.session);n._instrumentationDataSource=n.resources.consume(c.instrumentation.optional);n._pageEvent=void 0;n._engagement=n.resources.consume(h.resourceKey);n._searchSession=n.resources.consume(v.resourceKey.optional);return n}t.prototype.logStartSearchOnSubmit=function(){if(!this.searchSessionStarted){var e={name:"StartSearchSession",location:"NA",usageType:u.UsageType[u.UsageType.Click],currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{searchSessionId:this._searchSession}};this._startSearchSession();this._engagement.logData(e)}};t.prototype.currentPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.currentName};t.prototype.previousPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.previousName};t.prototype.userViewPage=function(e){var t=e.name,n=e.item,r="(none)";if(this._pageEvent){r=this._pageEvent.data.currentName;this._pageEvent.end();this.userExecuteAction({name:"NavigatePage"})}this._pageEvent=new p.Page({currentName:t,previousName:r});this._engagement.logData({name:"Page.View",location:"NA",usageType:u.UsageType[u.UsageType.Click],currentPage:t,previousPage:r,extraData:this._getExtraData(t)});g.isFeatureEnabled(g.WriteMruSignalWhenMediaViewedOneUp)&&n&&(n.video||n.audio||n.photo)&&this.resources.consumeAsync(m.mruRecent.optional).then(function(e){e&&e.recordDocumentView(n)})};t.prototype.userSeeItem=function(e){this._instrumentationDataSource&&this._instrumentationDataSource.userSeeItem(e)};t.prototype.userExecuteAction=function(e){this._instrumentationDataSource&&this._instrumentationDataSource.userExecuteAction(e)};t.prototype.userClickItem=function(e){var t=o.default[o.default.bingClickInstrumentation];if(d.isSearchType(e.queryType)&&e.urls&&e.urls[t]){var n=new a.Qos({name:"SearchResultClickItem"});l.request(e.urls[t]).done(function(){n.end({resultType:f.ResultTypeEnum.Success})},function(){n.end({resultType:f.ResultTypeEnum.Failure,extraData:{url:e.urls[t]}})})}this._logOfficeDocAge(e)};t.prototype.userClickSuggestion=function(e){if(e){var t=new a.Qos({name:"SearchSuggestionClickItem"});l.request(e).done(function(){t.end({resultType:f.ResultTypeEnum.Success})},function(){t.end({resultType:f.ResultTypeEnum.Failure,extraData:{url:e}})})}};t.prototype.getEngagementData=function(){return this._getExtraData()};t.prototype._getExtraData=function(e){return this._instrumentationDataSource?this._instrumentationDataSource.getEngagementData(e||this.currentPageName()):null};t.prototype._startSearchSession=function(){this.searchSessionStarted=!0};t.prototype._logOfficeDocAge=function(e){if(e&&e.dateModifiedValue)try{var t=e&&e.extension&&e.extension.toLowerCase();if(t){var n=this._engagement;n.logData({name:"File.Clicked",currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{extension:t,size:e.size}});"ms-word"===e.appMap||"ms-powerpoint"===e.appMap?this._dataStore.setValue("OfficeDocClickTime",new Date):this._dataStore.setValue("OfficeDocClickTime","");if(y[t]){var r=new Date(e.dateModifiedValue),i=Math.ceil(((new Date).getTime()-r.getTime())/1e3);i>0&&n.logData({name:"OfficeDocument.Clicked",extraData:{extension:t,age:i,dateModified:e.dateModifiedValue}})}}}catch(e){}};return t})(r.default);t.default=b});
define("hTe",["require","exports","he"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Page=void 0;t.Page=n.createPairedEvent({eventName:"Page,",shortEventName:"Page"},{previousName:1,currentName:1});t.default=t.Page});
define("Z$",["require","exports","ww","tB","gQ","sz","Eq","A","LO","pO","aee","OQ","IQ","CQ","UZ","ZK","nee","je","v","Gq","C","tee","eee","$$","iB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var T=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=n.itemsStore;r._operationProvider=n.operationProvider;r._schemaDataSource=n.schemaDataSource;r._updateQuota=n.updateQuota;r._groupThrottle=n.groupThrottle;r._smartFiltersStore=n.smartFiltersStore;r._serviceWorkerAgent=n.serviceWorkerAgent;return r}t.prototype.getItem=function(e){return this._getItem(e)};t.prototype.getItemSetKey=function(e,t){var n="";n+="parentKey="+e.parentKey;function r(e,t){t&&(n+="&"+e+"="+t)}r("ownerId",e.ownerId);r("groupingType",e.groupingType);n+="&sortField="+(e.sortField||"");n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var s in i)n+="&"+s+"="+i[s];r("groupBy",e.groupBy);r("viewId",e.baseViewId);r("viewXml",e.viewXml);r("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var u="";for(var a in o)u+=a+"_"+o[a];n+="&projection="+u}e.supportsNestedGroups&&(n+="&ng=1");return n};t.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})};t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,r=this._store.getItem(n),i=this._getItemSet(t,e);if(!r){var o=new s.default(n),u=e.queryType,a=void 0===u?o.queryType:u;o.queryType=a;this._store.setItem(o);r=this._store.getItem(n)}if(!i){var f=r.peek(),l=f&&f.folder,c=l&&l.childCount||0;(i=new v.default(t,e,c)).item=r;var h=e.needSchema;if(void 0===h||h){var p=this._schemaDataSource,d=p&&p.getColumns(f);d&&d.length>0&&i.schema(d)}this._store.setItemSet(t,i)}return i};t.prototype.invalidateItem=function(e,t){var r=void 0===t?{}:t,i=r.triggerFetch,s=void 0!==i&&i,o=r.emptyAllOtherSets,u=void 0!==o&&o,a=r.refreshSchema,f=void 0!==a&&a,l=r.updateGrouping,c=void 0!==l&&l,h=r.purgeCache,p=void 0!==h&&h;u&&this._store.emptyAllOtherSets([e]);if(f){(v=this._store.getItemSetFromItemKey(e))&&v.schema([])}c||this._store.invalidateItem(e,{purgeCache:p});this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);var d=this._serviceWorkerAgent;d&&d.isServiceWorkerActive()&&d.invalidateFileMetadataCache();if(s){var v=this._store.getItemSetFromItemKey(e);this._getItem(n.__assign(n.__assign({parentKey:e},v&&v.context||{}),{skipCache:!0,updateGrouping:c}))}};t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return u.default.wrapError(e)})};t.prototype.createDocument=function(e,t,n,r,i){var s=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,r).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),r=n&&n[1];return r?o.updateContentType(e,r,i).then(function(){s.invalidateItem(e);s._updateQuota(!0);return t}):t}s.invalidateItem(e);s._updateQuota(!0);return t})})};t.prototype.createCustomDocument=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.createCustomDocument(e,t,n)}).then(function(t){if(!t)return u.default.wrapError();r.invalidateItem(e);r._updateQuota(!0);return r.getItem({parentKey:e}).then(function(e){return r.peekUnwrapObservable(r._store.getItem(t))})})};t.prototype.updateBundle=function(e,t){var n=this,r=[new b.default(e.item.key,e.item)];t.update(r);return this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);r=r.map(function(e){return e.succeed()});t.update(r)},function(i){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);var s=new Error(i);r=r.map(function(e){return e.fail(s)});t.update(r);return u.default.wrapError(s)})};t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){t.invalidateItem(e.parentKey);return n})};t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})};t.prototype.reportAbuse=function(e){var t=new h.default,n=this._operationProvider.register({name:e.item.name||"",type:p.default.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),r=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});n.state(c.default.started);n.progress.maximum(1);return r.then(function(e){n.state(c.default.completed);n.progress.current(1);return e},function(e){n.state(c.default.failed);n.error(new d.default({message:e}));return u.default.wrapError(e)})};t.prototype.requestReview=function(e){for(var t=this,n=new h.default,r=e.items.map(function(e){var r=t._operationProvider.register({name:e.name||"",type:p.default.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});r.progress.maximum(1);r.progress.current(0);return r}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),s=0,o=r;s<o.length;s++){o[s].state(c.default.started)}return i.then(function(n){for(var i=0,s=r;i<s.length;i++){var o=s[i];o.progress.current(1);o.state(c.default.completed)}var u=e.items[0].parent;u&&t.invalidateItem(u.key);return n},function(e){for(var t=0,n=r;t<n.length;t++){var i=n[t];i.error(new d.default({message:e}));i.state(c.default.failed)}return u.default.wrapError(e)})};t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})};t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,p.default.addCoverPhotos,this._addCoverPhotos)};t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,p.default.removeCoverPhotos,this._removeCoverPhotos)};t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})};t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})};t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.updateItemOcrInfo(e,t,n)}).then(function(t){r.invalidateItem(e.key,{triggerFetch:!0});return t},function(e){return e})};t.prototype.rotateItems=function(e,t){var n=this,r={},i=e.items.map(function(e){return r[e.key]=new b.default(e.key,e)});t.update(i);return this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()});t.update(i)},function(e){var s=e.data||[];i=[];for(var o=0,u=s;o<u.length;o++){var a=u[o],f=r[a.key];n._store.setItem(f.input);delete r[a.key];i.push(f.fail(a.error))}for(var l in r){f=r[l];delete r[l];i.push(f.succeed())}t.update(i)})};t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};t.prototype.computeProjectedItemSet=function(e,t,n,r){var i=n.itemSetProjections,s=r?null:this._store.getItemSet(e),o=!s||s.isPlaceholder||s.isExpired||s.version!==t.version;if(!s||o){if(!s){(s=new v.default(e,n)).item=t.item;s.isTokenBasedApi=t.isTokenBasedApi;s.isPlaceholder=t.isPlaceholder;s.isExpired=t.isExpired;s.version=t.version}for(var u in i){var a=this._registeredProjections[u];a&&a.projectItemSet(s,t,i[u])}r||this._store.setItemSet(e,s)}return s};t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})};t.prototype._getItem=function(e){var r,i=this,s=g.deepCopy(e),o=this._store;if(e.keyAlias){r=this.getItemSync({parentKey:e.keyAlias}).item;e.parentKey=r.peek().key}else r=this.getItemSync(e).item;var a=e.skipCache,l=void 0!==a&&a,c=this.getItemSetKey(e),h=e.itemSetProjections?this.getItemSetKey(e,!0):c,p=this._getItemSet(c,e),d=p&&p.content.peek().items,y=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,b=!l&&r&&!r.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||m.resultSetHasData(d,{start:0,end:d.length})),E=e.startIndex,x=void 0===E?0:E,T=e.pageSize,N=void 0===T?100:T,C=e.endIndex||x+N;C=d&&d.length>0&&!y?Math.min(d.length,C):C;x=Math.max(0,Math.min(C,x));var k=o.getNextRequestToken(h);e.requestToken="end"===k?"":k;var L=new S.default(e,o,y,t.TOKEN_BASED_API_EXTRA_ITEMS);L.initialize(p,x);var A=!1,O=p&&p.content.peek();if(O&&(1===O.partialResultStatus||2===O.partialResultStatus)){A=!0;1===O.partialResultStatus&&p.content({items:O.items,groupings:O.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(b&&!A&&L.isResultSetValid(d,{start:x,end:C}))return u.default.wrap(p);if(r&&r.peek().isStub){var M=e.startKey;if(M){if(o.getItem(M)){p.content.peek().items=[o.getItem(M)];p.isPlaceholder=!0;p.isExpired=!1;var _=this._schemaDataSource,D=_&&_.getColumns(r.peek());D&&D.length>0&&p.schema(D);p.content.valueHasMutated&&p.content.valueHasMutated()}}return u.default.wrap(p)}var P=p&&!p.isExpired&&p.content.peek().groupings;P&&P.length>0&&(e.isGrouped=!0);this._normalizeContext(e,d,x,C,!b);var H=this._getRequestKey(e),B=this._pendingGetItemRequests[H];if(B)return e.itemSetProjections?B.getPromise().then(function(t){return i.computeProjectedItemSet(c,t,e)}):B.getPromise();y&&!k&&(e.startIndex=0);this._pendingGetItemRequests[H]=B=new w.default;this.resources.consumeAsync(f.getItem.bypass).then(function(t){return t.getItem(n.__assign(n.__assign({},e),{itemSetKey:c}))}).then(function(t){if(s.updateContextBasedOnResult&&e.updateContextBasedOnResult){s.updateContextBasedOnResult(s,t);e.updateContextBasedOnResult(e,t);c=i.getItemSetKey(s)}var n=e.itemSetProjections?i.getItemSetKey(e,!0):c;r=o.getItem(e.parentKey);var u=o.getItemSet(n);b=!(!r||!u);var a=L.computeNewChildren(t,e,u,n,!!b),f=a.allChildren,l=a.hasNextRequestToken;l&&(y=l);if(t.item&&!e.ignoreChildren&&!e.skipStoreResults){if(!b){(u=new v.default(n,e)).item=o.getItem(e.parentKey);u.isTokenBasedApi=y;o.setItemSet(n,u)}var h=!!u.isExpired;u.sortField=t.sortField;u.isAscending=t.isAscending;u.isPlaceholder=!1;u.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var d=t.schema;u.schema(d&&d.length>0&&d||[]);t.customViewRenderer?u.customViewRenderer=i.observables.create(t.customViewRenderer):u.customViewRenderer=i.observables.create(void 0)}var w=t.groupings;y&&e.mergeGroupings&&(w=L.computeNewGroupings(u.content.peek().groupings,t.groupings,f,e,h));t.contentTypes&&u.contentTypes&&u.contentTypes(t.contentTypes);var E=u.content.peek(),S=E.partialResultStatus,x=E.partialResultRequestCount,T=void 0===x?0:x;if(!(w&&w.length&&!!w[0])){if(l&&(t.children&&t.children.length<30||!t.children)){var N=T+1;N<=5?T=N:S=1}else void 0===S||0===S||l?2===S&&t.children&&30===t.children.length&&(S=0):S=3}u.content({items:f,groupings:w,partialResultRequestCount:T,partialResultStatus:S});var C=u.version,k=void 0===C?0:C;u.version=k+1}delete i._pendingGetItemRequests[H];if(e.requestAllChildren&&!m.resultSetHasData(f,{start:0,end:t.totalChildren})){var A=g.deepCopy(e),O=A.startIndex,M=void 0===O?0:O;A.startIndex=M+100;return i._getItem(A)}if(t.isFromBrowserCache){s.skipCache=!0;return i._getItem(s)}e.itemSetProjections&&(u=i.computeProjectedItemSet(c,u,e));return u},function(e){delete i._pendingGetItemRequests[H];return u.default.wrapError(e)}).then(function(e){B.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(-2147024860)&&!e.noGroupReplace?i._groupThrottle(!0):B.error(t)});return B.getPromise()};t.prototype._normalizeContext=function(e,t,n,r,i){var s=e.pageSize||100;if(!e.avoidSeamSnapping){if(!i&&!(n-n%s==r-r%s)&&t)for(;n<r&&t[n];)n++;e.startIndex=n-n%s}"number"!=typeof e.pageSize&&(e.pageSize=100);for(var o=e.startIndex,u=void 0===o?0:o;r-u>e.pageSize;)e.pageSize+=100};t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};t.prototype._getItemSet=function(e,t){var n=this._store,r=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),s=n.getItemSet(i);s&&(r=this.computeProjectedItemSet(e,s,t))}return r};t.prototype._updateCoverPhotos=function(e,t,n){for(var r=this,i=new h.default,s=e.target,o=e.items.map(function(e){var n=r._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:s,item:e}},iconName:e.iconName,batch:i});n.progress.maximum(1);n.progress.current(0);return n}),u=n.call(this,e),a=0,f=o;a<f.length;a++){f[a].state(c.default.started)}return u.then(function(e){r.invalidateItem(s.key);for(var t=0,n=o;t<n.length;t++){var i=n[t];i.progress.current(1);i.state(c.default.completed)}return e},function(){for(var e=0,t=o;e<t.length;e++){t[e].state(c.default.failed)}})};t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})};t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})};t.prototype._getItemDataSource=function(){return this.resources.consumeAsync(f.items)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{groupThrottle:a.groupThrottle.optional,schemaDataSource:f.schema.optional,itemsStore:o.resourceKey,operationProvider:i.resourceKey,smartFiltersStore:l.smartFiltersStore.optional,updateQuota:E.resourceKey,serviceWorkerAgent:x.resourceKey.optional});t.TOKEN_BASED_API_EXTRA_ITEMS=2;return t})(r.default);t.default=T;t.resourceKey=y.createResolvedResourceKey(e("module").id,T)});
define("eee",["require","exports","t","nee","fB"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t,n,r){this._context=e;this._store=t;this._isTokenBaseApi=n;this._tokenBasedExtraItemCount=r}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,r=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,r)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&"__next__"!==this._context.group.groupingId&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&"__next__"===this._context.group.groupingId;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&r.resultSetHasData(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return n};e.prototype.computeNewChildren=function(e,t,n,r,s){var o,u=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);o=s&&!n.isExpired?n.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&o.length>e.totalChildren&&(o[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,r,e.nextRequestToken);u=!0;n&&(n.isTokenBasedApi=u)}else this._store.setNextRequestToken(t.parentKey,r,"end");if(t.requestToken){t.startIndex=o.length-this._tokenBasedExtraItemCount;e.totalChildren+=o.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var a=e.children.length,f=e.startIndex+a;e.nextRequestToken&&(f+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(o.length,f))}if(e.item&&e.totalChildren>=0){this._isExpandingGroup||(o.length>0&&0===e.totalChildren?o=[]:o.length=e.totalChildren);var l=void 0;l=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var c=0,h=0;c<o.length;c++)if(c>=l&&h<e.children.length){o[c]=this._store.getItem(e.children[h].key);if(i.isFeatureEnabled(i.SupportMountPointInMoveCopyPanel)){(o[c].peek().remoteItem||t.remoteItem)&&(o[c].peek().isMountPointFolder=!0);t.isMountPointFolder&&(o[c].peek().remoteWebUrl=t.remoteItem.SiteUrl)}h++}}return{allChildren:o,hasNextRequestToken:u}};e.prototype.computeNewGroupings=function(e,t,r,i,s){var o=this._isExpandingGroup?i.group:null,u=i.itemsPerGroup,a=e&&e.length>0?e[0].itemGroups:null,f=null;a&&a.length>0&&a[a.length-1].isPlaceholder&&(f=a.pop());var l=this._mergeGroupings(e,t,s,r);if(o&&l){l[0].isAllCollapsed(!1);o.state({isCollapsed:!1})}if(r&&r.length>0&&!r[r.length-1]&&(a=l&&l.length>0?l[0].itemGroups:null)&&a.length>0){var c=a[a.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(c.hasMoreData=!0);var h=r[c.startIndex+(-1!==u?Math.min(c.count,u):c.count)-1]&&!(this._context.groupReplace&&c.count<u),p=l[0].isAllCollapsed.peek();if(h||this._isFetchingNextGroup||p){var d=c.startIndex+c.count;f?f.startIndex=d:f={groupingId:"__next__",startIndex:d,count:1,isPlaceholder:!0,state:n.observable({isCollapsed:!1})};r.length<d&&(r.length=d+1);a.push(f)}}return l};e.prototype._mergeGroupings=function(e,t,n,r){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var s=0;s<t.length;s++){var o=i[s].isAllCollapsed.peek();i[s].itemGroups=n?this._retainItemGroupState(i[s].itemGroups,t[s].itemGroups):this._mergeItemGroups(i[s].itemGroups,t[s].itemGroups,o,null,r)}}else i=t;return i};e.prototype._mergeItemGroups=function(e,t,n,r,i){var s=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=s[i];if(e.groupingId===o.groupingId){if(u._context.noIndexBasedDataFetch||!u._context.isTokenBasedApi){if(u._context.groupReplace){o.count+=e.count;o.hasMoreData&&i<s.length-1&&(o.hasMoreData=!1)}else o.count=e.count;o.children=u._mergeItemGroups(o.children,e.children,n,o);if(0===i)o.startIndex=r?r.startIndex:0;else{var a=s[i-1],f=a.startIndex+a.count-o.startIndex;o.startIndex+=f;o.children&&o.children.forEach(function(e){e.startIndex+=f})}}else{var l=e.startIndex+u._context.startIndex,c=e.startIndex+u._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l);o.count=Math.max(c,o.startIndex+o.count)-o.startIndex}t=!0;return"break"}},a=0;a<s.length;a++){if("break"===o(a))break}if(!t){var f=s[s.length-1],l=f.startIndex+f.count-e.startIndex;e.startIndex+=l;e.children&&e.children.forEach(function(e){e.startIndex+=l});var c=Math.min(e.count,30),h=0;if(i)for(var p=e.startIndex;p<e.startIndex+c;p++)i[p]||h++;h&&(e.emptyItemCount=h);s.push(e)}},u=this,a=0,f=t;a<f.length;a++){o(f[a])}}else s=t;return s};e.prototype._retainItemGroupState=function(e,t,n){var r=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},s=0,o=e;s<o.length;s++){var u=o[s];i[u.groupingId]=u}for(var a=0,f=r;a<f.length;a++){var l=f[a],c=i[l.groupingId];if(c){l.state(c.state.peek());l.children=this._retainItemGroupState(c.children,l.children,c)}}}return r};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(!(r&&r.startIndex<=e))break;var i=r.startIndex+r.count-1;if(r.children){if(i>=e)return this._getGroupStartingOnIndex(e,r.children)}else{if(r.startIndex===e)return r.state.peek().isCollapsed?null:r;if(i>=e){var s=n<t.length-1?t[n+1]:null;if(s&&!s.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e})();t.default=s});
define("_ne",["require","exports","ww","tB","pO","Z$","xv","v"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._urlDataSource=n.urlDataSource;r._itemProvider=n.itemProvider;return r}t.prototype.createShortcut=function(e,t,n){var r=this;return this._getShortcutDataSource().then(function(r){return r.createShortcut(e,t,n)}).then(function(t){r._itemProvider.invalidateItem(e);return t})};t.prototype.getShortcutTargetData=function(e,t){return this._getShortcutDataSource().then(function(n){return n.getShortcutTargetData(e,t)})};t.prototype.getFileByUrl=function(e){return this._getShortcutDataSource().then(function(t){return t.getFileByUrl(e)})};t.prototype.getRecentFiles=function(){var e={parentKey:this._urlDataSource.getRootItemKey(o.default.Recent),startIndex:0,endIndex:5,queryType:o.default.Recent};return this._itemProvider.getItem(e)};t.prototype._getShortcutDataSource=function(){return this.resources.consumeAsync(i.shortcut)};return t})(r.default);t.default=a;t.resourceKey=u.createResolvedResourceKey(e("module").id,a,n.__assign(n.__assign({},r.default.dependencies),{urlDataSource:i.url,itemProvider:s.resourceKey}))});
define("Xat",["require","exports","ww","tB","pO"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._dataSource=n.resources.consume(i.itemActivity);return n}t.prototype.getItemActivities=function(e,t,n){return this._dataSource.getItemActivities(e,t,n)};return t})(r.default);t.default=s});
define("Uit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["z5t"],t,n)}).then(function(e){return e.resourceKey})})})});
define("YX",["require","exports","ww","tB","pO","v"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._commandDataSource=n.itemCommandDataSource;return r}t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemCommandDataSource:i.itemCommand});return t})(r.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("irt",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["Fze"],t,n)}).then(function(e){return e.resourceKey})})})});
define("zit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["bct"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Rit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["uct"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Sie",["require","exports","ww","g","v","wie","Iie","wie","Die"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.oAuthTokenDataSourceKey=void 0;n.__exportStar(u,t);t.oAuthTokenDataSourceKey=new i.ResourceKey({name:e("module").id+".dataSource",factory:{dependencies:{pageContext:r.pageContext},create:function(e){var t=new o.default(e.pageContext);return{instance:t,disposable:t}}}});t.resourceKey=i.createResolvedResourceKey(e("module").id,s.default,{oAuthTokenDataSource:t.oAuthTokenDataSourceKey})});
define("sit",["require","exports","ww","A","tB","pO"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.prefetchPeopleCards=function(e,t){this._getPeopleCardDataSource().then(function(n){n.prefetchPeopleCards(e,t)})};t.prototype.getPeopleCard=function(e,t){return this._getPeopleCardDataSource().then(function(n){return n.getPeopleCard(e,t)})};t.prototype.getOrgChart=function(e){return this._getPeopleCardDataSource().then(function(t){return t.getOrgChart(e)})};t.prototype.getDocuments=function(e,t){return this._getPeopleCardDataSource().then(function(n){return n.getDocuments(e,t)})};t.prototype.prefetchDocuments=function(e,t){this._getPeopleCardDataSource().then(function(n){n.prefetchDocuments(e,t)})};t.prototype._getPeopleCardDataSource=function(){var e=this;return this._peopleCardDataSource?r.default.as(this._peopleCardDataSource):this.resources.consume(s.peopleCardFactory)().then(function(t){e._peopleCardDataSource=t;return t})};return t})(i.default);t.default=o});
define("gTe",["require","exports","ww","tB","sB","T2","fB","v4e"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._peopleToPrefetch={};n._debouncedPrefetch=n.async.debounce(function(){return n._prefetchPeopleCards()},50);return n}t.prototype.personRendered=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];r&&!this._peopleToPrefetch[r]&&(this._peopleToPrefetch[r]=!0)}this._debouncedPrefetch()};t.prototype.getPeopleCardData=function(e){if(o.isFeatureEnabled(o.PeopleCardsOnLoki)&&!o.isFeatureEnabled(o.PeopleCardsReactComponent)){this.resources.consume(i.resourceKey).logData({name:"PeopleCard.DataLoad"});this._peopleCardProvider||(this._peopleCardProvider=this.resources.consume(s.peopleCard));this._peopleCardProvider.getPeopleCard(e,!1)}};t.prototype._prefetchPeopleCards=function(){if(o.isFeatureEnabled(o.PeopleCardsOnLoki)&&!o.isFeatureEnabled(o.PeopleCardsReactComponent)){this._peopleCardProvider||(this._peopleCardProvider=this.resources.consume(s.peopleCard));var e=Object.keys(this._peopleToPrefetch);e.length>0&&this._peopleCardProvider.prefetchPeopleCards(e,u.default.Page)}this._peopleToPrefetch={}};return t})(r.default);t.default=a});
define("_Ke",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["vct"],t,n)}).then(function(e){return e.resourceKey})})})});
define("tee",["require","exports","tB","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new r.ResourceKey({name:e("module").id+".updateQuota",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})});
define("oit",["require","exports","ww","pO","tB"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._dataSource=n.resources.consume(r.recycleBin);return n}t.prototype.getRecycleBinItem=function(e){return this._dataSource.getRecycleBinItem(e)};return t})(i.default);t.default=s});
define("f8e",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["i5e"],t,n)}).then(function(e){return e.resourceKey})})})});
define("vat",["require","exports","fv","v","Dat","pO","g"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var u=(function(){function e(e,t){this._searchUpscopeDataSource=t.searchUpscopeDataSource;this._pageContext=t.pageContext;this._urlDataSource=t.urlDataSource}e.prototype.getUpscopeUrl=function(){return Number(this._pageContext.webTemplate)===n.WebTemplateType.mySite?this._searchUpscopeDataSource.getTenantUpscopeUrl(this.getSearchText()):this._searchUpscopeDataSource.getSiteUpscopeUrl(this.getSearchText())};e.prototype.getSearchText=function(){return this._urlDataSource.getQueryParamValue()||""};e.prototype.getLabel=function(){return this._searchUpscopeDataSource.getLabel()};e.prototype.getAriaLabel=function(){return this._searchUpscopeDataSource.getAriaLabel()};e.prototype.getListTemplate=function(){return this._pageContext.listBaseTemplate};e.dependencies={searchUpscopeDataSource:i.resourceKey,pageContext:o.pageContext,urlDataSource:s.url};return e})();t.default=u;t.resourceKey=r.createResolvedResourceKey(e("module").id,u)});
define("yK",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey("searchUpscopeProvider")});
define("nQ",["require","exports","ey","$q","A","pO","v","N","Te","fB"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var l=f.isFeatureEnabled(f.UseSelfIssuedTokenForSPOWebAuth)&&f.isFeatureEnabled(f.UseIdentityAuthForVroom),c=(function(){function e(e,t){this._identityDataSource=t.identityDataSource;this._microServiceDataSource=t.microServiceDataSource}e.prototype.getToken=function(e,t){var r=this._identityDataSource.getIdentity().type;if(r===n.IdentityType.aad){if(t&&l){var s=new a.default(t).authority;return this._identityDataSource.getSharePointToken(s)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return i.default.resolve()})}else if(r===n.IdentityType.msa)return this._identityDataSource.getSessionToken();return i.default.reject(new u.ApiError({code:"unauthUser",isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))};e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)};e.dependencies={identityDataSource:s.identity,microServiceDataSource:r.resourceKey.optional};return e})();t.default=c;t.resourceKey=o.createResolvedResourceKey(e("module").id,c)});
define("iit",["require","exports","ww","tB","pO"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._dataSource=n.resources.consume(i.shareByLink);return n}t.prototype.getShareByLinkInfo=function(){return this._dataSource.getShareByLinkInfo().then(function(e){return e})};return t})(r.default);t.default=s});
define("_it",["require","exports","ww","tB","pO","A"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._siteDataSource=n.resources.consume(i.site);n.isReadOnly=n.createObservable(!1);n.readOnlyState=n.createObservable(-2);n._requestReadOnlyState();return n}t.prototype._requestReadOnlyState=function(){var e=this;s.default.all({isReadOnly:this._siteDataSource.getReadOnlyState(),readOnlyState:this._siteDataSource.getFullSiteReadOnlyState()}).then(function(t){e.isReadOnly(t.isReadOnly);e.readOnlyState(t.readOnlyState)})};return t})(r.default);t.default=o});
define("Yat",["require","exports","ww","A","tB","pO"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.getSubscriptions=function(e,t){return this._getSubscriptionsDataSource().then(function(n){return n.getSubscriptions(e,t)})};t.prototype.updateSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.updateSubscription(e)})};t.prototype.getRootSubscriptions=function(){return this._getSubscriptionsDataSource().then(function(e){return e.getRootSubscriptions()})};t.prototype.createRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.createRootSubscription(e)})};t.prototype.updateRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.updateRootSubscription(e)})};t.prototype.deleteRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.deleteRootSubscription(e)})};t.prototype._getSubscriptionsDataSource=function(){var e=this;if(this._subscriptionsDataSource)return r.default.wrap(this._subscriptionsDataSource);if(this.resources.isExposed(s.subscriptions)){this._subscriptionsDataSource=this.resources.consume(s.subscriptions);return r.default.wrap(this._subscriptionsDataSource)}return this.resources.consumeAsync(s.subscriptions).then(function(t){e._subscriptionsDataSource=t;return t})};return t})(i.default);t.default=o});
define("Gz",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["die"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Pat",["require","exports","ww","tB","pO","g","v"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var u=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.expiringUserCount=r.createObservable(0);r._pageContext=n.pageContext;r._pageContext.isSiteAdmin&&r._requestExpiringUserCount();return r}t.prototype._requestExpiringUserCount=function(){var e=this;this._getUserExpirationDataSource().then(function(t){t.getUsersWithExpirations("UserExpiration",!1,50,0,"").then(function(t){var n=0;if(Array.isArray(t)){var r=new Date;r.setDate(r.getDate()+21);t.forEach(function(e){e&&e.expiration&&e.expiration<r&&n++})}e.expiringUserCount(n)})})};t.prototype._getUserExpirationDataSource=function(){return this.resources.consumeAsync(i.userExpiration)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pageContext:s.pageContext});return t})(r.default);t.default=u;t.resourceKey=o.createResolvedResourceKey(e("module").id,u)});
define("fit",["require","exports","ww","pO","A","tB","pit","v","k"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var f=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this,s=a.Killswitch.isActivated("8dba7267-c081-480e-9601-f659d6395db5","09/09/2020","Add dependencies to UserInfoProvider and UserInfoDataSource");i.dataSource=!s&&n&&n.dataSource||i.resources.consume(r.userInfo);i.canPersistUserInfo=i.dataSource.canPersistUserInfo();return i}t.prototype.getAnid=function(){return this.dataSource.getAnid()};t.prototype.isAuthenticated=function(){return this.dataSource.isAuthenticated()};t.prototype.getUserInfo=function(e){var t=this;return e||!this._cachedUserInfo?this.isAuthenticated()?this.dataSource.getUserInfo(e).then(function(e){t._cachedUserInfo=e;return e},function(e){return i.default.wrapError(null)}):i.default.wrap(null):i.default.wrap(this._cachedUserInfo)};t.prototype.setUserInfo=function(e,t,n,r,i){return this.dataSource.setUserInfoWithUserFacts(e,t,n,r,i)};t.prototype.resetUpsellUserFact=function(){return this.dataSource.resetUpsellUserFact()};t.prototype.getBubbleUserFact=function(e,t){var n=this;return this.dataSource.getBubbleUserFact?this.dataSource.getBubbleUserFact(e,t):this.getUserInfo(t).then(function(t){if(t&&t.info)for(var r=0,i=t.info;r<i.length;r++){var s=i[r],o=n.peekUnwrapObservable(e),u=n.peekUnwrapObservable(o.campaignGuid);if(s.id&&s.id.toLowerCase()===u.toLowerCase())return JSON.parse(s.data)}return{d:!1,v:0}},function(e){return i.default.wrapError(null)})};t.prototype.setBubbleUserFact=function(e,t){return this.dataSource.setBubbleUserFact?this.dataSource.setBubbleUserFact(e,t):this.setUserInfo(17,3,null,e.campaignGuid,JSON.stringify(t))};t.prototype.getSurveyStatusUserFact=function(e,t,n){return t?i.default.resolve({activated:!1,dateLastModified:new Date}):this.dataSource.getSurveyStatusUserFact?this.dataSource.getSurveyStatusUserFact(e):this.getUserInfo(n).then(function(t){if(t&&t.info)for(var n=0,r=t.info;n<r.length;n++){var i=r[n];if(i.id&&i.id.toLowerCase()===e.toLowerCase())return{activated:JSON.parse(i.data).a,dateLastModified:new Date(i.modifiedDate)}}return{activated:!1,dateLastModified:new Date}})};t.prototype.setSurveyStatusUserFact=function(e,t){return this.dataSource.setSurveyStatusUserFact?this.dataSource.setSurveyStatusUserFact(e,t):this.setUserInfo(47,3,null,e,JSON.stringify({a:t.activated}))};t.prototype.getUpsellDismissedById=function(e,t){return this.dataSource.getUpsellDismissedById(e,t)};t.prototype.getUpsellViewCountById=function(e,t){return this.dataSource.getUpsellViewCountById(e,t)};t.prototype.markUpsellAsSeen=function(e){return this.dataSource.markUpsellAsSeen(e)};t.prototype.markUpsellAsDismissed=function(e){return this.dataSource.markUpsellAsDismissed(e)};t.prototype.updateUpsellData=function(e,t,n){return this.dataSource.updateUpsellData(e,t,n)};t.prototype.hasUserFact=function(e){return this.dataSource.hasUserFact(e)};t.prototype.getUserFact=function(e){return this.dataSource.getUserFact(e)};t.prototype.getIsPremium=function(e){return this.dataSource.getIsPremium(e)};t.prototype.getUpsellToShow=function(e){return this.dataSource.getUpsellToShow(e)};t.prototype.getUpsellViewCount=function(e){return this.dataSource.getUpsellViewCount(e)};t.prototype.getUpsellDismissed=function(e){return this.dataSource.getUpsellDismissed(e)};t.prototype.getUpsellIframeSrc=function(e,t){return this.dataSource.getUpsellIframeSrc(e,t)};t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?o.default[e.variation]:e};t.prototype.sendShowUpsell=function(e,t,n){return this.dataSource.sendShowUpsell(e,t,n)};t.prototype.sendCloseUpsell=function(e,t,n){return this.dataSource.sendCloseUpsell(e,t,n)};t.prototype.getMarket=function(){return this.dataSource.getMarket()};t.prototype.getFirstRunExperienceDismissed=function(){return this.dataSource.getFirstRunExperienceDismissed()};t.prototype.getFirstRunExperienceViewCount=function(){return this.dataSource.getFirstRunExperienceViewCount()};t.prototype.updateFirstRunExperienceData=function(e,t){return this.dataSource.updateFirstRunExperienceData(e,t)};t.prototype.hasPositioningBeenViewed=function(){return this.dataSource.hasPositioningBeenViewed()};t.prototype.datePositioningViewed=function(){return this.dataSource.datePositioningViewed()};t.prototype.getPremiumUpsellsViewed=function(){return this.dataSource.getPremiumUpsellsViewed()};t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){return this.dataSource.getMostRecentNewFeaturesUpsellViewed()};t.prototype.setPositioningUserFactWithParams=function(e){return this.dataSource.setPositioningUserFactWithParams(e)};t.prototype.getGuidedTourCompleted=function(){return this.dataSource.getGuidedTourCompleted()};t.prototype.getGuidedTourViewCount=function(){return this.dataSource.getGuidedTourViewCount()};t.prototype.updateGuidedTourData=function(e,t){return this.dataSource.updateGuidedTourData(e,t)};t.prototype.completeGuidedTourAction=function(e){return this.dataSource.completeGuidedTourAction(e)};t.prototype.getCompletedGuidedTourActions=function(){return this.dataSource.getCompletedGuidedTourActions()};t.prototype.getExpiringSharingLinksSeen=function(){return this.dataSource.getExpiringSharingLinksSeen()};t.prototype.setExpiringSharingLinksSeen=function(){return this.dataSource.setExpiringSharingLinksSeen()};t.prototype.getEXPExperimentVariation=function(e){return this.dataSource.getEXPExperimentVariation(e)};t.prototype.setEXPExperimentVariation=function(e,t,n){return this.dataSource.setEXPExperimentVariation(e,t,n)};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{dataSource:r.userInfo});return t})(s.default);t.default=f;t.resourceKey=u.createResolvedResourceKey(e("module").id,f)});
define("q2",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["fLt"],t,n)}).then(function(e){return e.resourceKey})})})});
define("Fit",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["lLt"],t,n)}).then(function(e){return e.resourceKey})})})});
define("sx",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.QosEventType=void 0;(function(e){e[e.start=1]="start";e[e.end=2]="end"})(t.QosEventType||(t.QosEventType={}))});
define("ax",["require","exports","ix"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initServiceWorkerClient=t.SWINSTALLED=t.SERVICEWORKER_SHOULDREFRESH_FLAG=void 0;t.SERVICEWORKER_SHOULDREFRESH_FLAG="serviceWorkershouldRefresh";t.SWINSTALLED="ODSPSWInstalled";t.initServiceWorkerClient=function(){n.registerServiceWorkerPostMessageListener(function(e){if(e.shouldRefresh){window.sessionStorage.setItem(t.SERVICEWORKER_SHOULDREFRESH_FLAG,"1");location.reload(!0)}})}});
define("ox",["require","exports","W","ix","sx"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNavigationTiming=t.getServiceWorkerState=t.init=void 0;var s={};t.init=function(){r.registerServiceWorkerPostMessageListener(o)};function o(e){if(e&&e.isQos){for(var t=e.qosEvents,r=0,o=t;r<o.length;r++){var u=(h=o[r]).qos,a=h.id;if(h.type===i.QosEventType.start){var f=new n.Qos(u);s[a]=f}}for(var l=0,c=t;l<c.length;l++){var h;u=(h=c[l]).qos,a=h.id;if(h.type===i.QosEventType.end){f=s[a];delete s[a];if(!f){var p="there is no paired service worker qos start event for this end event: "+JSON.stringify(u);console.log(p);f=new n.Qos({name:u.extraData.name})}f.end(u)}}}}t.getServiceWorkerState=function(){var e="unknown",t="unknown";try{if("serviceWorker"in navigator)if(navigator.serviceWorker.controller){e=navigator.serviceWorker.controller.state;t=navigator.serviceWorker.controller.scriptURL}else e="unavailable";else e="unsupported"}catch(e){console.log(e)}return{state:e,serviceWorkerScriptLocation:t}};t.getNavigationTiming=function(){var e=performance&&performance.getEntriesByType("navigation");if(e&&e.length>0){var t=e[0];return{workerStart:Math.round(t.workerStart),fetchStart:Math.round(t.fetchStart),requestStart:Math.round(t.requestStart)}}}});
define("iFe",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.floodgateAppId=void 0;t.floodgateAppId=new n.ResourceKey("floodgate.appId")});
define("mx",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.rumOneListsHomeHelper=t.rumOneEmbedVideoHelper=t.rumOneHelper=t.rumOneScenarioPrefix=void 0;t.rumOneScenarioPrefix=new n.ResourceKey("RUMOneScenarioPrefix");t.rumOneHelper=new n.ResourceKey("rumOneHelper");t.rumOneEmbedVideoHelper=new n.ResourceKey("rumOneEmbedVideoHelper");t.rumOneListsHomeHelper=new n.ResourceKey("rumOneListsHomeHelper")});
define("aee",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.smartFiltersStore=t.userInfoStore=t.userSettingsStore=t.dataStore=void 0;t.dataStore=new n.ResourceKey("dataStore");t.userSettingsStore=new n.ResourceKey("userSettingsStore");t.userInfoStore=new n.ResourceKey("userInfoStore");t.smartFiltersStore=new n.ResourceKey("smartFiltersStore")});
define("l$",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.eventScope=t.storageInfo=t.photos=t.files=t.base=t.error=t.contentRange=t.fileContent=t.listViewContextMenuHelper=t.topCommandSet=t.listViewContextMenuCommandSet=t.dataManager=t.sortManager=void 0;t.sortManager=new n.ResourceKey("sortManager");t.dataManager=new n.ResourceKey("dataManager");t.listViewContextMenuCommandSet=new n.ResourceKey("listViewContextMenuCommandSet");t.topCommandSet=new n.ResourceKey("topCommandSet");t.listViewContextMenuHelper=new n.ResourceKey("listViewContextMenuHelper");t.fileContent=new n.ResourceKey("fileContent");t.contentRange=new n.ResourceKey("contentRange");t.error=new n.ResourceKey("error");(function(e){(function(e){e.isLeftNavClosing=new n.ResourceKey("base.leftNav.isLeftNavClosing");e.isLeftNavVisible=new n.ResourceKey("base.leftNav.isLeftNavVisible");e.hideLeftNav=new n.ResourceKey("base.leftNav.hideLeftNav");e.isLeftNavUserExpanded=new n.ResourceKey("base.leftNav.isLeftNavUserExpanded");e.toggleIsLeftNavUserExpanded=new n.ResourceKey("base.leftNav.toggleIsLeftNavUserExpanded")})(e.leftNav||(e.leftNav={}));(function(e){e.context=new n.ResourceKey("base.suiteNav.context");e.isTopBarVisible=new n.ResourceKey("base.suiteNav.isTopBarVisible");e.isTopBarHamburgerVisible=new n.ResourceKey("base.suiteNav.isTopBarHamburgerVisible");e.isSuiteNavHamburgerVisible=new n.ResourceKey("base.suiteNav.isSuiteNavHamburgerVisible");e.supportHamburgerInSuiteNav=new n.ResourceKey("base.suiteNav.supportHamburgerInSuiteNav");e.isSuiteNavHidden=new n.ResourceKey("base.suiteNav.isSuiteNavHidden")})(e.suiteNav||(e.suiteNav={}));(function(e){e.transclusionProvider=new n.ResourceKey("base.commandBar.transclusionProvider");e.isDarkTheme=new n.ResourceKey("base.commandBar.isDarkTheme");e.isSearchHidden=new n.ResourceKey("base.commandBar.isSearchHidden")})(e.commandBar||(e.commandBar={}));(function(e){e.isInfoPaneAvailable=new n.ResourceKey("base.infoPane.isInfoPaneAvailable");e.hidePreview=new n.ResourceKey("base.infoPane.hidePreview")})(e.infoPane||(e.infoPane={}));(function(e){e.isFiltersPaneAvailable=new n.ResourceKey("base.filtersPane.isFiltersPaneAvailable")})(e.filtersPane||(e.filtersPane={}));(function(e){e.isColumnCustomizationPaneExpanded=new n.ResourceKey("base.columnCustomizationPane.isColumnCustomizationPaneExpanded");e.columnToFormat=new n.ResourceKey("base.columnCustomizationPane.columnToFormat");e.viewToFormat=new n.ResourceKey("base.columnCustomizationPane.viewToFormat")})(e.columnCustomizationPane||(e.columnCustomizationPane={}));(function(e){e.isPhotosOnly=new n.ResourceKey("base.oneUpOverlay.isPhotosOnly")})(e.oneUpOverlay||(e.oneUpOverlay={}));(function(e){e.hasFooter=new n.ResourceKey("base.footer.hasFooter")})(e.footer||(e.footer={}));e.isSPLightSpeed=new n.ResourceKey("base.isSPLightSpeed");e.isScrollbarHidden=new n.ResourceKey("base.isScrollbarHidden");e.addPaddingBottom=new n.ResourceKey("base.addPaddingBottom");e.makeFlexBox=new n.ResourceKey("base.makeFlexBox");e.contextMenuHelper=new n.ResourceKey("base.contextMenuHelper");e.isRetrievingData=new n.ResourceKey("base.isRetrievingData");e.isSmartBannerVisible=new n.ResourceKey("base.isSmartBannerVisible")})(t.base||(t.base={}));(function(e){e.layoutType=new n.ResourceKey("files.layoutType");e.resx=new n.ResourceKey("files.resx");e.isArrangeControlVisible=new n.ResourceKey("files.isArrangeControlVisible")})(t.files||(t.files={}));(function(e){e.layoutType=new n.ResourceKey("photos.layoutType")})(t.photos||(t.photos={}));(function(e){e.layoutType=new n.ResourceKey("storageInfo.layoutType")})(t.storageInfo||(t.storageInfo={}));t.eventScope=new n.ResourceKey("eventScope")});
define("g",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.newDocumentTemplates=t.searchBehavior=t.sharingContextInformation=t.onePageContext=t.contentTypes=t.loggingContextBuckets=t.loggingContext=t.itemsPerGroup=t.appViewErrorMessage=t.appViewChangeInProgress=t.inplaceEditorClosing=t.inplaceEditorUrl=t.listItems=t.listContext=t.pageContext=void 0;t.pageContext=new n.ResourceKey("pageContext");t.listContext=new n.ResourceKey("listContext");t.listItems=new n.ResourceKey("listItems");t.inplaceEditorUrl=new n.ResourceKey("inplaceEditorUrl");t.inplaceEditorClosing=new n.ResourceKey("inplaceEditorClosing");t.appViewChangeInProgress=new n.ResourceKey("appViewChangeInProgress");t.appViewErrorMessage=new n.ResourceKey("appViewChangeInProgress");t.itemsPerGroup=new n.ResourceKey("itemsPerGroup");t.loggingContext=new n.ResourceKey("loggingContext");t.loggingContextBuckets=new n.ResourceKey("loggingContextBuckets");t.contentTypes=new n.ResourceKey("provider.contentTypes");t.onePageContext=new n.ResourceKey("onePageContext");t.sharingContextInformation=new n.ResourceKey("sharingContextInformation");t.searchBehavior=new n.ResourceKey("searchBehavior");t.newDocumentTemplates=new n.ResourceKey("newDocumentTemplates")});
define("Pee",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shyConductor=t.needsAttentionViewHelper=t.clientSideExtensionHelper=t.fileHandlerHelper=t.educationAndUpsells=t.attributionHelper=t.experimentHelper=t.syncActiveXClient=t.beforeUnload=t.idle=void 0;t.idle=new n.ResourceKey("idle");t.beforeUnload=new n.ResourceKey("beforeUnload");t.syncActiveXClient=new n.ResourceKey("syncActiveXClient");t.experimentHelper=new n.ResourceKey("experimentHelper");t.attributionHelper=new n.ResourceKey("attributionHelper");t.educationAndUpsells=new n.ResourceKey("educationAndUpsells");t.fileHandlerHelper=new n.ResourceKey("fileHandlerHelper");t.clientSideExtensionHelper=new n.ResourceKey("clientSideExtensionHelper");t.needsAttentionViewHelper=new n.ResourceKey("needsAttentionViewHelper");t.shyConductor=new n.ResourceKey("shyConductor")});
define("i$e",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dataContext=void 0;t.dataContext=new n.ResourceKey("vroom.dataContext")});
define("Wb",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey("BootOptions")});
define("QLt",["require","exports","fB","XLt","Dw","JLt","Sw","Aat","T","Lb","sw","tg","LI","EI","Nx","g","iw","YLt","Pz","fft"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=new l.default,y=h.getPageType(g.viewParams);if(n.isFeatureEnabled(n.LightspeedFilePicker)&&y===p.default.FilePicker){g.navigateTo(window.location.pathname+"#"+d.serializeQuery(g.viewParams));g.dispose()}else if(n.isFeatureEnabled(n.UseItemsScopeInOneDrive)){new Promise(function(t,n){e(["Nkt"],t,n)});g.dispose()}else{a.rootResourceScope.expose(c.navigation,g);i.initializeLogging({clientName:"ODB Web",viewParams:g.viewParams});o.FontResourceLoader.loadFontFaceDefinitions();o.FontResourceLoader.loadFontFamilies();a.rootResourceScope.expose(v.pageContext,m.spPageContext);var b=u.getAppResources1(a.rootResourceScope);u.getAppResources2(a.rootResourceScope);s.addSuiteNavResources(b);b.expose(f.resourceKey,b);b.consume(r.odbKnockoutAppBoot)}});
define("_v",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Constants=void 0;var n=(function(){function e(){}e.DefaultLocale="en-US";e.TeamsListClientName="Teams.List";e.TeamsPagesClientName="Teams.Page";e.TeamsFileClientName="Teams.File";e.PageContextKey="_spPageContextInfo";return e})();t.Constants=n});
define("mv",["require","exports","_v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCurrentTheme=t.setCurrentTheme=t.isTeamsSubEntityPresent=t.getSubEntityDetails=t.getUrlQueryParam=t.getSpListMigrationMarker=t.getTeamsTabContextFromUrl=t.getTeamsImagesUrl=t.getClientName=t.getTeamsListUrl=t.getExtraDataHost=t.isTeamsApp=t.isTeamsPortalApp=t.setTeamsPortalApp=t.isTeamsFileApp=t.setTeamsFileApp=t.isTeamsPageApp=t.setTeamsPageApp=t.isTeamsListApp=t.setTeamsListApp=t.TeamsTabContext=t.TeamsApp=void 0;var r;(function(e){e[e.None=0]="None";e[e.List=1]="List";e[e.Page=2]="Page";e[e.Portal=3]="Portal";e[e.File=4]="File"})(r=t.TeamsApp||(t.TeamsApp={}));var i=function(){};t.TeamsTabContext=i;var s=r.None,o=new i;t.setTeamsListApp=function(e){s=r.List;window._TeamsListApp=e;window._ListInTeamsApp=e;a()};t.isTeamsListApp=function(){return s===r.List};t.setTeamsPageApp=function(e){s=r.Page;window._TeamsPageApp=e;a()};t.isTeamsPageApp=function(){return s===r.Page};t.setTeamsFileApp=function(e){s=r.File;window._TeamsFileApp=e;a()};t.isTeamsFileApp=function(){return s===r.File};var u=r.None;t.setTeamsPortalApp=function(e){u=r.Portal;window.teamsCustomAppType=e?"portals":void 0};t.isTeamsPortalApp=function(){return u===r.Portal};t.isTeamsApp=function(){return t.isTeamsListApp()||t.isTeamsPageApp()||t.isTeamsPortalApp()||t.isTeamsFileApp()};t.getExtraDataHost=function(){return t.isTeamsListApp()?"TeamsList":t.isTeamsPageApp()?"TeamsPage":t.isTeamsFileApp()?"TeamsFile":"SP"};t.getTeamsListUrl=function(e,t,n){return encodeURI(e+"/_layouts/15/listallitems.aspx?listUrl="+t+("&"===n.substr(0,1)?n:"&"+n))};t.getClientName=function(){return t.isTeamsListApp()?""+n.Constants.TeamsListClientName:t.isTeamsPageApp()?""+n.Constants.TeamsPagesClientName:t.isTeamsFileApp()?""+n.Constants.TeamsFileClientName:void 0};t.getTeamsImagesUrl=function(e){var t="odsp-media/images/teams/"+e+".svg";return window&&window.require&&window.require.toUrl?window.require.toUrl(t):t};t.getTeamsTabContextFromUrl=function(){void 0===o.TeamId&&a();return o};t.getSpListMigrationMarker=function(){return t.getUrlQueryParam("mg",!0)};t.getUrlQueryParam=function(e,t){void 0===t&&(t=!1);var n=window.location.href.split("?")[1];if(n)for(var r=n.split("&"),i=0;i<r.length;i++){var s=r[i].split("=");if(s[0]===e)return t?decodeURIComponent(s[1]):s[1]}};t.getSubEntityDetails=function(){var e=t.getUrlQueryParam("subEntityId");if(e&&!Number.isNaN(+e)){var n=t.getUrlQueryParam("listUrl"),r=t.getUrlQueryParam("theme"),i=window.location.href,s=void 0;if(e&&i&&n){s=""+i.split("?")[0].toLowerCase().split("/teams/")[0]+n+"/dispform.aspx?ID="+e+"&app=teamslist&theme="+r}return{itemId:e,itemOpenUrl:s}}};t.isTeamsSubEntityPresent=function(){var e=t.getUrlQueryParam("subEntityId");return!(!e||Number.isNaN(+e))};t.setCurrentTheme=function(e){e&&(window._TeamsTheme=e)};t.getCurrentTheme=function(){return window._TeamsTheme};function a(){var e=t.getUrlQueryParam("teamId",!0);void 0!==e&&(o.TeamId=e.split("@")[0]);var n=t.getUrlQueryParam("channelId",!0);void 0!==n&&(o.ChannelId=n.split("@")[0]);o.EntityId=t.getUrlQueryParam("entityId",!0);o.RingId=t.getUrlQueryParam("ringId",!0);o.AppSessionId=t.getUrlQueryParam("asid",!0);o.SessionId=t.getUrlQueryParam("sid",!0)}});
define("HPe",["require","exports","ww","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.teamsUtilitiesResourceKey=t.teamsHostedApplicationResourceKey=void 0;t.teamsHostedApplicationResourceKey=new r.ResourceKey({name:e("module").id+".hostedApplication",loader:{load:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["@ms/odsp-teams-shared/lib/teams/HostedApplicationFactory"],t,n)})];case 1:t=n.sent().HostedApplicationFactory;return[2,new r.ConstantResourceFactory(function(e){return t.getHostedApplicationInstance(e)})]}})})}}});t.teamsUtilitiesResourceKey=new r.ResourceKey({name:e("module").id+".utilities",loader:{load:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["@ms/odsp-teams-shared/lib/utilities/TeamsUtilities"],t,n)})];case 1:t=n.sent().TeamsUtilities;return[2,new r.ConstantResourceFactory(t)]}})})}}})});
define("FPe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PagesAppConstants=void 0;(function(e){e.AppType="doclibPagesApp"})(t.PagesAppConstants||(t.PagesAppConstants={}))});
define("fft",["require","exports","C2"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});window.__loadTests=function(){return n.loadModuleExport({path:"odsp-next-test/functional/remote/execution/Initialization",require:window.require,getExport:function(e){return e.initialize}}).then(function(e){return e()})}});
define("Nz",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.findMatch=t.removeDuplicates=void 0;t.removeDuplicates=function(e){var t;t={};for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=""+s;if(!t[o]){t[o]=!0;n.push(s)}}return n};t.findMatch=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t(r))return{value:r,index:n}}}});
define("t$e",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["JDe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("$$",["require","exports","v","Ow","WB"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var s;(function(){try{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(function(e){e&&e.navigationPreload.getState().then(function(e){s=e.enabled})})}catch(e){}})();var o=(function(){function e(){this._isOneDriveWinApp=-1!==navigator.userAgent.indexOf("OneDriveWinApp")}e.prototype.isServiceWorkerActive=function(){var e="serviceWorker"in navigator&&!!navigator.serviceWorker.controller&&"activated"===navigator.serviceWorker.controller.state;this.isServiceWorkerActive=function(){return e};return e};e.prototype.getServiceWorkerInfo=function(){return{isServiceWorkerRegistered:localStorage&&!!localStorage.getItem("isServiceWorkerRegisteredKey")||!1,isServiceWorkerFlightEnabled:this._isOneDriveWinApp?!r.isFeatureEnabled(r.DisableServiceWorkerPWA):r.isFeatureEnabled(r.EnableODBServiceWorker),isSWExperimentationFlightEnabled:r.isFeatureEnabled(r.EnableOdbServiceWorkerExperiment),isServiceWorkerExperimentOn:!!r.isFeatureEnabled(r.EnableOdbServiceWorkerExperiment)&&this._isOdbServiceWorkerExperimentOn(),isDocLibServiceWorkerFlightEnabled:r.isFeatureEnabled(r.EnableCommonServiceWorker),isDocLibSWExperimentationFlightEnabled:r.isFeatureEnabled(r.EnableDocLibServiceWorkerExperiment),isDocLibServiceWorkerExperimentOn:!!r.isFeatureEnabled(r.EnableDocLibServiceWorkerExperiment)&&this._isDocLibServiceWorkerExperimentOn(),isNavigationPreloadEnabled:s||void 0,swNavigationInfo:this.getSWNavigationInfo()||void 0}};e.prototype.getServiceWorkerStatus=function(){var e="unknown";try{e="serviceWorker"in navigator?navigator.serviceWorker.controller?navigator.serviceWorker.controller.state:"unavailable":"unsupported"}catch(e){console.error(e)}return e};e.prototype.invalidateFileMetadataCache=function(){this._invalidateCache("FileMetadata")};e.prototype._invalidateCache=function(e){var t=navigator.serviceWorker.controller;t&&t.postMessage(JSON.stringify({operation:"invalidate",cacheName:e}))};e.prototype._isOdbServiceWorkerExperimentOn=function(){this._odbServiceWorkerExperiment||(this._odbServiceWorkerExperiment=new i.ABExperiment({name:"ODBServiceWorkerExperimentV2",startDate:"7/01/2019",targetType:i.TargetType.user,version:i.ABExpHash.v2}));return this._odbServiceWorkerExperiment.IsExperimentOn()};e.prototype._isDocLibServiceWorkerExperimentOn=function(){this._docLibServiceWorkerExperiment||(this._docLibServiceWorkerExperiment=new i.ABExperiment({name:"CommonServiceWorkerExperiment",startDate:"8/19/2019"}));return this._docLibServiceWorkerExperiment.IsExperimentOn()};e.prototype.getSWNavigationInfo=function(){var e=performance&&performance.getEntriesByType("navigation");if(e&&e.length>0){var t=e[0];return{workerStart:t.workerStart,fetchStart:t.fetchStart,requestStart:t.requestStart}}};return e})();t.default=o;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:new n.SimpleResourceFactory(o)})});
define("dv",["require","exports","mv","pv","lv"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isFileBrowser=t.isTeamsWebView=t.isOneDriveXboxApp=t.isOneDriveWinApp=t.isOneDriveWinAppTest=t.isWebViewHosted=t.isWebViewHostedList=void 0;Object.defineProperty(t,"isWebViewHostedList",{enumerable:!0,get:function(){return i.isWebViewHostedList}});var s,o,u,a,f;t.isWebViewHosted=function(){void 0===s&&(s=/[?&]env=WebView/.test(r.originalQueryString)||c()||(function(){try{return window.parent&&window.parent!==window&&-1===navigator.userAgent.indexOf("PhantomJS/")||/[?&]env=Embedded/.test(r.originalQueryString)}catch(e){return!1}})()||n.isTeamsListApp()||h());return s};function l(){try{return!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){return!1}}t.isOneDriveWinAppTest=l;t.isOneDriveWinApp=function(){void 0===o&&(o=-1!==navigator.userAgent.indexOf("OneDriveWinApp")||l());return o};t.isOneDriveXboxApp=function(){if(void 0===u){var e=navigator.userAgent;u=-1!==e.indexOf("Xbox")&&-1!==e.indexOf("OneDriveWinApp")}return u};function c(){if(!a){var e=navigator.userAgent;a=/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)).* Electron\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/.test(e)}return a||n.isTeamsListApp()||n.isTeamsFileApp()}t.isTeamsWebView=c;function h(){if(void 0===f){var e=window.location.pathname.toLowerCase();f=-1!==e.indexOf("/_layouts/15/filebrowser.aspx")}return f}t.isFileBrowser=h});
define("lv",["require","exports","uv","zi","pv"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isWebViewHostedList=void 0;var s;t.isWebViewHostedList=function(e){void 0===s&&(s=/[?&]env=WebViewList/.test(i.originalQueryString));return s||!!e&&(Number(e.webTemplate)===n.default.mySite&&!!e.listId&&e.listBaseType!==r.ListBaseType.invalidType&&!r.isDocLib(e.listBaseType))}});
define("pv",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.originalQueryString=void 0;t.originalQueryString=location.search});
define("I3",["require","exports","Yb","Je","ga"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.waitForDomLoad=void 0;var s=r.default.isActivated("AF0DA10B-7983-4CD8-A61D-340EDD4388AD","04/16/2019","disableWaitForDOMContentLoaded"),o=r.default.isActivated("065324A7-7C6C-437D-9225-F22878BB872D","01/16/2020","disableWaitForDocumentBody");t.waitForDomLoad=function(e){var t=this;if(s||!o&&document.body||"interactive"===document.readyState||"complete"===document.readyState){e(!1);return Promise.resolve(!1)}return new Promise(function(r,s){var u=function(){try{e(!0);r(!0)}catch(e){s(e)}};if(o){var a=new i.EventGroup(t);a.on(document,"DOMContentLoaded",function(){a.off(document,"DOMContentLoaded");u()})}else var f=new n.default,l=f.setInterval(function(){if(document.body){f.clearInterval(l);u()}},5)})}});
define("Gat",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id+".dragAndDropAnimationHelper",loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["rxe"],t,n)}).then(function(e){return e.resourceKey})})});t.default=t.resourceKey});
define("kat",["require","exports","ww","A","fB","YB","tB","tg","T2","pO","W"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExperimentId=void 0;var c,h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._navigation=n.resources.consume(u.navigation);n._userInfoProvider=n.resources.consume(a.userInfo);return n}t.prototype.isExperimentManualTest=function(e){return!!this._navigation.viewParams["EXPExperimentTest_e"+e]};t.prototype.isInapplicableEnvironment=function(){var e="edog"===(window._spPageContextInfo&&window._spPageContextInfo.env);return!(!window.$Config||!window.$Config.isINT)||e};t.prototype.startEXPExperimentBehindFeature=function(e,t){var n=this,o=t.experimentId,u=t.experimentName,a=t.variationMap,f=t.getVariationFunction;if(i.isFeatureEnabled(e)){if(this.isExperimentManualTest(o)){var l=this._navigation.viewParams["EXPExperimentTest_e"+o],c=Number(l);return isNaN(c)||!a[c]?r.default.wrap(0):r.default.wrap(c)}return this.getExperimentVariation(o,f).then(function(t){t&&!n.isInapplicableEnvironment()&&s.default.logData({name:e.ODC?String(e.ODC):String(e.ODB),isInRamp:!0,experiment:u,variant:a[t]&&a[t].name});return t})}return r.default.wrap(0)};t.prototype.getExperimentVariation=function(e,t){var n=this;return this._userInfoProvider.getEXPExperimentVariation(e).then(function(s){if(s)return r.default.wrap(s);var o=n.resources.consume(f.identity.optional).getIdentity().id,u=t(o);new l.Qos({name:"ExpHelper.Assignment."+e}).end({resultType:l.ResultTypeEnum.Success,resultCode:"Variation."+u});return i.isFeatureEnabled(i.ExpFactCleanup)?n._userInfoProvider.setEXPExperimentVariation(e,u,p).then(function(e){return e?r.default.wrap(u):r.default.wrap(0)}):n._userInfoProvider.setEXPExperimentVariation(e,u).then(function(e){return e?r.default.wrap(u):r.default.wrap(0)})})};return t})(o.default);t.default=h;(function(e){e[e.Iconography=219512403]="Iconography";e[e.ReaectShell=631936892]="ReaectShell";e[e.QuotaUxRevision=1]="QuotaUxRevision";e[e.QuotaUxRevisionAA=2]="QuotaUxRevisionAA";e[e.QuotaUxRevision2=3]="QuotaUxRevision2";e[e.QuotaUxRevisionAA2=4]="QuotaUxRevisionAA2";e[e.Unknown1=313862562]="Unknown1";e[e.Unknown2=758340426]="Unknown2";e[e.Unknown3=860081470]="Unknown3";e[e.Unknown4=860647394]="Unknown4";e[e.Unknown5=911653430]="Unknown5";e[e.Unknown6=973349173]="Unknown6"})(c=t.ExperimentId||(t.ExperimentId={}));var p=[c.Iconography,c.ReaectShell]});
define("Sw",["require","exports","jv"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FontResourceLoader=void 0;var r=(function(){function e(){}e.loadFontFaceDefinitions=function(){var e=document.createElement("link");e.href="https://static2.sharepointonline.com/files/fabric/onedrive-assets/onedrive-font-face-definitions.css";e.rel="stylesheet";e.type="text/css";document.head.appendChild(e)};e.loadFontFamilies=function(){var e=new n.default,t=document.head;if(e.isWindows||e.isWinPhone){r=document.createElement("style"),i=document.createTextNode('\n            body, input, textarea, button {\n                font-family: "Segoe UI", Tahoma, Arial, sans-serif;\n            }');r.appendChild(i);t.insertBefore(r,t.firstChild)}else{var r=document.createElement("style"),i=document.createTextNode('\n            body, input, textarea, button {\n                font-family: \'Segoe UI Web (West European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(ar):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (Arabic)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(bg):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (Cyrillic)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(cs):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(el):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (Greek)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(et):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(he):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (Hebrew)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(hi):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Nirmala UI\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(hr):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(hu):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(ja):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Yu Gothic UI\', \'Meiryo UI\', Meiryo, \'MS Pgothic\', Osaka, -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(kk):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(ko):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Malgun Gothic\', Gulim, -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(lo):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Leelawadee UI Web\', \'Lao UI\', DokChampa, -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(lt):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(lv):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(pl):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(ru):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (Cyrillic)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(sk):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(sr-latn):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(th):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Leelawadee UI Web\', \'Kmer UI\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(tr):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (East European)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(uk):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (Cyrillic)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(vi):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Segoe UI Web (Vietnamese)\', -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(zh-hans):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Microsoft Yahei UI\', Verdana, Simsun, -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }\n            :lang(zh-hant):not(.ms-Icon):not([data-icon-name]) {\n                font-family: \'Microsoft Jhenghei UI\', Pmingliu, -apple-system, BlinkMacSystemFont, "Roboto", "Helvetica Neue", sans-serif;\n            }');r.appendChild(i);t.insertBefore(r,t.firstChild)}};return e})();t.FontResourceLoader=r});
define("Y8e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isDicomFile=t.fileTypeSupportsPreview=void 0;var n=[".dcm",".dcm30",".dic",".dicm",".dicom"],r={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0,".aspx":!0};t.fileTypeSupportsPreview=function(e){return!!e&&r[e.toLowerCase()]};t.isDicomFile=function(e){return n.indexOf(e)>=0}});
define("Lb",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey(e("module").id)});
define("T",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.rootResourceScope=void 0;t.rootResourceScope=new n.ResourceScope({owner:"OneDriveRoot",useFactoriesOnKeys:!0})});
define("Aat",["require","exports","t","A","sw","crt","WB","ese","lie","v","tg","g","aee","l$","i$e","LO","Pee","T2","pO","iFe","srt","_5e","ort","Nte","KK","rrt","irt","SZ","nrt","Kit","K2","q0e","x5e","WK","nPe","Git","Oq","_Ke","Nne","sTe","tTe","Ete","zit","Vit","jit","rOe","Nit","Rit","d$e","$q","hse","iTe","Hit","Fit","Uit","GK","Tit","q2","dTe","Mit","kit","Lit","Ait","Eit","Zq","wit","Oit","Cit","xit","Iit","ZAe","Dit","Sit","P0e","yit","vit","zie","git","bit","hit","Bie","_it","uTe","fTe","gTe","fit","uit","lit","cit","Lq","aTe","sit","oit","rit","iit","cTe","eit","$at","Zat","vTe","Xat","Jat","Yat","Qat","qat","_Te","Wat","Bat","Ez","Nat","oTe","rTe","Rat","Hat","Fat","Uat","Tat","Pat","_Pe","PO","Cq","fB","IPe","EI","xv","Mat","dv","kat","iw","eTe","Lat","tOe","Ve","A3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge,ye,be,we,Ee,Se,xe,Te,Ne,Ce,ke,Le,Ae,Oe,Me,_e,De,Pe,He,Be,je,Fe,Ie,qe,Re,Ue,ze,We,Xe,Ve,$e,Je,Ke,Qe,Ge,Ye,Ze,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt,Tt,Nt){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAppResources2=t.getAppResources1=void 0;function Ct(e){return e.resourceKey}var kt=new f.ResourceKey("hasExposedAppResources");t.getAppResources1=function(t){var r=t;if(r.isExposed(kt))return r;r.expose(kt,!0);var s=r.consume(c.pageContext);o.ABExperiment.Init(s);r.expose(T.resourceKey,s.CorrelationId||"");r.expose(v.viewParams,(function(e){var t=e.consume(l.navigation),r=n.observable(t.viewParams);r.equalityComparer=Tt.deepCompare;new Nt.EventGroup(null).on(t,"change",function(){r(t.viewParams)});return r})(r));r.exposeAsync(y.engagementHandlers,new f.AliasResourceLoader(function(){return new Promise(function(t,n){e(["MDe"],t,n)}).then(Ct)}));r.expose(y.bundle,new(r.injected(He.default)));var u=new(r.injected(Xe.default));r.expose(g.bundleLoader,u);r.expose(d.dataContext,new(r.injected(De.default)));r.expose(h.userInfoStore,new gt.default);r.expose(h.userSettingsStore,new St.default);r.isExposed(l.navigation)||r.expose(l.navigation,new i.default);r.exposeFactory(P.resourceKey,new f.AliasResourceFactory(q.resourceKey));var a=r.expose(y.url,new(r.injected(Ae.default))),p=a.getPageType(),b=a.getQueryType();p===vt.default.Files&&b===mt.default.Files&&r.expose(f.asyncLoadBarrierKey,{wait:function(){return u.waitForPLT()}});r.exposeFactory(y.urlLite,new f.AliasResourceFactory(ct.resourceKey));r.expose(v.isGuidedTourVisible,n.observable(!1));r.exposeFactory(Se.resourceKey,new f.AliasResourceFactory(Ee.useItemsScopeResourceKey));r.exposeFactory(ht.resourceKey,new f.AliasResourceFactory(Se.resourceKey));r.expose(y.settings,new Re.default);r.exposeFactory(le.resourceKey,new f.AliasResourceFactory(J.resourceKey));r.exposeFactory(K.resourceKey,new f.AliasResourceFactory(le.resourceKey));r.exposeFactory(y.identity,new f.AliasResourceFactory(O.resourceKey));r.expose(y.userInfo,new(r.injected(Ue.default)));r.expose(g.userInfo,new(r.injected(Me.default)));r.expose(m.experimentHelper,new(r.injected(bt.default)));r.expose(y.teachingBubble,new(r.injected(it.default)));r.exposeFactory(g.teachingBubble,new f.AliasResourceFactory(X.resourceKey));r.exposeFactory(y.people,new f.AliasResourceFactory(Q.resourceKey));r.expose(y.instrumentation,new(r.injected(ot.default)));r.expose(g.instrumentation,new(r.injected(Ge.default)));r.expose(y.shareByLink,new(r.injected(Qe.default))(s));r.expose(g.shareByLink,new(r.injected(qe.default)));r.exposeFactory(be.typeResourceKey,new f.AliasResourceFactory(we.typeResourceKey));r.expose(y.folderItemCount,new(r.injected(st.default)));r.expose(y.itemActivity,new(r.injected(Ye.default)));r.expose(g.itemActivity,new(r.injected(Ve.default)));pt.isFeatureEnabled(pt.ActivityFeedRefactoring)||r.expose(y.itemActivityFeed,new at.default(s));pt.isFeatureEnabled(pt.ActivityFeedRefactoring)&&r.exposeFactory(y.itemActivityFeedHelper,new f.AliasResourceFactory(he.resourceKey));r.exposeFactory(y.itemCommentDataSource,new f.AliasResourceFactory(fe.resourceKey));r.exposeFactory(y.itemMuteNotificationDataSource,new f.AliasResourceFactory(Te.resourceKey));r.exposeAsync(y.batchUploaderType,new f.AliasResourceLoader(function(){return new Promise(function(t,n){e(["hAe"],t,n)}).then(function(e){return e.typeResourceKey})}));r.exposeFactory(k.resourceKey,new f.AliasResourceFactory(L.resourceKey));var w=pt.isFeatureEnabled(pt.UseOLSQueryForSearch)&&"EDOG_Content"!==s.farmLabel;r.expose(E.isOLSQueryEnabledResourceKey,w);r.expose(g.ransomwareDetection,null);r.exposeFactory(y.itemColumn,new f.AliasResourceFactory(M.resourceKey));r.exposeFactory(y.restore,new f.AliasResourceFactory(oe.resourceKey));r.exposeFactory(y.restoreActivities,new f.AliasResourceFactory(pe.resourceKey));r.exposeFactory(y.notificationSettings,new f.AliasResourceFactory(ge.resourceKey));r.exposeAsync(y.worker,new f.AliasResourceLoader(function(){return new Promise(function(t,n){e(["jwe"],t,n)}).then(Ct)}));r.exposeFactory(y.search,new f.AliasResourceFactory(_.resourceKey));pt.isFeatureEnabled(pt.ODBFlow)&&r.exposeAsync(y.list,new f.AliasResourceLoader(function(){return new Promise(function(t,n){e(["OZ"],t,n)}).then(Ct)}));r.expose(v.useMobileList,!1);r.expose(y.sharing,new(r.injected(Ie.default))(s));r.expose(y.sharingData,new(r.injected($e.default))(s));r.exposeAsync(y.sites,new f.AliasResourceLoader(function(){return new Promise(function(t,n){e(["qxe"],t,n)}).then(Ct)}));r.exposeAsync(y.fileHandlerFromCache,new f.AliasResourceLoader(function(){return Promise.resolve(new Promise(function(t,n){e(["SDe"],t,n)})).then(function(e){return e.resourceKey})}));return r};var Lt=new f.ResourceKey("hasExposedAppResources2");t.getAppResources2=function(t){var i=t;if(i.isExposed(Lt))return i;i.expose(Lt,!0);var o=i.consume(c.pageContext);i.expose(y.versionControl,new(i.injected(nt.default)));i.expose(y.versionHistory,new(i.injected(rt.default)));i.expose(v.isItemSetRendered,n.observable(!1));i.exposeFactory(te.resourceKey,new f.AliasResourceFactory(se.resourceKey));i.expose(v.mobileOfficeAppUpsellDismissedThisSession,n.observable(!1));a.default.addConfig({enforceDefine:!1});pt.isFeatureEnabled(pt.RecycleBinImmersive)&&i.expose(y.footer,new(i.injected(Pe.default)));i.expose(v.isDebugWindowVisible,n.observable(!0));i.exposeFactory(G.resourceKey,new f.AliasResourceFactory(F.resourceKey));i.exposeFactory(y.shortcut,new f.AliasResourceFactory(G.resourceKey));var l=function(e,t){i.exposeAsync(e,new f.AliasResourceLoader(function(){return t().then(Ct)}))};l(y.graphUrl,function(){return new Promise(function(t,n){e(["Sse"],t,n)})});l(g.graphToken,function(){return new Promise(function(t,n){e(["Dse"],t,n)})});l(y.fileHandler,function(){return new Promise(function(t,n){e(["yDe"],t,n)})});l(y.preAuth,function(){return new Promise(function(t,n){e(["DDe"],t,n)})});l(y.appUrl,function(){return new Promise(function(t,n){e(["IDe"],t,n)})});l(m.fileHandlerHelper,function(){return new Promise(function(t,n){e(["xDe"],t,n)})});l(y.graph,function(){return new Promise(function(t,n){e(["wDe"],t,n)})});i.expose(c.listContext,new(i.injected(Le.default))({listRootFolderWebRelativeUrl:wt.listWebRelativeUrl}));i.expose(ie.useFolderScopedSearchKey,!1);i.exposeFactory(ie.listItemsDataSourceAsyncKey,new f.AliasResourceFactory(A.resourceKey));i.exposeFactory(y.getItem,new f.AliasResourceFactory(ie.listItemsDataSourceAsyncKey));i.exposeFactory(y.items,new f.AliasResourceFactory(ie.listItemsDataSourceAsyncKey));i.exposeFactory(y.deleteRestore,new f.AliasResourceFactory(ie.listItemsDataSourceAsyncKey));i.exposeFactory(y.itemInvalidator,new f.AliasResourceFactory(R.resourceKey));i.expose(y.iosMobileAppPath,new(i.injected(tt.default)));i.exposeFactory(y.download,new f.AliasResourceFactory(I.resourceKey));i.expose(y.copy,new(i.injected(Be.default))(o));i.expose(m.syncActiveXClient,new(i.injected(Et.default))({}));i.exposeFactory(y.language,new f.AliasResourceFactory(ut.resourceKey));i.expose(y.encoding,new ze.default);i.exposeFactory(y.videoItem,new f.AliasResourceFactory(z.resourceKey));i.expose(g.profile,new(i.injected(Oe.default)));i.exposeFactory(y.subscriptions,new f.AliasResourceFactory(ne.resourceKey));i.expose(g.subscriptions,new(i.injected(Je.default)));i.exposeFactory(y.folder,new f.AliasResourceFactory(N.resourceKey));i.exposeFactory(y.itemCommand,new f.AliasResourceFactory(V.resourceKey));i.expose(y.error,new(i.injected(_e.default)));i.expose(v.didUserUploadOrCreateFile,n.observable(!1));i.expose(v.didUserCreateOfficeFile,n.observable(!1));i.expose(v.mobileUpsellDismissedThisSession,n.observable(!1));i.expose(D.allowInfectedFileDownloadsResourceKey,!!o.allowInfectedDownload);if(pt.isFeatureEnabled(pt.PeopleCardsOnLoki)&&!pt.isFeatureEnabled(pt.PeopleCardsReactComponent)){i.expose(y.peopleCardFactory,function(){return r.default.resolve(new Promise(function(t,n){e(["g4e"],t,n)}).then(function(e){if(i.isExposed(y.peopleCard))return i.consume(y.peopleCard);var t=new(i.injected(e.default));return i.expose(y.peopleCard,t)}))});i.expose(g.peopleCard,new(i.injected(je.default)))}o.isSPO||i.expose(v.displayImageTileNames,!0);i.expose(v.isSharingSectionExpanded,n.observable(!1));i.expose(y.recycleBin,new(i.injected(Ke.default)));i.expose(g.recycleBin,new(i.injected(Fe.default)));i.expose(g.dragAndDropRobot,new(i.injected(Ze.default))({},{needsOverlayContent:i.consume(et.resourceKey)}));i.expose(y.site,new u.default(o));i.expose(g.site,new(i.injected(ke.default)));i.exposeFactory(y.policyTip,new f.AliasResourceFactory(B.resourceKey));i.exposeFactory(p.sortManager,new f.AliasResourceFactory(w.resourceKey));i.consume(g.bundleLoader).queueBundle(1);t.exposeFactory(me.resourceKey,new f.AliasResourceFactory(de.resourceKey));i.exposeFactory(Ce.resourceKey,new f.AliasResourceFactory(Ne.resourceKey));i.exposeFactory(y.guidedTour,new f.AliasResourceFactory(ue.resourceKey));i.exposeFactory(y.notifications,new f.AliasResourceFactory(ae.resourceKey));i.exposeFactory(g.notification,new f.AliasResourceFactory(U.resourceKey));i.exposeFactory(g.notificationManager,new f.AliasResourceFactory($.resourceKey));i.exposeFactory(y.wopiFrame,new f.AliasResourceFactory(H.resourceKey));i.exposeFactory(y.wrs,new f.AliasResourceFactory(S.resourceKey));i.exposeFactory(y.web,new f.AliasResourceFactory(x.resourceKey));if(pt.isFeatureEnabled(pt.EnablePushChannel)&&!pt.isFeatureEnabled(pt.UseItemsScopeInOneDrive)&&!pt.isFeatureEnabled(pt.UseItemsScopeInSitesForODB)){i.exposeFactory(y.pushChannel,new f.AliasResourceFactory(Y.resourceKey));i.exposeFactory(y.itemAutoRefresh,new f.AliasResourceFactory(ce.resourceKey));i.consumeAsync(pt.isFeatureEnabled(pt.EnablePushChannelAutoRefresh)?ee.resourceKey:j.resourceKey)}l(y.vroomItemIdentityProcessor,function(){return new Promise(function(t,n){e(["t5e"],t,n)})});l(y.analytics,function(){return new Promise(function(t,n){e(["I4e"],t,n)})});l(y.zip,function(){return new Promise(function(t,n){e(["F4e"],t,n)})});l(y.customAction,function(){return new Promise(function(t,n){e(["E0e"],t,n)})});i.expose(g.customAction,new(i.resolved(We.default))({}));if(pt.isFeatureEnabled(pt.UserExpirationPanel)&&o.isSiteAdmin){i.exposeFactory(y.userExpiration,new f.AliasResourceFactory(ye.resourceKey));i.expose(g.userExpiration,new(i.resolved(ft.default))({}));i.consumeAsync(xt.resourceKey).then(function(e){e.autoOpenPanelBaseOnQueryParams()})}i.exposeFactory(y.mruRecent,new f.AliasResourceFactory(W.resourceKey));i.exposeFactory(g.mruRecent,new f.AliasResourceFactory(C.resourceKey));i.expose(v.actionMap,new dt.default);if(yt.isOneDriveWinApp()){i.exposeFactory(y.winAppCommunicator,new f.AliasResourceFactory(ve.resourceKey));i.consumeAsync(re.resourceKey.bypass);i.consumeAsync(Z.resourceKey)}i.exposeFactory(y.wip,new f.AliasResourceFactory(lt.resourceKey));s.EngagementHelpers.registerClicks("ODB");if(pt.isFeatureEnabled(pt.EnableFloodgate)){i.expose(b.floodgateAppId,2160);i.exposeFactory(y.floodgate,new f.AliasResourceFactory(xe.resourceKey))}return i}});
define("iw",["require","exports","ww","Pe","fv","ZI","Je"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSpOneDrivePageCacheSync=t.getSpOneDrivePageDataCache=t.listWebRelativeUrl=t.spPageContext=void 0;var u;window.location.search.indexOf("nullpagecontext")>=0&&(window._spPageContextInfo=null);t.spPageContext=window._spPageContextInfo;if(t.spPageContext){if(!o.default.isActivated("9FA9EFD3-16F5-4D1D-AAC3-8DB2472C33D7","6/19/2020","Only assign list URL for OneDrive if not present")&&Number(t.spPageContext.webTemplate)===i.default.mySite&&!t.spPageContext.listUrl){t.spPageContext.listUrl=new r.SimpleUri(t.spPageContext.webAbsoluteUrl).path+"/Documents";u="Documents"}Object.freeze(t.spPageContext)}t.listWebRelativeUrl=u||"";t.getSpOneDrivePageDataCache=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return window._spOneDrivePageDataCache?[2,Promise.resolve(window._spOneDrivePageDataCache)]:[4,s.listDataFlushSignal.promise];case 1:e.sent();return[2,Promise.resolve(window._spOneDrivePageDataCache)]}})})};t.getSpOneDrivePageCacheSync=function(){return window._spOneDrivePageDataCache}});
define("XLt",["require","exports","t","v","de","I3","ZLt","tft"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.odbKnockoutAppBoot=t.ODBOneDrive=void 0;var a=(function(){function e(e,t){i.default.mark("EUPL.ODBAppBoot.Start");this._resources=t.resources;this._addPinnedTabIcon();this._applyBindings()}e.prototype._applyBindings=function(){var e=this;s.waitForDomLoad(function(t){t&&i.default.mark("EUPL.ODBAppBoot.DOMContentLoaded");var r=document.createElement("div");document.body.appendChild(r);n.applyBindingsToNode(r,{component:{name:u.default.tagName,params:{resources:e._resources}}});i.default.mark("EUPL.ODBAppBoot.End")})};e.prototype._addPinnedTabIcon=function(){o.default.SetMaskIcon(window.require.toUrl("odsp-media/images/maskicon/mask_icon.svg"),"#094AB2")};return e})();t.ODBOneDrive=a;t.odbKnockoutAppBoot=r.createResolvedResourceKey(e("module").id,a,{resources:r.resourceScopeKey})});
define("Dw",["require","exports","ww","Iw","v","mx","ux","T","jC"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeLogging=void 0;var f=!1;t.initializeLogging=function(e){var t=e.viewParams,l=e.clientName;if(!f){f=!0;var c=n.__assign({},a.getHostAppAriaContext({viewParams:t,clientName:l}));r.default({context:c});u.rootResourceScope.expose(s.rumOneScenarioPrefix,"ODBNext");u.rootResourceScope.exposeFactory(s.rumOneHelper,new i.AliasResourceFactory(o.resourceKey))}}});
define("JLt",["require","exports","t","W","P2","ZO","bv","JO","v","g","T2","pO","YO","R2","YN","wK","Kz","Cat","Dat","yat","yK","vat","fB","qO","XN"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addSuiteNavResources=void 0;var N=new a.ResourceKey("hasExposedSuiteNavResources");t.addSuiteNavResources=function(e){var t;if(!e.isExposed(N)){e.expose(N,!0);var C=e.consume(f.pageContext);e.expose(T.sharepointUrl,n.observable(""));e.expose(T.isTenantAdmin,n.observable(!1));var k={workloadId:x.default.SHAREPOINT,currentMainLinkElementID:x.default.ONEDRIVE,showMySiteSettings:!1,helpNamespace:"Groove",helpId:"ODB_Overview"},L=e.consume(m.typeResourceKey),A={supportsCaching:!0,supportsRealSuiteNav:!0,collapseO365Settings:!0,enableDelayLoading:!0};if(S.isFeatureEnabled(S.UnifiedSuiteNavBootstrapperLoadingFlow)){var O=e.expose(c.suiteNavBasic,new u.default({suiteNavContext:k,suiteNavCapabilities:A},{pageContext:C}));e.expose(l.suiteNavBasic,new s.default({engagementEvent:o.Engagement,qosEvents:(t={},t[i.SuiteNavQosLabel.GET_O365_SHELL]=new r.Qos({name:i.SuiteNavQosLabel.GET_O365_SHELL}),t)},{dataSource:O}))}e.expose(c.suiteNavV2,new L({suiteNavContext:k,suiteNavDataUpdater:e.consume(d.resourceKey),suiteNavCapabilities:A,suiteNavDataSourceBasic:e.consume(c.suiteNavBasic.optional)}));e.exposeFactory(h.resourceKey,new a.AliasResourceFactory(p.resourceKey));e.exposeFactory(y.resourceKey,new a.AliasResourceFactory(b.resourceKey));e.exposeFactory(v.resourceKey,new a.AliasResourceFactory(g.resourceKey));e.exposeFactory(w.resourceKey,new a.AliasResourceFactory(E.resourceKey))}}});
define("h$",["require","exports","ey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.canListItemBeOpened=t.convertToIOneDriveItem=t.convertToISPListItem=void 0;t.convertToISPListItem=function(e){return e};t.convertToIOneDriveItem=function(e){return e};t.canListItemBeOpened=function(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&4!==e.itemStatus&&3!==e.itemStatus&&n.PermissionMask.hasItemPermission(e,n.PermissionMask.openItems)}});
define("wZ",["require","exports","EZ","ze","M","X7"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(){}e.getFilterList=function(e,t,r,i){return s.default.getFilterList(e,t,r,i,n.default.EmptyFilterValue)};e.clearFilterInfo=function(t,n){n=n||0;for(var r=e.getFilterList(t),i=n;i<r.length;i++){var o=r[i];t=s.default.addFilterInfo(t,o.fieldName,null,!0)}return t};e.getInplviewHash=function(e,t){var n="#InplviewHash"+(e=i.default.normalizeLower(e||"",!1))+"=";t&&(n+=Object.keys(t).map(function(e){var n=r.default.encodeURIComponent(t[e]);return r.default.encodeURIComponent((e+"="+n).replace(/-/g,"--"))}).join("-"));return n};return e})();t.default=o});
define("Oee",["require","exports","A"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withLoaderCache=void 0;t.withLoaderCache=function(e){var t;return function(){return t||(t=n.default.resolve(e()).then(function(e){return e.default}).catch(function(e){t=void 0;return n.default.reject(e)}))}}});
define("qb",["require","exports","ww","W"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.logEndData=t.logExpectedFailure=t.logUnexpectedFailure=t.logSuccess=t.reset=t.restart=t.init=void 0;var i;function s(e,t){if(!i){var s=e||{name:"App"},o=r.Qos.withContext(function(e){return t?n.__assign(n.__assign({},e),{Workload:t}):e});i=new o(s)}return i}t.init=s;t.restart=function(){i=void 0;return s()};t.reset=function(){i=void 0};t.logSuccess=function(e){var t=(e||{}).workload;i||s(void 0,t);i.end(e||{resultType:r.ResultTypeEnum.Success})};t.logUnexpectedFailure=function(e){var t=e.workload;i||s(void 0,t);i.end(e||{resultType:r.ResultTypeEnum.Failure})};t.logExpectedFailure=function(e){var t=e.workload;i||s(void 0,t);i.end(e||{resultType:r.ResultTypeEnum.ExpectedFailure})};t.logEndData=function(e){var t=e.workload;i||s(void 0,t);e&&i.end(e)}});
define("VC",["require","exports","ww","WC","k4","KC","GC","zC","Ia"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getHostAppAriaContext=t.getPickerAriaContext=void 0;t.getPickerAriaContext=function(e){var t,r,i,u,a,l=e.viewParams,c=e.context,h=c.ClientName,p=c.Scenario,d=l[s.PICKER_PARAM_KEY]||"",v=l[o.FILE_PICKER_PARAM_KEY]||"";try{u=JSON.parse(d)}catch(e){}try{a=JSON.parse(v)}catch(e){}var m,g,y,b=!1,w=l.client_id||l.aad_client_id||l.msa_client_id;if(a){b=f(null===(t=a.typesAndSources)||void 0===t?void 0:t.filters);m=null===(r=a.typesAndSources)||void 0===r?void 0:r.mode;g=null===(i=a.telemetry)||void 0===i?void 0:i.sessionId}else if(u)try{u.aid&&(w=u.aid);b=f(u.f);m=u.v||void 0}catch(e){}y="folders"===m?"Folder":b?"Media":"File";return n.__assign(n.__assign(n.__assign(n.__assign({},c),g?{Session:g}:{}),w?{AppId:w}:{}),{PickerType:y+"Picker",IsFilePicker:1,IsSharedControl:!0,Scenario:(p?p+".":"")+"Picker."+y,ClientName:(h?h+".":"")+"Picker."+y})};t.getHostAppAriaContext=function(e){var t=e.viewParams,r=e.clientName,i=t.app,s=t.scenario;return n.__assign(n.__assign({},s?{Scenario:s}:{}),{ClientName:(i?i+".":"")+r})};function f(e){var t=u.getTypeFilter(e);return!!t&&i.doExtFiltersHaveMediaTypesOnly({extFilters:t,allowedMediaTypes:[r.ItemTypeFilter.photo,r.ItemTypeFilter.video],fileTypeIconMap:a.FileTypeIconMap})}});
define("ux",["require","exports","ww","Z2","v","mx","pO","Je","EI","xv","kv","Gv","de","je","Ow","px","zi","g","tg","Be","Wb","dv","gy","k3","fx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.RUMOneHelper=t.MODERNONEPAGE=void 0;t.MODERNONEPAGE="isModernOnePage";var N=(function(e){n.__extends(i,e);function i(t,n){var r=e.call(this)||this;r.listViewLogged=!1;r._calculateTTITimeByTransition=function(e,t){if(t===c.default.fullPageLoad)return e;if(t===c.default.onePageAppNavigation){return e-r._getTransactionStartTime()}return e};var i=n.navigation,s=n.rumOneScenarioPrefix,o=n.urlDataSource,u=n.pageContext,a=n.bootOptions,f=n.platformDetection;r.scenarioPrefix=s;r.urlDataSource=o;r.navigation=i;r._bootOptions=a;r._pageContext=u;r._viewParams=i.viewParams;r._chromeless=E.isWebViewHosted();r._platformDetection=f;r.listInfo="SPList"===r.scenarioPrefix?m.isDocumentLibrary(r._pageContext&&r._pageContext.listBaseTemplate||"")?".DocumentLibrary":".CustomList":"";r._collectFid();r._evaluateExperiments();r._logBaseUrl();return r}i.prototype.getControlRenderTime=function(e){var t=this.rumone.readControlPerformanceData().filter(function(t){return t.controlId===e})[0];return t&&t.renderTime||NaN};i.prototype.logRUMOneForItemsScopeListView=function(e,r,i){var s,o,u=this,d=this.rumone,v=this._breakdownData,m=!1;if(d&&d.isRunning()&&!this.listViewLogged){this._logHostAppStart()&&void 0!==(null===(s=this._bootOptions)||void 0===s?void 0:s.hostAppStart)&&d.setPerformanceDataPropertyValue("PageTransitionType",c.default.onePageAppNavigation);d.addExpectedControl(this.scenarioPrefix+"ListView");d.writePageTransitionType(this._getPageTransitionTypeForListView(),!0);var g=this._getRequiredQuietnessDurationInMilliseconds();d.setSettings({TTISettings:{TTIPolyfillSettings:{enabled:!0,calculateTTI:function(e,t){m?u._ttiSignal.resolve():m=!0;i&&i(e,t);return u._calculateTTITimeByTransition(e,t.PageTransitionType)},options:n.__assign({useMutationObserver:!1,trackNetworkRequests:!1},g)}}});var y=a.default[this.urlDataSource.getPageType(this._viewParams)]+"-"+(f.default[this.urlDataSource.getQueryType(this._viewParams)]||"Default");d.writeScenarioId(this.scenarioPrefix+this.listInfo+"."+y,!0);var b=d.getPerformanceDataPropertyValue("PageTransitionType");b===c.default.fullPageLoad&&d.collectW3cResourceTimings();void 0!==window.g_duration&&void 0!==window.g_iisLatency&&d.writeServerSideLatency(window.g_duration,window.g_iisLatency);if(window._spPageContextInfo){d.writeServerCorrelationId(window._spPageContextInfo.CorrelationId);d.collectSPClientFlights(window._spPageContextInfo)}this._logColdHit(d);var w=void 0,E=d.getMarkerTime(h.AppStartMarkerName),S=d.getMarkerTime("EUPL.SPOAppBoot.NewStart"),x=d.readEUPLBreakdown("itemsView.dataFetch"),N=Number(d.getPerformanceDataPropertyValue("W3cNavigationStart")),C=r.itemsScopeInitTime,k=void 0===C?NaN:C,L=this._CollectBreakDown(),A=!!document.getElementById("requireJsString");d.addEUPLBreakdown("inlineRequireJS",{data:A,needFlatten:!0});d.addEUPLBreakdown("isItemsView",{data:!0,needFlatten:!0});d.addEUPLBreakdown("isChromeless",{data:this._chromeless,needFlatten:!0});d.addEUPLBreakdown("isListDataSyncEnabled",{data:!!window.__isListDataSyncEnabled,needFlatten:!0});if(b===c.default.fullPageLoad){d.addEUPLBreakdown("FullPageOrOnePage",{data:!0,needFlatten:!0});if("SPList"===this.scenarioPrefix){d.addExpectedControl({controlId:"SuiteNav",ignoreForEUPL:!0});d.addExpectedControl({controlId:"TopLevelCommandBar",ignoreForEUPL:!0});this._chromeless||d.addExpectedControl({controlId:"ReactLeftNav",ignoreForEUPL:!0})}this.scenarioPrefix;w=h.HighResolutionTimingSupported?0:N;var O=d.getMarkerTime("EUPL.StoreInitialization.Start"),M=d.getMarkerTime("EUPL.StoreInitialization.End"),_=h.default.summary,D=h.default.getResponseEnd()-N,P=d.getMarkerTime(T.REQUIRE_CONFIG_START),H=d.getMarkerTime(T.SCRIPT_START),B=d.getMarkerTime("AppStart");p.extend(L,{w3cResponseEnd:v(D),appStart:v(_.appStart),inlineScripts:v(P-D),scriptFetch:v(H-P),appLoad:v(B-H),newAppStart:v(_.appStart-E+S),newAppStartTime:v(S),dataFetch:v(x),render:v(e-E-(x||0)),itemsViewRender:v(e-k),preItemsViewRender:v(k-E),storeInitialization:v(M-O),prefetchStart:v(_.prefetchStart),deferredListDataRender:v(_.deferredListDataRender)})}else if(b===c.default.onePageAppNavigation){d.addEUPLBreakdown("FullPageOrOnePage",{data:!0,needFlatten:!0});if(this._logHostAppStart()){var j=!!(null===(o=this._bootOptions)||void 0===o?void 0:o.hostAppStart)&&!d.getMarkerTime(h.OnePageNavigationStartMarkerName);d.addEUPLBreakdown("isHosted",{data:j,needFlatten:!0})}d.readTempData(t.MODERNONEPAGE)&&d.addEUPLBreakdown(t.MODERNONEPAGE,{data:!0,needFlatten:!0});w=this._getTransactionStartTime();var F=d.getMarkerTime("OnePage.Prefetch.Start"),I=d.getMarkerTime("OnePage.Prefetch.End"),q=(B=d.getMarkerTime("AppStart"),d.getMarkerTime("OnePage.LoadRequireJS.Start")),R=d.getMarkerTime("OnePage.LoadRequireJS.End"),U=d.getMarkerTime("SPOAppBoot.Start");P=d.getMarkerTime("EUPL.OnePage.requireConfig.Start");q?p.extend(L,{appStart:v(B-w),dataFetch:v(I-F),render:v(e-U),requireJSLoad:v(R-q),requireConfigCost:v(B-P)}):p.extend(L,{dataFetch:v(x),render:v(e-w-(x||0))})}d.mark("glass");this._logServiceWorkerMetrics();var z=d.getMarkerTime("SPOAppBoot.DOMContentLoaded");if(!isNaN(z)){U=d.getMarkerTime("SPOAppBoot.Start");d.addEUPLBreakdown("timeWaitForBody",{data:z-U,needFlatten:!0})}d.writeEUPLBreakdown(JSON.stringify(L));var W=new l.default(this.scenarioPrefix+"ListView",w,e,this.computeRenderTime,this.checkRenderTimeRequiredDataAvailable);d.writeControlPerformanceData(W);this.listViewLogged=!0}};i.prototype.logRUMOneForDeferredControl=function(e,t){d.isFeatureEnabled(d.UnifiedSuiteNavBootstrapperLoadingFlow)&&"SuiteNav"===e&&this._logSuiteNavBreakdownData();var n=this._getPageTransitionTypeForListView(),r=h.HighResolutionTimingSupported?0:Number(this.rumone.getPerformanceDataPropertyValue("W3cNavigationStart"));if(n===c.default.fullPageLoad){var i=new l.default(e,r,t,this.computeRenderTime,this.checkRenderTimeRequiredDataAvailable,!0,!0);this.rumone.isRunning()&&this.rumone.writeControlPerformanceData(i)}};i.prototype.dispose=function(){this.rumone.resetLogger();delete this.rumone};i.prototype._logColdHit=function(e){var t=window._spModuleLink;if("undefined"!=typeof Storage&&t){var n=window.localStorage.getItem("spListBuildNumber"),r=t.buildNumber;n&&e.addEUPLBreakdown("isColdHit",{data:n!==r,needFlatten:!0});localStorage.setItem("spListBuildNumber",r)}};i.prototype._getRequiredQuietnessDurationInMilliseconds=function(){var e=new b.default(location.href),t=e.getQueryParameter("ttithreshold")?Number(e.getQueryParameter("ttithreshold")):1e3;return{requiredMainThreadQuietnessDurationInMilliseconds:t,requiredNetworkQuietnessDurationInMilliseconds:t}};i.prototype._evaluateExperiments=function(){this._pageContext&&!this._platformDetection.isIE&&-1===this._platformDetection.userAgent.toLowerCase().indexOf("opera mini")&&S.getVariantAndLogExposure(d.BROTLI_EXP,this._pageContext)};i.prototype._logSuiteNavBreakdownData=function(){var e=this.rumone.getMarkerTime("Bootstrapper.SuiteNav.InitialRendered");this.rumone.addEUPLBreakdown("SuiteNavInitialRendered",this._breakdownData(e))};i.prototype._collectFid=function(){var e=this;if("hidden"!==document.visibilityState&&"PerformanceObserver"in window)try{var t=new PerformanceObserver(function(n){for(var r=0,i=n.getEntries();r<i.length;r++){var s=i[r],o=Math.round(s.processingStart-s.startTime);e.rumone.addEUPLBreakdown("FID",{data:o,needFlatten:!0});t.disconnect();break}});t.observe({type:"first-input",buffered:!0})}catch(e){}};i.prototype._logHostAppStart=function(){return!u.default.isActivated("D77FD546-1AF3-4A69-8CDD-694A81E9BADB","07/15/2020","Log hostAppStart as transactionStartTime")};i.prototype._getTransactionStartTime=function(){var e,t=this.rumone.getMarkerTime(h.OnePageNavigationStartMarkerName);this._logHostAppStart()&&isNaN(t)&&(t=Number(null===(e=this._bootOptions)||void 0===e?void 0:e.hostAppStart));return t};i.dependencies=n.__assign(n.__assign({},r.default.dependencies),{urlDataSource:o.urlLite,navigation:y.navigation,rumOneScenarioPrefix:s.rumOneScenarioPrefix,bootOptions:w.resourceKey.optional,pageContext:g.pageContext.optional,platformDetection:x.platformDetection});return i})(v.default);t.RUMOneHelper=N;t.default=N;t.resourceKey=i.createResolvedResourceKey(e("module").id,N)});
define("px",["require","exports","ww","Mv","Gv","de","R","ox","ax","Tv"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FILTER_ACTION=t.SORT_ACTION=void 0;t.SORT_ACTION="Sort";t.FILTER_ACTION="Filter";var l=(function(){function e(){var e=this;this.rumone=r.default.getRUMOneLogger();this._ttiSignal=new o.Signal;f.TTIIsSupported()||this._ttiSignal.resolve();window.getRumOneForTAB=function(){return e.rumone}}e.prototype.waitForTTI=function(){return this._ttiSignal.promise};e.prototype.mark=function(e){this.rumone.mark(e)};e.prototype.markOnce=function(e){this.rumone.getMarkerTime(e)||this.mark(e)};e.prototype.checkRenderTimeRequiredDataAvailable=function(e,t){return!(!e||!t)&&(t.startTime>=0&&t.endTime>t.startTime)};e.prototype.computeRenderTime=function(e,t){return e&&t?t.endTime-t.startTime:0};e.prototype.isDocumentLibrary=function(){return!1};e.prototype.logPropertiesPaneLaunch=function(){};e.prototype.logPropertiesPaneUpdate=function(){};e.prototype.logPropertiesPaneModifyProperty=function(){};e.prototype.logPropertiesPaneEnd=function(){};e.prototype.getControlRenderTime=function(e){return NaN};e.prototype.logOnePageNavigationStart=function(){};e.prototype.logFilterSort=function(e){};e.prototype.logLaunchFilterPaneStart=function(){};e.prototype.logLaunchFilterPaneEnd=function(){};e.prototype.logRUMOneForListView=function(e){};e.prototype.logRUMOneForItemsScopeListView=function(e,t){};e.prototype.logRUMOneForDeferredControl=function(e,t){};e.prototype.logPowerAppFormLoadStart=function(e){};e.prototype.logPowerAppFormUserClick=function(){};e.prototype.logPowerAppFormLoadEnd=function(){};e.prototype.logPowerAppFormDataLoadEnd=function(){};e.prototype.logPowerAppFormLoadScenarioEnd=function(){};e.prototype.logPowerAppFormClickScenarioEnd=function(){};e.prototype.dispose=function(){this.rumone.resetLogger();delete this.rumone};e.prototype._getTimingNormalizer=function(e){return function(t){t=Math.round(t);if(s.HighResolutionTimingSupported)return t>=e?t-e:t;if(t<e)throw new Error("timing "+t+" should not be smaller than navigationStart "+e);return t}};e.prototype._CollectBreakDown=function(e){var t=window.__themeState__.perf,r=navigator.userAgent,i={loadStyleDuration:{data:t?t.duration:NaN,needFlatten:!0},loadStyleCount:{data:t?t.count:NaN,needFlatten:!0},isCloudAppSecurity:r.indexOf("CAS_CAAC")};e=n.__assign(n.__assign({},e),i);window.tabperf=e;return e};e.prototype._getPageTransitionTypeForListView=function(){return this.rumone.getMarkerTime(s.OnePageNavigationStartMarkerName)?i.default.onePageAppNavigation:void 0!==this.rumone.getPerformanceDataPropertyValue("PageTransitionType")?this.rumone.getPerformanceDataPropertyValue("PageTransitionType"):this.rumone.getMarkerTime("ListViewUpdate.Start")?i.default.none:i.default.fullPageLoad};e.prototype._breakdownData=function(e){return{data:e,needFlatten:!0}};e.prototype._logBaseUrl=function(){window.require&&this.rumone.addEUPLBreakdown("ManifestBaseUrl",this._breakdownData(window.require.toUrl("")))};e.prototype._logServiceWorkerMetrics=function(){var e=this.rumone;e.addEUPLBreakdown("pageServedFromCache",{data:!!window.__pageFromServiceWorker,needFlatten:!0});var t=u.getServiceWorkerState(),n=t.state,r=t.serviceWorkerScriptLocation;e.addEUPLBreakdown("serviceWorkerState",{data:n,needFlatten:!0});e.addEUPLBreakdown("serviceWorkerScriptLocation",{data:r,needFlatten:!0});if("1"===sessionStorage.getItem(a.SERVICEWORKER_SHOULDREFRESH_FLAG)){sessionStorage.removeItem(a.SERVICEWORKER_SHOULDREFRESH_FLAG);e.addEUPLBreakdown("reloadByServiceWorker",{data:!0,needFlatten:!0})}if("1"===sessionStorage.getItem(a.SWINSTALLED)){sessionStorage.removeItem(a.SWINSTALLED);e.addEUPLBreakdown("firstPageLoadAfterSWInstall",{data:!0,needFlatten:!0})}var i=u.getNavigationTiming();if(i){e.addEUPLBreakdown("navigation.fetchStart",{data:i.fetchStart,needFlatten:!1});e.addEUPLBreakdown("navigation.requestStart",{data:i.requestStart,needFlatten:!1});e.addEUPLBreakdown("navigation.workerStart",{data:i.workerStart,needFlatten:!1})}};return e})();t.default=l});
define("jC",["require","exports","LI","VC","EI"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getHostAppAriaContext=void 0;t.getHostAppAriaContext=function(e){var t=e.viewParams;return n.getPageType(t)===i.default.FilePicker?r.getPickerAriaContext({context:r.getHostAppAriaContext(e),viewParams:e.viewParams}):r.getHostAppAriaContext(e)}});
define("ZLt",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.SetMaskIcon=function(e,t){var n=document.head;if(n){"#"!==(t=t.trim()).charAt(0)&&(t="#"+t);var r=document.createElement("link");r.setAttribute("rel","mask-icon");r.setAttribute("href",e);r.setAttribute("color",t);n.appendChild(r)}};return e})();t.default=n});
define("Cx",["require","exports","Ex"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getMimeTypeForExtension=t.canOpenInMonacoForExtension=t.canOpenItemInMonaco=t.canOpenInMonaco=t.TEXT_MIME_TYPE=void 0;t.TEXT_MIME_TYPE="text/plain";var r={abap:"text/plain",ada:"text/plain",adp:"text/plain",ahk:"text/plain",as:"text/plain",as3:"text/plain",asc:"text/plain",ascx:"text/xml",asm:"text/plain",asp:"text/plain",awk:"text/plain",bash:"text/plain",bash_login:"text/plain",bash_logout:"text/plain",bash_profile:"text/plain",bashrc:"text/plain",bat:"text/x-bat",bib:"text/plain",bsh:"text/x-java",build:"text/plain",builder:"text/plain",c:"text/x-cpp","c++":"text/x-c++src",capfile:"text/plain",cc:"text/x-c++src",cfc:"text/plain",cfm:"text/plain",cfml:"text/plain",cl:"text/plain",clj:"text/plain",cls:"text/plain",cmake:"text/plain",cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:"text/plain",cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:"text/plain",db:"text/plain",ddl:"text/plain",di:"text/plain",dif:"text/plain",diff:"text/plain",disco:"text/xml",dml:"text/plain",dtd:"text/xml",dtml:"text/xml",el:"text/plain",emakefile:"text/plain",erb:"text/plain",erl:"text/plain",f:"text/plain",f90:"text/plain",f95:"text/plain",fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:"text/plain",gemspec:"text/ruby",gitconfig:"text/x-ini",go:"text/plain",groovy:"text/plain",gvy:"text/plain",h:"text/x-cpp","h++":"text/x-c++hdr",haml:"text/plain",handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:"text/plain",hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:"text/plain",hs:"text/plain",htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:"text/plain",inc:"text/html",inf:"text/plain",ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:"text/plain",jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:"text/plain",jsx:"text/javascript",l:"text/plain",less:"text/x-less",lhs:"text/plain",lisp:"text/plain",log:"text/plain",lst:"text/plain",ltx:"text/plain",lua:"text/x-lua",m:"text/plain",mak:"text/plain",make:"text/plain",markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:"text/plain",mli:"text/plain",mll:"text/plain",mly:"text/plain",mm:"text/plain",mud:"text/plain",nfo:"text/plain",opml:"text/xml",osascript:"text/plain",out:"text/plain",p:"text/plain",pas:"text/plain",patch:"text/plain",php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:"text/plain",plist:"text/plain",pm:"text/plain",pod:"text/plain",pp:"text/plain",profile:"text/plain",properties:"text/plain",ps1:"text/x-powershell",ps1xml:"text/x-powershell",psd1:"text/x-powershell",psm1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:"text/plain",r:"text/plain",rake:"text/plain",rb:"text/ruby",rbx:"text/plain",rc:"text/plain",re:"text/plain",reg:"text/plain",rest:"text/plain",resw:"text/xml",resx:"text/xml",rhtml:"text/plain",rjs:"text/plain",rprofile:"text/plain",rpy:"text/plain",rss:"text/xml",rst:"text/plain",rxml:"text/plain",s:"text/plain",sass:"text/scss",scala:"text/plain",scm:"text/plain",sconscript:"text/plain",sconstruct:"text/plain",script:"text/plain",scss:"text/scss",sgml:"text/xml",sh:"text/plain",shtml:"text/html",sml:"text/xml",sql:"text/plain",sty:"text/plain",t:"text/plain",tcl:"text/plain",tex:"text/plain",text:"text/plain",textile:"text/plain",tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:"text/plain",vb:"text/x-vb",vi:"text/plain",vim:"text/plain",wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:"text/plain",xslt:"text/plain",yaml:"text/plain",yaws:"text/plain",yml:"text/plain",zsh:"text/plain"};function i(e){return((e&&"."===e[0]?e.substring(1):e)||"").toLowerCase()}function s(e){e=i(e);return r.hasOwnProperty(e)}t.canOpenInMonaco=s;t.canOpenItemInMonaco=function(e){return!!e&&!!e.extension&&o(e.extension,e.type)};function o(e,t){return s(e)&&(t===n.default.File||t===n.default.Media||t===n.default.Unknown)}t.canOpenInMonacoForExtension=o;t.getMimeTypeForExtension=function(e){e=i(e);return r.hasOwnProperty(e)?r[e]:void 0}});
define("R$",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id+".sharedRecentEvents",loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["oxe"],t,n)}).then(function(e){return e.resourceKey})})})});
define("gse",["require","exports","ww","g","v","vse","Sie","vse"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;n.__exportStar(u,t);t.resourceKey=i.createResolvedResourceKey(e("module").id,s.GraphPeoplePickerHelper,{oAuthTokenProvider:o.resourceKey,pageContext:r.pageContext,sharingContextInformation:r.sharingContextInformation.optional})});
define("bse",["require","exports","ww","g","v","tT","Sie","tT"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;n.__exportStar(u,t);t.resourceKey=i.createResolvedResourceKey(e("module").id,s.SubstratePeoplePickerHelper,{oAuthTokenProvider:o.resourceKey,pageContext:r.pageContext,sharingContextInformation:r.sharingContextInformation.optional})});
define("fx",["require","exports","Oo","de","Ow"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.markAppStart=t.REQUIRE_CONFIG_START=t.SCRIPT_START=void 0;t.SCRIPT_START="ScriptStart";t.REQUIRE_CONFIG_START="RequireConfigStart";t.markAppStart=function(){r.default.appStart();n.measure("AppStart","W3CResponseEnd","AppStart");n.measure("InlineScripts","W3CResponseEnd",t.REQUIRE_CONFIG_START);n.measure("ScriptFetch",t.REQUIRE_CONFIG_START,t.SCRIPT_START);n.measure("AppLoad",t.SCRIPT_START,"AppStart");if(i.isFeatureEnabled(i.StopAtAppStart))throw"Stopping after App Start"}});
define("qne",["require","exports","qD"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createProtocolHandlerUrl=t.protocolCommand=void 0;t.protocolCommand=n.ProtocolHandlerHelper.protocolCommand;t.createProtocolHandlerUrl=function(e,t,r,i,s,o){var u=n.ProtocolHandlerEncodeOption.none;s&&(u=n.ProtocolHandlerEncodeOption.encodeCommand);return n.ProtocolHandlerHelper.CreateProtocolHandlerUrl(e,t,r,i,u,o)}});
define("lz",["require","exports","ww","tB","wz","_z","A","mz","pz","uz","LO","nB","v"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.getSelectedItemApp=void 0;var p=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogProvider=n.dialogProvider;r._promiseTracker=n.promiseTracker;r._itemSetSelectionModel=n.itemSetSelectionModel;return r}t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(a.default.resolveDescription),r=this.createObservable(!0),i=this.createObservable(!1),s=this._shouldShowDialog();if(this._itemSetSelectionModel){t=this._itemSetSelectionModel.resolveSelection().then(function(t){s=!1;e&&e.state(2);return t},function(t){if(e){n(a.default.resolveError);r(!1);i(!0)}return o.default.wrapError(t)});s&&(e=this._createDialog(n,r,i)).wait().done(void 0,function(){t.cancel()});this._promiseTracker&&this._promiseTracker.registerPromise(t)}else t=o.default.wrap([]);return t};t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:a.default.resolveTitle,isDismissable:!1,component:{name:s.default.tagName,params:{text:e}},actions:[{name:u.default.cancelActionText,execute:function(){return o.default.wrap(3)},isVisible:t,icon:new f.default("Cancel"),isDefault:!0},{name:u.default.ok,execute:function(){return o.default.wrap(3)},isVisible:n,icon:new f.default("Cancel"),isDefault:!0}]})};t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{dialogProvider:i.resourceKey,promiseTracker:l.promiseTracker.optional,itemSetSelectionModel:l.itemsSelection});return t})(r.default);t.default=p;t.getSelectedItemApp=function(e){var t=e.selection();if(1===t.length){var n=c.unwrap(t[0]);return n.appMap?n.appMap:"nonOfficeApp"}};t.resourceKey=h.createResolvedResourceKey(e("module").id,p)});
define("eTe",["require","exports","ww","Uxe","tB","k3"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SyncActiveXClient=void 0;var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._platform=n.resources.consume(s.platformDetection);return n}t.IsBrowserPluginInstalled=function(e){var t=navigator.mimeTypes&&navigator.mimeTypes[e];return!!t&&!!t.enabledPlugin};t.prototype.TryUseOfflineClient=function(e,t,n,r,i,s,o){if(this._initOfflineClient()){try{if(!this._isOfflineAllowedByClient(e,t,r,i))return!1;this._offlineClient.TakeOffline(e,t,n,r,i,s,o)}catch(e){return!1}return!0}return!1};t.prototype._isOfflineAllowedByClient=function(e,t,n,r){return this._offlineClient.IsOfflineAllowed(e,t,n,r)};t.prototype._initOfflineClient=function(){try{if(!this._platform.isWindows7)return!1;if(!this._offlineClient)if(-1===document.cookie.indexOf("OfflineClientInstalled")){this._isSupportedMacBrowser()?this._offlineClient=this._createMacPlugin():this._offlineClient=new ActiveXObject("SharePoint.OfflineClient");r.set("OfflineClientInstalled","1")}else{if("1"!==r.get("OfflineClientInstalled"))return!1;this._isSupportedMacBrowser()?this._offlineClient=this._createMacPlugin():this._offlineClient=new ActiveXObject("SharePoint.OfflineClient")}if(this._offlineClient&&void 0!==this._offlineClient&&void 0!==this._offlineClient.IsOfflineAllowed&&void 0!==this._offlineClient.TakeOffline)return!0}catch(e){r.set("OfflineClientInstalled","0");this._offlineClient=null}return!1};t.prototype._isSupportedMacBrowser=function(){return this._platform.isMac&&(this._platform.isFirefox||this._platform.isSafari||this._platform.isChrome)};t.prototype._createMacPlugin=function(){var e=null;if(this._isSupportedMacBrowser()&&!this._platform.isChrome&&null===(e=document.getElementById("macSharePointPlugin"))&&this._isMacPluginInstalled()){var n=null;n=this._platform.isSafari&&t.IsBrowserPluginInstalled("application/x-sharepoint-webkit")?"application/x-sharepoint-webkit":t.MAC_PLUGIN_MIME_TYPE;var r=document.createElement("object");r.id="macSharePointPlugin";r.type=n;r.width="0";r.height="0";r.style.visibility="hidden";document.body.appendChild(r);e=document.getElementById("macSharePointPlugin")}return e};t.prototype._isMacPluginInstalled=function(){var e=t.IsBrowserPluginInstalled("application/x-sharepoint-webkit"),n=t.IsBrowserPluginInstalled(t.MAC_PLUGIN_MIME_TYPE);return!(!this._platform.isSafari||!e)||n};t.MAC_PLUGIN_MIME_TYPE="application/x-sharepoint";return t})(i.default);t.SyncActiveXClient=o;t.default=o});
define("xx",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isGCCLow=t.isPPE=t.isGovernmentTenant=t.isBlackForest=t.isGallatin=void 0;t.isGallatin=function(e){return e?"gallatin"===e:location.origin.indexOf(".cn")===location.origin.length-3};t.isBlackForest=function(e){return e?"blackforest"===e:location.origin.indexOf(".de")===location.origin.length-3};t.isGovernmentTenant=function(e){return"pathfinder"===e||"trailblazer"===e};t.isPPE=function(e){return"prodbubble"===e};t.isGCCLow=function(e){return"US_2_Content"===e||"US_86_Content"===e||"US_96_Content"===e||"US_105_Content"===e||"US_265_Content"===e||"US_266_Content"===e||"US_267_Content"===e||"US_268_Content"===e||"US_269_Content"===e||"US_270_Content"===e}});
define("tOe",["require","exports","ww","g","tg","O2","tB","fB","v"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.UserExpirationUtils=void 0;var f=(function(t){n.__extends(a,t);function a(e,n){void 0===e&&(e={});var r=t.call(this,e,n)||this;r._pageContext=n.pageContext;r._navigation=n.navigation;return r}a.prototype.autoOpenPanelBaseOnQueryParams=function(){if(this._checkPermissions()&&this._urlContainsUserExpirationParam()){this._openUserExpirationPanel();this._removeUserExpirationUrlParam()}};a.prototype._urlContainsUserExpirationParam=function(){if(this._navigation.viewParams){if(this._navigation.viewParams.userExpiration||this._navigation.viewParams["userExpiration".toLowerCase()])return!0}return!1};a.prototype._checkPermissions=function(){return this._pageContext.isSiteAdmin&&u.isFeatureEnabled(u.UserExpirationPanel)};a.prototype._removeUserExpirationUrlParam=function(){if(this._navigation.viewParams){var e=n.__assign({},this._navigation.viewParams);if(e.userExpiration||e["userExpiration".toLowerCase()]){delete e.userExpiration;delete e["userExpiration".toLowerCase()];this._navigation.updateViewParams(e,{ignoreHistory:!0,clearOtherParams:!0})}}};a.prototype._openUserExpirationPanel=function(){var t=this;Promise.resolve(new Promise(function(t,n){e(["zX"],t,n)})).then(s.getDefaultExport).then(function(e){new(t.resources.injected(e))({}).execute(null)})};a.dependencies=n.__assign(n.__assign({},o.default.dependencies),{pageContext:r.pageContext,navigation:i.navigation});return a})(o.default);t.UserExpirationUtils=f;t.resourceKey=a.createResolvedResourceKey(e("module").id,f)});
define("qPe",["require","exports","fB"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isUnifiedAppSupportedFile=t.openInOffice=t.unifiedAppEnabled=void 0;function r(e,t){var n=e.appMap?e.appMap.toLowerCase():void 0,r="ms-powerpoint"===n,i="ms-word"===n,s="ms-visio"===n,o="ms-excel"===n;return t&&(r||i||s||o)||!t&&(r||i||s||o)}t.unifiedAppEnabled=r;function i(e){return!!(e&&e.openUrl&&e.appMap)}t.openInOffice=i;t.isUnifiedAppSupportedFile=function(e){return r(e,!0)&&i(e)&&!n.isFeatureEnabled(n.EnablePdfCoversionForAllTypes)}});
define("_c",["require","exports","Lt"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Selection=n.Selection});
define("hc",["require","exports","Lt"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SELECTION_CHANGE=n.SELECTION_CHANGE;t.SelectionDirection=n.SelectionDirection;t.SelectionMode=n.SelectionMode});
define("Die",["require","exports","module"],function(e,t,n){(function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&(function(){try{new Blob;return!0}catch(e){return!1}})(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};l.prototype.append=function(e,t){e=u(e);t=a(t);var n=this.map[e];this.map[e]=n?n+","+t:t};l.prototype.delete=function(e){delete this.map[u(e)]};l.prototype.get=function(e){e=u(e);return this.has(e)?this.map[e]:null};l.prototype.has=function(e){return this.map.hasOwnProperty(u(e))};l.prototype.set=function(e,t){this.map[u(e)]=a(t)};l.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)};l.prototype.keys=function(){var e=[];this.forEach(function(t,n){e.push(n)});return f(e)};l.prototype.values=function(){var e=[];this.forEach(function(t){e.push(t)});return f(e)};l.prototype.entries=function(){var e=[];this.forEach(function(t,n){e.push([n,t])});return f(e)};t.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var s=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};v.call(m.prototype);v.call(b.prototype);b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})};b.error=function(){var e=new b(null,{status:0,statusText:""});e.type="error";return e};var o=[301,302,303,307,308];b.redirect=function(e,t){if(-1===o.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:e}})};e.Headers=l;e.Request=m;e.Response=b;e.fetch=function(e,n){return new Promise(function(r,i){var s=new m(e,n),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:y(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;r(new b(t,e))};o.onerror=function(){i(new TypeError("Network request failed"))};o.ontimeout=function(){i(new TypeError("Network request failed"))};o.open(s.method,s.url,!0);"include"===s.credentials&&(o.withCredentials=!0);"responseType"in o&&t.blob&&(o.responseType="blob");s.headers.forEach(function(e,t){o.setRequestHeader(t,e)});o.send(void 0===s._bodyInit?null:s._bodyInit)})};e.fetch.polyfill=!0}function u(e){"string"!=typeof e&&(e=String(e));if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function a(e){"string"!=typeof e&&(e=String(e));return e}function f(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};t.iterable&&(n[Symbol.iterator]=function(){return n});return n}function l(e){this.map={};e instanceof l?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function c(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise(function(t,n){e.onload=function(){t(e.result)};e.onerror=function(){n(e.error)}})}function p(e){var t=new FileReader,n=h(t);t.readAsArrayBuffer(e);return n}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e));return t.buffer}function v(){this.bodyUsed=!1;this._initBody=function(e){this._bodyInit=e;if(e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e)){this._bodyArrayBuffer=d(e.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))};if(t.blob){this.blob=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))};this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}}this.text=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return(function(e){var t=new FileReader,n=h(t);t.readAsText(e);return n})(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve((function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")})(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)};t.formData&&(this.formData=function(){return this.text().then(g)});this.json=function(){return this.text().then(JSON.parse)};return this}function m(e,t){var n,r,i=(t=t||{}).body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url;this.credentials=e.credentials;t.headers||(this.headers=new l(e.headers));this.method=e.method;this.mode=e.mode;if(!i&&null!=e._bodyInit){i=e._bodyInit;e.bodyUsed=!0}}else this.url=String(e);this.credentials=t.credentials||this.credentials||"omit";!t.headers&&this.headers||(this.headers=new l(t.headers));this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),s.indexOf(r)>-1?r:n);this.mode=t.mode||this.mode||null;this.referrer=null;if(("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function g(e){var t=new FormData;e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}});return t}function y(e){var t=new l;e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}});return t}function b(e,t){t||(t={});this.type="default";this.status="status"in t?t.status:200;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in t?t.statusText:"OK";this.headers=new l(t.headers);this.url=t.url||"";this._initBody(e)}})("undefined"!=typeof self?self:this)});
define('ODBOneDrive_mini_css',["nt","Ew"],function(e){"use strict";e.loadStyles([{"rawString":".od-DragAndDropHint-box{font-size:14px;font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";text-align:center;box-sizing:border-box}.od-DragAndDropHint-file{height:80%;top:50%;transform:translate(-50%,-50%);position:absolute;width:100%}html[dir=ltr] .od-DragAndDropHint-file{left:50%}html[dir=rtl] .od-DragAndDropHint-file{right:50%}.od-DragAndDropHint-fileContainer{width:100%;height:74%;position:relative}.od-DragAndDropHint-robot{height:173px;width:100%;background-repeat:no-repeat;background-position:center center;background-size:auto 100%;margin-top:12px}.od-DragAndDropHint-box--robot{border:2px dashed "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-DragAndDropHint-robot--grid{display:inline-block;margin:0;background-position:-25px;background-size:auto 100%;width:45%;vertical-align:top}.od-DragAndDropHint--grid{height:100%;width:100%;position:relative}.od-DragAndDropHint-box--grid{height:100%;width:54%;display:inline-block;vertical-align:top}.od-DragAndDropHint-text--grid{padding:4px 5px;font-size:15px;overflow:hidden;width:100%;display:inline-block;box-sizing:border-box;text-overflow:ellipsis;height:40%}.od-DragAndDropHint.is-animating{opacity:0}.od-DragAndDropHint-robotAnimation.od-DragAndDropHint-robot--grid{background-size:auto 106%}"}]);});