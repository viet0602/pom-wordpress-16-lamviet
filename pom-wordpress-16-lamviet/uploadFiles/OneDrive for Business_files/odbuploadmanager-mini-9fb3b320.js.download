define("N9e",["require","exports","ww","A","ze","Fz","eS","je","cP","X9e","Ge","$7","De","We","y9","Y9e","_H","W9e","G9e","V9e","q3","bv","Be","j9e","k","ND","A3","B9e","R5"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A="0x0120",O={ODB:788,OneDrive:!0},M={ODB:561,OneDrive:!0},_={ODB:573,OneDrive:!0},D={ODB:1261},P={ODB:1310},H={ODB:1293},B=1,j=2,F=4,I=8,q=16,R=!T.Killswitch.isActivated("6f35d54f-e089-40be-ac52-2550353af7a3","05/28/2020","Update image before creating item"),U=T.Killswitch.isActivated("6BB10EC3-7C91-4E97-8A8D-8B7B920D309A","11/05/2020","Fix focus problem for clientForm when there is a list validation error"),z=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._clientForms=null;r._getAdditionalPostData=function(e){e.isListDataRenderOptionChangeFeatureEnabled=r.isFeatureEnabled(O);e.isSpotlightFeatureEnabled=r.isFeatureEnabled(_);return h.getAdditionalPostData(e)};var i=n.pageContext,s=n.apiUrlHelper,o=n.itemUrlHelper;r._itemUrlHelper=o||new l.ItemUrlHelper({},{pageContext:i});r._apiUrlHelper=s||new p.ApiUrlHelper({},{itemUrlHelper:r._itemUrlHelper,pageContext:i});t.complianceTagProvider?r._complianceTagProvider=t.complianceTagProvider:r._complianceTagProvider=new y.default({pageContext:i});t.fileUploaderProvider?r._fileUploaderProvider=t.fileUploaderProvider:r._fileUploaderProvider=new g.FileUploaderProvider({pageContext:i});r.isFeatureEnabled=t.isFeatureEnabled?t.isFeatureEnabled:function(e){return w.default.isFeatureEnabled(e,r._pageContext&&r._pageContext.ExpFeatures)};return r}Object.defineProperty(t.prototype,"listContext",{set:function(e){this._listContext=e},enumerable:!0,configurable:!0});t.prototype.getClientFormSchema=function(e,t,i){var s=this,o=function(){var r=s._locateClientFormWithContentTypeInfos(e,t);if(i&&r&&r.fields){var o=r.fields.filter(function(e){return!s._isFieldRequireUniqueValue(e)});return n.__assign(n.__assign({},r),{fields:o})}return r};if(null===this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas().then(function(){return o()})}return r.default.wrap(o())};t.prototype.getClientForm=function(e,t,n,s){var o=this;return new r.default(function(r,u){o.getData(function(){var t=i.default.encodeRestUriStringToken(o._listContext.listUrl),n=",cutoffVersion="+(new S.default(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0"),r=j+F+I+q;return o._pageContext.webAbsoluteUrl+"/_api/web/GetList(@v1)/RenderExtendedListFormData(itemId="+e+",formId='editform',mode='2',options="+r+n+")?@v1='"+t+"'"},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData){t=JSON.parse(t.d.RenderExtendedListFormData);n&&n.length>0&&!n[0].contentType&&t.ListData&&t.ListData.ContentType&&(n[0].contentType=t.ListData.ContentType);t.ListDataLite=t.ListData;t.ListData=t.Data;t.Data=void 0;return t}}return null},"GetItemDataForClientForm",function(){return""},"POST",o._getAdditionalHeaders()).then(function(e){r(o._processGetClientFormServerData(e,t,n,s))},function(e){var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1;u({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})})};t.prototype.updatePanelViewInfo=function(e){var t=this;return new r.default(function(n,r){t.getData(function(){var n=i.default.encodeRestUriStringToken(t._listContext.listUrl);return t._pageContext.webAbsoluteUrl+"/_api/web/GetList(@v1)/contentTypes('"+e.contentTypeId+"')/ReorderFields()?@v1='"+n+"'"},function(){return null},"CustomPanelSaveDataToServer",function(){return JSON.stringify({fieldNames:e.data})}).then(function(){n(e.serverResponse({message:{value:"updated Information"}}))},function(t){r(e.serverResponse(t))})})};t.prototype.saveCustomShowHideRules=function(e,t,n){var r=this,i={__metadata:{type:"SP.Field"},ClientValidationFormula:e.rules,ClientValidationMessage:e.errMsg};return this.getData(function(){return r._getListApiUrl(t).segment("Fields").method("GetByInternalNameOrTitle",n).toString()},function(e){return e},"saveCustomValidationRules",function(){return JSON.stringify(i)},"MERGE")};t.prototype._isFieldRequireUniqueValue=function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"===t||"attachments"===t||"Title"===n||"LinkTitle"===n||"LinkTitleNoMenu"===n||"thumbnail"===t};t.prototype._getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e||this._pageContext.listUrl,listUrl:e||this._pageContext.listUrl});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};t.prototype.saveClientFormCustomFormatter=function(e,t){var n=this,r={__metadata:{type:"SP.ContentType"},ClientFormCustomFormatter:JSON.stringify(e.ClientFormCustomFormatterJson)};return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e.ContentTypeId+"')").toString()},function(e){return e},"saveCustomFormFormatterJSON",function(){return JSON.stringify(r)},"MERGE")};t.prototype.getClientFormCustomFormatter=function(e,t){var n=this;return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e+"')").toString()},function(e){var t=JSON.parse(e);console.log(t);return e},"GetCustomFormatter",null,"GET")};t.prototype.getResourceProviders=function(){return{ComplianceTagProvider:this._complianceTagProvider,FileUploaderProvider:this._fileUploaderProvider}};t.prototype._processGetClientFormServerData=function(e,t,r,i){var s=this,o=new m.SPListItemProcessor({listContext:this._listContext,pageContext:this._pageContext}).processData("parent",e),u=o&&o.items&&o.items[0];this._clientForms={};var a=e.ListSchema;if(a){a.New&&this._processClientFormResponse(2,a.New);if(a.Edit){this._processClientFormResponse(1,a.Edit);this._processClientFormResponse(3,a.Edit)}}var f=this._locateClientFormWithContentTypeInfos(t,r);if(i&&f&&f.fields){var l=f.fields.filter(function(e){return!s._isFieldRequireUniqueValue(e)});f=n.__assign(n.__assign({},f),{fields:l})}var c={item:u,formType:f.formType,contentType:f.contentType,contentTypeId:f.contentTypeId,fields:[],isBulkEdit:i,clientFormCustomFormatter:f.clientFormCustomFormatter};this._generateFieldsFromSchema(c,f);for(var h=[],p=0,d=c.fields;p<d.length;p++){if(0===(y=d[p]).state){y.state=2;h.push(y)}}this._handleServerData(c,e,{},h);for(var v=0,g=h;v<g.length;v++){var y;(y=g[v]).state=0}return c};t.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&(this._listContext.enableAttachments||void 0===this._listContext.enableAttachments),r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];("Attachments"!==s.Type||n)&&!(e.isBulkEdit&&s.ReadOnlyField)&&e.fields.push(this._generateField(e,s))}};t.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:0}};t.prototype.updateFormValues=function(e,t){var n=this,s=e.item;if(!s||!s.properties||!s.properties.ID)return r.default.wrap();for(var o=[],u=0,a=e.fields;u<a.length;u++){var f=a[u];if(0===f.state){f.state=2;o.push(f)}}return this.getData(function(){var e=s.properties.ID,t=i.default.encodeRestUriStringToken(n._listContext.listUrl),r=B+j+F+I,o=",cutoffVersion="+(new S.default(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0");return n._pageContext.webAbsoluteUrl+"/_api/web/GetList(@v1)/RenderExtendedListFormData(itemId="+e+",formId='editform',mode='2',options="+r+o+")?@v1='"+t+"'"},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return t=JSON.parse(t.d.RenderExtendedListFormData)}return null},"GetItemDataForClientForm",function(){return""},"POST",this._getAdditionalHeaders(),"",0,!0).then(function(r){n._handleServerData(e,r,t,o);for(var i=0,s=o;i<s.length;i++){s[i].state=0}},function(e){for(var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1,i=0,s=o;i<s.length;i++){s[i].state=0}return r.default.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})};t.prototype.createItem=function(e){var t=this,n=this._getUrlInfo(e.clientForm.item),i=n.listUrl,s=n.itemUrlParts,o="AddValidateUpdateItemUsingPath",u=function(){return t._apiUrlHelper.build().webByItemUrl(s).method("GetList",i).method(o).toString()},a=!!e.clientForm.contentTypeId&&0===e.clientForm.contentTypeId.lastIndexOf(A,0),l=function(t){var n=e.rootFolder||i;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n},UnderlyingObjectType:a?"1":void 0},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})};return this._ensureClientForms().then(function(){return R&&t.isFeatureEnabled(P)&&t._fileUploaderProvider&&t._fileUploaderProvider.imageOperationsPool.length>0?t._updateImages(!0).then(function(n){var i=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});t._fileUploaderProvider.imageOperationsPool=[];if(t.handleFileUploaderErrors(n,null,i)){n&&n.length>0&&n.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n){var r=L.ParseThumbnailString(n.data);if(r){r.serverRelativeUrl=t.image.serverRelativeUrl;r.id=t.image.id;r.serverUrl=t.image.serverUrl}try{n.data=JSON.stringify(r)}catch(e){n.data=""}}}});return t._doCreateItem(u,l,e,o)}return r.default.wrap({status:f.UpdateResultStatus.fail})}):t._doCreateItem(u,l,e,o)})};t.prototype._doCreateItem=function(e,t,n,r){var i=this;return this._createOrUpdateItem("CreateItem",e,t,n,r).then(function(e){return i._postUpdateFields("CreateItem",n,[]).then(function(t){if(e.status===f.UpdateResultStatus.success&&t.status===f.UpdateResultStatus.fail){t.status=f.UpdateResultStatus.partialSuccess;return t}return e})})};t.prototype.updateItem=function(e){var t=this,n=e.clientForm.isBulkEdit&&e.itemdIds&&e.itemdIds.length>1?e.itemdIds:void 0,i=n&&n.length>1,s=function(e){var n=t._getUrlInfo(e),r=n.listUrl,s=n.itemUrlParts;return i?t._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("BulkValidateUpdateListItems").toString():t._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("items",e.properties.ID).method("ValidateUpdateListItem").toString()},o=function(r){var s;i&&(s=t._listContext.folderPath);return JSON.stringify({itemIds:n,formValues:r,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:s})};return this._ensureClientForms().then(function(){return R&&t.isFeatureEnabled(P)&&t._fileUploaderProvider&&t._fileUploaderProvider.imageOperationsPool.length>0?t._updateImages(!1).then(function(u){var a=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});t._fileUploaderProvider.imageOperationsPool=[];if(t.handleFileUploaderErrors(u,null,a)){u&&u.length>0&&u.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n&&n.data!==n.serverData){var r=L.ParseThumbnailString(n.data);if(r){r.serverRelativeUrl=t.image.serverRelativeUrl;r.id=t.image.id;r.serverUrl=t.image.serverUrl}n.data=r?JSON.stringify(r):""}}});return t._doUpdateItem(s,o,e,i,n)}return r.default.wrap({status:f.UpdateResultStatus.fail})}):t._doUpdateItem(s,o,e,i,n)})};t.prototype._doUpdateItem=function(e,t,n,r,i){var s=this;return this._createOrUpdateItem("UpdateItem",e,t,n,r?"BulkValidateUpdateListItems":"ValidateUpdateListItem",i).then(function(e){return s._postUpdateFields("UpdateItem",n,i).then(function(t){if(e.status===f.UpdateResultStatus.success&&t.status===f.UpdateResultStatus.fail){t.status=f.UpdateResultStatus.partialSuccess;return t}return e})})};t.prototype.fetchAllClientFormSchemas=function(){var e=this;this._clientFormsDebouncer||(this._clientFormsDebouncer=new s.default);this._clientFormsDebouncer.isExecuting()||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.getData(function(){return e._getServerConnectionUrl().toString()},function(t){e._clientForms={};var n=JSON.parse(t);n.ContentTypeIdToNameMap&&(e._contentTypeIdToNameMap=n.ContentTypeIdToNameMap);n.ClientFormCustomFormatter&&(e._ctIdToClientFormCustomFormatter=n.ClientFormCustomFormatter);var r=n.ClientForms;if(r){r.New&&e._processClientFormResponse(2,r.New);if(r.Edit){e._processClientFormResponse(1,r.Edit);e._processClientFormResponse(3,r.Edit)}}n.Navigation&&(e._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes});void 0!==n.EnableAttachments&&(e._listContext.enableAttachments=n.EnableAttachments);n.FormRenderModes&&e._processFormRenderMode(n.FormRenderModes);(n.PowerAppFormId||n.AppId)&&(e._powerAppFormId=n.PowerAppFormId||n.AppId);n.AppRenderInfo&&(e._powerAppFormInfo=n.AppRenderInfo||{});n.AppAdditionalData&&(e._powerAppAdditionalData=n.AppAdditionalData);n.CachedFileUrlTemplate&&n.CacheAppFiles&&(e._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},"GetClientForms",function(){var t=T.Killswitch.isActivated("6C84499D-FB49-4D49-8AA4-D01985944D20","07/07/20","do not fetch navigationNodes when getClientForms")&&!e._listContext.leftNavigationData&&e.isFeatureEnabled(M);return e._getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:t})},"POST",this._getAdditionalHeaders())));return this._clientFormsPromise};t.prototype.getFieldFilterData=function(e,t){return new v.ListFilterDataSource({parentKey:void 0,listContext:this._listContext,pageContext:this._pageContext,folderPath:void 0,itemUrlHelper:this._itemUrlHelper,apiUrlHelper:this._apiUrlHelper}).getFilterData(e,"",t,void 0)};t.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t};t.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})};t.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})};t.prototype.getPowerAppFormId=function(){return this._powerAppFormId};t.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo};t.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData};t.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo};t.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='"+e+"'&visualizationTarget=1"},function(e){var t=JSON.parse(e),n="";t.d&&t.d.Value&&(n=JSON.parse(t.d.Value));return n},"GetPowerAppFormDesignUrl",null,"GET")};t.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return c.getListDataUrl({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})};t.prototype._processClientFormResponse=function(e,t){this._clientForms[e]||(this._clientForms[e]={});var n=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!n[r]){var i=this._reverseLookupContentTypeIdByName(r),s=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[i]:void 0;n[r]={contentType:r,contentTypeId:i,formType:e,fields:[],clientFormCustomFormatter:s?JSON.parse(s):void 0,mode:0};for(var o=n[r],u=t[r],a=0,f=u.length;a<f;a++)o.fields.push(u[a])}};t.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null};t.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var r=2;switch(n){case"Edit":r=1;break;case"Display":r=3}var i=0;switch(e[t][n].RenderType){case 1:i=2;break;case 2:i=3;break;case 3:i=4;break;case 4:i=5;break;default:o.Verbose.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[r][t].mode=i}};t.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var r=t[0],i=this._locateClientForm(e,r.contentType,r.contentTypeId);if(1===t.length||!i||!i.fields)return i;for(var s=i.fields.slice(),o=function(n){if(0===s.length)return"break";var r=t[n],i=u._locateClientForm(e,r.contentType,r.contentTypeId);s=s.filter(function(e){for(var t=0,n=i.fields;t<n.length;t++){if(n[t].Name===e.Name)return!0}return!1})},u=this,a=1;a<t.length;a++){if("break"===o(a))break}return n.__assign(n.__assign({},i),{fields:s})};t.prototype._locateClientForm=function(e,t,n){!t&&n&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[n]);if(!t&&this._clientForms[e])for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){t=r;break}if(n&&0===n.lastIndexOf(A,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var i={FileLeafRef:1,Title:1,URL:1};for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){var s=this._clientForms[e][r].fields.filter(function(e){return!!i[e.Name]})[0];if(s){this._clientForms[e].Folder={contentType:"Folder",contentTypeId:n,formType:e,fields:[s],mode:0};return this._clientForms[e].Folder}}}if(!this._clientForms[e]||!this._clientForms[e][t]){if("folder"===t.toLowerCase()&&!n)for(var r in this._clientForms[e])if(this._clientForms[e][r]&&!this._clientForms[e][r].contentTypeId)return this._clientForms[e][r];return null}return this._clientForms[e][t]};t.prototype._getAdditionalHeaders=function(){return c.getListRequestHeaders(this._listContext)};t.prototype._handleServerData=function(e,t,n,r){for(var i=t.ListDataLite?t.ListDataLite:t.ListData,s=t.ListDataLite?t.ListData.Row[0]:t.Data.Row[0],o=e.item,u=0,a=r.length;u<a;u++){var f=r[u],l=f.schema;if(!n||!n.hasOwnProperty(l.Name)){void 0===f.data&&(f.data=null);void 0===f.serverData&&(f.serverData=null);if(i.hasOwnProperty(l.Name)){l.FieldType&&"boolean"===l.FieldType.toLowerCase()&&""===s[l.Name]&&"0"===i[l.Name]?f.serverData="":l.FieldType&&"thumbnail"===l.FieldType.toLowerCase()&&s[l.Name]?f.serverData=s[l.Name]:f.serverData=i[l.Name];o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=s[l.Name])}else if(b.isClientFormComplianceTagField(f)){f.serverData=s[b.COMPLIANCETAG_FIELD_NAME];o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=s[l.Name])}else o.folder&&f.schema.FieldType&&"file"===f.schema.FieldType.toLowerCase()&&f.schema.Title&&"name"===f.schema.Title.toLowerCase()&&i.Title?f.serverData=i.Title:f.serverData=null;e.isBulkEdit&&(f.serverData=null);if(f.schema.AppendOnly){f.appendOnlyData=t[f.schema.Name];f.data=""}else f.data=f.serverData}}o.hasClientFormData=!0};t.prototype._createOrUpdateItem=function(e,t,n,i,s,o){var u=this,a=i.clientForm.fields,l=[],c=[],h={},p=[],v=!1,m=!1;!T.Killswitch.isActivated("9275D398-BC11-4137-9A9C-597DEE2E74F9","03/11/2020","For customList, ensure to also update folder FileLeafRef when user update folder title in client form")&&1===i.clientForm.formType&&i.clientForm.item&&!i.clientForm.isBulkEdit&&this._listContext&&!this._listContext.isDocLib&&i.clientForm.item.properties&&"1"===i.clientForm.item.properties.FSObjType&&(m=!0);this.isFeatureEnabled(H)&&(o?x.logTaggingChanges(i.clientForm,o.length):x.logTaggingChanges(i.clientForm));for(var g=0,y=a;g<y.length;g++){var w=y[g];if(null!==w.data&&void 0!==w.data){var S=w.data;if("thumbnail"===w.schema.FieldType.toLowerCase()&&"string"!=typeof S)try{S=JSON.stringify(S)}catch(e){}if(!this._isClientFormFieldUpdated(i,S,w.serverData)||"attachments"===w.schema.FieldType.toLowerCase()||b.isClientFormComplianceTagField(w)||b.isClientFormComplianceUnlockRecordField(w))h[w.schema.Name]=!0;else{l.push(w);var C=w.schema.Name;if("ContentType"===C){S=this._reverseLookupContentTypeIdByName(S.displayName);C="ContentTypeId";v=!0}c.push({FieldName:C,FieldValue:S,HasException:!1,ErrorMessage:null});"Title"===C&&m&&c.push({FieldName:"FileLeafRef",FieldValue:S,HasException:!1,ErrorMessage:null});E.Engagement.logData({name:"ClientFormUpdate."+w.schema.FieldType.toLowerCase(),extraData:{Host:N.getExtraDataHost()}})}}}if(v){if(!T.Killswitch.isActivated("9678aca9-f8a4-4732-879d-ffbe7e215a33","04/07/2020","for cc model deployed lists, set PrimeCorrectByUser flag as true if ContentType is manually corrected")){4096==(4096&this._listContext.flags2)&&c.push({FieldName:"PrimeCorrectedByUser",FieldValue:"true",HasException:!1,ErrorMessage:null})}}else 2===i.clientForm.formType?c.push({FieldName:"ContentType",FieldValue:i.clientForm.contentType,HasException:!1,ErrorMessage:null}):1===i.clientForm.formType&&i.clientForm.item&&i.clientForm.item.properties&&!i.clientForm.isBulkEdit&&c.push({FieldName:"ContentTypeId",FieldValue:i.clientForm.item.properties.ContentTypeId,HasException:!1,ErrorMessage:null});if(0===l.length&&0===p.length)return r.default.wrap({status:f.UpdateResultStatus.success});p.push(this._getUpdateItemPromise(e,t,n,i,s,l,c,i.clientForm.item,o));return r.default.all(p).then(function(e){for(var t={status:f.UpdateResultStatus.success},n=0,r=e;n<r.length;n++){var i=r[n];if(i&&i.hasOwnProperty("status")){t.status=i.status;i.failedItemIds&&(t.failedItemIds=i.failedItemIds)}break}return t},function(e){e=Array.isArray(e)?e:[e];var t,n;if(!U&&e&&e[0]&&e[0].code){var r=e[0].code.split(", ");if(r&&2===r.length){t=r[0];n=r[1]}}for(var s="-2146232832"===t&&"Microsoft.SharePoint.SPFieldValidationException"===n,o=0;o<l.length;o++){var a=l[o];a.hasException=0===o||!(s&&!U);a.state=0}var f=d.getServerUrl(u._pageContext)+i.clientForm.item.properties.FileRef;throw e=e.filter(function(e){return e&&e.message&&e.message.value}).map(function(e){e.message.value=e.message.value.replace('"'+f+'" ',"");return e})})};t.prototype._getUpdateItemPromise=function(e,t,n,i,s,o,u,a,l){var c=this;return u&&0!==u.length&&o&&0!==o.length?this.getData(t.bind(null,a),function(e){var t=JSON.parse(e);if(!t.d||!t.d[s]||!t.d[s].results){for(var n=0,u=o;n<u.length;n++){(L=u[n]).state=0}return r.default.wrapError("The server response couldn't be processed")}for(var h=null,p={},d="",v=0,m=t.d[s].results;v<m.length;v++){var g=m[v];if(2===i.clientForm.formType&&"Id"===g.FieldName){var y=a;y.properties||(y.properties={});y.properties.ID=g.FieldValue}if(!0===g.HasException||null!==g.ErrorMessage){var b=g.FieldName;p[b]||(p[b]=[]);void 0!==g.ItemId&&p[b].indexOf(g.ItemId)<0&&p[b].push(g.ItemId);if(!h){h={};for(var w=0,E=i.clientForm.fields;w<E.length;w++){var S=E[w];h[S.schema.Name]=S}}if(h[b]){h[b].errorMessage=g.ErrorMessage;h[b].hasException=!0;var x=h[b].schema.Title;d=d?d+", "+x:x}}}var T={status:d?f.UpdateResultStatus.fail:f.UpdateResultStatus.success};if(l&&l.length&&p.null){var N=p.null;N.length<l.length?T.status=f.UpdateResultStatus.partialSuccess:T.status=f.UpdateResultStatus.fail;T.failedItemIds=N}for(var C=0,k=o;C<k.length;C++){var L=k[C];if(d){if(!p[L.schema.Name]&&i.isInteractiveSave){L.errorMessage="Cannot save due to errors in other fields: "+d;L.hasException=!0}}else{L.errorMessage="";L.hasException=!1}L.state=0}c._raiseCreateOrUpdateEvents(i,T);return T},e,function(){return n(u)},"POST",this._getAdditionalHeaders(),void 0,5):r.default.wrap()};t.prototype._getUrlInfo=function(e){var t=e&&this._itemUrlHelper.getItemUrlParts(e.key);return{listUrl:t&&t.serverRelativeListUrl?t.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:t}};t.prototype._isClientFormFieldUpdated=function(e,t,n){return(!e.clientForm.isBulkEdit||""!==t||null!==n)&&!u.deepCompare(t,n)};t.prototype._postUpdateFields=function(e,t,n){var i=t.clientForm.item;if(!this.isValidItem(i))return r.default.wrap({status:f.UpdateResultStatus.fail});for(var s=this._itemUrlHelper.getItemUrlParts(i.key).serverRelativeListUrl,o=n&&n.length>1,u=[],a=null,l=0;l<t.clientForm.fields.length;l++){var c=t.clientForm.fields[l];if(b.isClientFormComplianceTagField(c)){if(c.data===c.serverData)continue;if(o){var h=this._updateMultipleComplianceTagsPromises(n,c,s);if(h)for(var p=0,d=h;p<d.length;p++){var v=d[p];u.push(v)}}else u.push(this._updateComplianceTagField(c,i));E.Engagement.logData({name:"ClientFormUpdate."+c.schema.FieldType.toLowerCase()})}else if(b.isClientFormComplianceUnlockRecordField(c)){if(!this.isFeatureEnabled(D)||c.data===c.serverData)continue;var m=b.isUnlockRecordTurnedOn(i.properties[b.COMPLIANCEFLAGS_NAME]);if(m===("1"===c.data)||o)continue;u.push(this._updateUnlockRecordField(i,c,s,m));E.Engagement.logData({name:"ClientFormUpdate."+c.schema.FieldType.toLowerCase()})}else"attachments"===c.schema.FieldType.toLowerCase()&&(a=c)}n&&0!==n.length||u.push(this._updateAttachmentsField(a,i,e));return r.default.all(u).then(function(e){for(var t,n={status:f.UpdateResultStatus.success},r=0,i=e;r<i.length;r++){var s=i[r];s&&s.status===f.UpdateResultStatus.fail&&(n.status=s.status);s&&s.failedItemIds&&s.failedItemIds.length>0&&(t=n.failedItemIds).push.apply(t,s.failedItemIds)}return n})};t.prototype._updateComplianceTagField=function(e,t){var n,i=e.schema;i.ComplianceTags&&(n=i.ComplianceTags.filter(function(t){return t&&t.tagValue===e.data})[0]);if(n){e.state=1;return this._complianceTagProvider.updateComplianceTag(t,n).then(function(){e.state=0;return{status:f.UpdateResultStatus.success}},function(t){if(t&&e){e.errorMessage=t.message&&t.message.value?t.message.value:t;e.hasException=!0}e.state=0;return{status:f.UpdateResultStatus.fail}})}return r.default.wrap(null)};t.prototype._updateMultipleComplianceTagsPromises=function(e,t,n){var r,i=t.schema,s=[];i.ComplianceTags&&(r=i.ComplianceTags.filter(function(e){return e&&e.tagValue===t.data})[0]);if(!r)return s;t.state=1;for(var o=[],u=0,a=0,l=e.length;a<l;a++){o.push(e[a]);if(++u===b.MAX_ITEM_SIZE||a===e.length-1){s.push(this._complianceTagProvider.updateComplianceTagInBatch(o,r,n).then(function(e){t.state=0;return e&&e.length>0?{status:f.UpdateResultStatus.fail,failedItemIds:e}:{status:f.UpdateResultStatus.success}},function(e){if(e&&t){t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=0;return{status:f.UpdateResultStatus.fail,failedItemIds:o}}));o=[];u=0}}return s};t.prototype._updateUnlockRecordField=function(e,t,n,r){var i="1"===t.data;t.state=1;return i?this._complianceTagProvider.unlockRecord(e,n).then(function(e){t.serverData=e?"1":"0";t.state=0;return{status:f.UpdateResultStatus.success}},function(e){if(e&&t){t.serverData=r?"1":"0";t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=0;return{status:f.UpdateResultStatus.fail}}):this._complianceTagProvider.lockRecord(e,n).then(function(e){t.serverData=e?"1":"0";t.state=0;return{status:f.UpdateResultStatus.success}},function(e){if(e&&t){t.serverData=r?"1":"0";t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=0;return{status:f.UpdateResultStatus.fail}})};t.prototype._updateAttachmentsField=function(e,t,n){var i=this;if(this._fileUploaderProvider&&this._fileUploaderProvider.operationsPool.length>0){this._fileUploaderProvider.operationsPool.some(function(e){return 0===e.fileType})&&(e.state=1);return this._fileUploaderProvider.executeAllOperations(this._fileUploaderProvider.operationsPool,!0,"CreateItem"===n&&t&&t.properties?Number(t.properties.ID):void 0).then(function(t){i._fileUploaderProvider.operationsPool=[];return{status:i.handleFileUploaderErrors(t,e,[])?f.UpdateResultStatus.success:f.UpdateResultStatus.fail}},function(t){i._fileUploaderProvider.operationsPool=[];return{status:i.handleFileUploaderErrors(t,e,[])?f.UpdateResultStatus.success:f.UpdateResultStatus.fail}})}return r.default.wrap(null)};t.prototype.isValidItem=function(e){return e&&e.properties&&e.properties.ID&&"0"!==e.properties.ID};t.prototype.handleFileUploaderErrors=function(e,t,n){var r={attachments:[]},i=!0;e.forEach(function(e){if(!e.result){e.attachment&&r.attachments.push(e.errorMsg);e.image&&(r[e.image.fieldName]=e.errorMsg);i=!1}});if(t){if(r.attachments.length>0){var s=r.attachments.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage=s;t.hasException=!0}t.state=0;E.Engagement.logData({name:"ClientFormUpdate."+t.schema.FieldType.toLowerCase()})}n.forEach(function(e){if(r[e.schema.Name]){e.errorMessage=r[e.schema.Name];e.hasException=!0}e.state=0;E.Engagement.logData({name:"ClientFormUpdate."+e.schema.FieldType.toLowerCase()})});return i};t.prototype._ensureClientForms=function(e){if(this._clientForms&&this._contentTypeIdToNameMap&&!this._listContext.refreshClientForm)return e?r.default.wrap(e()):r.default.wrap();this._listContext.refreshClientForm=void 0;return e?this.fetchAllClientFormSchemas().then(e):this.fetchAllClientFormSchemas().then(function(){return r.default.wrap()})};t.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1};t.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],r=this._clientForms[e][n];return r?r.mode:this._checkRenderModes(4)?4:0};t.prototype._raiseCreateOrUpdateEvents=function(e,t){var n=e.clientForm;if(t&&t.status===f.UpdateResultStatus.success&&n){var r=n.item&&n.item.properties&&n.item.properties.ID?n.item.properties.ID:void 0,i=e.itemdIds&&e.itemdIds.length?e.itemdIds.map(String):r?[r]:void 0;i&&C.default.raise(window,2===n.formType?k.ClientFormEvents.newItemCreated:k.ClientFormEvents.itemUpdated,{itemIds:i})}};t.prototype._updateImages=function(e){return this._fileUploaderProvider&&this._fileUploaderProvider.imageOperationsPool.length>0?this._fileUploaderProvider.executeAllOperations(this._fileUploaderProvider.imageOperationsPool,!0,e?0:void 0):r.default.wrap([])};return t})(a.default);t.default=z});
define("B9e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.newItemCreated="clientFormNewItemCreated";e.itemUpdated="clientFormItemUpdated";return e})();t.ClientFormEvents=n;t.default=n});
define("X9e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.fail=0]="fail";e[e.partialSuccess=1]="partialSuccess";e[e.success=2]="success"})(t.UpdateResultStatus||(t.UpdateResultStatus={}))});
define("K9e",["require","exports","ww","A","eS","cP","V9e","z9e"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this,i=t.apiUrlHelper,s=t.itemUrlHelper;r._apiUrlHelper=i;r._itemUrlHelper=s;return r}t.prototype.getAvailableTagsForSite=function(){var e=this;return this.dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return r.default.wrapError(u.default.GetAvailableTagsForSiteFailed)})};t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length){i.Verbose.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n});return r.default.wrap([])}var s=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this.dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:s,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return r.default.wrapError(e)})};t.prototype.updateComplianceTag=function(e,t){var n=t.blockEdit||t.blockDelete,i=t.blockEdit,s=t.isEventTag,o=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:n,isTagPolicyRecord:i,isEventBasedTag:s,isTagSuperLock:t.superLock});return this.dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,"SetComplianceTag"),qosName:"SetComplianceTag",additionalPostData:o,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return r.default.wrapError(e)})};t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return o.isUnlockRecordTurnedOn(t)}return!1},function(e){return r.default.wrapError(e)})};t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return o.isUnlockRecordTurnedOn(t)}return!1},function(e){return r.default.wrapError(e)})};t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()};t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()};t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:u.default.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:u.default.NoneComplianceTagDescription,tagTooltip:u.default.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:""};t.push(n);for(var r=0,i=e;r<i.length;r++){var s=i[r],a=o.getTagDescription(s),f=o.getTagTooltip(s),l={tagName:s.TagName,tagValue:s.TagName,blockDelete:s.BlockDelete,blockEdit:!!s.BlockEdit,tagDescription:a,tagTooltip:f,hasRetentionAction:s.HasRetentionAction,autoDelete:s.AutoDelete,isEventTag:s.IsEventTag,reviewerEmail:s.ReviewerEmail,notes:s.Notes,displayName:s.DisplayName,superLock:s.SuperLock,tagId:s.TagId};t.push(l)}return t};t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()};t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()};t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()};return t})(s.DataSource);t.default=a});
define("V9e",["require","exports","Oe","z9e"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.COMPLIANCETAG_FIELD_NAME="_ComplianceTag";t.COMPLIANCETAG_FIELD_ID="D4B6480A-4BED-4094-9A52-30181EA38F1D";t.ASSETID_FIELD_NAME="ComplianceAssetId";t.ASSETID_FIELD_ID="3A6B296C-3F50-445C-A13F-9C679EA9DDA3";t.UNLOCKRECORD_FIELD_NAME="RecordUnlocked";t.UNLOCKRECORD_FIELD_ID="96BE7325-AFA4-48CF-8503-9258F0A7817D";t.COMPLIANCEFLAGS_NAME="_ComplianceFlags";t.MAX_ITEM_SIZE=200;t.isUnlockRecordTurnedOn=function(e){return!!(256&e)};t.getRecordLabelHoverText=function(){return r.default.RecordLabelHoverText};t.getPlaceholder=function(){return r.default.ComplianceTagFieldPlaceHolder};t.getTagDescription=function(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?r.default.RetainForeverText:" ";var t=i(e.TagDuration);return e.BlockDelete?n.format(r.default.PreserveTagText,t):e.AutoDelete?n.format(r.default.DeleteTagText,t):" "};t.getTagTooltip=function(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return r.default.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?r.default.PreserveForeverTooltip:r.default.NoRetentionTooltip;var t=i(e.TagDuration),s="",o="";if(e.BlockDelete){s="PreserveTag"+e.TagRetentionBasedOn+"Tooltip";e.BlockEdit&&(o=r.default.PreserveIsRecordTooltipModifier);e.ReviewerEmail?o+=r.default.ReviewTooltip:o+=e.AutoDelete?r.default.PreserveAutoDeleteTooltipModifier:r.default.PreserveNoDeleteTooltipModifier}else e.AutoDelete&&(s="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var u=r.default[s];return u?n.format(u,t)+o:null};function i(e){var t="";if(e>0){var i=Math.floor(e/365);if(i>0){var s=i>1?r.default.RetentionPeriodYears:r.default.RetentionPeriodYear;t=n.format(s,i)}else{var o=Math.floor(e/30);if(o>0){var u=o>1?r.default.RetentionPeriodMonths:r.default.RetentionPeriodMonth;t=n.format(u,o)}else{var a=e>1?r.default.RetentionPeriodDays:r.default.RetentionPeriodDay;t=n.format(a,e)}}}return t}t.getDurationAsString=i;t.isClientFormComplianceUnlockRecordField=function(e){return!!(e&&e.schema&&s(e.schema.FieldType,e.schema.Id))};function s(e,n){return!(!e||"boolean"!==e.toLowerCase()||!n||n.toLowerCase()!==t.UNLOCKRECORD_FIELD_ID.toLowerCase())}t.isComplianceUnlockRecordField=s;t.isClientFormComplianceAssetIdField=function(e){return!!(e&&e.schema&&o(e.schema.FieldType,e.schema.Id))};function o(e,n){return!(!e||"text"!==e.toLowerCase()||!n||n.toLowerCase()!==t.ASSETID_FIELD_ID.toLowerCase())}t.isComplianceAssetIdField=o;t.isClientFormComplianceTagField=function(e){return!!(e&&e.schema&&u(e.schema.FieldType,e.schema.Id))};function u(e,n){return!(!e||"lookup"!==e.toLowerCase()||!n||n.toLowerCase()!==t.COMPLIANCETAG_FIELD_ID.toLowerCase())}t.isComplianceTagField=u});
define("Q9e",["require","exports","ww","A","cP","y9"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this,i=t.apiUrlHelper,s=t.itemUrlHelper;r._itemUrlHelper=s;r._apiUrlHelper=i;return r}t.prototype.getAttachments=function(e,t){var n=this;return this.getData(function(){return n.buildAttachmentBaseUrl(e,t).toString()},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.resultes&&0===t.d.results.length)return[];var r=t.d.results;return n.transformAttachmentData(r)},"Attachments")};t.prototype.addAttachment=function(e,t,n){var i=this;return new r.default(function(r,s){var o=new FileReader;o.onload=function(u){var a=o.result;i.doUploadAttachment(e,t,n.name,a).then(r,s)};o.readAsArrayBuffer(n)},function(){})};t.prototype.deleteAttachment=function(e,t,n,i){var s=this;return new r.default(function(r,o){s.doDeleteAttachment(e,t,n,i||!1).then(r,o)},function(){})};t.prototype.getDataSourceName=function(){return"AttachmentDataSource"};t.prototype.addImage=function(e,t,n,i,s,o){var u=this;return new r.default(function(r,a){var f=new FileReader;f.onload=function(l){var c=f.result;u.doUploadImage(t,i,s,o.name,c,n,e).then(r,a)};f.readAsArrayBuffer(o)},function(){})};t.prototype.buildAttachmentBaseUrl=function(e,t,n){var r=this._itemUrlHelper.getItemUrlParts(t),i=this._apiUrlHelper.build().webByItemUrl(r).method("GetList",r.serverRelativeListUrl).method("Items",e);return i=n?i.method("AttachmentFiles",n):i.segment("AttachmentFiles")};t.prototype.transformAttachmentData=function(e){var t=this;return e.map(function(e){return{type:"attachment",fileName:e.FileName,serverRelativeUrl:s.getServerUrl(t._pageContext)+e.ServerRelativeUrl,uploaded:!0}})};t.prototype.doUploadAttachment=function(e,t,n,r){var i=this;return this.dataRequestor.getData({url:this.buildAttachmentBaseUrl(e,t).methodWithAliases("addUsingPath",{decodedUrl:n}).toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d)return null;var n=[t.d],r=i.transformAttachmentData(n);return r&&1===r.length?r[0]:null},qosName:"UploadAttachment",additionalPostData:r,noRedirect:!0})};t.prototype.doDeleteAttachment=function(e,t,n,r){var i=this;return this.getData(function(){return i.buildAttachmentBaseUrl(e,t,n).segment(r?"DeleteObject":"RecycleObject").toString()},function(e){try{var t=JSON.parse(e);return r&&void 0!==t.d.DeleteObject||!r&&void 0!==t.d.RecycleObject}catch(e){return!1}},r?"DeleteAttachment":"RecycleAttachment")};t.prototype.doUploadImage=function(e,t,n,r,i,s,o){var u=this,a=this._itemUrlHelper.getItemUrlParts(e);return this.dataRequestor.getData({url:this._apiUrlHelper.build().webByItemUrl(a).methodWithAliases("UploadImage",{listTitle:t,imageName:r,listId:s,itemId:o}).toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d.UploadImage)return null;var r=t.d.UploadImage,i=u.transformImageData(r,n);return i||null},qosName:"UploadImage",additionalPostData:i,noRedirect:!0})};t.prototype.transformImageData=function(e,t){return{type:"thumbnail",fileName:e.Name,serverRelativeUrl:e.ServerRelativeUrl,id:e.UniqueId,fieldName:t,serverUrl:s.getServerUrl(this._pageContext)}};return t})(i.DataSource);t.FileUploaderDataSource=o;t.default=o});
define("hH",["require","exports","yH","JS","YS","FS","M","vH","jP","Gk","zP","K","gH","bH","bH","zi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.buildItems=function(e,n,r,i,s){for(var o=[],u=[],a=e.Row,f=a.length,l=0;l<f;l++){var c=t(a[l],u,n,r);c.parent=i;c.parentKey=i.key;s&&s.setItem(c.key,c);o.push(c)}var h=0;if(u.length>0){var p=u[u.length-1];h=p.startIndex+p.count}else{u=void 0;h=f>0?e.LastRow:0}return{items:o,groups:u,totalCount:h}};e.buildRootItem=function(e,t,n,r){var s=(function(e){var t=e;if(0===e.indexOf("id")){var n=c.deserializeQuery(e);t=n.id}return t})(e),o=h.buildItemKey(s,n.listUrl),u={key:o},a=t.ListTitle,l=t.AllowCreateFolder,m=t.EnableMinorVersions,g=t.verEnabled,y=t.AllowGridMode,b=t.DisableGridEditing,w=t.ListTemplateType,E=t.BasePermissions,S=void 0===E?{}:E,x=S.ManageLists,T=void 0===x?void 0:x,N=S.ManagePersonalViews,C=void 0===N?void 0:N,k=S.OpenItems,L=void 0===k?void 0:k,A=t.ListSchema,O=(void 0===A?{}:A).DefaultItemOpen,M=void 0===O?void 0:O,_=t.ExcludeFromOfflineClient,D=t.WebExcludeFromOfflineClient,P=t.ListData,H="string"==typeof M?"0"===M:void 0;if(r){var B=r.getItem(o);B&&(u=B)}u.type=f.default.Folder;u.isRootFolder=s===n.listUrl;p.default(u,{permissions:d.optional(P?i.fromHexString(P.FolderPermissions):void 0)});void 0===u.list&&(u.list={});p.default(u.list,{id:d.optional(t.listName),title:d.optional(a),allowGridMode:"boolean"==typeof y?y:d.backup(!0),allowCreateFolder:d.optional(l),disableGridEditing:"boolean"==typeof b?b:d.backup(!1),enableMinorVersions:d.optional(m),enableVersions:d.optional(g),templateType:d.optional("string"==typeof w?Number(w):void 0),isDocumentLibrary:d.optional("string"==typeof w?v.isDocumentLibrary(w):void 0),isPromotedLinks:d.optional("string"==typeof w?v.isPromotedLinksList(w):void 0),isForceCheckout:d.optional(t.isForceCheckout),isModerated:d.optional(t.isModerated),enableRequestSignOff:d.optional(t.EnableRequestSignOff),newWOPIDocumentEnabled:d.optional(t.NewWOPIDocumentEnabled),newWOPIDocumentTypes:d.optional(t.NewWOPIDocumentTypes),permissions:{manageLists:d.optional(T),managePersonalViews:d.optional(C),openItems:d.optional(L)},openInClient:d.optional(H),excludeFromOfflineClient:d.optional("boolean"==typeof _||"boolean"==typeof D?_||D:void 0),contentTypesEnabled:d.optional(t.ContentTypesEnabled),metadataNavFeatureEnabled:d.optional(t.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:d.optional(t.canUserCreateMicrosoftForm),itemCount:d.optional(t.ListSchema&&t.ListSchema.ItemCount),rowLimit:d.optional(P&&P.RowLimit)});u.isRootFolder&&(u.name=u.displayName=a);r&&r.setItem(o,u);return u};function t(e,t,c,p){if(e){var d={key:h.buildItemKey((function(e){return e.id||e.FileRef||e.ServerRelativeUrl})(e),c.listUrl)};d.id=e.id||e.FileRef;d.itemId=e["name.FileSystemItemId"];var m=e.File_x0020_Type;d.extension=m?"."+m:void 0;d.policyTip=e._ip_UnifiedCompliancePolicyUIAction?Number(e._ip_UnifiedCompliancePolicyUIAction):0;d.type=(function(e,t,n){var r=f.default.File,i=e.File_x0020_Type;if("1"===e.FSObjType){var s=e["File_x0020_Type.mapapp"],o=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];r=s&&"onenote"===s.substring(0,7)||o&&-1!==o.indexOf("onenote")?f.default.OneNote:f.default.Folder}else u.default.isShortcutEnabled()&&u.default.isShortcutFileType(i)?r=f.default.Shortcut:"pdf"===i?r=f.default.Media:(r=a.getItemTypeFromExtension(i))===f.default.Unknown&&v.isGenericList(n.listTemplateType)&&(r=f.default.File);".ai"!==t.extension&&".eps"!==t.extension&&".psd"!==t.extension||(r=f.default.Media);r===f.default.Folder?t.isDocSet="Sharepoint.DocumentSet"===e.ProgId:r===f.default.File&&n&&!n.isDocLib&&(t.listItem={});return r})(e,d,c);d.extension&&(d.iconName=a.getIconNameFromItem(d));d.isRootFolder=e.isRootFolder;var g=n.getItemName(e,d.type,c);g&&(d.displayName=d.name=g);d.dateModifiedValue=e.Modified;d.dateModified=e["Modified.FriendlyDisplay"]?s.getRelativeDateTimeStringForLists(e["Modified.FriendlyDisplay"]):String(e.Modified);d.permissions=e.PermMask?i.fromHexString(e.PermMask):void 0;d.isPlaceholder=!e.PermMask;d.hasMissingMetadata=(function(e,t){if(!t.listSchema)return!1;var n=t.listSchema.filter(function(e){return e.isRequired&&Boolean(e.name)}),r=!1;if(n&&n.length>0)for(var i in n)if(i){var s=n[i];if(!e[s.internalName]){r=!0;break}}return r})(e,c);var y=e["serverurl.progid"];d.openUrl=y?y.substring(1):e.FileRef;-1!==d.openUrl.toLowerCase().indexOf("/wopiframe?")&&(d.openUrl=d.openUrl.replace(/\/_layouts\/WopiFrame.aspx\?/,"/_layouts/15/WopiFrame.aspx?"));d.previewIFrameUrl=e.ServerRedirectedEmbedUrl;d.appMap=e["File_x0020_Type.mapapp"]||e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];d.size=e.File_x0020_Size?Number(e.File_x0020_Size):void 0;d.totalSize=e.SMTotalSize?Number(e.SMTotalSize):void 0;p.blockDownloadsExperienceEnabled&&(d.type===f.default.Media||d.openUrl&&d.appMap)?d.itemStatus=4:p.blockDownloadsExperienceEnabled?d.itemStatus=3:p.viewOnlyExperienceEnabled&&(d.itemStatus=4);if(d.type===f.default.Folder){d.folder={};d.childCount=Number(e.ItemChildCount)+Number(e.FolderChildCount);var b=Number(e.SMTotalFileCount);d.folder.totalCount=b>0?b:d.childCount;d.folder.childCount=d.childCount}d.isDraggable=!0;d.isDropEnabled=d.type===f.default.Folder;d.properties={};for(var w in e)e.hasOwnProperty(w)&&(d.properties[w]=e[w]);var E=e.UniqueId&&o.default.normalizeLower(e.UniqueId);E&&(d.properties.uniqueId=E);var S=d.name;d.extension&&(S=d.name.substring(0,d.name.toLowerCase().lastIndexOf(d.extension.toLowerCase())));d.properties.FileName=S;Number(e.PrincipalCount)>0?d.sharingType=l.default.Shared:void 0===e.PrincipalCount?d.sharingType=l.default.Unknown:d.sharingType=l.default.Private;r.GroupBuilder.buildGroupFromItem(e,t,c);return d}}e.buildItem=t})(t.ListItemBuilder||(t.ListItemBuilder={}))});
define("_H",["require","exports","yH","WS","hH","JS","zi"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e){this._listContext=e.listContext;this._pageContext=e.pageContext;this._itemStore=e.itemStore}e.prototype.processData=function(e,t){n.updateListContext(t,this._listContext);n.updateListContextGroupInfo(this._listContext);var r=t.ListSchema&&"TRUE"===t.ListSchema.Collapse,s=this._processSchema(t.ListSchema),o=t.ListContenTypes,u=t.ListData||t,a=i.ListItemBuilder.buildRootItem(e,t,this._listContext,this._itemStore),f=this._processItems(u,r,a);return{root:a,items:f.items,groups:f.groups,totalCount:f.totalCount,startIndex:this._getStartIndex(u),columns:s,contentTypes:o,nextRequestToken:this._getNextRequestToken(u),isAllGroupsCollapsed:r}};e.prototype._processSchema=function(e){if(e){var t={},n={hasFixedSchema:this._listContext.listTemplateType===o.default.mySiteDocumentLibrary};this._listContext.listSchema=r.buildSchema(e,this._listContext,n,t);Object.keys(t).length&&(this._listContext.groupSchema=t)}return this._listContext.listSchema};e.prototype._processItems=function(e,t,n){var r;(r=t?s.GroupBuilder.buildCollapsedGroups(e.Row,this._listContext):i.ListItemBuilder.buildItems(e,this._listContext,this._pageContext,n,this._itemStore)).groups&&r.groups.length>0&&(this._listContext.lastGroup=r.groups[r.groups.length-1]);return{items:r.items?r.items:[],groups:r.groups,totalCount:r.totalCount}};e.prototype._getStartIndex=function(e){var t=0;this._listContext.group?t=this._listContext.group.startIndex:e.FirstRow&&(t=e.FirstRow-1);return t};e.prototype._getNextRequestToken=function(e){var t="";e.NextHref&&(t=(t=e.NextHref).replace("&View=00000000-0000-0000-0000-000000000000",""));return t};return e})();t.SPListItemProcessor=u});
define("TAe",["require","exports","ww","M","Yb","C","A","k","pb","W","Pc","Bk","UAe","r2","UAe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=262144e3,m="ServerRelativeUrl,UniqueId,Name,VroomItemID,VroomDriveID",g=!u.Killswitch.isActivated("E6826E26-A164-4C90-81FA-EE1CFE515951","10/15/2020","Restrict retries on streaming uploads"),y=(function(){function e(e){var t=e.hasher,n=e.throttler,s=e.dataRequestor,o=e.appName,u=e.webApiUrl,a=e.authToken,l=e.canStream,c=e.fileUpload,h=e.itemExpansion,p=e.destinationUrl,d=e.qosEvent,m=void 0===d?f.Qos:d,g=e.nameConflictBehavior,y=void 0===g?0:g,b=e.onStart,w=e.onAbort,E=e.onProgress;this._hasher=t;this._dataRequestor=s;this._throttler=n;this._chunkNumber=0;this._uploadedBytes=0;this._qosEvent=m;this._id=r.default.generate();this._authToken=a;this._canStream=l;this._webApiUrl=u;this._fileUpload=c;this._async=new i.default(this);this._itemExpansion=h;this._destinationUrl=p;this._nameConflictBehavior=y;this._chunkSize=Math.min(c.size,v);this._trackingHeaders={Application:o,Scenario:"UploadFile",ScenarioType:"AUO"};this._onStart=b;this._onAbort=w;this._onProgress=E}e.prototype.upload=function(){var e=this,t=this._throttler.throttle(function(){var t=e._id,n=e._fileUpload.size,r=e._canStream&&n>25165824,i={fileUploadId:t,size:n},s=new e._qosEvent({name:"Upload.h5",extraData:i}),u=r?"SharePointUploader.stream":"SharePointUploader.create",d=new e._qosEvent({name:u,extraData:i});e._onStart&&e._onStart();return e.start(r).then(function(e){s.end({resultType:f.ResultTypeEnum.Success});d.end({resultType:f.ResultTypeEnum.Success});return e},function(t){var n=o.default.isCanceled(t),r=h.wrapError(t),i=h.convertToUploadError(r);if(n||i.code===p.requestAborted){s.end({resultType:f.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted"});d.end({resultType:f.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted"});e._onAbort&&e._onAbort()}else{var u=h.isErrorTypeExpected(r)?f.ResultTypeEnum.ExpectedFailure:f.ResultTypeEnum.Failure;s.end(a.mergeQosEndSchema(l.getQosEndSchemaFromError(i),{resultType:u,resultCode:c.UploadErrorType[i.errorType]}));d.end(a.mergeQosEndSchema(l.getQosEndSchemaFromError(r),{resultType:u,extraData:{uploadedBytes:e._uploadedBytes}}))}return o.default.reject(i)})});this._uploadPromise=t;return t};e.prototype.abort=function(){var e=this,t=this._uploadPromise;this._uploadPromise=void 0;if(!this._hasCompleted&&t){t.cancel();t.then(function(){},function(){}).done(function(){e._hasher&&e._hasher.dispose();return e.cancelUpload()})}};e.prototype.restart=function(e){var t=e.nameConflictBehavior,n=void 0===t?this._nameConflictBehavior:t;this._nameConflictBehavior=n;var r=this._uploadPromise;this._uploadPromise=void 0;r&&r.cancel();this._hasher&&this._hasher.reset();return this.upload()};e.prototype.dispose=function(){this._async.dispose();this._hasher&&this._hasher.dispose()};e.prototype.start=function(e){var t=this;this._uploadedBytes=0;var n=this._fileUpload.size;return(e?this.streamFile():this.uploadFile()).then(function(e){t.updateProgress(n);return e})};e.prototype.updateProgress=function(e){if(this._uploadedBytes!==e){this._uploadedBytes=e;this._onProgress&&this._onProgress(e)}};e.prototype.getUploadUrl=function(e){var t=this._webApiUrl;t=(t=t.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");var n={};n.DecodedUrl=this._fileUpload.name;n.overwrite=1===this._nameConflictBehavior;n.AutoCheckoutOnInvalidData=!0;e&&(n.XorHash=e);t=t.methodWithAliases("AddUsingPath",n).oDataParameter("$Select",m);this._itemExpansion&&(t=t.oDataParameter("$Expand",this._itemExpansion));return t.toString()};e.prototype.uploadFile=function(e){var t=this;void 0===e&&(e=3);var n=this._fileUpload.slice(0,this._fileUpload.size);return(this._hasher&&!this._hasher.hasFullHash()?this._hasher.computeHash(n,0,n.size):o.default.resolve()).then(function(){var r=t._hasher?t._hasher.getFullHash(n.size):void 0,i=t._hasher?"UploadFileWithChecksum":"UploadFile";return t.uploadChunk({trackSpeed:!1,url:t.getUploadUrl(r),qosName:i,data:n,offset:0,length:n.size}).then(function(e){return t.parseItemResponse(e)}).catch(function(n){if(o.default.isCanceled(n))return o.default.wrapError(n);if(n&&n.retryAfter&&e>0){var r=1e3*n.retryAfter;return t._throttler.addThrottleTimer(r).then(function(){t._uploadedBytes=0;return t.uploadFile(e-1)})}return o.default.wrapError(h.createError(n,d.UploadStage.singleChunk))})})};e.prototype.getStreamingUrl=function(e,t,n,r){var i,s=this._webApiUrl,o=this._fileUpload.name,u={uploadId:{guid:this._requestId}};if(n===d.UploadStage.start){i="StartUpload";s=(s=s.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");s=1===this._nameConflictBehavior?s.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:o}):s.methodWithAliases("AddStubUsingPath",{DecodedUrl:o})}else{if(n===d.UploadStage.finish){i=this._hasher?"FinishUploadWithChecksum":"FinishUpload";s=s.oDataParameter("$Select",m);this._itemExpansion&&(s=s.oDataParameter("$Expand",this._itemExpansion))}else i="ContinueUpload";s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+o});u.fileOffset=e;r&&n===d.UploadStage.finish&&(u.checksum=r)}return(s=s.methodWithAliases(i,u)).toString()};e.prototype.streamFile=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._requestId||(this._requestId=r.default.generate());var i=this._fileUpload.size,u=this._chunkNumber>0?Math.min(this._chunkSize+e,i):0,a=this._fileUpload.slice(e,u),f=0===this._chunkNumber?d.UploadStage.start:i<=u?d.UploadStage.finish:d.UploadStage.continue,l=f===d.UploadStage.start,c=f===d.UploadStage.finish,p="SendFileRequest"+(l?".Start":c?this._hasher?".FinishWithChecksum":".Finish":".Continue"),v=this._hasher&&f!==d.UploadStage.start&&!this._hasher.hasFullHash()&&this._hasher?this._hasher.computeHash(a,e,u):o.default.resolve();return(c?v:o.default.resolve()).then(function(){var r=void 0;n._hasher&&c&&(r=n._hasher.getFullHash(i));return n.uploadChunk({trackSpeed:!0,url:n.getStreamingUrl(e,u,f,r),qosName:p,data:a,offset:e,length:a.size}).then(function(e){n.updateProgress(u);if(u<i){n._chunkNumber++;return v.then(function(){return n.streamFile(u,g?t:void 0)})}return n.parseItemResponse(e)},function(r){if(o.default.isCanceled(r)){f!==d.UploadStage.start&&n.cancelUpload();return o.default.reject(r)}if(h.shouldLowerChunkSize(r)){if(n._chunkSize<=1048576){n.cancelUpload();return o.default.reject(h.createError(r,f))}n._chunkSize=Math.floor(n._chunkSize/2);return n.streamFile(e,t)}if(t>0&&h.canRetry(r,f)){var i,u=new s.default(function(){i&&n._async.clearTimeout(i)});i=n._async.setTimeout(function(){return u.complete()},1e3);return u.getPromise().then(function(){return n.getUploadStatus().then(function(e){return n.streamFile(e,t-1)},function(){return n.streamFile(e,t-1)})})}f!==d.UploadStage.start&&n.cancelUpload();return o.default.reject(h.createError(r,f))})},function(e){f!==d.UploadStage.start&&n.cancelUpload();return o.default.reject(e)})};e.prototype.getUploadStatus=function(){var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileUpload.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:this._requestId}}).toString();return this._dataRequestor.getData({url:e,method:"GET",noRedirect:!0,authToken:this._authToken,qosName:"GetUploadStatus",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},telemetryHandler:function(e){var t=e.eventData,r=e.response;if(t.resultType===f.ResultTypeEnum.Success){if(!r||!r.d||!r.d.ExpectedContentRange)return{eventData:n.__assign(n.__assign({},t),{resultCode:"NoContentRange",resultType:f.ResultTypeEnum.Failure})};var i=parseInt(r.d.ExpectedContentRange.split("-")[0],10);if(isNaN(i))return{eventData:n.__assign(n.__assign({},t),{resultCode:"NaNContentRange",resultType:f.ResultTypeEnum.Failure,error:r.d.ExpectedContentRange})}}return{eventData:t}}}).then(function(e){if(e.d&&e.d.ExpectedContentRange){var t=parseInt(e.d.ExpectedContentRange.split("-")[0],10);return isNaN(t)?o.default.reject(""):t}return o.default.reject("")})};e.prototype.cancelUpload=function(){if(!this._requestId)return o.default.resolve();var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileUpload.name}).methodWithAliases("CancelUpload",{uploadId:{guid:this._requestId}}).toString();this._requestId="";this._chunkNumber=0;return this._dataRequestor.getData({url:e,noRedirect:!0,authToken:this._authToken,qosName:"CancelUploadSession",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id}}).then(function(){})};e.prototype.uploadChunk=function(e){var t,n,r,i,o=this,u=e.url,a=e.qosName,f=e.data,l=e.offset,c=e.length,p=new s.default(function(){t.cancel()}),d=function(e){var t=o._chunkNumber>0&&l+c>=o._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&o._async.clearTimeout(n);e&&(n=o._async.setTimeout(function(){p.error({code:""+h.clientErrorCodes.timeout,message:""})},r))},v=Date.now(),m=Date.now(),g=0,y=0,b=0,w=this._async.debounce(function(e){e>o._uploadedBytes&&o.updateProgress(e)},100,{leading:!1});t=this._dataRequestor.getData({url:u,qosName:a,noRedirect:!0,authToken:this._authToken,additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:f,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();y+=(e.loaded-g)/(t-m);b++;r=e.loaded/(t-v);m=t;g=e.loaded;o._onProgress&&w(l+e.loaded);d(c-e.loaded)}}});d(c);e.trackSpeed&&(i=this._async.setInterval(function(){if(b){Date.now()-v+(c-g)/((y+r)/(b+1))>15e4&&g<c&&p.error({code:""+h.clientErrorCodes.tooSlow,message:""})}},1e4));var E=function(){n&&o._async.clearTimeout(n);i&&o._async.clearInterval(i)};t.done(function(e){p.complete(e)},function(e){p.error(e)});p.getPromise().done(function(){return E()},function(){t.cancel();E()});return p.getPromise()};e.prototype.parseItemResponse=function(e){try{return JSON.parse(e).d}catch(e){}};return e})();t.SharePointUploader=y});
define("Nk",["require","exports","ww","Bk","N"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,n.__assign(n.__assign({},t),{isExpected:o(t.errorType)}))||this;i.message=t.message;i.errorType=t.errorType||r.UploadErrorType.other;i.maxSizeInBytes=t.maxSizeInBytes;i.allowRename=t.allowRename||!1;i.allowMerge=t.allowMerge||!1;i.supportsVersioning=t.supportsVersioning||!1;i.extraData=t.extraData;i.libraryName=t.libraryName;i.isFolder=t.isFolder;i.fixItUrl=t.fixItUrl;return i}return t})(i.ApiError);t.UploadError=s;function o(e){switch(e){case r.UploadErrorType.conflict:case r.UploadErrorType.emptyFileOrFolder:case r.UploadErrorType.emptyFileOrFolderForDocLib:case r.UploadErrorType.fileSize:case r.UploadErrorType.folderUploadNotSupported:case r.UploadErrorType.insufficientVaultQuota:case r.UploadErrorType.invalidName:case r.UploadErrorType.lockMismatch:case r.UploadErrorType.malwareDetected:case r.UploadErrorType.overQuota:case r.UploadErrorType.overQuotaSharedFolder:case r.UploadErrorType.pathTooLong:case r.UploadErrorType.targetFolderMissing:case r.UploadErrorType.throttled:case r.UploadErrorType.unlockRequired:case r.UploadErrorType.versionMismatch:return!0;case r.UploadErrorType.accessDenied:case r.UploadErrorType.itemNotFound:case r.UploadErrorType.disconnected:case r.UploadErrorType.authFailure:case r.UploadErrorType.general:return!1;case r.UploadErrorType.none:case r.UploadErrorType.other:return}}t.default=s});
define("UAe",["require","exports","ww","N","Bk","Nk","r2","FAe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,f="-1",l="-2130575257",c="-2130575142",h="-2130209002",p="-2130209003",d="-2147023080",v="-2130575245";t.clientErrorCodes={unknown:"UNKNOWN_UPLOAD_ERROR",timeout:"UPLOAD_TIMEOUT_ERROR",tooSlow:"UPLOAD_TOO_SLOW_ERROR"};(function(e){e[e.singleChunk=0]="singleChunk";e[e.start=1]="start";e[e.continue=2]="continue";e[e.finish=3]="finish";e[e.status=4]="status";e[e.cancel=5]="cancel"})(a=t.UploadStage||(t.UploadStage={}));var m=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,n.__assign(n.__assign({},t),{extraData:n.__assign(n.__assign({},t.extraData||{}),"number"==typeof t.statusCode?{status:t.statusCode}:{})}))||this;r.errorType=t.errorType;r.displayString=t.displayString;try{r.serverError=JSON.stringify(t.serverError)}catch(e){r.serverError=""}return r}return t})(r.ApiError);t.UploadFragmentError=m;function g(e){if(e&&e.code){return e.code.split(",")[0]||e.code}return e&&e.number?""+e.number:t.clientErrorCodes.unknown}t.shouldLowerChunkSize=function(e){var n=g(e);return n===t.clientErrorCodes.tooSlow||n===t.clientErrorCodes.timeout||!!e&&0===e.status};t.canRetry=function(e,t){if(429===e.status)return!1;if(404===e.status&&(t===a.start||t===a.singleChunk))return!1;switch(g(e)){case o.requestAborted:case f:case l:case c:case h:case p:case d:case v:return!1;default:return!0}};t.createError=function(e,n){if(!e)return new m({errorType:i.UploadErrorType.general,code:"Unknown",statusCode:0,message:"Unknown upload error",serverError:e});var r,s,u=!1,f=g(e);if("string"==typeof e)r=e;else{var c=e.message;if("string"==typeof c)r=c;else if(c&&c.value){r=c.value;u=!0}}var h=e&&e.code||"Unhandled client error";if(f===o.offline){h="Disconnected";s=i.UploadErrorType.disconnected}else s=f===l?i.UploadErrorType.conflict:f===t.clientErrorCodes.timeout?i.UploadErrorType.general:404!==e.status||n!==a.start&&n!==a.singleChunk?u?i.UploadErrorType.other:i.UploadErrorType.general:i.UploadErrorType.targetFolderMissing;return new m({errorType:s,code:f,statusCode:e.status,message:h,correlationId:e.correlationId,displayString:r,serverError:e})};t.wrapError=function(e){return e instanceof m?e:e instanceof u.FileHasherError?new m({errorType:i.UploadErrorType.other,code:"FileHasher",statusCode:0,innerError:e}):new m({errorType:i.UploadErrorType.general,code:"Unknown",statusCode:0,innerError:e})};t.convertToUploadError=function(e){return new s.UploadError({message:e.displayString||e.message||"Unknown fragment error",errorType:e.errorType,innerError:e,supportsVersioning:!0})};t.isErrorTypeExpected=function(e){switch(e.errorType){case i.UploadErrorType.disconnected:case i.UploadErrorType.conflict:case i.UploadErrorType.targetFolderMissing:return!0}switch(e.code){case d:case v:case o.offline:case o.noConnection:case o.requestAborted:case t.clientErrorCodes.timeout:return!0}return!1}});
define("FAe",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){n.__extends(t,e);function t(n){var r=e.call(this,n)||this;r.name="FileHasherError";r.__proto__=t.prototype;return r}return t})(Error);t.FileHasherError=r});
define("R9e",["require","exports","A","Gk","N9e"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){this._buffer=[];this._bufferSize=5;var n,r;if(t&&t.pageContext){this._pageContext=t.pageContext;this._listContext=t.listContext;n=t.apiUrlHelper;r=t.itemUrlHelper}else{this._pageContext=e.pageContext;this._listContext=e.listContext;n=e.apiUrlHelper;r=e.itemUrlHelper}this._defaultValueOverride=e.defaultValueOverride||{};this._clientFormDataSource=new i.default({isFeatureEnabled:e.isFeatureEnabled,fileUploaderProvider:e.fileUploaderProvider,complianceTagProvider:e.complianceTagProvider},{pageContext:this._pageContext,apiUrlHelper:n,itemUrlHelper:r});this._clientFormDataSource.listContext=this._listContext}e.prototype.getClientForm=function(e,t){var i=this;void 0===t&&(t=!1);t&&(this._listContext.refreshClientForm=!0);var s,o,u=e.itemId,a=e.item;if(!u&&a){var f=this._getBufferKeyFromItem(a,e.contentType);s=e.isBulkEdit?void 0:this._getClientFormFromBuffer(f);a.type!==r.default.Folder||e.contentType||(e.contentType="Folder");if(s){if(a.hasClientFormData){s.item=e.item;return n.default.wrap(s)}this._deleteClientFormFromBuffer(f)}}var l=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var c={},h=0,p=e.selection;h<p.length;h++){var d=p[h];if(d){var v=d.properties;if(v){var m=d.type!==r.default.Folder||v.ContentType?v.ContentType:"Folder",g=v.ContentTypeId,y=m+g;if(!c[y]){l.push({contentType:m,contentTypeId:g});c[y]=!0}}}}else l.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return u?this._clientFormDataSource.getClientForm(u,e.clientFormType,l,e.isBulkEdit):this._clientFormDataSource.getClientFormSchema(e.clientFormType,l).then(function(t){if(e.item&&!e.item.properties.ContentTypeId){e.item.properties.ContentTypeId=t.contentTypeId;e.item.properties.ContentType=t.contentType}o={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit};i._generateFieldsFromSchema(o,t);if(2!==e.clientFormType)return i.updateFormValues(o)}).then(function(){i._addClientFormToBuffer(o);return n.default.wrap(o)})};e.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)};e.prototype.updateItem=function(e){e.clientForm.isBulkEdit&&e.itemdIds&&(this._buffer=[]);return this._clientFormDataSource.updateItem(e)};e.prototype.saveCustomShowHideRules=function(e,t,n){return this._clientFormDataSource.saveCustomShowHideRules(e,t,n)};e.prototype.saveClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.saveClientFormCustomFormatter(e,t)};e.prototype.getClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.getClientFormCustomFormatter(e,t)};e.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)};e.prototype.getFieldFilterData=function(e,t){return this._clientFormDataSource.getFieldFilterData(e,t)};e.prototype.getClientFormSchema=function(e,t,n){return this._clientFormDataSource.getClientFormSchema(e,[{contentType:t,contentTypeId:n}])};e.prototype.updatePanelViewInfo=function(e){return this._clientFormDataSource.updatePanelViewInfo(e)};e.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)};e.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},i=0,s=e.selection;i<s.length;i++){var o=s[i];if(o){var u=o.properties;if(u){var a=o.type!==r.default.Folder||u.ContentType?u.ContentType:"Folder",f=u.ContentTypeId,l=a+f;if(!n[l]){t.push({contentType:a,contentTypeId:f});n[l]=!0}}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t};e.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)};e.prototype.getFormRenderMode=function(e,t){return this._clientFormDataSource.getFormRenderMode(e,t)};e.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()};e.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()};e.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()};e.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()};e.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)};e.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()};e.prototype.clearBuffer=function(){this._buffer=[]};e.prototype.updateListContext=function(e){this._listContext=e;this._clientFormDataSource.listContext=e};e.prototype.getResourceProviders=function(){return this._clientFormDataSource.getResourceProviders()};e.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];if(void 0!==this._defaultValueOverride[s.InternalName]){s.DefaultValue=this._defaultValueOverride[s.InternalName];s.DefaultValueFormatted="";s.DefaultValueTyped=""}("Attachments"!==s.Type||n)&&!(e.isBulkEdit&&s.ReadOnlyField)&&e.fields.push(this._generateField(e,s))}};e.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:0}};e.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t};e.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var r=this._buffer[t].key;if(r===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;this._buffer.splice(t,1);this._buffer.unshift({key:r,form:i});return i}}return null};e.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit){var t=e.item;t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}};e.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){if(this._buffer[t].key===e){this._buffer.splice(t,1);break}}};return e})();t.ClientFormProvider=s});
define("G9e",["require","exports","K9e","We","Ge"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){var t=new i.ItemUrlHelper({},{pageContext:e.pageContext}),s=new r.ApiUrlHelper({},{itemUrlHelper:t,pageContext:e.pageContext}),o={pageContext:e.pageContext};this._dataSource=new n.default({apiUrlHelper:s,itemUrlHelper:t},o)}e.prototype.getAvailableTagsForSite=function(){this._cachedTagsPromise||(this._cachedTagsPromise=this._dataSource.getAvailableTagsForSite());return this._cachedTagsPromise};e.prototype.updateComplianceTag=function(e,t){return this._dataSource.updateComplianceTag(e,t)};e.prototype.updateComplianceTagInBatch=function(e,t,n){return this._dataSource.updateComplianceTagInBatch(e,t,n)};e.prototype.unlockRecord=function(e,t){return this._dataSource.unlockRecord(e,t)};e.prototype.lockRecord=function(e,t){return this._dataSource.lockRecord(e,t)};e.prototype.hasComplianceTags=function(){return this.getAvailableTagsForSite().then(function(e){return!!(e&&e.length>1)})};return e})();t.default=s});
define("W9e",["require","exports","A","k","Oe","Q9e","We","Ge","q9e","Nc","M"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=!r.Killswitch.isActivated("c2826c91-84a2-4d32-9c21-95ec3fad2072","06/15/2020","Dedupe operations when attemp to pushing a new operation(support IE)"),h=(function(){function e(e){this.operationsPool=[];this.imageOperationsPool=[];this.listTitle=e.pageContext.listTitle;this.listId=l.default.normalizeLower(e.pageContext.listId,!1);var t=new u.ItemUrlHelper({},{pageContext:e.pageContext}),n=new o.ApiUrlHelper({},{itemUrlHelper:t,pageContext:e.pageContext}),r={pageContext:e.pageContext};this.dataSource=new s.default({apiUrlHelper:n,itemUrlHelper:t},r)}e.prototype.createAddAttachmentOperation=function(e,t,n){var r={type:1,listItemId:e,listItemKey:t,fileType:0,fileName:n.name,file:n};c?this.handleNewOperation(r,this.operationsPool):this.operationsPool.push(r)};e.prototype.createDeleteAttachmentOperation=function(e,t,n){var r={type:0,listItemId:e,listItemKey:t,fileType:0,fileName:n};c?this.handleNewOperation(r,this.operationsPool):this.operationsPool.push(r)};e.prototype.createAddImageOperation=function(e,t,n,r){var i={type:1,listItemId:e,listItemKey:t,fileType:1,fileName:n.name,file:n,fieldName:r};c?this.handleNewOperation(i,this.imageOperationsPool):this.imageOperationsPool.push(i)};e.prototype.createDeleteImageOperation=function(e,t,n,r){var i={type:0,listItemId:e,listItemKey:t,fileType:1,fileName:n,fieldName:r};c?this.handleNewOperation(i,this.imageOperationsPool):this.imageOperationsPool.push(i)};e.prototype.executeAllOperations=function(e,t,r){var i=this;c||t&&this.preprocessOperations();return new n.default(function(t,n){if(e.length>0){var s=e[0],o=e.slice(1),u=void 0;if(1===s.type){void 0!==r&&(s.listItemId=r);u=i.processUpload(s.listItemId,s.listItemKey,s.file,s.fileType,s.fieldName)}else u=i.processDelete(s.listItemId,s.listItemKey,s.fileName,s.fileType,s.fieldName);var a=function(e){i.executeAllOperations(o,!1,r).done(function(n){return t([e].concat(n))},n)};u.done(a,a);f.Engagement.logData({name:"ClientFormUpdate.attachments"})}else t([])})};e.prototype.processUpload=function(e,t,n,r,s){return 1===r?this.dataSource.addImage(e,t,this.listId,this.listTitle,s,n).then(function(e){return{result:!0,attachment:null,image:e,errorMsg:e?null:i.format(a.default.uploadImageGenericError,n.name)+"."}},function(e){var t=i.format(a.default.uploadImageGenericError,n.name);e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=a.default.uploadImageUnsupportedTypeError:e.message&&e.message.value&&(t+=" : "+e.message.value));throw{result:!1,attachment:null,image:{type:"thumbnail",fieldName:s,fileName:n.name,serverUrl:null},errorMsg:t}}):this.dataSource.addAttachment(e,t,n).then(function(e){return{result:!0,attachment:e,errorMsg:e?null:i.format(a.default.uploadErrorAttachment,n.name)+"."}},function(e){throw{result:!1,attachment:{type:"attachment",uploaded:!1,fileName:n.name},errorMsg:i.format(a.default.uploadErrorAttachment,n.name)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})};e.prototype.processDelete=function(e,t,r,s,o){return 1===s?n.default.wrap({result:!0,image:{type:"thumbnail",fieldName:o,fileName:r,serverRelativeUrl:null,serverUrl:null},errorMsg:null}):this.dataSource.deleteAttachment(e,t,r).then(function(e){return{result:e,errorMsg:e?null:i.format(a.default.deleteErrorAttachment,r)+"."}},function(e){throw{result:!1,errorMsg:i.format(a.default.deleteErrorAttachment,r)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})};e.prototype.preprocessOperations=function(){for(var e=this,t=[],n=0;n<this.operationsPool.length;n++){var r=this.operationsPool[n];if(1===r.type)for(var i=n+1;i<this.operationsPool.length;i++){var s=this.operationsPool[i];if(0===s.type&&s.fileType===r.fileType&&s.fileName===r.fileName){t.push(n);t.push(i)}}}t.sort(function(e,t){return t-e}).forEach(function(t){e.operationsPool.splice(t,1)})};e.prototype.handleNewOperation=function(e,t){var n=e.type,r=this.findDuplicateOperation(e,t);1===n?r<0&&t.push(e):r<0?t.push(e):t.splice(r,1)};e.prototype.findDuplicateOperation=function(e,t){var n=e.fileType,r=-1;t.some(function(t,i){if(1===t.type&&t.fileName===e.fileName&&(1!==n||t.fieldName===e.fieldName)){r=i;return!0}});return r};return e})();t.FileUploaderProvider=h});
define("Vye",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.getParent=function(e,t){if(e.level&&e.parentKey&&0!==e.level){return t.filter(function(t){return t.groupingId===e.parentKey})[0]}};e.getFilterDetails=function(n,r){for(var i=n,s=[],o=[];i&&i.fieldSchema;){s.unshift(i.fieldSchema.Name);var u=t(i);o.unshift(u);i=e.getParent(i,r)}return{fields:s,values:o}};function t(e){var t="";switch(e.fieldSchema.Type){case"User":case"Lookup":t=e.name;break;case"DateTime":var n=decodeURIComponent(e.groupString).split(";#"),r=n[0];n.length>0&&(n=n.slice(1,n.length-1))[e.level]&&(r=n[e.level]);t=(function(e){if(!e)return e;var t=e.substring(0,4),n=e.substring(4,6),r=e.substring(6,8);return[t,"-",n,"-",r].join("")})(r);break;default:t=e.fieldValue}return t}})(n||(n={}));t.default=n});
define("j9e",["require","exports","bv","fe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.taxonomyFieldTypeSingle="TaxonomyFieldType";t.taxonomyFieldTypeMulti="TaxonomyFieldTypeMulti";t.bulkEditEngagementName=".BulkEdit.";t.notBulkEditEngagementName=".NotBulkEdit.";t.TERM_DELIMITER=";";t.onChangingTagsEngagementName="OnChangingTags";t.logTaggingChanges=function(e,s){void 0===s&&(s=1);try{for(var o=e.fields.length,u=0;u<o;u++)if(e.fields[u].schema.FieldType===t.taxonomyFieldTypeSingle||e.fields[u].schema.FieldType===t.taxonomyFieldTypeMulti){var a=i(e.fields[u].serverData,e.fields[u].data);if(0===a.addedTagsCount&&0===a.deletedTagsCount)continue;var f=e.fields[u].schema.FieldType.toLowerCase();e.isBulkEdit||s>1?f+=t.bulkEditEngagementName:f+=t.notBulkEditEngagementName;f+=t.onChangingTagsEngagementName;for(var l=0;l<s;l++)n.Engagement.logData({name:f,isIntentional:!0,extraData:{deletedTagsCount:a.deletedTagsCount,addedTagsCount:a.addedTagsCount}})}}catch(e){r.default.logError(e,{eventName:t.onChangingTagsEngagementName});return}};function i(e,t){var n=s(e),r=s(t),i=0,o=Object.keys(n).length,u=Object.keys(r).length;if(o>0&&u>0)for(var a in n)r[a]&&i++;return{deletedTagsCount:o-i,addedTagsCount:u-i}}t.getModifiedTagsCount=i;function s(e){if(!e)return{};for(var n={},r=0,i=e.split(t.TERM_DELIMITER);r<i.length;r++){n[i[r]]=!0}delete n[""];return n}t.separateTags=s});
define("aQ",["require","exports","ww","nM"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("EY",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.performanceNow=window.performance?function(){return window.performance.now()}:function(){return Date.now()};var n=(function(){function e(e,t){this._performanceNow=t.performanceNow;this._startTime=this._performanceNow();this._expirationTime=this._startTime+e.timeout;this._totalBytes=e.totalBytes;this._progressPoints=0}e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this._getRateRatio(e);return void 0===t||t<=1};e.prototype.didActivityHaveExtraCapacity=function(){return this._getRateRatio(this._totalBytes)<=.5};e.prototype._getRateRatio=function(e){this._progressPoints++;var t,n=this._performanceNow(),r=n-this._startTime,i=this._expirationTime-n,s=this._totalBytes-e;(this._progressPoints>=4&&r>=4e3||this._progressPoints>0&&0===s)&&i>0&&(t=s/i/(e/r));return t};return e})();t.ActivityBandwidthVerifier=n});
define("IAe",["require","exports","ww","MY","kY","AY","EY"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t)});
define("kY",["require","exports","ww","C"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.createSession=function(e){var t=e.qosData,r=e.itemUrl,i=e.headers,o=e.allowCookies,u=e.accessToken,a=e.fileName,f=e.fileSize,l=e.lastModifiedDate,c=e.eTag,h=e.conflictBehavior,p=e.ignoreCookieAuth,d={item:n.__assign(n.__assign({},s(r)?{"@microsoft.graph.conflictBehavior":h}:{"@name.conflictBehavior":h}),l?{fileSystemInfo:{lastModifiedDateTime:l.toISOString()}}:{})},v=n.__assign(n.__assign(n.__assign(n.__assign({},c?{"If-Match":c}:{}),p?{IgnoreCookieAuthentication:"t"}:{}),{Prefer:"synchronousmetadata"}),i);return this._dataRequestor.send({path:r+"/"+encodeURIComponent(a)+":/"+(s(r)?"createUploadSession":"oneDrive.createUploadSession"),requestType:"POST",apiName:"CreateSession",headers:v,allowCookies:o,accessToken:u,useAuthorizationHeaders:!0,postData:JSON.stringify(d),qosExtraData:n.__assign({conflictBehavior:h,fileSize:f},t)})};e.prototype.cancelSession=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"DELETE",apiName:"CancelSession",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.uploadFragment=function(e){var t=e.qosData,i=e.headers,s=e.sessionUrl,o=e.startByte,u=e.endByte,a=e.fileSize,f=e.content,l=e.timeout,c=e.onProgress,h=e.select,p=n.__assign({"Content-Range":"bytes "+o+"-"+Math.max(u-1,o)+"/"+a},i),d=!0,v=this._dataRequestor.send({path:s+(h?(s.indexOf("?")>-1?"&":"?")+"$select="+h:""),needsAuthorization:!1,requestType:"PUT",apiName:"UploadFragment",headers:p,postData:f,timeout:l,hasContentType:!1,onUploadProgress:function(e){e.lengthComputable&&d&&c(o+e.loaded)},qosExtraData:n.__assign(n.__assign({},t),{startByte:o,endByte:u,fileSize:a})}),m=new r.default(function(){d=!1;v.cancel()});v.done(function(e){d=!1;m.complete(e)},function(e){d=!1;m.error(e)});return m.getPromise()};e.prototype.commit=function(e){var t=e.qosData,r=e.itemUrl,i=e.accessToken,o=e.fileName,u=(e.description,e.eTag),a=e.conflictBehavior,f=e.sessionUrl,l={"If-Match":u},c=s(r)?{"@microsoft.graph.conflictBehavior":a,"@microsoft.graph.sourceUrl":f}:{"@name.conflictBehavior":a,"@content.sourceUrl":f};return this._dataRequestor.send({path:r+"/"+encodeURIComponent(o),requestType:"PUT",apiName:"CommitSession",headers:l,accessToken:i,useAuthorizationHeaders:!0,postData:JSON.stringify(c),qosExtraData:n.__assign({conflictBehavior:a},t)})};e.prototype.getStatus=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"GET",apiName:"GetStatus",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.getItem=function(e){var t=e.qosData,r=e.itemUrl,i=e.accessToken,s=e.fileName;return this._dataRequestor.send({requestType:"GET",apiName:"GetItem",path:r+"/"+encodeURIComponent(s),useAuthorizationHeaders:!0,accessToken:i,qosExtraData:n.__assign({},t)})};return e})();t.UploadService=i;function s(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}});
define("AY",["require","exports","ww","nM","W","A","C"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=62914560,a=Math.pow(2,.25),f=(function(){function e(e,t){this._uploadService=t.uploadService;this._activityBandwidthVerifierType=t.activityBandwidthVerifierType;var n=t.useCommitForUpload,r=void 0!==n&&n,i=t.checkForCompletedUploadOnSessionTermination,s=void 0===i||i,o=t.shouldCancelOnCompleteFailure,a=void 0===o||o,f=t.maximumFragmentSize,l=void 0===f?u:f;this._shouldCancelOnCompleteFailure=a;this._useCommitForUpload=r;this._checkForCompletedUploadOnSessionTermination=s;this._maximumFragmentSize=l}e.prototype.advanceState=function(e,t){var n=this,r=t.sessionUrl,i=t.nextExpectedRanges;return(r?i?this._uploadItemState(e,t):this._getStatusState(e,t):this._createSessionState(e,t)).then(function(t){return t.error?n._handleGeneralErrorState(e,t):n._getState(t,{waitDuration:void 0,attemptsRemaining:void 0})})};e.prototype._createSessionState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.createSession",extraData:o});return this._uploadService.createSession({qosData:o,itemUrl:e.itemUrl,headers:e.headers,allowCookies:e.allowCookies,accessToken:e.accessToken,fileName:e.fileName,fileSize:e.content.size,eTag:e.eTag,lastModifiedDate:e.lastModifiedDate,conflictBehavior:t.conflictBehavior,ignoreCookieAuth:e.ignoreCookieAuth}).then(function(e){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})},function(a){return s._handleCreateSessionErrorState(e,s._getState(t,{error:a})).then(function(e){e.error?u.end({resultType:i.ResultTypeEnum.Failure,error:a.message,resultCode:r.getResultCodeFromError(a),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(a))}):u.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return e})})};e.prototype._handleCreateSessionErrorState=function(e,t){var n=this;return this._handleErrorState(t,function(r,i){switch(r){case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(i,e,t)}})};e.prototype._getStatusState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.getStatus",extraData:o});return this._uploadService.getStatus({qosData:o,sessionUrl:t.sessionUrl}).then(function(e){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{nextExpectedRanges:e.nextExpectedRanges})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{error:e})})};e.prototype._uploadItemState=function(e,t){var s=this,o=e.qosData,u=e.content.size,a=this._getNextRange({fileSize:u,nextExpectedRanges:t.nextExpectedRanges}),f=new i.Qos({name:"VroomUploader.uploadItem",extraData:e.qosData});return(a&&a.start<u?t.allowStreaming?this._uploadStreamState({nextRange:a},e,t):this._uploadFragmentState({nextRange:a},e,t):this._useCommitForUpload?this._commitState(e,t):this._shouldCancelOnCompleteFailure?this._cancelSessionState(e,t):this._terminateUploadOnCompleteFailure(t)).then(function(t){if(t.error)return s._handleUploadItemErrorState(e,t).then(function(e){var t=e.error;t?f.end({resultType:i.ResultTypeEnum.Failure,error:t.message,resultCode:r.getResultCodeFromError(t),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(t))}):f.end({resultType:i.ResultTypeEnum.Success});return e});f.end({resultType:i.ResultTypeEnum.Success});return t})};e.prototype._terminateUploadOnCompleteFailure=function(e){return s.default.resolve(this._getState(e,{error:new Error("The upload session is still open but there are no more bytes to upload.")}))};e.prototype._uploadFragmentState=function(e,t,s){var u=this,f=e.nextRange,l=t.onProgress,c=t.headers,h=t.content,p=t.content.size,d=t.qosData,v=t.select,m=s.sessionUrl,g=s.speed,y=void 0===g?1/8:g,b=f.start,w=f.end;l&&l(b);var E,S,x=this._getFragmentSize(y),T=Math.min(b+x,w),N=new o.default(function(){E&&E.cancel()}),C=y>1/1920?6e4:3e5,k=new this._activityBandwidthVerifierType({timeout:C,totalBytes:T-b}),L=new i.Qos({name:"VroomUploader.uploadFragment",extraData:n.__assign(n.__assign({},d),{startByte:b,endByte:T,fileSize:p,speed:y,fragmentSize:x})});(E=this._uploadService.uploadFragment({qosData:d,headers:c,sessionUrl:m,startByte:b,endByte:T,fileSize:p,content:h.slice(b,T),timeout:C,select:v,onProgress:function(e){S=e;if(y>1/1920&&!k.doesActivityHaveRemainingCapacity(e-b)){L.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted",extraData:n.__assign(n.__assign({},d),{lastByte:e})});N.complete(u._getState(s,{speed:Math.max(.5*y,1/1920),nextExpectedRanges:void 0}));E&&E.cancel()}l&&l(e)}}).then(function(e){l&&l(T);L.end({resultType:i.ResultTypeEnum.Success});return s=u._isItem(e)?u._getState(s,{item:e}):u._getState(s,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(k.didActivityHaveExtraCapacity()?y*a:y,1)})},function(e){L.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign(n.__assign({},d),r.getQosExtraDataFromError(e)),{lastByte:S})});return u._getState(s,{error:e})})).done(function(e){N.complete(e)});return N.getPromise()};e.prototype._uploadStreamState=function(e,t,s){var u=this,a=e.nextRange,f=t.headers,l=t.onProgress,c=t.content,h=t.content.size,p=t.qosData,d=s.sessionUrl,v=a.start,m=a.end,g=Math.min(m-v,this._maximumFragmentSize),y=v+g;l&&l(v);var b,w=new o.default(function(){b&&b.cancel()}),E=new i.Qos({name:"VroomUploader.uploadStream",extraData:n.__assign(n.__assign({},p),{startByte:v,endByte:y,fileSize:h,fragmentSize:g})});(b=this._uploadService.uploadFragment({qosData:p,headers:f,sessionUrl:d,startByte:v,endByte:y,fileSize:h,content:c.slice(v,y),timeout:864e5,onProgress:function(e){l&&l(e)}}).then(function(e){l&&l(y);E.end({resultType:i.ResultTypeEnum.Success});return s=u._isItem(e)?u._getState(s,{item:e}):u._getState(s,{nextExpectedRanges:e.nextExpectedRanges})},function(e){E.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign(n.__assign({},p),r.getQosExtraDataFromError(e)),{lastByte:void 0})});return u._handleUploadStreamErrorState({nextRange:a},t,u._getState(s,{error:e}))})).done(function(e){w.complete(e)});return w.getPromise()};e.prototype._handleUploadStreamErrorState=function(e,t,n){var r=this,i=e.nextRange;return this._handleErrorState(n,function(e){switch(e){case 0:return r._wait({duration:1e3},t).then(function(){return r._getStatusState(t,n).then(function(e){return r._getNextRange({fileSize:t.content.size,nextExpectedRanges:e.nextExpectedRanges}).start>i.start?e:r._getState(n,{allowStreaming:!1})})})}})};e.prototype._commitState=function(e,t){var s=this,o=e.qosData,u=e.onProgress;u&&u(e.content.size);var a=new i.Qos({name:"VroomUploader.commit",extraData:o});return this._uploadService.commit({qosData:o,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,sessionUrl:t.sessionUrl,conflictBehavior:t.conflictBehavior}).then(function(e){a.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{item:e})},function(e){return s._handleCommitErrorState(s._getState(t,{error:e})).then(function(t){a.end({resultType:t.error?i.ResultTypeEnum.Failure:i.ResultTypeEnum.ExpectedFailure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return t})})};e.prototype._handleCommitErrorState=function(e){var t=this;return this._handleErrorState(e,function(n){switch(n){case"uploadSessionFailed":case"uploadSessionNotFound":case 410:return s.default.resolve(t._getState(e,{error:void 0,sessionUrl:void 0}))}})};e.prototype._cancelSessionState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.cancelSession",extraData:o});return this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:t.sessionUrl}).then(function(){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{sessionUrl:void 0})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{sessionUrl:void 0})})};e.prototype._handleUploadItemErrorState=function(e,t){var n=this,r=t.speed,i=void 0===r?1:r;t=this._getState(t,{nextExpectedRanges:void 0});return this._handleErrorState(t,function(r,o){switch(r){case 0:return window.navigator.onLine?t.allowStreaming?s.default.resolve(n._getState(t,{allowStreaming:!1})):s.default.resolve(n._getState(t,{speed:Math.max(i*(1/8),1/1920)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case 404:return s.default.resolve(n._getState(t,{error:void 0,sessionUrl:void 0}));case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(o,e,t);case"invalidRange":case 416:return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0})})}})};e.prototype._getItemIfCompletedState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.getItemIfCompleted",extraData:o});return this._uploadService.getItem({qosData:o,fileName:e.fileName,itemUrl:e.itemUrl,accessToken:e.accessToken}).then(function(n){u.end({resultType:i.ResultTypeEnum.Success});return e.lastModifiedDate&&n.fileSystemInfo&&n.fileSystemInfo.lastModifiedDateTime===e.lastModifiedDate.toISOString()&&n.size===e.content.size&&"rename"!==t.conflictBehavior?s._getState(t,{item:n,error:void 0}):s._getState(t,{error:new Error("The upload session has terminated but the existing item does not match the input.")})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{error:e})})};e.prototype._handleGeneralErrorState=function(e,t){var n=this,r=t.waitDuration,i=void 0===r?500:r,s=t.attemptsRemaining,o=void 0===s?10:s;return this._handleErrorState(t,function(r){switch(r){case"uploadSessionNotFound":return n._checkForCompletedUploadOnSessionTermination?n._getItemIfCompletedState(e,t):void 0;case"authFailure":case"unauthenticated":case 401:case"lockMismatch":case 423:case 501:case"quotaLimitReached":case 507:return}if("number"==typeof r){if(r>=400&&r<500)return;if(0===r||r>=500&&r<600)return n._wait({duration:i,allowWakeWhenOnline:!0},e).then(function(){return n._getState(t,{error:void 0,waitDuration:Math.min(2*i,3e4),attemptsRemaining:void 0})});if(!o)return;return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0,waitDuration:void 0,attemptsRemaining:Math.max(o-1,0)})})}})};e.prototype._handleErrorState=function(e,t){var n=e.error,i=r.getErrorResolution(n,t);void 0===i&&(i=s.default.resolve(e));return i};e.prototype._promptForConflictBehaviorState=function(e,t,o){var u=this,a=t.onPromptForConfictBehavior,f=t.qosData,l=new i.Qos({name:"VroomUploader.promptForConflictBehavior",extraData:f});return s.default.resolve().then(function(){return a(e)}).then(function(e){l.end({resultType:i.ResultTypeEnum.Success,extraData:f});return u._getState(o,{error:void 0,conflictBehavior:e})},function(t){l.end({resultType:i.ResultTypeEnum.Failure,error:t.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},f),r.getQosExtraDataFromError(t))});return u._getState(o,{error:t})})};e.prototype._wait=function(e,t){var n=e.duration,o=e.allowWakeWhenOnline,u=t.onWait,a=t.qosData,f=new i.Qos({name:"VroomUploader.wait",extraData:a});return s.default.resolve(u({duration:n,allowWakeWhenOnline:o})).then(function(){f.end({resultType:i.ResultTypeEnum.Success})},function(e){f.end({resultType:s.default.isCanceled(e)?i.ResultTypeEnum.Success:i.ResultTypeEnum.Failure,error:e&&e.message,resultCode:r.getResultCodeFromError(e)});return s.default.reject(e)})};e.prototype._getState=function(e,t){return n.__assign(n.__assign({},e),t)};e.prototype._getNextRange=function(e){var t=e.fileSize,n=e.nextExpectedRanges;return(void 0===n?[]:n).reduce(function(e,n){var r,i=n.split("-",2),s=i[0],o=i[1],u=parseInt(s,10);if(!e||u<e.start&&u<t){r={start:u,end:""===o?t:Math.min(parseInt(o,10)+1,t)}}else r=e;return r},void 0)};e.prototype._isItem=function(e){return!!e.id};e.prototype._getFragmentSize=function(e){var t,n=e*u;t=n>327680?n-n%327680:n-n%32768;return Math.min(Math.max(t,32768),this._maximumFragmentSize)};return e})();t.UploadStateMachine=f});
define("MY",["require","exports","ww","A","nM","W","Jy"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){var n=t.uploadService,r=t.uploadStateMachine,i=t.useStreamingUpload,s=void 0!==i&&i;this._uploadService=n;this._uploadStateMachine=r;this._useStreamingUpload=s}e.prototype.upload=function(e){var t=e.conflictBehavior,u=n.__rest(e,["conflictBehavior"]),a=u.qosData,f=u.fileName,l=new s.Qos({name:"VroomUploader.upload",extraData:n.__assign(n.__assign({},a),{extension:o.getFileExtension(f,!0)})});return this._uploadState(u,{conflictBehavior:t,allowStreaming:this._useStreamingUpload}).then(function(e){l.end({resultType:s.ResultTypeEnum.Success});return e},function(e){l.end({resultType:r.default.isCanceled(e)?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,error:e.message,resultCode:i.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},a),i.getQosExtraDataFromError(e))});return r.default.reject(e)})};e.prototype._uploadState=function(e,t){var n=this,i=t.sessionUrl,s=t.item,o=t.error;if(s)return r.default.resolve(s);if(o){var u=void 0;i&&(u=this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:i}).then(function(){},function(){}));return r.default.resolve(u).then(function(){return r.default.reject(o)})}return this._uploadStateMachine.advanceState(e,t).then(function(t){return n._uploadState(e,t)})};return e})();t.Uploader=u;t.default=u});
define("xAe",["require","exports","he","W","_e"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=i.ResultTypeEnum;t.Upload=n.createPairedEvent({eventName:"Upload,Qos,",shortEventName:"Upload"},{dragAndDrop:3,size:2,extension:1,folderUpload:3,groupFolder:3},r.Qos);t.default=t.Upload});
define("NAe",["require","exports","C","A"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.unknown=0]="unknown";e[e.file=1]="file";e[e.directory=2]="directory"})(t.EntryType||(t.EntryType={}));function i(e){return{name:e.name,type:2,getEntries:function(){return r.default.resolve({entries:o(e)})}}}function s(e){return e.type?{name:e.name,type:1,getFile:function(){return r.default.resolve(e)}}:{name:e.name,type:0,getFile:function(){return r.default.resolve(e)}}}function o(e){var t=[];for(var n in e.directories)n&&t.push(i(e.directories[n]));for(var r=0,o=e.files;r<o.length;r++){var u=o[r];t.push(s(u))}return t}t.buildEntriesFromFileList=function(e){for(var t={name:"",directories:{},files:[]},n=0,r=e;n<r.length;n++){for(var i=r[n],s=i.webkitRelativePath,u=t,a=0,f=(void 0===s?i.name:s).split("/").slice(0,-1);a<f.length;a++){var l=f[a];u=u.directories[l]||(u.directories[l]={name:l,directories:{},files:[]})}u.files.push(i)}return o(t)};function u(e){return(function(e){var t=new n.default;e.readEntries(function(e){return t.complete(e)},function(e){return t.error(e)});return t.getPromise()})(e).then(function(t){return t.length?{entries:t.map(a),getEntries:function(){return u(e)}}:{entries:[]}})}function a(e){var t;e.isDirectory?t={name:e.name,type:2,getEntries:function(){return u(e.createReader())}}:e.isFile&&(t={name:e.name,type:1,getFile:function(){return(function(e){var t=new n.default;e.file(function(e){t.complete(e)},function(e){t.error(e)});return t.getPromise()})(e)}});return t}t.buildEntriesFromEntryList=function(e){return e.map(a)}});
define("CAe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Html5="h5"});
define("jAe",["require","exports","jP","Jy"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=0,s=(function(){function e(e,t){var s=e.file;this._file=s;this.eTag=s.eTag;var o,u=s.fileName||s.name,a=r.splitFileName(u),f=a.name,l=a.extension;this.extension=l;this.iconName=n.getIconNameFromExtension(l);this.size=s.size;if(t.platformDetection.isIOS&&"image"===f&&"photo"===this.iconName){var c=s.lastModifiedDate,h=void 0===c?new Date:c;o="IMG_"+this._getLastModifiedISO8601(h)+"_"+ ++i+l}else o=u;s.lastModifiedDate&&(this.lastModifiedDate=s.lastModifiedDate);this.name=o}e.prototype.slice=function(e,t){var n=this._file;return(n.slice||n.mozSlice||n.webkitSlice).call(n,e,t)};e.prototype._getLastModifiedISO8601=function(e){return e.getUTCFullYear()+"-"+o(e.getUTCMonth()+1,2)+"-"+o(e.getUTCDate(),2)+" "+o(e.getUTCHours(),2)+"-"+o(e.getUTCMinutes(),2)+"-"+o(e.getSeconds(),2)};return e})();t.Html5FileUpload=s;function o(e,t){for(var n=""+e;n.length<t;)n="0"+n;return n}t.default=s});
define("PAe",["require","exports","module"],function(e,t,n){!(function(e){var t,n="undefined",r=n!==typeof Buffer&&Buffer,i=n!==typeof Uint8Array&&Uint8Array,s=n!==typeof ArrayBuffer&&ArrayBuffer,o=[0,0,0,0,0,0,0,0],u=Array.isArray||function(e){return!!e&&"[object Array]"==Object.prototype.toString.call(e)},a=4294967296,f=16777216;l("Uint64BE",!0,!0);l("Int64BE",!0,!1);l("Uint64LE",!1,!0);l("Int64LE",!1,!1);function l(u,l,E){var S=l?0:4,x=l?4:0,T=l?0:3,N=l?1:2,C=l?2:1,k=l?3:0,L=l?g:b,A=l?y:w,O=D.prototype,M="is"+u,_="_"+M;O.buffer=void 0;O.offset=0;O[_]=!0;O.toNumber=P;O.toString=function(e){var t=this.buffer,n=this.offset,r=B(t,n+S),i=B(t,n+x),s="",o=!E&&2147483648&r;if(o){r=~r;i=a-i}e=e||10;for(;;){var u=r%e*a+i;r=Math.floor(r/e);i=Math.floor(u/e);s=(u%e).toString(e)+s;if(!r&&!i)break}o&&(s="-"+s);return s};O.toJSON=P;O.toArray=c;r&&(O.toBuffer=h);i&&(O.toArrayBuffer=p);D[M]=function(e){return!(!e||!e[_])};e[u]=D;return D;function D(e,r,u,f){return this instanceof D?(function(e,r,u,f,l){if(i&&s){r instanceof s&&(r=new i(r));f instanceof s&&(f=new i(f))}if(!(r||u||f||t)){e.buffer=m(o,0);return}if(!d(r,u)){l=u;f=r;u=0;r=new(t||Array)(8)}e.buffer=r;e.offset=u|=0;if(n===typeof f)return;if("string"==typeof f)(function(e,t,n,r){var i=0,s=n.length,o=0,u=0;"-"===n[0]&&i++;var f=i;for(;i<s;){var l=parseInt(n[i++],r);if(!(l>=0))break;u=u*r+l;o=o*r+Math.floor(u/a);u%=a}if(f){o=~o;u?u=a-u:o++}H(e,t+S,o);H(e,t+x,u)})(r,u,f,l||10);else if(d(f,l))v(r,u,f,l);else if("number"==typeof l){H(r,u+S,f);H(r,u+x,l)}else f>0?L(r,u,f):f<0?A(r,u,f):v(r,u,o,0)})(this,e,r,u,f):new D(e,r,u,f)}function P(){var e=this.buffer,t=this.offset,n=B(e,t+S),r=B(e,t+x);E||(n|=0);return n?n*a+r:r}function H(e,t,n){e[t+k]=255&n;n>>=8;e[t+C]=255&n;n>>=8;e[t+N]=255&n;n>>=8;e[t+T]=255&n}function B(e,t){return e[t+T]*f+(e[t+N]<<16)+(e[t+C]<<8)+e[t+k]}}function c(e){var n=this.buffer,r=this.offset;t=null;return!1!==e&&u(n)?8===n.length?n:n.slice(r,r+8):m(n,r)}function h(e){var n=this.buffer,i=this.offset;t=r;return!1!==e&&r.isBuffer(n)?8===n.length?n:n.slice(i,i+8):r.from(p.call(this,e))}function p(e){var n=this.buffer,r=this.offset,o=n.buffer;t=i;if(!1!==e&&!n.offset&&o instanceof s)return 8===o.byteLength?o:o.slice(r,r+8);var u=new i(8);v(u,0,n,r);return u.buffer}function d(e,t){var n=e&&e.length;t|=0;return n&&t+8<=n&&"string"!=typeof e[t]}function v(e,t,n,r){t|=0;r|=0;for(var i=0;i<8;i++)e[t++]=255&n[r++]}function m(e,t){return Array.prototype.slice.call(e,t,t+8)}function g(e,t,n){for(var r=t+8;r>t;){e[--r]=255&n;n/=256}}function y(e,t,n){var r=t+8;n++;for(;r>t;){e[--r]=255&-n^255;n/=256}}function b(e,t,n){for(var r=t+8;t<r;){e[t++]=255&n;n/=256}}function w(e,t,n){var r=t+8;n++;for(;t<r;){e[t++]=255&-n^255;n/=256}}})("object"==typeof t&&"string"!=typeof t.nodeName?t:this||{})});
define("sSe",["require","exports","ww","wx","Yy","fSe","uSe","lSe","FS","jP","oT","v","W2","vH","Yb","C","zq","xv","Ex","pO","dSe","$Z","zq","A","dv","cSe","Cx","Be"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ItemResultProcessor=void 0;var L=(function(){function e(e,t){var r=this,i=t.urlDataSource,s=t.graphDataSource,o=t.itemIdentityProcessor,u=t.location,a=void 0===u?window.location:u,f=t.rootOAuthToken;this._urlDataSource=i;this._itemIdentityProcessor=o;this._origin=a.protocol+"//"+a.host;this._rootToken=f;this._graphDataSource=s;this._itemKeyByUrl=new Map;this._isOneDriveWinApp=T.isOneDriveWinApp();this._async=new d.default(this);E.default.registerCookieChecker({isApplicable:function(e){return e.indexOf("needs_accessToken=true")>0},check:function(e){return n.__awaiter(r,void 0,x.default,function(){var r,i,s,o,u,a,f,l;return n.__generator(this,function(n){switch(n.label){case 0:return(r=this._itemKeyByUrl.get(e))?(s=this._graphDataSource.refreshAccessToken)?[4,this._graphDataSource.refreshAccessToken({key:r})]:[3,2]:[3,3];case 1:s=n.sent();n.label=2;case 2:o=(i=s)&&i.accessToken;u=e+"&access_token="+o;a=new t.itemTaskObserverType;f={url:u,width:window.innerWidth,height:window.innerHeight};a.update([new m.Task(r).succeed({item:{key:r,thumbnail:m.Graft.replace(f)}})]);this._itemKeyByUrl.delete(e);a.flush();l=new v.default;this._async.setTimeout(function(){l.error(new Error("NeedAccessToken"))},0);return[2,l.getPromise()];case 3:return[2,!1]}})})}})}e.prototype.processItem=function(e,t){var r,i=e.itemFromServer,s=e.topCollaborator,o=e.requestKey,u=e.observer,a=this._itemIdentityProcessor.processIdentity({itemFromServer:i,requestKey:o,observer:u}).key,f=i.parentReference;if(f){var l=A(i),c=f.driveId,h=f.id,p=f.path;if(p||h){var d=n.__assign(n.__assign({},f),{"@odata.id":l&&(h?O(l,c,h):""+l+p)});r=this._itemIdentityProcessor.processIdentity({itemFromServer:d,requestKey:o,observer:u}).key}}var v=this._urlDataSource.getKeyParams(o),g=this._urlDataSource.getQueryType(v),y=this.buildItemFromServerResponse({itemFromServer:i,key:a,topCollaborator:s,parentKey:r,queryType:g},t);u.update([new m.Task(a).succeed({item:y})]);return{key:a}};e.prototype.buildItemFromServerResponse=function(e,t){var a,c=e.itemFromServer,d=e.topCollaborator,v=e.key,b=e.parentKey,w=e.queryType||g.default.Files,E=c.sharepointIds||{},S={key:v,parentKey:b,properties:{listId:E.listId,ID:E.listItemId,uniqueId:E.listItemUniqueId}};S.queryType=w;S.displayType=w;w===g.default.SharedWithMe&&(S.external={});var x=c.id,T=c.name,L=c.folder,M=c.size,D=c.description,P=c.location,H=(L?{extension:""}:i.splitFileName(T)).extension,B=(function(e){var t,n=e.package,r=i.getFileExtension(e.name||"",!0);t=n&&"oneNote"===n.type?y.default.OneNote:e.folder?y.default.Folder:(function(e){var t=i.getFileExtension(e.name||"",!0);return C.canOpenInMonaco(t||"")})(e)?y.default.File:e.photo?y.default.Media:e.video?y.default.Media:e.thumbnails?y.default.Media:p.default.isShortcutEnabled()&&p.default.isShortcutFileType(r)?y.default.Shortcut:y.default.File;return t})(c),j=c.parentReference,F=m.Graft.optional(j&&j.driveId);S.itemId=x;var I=j&&j.driveType;S.graph={itemId:x,driveId:F,driveType:m.Graft.optional(I)};var q=T;S.name=q;S.displayName=q;S.extension=H;S.size=M;S.caption=D||"";S.type=B;S.ownerId=F;S.geoLocation=P;var R=c.searchResult,U=c["@microsoft.graph.downloadUrl"]||c["@content.downloadUrl"],z=(function(e){var t=e["@odata.id"];if(t)return t;var n=e.id,r=(e.parentReference||{}).driveId,i=A(e);return i&&O(i,r,n)})(c),W=((a={})[r.default.download]=U,a[r.default.itemUrl]=m.Graft.optional(z),a);if(R){var X=R.onClickTelemetryUrl;X&&(W[r.default.bingClickInstrumentation]=X)}if(L){var V=L.childCount;S.folder={childCount:V};S.childCount=V}var $=c.photo,J=c.image;if(J){var K=J.width,Q=J.height;S.photo=n.__assign(n.__assign({},$?{cameraMake:m.Graft.optional($.cameraMake),cameraModel:m.Graft.optional($.cameraModel),exposureDenominator:m.Graft.optional($.exposureDenominator),exposureNumerator:m.Graft.optional($.exposureNumerator),focalLength:m.Graft.optional($.focalLength),iso:m.Graft.optional($.iso)}:{}),{width:K,height:Q,originalUrl:U})}var G=(c.file||{}).mimeType,Y=void 0===G?"":G,Z=(function(e,t){var n=e.thumbnails,r=n&&n[0],i=r&&(r.large||r.medium||r.small),s=i&&i.url;return s&&s.replace(/[&?](width|height|cropmode)=[^&]*/g,"").replace("https://media.cloudapp.net",t?"https://centralus1-mediad.svc.ms":"https://northcentralus1-medias.svc.ms")})(c,t&&"edog"===t.env),ee=Z&&Z.indexOf("/transform/thumbnail?")>=0&&Z,te=this._rootToken,ne=(function(e){return e&&("."===e[0]?e.slice(1):e).toLowerCase()})(H),re="mp4"===ne||0===Y.lastIndexOf("video/mp4",0),ie=c.video;if(ie){K=ie.width,Q=ie.height;var se=ie.bitrate,oe=ie.duration;S.video={fourCC:ie.fourCC||(re?"H264":void 0),width:K,height:Q,bitrate:se,duration:oe}}var ue=c.audio,ae=c.lastModifiedBy,fe=(void 0===ae?{}:ae).user,le=void 0===fe?{}:fe,ce=le.email,he=void 0===ce?void 0:ce,pe=le.displayName,de=void 0===pe?void 0:pe,ve=c.createdBy,me=(void 0===ve?{}:ve).user,ge=(void 0===me?{}:me).displayName,ye=void 0===ge?void 0:ge,be=c.lastModifiedDateTime,we=c.createdDateTime,Ee=c.shared,Se=void 0===Ee?{}:Ee,xe=Se.sharedBy,Te=(void 0===xe?{}:xe).user,Ne=void 0===Te?{}:Te,Ce=Ne.email,ke=void 0===Ce?void 0:Ce,Le=Ne.displayName,Ae=void 0===Le?void 0:Le,Oe=Se.sharedDateTime,Me=void 0===Oe?void 0:Oe;S.creatorName=ye;S.editorName=de;var _e=_(be);S.dateModifiedTime=_e.date;S.dateModified=_e.dateString;_e=_(we);S.dateCreatedTime=_e.date;S.dateCreated=_e.dateString;_e=_(Me);S.dateSharedTime=_e.date;S.dateShared=_e.dateString;S.properties.sharedByUser={title:Ae,isTopCollaborator:ke&&d&&d.indexOf(ke)>-1,sip:ke};S.properties.editorName=[{title:de,sip:he}];var De=".ts"===H&&M<1<<19&&!ie,Pe=f.getIconNameFromItem({type:B,extension:H,textEditorMimeType:De?"text/typescript":void 0});S.iconName=Pe;var He=ue||"audio"===Pe||0===Y.lastIndexOf("audio/",0),Be=ie||"video"===Pe||!De&&0===Y.lastIndexOf("video/",0);He&&(S.audio={});if(Be&&!ie){var je={fourCC:re?"H264":void 0,width:-1,height:-1,bitrate:void 0,duration:void 0};S.video=je}c.malware&&(S.lifeCycleStatus={isMalwareDetected:!0});var Fe=null,Ie=c["-embed-formats"];if(Ie&&Ie.dash)Fe=new k.default(Ie.dash.url);else if(ie||He||Be)if(ee){Fe=new k.default(ee.replace("/thumbnail?","/videomanifest?"));var qe=ie&&ie.manifestMetadata;Fe.setQueryParameter("manifestMetadata",qe,!0)}else"personal"===I&&(Fe=U?new k.default(U):null);if(Fe){Fe.setQueryParameter("action","Access");W[r.default.video]=Fe.toString()}var Re=B===y.default.OneNote?"one":Pe,Ue=Re&&l.OfficeIconFileTypeMap[Re];S.appMap=m.Graft.optional(Ue);S.urls=W;var ze,We=c.cTag,Xe=We&&encodeURIComponent(We);if(Z){var Ve=Z+(Z.indexOf("?")>=0?"&":"?")+"encodeFailures=1";K=J?J.width:ie?ie.width:void 0,Q=J?J.height:ie?ie.height:void 0;S.thumbnail={url:Ve,width:K,height:Q,getAligned:function(e){var t=e.width,n=void 0===t?window.innerWidth:t,r=e.height,i=void 0===r?window.innerHeight:r;return{width:n|=0,height:i|=0,url:Ve+"&width="+n+"&height="+i}}}}ee&&(ze={officeBundleGenerateUrl:ee.replace("/thumbnail?","/OfficeBundle?")+"&minVersion={{minVersion}}&cTag="+Xe,officeBundleGetFragmentUrl:ee.replace("/thumbnail?","/OfficeBundleFragment?")+"&fragment={0}"});var $e,Je,Ke=(function(e){var t=e.officeBundle;if(t)return t;var n=e.listItem,r=n&&n.fields,i=r&&r.MediaServiceFastMetadata;if(i)try{return JSON.parse(i).officeBundle}catch(e){}})(c),Qe="ms-excel"===Ue,Ge="ms-powerpoint"===Ue,Ye="ms-visio"===Ue,Ze="ms-word"===Ue,et=c.webUrl;if("pdf"!==Pe&&Ze||Qe||Ge||Ye){var tt=!(!t||!t.wopiToken)||(te?N.isWopiAllowed(h.getAppId(h.parseTokenPayload(te))):et&&0===et.lastIndexOf(this._origin,0));(Ge&&U||Ze&&tt)&&(S.officeBundle=n.__assign(n.__assign(n.__assign({},Ke?(Je=($e=Ke).generationTime,{bundleCTag:$e.ctag,bundleVersion:$e.version,hasBundleGenerationFailed:$e.fatalError||!1,generationTime:Je?new Date(Je):void 0,bundleErrorInfo:$e.errorInfo||""}):{}),ze||{}),{cTag:We}));"personal"!==I&&(S.wopiFrameUrl=et)}"7z"!==ne&&"rar"!==ne&&"zip"!==ne||(S.zip=ee?{downloadZipContentsUrl:"",zipMetaDataUrl:ee.replace("/thumbnail?","/zipmetadata?")}:m.Graft.optional((function(e,t,n,r,i){var s="personal"===(e.parentReference||{}).driveType?"odc":"spo";return n&&r?{downloadZipContentsUrl:"",zipMetaDataUrl:"https://southcentralus1-mediap.svc.ms/transform/zipmetadata?provider="+s+"&inputFormat="+t+"&docid="+encodeURIComponent(n)+"&access_token="+r}:n&&i?{downloadZipContentsUrl:"",zipMetaDataUrl:"https://southcentralus1-mediap.svc.ms/transform/zipmetadata?provider="+s+"&inputFormat="+t+"&docid="+encodeURIComponent(n)}:void 0})(c,ne,z,te,this._isOneDriveWinApp)));o.canRenderNative(H)?S.htmlConversion={}:o.canConvert(H)&&(S.htmlConversion=ee?{url:ee.replace("/thumbnail?","/html?")+"&inlineImages=true"}:{});s.canRenderNative(ne)?S.model3d={canRenderNative:!0}:s.canConvert(ne)&&(S.model3d=ee?{canConvert:!0,conversionUrl:ee.replace("/thumbnail?","/glb?")}:{canConvert:!0});var nt=c.dataLossPrevention;nt&&(S.itemStatus=m.Graft.optional((function(e,t,n){if(n.blockDownload){if(e===y.default.Media||t)return 4;if(e!==y.default.Folder)return 3}if(n.viewOnly)return 4})(B,Ue,nt)));u.canConvert(ne)?S.pdfConversion=ee?{url:ee.replace("/thumbnail?","/pdf?")}:{}:u.canRenderNative(ne)&&ee&&nt&&(nt.blockDownload||nt.viewOnly)&&(S.pdfConversion={url:ee.replace("/thumbnail?","/passthrough?")});S.openUrl=et;S.vault=c.vault;S.itemFromServer=c;S.isPlaceholder=!1;if(!S.thumbnail&&this._isOneDriveWinApp&&("jpg"===ne||"png"===ne||"jpeg"===ne)){var rt=this._graphDataSource.getItemUrl({key:v,graph:{itemId:x,driveId:j.driveId,driveType:j&&j.driveType}},{useDirectEndpoint:!0})+"/thumbnails/0/c"+(0|window.innerWidth)+"x"+(0|window.innerHeight)+"/content?needs_accessToken=true";S.thumbnail={url:rt,width:window.innerWidth,height:window.innerHeight};this._itemKeyByUrl.set(rt,v)}return S};e.dependencies={urlDataSource:b.url,itemIdentityProcessor:b.vroomItemIdentityProcessor,rootOAuthToken:w.resourceKey.optional,graphDataSource:b.graph,itemTaskObserverType:S.resourceKey};return e})();t.ItemResultProcessor=L;function A(e){var t=e["@odata.context"];if(t)return t.split("/$")[0];var n=e.sharepointIds;if(n){var r=n.siteUrl;if(r)return r+"/_api/v2.1"}}function O(e,t,n){return e+"/drive"+(t?"s/"+t:"")+"/items/"+n}var M="0001-01-01T00:00:00";function _(e){var t=e&&e.lastIndexOf(M,0)<0?new Date(e):void 0;return{date:t,dateString:t?a.getRelativeDateTimeStringPast(t):""}}t.resourceKey=c.createResolvedResourceKey(e("module").id,L);t.default=L});
define("SAe",["require","exports","ww","tB","v","K","Te","Aq","g","K2"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var l=s.deserializeQuery(window.location.search.slice(1)).s,c=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._apiUrlHelper=n.apiUrlHelper;r._pageContext=n.pageContext;r._identityDataSource=n.identityDataSource;return r}t.prototype.getVroomCreateUploadSessionItemUrl=function(){return this._apiUrlHelper.build().segment("v2.1").segment("shares").segment("u!"+l).segment("driveItem:").toString().replace(this._pageContext.webServerRelativeUrl,"")};t.prototype.getAccessToken=function(){return this._identityDataSource.getSharePointToken(new o.SimpleUri(this._pageContext.webAbsoluteUrl).authority)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{apiUrlHelper:u.resourceKey,pageContext:a.pageContext,identityDataSource:f.resourceKey});return t})(r.default);t.default=c;t.resourceKey=i.createResolvedResourceKey(e("module").id,c)});
define("HAe",["require","exports","ww","tB","Kk","A","C","Nk","W","zAe","Bk","VAe","BAe","NAe","RAe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this,s=t.batchStartTime,o=void 0===s?Date.now():s;r.filesUploading=r.observables.createArray();r.wasDragAndDropped=!!t.wasDragAndDropped;r.parentItem=t.parentItem;r.isFileRequest=!!t.isFileRequest;r.allowCookies=!!t.allowCookies;r.accessToken=t.accessToken;r.fileNamePrefix=t.fileNamePrefix;r._behavior=t.behavior;r._fileList=t.files;r.scenario=(t.scenario?t.scenario+".":"")+(r.wasDragAndDropped?"DragDrop.Upload":"Upload");r.batchStartTime=o;r._fileReader=new FileReader;r._fileReaderQueue=new i.default;r._startUploadQueue=new i.default;r._html5FileUploadType=n.html5FileUploadType;r._singleErrorUploaderType=n.singleErrorUploaderType;r._singleFolderUploaderType=n.singleFolderUploaderType;r._uploadQosMonitorType=n.uploadQosMonitorType;return r}t.prototype.start=function(){var e=this,t=new a.Qos({name:"BatchUploader.start",extraData:{scenario:this.scenario,dragAndDrop:this.wasDragAndDropped}});return this.beforeStart().then(function(){var t,n=e._fileList;t=(function(e){var t=e[0];return!!t&&"function"==typeof(t.slice||t.mozSlice||t.webkitSlice)&&"size"in t})(n)?p.buildEntriesFromFileList(n):p.buildEntriesFromEntryList(n);return s.default.all(t.map(function(t,n){return e._getUpload(t,e.parentItem,n)})).then(function(e){return s.default.all(e.map(function(e){return e.wait}))}).then(function(){})}).then(function(){t.end({resultType:a.ResultTypeEnum.Success});e.onBatchComplete()},function(){t.end({resultType:a.ResultTypeEnum.Failure});e.onBatchComplete()})};t.prototype.beforeStart=function(){return s.default.wrap()};t.prototype.validateFile=function(e){return s.default.wrap()};t.prototype.createSingleFolderUploader=function(e){var t=e.parentItem,n=e.name,r=e.onCreateFolder;return new(this.scope.attached(this._singleFolderUploaderType))({name:n,parentItem:t,onCreateFolder:r})};t.prototype.onBatchComplete=function(){};t.prototype.isSPList=function(){return!1};t.prototype.libraryName=function(){return""};t.prototype._isFolder=function(e){var t=this,n=this._fileReader;return this._fileReaderQueue.enqueue(function(){var r=new o.default;t.events.on(n,"load",function(){r.complete(!1)});t.events.on(n,"error",function(){r.complete(!0)});var i=e.slice||e.mozSlice||e.webkitSlice;try{n.readAsArrayBuffer(i.call(e,0,Math.min(1,e.size)))}catch(e){r.complete(!0)}return r.getPromise().then(function(e){t.events.off(n);return e})})};t.prototype._getUpload=function(e,t,n){var r=this,i=new a.Qos({name:"BatchUploader.getUpload",extraData:{scenario:this.scenario,dragAndDrop:this.wasDragAndDropped}});return this._startUploadQueue.enqueue(function(){var e,t=new o.default(function(){e&&r.async.clearTimeout(e)});e=r.async.setTimeout(function(){return t.complete()},0);return t.getPromise()}).then(function(){return 2===e.type?r._getDirectoryUpload(e,t):r._getUnknownUpload(e,t,n)}).then(function(e){i.end({resultType:a.ResultTypeEnum.Success});return e},function(e){i.end({resultType:a.ResultTypeEnum.Failure});return s.default.wrapError(e)})};t.prototype._getUploadsForDirectoryPage=function(e,t,n){var r=this,i=e.entries,o=[s.default.all(i.map(function(e,i){return r._getUpload(e,t,n+i)}))];e.getEntries&&o.push(e.getEntries().then(function(e){return r._getUploadsForDirectoryPage(e,t,n+i.length)}));return s.default.all(o).then(function(e){var t;return(t=[]).concat.apply(t,e)})};t.prototype._getDirectoryUpload=function(e,t){var n=this,r=new o.default,i=this.createSingleFolderUploader({name:e.name,parentItem:t,onCreateFolder:function(t){return e.getEntries().then(function(e){return n._getUploadsForDirectoryPage(e,t,0)}).then(function(e){r.complete(e)},function(e){r.error(e)})}}),u={wait:this._waitForUploader(i).then(function(){return r.getPromise()}).then(function(e){return s.default.all(e.map(function(e){return e.wait}))}).then(function(){})};return s.default.wrap(u)};t.prototype._getUnknownUpload=function(e,t,n){var r=this;return e.getFile().then(function(i){var o,a;o=0===e.type?r._isFolder(i).then(function(e){a=!0;if(e)return s.default.wrapError(new u.UploadError({message:"",errorType:l.UploadErrorType.folderUploadNotSupported}))}):s.default.wrap();var f=new r._html5FileUploadType({file:i});return o.then(function(){return r._validateFile({fileUpload:f})}).then(function(){return r.validateFile({fileUpload:f,parentItem:t,index:n})}).then(function(){return r.createSingleFileUploader({fileUpload:f,parentItem:t,index:n,isTemplate:r.isTemplate,isFileRequest:r.isFileRequest,allowCookies:r.allowCookies,accessToken:r.accessToken,fileNamePrefix:r.fileNamePrefix})},function(e){return new(r.scope.attached(r._singleErrorUploaderType))({name:i.name,parentItem:t,isFolder:a,error:e})})},function(n){return new(r.scope.attached(r._singleErrorUploaderType))({name:e.name,parentItem:t,isFolder:!1,error:new u.UploadError({errorType:l.UploadErrorType.general,message:""})})}).then(function(e){return{wait:r._waitForUploader(e)}})};t.prototype._waitForUploader=function(e){var t=new o.default(function(){e.abort()});this.scope.attach(new this._uploadQosMonitorType({uploader:e,isDragDrop:this.wasDragAndDropped}));this.observables.backgroundCompute(function(){var n=e.state.peek();2===n?t.complete():4===n?t.error(e.error.peek()||new Error("Unknown error from uploader.")):3===n?t.cancel():e.state()});this._addUploader(e);e.start();return t.getPromise()};t.prototype._validateFile=function(e){var t=e.fileUpload;return t.name?t.size?void 0!==this.maxFileSize&&t.size>this.maxFileSize?s.default.wrapError(new u.UploadError({message:"",errorType:l.UploadErrorType.fileSize,maxSizeInBytes:this.maxFileSize})):s.default.wrap():s.default.wrapError(new u.UploadError({message:"",errorType:this.isSPList()?l.UploadErrorType.emptyFileOrFolderForDocLib:l.UploadErrorType.emptyFileOrFolder,libraryName:this.libraryName()})):s.default.wrapError(new u.UploadError({message:"",errorType:l.UploadErrorType.invalidName}))};t.prototype._addUploader=function(e){var t=this._behavior;t&&e.nameConflictBehavior(t);this.filesUploading.push(e);return e};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{html5FileUploadType:h.typeResourceKey,singleErrorUploaderType:c.typeResourceKey,singleFolderUploaderType:f.typeResourceKey,uploadQosMonitorType:d.typeResourceKey});return t})(r.default);t.default=v});
define("BAe",["require","exports","jAe","k3","v"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=t.Html5FileUpload=void 0;Object.defineProperty(t,"Html5FileUpload",{enumerable:!0,get:function(){return n.Html5FileUpload}});t.typeResourceKey=i.createResolvedTypeResourceKey(e("module").id,n.Html5FileUpload,{platformDetection:r.platformDetection});t.default=n.Html5FileUpload});
define("VAe",["require","exports","ww","tB","v","Yy","jP"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=void 0;var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.name,u=t.isFolder,a=t.error;r._error=a;var f=s.getFileExtension(i),l=u?"folder":o.getIconNameFromExtension(f);r.allowRename=!1;var c=r.observables;r.item=c.create();r.state=c.create(4);r.uploadedBytes=c.create(0);r.totalBytes=c.create(0);r.fileName=c.create(i);r.iconName=c.create(l);r.error=c.create(r._error);r.nameConflictBehavior=c.create(0);return r}t.prototype.start=function(){this.error(this._error);this.state(4)};t.prototype.abort=function(){this.error(void 0);this.state(3)};t.prototype.restart=function(){this.start()};return t})(r.default);t.default=u;t.typeResourceKey=i.createResolvedTypeResourceKey(e("module").id,u)});
define("zAe",["require","exports","ww","tB","Kk","Bk","Nk","pO","v"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=t.uploadQueueResourceKey=void 0;t.uploadQueueResourceKey=new a.ResourceKey({name:e("module").id+".uploadQueue",factory:{dependencies:{},create:function(){return{instance:new i.default(3)}}}});var f=(function(e){n.__extends(i,e);function i(t,n){var r=e.call(this,t,n)||this;r._itemDataSource=n.itemDataSource;r._uploadQueue=n.uploadQueue;r._parentItem=t.parentItem;r._onCreateFolder=t.onCreateFolder;r.allowRename=!1;var i=r.observables;r.item=i.create();r.state=i.create(0);r.uploadedBytes=i.create(0);r.totalBytes=i.create(0);r.fileName=i.create(t.name);r.iconName=i.create("folder");r.error=i.create();r.nameConflictBehavior=i.create(0);return r}i.prototype.start=function(){this._uploadPromise=this.trackPromise(this._upload())};i.prototype.abort=function(){this.error(void 0);this.state(3);var e=this._uploadPromise;delete this._uploadPromise;e&&e.cancel()};i.prototype.restart=function(){var e=this,t=this._uploadPromise;delete this._uploadPromise;t&&t.cancel();t.then(function(){},function(){}).done(function(){e.start()})};i.prototype._upload=function(){var e=this;this.state(1);return this._uploadQueue.enqueue(function(){return e._itemDataSource.createFolder({parent:e._parentItem,folderName:e.fileName.peek(),needItemDetails:!0})}).then(function(t){e.item(t);return e._onCreateFolder(t)}).then(function(){e.state(2)},function(t){var n;n=t instanceof Error?t.message:t;e.error(new o.UploadError({errorType:s.UploadErrorType.other,message:n}));e.state(4)})};i.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemDataSource:u.items,uploadQueue:t.uploadQueueResourceKey});return i})(r.default);t.default=f;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,f)});
define("RAe",["require","exports","ww","tB","xAe","Bk","v","Jy","Pc","pb"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=t.UploadQosMonitor=void 0;var l=0,c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._uploader=t.uploader;r._isDragDrop=t.isDragDrop;r._id=++l;r._sequence=0;r.observables.backgroundCompute(r._computeUpdateQos);return r}t.prototype._computeUpdateQos=function(){var e=this._uploader,t=e.state.peek();if(0===t){this._uploadEvent=void 0;e.state()}else if(1===t){this._uploadEvent=this._createUploadEvent();e.state()}else if(2===t){(this._uploadEvent||(this._uploadEvent=this._createUploadEvent())).end({resultType:i.ResultTypeEnum.Success})}else if(4===t){var r=e.error.peek();(this._uploadEvent||(this._uploadEvent=this._createUploadEvent())).end(f.mergeQosEndSchema(a.getQosEndSchemaFromError(r),n.__assign({},r?{resultType:h(r)?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure}:{})));e.state()}else if(3===t){(this._uploadEvent||(this._uploadEvent=this._createUploadEvent())).end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"canceled"})}};t.prototype._createUploadEvent=function(){return new i.default({name:"BatchUploader.uploadSingleItem",dragAndDrop:this._isDragDrop,size:this._uploader.totalBytes.peek(),extension:u.getFileExtension(this._uploader.fileName.peek(),!0),folderUpload:"folder"===this._uploader.iconName.peek(),groupFolder:!1,extraData:{uploadId:this._id,uploadAttemptCount:++this._sequence,isScenarioQosEvent:!0}})};return t})(r.default);t.UploadQosMonitor=c;function h(e){switch(e.errorType){case s.UploadErrorType.conflict:case s.UploadErrorType.emptyFileOrFolder:case s.UploadErrorType.emptyFileOrFolderForDocLib:case s.UploadErrorType.fileSize:case s.UploadErrorType.folderUploadNotSupported:case s.UploadErrorType.invalidName:case s.UploadErrorType.lockMismatch:case s.UploadErrorType.malwareDetected:case s.UploadErrorType.overQuota:case s.UploadErrorType.overQuotaSharedFolder:case s.UploadErrorType.throttled:case s.UploadErrorType.versionMismatch:case s.UploadErrorType.unlockRequired:case s.UploadErrorType.insufficientVaultQuota:return!0;default:case s.UploadErrorType.authFailure:case s.UploadErrorType.accessDenied:case s.UploadErrorType.general:case s.UploadErrorType.none:case s.UploadErrorType.other:case s.UploadErrorType.targetFolderMissing:return!1}}t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,c,{})});
define("wAe",["require","exports","Yb","C","A","Kk","v"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.UploadThrottler=void 0;var u=new s.default(3),a=(function(){function e(){this.async=new n.default;this.uploaderCount=0;this.throttledSignals=[]}e.prototype.throttle=function(e){var t=this;return u.enqueue(function(){if(!t.isReady&&t.uploaderCount>=1e3){t.uploaderCount=0;t.isReady=!0}if(t.batchStartTime&&t.uploaderCount>=8)return t.throttleUploader(e);t.isReady&&!t.batchStartTime&&(t.batchStartTime=Date.now());return t.startUploader(e)})};e.prototype.addThrottleTimer=function(e){this.isReady=!0;this.setTimeout(e);return this.addUploaderCallback(function(){return i.default.resolve()})};e.prototype.startUploader=function(e){this.uploaderCount+=1;return e()};e.prototype.addUploaderCallback=function(e){var t=this,n=new r.default;this.throttledSignals.push(n);return n.getPromise().then(function(){return t.startUploader(e)})};e.prototype.throttleUploader=function(e){if(this.timeout)return this.addUploaderCallback(e);var t=1e3-(Date.now()-this.batchStartTime);if(t>0){this.setTimeout(t);return this.addUploaderCallback(e)}this.uploaderCount=0;this.batchStartTime=Date.now();return this.startUploader(e)};e.prototype.setTimeout=function(e){var t=this;if(this.timeout){this.async.clearTimeout(this.timeout);this.timeout=void 0}this.timeout=this.async.setTimeout(function(){t.timeout=void 0;t.uploaderCount=0;t.batchStartTime=Date.now();for(var e=0,n=t.throttledSignals;e<n.length;e++){n[e].complete()}t.throttledSignals=[]},e)};return e})();t.UploadThrottler=a;t.resourceKey=new o.ResourceKey({name:e("module").id,factory:new o.SimpleResourceFactory(a)})});
define("kAe",["require","exports","Yb","C","A","A3","LAe","MAe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileHasher=void 0;var a=8388608,f=(function(){function t(e){this._workerUrl=e;this._async=new n.default;this._events=new s.default(this);this.createWorker();this.reset()}t.prototype.reset=function(){this._isWorkerAlive||this.createWorker();this._finalHash="";this._hashInfo={data:u.createHashArray(),shiftSoFar:0,endByteHashed:0}};t.prototype.computeHash=function(e,t,n){var s=this;if(this.hasFullHash())return i.default.reject(new o.FileHasherError("Cannot compute hash because we already computed final hash"));if(!this._isWorkerAlive)return i.default.reject(new o.FileHasherError("Web worker failed to load or was terminated"));var u=this._currentJob?this._currentJob.signal:new r.default,f=t+a>=n?n:t+a;this._currentJob={data:e,signal:u,endByte:n,nextStartByte:f,timeout:this._async.setTimeout(function(){s.completeJob("Web worker did not respond")},3e4)};(function(e){var t=new r.default,n=new FileReader;n.onload=function(){t.complete(n.result)};n.onerror=function(){n.abort();t.error(new Error("Unable to read data Blob as ArrayBuffer using FileReader"))};n.readAsArrayBuffer(e.slice(0,a>e.size?e.size:a));return t.getPromise()})(e).then(function(e){if(e.byteLength>0){var n={buffer:e,startByte:t,endByte:f};s._worker.postMessage({info:s._hashInfo,input:n},[e])}else s.completeJob()},function(e){s.completeJob(e.message)}).done();return u.getPromise()};t.prototype.hasFullHash=function(){return!!this._finalHash};t.prototype.getFullHash=function(e){if(!this._finalHash){this.dispose();this._finalHash=u.finalizeHash(this._hashInfo,e)}return this._finalHash};t.prototype.dispose=function(){if(this._isWorkerAlive){this._events.dispose();this._async.dispose();this.completeJob("Web worker was terminated");this._worker.terminate()}this._isWorkerAlive=!1};t.prototype.createWorker=function(){var t=window.__hasher_worker;this._worker=t||new Worker(e.toUrl(this._workerUrl));this._isWorkerAlive=!0;if(t){this._worker.onerror=this.handleWorkerError.bind(this);this._worker.onmessage=this.handleWorkerMessage.bind(this)}else{this._events.on(this._worker,"error",this.handleWorkerError.bind(this));this._events.on(this._worker,"message",this.handleWorkerMessage.bind(this))}};t.prototype.handleWorkerError=function(e){var t=e&&(e.error&&e.error.message||e.message)||"Unknown web worker error";this.completeJob(t);this.dispose()};t.prototype.handleWorkerMessage=function(e){if(this._currentJob){this._async.clearTimeout(this._currentJob.timeout);if(!e||!e.data||!e.data.info)return this.completeJob("Invalid response from web worker");this._hashInfo=e.data.info;var t=this._currentJob,n=t.nextStartByte,r=t.endByte;n>=r?this.completeJob():this.computeHash(this._currentJob.data.slice(a),n,r)}};t.prototype.completeJob=function(e){if(this._currentJob){this._async.clearTimeout(this._currentJob.timeout);e?this._currentJob.signal.error(new o.FileHasherError(e)):this._currentJob.signal.complete();this._currentJob=void 0}};return t})();t.FileHasher=f});
define("LAe",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileHasherError=void 0;var r=(function(e){n.__extends(t,e);function t(n){var r=e.call(this,n)||this;r.name="FileHasherError";r.__proto__=t.prototype;return r}return t})(Error);t.FileHasherError=r});
define("MAe",["require","exports","PAe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.finalizeHash=t.createHashArray=void 0;var r=160,i=Math.floor((r-1)/32+1);t.createHashArray=function(){return Array.apply(null,Array(i)).map(Number.prototype.valueOf,0)};function s(e){return new Uint8Array([255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24])}function o(e,t,n,r,i){for(var s=0;s<i;s++)n[r+s]=e[t+s]}t.finalizeHash=function(e,t){for(var u=Math.floor((r-1)/8+1),a=new Array(u),f=0;f<i-1;f++){o(s(e.data[f]),0,a,4*f,4)}o(s(e.data[i-1]),0,a,4*(i-1),a.length-4*(i-1));var l=(function(e){return new Uint8Array(new n.Uint64LE(e).toArrayBuffer())})(t);for(f=0;f<l.length;f++)a[u-l.length+f]^=l[f];return btoa(String.fromCharCode.apply(null,a))}});
define("hAe",["require","exports","ww","HAe","OAe","CAe","yAe","Eq","_De","vAe","g","gAe","A","bAe","Nk","Bk","fB","v","Rq","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=t.useVroomUploadResourceKey=void 0;var w=10737418240,E=m.isFeatureEnabled(m.UseVroomUpload);t.useVroomUploadResourceKey=new g.ResourceKey({name:e("module").id+".useVroomUpload",factory:new g.ConstantResourceFactory(E)});var S=(function(e){n.__extends(m,e);function m(t,n){var r=e.call(this,t,n)||this;r.maxFileSize=w;r._itemsStore=n.itemsStore;r._pageContext=n.pageContext;r._listContext=n.listContext;r._postUploadProjectionHelper=n.postUploadProjectionHelper;r._postUploadTemplateHelper=n.postUploadTemplateHelper;r._singleFileUploaderType=n.singleFileUploaderType;r._vroomSingleFileUploaderType=n.vroomSingleFileUploaderType;r._useVroomUpload=n.useVroomUpload;r._isItemsScopeEnabled=n.isItemsScopeEnabled();r._nameConflictBehavior=t.behavior;r._shouldUpdateItemSet=!!t.skipInvalidation;r._uploadMetadata=t.metadata;r._itemSet=t.itemSet;r._topLevelUploaders=[];var i=r._pageContext.maximumFileSize,s=void 0!==i?1024*i*1024:w;r.maxFileSize=s;return r}m.prototype.validateFile=function(e){var t=e.fileUpload;return c.indexOfIllegalCharInUrlLeafName(t.name,this._pageContext)>-1?h.default.wrapError(new d.UploadError({message:p.default.illegalFileNameError,errorType:v.UploadErrorType.invalidName})):h.default.wrap()};m.prototype.createSingleFileUploader=function(e){var t,n=e.fileUpload,r=e.parentItem,i=e.isTemplate,o=e.isFileRequest,u=e.allowCookies,a=e.accessToken,f=e.fileNamePrefix;t=this._useVroomUpload||2===this._nameConflictBehavior?new(this.scope.attached(this._vroomSingleFileUploaderType))({fileUpload:n,parentItem:r,isFileRequest:o,allowCookies:u,accessToken:a,fileNamePrefix:f,qosContext:{uploadType:s.Html5,isDragAndDrop:this.wasDragAndDropped,isFolderUpload:!0,scenario:this.scenario}}):new(this.scope.attached(this._singleFileUploaderType))({fileUpload:n,parentItem:r,isTemplate:i,qosContext:{folderUpload:!0,scenario:this.scenario,wasDraggedAndDropped:this.wasDragAndDropped},metadata:this._uploadMetadata,nameConflictBehavior:this._nameConflictBehavior});r===this.parentItem&&this._topLevelUploaders.push(t);return t};m.prototype.createSingleFolderUploader=function(t){var n=t.parentItem,r=e.prototype.createSingleFolderUploader.call(this,t);n===this.parentItem&&this._topLevelUploaders.push(r);return r};m.prototype.onBatchComplete=function(){if(this._shouldUpdateItemSet){for(var e=[],t=0,n=this._topLevelUploaders;t<n.length;t++){var r=n[t];if(2===r.state.peek()){var i=this.peekUnwrapObservable(r.item);if(i){var s=this._itemsStore.getItem(i.key);s&&e.push(s)}}}this.isTemplate&&this._postUploadTemplateHelper?this._postUploadTemplateHelper.updateTemplates(e):!this._itemSet||b.default.isActivated("06F3E24E-15E4-4EDA-A38C-96B6FECE14B8","08/10/2019","run updateitemsetpostupload")&&this._isItemsScopeEnabled||this._postUploadProjectionHelper.updateItemSetPostUpload(this._itemSet,e,this._uploadMetadata?this._uploadMetadata.group:void 0)}};m.prototype.isSPList=function(){return 700!==this._listContext.listTemplateType};m.prototype.libraryName=function(){return this._listContext.listTitle};m.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pageContext:l.pageContext,itemsStore:u.resourceKey,listContext:l.listContext,postUploadProjectionHelper:a.resourceKey,postUploadTemplateHelper:f.resourceKey.optional,singleFileUploaderType:i.typeResourceKey,vroomSingleFileUploaderType:o.resourceKey,useVroomUpload:t.useVroomUploadResourceKey,isItemsScopeEnabled:y.isItemsScopeEnabledResourceKey.lazy});return m})(r.default);t.default=S;t.typeResourceKey=g.createResolvedTypeResourceKey(e("module").id,S)});
define("EAe",["require","exports","ww","M","Yb","C","A","Bk","r2","pb","W","Pc","AAe","Je","AAe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SharePointUploader=void 0;var v=262144e3,m=!p.default.isActivated("C632CBA1-6081-467D-A6A5-3BBCDD06B459","5/13/2020","Allow throttling after 429"),g=!p.default.isActivated("B351592D-F9B9-4EA3-BBB6-6573D66ABB6D","6/8/2020","Use file size for starting chunk size for smaller files."),y=!p.default.isActivated("60D6C33A-B397-454F-83CF-DAF0246F97A1","8/3/2020","Select file fields when upload"),b=(function(){function e(e){var t=e.hasher,n=e.throttler,s=e.dataRequestor,o=e.appName,u=e.webApiUrl,a=e.canStream,f=e.fileUpload,c=e.itemExpansion,h=e.destinationUrl,p=e.qosEvent,d=void 0===p?l.Qos:p,m=e.nameConflictBehavior,y=void 0===m?0:m,b=e.onStart,w=e.onAbort,E=e.onProgress;this._hasher=t;this._dataRequestor=s;this._throttler=n;this._chunkNumber=0;this._uploadedBytes=0;this._qosEvent=d;this._id=r.default.generate();this._canStream=a;this._webApiUrl=u;this._fileUpload=f;this._async=new i.default(this);this._itemExpansion=c;this._destinationUrl=h;this._nameConflictBehavior=y;this._chunkSize=g?Math.min(f.size,v):v;this._trackingHeaders={Application:o,Scenario:"UploadFile",ScenarioType:"AUO"};this._onStart=b;this._onAbort=w;this._onProgress=E}e.prototype.upload=function(){var e=this,t=this._throttler.throttle(function(){var t=e._id,n=e._fileUpload.size,r=e._canStream&&n>25165824,i={fileUploadId:t,size:n},s=new e._qosEvent({name:"Upload.h5",extraData:i}),p=r?"SharePointUploader.stream":"SharePointUploader.create",d=new e._qosEvent({name:p,extraData:i});e._onStart&&e._onStart();return e.start(r).then(function(e){s.end({resultType:l.ResultTypeEnum.Success});d.end({resultType:l.ResultTypeEnum.Success});return e},function(t){var n=o.default.isCanceled(t),r=h.wrapError(t),i=h.convertToUploadError(r);if(n||i.code===a.requestAborted){s.end({resultType:l.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted"});d.end({resultType:l.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted"});e._onAbort&&e._onAbort()}else{var p=h.isErrorTypeExpected(r)?l.ResultTypeEnum.ExpectedFailure:l.ResultTypeEnum.Failure;s.end(f.mergeQosEndSchema(c.getQosEndSchemaFromError(i),{resultType:p,resultCode:u.UploadErrorType[i.errorType]}));d.end(f.mergeQosEndSchema(c.getQosEndSchemaFromError(r),{resultType:p,extraData:{uploadedBytes:e._uploadedBytes}}))}return o.default.reject(i)})});this._uploadPromise=t;return t};e.prototype.abort=function(){var e=this,t=this._uploadPromise;this._uploadPromise=void 0;if(!this._hasCompleted&&t){t.cancel();t.then(function(){},function(){}).done(function(){e._hasher&&e._hasher.dispose();return e.cancelUpload()})}};e.prototype.restart=function(e){var t=e.nameConflictBehavior,n=void 0===t?this._nameConflictBehavior:t;this._nameConflictBehavior=n;var r=this._uploadPromise;this._uploadPromise=void 0;r&&r.cancel();this._hasher&&this._hasher.reset();return this.upload()};e.prototype.start=function(e){var t=this;this._uploadedBytes=0;var n=this._fileUpload.size;return(e?this.streamFile():this.uploadFile()).then(function(e){t.updateProgress(n);return e})};e.prototype.updateProgress=function(e){if(this._uploadedBytes!==e){this._uploadedBytes=e;this._onProgress&&this._onProgress(e)}};e.prototype.getUploadUrl=function(e){var t=this._webApiUrl;t=(t=t.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");var n={};n.DecodedUrl=this._fileUpload.name;n.overwrite=1===this._nameConflictBehavior;n.AutoCheckoutOnInvalidData=!0;e&&(n.XorHash=e);t=t.methodWithAliases("AddUsingPath",n);y&&(t=t.oDataParameter("$Select","VroomItemID,VroomDriveID"));this._itemExpansion&&(t=t.oDataParameter("$Expand",this._itemExpansion));return t.toString()};e.prototype.uploadFile=function(e){var t=this;void 0===e&&(e=3);var n=this._fileUpload.slice(0,this._fileUpload.size);return(this._hasher&&!this._hasher.hasFullHash()?this._hasher.computeHash(n,0,n.size):o.default.resolve()).then(function(){var r=t._hasher?t._hasher.getFullHash(n.size):void 0,i=t._hasher?"UploadFileWithChecksum":"UploadFile";return t.uploadChunk({trackSpeed:!1,url:t.getUploadUrl(r),qosName:i,data:n,offset:0,length:n.size}).then(function(e){return t.parseItemResponse(e)}).catch(function(n){if(o.default.isCanceled(n))return o.default.wrapError(n);if(n&&n.retryAfter&&e>0&&m){var r=1e3*n.retryAfter;return t._throttler.addThrottleTimer(r).then(function(){t._uploadedBytes=0;return t.uploadFile(e-1)})}return o.default.wrapError(h.createError(n,d.UploadStage.singleChunk))})})};e.prototype.getStreamingUrl=function(e,t,n,r){var i,s=this._webApiUrl,o=this._fileUpload.name,u={uploadId:{guid:this._requestId}};if(n===d.UploadStage.start){i="StartUpload";s=(s=s.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");s=1===this._nameConflictBehavior?s.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:o}):s.methodWithAliases("AddStubUsingPath",{DecodedUrl:o})}else{if(n===d.UploadStage.finish){i=this._hasher?"FinishUploadWithChecksum":"FinishUpload";s=s.oDataParameter("$Expand","ListItemAllFields")}else i="ContinueUpload";s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+o});u.fileOffset=e;r&&n===d.UploadStage.finish&&(u.checksum=r)}return(s=s.methodWithAliases(i,u)).toString()};e.prototype.streamFile=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._requestId||(this._requestId=r.default.generate());var i=this._fileUpload.size,u=this._chunkNumber>0?Math.min(this._chunkSize+e,i):0,a=this._fileUpload.slice(e,u),f=0===this._chunkNumber?d.UploadStage.start:i<=u?d.UploadStage.finish:d.UploadStage.continue,l=f===d.UploadStage.start,c=f===d.UploadStage.finish,p="SendFileRequest"+(l?".Start":c?this._hasher?".FinishWithChecksum":".Finish":".Continue"),v=this._hasher&&f!==d.UploadStage.start&&!this._hasher.hasFullHash()&&this._hasher?this._hasher.computeHash(a,e,u):o.default.resolve();return(c?v:o.default.resolve()).then(function(){var r=void 0;n._hasher&&c&&(r=n._hasher.getFullHash(i));return n.uploadChunk({trackSpeed:!0,url:n.getStreamingUrl(e,u,f,r),qosName:p,data:a,offset:e,length:a.size}).then(function(e){n.updateProgress(u);if(u<i){n._chunkNumber++;return v.then(function(){return n.streamFile(u)})}return n.parseItemResponse(e)},function(r){if(o.default.isCanceled(r)){f!==d.UploadStage.start&&n.cancelUpload();return o.default.reject(r)}if(h.shouldLowerChunkSize(r)){if(n._chunkSize<=1048576){n.cancelUpload();return o.default.reject(h.createError(r,f))}n._chunkSize=Math.floor(n._chunkSize/2);return n.streamFile(e,t)}if(t>0&&h.canRetry(r,f)){var i,u=new s.default(function(){i&&n._async.clearTimeout(i)});i=n._async.setTimeout(function(){return u.complete()},1e3);return u.getPromise().then(function(){return n.getUploadStatus().then(function(e){return n.streamFile(e,t-1)},function(){return n.streamFile(e,t-1)})})}f!==d.UploadStage.start&&n.cancelUpload();return o.default.reject(h.createError(r,f))})},function(e){f!==d.UploadStage.start&&n.cancelUpload();return o.default.reject(e)})};e.prototype.getUploadStatus=function(){var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileUpload.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:this._requestId}}).toString();return this._dataRequestor.getData({url:e,method:"GET",qosName:"GetUploadStatus",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},telemetryHandler:function(e){var t=e.eventData,r=e.response;if(t.resultType===l.ResultTypeEnum.Success){if(!r||!r.d||!r.d.ExpectedContentRange)return{eventData:n.__assign(n.__assign({},t),{resultCode:"NoContentRange",resultType:l.ResultTypeEnum.Failure})};var i=parseInt(r.d.ExpectedContentRange.split("-")[0],10);if(isNaN(i))return{eventData:n.__assign(n.__assign({},t),{resultCode:"NaNContentRange",resultType:l.ResultTypeEnum.Failure,error:r.d.ExpectedContentRange})}}return{eventData:t}}}).then(function(e){if(e.d&&e.d.ExpectedContentRange){var t=parseInt(e.d.ExpectedContentRange.split("-")[0],10);return isNaN(t)?o.default.reject(""):t}return o.default.reject("")})};e.prototype.cancelUpload=function(){if(!this._requestId)return o.default.resolve();var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileUpload.name}).methodWithAliases("CancelUpload",{uploadId:{guid:this._requestId}}).toString();this._requestId="";this._chunkNumber=0;return this._dataRequestor.getData({url:e,qosName:"CancelUploadSession",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id}}).then(function(){})};e.prototype.uploadChunk=function(e){var t,n,r,i,o=this,u=e.url,a=e.qosName,f=e.data,l=e.offset,c=e.length,p=new s.default(function(){t.cancel()}),d=function(e){var t=o._chunkNumber>0&&l+c>=o._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&o._async.clearTimeout(n);e&&(n=o._async.setTimeout(function(){p.error({code:""+h.clientErrorCodes.timeout,message:""})},r))},v=Date.now(),m=Date.now(),g=0,y=0,b=0,w=this._async.debounce(function(e){e>o._uploadedBytes&&o.updateProgress(e)},100,{leading:!1});t=this._dataRequestor.getData({url:u,qosName:a,additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:f,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();y+=(e.loaded-g)/(t-m);b++;r=e.loaded/(t-v);m=t;g=e.loaded;w(l+e.loaded);d(c-e.loaded)}}});d(c);e.trackSpeed&&(i=this._async.setInterval(function(){if(b){Date.now()-v+(c-g)/((y+r)/(b+1))>15e4&&g<c&&p.error({code:""+h.clientErrorCodes.tooSlow,message:""})}},1e4));t.done(function(e){p.complete(e)},function(e){p.error(e)});p.getPromise().done(function(){n&&o._async.clearTimeout(n);i&&o._async.clearInterval(i)},function(){t.cancel();n&&o._async.clearTimeout(n);i&&o._async.clearInterval(i)});return p.getPromise()};e.prototype.parseItemResponse=function(e){try{return JSON.parse(e).d}catch(e){}};return e})();t.SharePointUploader=b});
define("OAe",["require","exports","ww","M","C","A","Yy","ey","Vye","uv","v","Bk","TAe","zi","tB","fB","Gq","kAe","Ex","EAe","Je","g","wAe","Uye","pO","h$","Aq","D7","Y2","H9e","wq","zq"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=t.SingleFileUploader=void 0;var _=v.isFeatureEnabled(v.SPOODBWebUploadChecksum)&&"undefined"!=typeof Worker,D=!w.default.isActivated("44BB59BD-B756-45D2-945E-4C9B1AACEB42","9/1/2020","Switch back the odsp-next version of the SharePoint uploader."),P=!w.default.isActivated("3E300045-4874-4525-A1A3-29E5A7BF6BC7","10/21/2020","No longer disable streaming when download is disabled."),H=D?h.SharePointUploader:b.SharePointUploader,B=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._handleFailure=function(e){if(3===r.state.peek())return s.default.reject(e);var t=r._getItemKey();if(e.errorType!==c.UploadErrorType.conflict){r._itemTaskObserver.update([new m.default(t).succeed({item:{key:t,state:{upload:{status:4}}}})]);r._itemTaskObserver.flush()}r.item(r._itemTaskObserver.getItem({key:t}));r.error(e);r.state(4);return s.default.reject(e)};var i=t.fileUpload,o=t.parentItem,u=t.metadata,a=t.isTemplate,l=t.nameConflictBehavior;r._parentItem=o;r._fileUpload=i;r._isTemplate=!!a;if(_){var h="undefined"!=typeof __webpack_public_path__?__webpack_public_path__+"hasher.worker.js":window.require.toUrl("hasher.worker.js"),p=n.workerDataSource.getWorkerUrl(h);r._hasher=new g.FileHasher(p);r.addDisposable(r._hasher)}r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;r._itemParentHelper=n.itemParentHelper;r._itemUrlHelper=n.itemUrlHelper;r._apiUrlHelper=n.apiUrlHelper;r._throttler=n.uploadThrottler;r._dataRequestor=new n.dataRequestorType({qosName:"SingleFileUploader"});var d=Number(r._pageContext.webTemplate)===f.default.mySite;r.totalBytes=r.createObservable(i.size);r.uploadedBytes=r.createObservable(0);r.fileName=r.createObservable(i.name);r.iconName=r.createObservable(i.iconName);r.state=r.createObservable(0);r.error=r.createObservable();r.nameConflictBehavior=r.createObservable(l||0);r.allowRename=!1;r.supportsVersioning=!0;r.item=r.createObservable();r._uploadMetadata=u;r._itemTaskObserver=new n.itemTaskObserverType;var v=r._itemUrlHelper.getItemUrlParts(r._parentItem.key),y=r._apiUrlHelper.build().webByItemUrl(v);r.sharePointUploader=new H({webApiUrl:y,hasher:r._hasher,fileUpload:i,throttler:r._throttler,canStream:r._canStream(),dataRequestor:r._dataRequestor,itemExpansion:r._getExpansionValue(),destinationUrl:r._getDestinationUrl(),nameConflictBehavior:l,appName:d?"ODB Web":"SPList Web",onStart:function(){r.error(void 0);r.state(1)},onAbort:function(){var e=r.item.peek().key;r._itemTaskObserver.update([new m.default(e).succeed({item:{key:e,state:{upload:{status:3}}}})]);r._itemTaskObserver.flush();r.item(r._itemTaskObserver.getItem({key:e}))},onProgress:function(e){r.uploadedBytes(e)}});return r}t.prototype.start=function(){var e=this;this.state(0);var t=this._getItemKey();this._itemTaskObserver.update([new m.default(t).succeed({item:{key:t,state:{upload:{status:1}}}})]);this._itemTaskObserver.flush();this.item(this._itemTaskObserver.getItem({key:t}));return this.sharePointUploader.upload().then(function(t){return e._finshUpload(t)},this._handleFailure)};t.prototype.abort=function(){this.error(void 0);this.state(3);this.sharePointUploader.abort()};t.prototype.restart=function(){var e=this;this.sharePointUploader.restart({nameConflictBehavior:this.nameConflictBehavior.peek()}).then(function(t){return e._finshUpload(t)},this._handleFailure)};t.prototype._canStream=function(){return!(!P&&this._pageContext.blockDownloadsExperienceEnabled)&&!!(this._parentItem&&this._parentItem.permissions||u.PermissionMask.hasItemPermission(this._parentItem,u.PermissionMask.editListItems))};t.prototype._finshUpload=function(e){var t=this,n=this._transformItem(e);this.item(n);var r=this._getItemKey();return this._updateMetadata(n).then(function(){if(!t._uploadMetadata||!t._uploadMetadata.group){t._itemTaskObserver.update([new m.default(r).succeed({item:{key:r,state:{upload:{status:2}}}})]);t._itemTaskObserver.flush();t.item(t._itemTaskObserver.getItem({key:r}))}t.state(2)},this._handleFailure)};t.prototype._transformItem=function(e){var t=this._getItemKey(),n=void 0;e.ListItemAllFields&&e.ListItemAllFields.Id&&(n=String(e.ListItemAllFields.Id));var i=!1;if(e.ListItemAllFields&&e.ListItemAllFields.ContentType&&e.ListItemAllFields.ContentType.Fields&&e.ListItemAllFields.ContentType.Fields.results){var s=e.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(s.length>0)for(var u=0,a=s;u<a.length;u++){var f=a[u];if(!e.ListItemAllFields[f.InternalName]){i=!0;break}}}var l=e.UniqueId?r.default.normalizeLower(e.UniqueId):"",c=e.Name,h=o.getFileExtension(c),p=this._itemTaskObserver;p.update([new m.default(t).succeed({item:{key:t,parentKey:this._parentItem.key,type:y.default.File,id:e.ServerRelativeUrl,name:c,displayName:c,extension:h,properties:{ID:n,uniqueId:l},itemFromServer:e,hasMissingMetadata:i,graph:{driveId:e.VroomDriveID,itemId:e.VroomItemID}}})]);p.flush();return p.getItem({key:t})};t.prototype._getDestinationUrl=function(){var e=this._itemUrlHelper.getItemUrlParts(this._parentItem.key),t=e.serverRelativeListUrl+"/Forms";return this._isTemplate?t:e.serverRelativeItemUrl||""};t.prototype._getExpansionValue=function(){var e="ListItemAllFields",t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._parentItem,"list"));if(t){var n=t.list;n&&n.contentTypesEnabled&&n.templateType!==p.default.mySiteDocumentLibrary&&(e="ListItemAllFields/ContentType/Fields")}return e};t.prototype._updateMetadata=function(e){var t;if(this._uploadMetadata&&this._uploadMetadata.group){var n=new i.default;this._updateItem(e,n);t=n.getPromise()}else t=s.default.wrap();return t};t.prototype._updateItem=function(e,t){if(!this._uploadMetadata||!this._uploadMetadata.group)return s.default.wrap();var n=this._uploadMetadata,r=this.resources.consume(A.resourceKey),i={item:N.convertToISPListItem(e),fields:(function(){for(var e=[],t=n.group;t;){var r=t.fieldValue,i=t.fieldSchema;e.push({data:r,serverData:null,state:0,hasException:!1,errorMessage:"",schema:i});t=n.itemGroups&&Array.isArray(n.itemGroups)?x.convertGroup(a.default.getParent(t,n.itemGroups)):void 0}return e})(),formType:1};return r.updateItem({clientForm:i,newDocumentUpdate:!1}).then(function(){t.complete()},function(e){t.error(e)})};t.prototype._getItemKey=function(){var e,t=this._itemUrlHelper.getItemUrlParts(this._parentItem.key),n=t.serverRelativeItemUrl,r=t.normalizedListUrl,i=n+"/"+this._fileUpload.name;return this._urlDataSource.getKey(((e={}).id=i,e.listurl=r||"",e))};t.dependencies=n.__assign(n.__assign({},d.default.dependencies),{urlDataSource:T.url,itemParentHelper:O.resourceKey,itemUrlHelper:k.resourceKey,apiUrlHelper:C.resourceKey,dataRequestorType:L.typeResourceKey,itemTaskObserverType:M.resourceKey,pageContext:E.pageContext,workerDataSource:T.worker,uploadThrottler:S.resourceKey});return t})(d.default);t.SingleFileUploader=B;t.typeResourceKey=l.createResolvedTypeResourceKey(e("module").id,B)});
define("AAe",["require","exports","ww","r2","Bk","Nk","N","LAe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isErrorTypeExpected=t.convertToUploadError=t.wrapError=t.createError=t.canRetry=t.shouldLowerChunkSize=t.UploadFragmentError=t.UploadStage=t.clientErrorCodes=void 0;var a,f="-1",l="-2130575257",c="-2130575142",h="-2130209002",p="-2130209003",d="-2147023080",v="-2130575245";t.clientErrorCodes={unknown:"UNKNOWN_UPLOAD_ERROR",timeout:"UPLOAD_TIMEOUT_ERROR",tooSlow:"UPLOAD_TOO_SLOW_ERROR"};(function(e){e[e.singleChunk=0]="singleChunk";e[e.start=1]="start";e[e.continue=2]="continue";e[e.finish=3]="finish";e[e.status=4]="status";e[e.cancel=5]="cancel"})(a=t.UploadStage||(t.UploadStage={}));var m=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,n.__assign(n.__assign({},t),{extraData:n.__assign(n.__assign({},t.extraData||{}),"number"==typeof t.statusCode?{status:t.statusCode}:{})}))||this;r.errorType=t.errorType;r.displayString=t.displayString;try{r.serverError=JSON.stringify(t.serverError)}catch(e){r.serverError=""}return r}return t})(o.ApiError);t.UploadFragmentError=m;function g(e){if(e&&e.code){return e.code.split(",")[0]||e.code}return e&&e.number?""+e.number:t.clientErrorCodes.unknown}t.shouldLowerChunkSize=function(e){var n=g(e);return n===t.clientErrorCodes.tooSlow||n===t.clientErrorCodes.timeout||!!e&&0===e.status};t.canRetry=function(e,t){if(429===e.status)return!1;if(404===e.status&&(t===a.start||t===a.singleChunk))return!1;switch(g(e)){case r.requestAborted:case f:case l:case c:case h:case p:case d:case v:return!1;default:return!0}};t.createError=function(e,n){if(!e)return new m({errorType:i.UploadErrorType.general,code:"Unknown",statusCode:0,message:"Unknown upload error",serverError:e});var s,o,u=!1,f=g(e);if("string"==typeof e)s=e;else{var c=e.message;if("string"==typeof c)s=c;else if(c&&c.value){s=c.value;u=!0}}var h=e&&e.code||"Unhandled client error";if(f===r.offline){h="Disconnected";o=i.UploadErrorType.disconnected}else o=f===l?i.UploadErrorType.conflict:f===t.clientErrorCodes.timeout?i.UploadErrorType.general:404!==e.status||n!==a.start&&n!==a.singleChunk?u?i.UploadErrorType.other:i.UploadErrorType.general:i.UploadErrorType.targetFolderMissing;return new m({errorType:o,code:f,statusCode:e.status,message:h,correlationId:e.correlationId,displayString:s,serverError:e})};t.wrapError=function(e){return e instanceof m?e:e instanceof u.FileHasherError?new m({errorType:i.UploadErrorType.other,code:"FileHasher",statusCode:0,innerError:e}):new m({errorType:i.UploadErrorType.general,code:"Unknown",statusCode:0,innerError:e})};t.convertToUploadError=function(e){return new s.UploadError({message:e.displayString||e.message||"Unknown fragment error",errorType:e.errorType,innerError:e,supportsVersioning:!0})};t.isErrorTypeExpected=function(e){switch(e.errorType){case i.UploadErrorType.disconnected:case i.UploadErrorType.conflict:case i.UploadErrorType.targetFolderMissing:return!0}switch(e.code){case d:case v:case r.offline:case r.noConnection:case r.requestAborted:case t.clientErrorCodes.timeout:return!0}return!1}});
define("yAe",["require","exports","ww","tB","Bk","Nk","xAe","A","C","Kk","aQ","v","DAe","pO","sSe","zq","fe","SAe","dv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.SingleFileUploader=t.uploadQueueResourceKey=void 0;t.uploadQueueResourceKey=new c.ResourceKey({name:e("module").id+".uploadQueue",factory:{dependencies:{},create:function(){return{instance:new f.default(3)}}}});var b=0,w=(function(e){n.__extends(f,e);function f(t,n){var r=e.call(this,t,n)||this,i=t.fileUpload;r._qosData={uploadId:""+ ++b,uploaderType:"Vroom",scenario:t.qosContext.scenario};r._vroomUploader=n.vroomUploader;r._uploadQueue=n.uploadQueue;r._graphDataSource=n.graphDataSource;r._itemResultProcessor=n.itemResultProcessor;r._itemTaskObserver=new n.itemTaskObserverType;r._parentItem=t.parentItem;r._fileUpload=i;r._qosContext=t.qosContext;r._isFileRequest=!!t.isFileRequest;r._allowCookies=!!t.allowCookies;r._accessToken=t.accessToken;r._fileNamePrefix=t.fileNamePrefix;r._isOneDriveWinApp=y.isOneDriveWinApp();r.state=r.createObservable(0);r.uploadedBytes=r.createObservable(0);r.totalBytes=r.createObservable(i.size);r.fileName=r.createObservable(i.name);r.iconName=r.createObservable(i.iconName);r.error=r.createObservable();r.nameConflictBehavior=r.createObservable(0);r.allowRename=!0;r.item=r.createObservable();return r}f.prototype.start=function(){this._uploadPromise=this.trackPromise(this._upload())};f.prototype.abort=function(){delete this._fileUpload;var e=this._pendingRestart;delete this._pendingRestart;if(e)e.cancel();else{var t=this._uploadPromise;delete this._uploadPromise;if(t){t.cancel();t.done(function(){},function(){})}}};f.prototype.restart=function(){var e=this,t=this._pendingRestart;delete this._pendingRestart;if(t)t.complete();else{var n=this._uploadPromise;delete this._uploadPromise;if(n){n.cancel();n.done(function(){e.start()},function(){e.start()})}}};f.prototype._upload=function(){var e=this,t=this._fileUpload;this.uploadedBytes(0);this.error(void 0);if(!t){this.state(4);return u.default.wrap()}this.state(0);var r=this._qosContext,s=new o.Upload({name:"Upload."+r.uploadType,size:t.size,extension:t.extension.substring(1),dragAndDrop:r.isDragAndDrop,folderUpload:r.isFolderUpload,groupFolder:!1,extraData:this._qosData});return this._enqueue().then(function(){e.state(1);var n,r,i,s,o,u,a,f=e._parentItem,l={};e._isOneDriveWinApp&&f.vault&&(l.Prefer="Include-Feature=Vault");if(e._isFileRequest){e._fileRequestUtilityDataSource=e.resources.consume(g.resourceKey);n=e._fileRequestUtilityDataSource.getVroomCreateUploadSessionItemUrl();r=e._accessToken;i=e._allowCookies;s=x(2);o=void 0;u=e._fileNamePrefix+t.name;a=!e._allowCookies}else{n=e._graphDataSource.getItemUrl(f,{useDirectEndpoint:!0,isPath:!0,allowCookies:e._allowCookies});r=e._accessToken||e._graphDataSource.getAccessToken(f);i=e._allowCookies;s=x(e.nameConflictBehavior.peek());o=t.lastModifiedDate;u=t.name;a=!1}return e._vroomUploader.upload({qosData:e._qosData,itemUrl:n,accessToken:r,allowCookies:i,ignoreCookieAuth:a,headers:l,fileName:u,content:t,lastModifiedDate:o,eTag:t.eTag,conflictBehavior:s,onProgress:e.async.debounce(function(t){t>e.uploadedBytes.peek()&&e.uploadedBytes(t)},100,{leading:!1}),onPromptForConfictBehavior:function(t){return e._promptForConflictBehavior(t)},onWait:function(t){return e._wait(t)}})}).then(function(t){e._dequeue();return t},function(t){e._dequeue();return u.default.wrapError(t)}).then(function(t){if(!e._isFileRequest){var n=e._itemTaskObserver,r=e._itemResultProcessor.processItem({itemFromServer:t,requestKey:e._parentItem.key,observer:n}).key;n.update([new v.Task(r).succeed({item:{key:r,parentKey:e._parentItem.key}})]);n.flush();var i=n.getItem({key:r});e.item(i)}}).then(function(){e.uploadedBytes(t.size);delete e._fileUpload;e.error(void 0);e.state(2);s.end({resultType:o.ResultTypeEnum.Success})},function(t){if(u.default.isCanceled(t)){var r=e.state.peek();e.error(void 0);e.state(3);var a=void 0;switch(r){case 0:a="Dequeued";break;case 4:a="Ignored";break;default:a="Aborted"}s.end({resultType:o.ResultTypeEnum.ExpectedFailure,resultCode:a,extraData:n.__assign(n.__assign({},e._qosData),{lastByte:e.uploadedBytes.peek()})})}else{l.isGraphError(t)||m.default.logError(t);var f=e._getUploadError(t),c=f.errorType;e.error(f);e.state(4);s.end({resultType:E(c)?o.ResultTypeEnum.ExpectedFailure:o.ResultTypeEnum.Failure,resultCode:i.UploadErrorType[c],error:f.message,extraData:n.__assign(n.__assign(n.__assign({},e._qosData),f.extraData),{lastByte:e.uploadedBytes.peek()})})}return u.default.wrapError(t)})};f.prototype._promptForConflictBehavior=function(e){var t=this;this._dequeue();var n=new a.default;this._pendingRestart=n;var r=e?this._getUploadError(e):new s.UploadError({message:"",errorType:i.UploadErrorType.conflict,allowRename:this.allowRename});this.error(r);this.state(4);return n.getPromise().then(function(){var e=t.nameConflictBehavior.peek();t.error(void 0);t.state(0);return t._enqueue().then(function(){t.state(1);return u.default.wrap(x(e))})})};f.prototype._enqueue=function(){var e=new a.default;this._queueBlocker=e;var t=new a.default(function(){e.cancel()});this._uploadQueue.enqueue(function(){t.complete();return e.getPromise()});return t.getPromise()};f.prototype._dequeue=function(){var e=this._queueBlocker;delete this._queueBlocker;e&&e.complete()};f.prototype._wait=function(e){var t,n=this,r=e.duration,i=e.allowWakeWhenOnline,s=void 0!==i&&i,o=new a.default(function(){n.async.clearTimeout(t)}),f=function(){s&&o.complete()};t=this.async.setTimeout(function(){o.complete()},r);this.events.on(window,"online",f);return o.getPromise().then(function(){n.events.off(window,"online",f)},function(e){n.events.off(window,"online",f);return u.default.wrapError(e)})};f.prototype._getUploadError=function(e){var t;if(l.isGraphError(e)){var n=e;t=n.response&&n.response.error&&n.response.error.fixItUrl}return new s.UploadError({message:e.message,errorType:S(e),allowRename:this.allowRename,fixItUrl:t,extraData:l.getQosExtraDataFromError(e)})};f.dependencies=n.__assign(n.__assign({},r.default.dependencies),{vroomUploader:h.resourceKey,uploadQueue:t.uploadQueueResourceKey,itemResultProcessor:d.resourceKey,itemTaskObserverType:v.resourceKey,graphDataSource:p.graph});return f})(r.default);t.SingleFileUploader=w;function E(e){switch(e){case i.UploadErrorType.conflict:case i.UploadErrorType.pathTooLong:case i.UploadErrorType.invalidName:case i.UploadErrorType.folderUploadNotSupported:case i.UploadErrorType.emptyFileOrFolder:case i.UploadErrorType.emptyFileOrFolderForDocLib:case i.UploadErrorType.lockMismatch:case i.UploadErrorType.overQuota:case i.UploadErrorType.fileSize:case i.UploadErrorType.unlockRequired:case i.UploadErrorType.insufficientVaultQuota:return!0;default:return!1}}function S(e){var t=l.getErrorResolution(e,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return i.UploadErrorType.authFailure;case"pathIsTooLong":return i.UploadErrorType.pathTooLong;case"pathIsTooDeep":case"invalidPath":case"nameContainsInvalidCharacters":return i.UploadErrorType.invalidName;case"itemNotFound":case 404:return i.UploadErrorType.targetFolderMissing;case"activityLimitReached":return i.UploadErrorType.throttled;case"unlockRequired":return i.UploadErrorType.unlockRequired;case"accessRestricted":case"accessDenied":case"notSupported":case 403:case 429:return i.UploadErrorType.accessDenied;case"nameAlreadyExists":case 409:return i.UploadErrorType.conflict;case"entityTagDoesNotMatch":case"versionNumberDoesNotMatch":case"resourceModified":case 412:return i.UploadErrorType.versionMismatch;case"maxFileSizeExceeded":case 413:return i.UploadErrorType.fileSize;case 415:return i.UploadErrorType.emptyFileOrFolder;case"lockMismatch":case"lockNotFoundOrAlreadyExpired":case"lockOwnerMismatch":case 423:return i.UploadErrorType.lockMismatch;case"insufficientVaultQuota":return i.UploadErrorType.insufficientVaultQuota;case"maxDocumentCountExceeded":case"maxFolderCountExceeded":case"maxItemCountExceeded":case"quotaLimitReached":case 507:return i.UploadErrorType.overQuota;case"malwareDetected":case"virusSuspicious":return i.UploadErrorType.malwareDetected;case"timeout":case"generalException":case"invalidRange":case"invalidRequest":case"notAllowed":case"resyncRequired":case"serviceNotAvailable":case"uploadSessionNotFound":case 400:case 405:case 411:case 422:case 500:case 501:case 503:return}});void 0===t&&(t=i.UploadErrorType.general);return t}function x(e){var t;switch(e){case 1:case 3:t="replace";break;case 2:t="rename";break;default:case 0:t="fail"}return t}t.resourceKey=new c.ResourceKey({name:e("module").id,factory:new c.ResolvedResourceTypeFactory(w)});t.default=w});
define("DAe",["require","exports","IAe","eQ","v"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.vroomUploadStateMachineResourceKey=t.activityBandwidthVerifierTypeResourceKey=t.useStreamingUploadResourceKey=t.useCommitForVroomUploadResourceKey=t.vroomUploadServiceResourceKey=t.performanceNowResourceKey=void 0;var s=new i.ResourceKey({name:e("module").id+".maximumFragmentSize",factory:new i.ConstantResourceFactory(251658240)});t.performanceNowResourceKey=new i.ResourceKey({name:e("module").id+".performanceNow",factory:new i.ConstantResourceFactory(n.performanceNow)});t.vroomUploadServiceResourceKey=new i.ResourceKey({name:e("module").id+".vroomUploadService",factory:new i.ResolvedResourceFactory(n.UploadService,{dataRequestor:r.resourceKey})});t.useCommitForVroomUploadResourceKey=new i.ResourceKey({name:e("module").id+".useCommitForVroomUpload",factory:new i.ConstantResourceFactory(!0)});t.useStreamingUploadResourceKey=new i.ResourceKey({name:e("module").id+".useStreamingUpload",factory:new i.ConstantResourceFactory(!0)});t.activityBandwidthVerifierTypeResourceKey=new i.ResourceKey({name:e("module").id+".activityBandwidthVerifier",factory:new i.ResolvedResourceTypeFactory(n.ActivityBandwidthVerifier,{performanceNow:t.performanceNowResourceKey})});t.vroomUploadStateMachineResourceKey=new i.ResourceKey({name:e("module").id+".vroomUploadStateMachine",factory:new i.ResolvedResourceFactory(n.UploadStateMachine,{uploadService:t.vroomUploadServiceResourceKey,activityBandwidthVerifierType:t.activityBandwidthVerifierTypeResourceKey,useCommitForUpload:t.useCommitForVroomUploadResourceKey,maximumFragmentSize:s})});t.resourceKey=i.createResolvedResourceKey(e("module").id,n.Uploader,{uploadService:t.vroomUploadServiceResourceKey,uploadStateMachine:t.vroomUploadStateMachineResourceKey,useStreamingUpload:t.useStreamingUploadResourceKey});t.default=n.Uploader});
define("Uye",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertGroup=void 0;t.convertGroup=function e(t){if(t){var r=t.fieldSchema,i=t.children,s=n.__rest(t,["fieldSchema","children"]);return n.__assign({fieldSchema:r?n.__assign(n.__assign({},r),{Name:r.Name}):void 0,children:i?i.map(e):void 0},s)}}});
define("vAe",["require","exports","NZ","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var i=(function(){function e(e,t){this._listProvider=t.listProvider}e.prototype.updateTemplates=function(e){this._listProvider.updateTemplates(e)};return e})();t.default=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i,{listProvider:n.resourceKey})});
define("H9e",["require","exports","v","g","R9e"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertListContext=t.resourceKey=void 0;var s={listContext:r.listContext,pageContext:r.pageContext};t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:s,create:function(e){var t=e.listContext,n=e.pageContext,r=new i.ClientFormProvider({listContext:o(t),pageContext:n});return{instance:r,disposable:r}}}});function o(e){return{listUrl:e.listUrl,listId:e.listId,urlParts:e.urlParts,listTitle:e.listTitle,listTemplateType:e.listTemplateType,isDocLib:e.isDocLib,folderPath:e.folderPath,enableAttachments:e.enableAttachments,leftNavigationData:e.leftNavigationData,refreshClientForm:e.refreshClientForm,contentTypesEnabled:e.contentTypesEnabled,tenantTagPolicyEnabled:e.tenantTagPolicyEnabled,allowCreateFolder:e.allowCreateFolder,flags2:e.flags2}}t.convertListContext=o});
define("dSe",["require","exports","v"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey("rootAuthToken")});
define("cSe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isFirstParty=t.isWopiAllowed=void 0;var n=["00000002-0000-0ff1-ce00-000000000000","2d4d3d8e-2be3-4bef-9f87-7875a61c29de","00000007-0000-0ff1-ce00-000000000000","cc15fd57-2c6c-4117-a88c-83b1d56b4bbe","5e3ce6c0-2b1f-4285-8d4b-75ee78787346","1fec8e78-bce4-4aaf-ab1b-5451cc387264","3ab4b783-69c8-4af2-b6b3-7bb6d4bcff21","944f0bd1-117b-4b1c-af26-804ed95e767e","4345a7b9-9a63-4910-a426-35363201d503","d3590ed6-52b3-4102-aeff-aad2292ab01c","27922004-5251-4030-b22d-91ecd9a37ea4"],r=["00000005-0000-0ff1-ce00-000000000000","6b4b7fb3-0cd3-406a-85d0-4e4dbb1c4a66","b26aadf8-566f-4478-926f-589f601d9c74","af124e86-4e96-495a-b70a-90f90ab96707","ab9b8c07-8f02-4f72-87fa-80105867a763","80ccca67-54bd-44ab-8625-4b79c4dc7775","d2651b8f-b523-4ffd-a8d2-e91242097cd6","c57a5634-1757-4ea7-a8ea-5ab3a51c8a03","00000009-0000-0000-c000-000000000000"];t.isWopiAllowed=function(e){return!e||n.indexOf(e.toLowerCase())>=0};t.isFirstParty=function(e){if(!e)return!0;var t=e.toLowerCase();return n.indexOf(t)>=0||r.indexOf(t)>=0}});
define("gAe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.indexOfIllegalCharInUrlLeafName=void 0;var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];t.indexOfIllegalCharInUrlLeafName=function(e,t){for(var r,i,s=e.length,o=t.supportPoundStorePath,u=t.supportPercentStorePath,a=0;a<s;a++){r=e.charCodeAt(a);var f="#"===(i=e[a])&&o||"%"===i&&u;if(r<160&&!n[r]&&!f)return 1;if("."===i&&a===s-1)return 1}return-1}});