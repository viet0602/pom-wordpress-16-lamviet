define("lWe",["require","exports","pWe","Q3","uWe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataSyncListStatus=i.DataSyncListStatus;t.DataSyncListStatusError=i.DataSyncListStatusError;t.DataSyncListStatusAttentionReason=i.DataSyncListStatusAttentionReason;var s,o=["isConflict"];t.getConflictErrorDetailContents=function(e){var t=function(t){if(e.hasOwnProperty(t)&&!o.find(function(e){return e===t}))return{value:{key:t,value:e[t]}}};for(var n in e){var r=t(n);if("object"==typeof r)return r.value}};(function(e){e[e.Unspecified=0]="Unspecified";e[e.ListQuickEdit=1]="ListQuickEdit"})(t.DataSyncOperationType||(t.DataSyncOperationType={}));t.getDataSyncClient=function(e,t){return r.isDataSyncEnabled(t)?s||(s=new n.NucleusDataSyncClient({aadUserId:e,featureCheck:t})):void 0}});
define("_We",["require","exports","ww","ga","fWe","k"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NucleusMySiteDiscoveryFlight={ODB:60046};t.DiscoveryExtensionMessages={startRefresh:"NUCLEUS_FORCE_REFRESH",refreshComplete:"NUCLEUS_REFRESH_COMPLETE"};var o="nucleus.installed";function u(){return!!window.sessionStorage.getItem(o)&&"true"!==window.localStorage.getItem("nucleus.noExtension")}t.discoveryGraphUrl="https://graph.microsoft.com/v1.0/me/drive";var a=(function(){function e(e){var t,n,r;this._getAuthToken=void 0;this._discoveryTimeoutMs=(null===(t=e)||void 0===t?void 0:t.timeoutPeriodMs)||1e4;this._sleepBetweenRetriesMs=(null===(n=e)||void 0===n?void 0:n.sleepBetweenRetriesMs)||100;this._featureCheck=(null===(r=e)||void 0===r?void 0:r.featureCheck)||function(){return!0};this._id=Date.now();i.log("Initialized discovery instance: "+this._id)}e.prototype.registerAuthTokenCallback=function(e){this._getAuthToken||(this._getAuthToken=e)};e.prototype.refreshNucleusUrl=function(e){var t=this;i.log("Attempting to discover endpoint for user "+i.Private(e)+", instance="+this._id);if(!u()&&!this._getAuthToken){i.log("Plugin not installed & token callback not registered. Can't do discovery.");return Promise.resolve(void 0)}return u()?this._performDiscoveryWithExtension(e).then(function(n){return n||t._performDiscoveryWithMySite(e)}).catch(function(n){return t._performDiscoveryWithMySite(e)}):this._performDiscoveryWithMySite(e)};e.prototype._performDiscoveryWithMySite=function(e){return n.__awaiter(this,void 0,void 0,function(){var e,r,s,o,u,a,f,l,c,h,p,d=this;return n.__generator(this,function(n){switch(n.label){case 0:if(!this._getAuthToken||!this._featureCheck(t.NucleusMySiteDiscoveryFlight)){i.log("MySite discovery not available");return[2,void 0]}i.log("Resolving endpoint via mysite.");n.label=1;case 1:n.trys.push([1,14,,15]);return[4,this._getAuthToken(t.discoveryGraphUrl)];case 2:if(!(e=n.sent())){i.log("Can't get auth token for "+t.discoveryGraphUrl);return[2,void 0]}return[4,fetch(t.discoveryGraphUrl,{headers:{Authorization:"Bearer "+e,Accept:"application/json, text/plain, */*"},method:"GET"})];case 3:return[4,n.sent().json()];case 4:if(!(r=n.sent())||!r.webUrl){i.log("Failed to parse graph response: "+i.Private(function(){return JSON.stringify(r)}));return[2,void 0]}i.log("Graph root response: "+i.Private(function(){return JSON.stringify(r)}));s=r.webUrl.substring(0,r.webUrl.lastIndexOf("/")+1)+"_api/web/lists/GetByTitle('microsoft.ListSync.Endpoints')/items";i.log("Endpoint list url: "+i.Private(s));return[4,this._getAuthToken(s)];case 5:if(!(o=n.sent())){i.log("Can't get auth token for "+s);return[2,void 0]}return[4,fetch(s,{headers:{Authorization:"Bearer "+o,Accept:"application/json;odata=verbose"},method:"GET"})];case 6:return[4,n.sent().json()];case 7:if(!(u=n.sent())||!u.d||!u.d.results){i.log("Failed to parse list response: "+i.Private(function(){return JSON.stringify(u)}));return[2,void 0]}i.log("Endpoint list response: "+i.Private(function(){return JSON.stringify(u)}));a=u.d.results.map(function(e){return e.EndpointData.length>0?JSON.parse(e.EndpointData):void 0});f=a.map(function(e){return e&&{request:d._fetchSyncLists(e),endpoint:e}});l=0,c=f;n.label=8;case 8:if(!(l<c.length))return[3,13];if(!(h=c[l]))return[3,12];n.label=9;case 9:n.trys.push([9,11,,12]);return[4,h.request];case 10:return 200===n.sent().status?[2,h.endpoint]:[3,12];case 11:n.sent();return[3,12];case 12:l++;return[3,8];case 13:return[2,void 0];case 14:p=n.sent();i.log("MySite discovery failed: "+p+" ");return[2,void 0];case 15:return[2]}})})};e.prototype._fetchSyncLists=function(e){return fetch(e.url+"/Sync/Lists",{headers:{Authorization:e.authToken,Accept:"application/json","Content-Type":"application/json"},method:"GET"})};e.prototype._performDiscoveryWithExtension=function(e){var n=this;if(!u()||s.Killswitch.isActivated("8a8a00e8-087d-47c4-986e-045d4f15fca4","10/08/2020","Discovery via extension killswitch"))return Promise.resolve(void 0);i.log("Resolving endpoint via extension.");return new Promise(function(s,o){var u=new r.EventGroup(window),a=!1,f=new Date,l=function(){var r={type:t.DiscoveryExtensionMessages.startRefresh,messageData:{user:e,msgid:n._id}};if(!a){i.log("Posting message to plugin: "+i.Private(function(){return JSON.stringify(r)})+", time: "+(new Date).toISOString()+", instance="+n._id);window.postMessage(r,"*")}};u.on(window,"message",function(e){if(!a&&(function(e){return(!e||e.source===window||null===e.source)&&(e&&e.data&&e.data.type===t.DiscoveryExtensionMessages.refreshComplete)})(e)){var r=e.data.messageData;i.log("Got response from plugin: "+i.Private(function(){return JSON.stringify(e.data)})+" after "+(Date.now()-f.getTime())+"ms, instance="+n._id);if(e.data.msgid&&e.data.msgid!==n._id)i.log("Got expired msg, ignoring. instance="+n._id);else if(r&&r.retry&&!a){i.log("Discovery queuing postMessage for instance="+n._id);setTimeout(l,n._sleepBetweenRetriesMs)}else{i.log("Discovery disposing events instance="+n._id);u.dispose();a=!0;s(r&&r.success&&r.user&&r.endpointData?r.endpointData:void 0)}}},!1);l();setTimeout(function(){if(!a){a=!0;o("Timed out refreshing endpoint information after waiting "+n._discoveryTimeoutMs+"ms, instance="+n._id);u.dispose()}},n._discoveryTimeoutMs)})};return e})();t.NucleusDiscovery=a});
define("uWe",["require","exports","fWe","k"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataSyncListViewApiRedirectionFeature={ODB:1686};t.DataSyncListFieldApiRedirectionFeature={ODB:60072};t.EnableNucleusRenderListFilterDataRedirection={ODB:1833};var i=!1;t.setIgnoreDisabledRoutes=function(e){i=e};var s,o,u=function(){return i},a=r.Killswitch.isActivated("d4dfd3ef-72de-45a2-bb9f-487384f16b7c","09/29/2020","check the toLower of the chunk"),f=r.Killswitch.isActivated("81c85944-14d4-4da1-b071-c3e722ffa1e8","10/13/2020","check for search redirection capability");(function(e){e[e.None=0]="None";e[e.InSync=1]="InSync";e[e.ChangesSaved=2]="ChangesSaved";e[e.Syncing=3]="Syncing";e[e.Attention=4]="Attention";e[e.SyncConflict=5]="SyncConflict";e[e.SettingUp=6]="SettingUp";e[e.Unsupported=7]="Unsupported";e[e.Removed=8]="Removed";e[e.Error=9]="Error";e[e.ListStatusConnectionLost=10]="ListStatusConnectionLost";e[e.ListStatusConnected=11]="ListStatusConnected"})(t.DataSyncListStatus||(t.DataSyncListStatus={}));(function(e){e[e.UnknownError=0]="UnknownError"})(t.DataSyncListStatusError||(t.DataSyncListStatusError={}));(function(e){e[e.SetupRequired=0]="SetupRequired";e[e.SignInRequired=1]="SignInRequired"})(t.DataSyncListStatusAttentionReason||(t.DataSyncListStatusAttentionReason={}));(function(e){e.Create="Create";e.Update="Update";e.Delete="Delete"})(t.ListSyncConflictType||(t.ListSyncConflictType={}));(function(e){e[e.List=1]="List";e[e.ListItem=2]="ListItem";e[e.ListView=3]="ListView";e[e.ListField=4]="ListField"})(s||(s={}));(function(e){e[e.Guid=1]="Guid";e[e.Path=2]="Path"})(o||(o={}));var l={api:{recycle:{isLeaf:!0},ValidateUpdateListItem:{isLeaf:!0}}},c={api:{SetViewXml:{isLeaf:!0,flight:t.DataSyncListViewApiRedirectionFeature}}},h={api:{"%self%":{isLeaf:!0,idType:o.Guid,flight:t.DataSyncListViewApiRedirectionFeature,returns:s.ListItem,api:c.api},Add:{isLeaf:!0,flight:t.DataSyncListViewApiRedirectionFeature}}},p={flight:t.DataSyncListFieldApiRedirectionFeature,api:{DeleteObject:{isLeaf:!0}}},d={api:{RenderListDataAsStream:{isLeaf:!0},RenderExtendedListFormData:{isLeaf:!0},RenderListFilterData:{isLeaf:!0,flight:t.EnableNucleusRenderListFilterDataRedirection},AddValidateUpdateItemUsingPath:{isLeaf:!0},GetItemById:{returns:s.ListItem,idType:o.Guid,api:l.api},items:{idType:o.Guid,returns:s.ListItem,api:l.api},Views:{isLeaf:!0,api:h.api,flight:t.DataSyncListViewApiRedirectionFeature},Fields:{flight:t.DataSyncListFieldApiRedirectionFeature,isLeaf:!0,api:{"%self%":{isLeaf:!0},GetByInternalNameOrTitle:{isLeaf:!0,returns:s.ListField,idType:o.Path,api:p.api},CreateFieldAsXml:{isLeaf:!0}}}}},v={api:{web:{api:{api:{GetList:{returns:s.List,idType:o.Path,api:d.api},GetListUsingPath:{returns:s.List,idType:o.Path,api:d.api},Lists:{api:{"%self%":{returns:s.List,idType:o.Guid,api:d.api},GetListUsingPath:{returns:s.List,idType:o.Path,api:d.api},GetList:{returns:s.List,idType:o.Guid,api:d.api},GetById:{returns:s.List,idType:o.Guid,api:d.api,disabled:a}}}}}.api},"sp.ListHomeItemCollection.GetListHomePersonalLists":{isLeaf:!0},"SP.FavoriteLists.GetListsBy":{isLeaf:!0},"sp.RecentListCollection.GetRecentLists":{isLeaf:!0}}};t.getListOperationFromUrl=function(e,t){var r=new URL(e);n.log("getListOperationFromUrl called for url: "+n.Private(e));var i=e.indexOf("InplaceSearchQuery");if(!f&&navigator.onLine&&i>0)n.log("Detected a search parameter when online, will run query online");else{var l=r.pathname.indexOf("/_api");if(-1!==l){var c=r.hostname;n.log("server: "+n.Private(c));var h=r.pathname.substring(0,l);if(0!==h.length){var p=r.protocol+"//"+c+h;n.log("site: "+n.Private(p));var d=r.pathname.substring(l+"/_api".length);if(0!==d.length){n.log("api: "+d);var g,y,b,w,E=d.split("/"),S=v,x="root";if(!S.disabled||u()){for(var T=function(e){if(0===e.length)return"continue";if(!S.api){n.log("Node "+x+" doesn't have any api when analyzing chunk: "+e);return{value:void 0}}var r=e.match(new RegExp("([^\\(]*)(\\((\\w+=)?(\\S*?)\\)|$)"));if(!r){n.log("Regex match failed against chunk: "+e);return{value:void 0}}var i=r[1],o=r[4],f=!a&&Object.getOwnPropertyNames(S.api).find(function(e){return e.toLowerCase()===i.toLowerCase()});if(!i||!S.api[i]&&!f){n.log("Node "+x+" doesn't have an api matching '"+i+"'"+(a?"":" or '"+f+"'")+" from chunk '"+e+"'");return{value:void 0}}S=S.api[i]||f&&S.api[f];x=i;o&&S.api&&S.api["%self%"]&&(S=S.api["%self%"]);if(S.flight&&!t(S.flight)||S.disabled&&!u()){n.log("Node "+x+" is marked as disabled.");return{value:void 0}}if(S.returns===s.List){w=S.returns;if(o){if(g)throw"Found multiple list identifiers in URL";g=o;y=S.idType;n.log("Found list param '"+g+"' in chunk "+e)}}S.isLeaf&&(b?b+="/"+x:b=x)},N=0,C=E;N<C.length;N++){var k=T(C[N]);if("object"==typeof k)return k.value}if(b){var L=null;if(w)if(g&&void 0!==y){if(g.startsWith("'%7B")&&g.endsWith("%7D'")&&44===g.length)L=g.substr(4,g.length-8);else if(!(L=r.searchParams.get(g))){n.log("Found a list operation but couldn't determine the ID. Param name was: "+g);return}}else if(!(L=r.searchParams.get("listFullUrl"))){n.log("Did not find a list or a list operation. This url is not supported");return}var A=y===o.Path&&L?r.protocol+"//"+r.host+decodeURIComponent(L).replace(/'/g,""):void 0;return{ids:{siteUrl:p,listId:y===o.Guid&&L?m(decodeURIComponent(L)):void 0,listUrl:A},rest:{api:d,method:b}}}n.log("Did not find a list method. This url is not supported")}else n.log("All nodes are disabled.")}else n.log("Did not find an api, this url is not supported")}else n.log("Did not find a site, this url is not supported")}else n.log("Did not find the api marker, this url is not supported")}};function m(e){return e&&e.replace(/guid/,"").replace(/'/g,"").replace(/}/g,"").replace(/{/g,"").toLowerCase()}t.normalizeGuid=m;t.getUserListPreSyncIssues=function(e,t){var r=e.siteUrl,i=e.siteId,s=e.listId,o=e.listUrl,u=e.webId,a=t.syncedLists.find(function(e){var t;return(r||i)&&(!r||r===e.siteUrl)&&(!i||m(i)===m(e.siteId))&&(o||s)&&(!s||m(s)===m(e.listId))&&(!o||(null===(t=e.listUrl)||void 0===t?void 0:t.endsWith(o)))&&(!u||m(u)===m(e.webId))});if(a&&(!a.syncState||!a.syncState.unsynced)){n.log("Found list: "+n.Private(function(){return JSON.stringify(a)}));return a}}});
define("pWe",["require","exports","ww","uWe","hWe","_We","mWe","fWe","k","Q3"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(){function e(e){this.getUserPromise=void 0;this._syncNowRequests={};this._listStatusCallbacks={};this._listStatusCallbackCount=0;this._listNotificationContext={};this.storage=e&&e.storage||new o.NucleusStorage;this.discovery=e&&e.discovery||new s.NucleusDiscovery(n.__assign(n.__assign({},e.discoveryOptions),{featureCheck:e.featureCheck}));this._wsFactory=e&&e.websocketFactory||function(e){return new WebSocket(e)};this._featureCheck=e.featureCheck;this._aadUserId=e.aadUserId}e.prototype.onRequestComplete=function(e){var t=e.httpStatus,n=e.succeeded,r=e.endpoint,i=e.resultCode,s=this._aadUserId,o=r.context;u.log("requestComplete, user "+u.Private(s)+", succeeded: "+n+", status: "+t+" ");n||(o.requestFailed=!0);if("NoConnection"===i||401===t||403===t||404===t){u.log("Forcing refresh, user "+u.Private(s)+", error "+t+" ");o&&(o.shouldRetryLocalRequest=!0);this._resetUserData({url:o.userRoot,authToken:r.authToken});return!1}return!n&&(!t||t>=500&&t<600)};e.prototype.getData=function(e,t,i){var s=n.__assign(n.__assign({},e),{siteId:r.normalizeGuid(e.siteId),listId:r.normalizeGuid(e.listId)});return this._getDataInternal(s,t,i)};e.prototype.getQosInfo=function(){return{dataSyncVersion:"0.1"}};e.prototype.addListStatusCallback=function(e,t,n){if(!t)throw new Error("not yet supported");this.addListStatusCallbackAsync(e,t,n);return this._listStatusCallbackCount};e.prototype.addListStatusCallbackAsync=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var s,o,a,f,l;return n.__generator(this,function(n){switch(n.label){case 0:if(i.isBoundToService())return[2,-1];t=this._normalizeIds(t);s=this._listStatusCallbackCount++;return[4,this._getUser()];case 1:if(!(o=n.sent())){u.logError("Could not subscribe to list changes, user not found");return[2,-1]}if(!(a=this._getUserList(t,o)))return[2,-1];f=this._socketIdFromList(a);this._listStatusCallbacks[s]={callback:e,options:r,listName:f,listId:a};this._connectListNotifications(o,a);l=this._getNotificationPayloadFromState(a,this._listNotificationContext[f]&&this._listNotificationContext[f].lastKnownServerState||a.syncState||{currentlySyncing:!0,unsynced:!1,pendingUploads:0,inInitialSync:!1});e([l]);return[2,s]}})})};e.prototype.removeListStatusCallback=function(e){this._listStatusCallbacks[e]&&delete this._listStatusCallbacks[e]};e.prototype.isListDataSyncEnabled=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:if(i.isBoundToService())return[2,!1];e=this._normalizeIds(e);return[4,this._getUser()];case 1:t=n.sent();return i.isBoundToService()?[2,!1]:[2,!!t&&!!this._getUserList(e,t)]}})})};e.prototype.registerAuthTokenCallback=function(e){this.discovery.registerAuthTokenCallback(e)};e.prototype.refreshLocalEndpointInfo=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);return[4,this._getNucleusUserWorker({forceRefresh:!0})];case 1:e.sent();return[3,3];case 2:e.sent();return[3,3];case 3:return[2]}})})};e.prototype.dismissListSyncIssues=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s,o;return n.__generator(this,function(n){switch(n.label){case 0:if(!this._featureCheck(f.EnableNucleusListConflictsUX)||0===e.length)return[2,Promise.resolve()];u.log("dismissListSyncIssues: "+u.Private(function(){return JSON.stringify(e)}));return[4,this._getUser()];case 1:if(!(t=n.sent()))throw Error("Failed to load user info");r=e[0].listFullUrl;if(e.filter(function(e){return e.listFullUrl!==r}).length>0)throw Error("All issues must belong to the same list");i=t.endpoint;if(!(s=this._getUserList({listFullUrl:r},t,!0)))throw Error("User is not syncing the given list");n.label=2;case 2:n.trys.push([2,4,,5]);return[4,fetch(i.url+"/Sync/Sites/"+s.siteId+"/Lists/"+s.listId+"/ConflictErrors",{headers:{Authorization:i.authToken,Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({action:"dismiss",eTag:e[0].eTag,ids:e.map(function(e){return e.id})})})];case 3:n.sent();return[3,5];case 4:o=n.sent();u.log("dismissListSyncIssues failed: "+o);return[2,void 0];case 5:return[2]}})})};e.prototype.getListSyncIssues=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s,o,a,l;return n.__generator(this,function(c){switch(c.label){case 0:if(!this._featureCheck(f.EnableNucleusListConflictsUX))return[2,Promise.resolve(void 0)];u.log("getListSyncIssues: "+u.Private(function(){return JSON.stringify(e)}));return[4,this._getUser()];case 1:if(!(t=c.sent()))return[2,void 0];r=t.endpoint;if(!(i=this._getUserList(e,t,!0)))return[2,void 0];c.label=2;case 2:c.trys.push([2,4,,5]);return[4,fetch(r.url+"/Sync/Sites/"+i.siteId+"/Lists/"+i.listId+"/ConflictErrors",{headers:{Authorization:r.authToken,Accept:"application/json","Content-Type":"application/json"},method:"GET"})];case 3:s=c.sent();return[3,5];case 4:o=c.sent();u.log("getListSyncIssues failed: "+o);return[2,void 0];case 5:c.trys.push([5,7,,8]);return[4,s.json()];case 6:a=c.sent();return[3,8];case 7:l=c.sent();u.log("Parsing getListSyncIssues failed: error: "+l);return[2,void 0];case 8:u.log("Got conflicts response: "+u.Private(function(){return JSON.stringify(a)}));return[2,a.conflictErrors.map(function(e){return n.__assign(n.__assign({},e),{eTag:a.eTag,listFullUrl:i.listFullUrl||i.listUrl})})]}})})};e.prototype.listHasSyncIssues=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return this._featureCheck(f.EnableNucleusListConflictsUX)?[4,this.getListSyncIssues(e)]:[2,Promise.resolve(!1)];case 1:return[2,!!(t=n.sent())&&t.length>0]}})})};e.prototype.notifyNewListCreated=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,this._triggerListsHomeSyncNow()];case 1:return[2,e.sent()]}})})};e.prototype._getDataInternal=function(e,t,s){return n.__awaiter(this,void 0,void 0,function(){var o,f,l,c,h,p,d,v,m,g,y,b,w,E;return n.__generator(this,function(n){switch(n.label){case 0:o=new Date;f=e.url,l=e.siteId,c=e.listId,h=e.siteUrl;u.log("getData("+u.logTime(o)+") - Bind: "+(i.isBoundToNucleus()?"nucleus":i.isBound()?"spo":"unbound")+", user: "+u.Private(this._aadUserId)+", url: "+u.Private(f)+", siteId: "+u.Private(l)+", siteUrl: "+u.Private(h)+", listId: "+u.Private(c)+" ");if(!(p=(i.isBoundToNucleus()||!i.isBound())&&this._getOperation(e)))return[3,4];n.label=1;case 1:n.trys.push([1,3,,4]);return[4,this._tryCallingLocalEndpoint(p,e,t)];case 2:if(d=n.sent()){if(i.tryBindToNucleus()){u.log("Using local result.Total time "+(Date.now()-o.getTime())+" ms.");return[2,d.result]}u.log("Got local result, but already bound to service.")}else u.log("Could not call local endpoint, trying service.");return[3,4];case 3:v=n.sent();if(i.isBoundToNucleus()){u.logError("Failed nucleus local call");throw v}if(!i.tryBindToService()&&!a.Killswitch.isActivated("6073c371-2ca5-4e7e-acc5-3e3392e99126","09/30/2020","service binding exception"))throw"Error updating service binding.";return[3,4];case 4:u.log("Calling service.");m=new Date;return[4,s()];case 5:g=n.sent();y=new Date;u.log("Service call done after "+(y.getTime()-m.getTime())+" ms.Total request time "+(y.getTime()-o.getTime())+" ms");if(p)for(b in this._listStatusCallbacks)if(this._listStatusCallbacks.hasOwnProperty(b)){w=this._listStatusCallbacks[b];(E=this._listNotificationContext[this._socketIdFromList(w.listId)])&&E.lastKnownServerState&&E.lastKnownServerState.inInitialSync||w.callback([{id:this._listStatusCallbacks[b].listId,state:r.DataSyncListStatus.None,dataRefreshNeeded:!1}])}return[2,g]}})})};e.prototype._tryCallingLocalEndpoint=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var i,s,o,a,f;return n.__generator(this,function(l){switch(l.label){case 0:i=2;s=function(s){var a,f,l,c,h,p,d,v,m;return n.__generator(this,function(n){switch(n.label){case 0:a=new Date;return[4,o._getUserOperationEndpoint(e,t)];case 1:f=n.sent();l=new Date;u.log("Endpoint resolution time: "+(l.getTime()-a.getTime())+" ms");if(!f)return[2,"break"];c=void 0;n.label=2;case 2:n.trys.push([2,4,,5]);h=new Date;u.log("local endpoint call starting at "+u.logTime(h)+".");return[4,r(f)];case 3:p=n.sent();if(!f.context.requestFailed){d=new Date;u.log("Call redirected! elapsed: "+(d.getTime()-h.getTime())+" ms");return[2,{value:{result:p}}]}return[3,5];case 4:v=n.sent();c=v;return[3,5];case 5:m=i-(s+1);if(f.context.shouldRetryLocalRequest&&m>0){u.log("Local call failed. Retrying discovery & request. "+m+" tries remaining.");return[2,"continue"]}u.log("Local call failed, not retrying. Context: "+u.Private(function(){return JSON.stringify(f.context)})+" ");if(c)throw c;return[2,{value:void 0}]}})};o=this;a=0;l.label=1;case 1:return a<i?[5,s(a)]:[3,4];case 2:if("object"==typeof(f=l.sent()))return[2,f.value];if("break"===f)return[3,4];l.label=3;case 3:++a;return[3,1];case 4:return[2]}})})};e.prototype._getNucleusUser=function(e){if(!(e||{}).forceRefresh&&this.getUserPromise)return this.getUserPromise;this.getUserPromise=this._getNucleusUserWorker(e);u.log("Started discovery for user: "+u.Private(this._aadUserId)+" ");return this.getUserPromise};e.prototype._getNucleusUserWorker=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s,o,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T;return n.__generator(this,function(N){switch(N.label){case 0:t=(e||{}).forceRefresh,r=void 0!==t&&t;s=(i=this).storage,o=i.discovery,a=i._aadUserId;u.log("Get nucleus endpoint, user: "+u.Private(a)+", forceRefresh: "+r+" ");if((f=s.getNucleusUserData(a))&&!r){if(f.syncedLists.length>0)return[2,f];u.log("Found user, but synced - lists was empty, refreshing")}N.label=1;case 1:N.trys.push([1,3,,4]);return[4,o.refreshNucleusUrl(a)];case 2:l=N.sent();return[3,4];case 3:c=N.sent();u.logError("Failed discovery: "+c);return[3,4];case 4:if(!l){u.log("No Nucleus endpoint was found for this user");return[2,void 0]}u.log("Calling synced-lists endpoint");N.label=5;case 5:N.trys.push([5,7,,8]);return[4,fetch(l.url+"/Sync/Lists",{headers:{Authorization:l.authToken,Accept:"application/json","Content-Type":"application/json"},method:"GET"})];case 6:h=N.sent();return[3,8];case 7:p=N.sent();u.logError("Error calling synced-lists endpoint: "+p);return[2,void 0];case 8:N.trys.push([8,10,,12]);return[4,h.json()];case 9:d=N.sent();u.log("synced - lists resp: "+u.Private(function(){return JSON.stringify(d)})+" ");v=d.d.results.map(function(e){return e.syncState?e:n.__assign(n.__assign({},e),{syncState:{currentlySyncing:!0,unsynced:!1,pendingUploads:0,refreshNeeded:!1,inInitialSync:!1}})});f={syncedLists:v,endpoint:l};s.updateNucleusUserData(a,f);return[3,12];case 10:m=N.sent();g=u.logError;y="Error parsing synced - lists JSON: "+m+".";b="Payload was: ";w=u.Private;return[4,h.text()];case 11:g.apply(void 0,[y+(b+w.apply(void 0,[N.sent()])+" ")]);return[2,void 0];case 12:for(E=0,S=f.syncedLists;E<S.length;E++){x=S[E];for(T in this._listStatusCallbacks)this._listStatusCallbacks.hasOwnProperty(T)&&this._listStatusCallbacks[T].listName===this._socketIdFromList(x)&&this._connectListNotifications(f,x)}return[2,f]}})})};e.prototype._getOperation=function(e){var t=e.url,i=e.siteId,s=e.listId,o=e.siteUrl;if(!t){if(!o){u.logError("neither URL nor site URL were provided");return}return{operationType:e.operation,ids:{siteId:i,listId:s,siteUrl:o}}}try{var a=r.getListOperationFromUrl(t,this._featureCheck);if(!a||!a.rest)return;a.ids=n.__assign(n.__assign({},a.ids),{siteId:a.ids.siteId||i,listId:a.ids.listId||s,siteUrl:a.ids.siteUrl||o});u.log("Found operation: "+u.Private(function(){return JSON.stringify(a)})+" ");return a}catch(e){u.logError("Failed to parse url with error: "+e);return}};e.prototype._getUser=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,this._getNucleusUser(e)];case 1:return[2,n.sent()];case 2:t=n.sent();u.logError("Failed to get user information: "+t);return[2,Promise.resolve(void 0)];case 3:return[2]}})})};e.prototype._triggerListsHomeSyncNow=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._getUser()];case 1:if(!(e=n.sent())){u.logError("Failed to find user for lists home sync");return[2,!1]}u.log("Sync Lists Home Now: "+u.Private(function(){return JSON.stringify(e.endpoint)}));t=e.endpoint.url+"/Sync/SyncListsHomeNow";return[4,fetch(t,{headers:{Authorization:e.endpoint.authToken,Accept:"application/json","Content-Type":"application/json"},method:"POST"}).catch(function(e){u.logError("Failed to send sync lists home request: "+e);return!1})];case 2:n.sent();return[2,!0]}})})};e.prototype._triggerListSyncNow=function(e,t){var n=t.siteId,r=t.listId;u.log("Sync now: "+u.Private(function(){return JSON.stringify(e.endpoint)})+", List: "+u.Private(r)+", Site: "+u.Private(n));if(r&&n)try{if(this._syncNowRequests[""+(n+r)])u.log("SyncNow already called for this list");else{var i=e.endpoint.url+"/Sync/Sites/"+n+"/Lists/"+r+"/SyncNow";this._syncNowRequests[""+(n+r)]=!0;fetch(i,{headers:{Authorization:e.endpoint.authToken,Accept:"application/json","Content-Type":"application/json"},method:"POST"}).catch(function(e){u.logError("Failed to send syncnow request: "+e)})}}catch(e){u.logError("Failed to send syncnow request: "+e)}};e.prototype._getUserOperationEndpoint=function(e,t){var r,i;return n.__awaiter(this,void 0,void 0,function(){var s,o,a,f,l,c,h,p;return n.__generator(this,function(n){switch(n.label){case 0:s=t.url,o=t.siteUrl;a=e.rest,f=e.ids;return[4,this._getUser()];case 1:return(l=n.sent())?f.listId||f.listUrl?!(c=this._getUserList(f,l))||(null===(r=c.syncState)||void 0===r?void 0:r.inInitialSync)||(null===(i=c.syncState)||void 0===i?void 0:i.unsynced)?l.fromStorage?[4,this._getUser({forceRefresh:!0})]:[3,3]:[3,4]:[3,5]:[2,void 0];case 2:if(!(l=n.sent()))return[2,void 0];c=this._getUserList(f,l);n.label=3;case 3:if(!c){u.log("Found operation, but no synced list.");return[2,void 0]}n.label=4;case 4:if(!c.syncState||c.syncState.inInitialSync){u.log("Can't redirect to this list during initial sync");return[2,void 0]}this._triggerListSyncNow(l,c);n.label=5;case 5:h=new URL(l.endpoint.url);if(a&&s){(p=new URL(s)).pathname=h.pathname+"/SharePoint/_api"+a.api;e.ids.siteUrl&&(p.search=p.search+"&siteUrl="+encodeURIComponent(e.ids.siteUrl))}else{if(!o)return[2,void 0];(p=new URL(o)).pathname=h.pathname+"/SharePoint"+p.pathname}p.protocol="http";p.host=h.host;return[2,{url:p.toString(),authToken:l.endpoint.authToken,context:{userRoot:l.endpoint.url},client:this}]}})})};e.prototype._resetUserData=function(e){var t=this._aadUserId,n=this.storage.getNucleusUserData(t);if(n&&n.endpoint&&n.endpoint.authToken===e.authToken&&n.endpoint.url===e.url){u.log("Resetting user "+u.Private(t)+" ");this.storage.clearNucleusUserData(t);this._shutdownNotifications();delete this.getUserPromise}};e.prototype._shutdownNotifications=function(e){var t=this;if(e)e.forEach(function(e){var n=t._socketIdFromList(e);if(t._listNotificationContext[n]){var r=t._listNotificationContext[n].socket;if(r){r.close();t._listNotificationContext[n].socket=void 0}t._notifyListStateConnectionChanges(e,!1)}});else for(var n in this._listNotificationContext)if(this._listNotificationContext.hasOwnProperty(n)){var r=this._listNotificationContext[n].socket;if(r){r.close();this._listNotificationContext[n].socket=void 0}}};e.prototype._socketIdFromList=function(e){return e.siteId+"-"+e.listId};e.prototype._getNotificationPayloadFromState=function(e,t){return{id:e,state:t.currentlySyncing||t.inInitialSync?r.DataSyncListStatus.Syncing:t.pendingUploads?r.DataSyncListStatus.ChangesSaved:r.DataSyncListStatus.InSync,dataRefreshNeeded:!!t.refreshNeeded}};e.prototype._updateListSyncState=function(e,t,n,r){n=n||this._socketIdFromList(e);r=r||this._listNotificationContext[n];u.log("Notification: "+u.Private(function(){return JSON.stringify(t)}));var i=this._getNotificationPayloadFromState(e,t),s=i.state,o=!r.lastSentClientState||s!==r.lastSentClientState.state;o&&(r.lastSentClientState={id:e,state:s,dataRefreshNeeded:!!t.refreshNeeded});r.lastKnownServerState=t;this._listNotificationContext[n]=r;if(o||t.refreshNeeded){u.log("Notifying listeners of new list state");for(var a in this._listStatusCallbacks)if(this._listStatusCallbacks.hasOwnProperty(a)){var f=this._listStatusCallbacks[a];if(f&&f.listName===n)try{f.callback([i])}catch(e){u.logError("Error sending list notification to callback "+n+": "+e)}}}};e.prototype._handleListStateChangeMessage=function(e,t){var n=this._socketIdFromList(e);u.log("Got list notification for "+u.Private(function(){return JSON.stringify(e)})+", listName: "+n);var r=this._listNotificationContext[n];if(r){var i=JSON.parse(t.data);this._updateListSyncState(e,i,n,r)}};e.prototype._handleListStateChangeError=function(e,t){var n=this;u.log("Hit a list websocket error");this._shutdownNotifications([t]);var r=this._socketIdFromList(t);if(this._listNotificationContext[r]&&this._listNotificationContext[r].reconnectAttempts<15){setTimeout(function(){u.log("Attempting to reconnect websocket, attempts: "+n._listNotificationContext[r].reconnectAttempts);n._connectListNotifications(e,t)},4e3)}else u.logError("Not reconnecting websocket because we hit the max reconnection attempts")};e.prototype._handleListStateConnected=function(e){var t=this._socketIdFromList(e);if(this._listNotificationContext[t]){this._listNotificationContext[t].reconnectAttempts=0;this._notifyListStateConnectionChanges(e,!0)}};e.prototype._notifyListStateConnectionChanges=function(e,t){var n,i=this._socketIdFromList(e);for(var s in this._listStatusCallbacks)if(this._listStatusCallbacks.hasOwnProperty(s)){var o=this._listStatusCallbacks[s];o.listName&&o.listName!==i||(null===(n=o.options)||void 0===n?void 0:n.sendConnectionNotifications)&&o.callback([{id:e,state:t?r.DataSyncListStatus.ListStatusConnected:r.DataSyncListStatus.ListStatusConnectionLost}])}};e.prototype._connectListNotifications=function(e,t){var n=this;if(!t.listId||!t.siteId)throw new Error("Cannot subscribe without list and site id");var r=this._socketIdFromList(t);if(!this._listNotificationContext[r]||!this._listNotificationContext[r].socket){var i=this._getUserList(t,e);if(void 0!==i){u.log("Setting up notifications for "+u.Private(function(){return JSON.stringify(t)}));var s=new URL(e.endpoint.url);s.protocol="ws";s.pathname+="/WebSocket/Sites/"+t.siteId+"/Lists/"+t.listId+"/Notifications";s.search="?authToken="+encodeURIComponent(e.endpoint.webSocketToken);var o=this._wsFactory(s.toString());if(this._listNotificationContext[r]){this._listNotificationContext[r].reconnectAttempts++;this._listNotificationContext[r].socket=o}else this._listNotificationContext[r]={id:t,reconnectAttempts:1,socket:o,lastKnownServerState:i.syncState};o.onopen=function(){n._handleListStateConnected(t)};o.onmessage=function(e){n._handleListStateChangeMessage(t,e)};o.onerror=function(){n._handleListStateChangeError(e,t)}}else u.log("User is not currenctly syncing this list.")}};e.prototype._normalizeIds=function(e){return n.__assign(n.__assign({},e),{listId:e.listId&&r.normalizeGuid(e.listId),siteId:e.siteId&&r.normalizeGuid(e.siteId),webId:e.webId&&r.normalizeGuid(e.webId)})};e.prototype._getUserList=function(e,t,n){if(!this._featureCheck(f.EnableNucleusListConflictsUX))return r.getUserListPreSyncIssues(e,t);var i=e.siteUrl,s=e.siteId,o=e.listId,a=e.listUrl,l=e.webId,c=e.listFullUrl,h=t.syncedLists.find(function(e){var t;return!!c&&c===e.listUrl||(i||s)&&(!i||i===e.siteUrl)&&(!s||r.normalizeGuid(s)===r.normalizeGuid(e.siteId))&&(a||o)&&(!o||r.normalizeGuid(o)===r.normalizeGuid(e.listId))&&(!a||(null===(t=e.listUrl)||void 0===t?void 0:t.endsWith(a)))&&(!l||r.normalizeGuid(l)===r.normalizeGuid(e.webId))});if(h&&(n||!h.syncState||!h.syncState.unsynced)){u.log("Found list: "+u.Private(function(){return JSON.stringify(h)}));return h}};return e})();t.NucleusDataSyncClient=l});
define("hWe",["require","exports","fWe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=void 0;t.canCallNucleus=function(){return!0===r||void 0===r};t.isBound=function(){return void 0!==r};t.isBoundToNucleus=function(){return!0===r};t.isBoundToService=function(){return!1===r};t.tryBindToService=function(){if(void 0===r){n.log("Binding to the SPO service");r=!1}return!r};t.tryBindToNucleus=function(){if(void 0===r){n.log("Binding to the local Nucleus endpoint");r=!0}return r};t.clearNucleusBindingState=function(){n.log("Clearing nucleus bind state");r=void 0}});
define("fWe",["require","exports","fe","Le"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataSyncLogging={ODB:1495};t.log=function(e){return i(e)};t.logError=function(e){return i({msg:e,error:!0})};var i=r.default.isFeatureEnabled(t.DataSyncLogging)?function(e){"string"==typeof e?n.default.verbose(e):e.error?n.default.logError(e.msg):n.default.verbose(e.msg)}:function(e){};t.logToConsoleFlag="sharepoint.datasync.nucleus.logToConsole";var s=window.localStorage.getItem(t.logToConsoleFlag),o=!!s&&"TRUE"===s.toUpperCase();o&&(i=function(e){console.log("[nucleus] "+("string"==typeof e?e:e.msg))});t.Private=o?function(e){return e?"function"==typeof e?e().toString():e.toString():"undefined"}:function(e){return"<PRIVATE>"};t.logTime=function(e){return""+(e||new Date).toISOString()}});
define("mWe",["require","exports","ww","k","fWe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="microsoft.sharepoint.datasync.nucleus",o=function(e){return s+"."+e},u=r.Killswitch.isActivated("5ccad0d8-ee83-477b-9de6-0ce1ecd41797","10/12/2020","Stop using sessionStorage for cached user info."),a=(function(){function e(){}e.prototype.clearNucleusUserData=function(e){i.log("Clearing storage at '"+s+"."+i.Private(e)+"'");u&&sessionStorage.removeItem(o(e));localStorage.removeItem(o(e))};e.prototype.updateNucleusUserData=function(e,t){i.log("Updating storage at '"+s+"."+i.Private(e)+"'. Data: "+i.Private(function(){return JSON.stringify(t)}));var r=n.__assign(n.__assign({},t),{fromStorage:!0,lastUpdate:t.lastUpdate||Date.now()});u&&sessionStorage.setItem(o(e),JSON.stringify(r));localStorage.setItem(o(e),JSON.stringify(r))};e.prototype.getNucleusUserData=function(e){var t=null;u?(t=sessionStorage.getItem(o(e)))||(t=localStorage.getItem(o(e)))&&sessionStorage.setItem(o(e),t):t=localStorage.getItem(o(e));if(t)try{var n=JSON.parse(t);i.log("Retrieved from storage at '"+s+"."+i.Private(e)+"'. Data: "+i.Private(function(){return JSON.stringify(n)}));if(r.Killswitch.isActivated("36534eee-96b8-42b4-940b-05de73f458d2","10/12/2020","Reinstate the endpoint data expiration")&&(!n.lastUpdate||n.lastUpdate+72e5<Date.now())){i.log("User expired");this.clearNucleusUserData(e);return}return n}catch(n){i.log("Error: got bad json at '"+s+"."+i.Private(e)+"'. Data: "+i.Private(t));return}else i.log("No user info for '"+s+"."+i.Private(e)+"'")};return e})();t.NucleusStorage=a});
define("w7",["require","exports","r"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n.createContext(void 0);t.useContextualControlHandlerManager=function(){return n.useContext(r)};t.useContextualControlHandlerCache=function(){return n.useContext(r)};var i=r.Provider;t.ContextualControlHandlerManagerProvider=i});
define("jY",["require","exports","ww","K_","Nb","d3","kb","Xv","SX","AJ","gD","KI","Vb","Ph","R6","J_","RQ","Km","wJ","E8","OJ","CJ","O_","xJ","Kv","IJ","rm","QI","DJ","p3","SJ","yJ","vd","CC","vJ","mJ","Q0","_y","r3","lJ","$Y","VY"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var U=b.asModuleWithRetries(function(){return new Promise(function(t,n){e(["wQ"],t,n)})},{chunkName:"graphaddondeferred"});t.graphAddon=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,b;return n.__generator(this,function(n){switch(n.label){case 0:e(C.asBatch(function(){e(f.graphAddonDataOnly);e(o.registerControlHandler(m.driveItemSetKeyFacet,u.itemSetColumnsControl)(w.driveItemSetColumnsControlHandler));e(o.registerControlHandler(m.driveItemSetKeyFacet,S.sortedItemSetControl)(x.driveItemSortedItemSetControlHandler));e(o.registerControlHandler(i.sharedWithMeItemSetKeyFacet,u.itemSetColumnsControl)(a.sharedWithMeRootItemSetColumnsControlHandler));e(o.registerControlHandler(h.driveItemKeyFacet,p.itemHoverCardControl)(l.driveItemHoverCardControlHandler));e(o.registerControlHandler(m.driveItemSetKeyFacet,g.itemSetPagingControl)(y.driveItemSetPagingControlHandler));e(o.registerControlHandler(h.driveItemKeyFacet,T.moveCopyActionControl)(N.driveItemMoveCopyActionControlHandler));e(r.registerOperationHandler(k.thumbnailTokenKeyFacet,A.getItemsOperation)(L.thumbnailUrlTokenOperationHandler));e(o.registerControlHandler(h.driveItemKeyFacet,d.itemThumbnailControl)(c.driveItemThumbnailControlHandler));e(o.registerControlHandler(h.driveItemKeyFacet,_.itemFileTypeIconControl)(O.specialFolderIconControlHandler));e(o.registerControlHandler(M.specialDriveItemKeyFacet,_.itemFileTypeIconControl)(O.specialFolderIconControlHandler));e(o.registerControlHandler(h.driveItemKeyFacet,D.itemTileControl)(P.specialFolderTileControlHandler));e(o.registerControlHandler(M.specialDriveItemKeyFacet,D.itemTileControl)(P.specialFolderTileControlHandler));e(o.registerControlHandler(h.driveItemKeyFacet,F.defaultClickActionControl)(I.defaultClickActionControlHandler));e(o.registerControlHandler(j.recentRootItemKeyFacet,B.itemsCommandBarControl)(H.itemsCommandBarControlHandler));e(E.graphItemActivityAddon);e(q.graphRecentAddon);e(R.graphSavedForLaterAddon)}));return[4,e(s.waitForPageLoad({waitIndefinitely:!0}))];case 1:n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,U()];case 3:if(!(t=n.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:b=n.sent();e(v.handleError({error:b}));return[3,5];case 5:return[2]}})})}})});
define("AJ",["require","exports","ww","K_","tc","Bc","M7","p3","yX","hX","_X","mX","pX","rX","iX","aX","nX","tX","$J","ZJ","XQ","XJ","QJ","Vb","a4","WJ","KJ","Fx","Nb","GJ","zJ","_y","I6","yJ","my","vO","fY","n4","t4","VJ","HQ","s3","kb","SY","d3","V7","jJ","wI","Cv","BJ","yY","J_","NJ","RJ","dI","EJ","LJ","E8","rm","RQ"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var oe=re.asModuleWithRetries(function(){return new Promise(function(t,n){e(["YQ"],t,n)})},{chunkName:"graphaddondeferred"});t.graphAddonDataOnly=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,re;return n.__generator(this,function(n){switch(n.label){case 0:e(ie.asBatch(function(){e(u.supportFacets({keyFacet:x.driveItemKeyFacet,facets:[x.driveItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,s.canonicalUrlFacet,s.eTagFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:C.driveItemPageKeyFacet,facets:[C.driveItemPageKeyFacet,i.childItemsFacet,i.pageFacet]}));e(u.supportFacets({keyFacet:k.sharedWithMeRootItemKeyFacet,facets:[k.sharedWithMeRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.canonicalUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:L.sharedWithMeItemSetKeyFacet,facets:[L.sharedWithMeItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:A.sharedByMeRootItemKeyFacet,facets:[A.sharedByMeRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.canonicalUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:O.sharedByMeItemSetKeyFacet,facets:[O.sharedByMeItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:M.recentRootItemKeyFacet,facets:[M.recentRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:_.recentItemSetKeyFacet,facets:[_.recentItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:P.savedForLaterRootItemKeyFacet,facets:[P.savedForLaterRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet]}));e(u.supportFacets({keyFacet:Q.commandsItemKeyFacet,facets:[z.addToOneDriveFacet,z.createFolderFacet,z.createLinkFacet,z.deleteFacet,z.downloadFacet,z.inviteFacet,z.moveFacet,z.officeLensFacet,z.renameFacet,z.uploadFacet]}));e(N.graphAddonDriveItemSet);e(r.registerOperationHandler(x.driveItemKeyFacet,u.getItemsOperation)(a.driveItemGetItemsOperationHandler));e(r.registerOperationHandler(te.driveItemVirtualizedPageKeyFacet,u.getItemsOperation)(ne.driveItemVirtualizedPageGetItemsOperationHandler));e(r.registerOperationHandler(T.driveAnalyticsItemKeyFacet,u.getItemsOperation)(f.driveAnalyticsItemGetItemsOperationHandler));e(r.registerOperationHandler(D.specialDriveItemKeyFacet,u.getItemsOperation)(l.specialDriveItemGetItemsOperationHandler));e(r.registerOperationHandler(Y.sharesItemKeyFacet,u.getItemsOperation)(Z.sharesItemGetItemsOperationHandler));e(r.registerOperationHandler(C.driveItemPageKeyFacet,u.getItemsOperation)(c.driveItemPageGetItemsOperationHandler));e(r.registerOperationHandler(k.sharedWithMeRootItemKeyFacet,u.getItemsOperation)(h.sharedWithMeRootItemGetItemsOperationHandler));e(r.registerOperationHandler(L.sharedWithMeItemSetKeyFacet,u.getItemsOperation)(p.sharedWithMeItemSetGetItemsOperationHandler));e(r.registerOperationHandler(A.sharedByMeRootItemKeyFacet,u.getItemsOperation)(d.sharedByMeRootItemGetItemsOperationHandler));e(r.registerOperationHandler(O.sharedByMeItemSetKeyFacet,u.getItemsOperation)(v.sharedByMeItemSetGetItemsOperationHandler));e(r.registerOperationHandler(M.recentRootItemKeyFacet,u.getItemsOperation)(m.recentRootItemGetItemsOperationHandler));e(r.registerOperationHandler(P.savedForLaterRootItemKeyFacet,u.getItemsOperation)(g.savedForLaterRootItemGetItemsOperationHandler));e(r.registerOperationHandler(_.recentItemSetKeyFacet,u.getItemsOperation)(y.recentItemSetGetItemsOperationHandler));e(r.registerOperationHandler(H.savedForLaterItemSetKeyFacet,u.getItemsOperation)(b.savedForLaterItemSetGetItemsOperationHandler));e(r.registerOperationHandler(B.searchItemSetKeyFacet,u.getItemsOperation)(S.searchItemSetGetItemsOperationHandler));e(u.supportFacets({keyFacet:j.driveFollowedItemKeyFacet,facets:[s.isFollowedFacet]}));e(r.registerOperationHandler(j.driveFollowedItemKeyFacet,u.getItemsOperation)(E.driveFollowItemGetItemsOperationHandler));e(r.registerOperationHandler(F.driveActivityItemKeyFacet,u.getItemsOperation)(w.driveActivityItemGetItemsOperationHandler));e(r.registerOperationHandler(Q.commandsItemKeyFacet,u.getItemsOperation)(I.commandsGetItemsOperationHandler));e(U.registerControlHandler(x.driveItemKeyFacet,R.openActionControl)(q.openActionControlHandler));e(U.registerControlHandler(se.driveItemSetKeyFacet,R.openActionControl)(q.openActionControlHandler));e(U.registerControlHandler(_.recentItemSetKeyFacet,X.filteredItemSetControl)(V.recentRootItemSetFilteredItemSetControlHandler));e(U.registerControlHandler(_.recentItemSetKeyFacet,$.itemsViewControl)(K.itemsViewControlHandler));e(U.registerControlHandler(_.recentItemSetKeyFacet,J.itemsViewLayoutsControl)(K.itemsViewLayoutsControlHandler));e(ee.graphFileHandlerAddon)}));return[4,e(W.waitForPageLoad({waitIndefinitely:!0}))];case 1:n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,oe()];case 3:if(!(t=n.sent().graphAddonDataOnlyDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:re=n.sent();e(G.handleError({error:re}));return[3,5];case 5:return[2]}})})}})});
define("YQ",["require","exports","ww","K_","kb","Vb","x8","i0","f0","D8","q0","u0","a0","Lv","wv","R_","UY","TY","PY","OY","CY","xY","IY","DY","gY","bY","hY","_Y","aF","ZU","n4","mY","B_","sI","pY","RQ","fY","V7","uY","Jx","dY","v8","cY","Is","Ki","d3","E8","t4","Ls","XQ","rm","M9","JQ"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var Z=V.asModuleWithRetries(function(){return new Promise(function(t,n){e(["./handlers/operations/driveItem/deleteItemsBatchedOperationHandler"],t,n)})},{chunkName:"addon-graph-deferredoperations"});t.graphAddonDataOnlyDeferred=r.createAddon(function(){return function(e){var t=e(z.readConfiguration({useBatchedDeleteConfiguration:W.useBatchedDeleteConfigurationFacet})).useBatchedDeleteConfiguration;e(Q.asBatch(function(){e(i.registerControlHandler(H.driveItemSetKeyFacet,D.itemsViewSearchControl)(P.driveItemSearchControlHandler));e(i.registerControlHandler(B.searchItemSetKeyFacet,D.itemsViewSearchControl)(P.searchItemSearchControlHandler));e(i.registerControlHandler(H.driveItemSetKeyFacet,j.filteredItemSetControl)(F.driveItemSetFilteredItemSetControlHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,o.createFolderOperation)(m.driveItemCreateFolderOperationHandler));e(t?r.registerOperationHandler(s.driveItemKeyFacet,u.deleteItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(X.waitForPageLoad())];case 1:t.sent();return[4,Z()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):r.registerOperationHandler(s.driveItemKeyFacet,u.deleteItemsOperation)(g.driveItemDeleteItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,a.renameItemOperation)(y.driveItemRenameItemOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,f.uploadItemsOperation)(b.driveItemUploadItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,I.moveCopyItemsOperation)(q.driveItemMoveCopyItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,G.addToOneDriveOperation)(Y.addToOneDriveOperationHandler));e(i.registerControlHandler(s.driveItemKeyFacet,l.createFolderActionControl)(w.driveItemCreateFolderActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,R.createFolderDialogControl)(U.driveItemCreateFolderDialogControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,c.renameActionControl)(E.driveItemRenameItemActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,h.deleteActionControler)(S.driveItemDeleteItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,p.uploadItemsActionControl)(x.driveItemUploadItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,L.shareLinkActionControl)(N.driveItemDefaultShareLinkControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,A.permissionInviteActionControl)(k.driveItemPermissionGrantControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,d.downloadItemsActionControlFacet)(T.driveItemDownloadItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,v.followItemActionControl)(C.driveItemfollowItemActionControlHandler));e(r.registerOperationHandler(O.driveFollowedItemKeyFacet,_.followItemOperation)(M.driveItemFollowItemOperationHandler));e(r.registerOperationHandler($.driveActivityItemKeyFacet,J.getItemsOperation)(K.driveActivityItemGetItemsOperationHandler))}))}})});
define("wQ",["require","exports","K_","Q0","F1","kb","FY","YQ","Fx","BQ","Nb","O_","NQ","s3","C_","FQ","UQ","TQ","PQ","MQ","kQ","rm","LQ","Ls","EQ"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphAddonDeferred=n.createAddon(function(){return function(e){e(E.asBatch(function(){e(u.graphAddonDataOnlyDeferred);e(s.registerControlHandler(a.sharedWithMeRootItemKeyFacet,r.itemsCommandBarControl)(f.sharedWithMeCommandBarControlHandler));e(s.registerControlHandler(a.sharedWithMeRootItemKeyFacet,i.itemsContextMenuControl)(o.sharedWithMeContextMenuControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,c.sortedItemSetControl)(h.sharedWithMeSortedItemSetControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,p.openActionControl)(v.sharedWithMeItemSetOpenActionControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,d.groupedItemSetControl)(m.sharedWithMeGroupedItemSetControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,d.unGroupedItemSetControl)(g.sharedWithMeUngroupedItemSetControlHandler));e(s.registerControlHandler(y.groupBySharedByKeyFacet,p.openActionControl)(b.groupBySharedByOpenActionControlHandler));e(s.registerControlHandler(y.groupByRelativeTimeKeyFacet,p.openActionControl)(w.groupByRelativeTimeOpenActionControlHandler));e(n.registerOperationHandler(S.topCollaboratorSetKeyFacet,x.getItemsOperation)(T.peopleGetItemsOperationHandler))}))}})});
define("WJ",["require","exports","ww","K_","tc","p3","qJ","RQ","rm"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphAddonDriveItemSet=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(a.asBatch(function(){e(s.supportFacets({keyFacet:u.driveItemSetKeyFacet,facets:[u.driveItemSetKeyFacet,i.childItemsFacet]}));e(r.registerOperationHandler(u.driveItemSetKeyFacet,s.getItemsOperation)(o.driveItemSetGetItemsOperationHandler))}));return[2]})})}})});
define("CJ",["require","exports","ww","K_","kb","Vb","v2","d3"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphItemActivityAddon=r.createAddon(function(){return function(t){t(i.registerControlHandler(s.driveItemKeyFacet,o.itemActivityFieldControl)(i.createDeferredControlHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(u.waitForPageLoad())];case 1:n.sent();return[4,new Promise(function(t,n){e(["AQe"],t,n)})];case 2:return[2,n.sent().driveItemActivityFieldControlHandler]}})})})))}})});
define("$Y",["require","exports","K_","kb","Xv","I6","cJ","_y","Q0","sJ","iJ","F1","s3","aJ","nJ","eJ"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphRecentAddon=n.createAddon(function(){return function(e){e(r.registerControlHandler(s.recentItemSetKeyFacet,i.itemSetColumnsControl)(o.recentItemSetColumnsControlHandler));e(r.registerControlHandler(u.recentRootItemKeyFacet,a.itemsCommandBarControl)(f.recentCommandBarControlHandler));e(r.registerControlHandler(u.recentRootItemKeyFacet,c.itemsContextMenuControl)(l.recentContextMenuControlHandler));e(r.registerControlHandler(p.recentGroupKeyFacet,h.openActionControl)(d.recentGroupOpenActionControlHandler));e(v.recentRootItemEngagementAddon)}})});
define("VY",["require","exports","K_","kb","H1","Xv","JY","nd","qY","KY","V1","zY","vO","my","mJ","Q0"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphSavedForLaterAddon=n.createAddon(function(){return function(e){e(r.registerControlHandler(h.savedForLaterItemSetKeyFacet,u.itemSetDetailsListControl)(a.savedForLaterRootItemSetDetailsListControlHandler));e(r.registerControlHandler(h.savedForLaterItemSetKeyFacet,i.itemSetTilesListControl)(f.savedForLaterRootItemSetTilesListControlHandler));e(r.registerControlHandler(h.savedForLaterItemSetKeyFacet,s.itemSetColumnsControl)(o.savedForLaterRootItemSetColumnsControlHandler));e(r.registerControlHandler(h.savedForLaterItemSetKeyFacet,l.emptyFolderControl)(c.emptyFolderControlHandler));e(r.registerControlHandler(p.savedForLaterRootItemKeyFacet,v.itemsCommandBarControl)(d.itemsCommandBarControlHandler))}})});
define("hN",["require","exports","ww","yN","bN"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("yN",["require","exports","SN","M9","Z_"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveWithProgress=i.implementOperationWithProgress({operationTypeFacet:r.addToOneDriveOperation,progressKeyFacet:r.addToOneDriveProgressKeyFacet,initializeBatch:function(){return n.addToOneDriveProgressAddon}})});
define("bN",["require","exports","Z_","gN","P7"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromOneDriveWithProgress=n.implementOperationWithProgress({operationTypeFacet:i.removeFromOneDriveOperation,progressKeyFacet:i.removeFromOneDriveProgressKeyFacet,initializeBatch:function(){return r.removeFromOneDriveProgressAddon}})});
define("DN",["require","exports","ww","r","yL","To","Mc","bc","jo","M9","Wv","Es","Rs","IN"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRetryReplaceShortcutProgressAction=l.createItemCacheComponent(function(e,t){var u=t.itemKeys,l=t.existedDescendants,d=u.filter(function(t){var n=e.demandItemFacet(c.errorFacet,t);if(n&&n instanceof h.ItemOperationError){if(p.nestedDescendantShortcutExistsFacet.unpack(n.facets))return!0}return!1}),v=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){v(a.resolveItems({items:s.makeObject(d,function(){return f.addToOneDriveOperation.pack({replaceShortcut:l})})}));v(i.retryProgressItems({items:s.makeObject(d,function(){return{}})}));return[2]})})},isAvailable:d.length>0})});t.RetryReplaceShortcutProgressAction=u.withSelectedItems()(t.ItemRetryReplaceShortcutProgressAction)});
define("uJ",["require","exports","r","aY","qi","Bc","Tc","_0","fJ"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeOnlineDefaultClickActionHandler={key:new i.Facet("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var i=t.itemKey,f=e.demandItem({openUrl:s.openUrlFacet,appMap:r.officeAppFacet},i),l=f.openUrl,c=f.appMap;return{action:!!l&&!!c?n.createElement(u.ItemShowMalwareDetectedAction,{itemKey:i,action:o.evaluateAction(e,n.createElement(a.ItemOpenInOfficeOnlineAction,{itemKey:i}))}):void 0}}}});
define("fJ",["require","exports","ww","HD","Wv","Mc","Bc","bc","Ac","pJ","cc","aY"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemOpenInOfficeOnlineAction=i.connectToItemCache(function(e,t){var i=t.itemKey,s=e.demandItem({openUrl:o.openUrlFacet,appFacet:c.officeAppFacet,isMalwareDetected:o.malwareDetectedFacet},i),u=s.openUrl,h=s.appFacet,p=s.isMalwareDetected,d=e.dispatch,v=!p&&!!h&&!!u,m=e.demandItemFacet(f.openInOfficeOnlineActionControl,i);return n.__assign({isAvailable:v,onExecute:u?function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){e=(new Date).getTime().toString();t=r.WopiHelper.AddWopiPerfMarkToTargetUrl(e,"ItemsView",u);d(l.readItems(function(e){return f.openInOfficeOnlineActionControl.evaluate(m)(e,{itemKey:i,forceInSameWindow:!1})})).forceInSameWindow?window.location.href=t:window.open(t);return[2]})})}:void 0},a.getItemActionEngagement(e,{itemKey:i,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(s.Action);t.OpenInOfficeOnlineAction=u.withSelectedItems()(u.withExactlyOneItem()(t.ItemOpenInOfficeOnlineAction))});
define("oU",["require","exports","ww","r","Wv","UI","mo","Wv","Mc","Ac","Tc","VI","Jk","Ki","Zv","$k","b3","UI","cc","bc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UniversalPrintWizard=m.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["@ms/shared-react-universal-print/lib/components/UniversalPrint/UniversalPrint"],t,n)})];case 1:return[2,t.sent().UniversalPrint]}})})});t.ItemPrintToUniversalPrinterAction=u.createItemCacheComponent(function(e,i){var s=i.itemKey,o=i.getPrintFileItem,u=void 0===o?g.getPrintFileUrlItem:o;if(!s)return null;var m=e.dispatch,b=e.demandItemFacet(c.printToUniversalPrinterActionControl,s),w=d.getConfiguration(e,{graphEndpoint:p.graphEndpointConfigurationFacet}).graphEndpoint;if(!w)return null;var E=c.printToUniversalPrinterActionControl.evaluate(b)(e,{itemKey:s,isAvailable:!1}),S=E.isAvailable,x=E.fileType,T=E.fileDisplayName,N=E.pdfUrlGenerator;if(!T||!x)return null;var C=function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:return u?[4,m(u({items:(t={},t[s]={pdfUrlGenerator:N},t)}))]:[3,2];case 1:n.sent();if(e=m(y.readItems(function(e){return e.demandItemFacet(g.universalPrintGetFileUrlItemFacet,s)})))return[2,e];n.label=2;case 2:throw new Error("Failed to fetch Print File data")}})})},k=l.renderComponentOnExecute(function(e){var i=e.resolve,s=m(h.getDataRequestor).dataRequestor;return r.createElement(t.UniversalPrintWizard,{endpoint:w,onClose:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){i();return[2]})})},fileDisplayName:T,fileType:x,getPrintFileData:C,dataRequestor:s,getPrintAuthToken:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,m(v.getAuthToken(["PrinterShare.Read.All","PrintJob.ReadWrite"],w||""))];case 1:if(e=t.sent())return[2,{accessToken:e}];throw new Error("Failed to fetch Print Graph Access Token")}})})}})});return r.createElement(a.Action,n.__assign({isAvailable:S,onExecute:k},f.getItemActionEngagement(e,{itemKey:s,engagement:{name:"PrintToUniversalPrinter",isIntentional:!0}})))});var w=o.createAsyncActionCreator(function(e){return function(t){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(s.getPrintFileUrlItem(e))];case 1:return[2,n.sent()]}})})}});t.PrintToUniversalPrinterAction=i.connectToItemCache(function(){return{getPrintFileItem:w}})(b.withSelectedItems()(b.withExactlyOneItem()(t.ItemPrintToUniversalPrinterAction)))});
define("zQ",["require","exports","ww","r","H","Md","IL","Z_","zU","Bc","qQ","WQ","KQ","GQ","Wv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,u=t.resolve,a=t.reject,f=t.onItemRemoved,l=t.itemKeys,p=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:u();return[4,f()];case 1:e.sent();return[2]}})})},d=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){a(new i.CancelError);return[2]})})};return r.createElement(s.WithItemCache,null,function(e){var t=e.itemCache,n=m(t,l),i=n.title,s=n.prompt;return r.createElement(o.ConfirmationDialog,{onCancel:d,onConfirm:p,yesText:h.default.removeFromSharedListConfirmButtonText,noText:c.default.removeFromSharedListCancelButtonText,defaultToYes:!0,title:i,prompt:s})})};return t})(r.PureComponent),m=function(e,t){if(t.length>1)return{title:c.default.itemsTitleWithAccess,prompt:c.default.itemsSubTextWithAccess};if(1===t.length){var n=e.demandItemFacet(f.folderFacet,t[0]);return{title:n?c.default.folderTitleWithAccess:c.default.fileTitleWithAccess,prompt:n?c.default.folderSubTextWithAccess:c.default.fileSubTextWithAccess}}return{title:"",prompt:""}},g=u.implementOperationWithProgress({operationTypeFacet:a.removeItemsFromSharedListOperation,progressKeyFacet:a.removeFromSharedListProgressKeyFacet,initializeBatch:function(){return p.removeFromSharedListProgressAddon}});t.RemoveFromSharedListAction=d.connectToItemCache(function(){return{removeFromSharedListWizard:v,removeItemsFromSharedList:g}})(l.RemoveFromSharedListBaseAction)});
define("qQ",["require","exports","ww","r","Wv","Vs","To","Tc","Mc","bc","cM","zU","Ac","Nb","k"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRemoveFromSharedAction=i.createItemCacheComponent(function(e,t){var i=t.itemKeys,f=t.removeFromSharedListWizard,v=t.removeItemsFromSharedList,m=void 0===v?c.removeItemsFromSharedList:v,g=s.getCurrentItemSetKey(e)||"",y=e.demandItemFacet(p.sharedWithMeItemSetKeyFacet,g);if(0===i.length)return null;for(var b=y&&i.length<=200,w=f,E=0,S=i;E<S.length;E++){var x=S[E],T=e.demandItemFacet(l.removeFromSharedActionListControl,x),N=!d.Killswitch.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");l.removeFromSharedActionListControl.evaluate(T)(e,{itemKey:x,isAvailable:N}).isAvailable||(b=!1)}var C=e.dispatch,k=function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e={itemSetKey:g};t=o.makeObject(i,function(){return e});return[4,C(m({items:t}))];case 1:n.sent();return[2]}})})},L=u.renderComponentOnExecute(function(e){return r.createElement(w,n.__assign({},e,{onItemRemoved:k,itemKeys:i}))});return r.createElement(a.Action,n.__assign({isAvailable:b,onExecute:L},h.getItemActionEngagement(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:i.length}}})))});t.RemoveFromSharedListBaseAction=f.withSelectedItems()(t.ItemRemoveFromSharedAction)});
define("QQ",["require","exports","qi","r","d8","u8"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addShortcutFromSharedWithMeCommand={action:r.createElement(s.AddToOneDriveAction,null),automationId:"addShortcutFromSharedWithMeCommand",title:i.default.AddShortcutFromSharedWithMeTooltip,iconProps:{iconName:"FabricFolderLink"},key:new n.Facet("AddShortcutFromSharedWithMe").id,name:i.default.AddShortcutFromSharedWithMe}});
define("jQ",["require","exports","Ng","qi","r","d8","c8"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeShortcutFromSharedWithMeCommand={action:i.createElement(n.ShowOnlyWithSelection,null,i.createElement(o.RemoveFromOneDriveAction,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:s.default.RemoveShortcutFromSWMTooltip,iconProps:{iconName:"FabricFolderLink"},key:new r.Facet("RemoveShortcutFromSWM").id,name:s.default.RemoveShortcutFromSWM}});
define("hJ",["require","exports","ww","r","qi","Mg","fJ"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeOnlineCommand={key:new i.Facet("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:r.createElement(o.OpenInOfficeOnlineAction,null),facets:n.__assign({},s.isReadonlyFacet.pack(!0))}});
define("_J",["require","exports","ww","r","Mg","M0","bJ","hJ"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openFileCommand={key:s.openCommand.key,automationId:s.openCommand.automationId,subMenuProps:{items:[u.openInOfficeOnlineCommand]},onRender:function(e){return r.createElement(o.OpenCommandButton,n.__assign({},e,{menuProps:e.subMenuProps}))},facets:n.__assign({},i.isReadonlyFacet.pack(!0))}});
define("rJ",["require","exports","oJ","d8"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openFileLocationCommand={key:"OpenFileLocation",name:r.default.OpenFileLocation,title:r.default.OpenFileLocation,action:n.OpenParentFolderAction,iconProps:{iconName:"FabricFolder"}}});
define("iU",["require","exports","r","qi","oU","rU"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.printToUniversalPrinterCommand={key:new r.Facet("universalPrint").id,automationId:"universalPrintCommand",action:n.createElement(i.PrintToUniversalPrinterAction,null),name:s.default.printToUniversalPrinter,title:s.default.PrintToUniversalPrinterTooltip,iconProps:{iconName:"Print"}}});
define("VQ",["require","exports","r","qi","Ng","zQ","d8"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromSharedListCommand={key:new r.Facet("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:o.default.removeFromSharedList,title:o.default.removeFromSharedListTooltip,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.RemoveFromSharedListAction,null)),iconProps:{iconName:"Cancel"}}});
define("xX",["require","exports","ww","r","pc","od","Oe","Hf","CX","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";f=f.TopCollaborator_8;Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,i=r.createElement(s.Icon,{className:f.topCollaboratorIcon,iconName:"TeamFavorite"}),l=r.createElement("span",{className:f.topCollaboratorUserName},t),c=r.createElement("div",{className:f.topCollaboratorTooltip},o.formatToArray(a.default.topCollaboratorWith,l));return r.createElement("div",{className:f.topCollaPlaceHolder},n?null:t?r.createElement(u.TooltipHost,{content:c},i):i)};return t})(i.BaseComponent);t.TopCollaborator=l});
define("OX",["require","exports","FS","h2","Wh","iz","w5","ys","_2"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateSharedColumn=i.createColumn({name:r.default.dateSharedColumnHeaderText,key:a.DATE_SHARED_COLUMN_KEY,fieldName:"",minWidth:i.ColumnWidth.regularMin,maxWidth:i.ColumnWidth.regularMax,isCollapsable:!0,sortProps:i.DATE_COLUMN_SORT_PROPS},o.DateField)(function(e,t){var r=e.demandItemFacet(s.sharedFacet,t),i=r&&new Date(r.sharedDateTime).getTime();if("number"!=typeof i||isNaN(i))return{text:""};var o=e.demandItemFacet(u.localeFacet,u.configurationItemKey);return o&&o.language||window.navigator.language?{text:n.getRelativeDateTimeStringPast(new Date(i),!1)}:{dateValue:i}})});
define("ZY",["require","exports","ww","ab","_2"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileTypeIconColumn=n.__assign(n.__assign({},r.fileTypeIconColumn),{key:i.FILE_TYPE_ICON_COLUMN_KEY,minWidth:32,maxWidth:32})});
define("DX",["require","exports","h2","Wh","D5","_2","k6","oY","ZQ","LQ","r","xX","ODBItemsScopeDeferred_mini_css","tc","iz"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";h=h.TopCollaborator_8;Object.defineProperty(t,"__esModule",{value:!0});t.sharedByColumn=r.createColumn({name:n.default.sharedByColumnHeaderText,key:s.SHARED_BY_COLUMN_KEY,fieldName:"",minWidth:r.ColumnWidth.regularMin,maxWidth:r.ColumnWidth.regularMax,isCollapsable:!0,sortProps:r.TEXT_COLUMN_SORT_PROPS,headerClassName:h.columnHeader},i.UserFieldRenderer)(function(e,t){var n=e.demandItem({shareByPerson:u.sharedByPersonFacet},t).shareByPerson,r=e.demandItem({sharedBy:d.sharedFacet},t).sharedBy,i=n&&n.itemKey,s=n&&n.displayValue||r&&r.sharedBy&&r.sharedBy.user&&r.sharedBy.user.displayName,v=!1;if(i&&a.userByEmailKeyFacet.matches(i)){var m=a.userByEmailKeyFacet.deserialize(i).email,g=e.demandItemFacet(p.childItemsFacet,f.topCollaboratorSetKeyFacet.serialize({endpoint:"https://graph.microsoft.com/beta"}));g&&(v=g.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(o.emailFacet,t);return!!n&&n===m}))}return i||s?{people:[{itemKey:i||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return l.createElement("div",{className:h.userWithTopCollaborator},l.createElement(c.TopCollaborator,{userName:r.title,isPlaceholder:!v}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(o.emailFacet,t)})});
define("QY",["require","exports","ww","r","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i){"use strict";i=i.GroupItemDetailsHeader_0;Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?r.createElement("div",{className:i.root},this.props.group.name):null};return t})(r.PureComponent);t.GroupItemDetailsHeader=s});
define("bJ",["require","exports","ww","r","od","m_","aY","qT","ODBItemsScopeDeferred_mini_css","bc","Wv","Bc","hJ","qi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";a=a.OpenCommandButton_8;Object.defineProperty(t,"__esModule",{value:!0});var d=new p.Facet("fileHandlerOpenCommand").id;t.OpenCommandSubMenuItemForContextMenu=f.withSelectedItems()(f.withExactlyOneItem()(l.connectToItemCache(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:o.officeAppFacet},n).appMap,s=r.name;r.key===h.openInOfficeOnlineCommand.key&&(s=s||(i?u.getOfficeOnlineStringMap(i,!0):u.OpenFileStrings.OpenInBrowser));return{name:s}})(function(e){return r.createElement("div",{className:a.contextualMenuItemLinkContent},r.createElement("span",{dir:"auto",className:a.contextualMenuItemTextLabel},e.name))})));t.OpenCommandButton=f.withSelectedItems()(f.withExactlyOneItem()(l.connectToItemCache(function(e,t){var r=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:o.officeAppFacet,fileName:c.fileNameFacet},r),a=s.appMap,f=s.fileName,l={};if(i&&i.items){var p=i.items[0];p&&-1!==p.key.indexOf(d)&&p.iconProps&&(l=p.iconProps)}var m=!!f&&!!f.extension&&".pdf"===f.extension.toLowerCase(),g=a&&u.getOfficeAppLogosMap(a),y={iconName:a?u.getOfficeAppIconNameMap(a):m?"PDF":"OpenFile"},b=void 0;i&&i.items&&(b=i.items.map(function(e){return e.key===h.openInOfficeOnlineCommand.key?n.__assign(n.__assign({},e),{iconProps:y,name:e.name||a&&u.getOfficeOnlineStringMap(a,!0)||(m?u.OpenFileStrings.OpenInBrowser:u.OpenFileStrings.Open),onRenderIcon:g?v.bind(void 0,g,!0):void 0}):e}));return{iconProps:l||y,onRenderIcon:g?v.bind(void 0,g,!1):void 0,text:u.OpenFileStrings.Open,menuProps:b?n.__assign(n.__assign({},i),{items:b}):i}})(s.CommandBarButton)));function v(e,t){return e?r.createElement("span",{className:t?a.menuItemIconContainer:a.iconContainer},r.createElement(i.Icon,{iconName:e.logoFill16,className:a.logoFillIcon}),r.createElement(i.Icon,{iconName:e.logo16,className:a.logoIcon})):null}});
define("lJ",["require","exports","ww","kb","BD","uJ"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultClickActionControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.handlers,o=void 0===r?[]:r;return{handlers:n.__spreadArrays([i.malwareDetectedDefaultClickActionHandler,s.openInOfficeOnlineDefaultClickActionHandler],o)}}}})});
define("mJ",["require","exports","ww","kb","M0","_J"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsCommandBarControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.commands,i=t.overflowCommands,s=t.farCommands,u=i?n.__spreadArrays(i):[],a=r?n.__spreadArrays(r):[],f=s;return{commands:a=o(e,{defaultCommands:a}).overrideDefaultCommands,overflowCommands:u,farCommands:f}}}});function o(e,t){for(var n=[],r=0,o=t.defaultCommands;r<o.length;r++){var u=o[r];u.key===i.openCommand.key?n.push(s.openFileCommand):n.push(u)}return{overrideDefaultCommands:n}}t.getOverrideDefaultCommands=o});
define("VI",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.printToUniversalPrinterActionControl=new n.ControlFacet("PrintToUniversalPrinterActionControl",{})});
define("cM",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromSharedActionListControl=new n.ControlFacet("removeFromShardListActionControl")});
define("CY",["require","exports","kb","vY"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canCreateFolderFacet,n)}}}})});
define("cY",["require","exports","kb","RU"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderDialogControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){return{validator:r.nameValidator}}}})});
define("IY",["require","exports","kb","vY"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDeleteItemsActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canDeleteFacet,n)}}}})});
define("gY",["require","exports","ww","kb","Vb","Jk","Bc","vY","nM","Ms","Q1","nM"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDownloadItemsActionControlHandler=r.createControlHandler()(h);function h(){return function(e){return p}}t.getDownloadItemActionControlHandler=h;function p(e,t){if(1!==t.itemKeys.length)return{};var r=t.itemKeys[0];if(e.demandItemFacet(o.folderFacet,r))return{};var h=e.demandItemFacet(i.driveItemKeyFacet,r),p=h?s.getDriveItemUrl(h):void 0,d=h?s.getDriveUrl(h):void 0,v=h&&h.endpoint||"";return{isAvailable:e.demandItemFacet(u.canDownloadFacet,r),getDownloadData:p&&d?function(){return(function(e){var t=this,r=e.itemUrl,i=e.driveUrl,o=e.endpoint;return function(u){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,u(s.getRawData({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:o}))];case 1:t=n.sent();if(!(h=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(r)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:h}];case 2:if((p=n.sent())instanceof a.GraphError){d=c.getErrorResolution(p,function(e,t){switch(e){case"unauthenticated":case 401:return l.authFailureErrorFacet.pack({});case"itemNotFound":case 404:return l.fileNotFoundErrorFacet.pack({});case"accessDenied":case 403:return l.accessDeniedErrorFacet.pack({});default:return l.offlineErrorFacet.pack({})}});throw new f.ItemOperationError({innerError:p,facets:d})}throw p;case 3:return[2]}})})}})({itemUrl:p,driveUrl:d,endpoint:v})}:void 0}}});
define("hY",["require","exports","kb"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemfollowItemActionControlHandler=n.createControlHandler()(function(){return function(){return function(){return{}}}})});
define("bY",["require","exports","ww","kb","Vb","Jk"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDefaultShareLinkControlHandler=r.createControlHandler()(o);function o(){return function(e){return u}}t.getDefaultShareLinkActionControlHandler=o;function u(e,t){var r=t.itemKey,o=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,u;return n.__generator(this,function(n){switch(n.label){case 0:if(!(t=e.driveItem))return[3,2];i=s.getDriveItemUrl(t)+"/invite";o=s.getDriveUrl(t);return[4,r(s.getRawDataWithCache({url:i,driveUrl:o,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(u=n.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:u.value[0].link.webUrl,scope:u.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:o})}}}});
define("AQe",["require","exports","ww","r","kb","Hge","Vge","Bc","D5","ZQ","Vb"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});function h(e,t){var n=e.activity,i=e.hoverCardElementsPerUser,o=e.personKeyByEmail;if(n){var u,a=(u=n.type,p[u]);return a?new a({activity:n,canOpenItem:function(){return!1},containingItem:{absolutePath:"",isFolder:!1,name:t,graphItemUrl:""},onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),s=e.user,u=s.email||"",a=i[u],f=o[u];return a?r.cloneElement(a,{displayValue:s.displayName,personKey:f,user:s},n):n},currentUserEmail:"",isSingleLevel:!0,onItemClick:function(){},strings:s.default}):void 0}}var p=((c={})[0]=o.EditItemActivity,c[1]=o.MoveItemActivity,c[2]=o.CommentItemActivity,c[3]=o.CommentResponseItemActivity,c[4]=o.MentionItemActivity,c[5]=o.VersionItemActivity,c[6]=o.RestoreItemActivity,c[9]=o.RenameItemActivity,c[10]=o.DeleteItemActivity,c[11]=o.CreateItemActivity,c[12]=o.ShareItemActivity,c);t.driveItemActivityFieldControlHandler=i.createControlHandler()(function(){return function(){return function(e,t){var r=t.itemKey,i=t.activity,s={},o={};if(l.driveItemKeyFacet.matches(r)){var c=l.driveItemKeyFacet.deserialize(r).endpoint,p=i&&i.actors||[],d=i&&i.action,v=d&&d.mention&&d.mention.mentionees||[],m=d&&d.share&&d.share.recipients||[],g=d&&d.commentResponse&&d.commentResponse.commentAuthor,y=n.__spreadArrays(p,v,m);g&&y.push(g);for(var b=0,w=y;b<w.length;b++){var E=w[b];if(E.email){var S=f.userByEmailKeyFacet.serialize({email:E.email,endpoint:c}),x={itemKey:S,displayValue:E.displayName},T=a.getHoverCardElement(e,x).hoverCardElement;s[E.email]=T;o[E.email]=S}}}var N=e.demandItemFacet(u.fileNameFacet,r);return{itemActivity:i&&N&&h({activity:i,hoverCardElementsPerUser:s,personKeyByEmail:o},N.name)}}}})});
define("IJ",["require","exports","kb"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemMoveCopyActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}})});
define("_Y",["require","exports","ww","kb","Vb","Jk"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPermissionGrantControlHandler=r.createControlHandler()(o);function o(){return function(e){return u}}t.getPermissionGrantActionControlHandler=o;function u(e,t){var r=t.itemKey,o=t.link,u=t.recipients,a=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,u,a,f,l,c,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:t=e.driveItem,i=e.link,o=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");u=t.endpoint;f=btoa(i);a="u!"+f.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");l=o.map(function(e){return{email:e}});c={recipients:l,roles:["read"]};h=u.replace("v1.0","beta");p=h+"/shares/"+a+"/permission/grant";return[4,r(s.getRawDataWithCache({url:p,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:c}))];case 1:d=n.sent();v=d.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:v}]}})})}})({driveItem:a,link:o,recipients:u})}}}});
define("xY",["require","exports","kb","RU","vY"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemRenameItemActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(i.canRenameFacet,n),validator:r.nameValidator}}}})});
define("DY",["require","exports","kb","vY"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemUploadItemsActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canUploadFacet,n)}}}})});
define("OJ",["require","exports","kb","E_","C5","ab","v5","_5","S5"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return l}});var f=[s.fileTypeIconColumn,r.displayNameColumn,i.dateModifiedColumn,a.modifiedByColumn,o.fileSizeColumn,u.sharedColumn];function l(e,t){return{columns:f}}});
define("xJ",["require","exports","ww","kb","Zv","E_","RQ","Ki","_2","vD","Vb","_2"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES=c.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES;t.driveItemSortedItemSetControlHandler=r.createControlHandler()(function(){return function(e){return h}});function h(e,t){return p(e,o.driveItemSetKeyFacet,t)}function p(e,t,r){var o=r.itemSetKey,c=r.handler,h=c.columnKey,p=c.isAscending,d=e.demandItemFacet(t,o);if(!d)return{};var v=e.demandItemFacet(f.driveTypeFacet,l.driveItemKeyFacet.serialize(n.__assign({},d.driveItemKey)));if(!v||"business"===v||"documentLibrary"===v)return{};if(!d.sortBy&&h===s.displayNameColumn.key&&!0===p)return{newItemSetKey:o};var m=i.getConfiguration(e,{customColumnKeysToFieldNamesConfiguration:u.customColumnKeysToFieldNamesConfigurationFacet}).customColumnKeysToFieldNamesConfiguration,g=n.__assign(n.__assign({},a.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES),m),y=g?g[h]:void 0;return y?{newItemSetKey:t.serialize(n.__assign(n.__assign({},d),{sortBy:y,isAscending:p}))}:{}}t.getSortedItemSetKey=p});
define("uY",["require","exports","ww","RQ","fY","kb","G7","K7"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetFilteredItemSetControlHandler=s.createControlHandler()(function(){return function(e){return a}});function a(e,t){var s=t.handlers,a=t.itemKey,f=e.demandItemFacet(r.driveItemSetKeyFacet,a),l=e.demandItemFacet(i.searchItemSetKeyFacet,a);if(s&&(f||l)){for(var c=[],h=0,p=s;h<p.length;h++){var d=p[h];if(d.key===u.itemPhotoTypeFilterHandler.key)c.push("photo");else if(d.key===u.itemVideoTypeFilterHandler.key)c.push("video");else if(d.key===u.itemFolderTypeFilterHandler.key)c.push("folder");else if(d.key===u.itemOneNoteFilterHandler.key)c.push("onenote");else if(d.key===u.itemNonPhotoTypeFilterHandler.key)c.push("!photo");else if(d.key===u.itemNonVideoTypeFilterHandler.key)c.push("!video");else if(d.key===u.itemNonFolderTypeFilterHandler.key)c.push("!folder");else if(d.key===u.itemNonOneNoteFilterHandler.key)c.push("!onenote");else{var v=o.getExtensionFilterFromFilterHandler(d);v&&c.push(v)}}if(f)return{itemKey:r.driveItemSetKeyFacet.serialize(n.__assign(n.__assign({},f),{extFilters:c}))}}return{}}});
define("wJ",["require","exports","kb","RQ","nm","EJ","Vb","ys","Ki","lY","vD"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetPagingControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.setItemKey,c=e.demandItemFacet(r.driveItemSetKeyFacet,n);if(!n||!c)return{};var h=c.driveItemKey.endpoint,p=o.driveItemKeyFacet.serialize(c.driveItemKey),d=e.demandItemFacet(l.driveTypeFacet,p),v=e.demandItemFacet(a.driveItemSetPageSizeFacet,u.configurationItemKey)||f.DEFAULT_PAGE_SIZE,m=e.demandItemFacet(a.supportsDriveItemSetRandomAccessFacet,u.configurationItemKey);if(m&&m(h,d)){return{totalItemCount:e.demandItemFacet(i.countFacet,p),getPageKey:function(e,t){return s.driveItemVirtualizedPageKeyFacet.serialize({setItemKey:n,endpoint:c.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:v}}return{}}}})});
define("kQ",["require","exports","kb"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupByRelativeTimeOpenActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}})});
define("MQ",["require","exports","kb"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupBySharedByOpenActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}})});
define("WY",["require","exports","ww","Ug","yh"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemLifeCycleSignalsControlHandler=function(e,t){var s=t.signals;if(s){var o=r.findMatch(s,function(e){return e.key===i.followedSignalKey});if(o&&o.index>-1){var u=o.index;return{signals:n.__spreadArrays(s.slice(0,u),s.slice(u+1))}}}return{}}});
define("KI",["require","exports","kb","Vb","YI","QI","qI","WI","Pe","Bc","eI","N5"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemThumbnailControlHandler=n.createControlHandler()(function(){return function(e){return h}});function h(e,t){var n=t.itemKey,h=t.desiredSize,d=e.demandItemFacet(r.driveItemKeyFacet,n);if(!d)return{};var v=e.demandItemFacet(u.hasThumbnailAuthTokenFacet,n)?(function(e,t){var n=t.itemKey,r=t.desiredSize,s=(function(e){return e&&p(e)?e[0]:e})(e.demandItemFacet(i.graphThumbnailSetFacet,n));if(s&&s.large)return{url:m(s.large.url,r),width:0,height:0}})(e,{itemKey:n,driveItem:d,desiredSize:h}):(function(e,t){var n=t.itemKey,r=t.driveItem,i=t.desiredSize;if(r.endpoint.indexOf("/_api/v2.")>-1){var u=e.demandItemFacet(f.canonicalUrlFacet,n),h=e.demandItemFacet(f.eTagFacet,n,{suppressGetItems:!0})||"";if(u){var p=new a.SimpleUri(r.endpoint).authority+"/_api/v2.1",d=s.thumbnailTokenKeyFacet.serialize({endpoint:p,driveId:r.driveId}),v=e.demandItemFacet(o.thumbnailAccessTokenFacet,d);if(v){var m=l.getDriveItemUrl({endpoint:p,driveId:r.driveId,itemId:r.itemId}),g=Math.ceil(i.width),y=Math.ceil(i.height);return{url:m+"/thumbnails/0/c"+g+"x"+y+"/content?"+c.serializeQuery({prefer:"noredirect,closestavailablesize",cb:h,access_token:{uriValue:v}}),width:0,height:0}}}}})(e,{itemKey:n,driveItem:d,desiredSize:h});return v?{thumbnail:v}:{}}function p(e){return e&&"number"==typeof e.length}t.isArray=p;var d=/width=[0-9]*/,v=/height=[0-9]*/;function m(e,t){var n="number"==typeof t.width?Math.ceil(t.width):t.width,r="number"==typeof t.height?Math.ceil(t.height):t.height,i=""+(n||"");d.test(e)?e=e.replace(d,"width="+i):e+=(e.indexOf("?")>-1?"&":"?")+"width="+i;var s=""+(r||"");v.test(e)?e=e.replace(v,"height="+s):e+=(e.indexOf("?")>-1?"&":"?")+"height="+s;return e}});
define("BJ",["require","exports","kb","Eo","I6","k4","Ye","Ia"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsViewControlHandler=n.createControlHandler()(a);t.itemsViewLayoutsControlHandler=n.createControlHandler()(a);function a(){return function(e){return function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(i.recentItemSetKeyFacet,n);if(a&&a.filters&&s.doExtFiltersHaveMediaTypesOnly({extFilters:s.getIItemTypeFilter(a.filters),allowedMediaTypes:[o.ItemTypeFilter.photo,o.ItemTypeFilter.video],fileTypeIconMap:u.FileTypeIconMap}))return{defaultLayout:r.tilesLayoutType,isLayoutResolved:!0}}return{}}}}});
define("pY",["require","exports","ww","kb","RQ","fY"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e,t){return s.searchItemSetKeyFacet.serialize(n.__assign({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}t.driveItemSearchControlHandler=r.createControlHandler()(u);t.searchItemSearchControlHandler=r.createControlHandler()(u);function u(){return function(e){return function(e,t){var n,r=t.itemKey,u=e.demandItemFacet(i.driveItemSetKeyFacet,r);if(u)n=function(e){return u?o(u,e):void 0};else{var a=e.demandItemFacet(s.searchItemSetKeyFacet,r);n=function(e){return a?o(a,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}});
define("pJ",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeOnlineActionControl=new n.ControlFacet("openInOfficeOnlineActionControl")});
define("HQ",["require","exports","ww","kb","Vs","mo","Vb","RQ","tc","p3"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openActionControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r,s,a=i.getCurrentItemSetKey(e),f={},h=e.demandItemFacet(u.driveItemSetKeyFacet,t.itemKey);if(h){r=l(e,{parentItemKey:o.driveItemKeyFacet.serialize(h.driveItemKey),stageItem:t.stageItem});f={itemKey:t.itemKey}}else{r=(s=c(e,{folderItemKey:t.itemKey,currentItemSetKey:a}))&&l(e,{parentItemKey:o.driveItemKeyFacet.serialize(s.driveItemKey),stageItem:t.stageItem});f=s?{itemKey:u.driveItemSetKeyFacet.serialize(s)}:{}}return n.__assign(n.__assign({},f),r?{stageItem:r}:{})}}});function l(e,t){var r=this,i=t.parentItemKey,o=t.stageItem;if(i)return o?s.createAsyncActionCreator(function(e){var t=e.itemsScopeItemKey,s=e.currentItemKey;return function(e){return n.__awaiter(r,void 0,void 0,function(){var r;return n.__generator(this,function(u){switch(u.label){case 0:e(f.resolveItems({items:(r={},r[s]=n.__assign({},a.parentItemFacet.pack({itemKey:i})),r)}));return[4,e(o({currentItemKey:s,itemsScopeItemKey:t}))];case 1:u.sent();return[2]}})})}}):void 0}t.getStageItemOverride=l;function c(e,t){var r=t.folderItemKey,i=t.currentItemSetKey;if(i&&r){var s=e.demandItemFacet(u.driveItemSetKeyFacet,i),a=e.demandItemFacet(o.driveItemKeyFacet,r);if(s&&a){var f=a.endpoint,l=a.driveId,c=a.itemId;return n.__assign(n.__assign({},s),{driveItemKey:{endpoint:f,driveId:l,itemId:c}})}}}t.getOverrideItemSetKeyForFolder=c});
define("nJ",["require","exports","kb"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentGroupOpenActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}})});
define("cJ",["require","exports","kb","ZY","dJ","xM"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return u}});var o=[r.fileTypeIconColumn,s.nameAndPathColumn,i.dateAccessedColumn];function u(e,t){return{columns:o}}});
define("eJ",["require","exports","ww","kb","Ov","Vs","K_","tJ","_y"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{datasource:"Recent",extraData:n.__assign({},"ItemsView.Load"===s?l(e,{itemsScopeItemKey:r}):{})}}}}});function l(e,t){var r=t.itemsScopeItemKey,i=s.getCurrentItemSetKey(e,r),o=e.demandItemFacet(u.itemSetEngagementExtraDataFacet,i);return n.__assign({},o)}t.recentRootItemEngagementAddon=o.createAddon(function(){return function(e){e(r.registerControlHandler(a.recentRootItemKeyFacet,i.itemEngagementControl)(f))}})});
define("sJ",["require","exports","kb","M0","D0","mJ","rJ"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentCommandBarControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.openCommand,o.openFileLocationCommand,i.shareCommand,i.copyLinkCommand];function a(e,t){return{commands:s.getOverrideDefaultCommands(e,{defaultCommands:u}).overrideDefaultCommands}}});
define("iJ",["require","exports","kb","M0","D0","rJ","_p"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return f}});var u={name:"-",key:"divider_1",itemType:o.ContextualMenuItemType.Divider},a=[r.openCommand,s.openFileLocationCommand,u,i.shareCommand,i.copyLinkCommand];function f(e,t){return{commands:a}}});
define("jJ",["require","exports","ww","I6","kb","G7","K7"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetFilteredItemSetControlHandler=i.createControlHandler()(function(){return function(e){return u}});function u(e,t){var i=t.handlers,u=t.itemKey,a=e.demandItemFacet(r.recentItemSetKeyFacet,u);if(i&&a){for(var f=[],l=0,c=i;l<c.length;l++){var h=c[l];if(h.key===o.itemPhotoTypeFilterHandler.key)f.push("photo");else if(h.key===o.itemVideoTypeFilterHandler.key)f.push("video");else if(h.key===o.itemFolderTypeFilterHandler.key)f.push("folder");else if(h.key===o.itemOneNoteFilterHandler.key)f.push("onenote");else if(h.key===o.itemNonPhotoTypeFilterHandler.key)f.push("!photo");else if(h.key===o.itemNonVideoTypeFilterHandler.key)f.push("!video");else if(h.key===o.itemNonFolderTypeFilterHandler.key)f.push("!folder");else if(h.key===o.itemNonOneNoteFilterHandler.key)f.push("!onenote");else{var p=s.getExtensionFilterFromFilterHandler(h);p&&f.push(p)}}return{itemKey:r.recentItemSetKeyFacet.serialize(n.__assign(n.__assign({},a),{filters:f}))}}return{}}});
define("zY",["require","exports","kb","GY"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.emptyFolderControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:r.default.savedForLaterEmptyStateTitle}}}})});
define("JY",["require","exports","kb","ZY","xM","XY","m2"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.fileTypeIconColumn,i.nameAndPathColumn,s.dateFollowedColumn,o.itemActivityColumn];function a(e,t){return{columns:u}}});
define("qY",["require","exports","ww","r","QY","qd","kb","Yv","Ih","WY"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetDetailsListControlHandler=o.createControlHandler()(function(){return function(e){return c}});var l=function(e){var t=e.defaultRender,i=n.__assign({},a.itemLifeCycleSignalsControl.pack(f.itemLifeCycleSignalsControlHandler));return t?r.createElement(u.ControlHandlerProvider,{controlHandlers:i},r.createElement(t,n.__assign({},e))):null};function c(){return{groupHeaderRenderer:i.GroupItemDetailsHeader,rowRenderer:l,groupProps:{collapseAllVisibility:s.CollapseAllVisibility.hidden}}}});
define("KY",["require","exports","ww","r","Yv","WY","Ih","kb","CC","Bc","ys","jS","w5"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetTilesListControlHandler=u.createControlHandler()(function(){return function(e){return v}});function p(e,t){var n=t.itemKey,i=e.demandItemFacet(f.dateFollowedFacet,n,{suppressGetItems:!0}),s=i&&new Date(i).getTime();if("number"==typeof s&&!isNaN(s)){var o=e.demandItemFacet(l.localeFacet,l.configurationItemKey),u=o&&o.language||window.navigator.language,a=c.getRelativeDateTimeStringPast(new Date(s),u);return{itemActivity:a&&r.createElement(h.DateField,{text:a})||null}}return{}}var d=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,u=n.__rest(e,["defaultRender"]),f=n.__assign(n.__assign({},o.itemLifeCycleSignalsControl.pack(s.itemLifeCycleSignalsControlHandler)),a.itemTileControl.pack(p));return t?r.createElement(i.ControlHandlerProvider,{controlHandlers:f},r.createElement(t,n.__assign({},u))):null};return t})(r.PureComponent);function v(){return{tileRenderer:d}}});
define("UQ",["require","exports","ww","Nb","kb","_2"],function(e,t,n,r,i,s){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});var u=((o={})[s.SHARED_BY_COLUMN_KEY]=!0,o[s.DATE_SHARED_COLUMN_KEY]=!0,o);t.sharedWithMeGroupedItemSetControlHandler=i.createControlHandler()(function(){return function(e){return a}});function a(e,t){var i=t.itemSetKey,o=t.handler.columnKey;if(!u[o])return{};var a=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i);if(!a)return{};var f=s.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[o];return f?{newItemSetKey:r.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},a),{groupBy:f}))}:{}}});
define("FQ",["require","exports","ww","Nb","kb","HQ","Fx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeItemSetOpenActionControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){var i=t.itemKey,u=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i),a=u&&u.driveItemKey.endpoint,f=a&&s.getStageItemOverride(e,{parentItemKey:o.sharedWithMeRootItemKeyFacet.serialize({endpoint:a}),stageItem:t.stageItem});return n.__assign({},f?{stageItem:f}:{})}}})});
define("NQ",["require","exports","ww","kb","Nb","_2","Uh"],function(e,t,n,r,i,s,o){"use strict";var u;Object.defineProperty(t,"__esModule",{value:!0});var a=((u={})[o.DISPLAY_NAME_COLUMN_KEY]=!0,u[o.NAME_AND_PATH_COLUMN_KEY]=!0,u[s.SHARED_BY_COLUMN_KEY]=!0,u[s.DATE_SHARED_COLUMN_KEY]=!0,u[s.ITEM_ACTIVITY_COLUMN_KEY]=!0,u);t.sharedWithMeSortedItemSetControlHandler=r.createControlHandler()(function(){return function(e){return f}});function f(e,t){var r=t.itemSetKey,o=t.handler,u=o.columnKey,f=o.isAscending;if(!a[u])return{};var l=e.demandItemFacet(i.sharedWithMeItemSetKeyFacet,r);if(!l)return{};var c=s.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[u];return c?{newItemSetKey:i.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},l),{sortBy:c,isAscending:f}))}:{}}});
define("TQ",["require","exports","ww","Nb","kb"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeUngroupedItemSetControlHandler=i.createControlHandler()(function(){return function(e){return s}});function s(e,t){var i=t.itemSetKey,s=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i);return s?{newItemSetKey:r.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},s),{groupBy:void 0}))}:{}}});
define("BQ",["require","exports","kb","M0","D0","QQ","VQ","jQ"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeCommandBarControlHandler=n.createControlHandler()(function(){return function(e){return f}});t.default=t.sharedWithMeCommandBarControlHandler;var a=[r.openCommand,i.shareCommand,i.copyLinkCommand,s.addShortcutFromSharedWithMeCommand,u.removeShortcutFromSharedWithMeCommand,o.removeFromSharedListCommand];function f(e,t){return{commands:a}}});
define("FY",["require","exports","kb","M0","D0","QQ","jQ","VQ"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return f}});var a=[r.openCommand,i.shareCommand,i.copyLinkCommand,s.addShortcutFromSharedWithMeCommand,o.removeShortcutFromSharedWithMeCommand,u.removeFromSharedListCommand];function f(e,t){return{commands:a}}});
define("SX",["require","exports","kb","ZY","xM","OX","DX"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.fileTypeIconColumn,i.nameAndPathColumn,s.dateSharedColumn,o.sharedByColumn];function a(e,t){return{columns:u}}});
define("SJ",["require","exports","ww","r","Wv","sb","tY","kb"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialFolderIconControlHandler=u.createControlHandler()(function(){return function(e){return function(e,t){return{fileTypeIconAs:a}}}});var a=i.createItemCacheComponent(function(e,t){var i=t.defaultRender,u=n.__rest(t,["defaultRender"]),a=u.isFolder,f=u.itemKey,l=u.type,c=l;if(a&&void 0===l){var h=e.demandItemFacet(o.specialFolderFacet,f);void 0!==h&&("desktop"===h?c=s.FileIconType.desktopFolder:"documents"===h?c=s.FileIconType.documentsFolder:"pictures"===h&&(c=s.FileIconType.picturesFolder))}return i?r.createElement(i,n.__assign({},u,{type:c})):null})});
define("vJ",["require","exports","r","kb","xh","tY"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialFolderTileControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){return{folderCoverControlHandler:function(t,r){var o=r.signalData;if(o&&o.signal)return{};var u=e.demandItem({specialFolder:s.specialFolderFacet},r.itemKey).specialFolder;if(!u)return{};var a=(function(e){var t=null;"desktop"===e?t=n.createElement(i.DesktopSignal,null):"documents"===e?t=n.createElement(i.DocumentsSignal,null):"pictures"===e&&(t=n.createElement(i.PicturesSignal,null));return{signal:t,key:e||""}})(u);return a&&a.signal?{signalData:a}:{}}}}}})});
define("EN",["require","exports","ww","Ms","nM","Q1","Is","u4","IN","Jk","Vb","Ki"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveResponse=function(e,t){var n=t+"/me/drive";return f.getRawData({url:n,qosName:e,method:"GET",endpoint:t})};t.getAddToOneDriveResponse=function(e){var t=this;return function(i){return n.__awaiter(t,void 0,void 0,function(){var t,s,a,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return n.__generator(this,function(_){switch(_.label){case 0:t=e.name,s=e.endpoint,a=e.sharepointIds,l=e.qosName,h=e.webAbsoluteUrl;p=i(o.readConfiguration({getUserOneDriveEndpoint:c.getUserOneDriveEndpointFacet,isTestMode:c.isTestMode})),d=p.getUserOneDriveEndpoint,v=p.isTestMode;m=new u.default(h).authority;return(y=s)?[3,3]:(b=d)?[4,i(d({endpoint:m}))]:[3,2];case 1:b=_.sent();_.label=2;case 2:y=b;_.label=3;case 3:if(g=y)return[3,4];throw new r.ItemOperationError({code:"A2ODAddToOneDrive_missingDriveEndpointInfo"});case 4:w=g.replace("v2.0","v2.1");E=w+"/drives/me/root/children";S=a.listId;x=a.listItemUniqueId;T=a.siteId;N=a.siteUrl;C=a.webId;k={name:t,remoteItem:{sharepointIds:{listId:S,listItemUniqueId:x,siteId:T,siteUrl:N,webId:C}},"@microsoft.graph.conflictBehavior":"rename"};L=[{code:"notAllowed"},{code:"shortcutAlreadyExists"},{code:"nestedDescendantShortcutExists"},{code:"nestedAscendantShortcutExists"}];return[4,i(f.getRawData({url:E,qosName:l,method:"POST",body:k,expectedErrors:L,endpoint:g}))];case 5:A=_.sent();if(v&&A){O=[];try{(M=window.localStorage.getItem("TAB.AddShortcut"))&&(O=JSON.parse(M))}catch(e){}window.localStorage.setItem("TAB.AddShortcut",JSON.stringify(n.__spreadArrays(O,[{name:t,id:A.id,endpoint:g}])))}return[2,A]}})})}};t.addToOneDriveErrorHandle=function(e,t,n){var o=i.getErrorResolution(e,function(r,i){var o=e.response,u=o&&o.error;if(u){var f=u["@error.fixItItemIds"],c=u["@error.fixItWebUrl"],h=u["@error.fixItItemName"],p=[];if(f&&t&&n)for(var d=0,v=f;d<v.length;d++){var m=v[d],g=l.driveItemKeyFacet.serialize({endpoint:t,driveId:n,itemId:m});p.push(g)}switch(r){case"unauthenticated":case 401:return s.authFailureErrorFacet.pack({});case"itemNotFound":case 404:return s.fileNotFoundErrorFacet.pack({});case"accessDenied":case 403:return s.accessDeniedErrorFacet.pack({});case"shortcutAlreadyExists":return a.shortcutExistedAlreadyFacet.pack({existShortcutUrl:c,existShortcutName:h});case"nestedDescendantShortcutExists":return a.nestedDescendantShortcutExistsFacet.pack({nestDescendantItemKeys:p});case"nestedAscendantShortcutExists":return a.nestedAscendantShortcutExistsFacet.pack({existShortcutUrl:c,existShortcutName:h});default:return s.offlineErrorFacet.pack({})}}});throw new r.ItemOperationError({innerError:e,facets:o})}});
define("JQ",["require","exports","ww","Ms","cc","Bc","K_","Vb","AN","nM","Nb","EN"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveOperationHandler=o.createSingleItemOperationHandler()(function(e){var t=e.itemKey,o=e.options.itemSetKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g;return n.__generator(this,function(n){switch(n.label){case 0:if(!l.sharedWithMeItemSetKeyFacet.matches(o))throw new r.ItemOperationError({code:"invalidItemSetForAddToOneDrive"});h=l.sharedWithMeItemSetKeyFacet.deserialize(o).driveItemKey.endpoint;p=e(i.readItems(function(e){return{fileName:e.demandItemFacet(s.fileNameFacet,t),sharepointIds:e.demandItemFacet(a.sharepointIdsFacet,t),remoteDriveInfo:e.demandItemFacet(u.driveItemKeyFacet,t)}})),d=p.fileName,v=p.sharepointIds,m=p.remoteDriveInfo;if(!(h&&d&&m&&v))throw new r.ItemOperationError({code:"missingItemInfoForAddToOneDrive"});n.label=1;case 1:n.trys.push([1,3,,4]);return[4,e(c.getAddToOneDriveResponse({name:d.name,sharepointIds:v,qosName:"AddToOneDrive_SWM",endpoint:h}))];case 2:n.sent();return[3,4];case 3:if(!((g=n.sent())instanceof f.GraphError))throw g;c.addToOneDriveErrorHandle(g);return[3,4];case 4:return[2]}})})}})});
define("VJ",["require","exports","ww","K_","$_","SY","yY","Jk"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandsGetItemsOperationHandler=r.createSingleItemOperationHandler()(a);function a(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,l,c,h,p,d;return n.__generator(this,function(v){switch(v.label){case 0:t=e.itemKey;a=o.commandsItemKeyFacet.deserialize(t);l=a.endpoint;c=u.getDriveUrl(a);return[4,r(f({url:u.getCommandsUrlFromDriveItem(a),driveUrl:c,qosName:"commands",endpoint:l}))];case 1:h=v.sent();(p=new i.ItemResolver).resolveItems({items:(d={},d[t]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},s.addToOneDriveFacet.pack(h.addToOneDrive)),s.createFolderFacet.pack(h.createFolder)),s.createLinkFacet.pack(h.createLink)),s.deleteFacet.pack(h.delete)),s.downloadFacet.pack(h.download)),s.inviteFacet.pack(h.invite)),s.moveFacet.pack(h.move)),s.officeLensFacet.pack(h.officeLens)),s.renameFacet.pack(h.rename)),s.uploadFacet.pack(h.upload)),d)});r(p.execute());return[2]}})})}}t.getCommands=a;function f(e){var t=this;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}});
define("XQ",["require","exports","ww","K_","$_","t4","Jk","uQ","y2","Z4","th","$Q","ZQ","Vb","Bc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveActivityItemGetItemsOperationHandler=r.createBatchedItemsOperationHandler({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=s.driveActivityItemKeyFacet.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,o=s.driveActivityItemKeyFacet.deserialize(t.itemKey).driveItemKey,u=o.endpoint,a=o.driveId;return!!i&&!!a&&i===a&&r===u}})(g);function v(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function m(e){var t=e[0],r={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(r[l.id]=!0)}for(var o=n.__assign(n.__assign({},t),{actors:n.__spreadArrays(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!r[l.id]){o.actors.push(l);r[l.id]=!0}}return o||t}function g(e){var t=this,r=e.items;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,c,h,g,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X;return n.__generator(this,function(V){switch(V.label){case 0:t=Object.keys(r);c=t[0];h=s.driveActivityItemKeyFacet.deserialize(c);g=h.driveItemKey,b=g.endpoint,w=g.driveId;if(!b)throw new Error("No endpoint to determine activity items.");E=t.map(function(e){return s.driveActivityItemKeyFacet.deserialize(e).driveItemKey.itemId});S=o.getDriveUrl({endpoint:($=b,$.replace("2.1","2.0")),driveId:w});x=S+"/ExtendedActivitiesForItems";T={driveItems:E,badgeOnly:!0};return[4,e(o.getRawData({url:x,method:"POST",body:T,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:b}))];case 1:if((N=V.sent()).value){C=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(N.value);k=0;L=0;A=0;O=0;M=new i.ItemResolver;for(_=0,D=t;_<D.length;_++){P=D[_];k++;H=s.driveActivityItemKeyFacet.deserialize(P);B=H.driveItemKey.itemId;j=B&&C[B];F=p.driveItemKeyFacet.serialize(H.driveItemKey);I=void 0;if(j){q=new u.default;R=q.processResponse({item:{name:B||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:x},response:{value:j,"@odata.nextLink":""}}).activities;U=v(R);if(z=m(R)){A++;L++;if(!U){O++;W=y(z,P).itemResolver;M.merge(W);I=z}}}M.resolveItems({items:(X={},X[P]=n.__assign({},a.itemActivityFacet.pack(I)),X[F]=n.__assign({},l.getInvalidationFacet().forFacet(d.activityItemFacet).thenInvalidate(P,a.itemActivityFacet).pack()),X)})}e(M.execute());e(f.logEngagement({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:k,activityFieldEligibleItemCount:L,activityFieldActiveItemCount:A,activityFieldBadgedItemCount:O,activityFieldBadgedPercent:k?Math.round(O/k*100):0},isIntentional:!1}))}return[2]}var $})})}}t.getActivityItems=g;function y(e,t){var r=new i.ItemResolver,o=s.driveActivityItemKeyFacet.deserialize(t).driveItemKey,u=(function(e){var t=e.actors,r=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=n.__spreadArrays(t,r,i);s&&o.push(s);return o})(e);if(u.length>0){var a=(function(e,t){for(var n=new i.ItemResolver,r=0,s=e;r<s.length;r++){var o=b(s[r],t).itemResolver;n.merge(o)}return{itemResolver:n}})(u,o).itemResolver;r.merge(a)}return{itemResolver:r}}function b(e,t){var n=new i.ItemResolver,r={itemKey:p.driveItemKeyFacet.serialize(t),userKey:h.userByEmailKeyFacet.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}},s=c.resolveUserItems(r).itemResolver;n.merge(s);return{itemResolver:n}}});
define("XJ",["require","exports","ww","K_","tC","cc","$_","vO","n4","tc","Bc","ys","th","Vb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveFollowItemGetItemsOperationHandler=r.createBatchedItemsOperationHandler()(d);function d(e){var t=this,r=e.items;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:return[4,e(s.readItems(function(e){return e.demandItemFacet(c.enableFollowItemConfigurationFacet,c.configurationItemKey)}))];case 1:if(!O.sent())return[2];t=Object.keys(r);d=t[0];v=a.driveFollowedItemKeyFacet.deserialize(d);if(!(m=v.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");g=u.savedForLaterItemSetKeyFacet.serialize({driveItemKey:{endpoint:m},sortBy:"",isAscending:!0});return[4,e(i.demandItems(function(e){return e.demandItemFacet(f.childItemsFacet,g)}))];case 2:y=O.sent();b=y&&y.itemKeys||[];w=new o.ItemResolver;E={};for(S=0,x=b;S<x.length;S++){k=x[S];E[k]=!0}for(T=0,N=t;T<N.length;T++){C=N[T];k=a.driveFollowedItemKeyFacet.deserialize(C).driveItemKey;L=!!E[p.driveItemKeyFacet.serialize(k)];w.resolveItems({items:(A={},A[C]=n.__assign(n.__assign({},l.isFollowedFacet.pack(L||void 0)),h.getInvalidationFacet().forFacet(l.isFollowedFacet).thenInvalidate(g,f.childItemsFacet).pack()),A)})}e(w.execute());return[2]}})})}}t.getFollowedItems=d});
define("UY",["require","exports","ww","Vb","K_","Jk","ih","tc","eY","$_"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.folders,l=r.driveItemKeyFacet.deserialize(t),c=l.endpoint,h=l.driveId,p=l.itemId,d=Object.keys(i)[0],v=i[d].progressItemKey,m=s.getDriveUrl(l);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,g,y,b,w,E,S,x;return n.__generator(this,function(T){switch(T.label){case 0:i=s.getDriveItemUrl(l)+"/children";g={name:d,folder:{},"@microsoft.graph.conflictBehavior":"rename"};h&&p&&(g.parentReference={driveId:h,id:p});return[4,e(s.getRawData({url:i,driveUrl:m,method:"POST",body:g,qosName:"createFolder",endpoint:c}))];case 1:y=T.sent();b=r.driveItemKeyFacet.serialize({endpoint:c,driveId:h,itemId:y.id});w=new f.ItemResolver;v&&w.resolveItems({items:(E={},E[v]=n.__assign({},o.createdItemFacet.pack({itemKey:b})),E)});w.invalidateItems({items:(S={},S[t]=[u.defaultChildItemSetFacet],S)});w.resolveItems({items:(x={},x[b]=n.__assign({},a.getDriveItemFacets({driveItem:y,parentFolderItemKey:t,endpoint:c})),x)});e(w.execute());return[2]}})})}})});
define("TY",["require","exports","ww","Vb","K_","Jk","th","Bc"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDeleteItemsOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=r.driveItemKeyFacet.deserialize(t);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,a;return n.__generator(this,function(n){switch(n.label){case 0:r=s.getDriveItemUrl(i);return[4,e(s.getRawData({url:r,method:"DELETE",qosName:"deleteItem",endpoint:i.endpoint}))];case 1:n.sent();e(o.invalidateItems({items:(a={},a[t]=[u.deletedFacet],a)}));return[2]}})})}})});
define("mY",["require","exports","ww","K_","Jk","Bc","$_","n4","Ki","Is","p3","Vb","ih"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemFollowItemOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,p=r.isFollowed,d=r.progressItemKey,v=u.driveFollowedItemKeyFacet.deserialize(t),m=v.driveItemKey,g=m.itemId,y=void 0===g?"":g,b=i.getDriveUrl(m);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,g,w,E,S,x,T,N;return n.__generator(this,function(C){switch(C.label){case 0:t=e(f.readConfiguration({saveForLaterGraphEndpoint:a.savedForLaterGraphEndpointConfigurationFacet})).saveForLaterGraphEndpoint;r=new o.ItemResolver;g=u.driveFollowedItemKeyFacet.serialize(v);w=t||m.endpoint;d&&e(l.resolveItems({items:(x={},x[d]=n.__assign({},h.sourceItemFacet.pack({itemKey:c.driveItemKeyFacet.serialize(m)})),x)}));E=p?{url:w+"/drives/"+m.driveId+"/items/"+y+"/follow",method:"POST",qosName:"followItem"}:{url:w+"/drives/"+m.driveId+"/following/"+y,method:"DELETE",qosName:"unfollowItem"};C.label=1;case 1:C.trys.push([1,3,,4]);return[4,e(i.getRawData({url:E.url,driveUrl:b,method:E.method,qosName:E.qosName,endpoint:w}))];case 2:C.sent();r.invalidateItems({items:(T={},T[g]=[s.isFollowedFacet],T)});r.resolveItems({items:(N={},N[g]=n.__assign({},s.isFollowedFacet.pack(p||void 0)),N)});e(r.execute());return[3,4];case 3:S=C.sent();throw new Error(S.message);case 4:return[2]}})})}})});
define("hX",["require","exports","ww","K_","a4","Ah","bX","Jk","ZB","p3","Us","IB","Bc","k6","ZQ","Is","Ki"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveAnalyticsItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,y=i.driveAnalyticsItemKeyFacet.deserialize(r).driveItemKey,b=y.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,w,E,S,x,T,N,C,k=this;return n.__generator(this,function(L){t={Caller:"HoverCard"};i=e(v.readConfiguration({enableCookiesForAnalyticsRequests:m.enableCookiesForAnalyticsRequestsConfigurationFacet})).enableCookiesForAnalyticsRequests,w=void 0!==i&&i;E="GetItemAnalytics_addon-graph";S=n.__awaiter(k,void 0,void 0,function(){var i,a,l,c,v,m;return n.__generator(this,function(S){switch(S.label){case 0:return[4,e(u.getRawDataWithCache({url:(x=u.getDriveItemUrl(y),T=g(x),N="$expand=analytics($expand=allTime($expand=activities))",C="$select=*,id,reactions,trending",k=C+"&"+N+",insights($expand=keyPoints)",L=T+"?"+k,L),qosName:E+"_GetAnalyticsSections",endpoint:b,timeout:6e3,headers:t,driveUrl:g(u.getDriveUrl(y)),allowCookies:w}))];case 1:i=S.sent();a=o.parseResponseOfAnalyticsSections(i);if(l=a.createdBy){c=d.userByEmailKeyFacet.serialize({email:l.email,endpoint:b});e(f.resolveItems({items:(v={},v[c]=n.__assign(n.__assign(n.__assign(n.__assign({},h.displayNameFacet.pack(l.displayName)),p.emailFacet.pack(l.email)),p.pictureFacet.pack(l.image)),p.sipFacet.pack(l.id)),v[r]=n.__assign({},s.createdByPersonFacet.pack({itemKey:c,displayValue:l.displayName})),v)}))}e(f.resolveItems({items:(m={},m[r]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},s.viewCountFacet.pack(a.viewCount)),s.viewerCountFacet.pack(a.viewerCount)),s.isTrendingFacet.pack(a.isTrending)),s.activitiesFacet.pack(a.activities)),s.likeCountFacet.pack(a.likeCount)),s.commentCountFacet.pack(a.commentCount)),s.lifeCycleStatusFacet.pack(a.lifeCycleStatus)),s.keyPointsFacet.pack(a.keyPointsData)),s.incompleteDataFacet.pack(a.incompleteData)),s.createdDateTimeFacet.pack(a.createdDateTime)),m)}));return[2]}var x,T,N,C,k,L})});x=[S];T=n.__awaiter(k,void 0,void 0,function(){var i,o,l,c;return n.__generator(this,function(h){switch(h.label){case 0:return[4,e(u.getRawDataWithCache({url:(p=u.getDriveItemUrl(y),d=g(p),d+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:E+"_GetRecommendedActionsAndConversations",endpoint:b,timeout:6e3,headers:t,driveUrl:g(u.getDriveUrl(y)),allowCookies:w}))];case 1:i=h.sent();o=(function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n})(i);l=(function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:a.ConversationType[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})})(i);e(f.resolveItems({items:(c={},c[r]=n.__assign(n.__assign({},s.recommendedActionsFacet.pack(o)),s.conversationsFacet.pack(l)),c)}));return[2]}var p,d})});x.push(T);if(c.isLowActivityTidbitEnabled()){N=n.__awaiter(k,void 0,void 0,function(){var i,o;return n.__generator(this,function(a){switch(a.label){case 0:return[4,e(u.getRawDataWithCache({url:(l=u.getDriveItemUrl(y),c=g(l),c+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'"),driveUrl:g(u.getDriveUrl(y)),qosName:E+"_GetShareWithPeople",endpoint:b,timeout:6e3,headers:t,allowCookies:w}))];case 1:i=a.sent();e(f.resolveItems({items:(o={},o[r]=n.__assign({},s.recommendedPeopleFacet.pack(i.value)),o)}));return[2]}var l,c})});x.push(N)}else e(f.resolveItems({items:(C={},C[r]=n.__assign({},s.recommendedPeopleFacet.pack([])),C)}));return[2,l.waitForAll(x)]})})}});function g(e){return e.replace("2.0","2.1")}});
define("yX",["require","exports","ww","K_","Vb","Jk","Jk","UJ","Es","MJ"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.driveItemKeyFacet.deserialize(r);return function(c){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:t=l;return l.driveId&&"me"!==l.driveId?[3,2]:[4,c(f.getOneDriveEndpoint({endpoint:l.endpoint}))];case 1:(h=E.sent())!==l.endpoint&&(t=n.__assign(n.__assign({},l),{endpoint:h}));E.label=2;case 2:p=o.getDriveUrl(t);return[4,c(o.getRawDataWithCache({url:s.getDriveItemUrl(t)+"?$expand=thumbnails",driveUrl:p,qosName:"getItem",endpoint:t.endpoint}))];case 3:d=E.sent();v=u.processLocalOrRemoteDriveItem({driveItemResponse:d,endpoint:t.endpoint}),m=v.itemResolver,g=v.actualItemKey;m.resolveItems({items:(y={},y[e.itemKey]=n.__assign({},a.resolvedAsKeyFacetFacet.pack(i.driveItemKeyFacet)),y)});m.mapKeys({mappings:(b={},b[g]=r,b)});l.driveId&&"me"!==l.driveId||m.mapKeys({mappings:(w={},w[i.driveItemKeyFacet.serialize(n.__assign(n.__assign({},l),{driveId:"me"}))]=i.driveItemKeyFacet.serialize(n.__assign(n.__assign({},l),{driveId:""})),w[r]=i.driveItemKeyFacet.serialize(t),w)});c(m.execute());return[2]}})})}})});
define("dY",["require","exports","ww","K_","Ms","tC","Jx","Q1","Bc","$_","Vb","Jk","cc","nM","tc","lY"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemMoveCopyItemsOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,m=Object.keys(r)[0];return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var g,y,b,w,E,S,x,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:if(!e(h.readItems(function(e){return e.demandItemFacet(l.driveItemKeyFacet,m)})))throw new Error("Source item does not have a driveItem key");g=r[m],y=g.isMove,b=g.conflictBehavior,w=g.progressItemKey;E=l.driveItemKeyFacet.deserialize(t);return[4,e(s.demandItems(function(e){return e.demandItemFacet(l.driveItemKeyFacet,m)}))];case 1:if(!(S=M.sent()))throw new Error("Unable to get metadata for destination item.");x=c.getDriveItemUrl(S);T=c.getDriveUrl(S);N=S.endpoint;M.label=2;case 2:M.trys.push([2,4,,5]);return[4,e(c.getRawData({url:x+(y?"":"/copy"),driveUrl:T,method:y?"PATCH":"POST",body:{parentReference:{id:E.itemId||v.ROOT_ITEM_ID,driveId:E.driveId||""},"@microsoft.graph.conflictBehavior":b},qosName:y?"moveItem":"copyItem",endpoint:N}))];case 3:C=M.sent();(k=new f.ItemResolver).invalidateItems({items:(A={},A[m]=y?[a.parentFolderItemFacet,a.deletedFacet]:[],A[t]=[d.defaultChildItemSetFacet],A)});w&&!y&&C.name&&k.resolveItems({items:(O={},O[w]=n.__assign({},a.displayNameFacet.pack(C.name)),O)});e(k.execute());return[3,5];case 4:if((L=M.sent())instanceof p.GraphError&&L.status===i.STATUS_CODE_ZERO)throw new o.MoveCopyItemOperationError({innerError:L,facets:n.__assign({},u.httpStatusErrorFacet.pack(L.status))});throw L;case 5:return[2]}})})}})});
define("PY",["require","exports","ww","Ms","Vb","K_","Jk","Bc","Q1","eY","Cs","$_","nM"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemRenameItemOperationHandler=s.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,s=e.options.names,p=i.driveItemKeyFacet.deserialize(t);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:i=Object.keys(s)[0];d=s[i],v=d.newName,m=d.newExtension;g=o.getDriveItemUrl(p);y=o.getDriveUrl(p);b=e(l.readItem({fileName:u.fileNameFacet},t)).fileName;w="string"==typeof m?m:b&&b.extension||"";return[4,e(o.getRawData({url:g,driveUrl:y,method:"PATCH",body:{name:""+v+w},qosName:"renameItem",endpoint:p.endpoint})).then(function(r){var i,s,o=new c.ItemResolver;o.invalidateItems({items:(i={},i[t]=[u.displayNameFacet],i)});o.resolveItems({items:(s={},s[t]=n.__assign(n.__assign({},u.displayNameFacet.pack(r.name)),u.fileNameFacet.pack(f.getFileName(r.name||"",!!r.folder))),s)});e(o.execute())}).catch(function(e){if(e instanceof h.GraphError&&e.status===r.STATUS_CODE_ZERO)throw new r.ItemOperationError({facets:n.__assign({},a.offlineErrorFacet.pack({})),innerError:e});throw e})];case 1:E.sent();return[2]}})})}})});
define("wY",["require","exports","ww","MY","kY","LY","AY","EY","Jk","$k","nM","eY","Da","is","Vb","D8","Cs","cc","hk","p3","ih","qi","tc","A","Hs","$_","Q1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=p.asOnceOnly(function(){return new s.UploadWaiter({},{})}),L=p.asOnceOnly(function(e){var t=e(a.getDataRequestor).dataRequestor,s=(function(e){n.__extends(t,e);function t(t){return e.call(this,t,{performanceNow:u.performanceNow})||this}return t})(u.ActivityBandwidthVerifier),f=new i.UploadService({},{dataRequestor:t}),l=new o.UploadStateMachine({},{activityBandwidthVerifierType:s,uploadService:f});return new r.Uploader({},{uploadService:f,uploadStateMachine:l})}),A=0;t.uploadDriveItem=function(e){var t=this,r=e.itemKey,i=e.options.sourceEntries,s=d.driveItemKeyFacet.deserialize(r),o=s.endpoint,u=s.driveId,f=Object.keys(i)[0],l=i[f],h=l.progressItemKey,p=l.conflictResolution,v=void 0===p?"fail":p;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,p,g,x,T,C,k,L;return n.__generator(this,function(A){switch(A.label){case 0:if(!(t=e(m.readItem({sourceFile:y.sourceFileFacet},f)).sourceFile))throw new Error("No source file for Graph upload.");i=a.getDriveItemUrl(s)+":";l=a.getDriveUrl(s);h&&e(b.resolveItems({items:(T={},T[h]=n.__assign({},w.progressSizeFacet.pack({total:t.size,current:0})),T)}));return[4,e(O({progressItemKey:h,sourceFile:t,itemUrl:i,driveUrl:l,conflictResolution:v,endpoint:o}))];case 1:p=A.sent();g=d.driveItemKeyFacet.serialize({endpoint:o,driveId:u,itemId:p.id});x=new N.ItemResolver;h&&x.resolveItems({items:(C={},C[h]=n.__assign(n.__assign({},w.createdItemFacet.pack({itemKey:g})),E.pack({progressSize:w.progressSizeFacet},{progressSize:{current:t.size}})),C)});x.invalidateItems({items:(k={},k[r]=[S.defaultChildItemSetFacet],k)});x.resolveItems({items:(L={},L[g]=n.__assign({},c.getDriveItemFacets({driveItem:p,parentFolderItemKey:r,endpoint:o})),L)});return[2,{itemResolver:x,driveItem:p,itemKey:g}]}})})}};function O(e){var t=this,r=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.driveUrl,u=e.endpoint,a=(function(e){switch(e){case"rename":return"rename";case"replace":return"replace";default:return"fail"}})(e.conflictResolution);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,c,p,d,m,y,S,N,O,M;return n.__generator(this,function(_){switch(_.label){case 0:t=e(L);c=e(k);return[4,e(f.getSessionToken(u,o))];case 1:p=_.sent();d=new h.Async;m=0;y=d.debounce(function(t){var n;if(t>m){r&&e(b.resolveItems({items:(n={},n[r]=E.pack({progressSize:w.progressSizeFacet},{progressSize:{current:t}}),n)}));m=t}},300,{leading:!1});S=e(g.readItems(function(e){return e.demandItemFacet(w.cancelSourceFacet,r)}));N=t.upload({conflictBehavior:a,qosData:{uploadId:""+ ++A},accessToken:p,fileName:i.name,content:i,itemUrl:s,onProgress:y,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return c.wait(e)},select:"*,sharepointIds"});O=S?S.token.subscribe(function(){N.cancel()}):void 0;_.label=2;case 2:_.trys.push([2,4,5,6]);return[4,N];case 3:return[2,_.sent()];case 4:M=_.sent();if(x.default.isCanceled(M))throw new T.CancelError;throw new v.UploadItemOperationError({facets:n.__assign({},l.getErrorResolution(M,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return C.accessDeniedErrorFacet.pack({});case"nameAlreadyExists":case 409:return C.conflictErrorFacet.pack({supportsRename:!0})}})||E.pack({},{})),innerError:M});case 5:O&&O();d.dispose();return[7];case 6:return[2]}})})}}});
define("OY",["require","exports","ww","K_","wY"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemUploadItemsOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,r(i.uploadDriveItem(e))];case 1:t=n.sent().itemResolver;r(t.execute());return[2]}})})}})});
define("mX",["require","exports","ww","K_","tc","Bc","KJ","Jk","Vb","eY","th","$_","aS","Is","Ki","PJ","Ji"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPageGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,g=o.driveItemPageKeyFacet.deserialize(r),y=g.setItemKey,b=g.endpoint,w=g.token,E=m.KeyFacet.get(y).deserialize(y),S=E.extFilters,x=E.driveItemKey,T=u.getDriveUrl(x);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,m,g,E,x,N,C,k,L,A,O,M,_,D,P,H;return n.__generator(this,function(B){switch(B.label){case 0:return[4,e(u.getRawData({endpoint:b,url:w,driveUrl:T,qosName:"getChildrenPage"}))];case 1:t=B.sent();m=S&&S.length>0?v.getChildrenItemFilter(S):void 0;g=new c.ItemResolver;E=[];x=0,N=t.value;B.label=2;case 2:if(!(x<N.length))return[3,5];C=N[x];if(!!m&&m(C))return[3,4];k=C&&(C.parentReference||C.remoteItem&&C.remoteItem.parentReference);L=k&&k.driveId;A=a.driveItemKeyFacet.serialize({itemId:C.id,driveId:L,endpoint:b});O=k?a.driveItemKeyFacet.serialize({itemId:k.id,driveId:L,endpoint:b}):void 0;E.push(A);g.resolveItems({items:(H={},H[A]=n.__assign(n.__assign({},f.getDriveItemFacets({driveItem:C,endpoint:b,parentFolderItemKey:O})),l.getInvalidationFacet().forFacet(s.displayNameFacet).thenInvalidate(r,i.childItemsFacet).forFacet(s.deletedFacet).thenInvalidate(r,i.childItemsFacet).pack()),H)});return(M=e(p.readConfiguration({processDriveItemFromSharePoint:d.processDriveItemFromSharePointFacet})).processDriveItemFromSharePoint)?[4,e(M.process({itemKey:A,driveItem:C}))]:[3,4];case 3:_=B.sent().itemResolver;g.merge(_);B.label=4;case 4:x++;return[3,2];case 5:if(D=t["@odata.nextLink"]){P=o.driveItemPageKeyFacet.serialize({setItemKey:y,endpoint:b,token:D});g.merge(h.resolveNewPage({itemKey:P}).itemResolver);E.push(P)}g.merge(h.resolveExistingPage({itemKey:r,itemSetKey:y,childItemKeys:E}).itemResolver);e(g.execute());return[2]}})})}})});
define("qJ",["require","exports","ww","K_","kJ","Is","Ki","lY","I4","Oo"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,c;return n.__generator(this,function(h){switch(h.label){case 0:t=r(s.readConfiguration({pageSize:o.driveItemSetPageSizeFacet})).pageSize;return[4,r(i.loadAndProcessPagedDriveItemSet(n.__assign(n.__assign({},e),{skip:l,top:t||u.DEFAULT_PAGE_SIZE})))];case 1:c=h.sent();f.mark(a.itemsViewPerfMarkers.resolveData.start);r(c.execute());f.mark(a.itemsViewPerfMarkers.resolveData.end);return[2]}})})}});var l=0});
define("LJ",["require","exports","ww","K_","EJ","kJ","tc","th"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemVirtualizedPageGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,a=i.driveItemVirtualizedPageKeyFacet.deserialize(r),f=a.setItemKey,l=a.top,c=a.skip;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(a){switch(a.label){case 0:return[4,r(s.loadAndProcessPagedDriveItemSet(n.__assign(n.__assign({},e),{itemKey:f,skip:c,top:l})))];case 1:(t=a.sent()).resolveItems({items:(i={},i[f]=n.__assign({},u.getInvalidationFacet().forFacet(o.childItemsFacet).thenInvalidate(e.itemKey,o.childItemsFacet).pack()),i)});r(t.execute());return[2]}})})}})});
define("RY",["require","exports","ww","K_","tC","fe","NY","Jk","$k","K9","G9","Ki","Is","W_","W","pb","Pc","yx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileHandlerGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,i=f.driveAppsKeyFacet.deserialize(r),o=i.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u;return n.__generator(this,function(n){t=e(p.logQoS({name:"getFileHandlersOperation"}));u={endpoint:o};return[2,e(y(i)).then(function(n){if(n){g.cacheFileHandlerData({driveAppsKey:i,data:n});e(g.resolveFileHandlers(n,r));u.fileHandlerRequestEndpoint=n.signature.endpoint;u.accessTokenObtained=!0;e(t({resultType:d.ResultTypeEnum.Success,extraData:u}))}else e(t({resultType:d.ResultTypeEnum.Failure,resultCode:"NoFileHandlerData",extraData:u}))}).catch(function(n){s.default.logError(n);e(t({resultType:d.ResultTypeEnum.Failure,extraData:u}));throw n})]})})}});t.filehandlerPerExtensionGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,s=f.driveAppsExtensionKeyFacet.deserialize(r).endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t=f.driveAppsKeyFacet.serialize({endpoint:s});return[4,e(i.demandItems(function(e){return e.demandItemFacet(l.fileHandlerActionsFacet,t)}))];case 1:n.sent();return[2]}})})}});function y(e){var t=e.endpoint,n=e.driveId;return function(e){var r,i={endpoint:t,driveId:n},s=e(p.logQoS({name:"fetchFileHandlerData",extraData:i})),f=e(h.readConfiguration({getUserOneDriveEndpoint:c.getUserOneDriveEndpointFacet,useOneDriveEndpoint:c.userOneDriveEndpointForFileHandlerConfigurationFacet})),l=f.getUserOneDriveEndpoint,g=f.useOneDriveEndpoint,y=u.getDriveUrl({endpoint:t,driveId:n}),b=new o.default({},{dataRequestor:e(u.getDataRequestor).dataRequestor}),w=Promise.resolve(t);l&&g&&(w=e(l({endpoint:t})));return w.then(function(t){r=t;y=u.getDriveUrl({endpoint:r});i.fileHandlerRequestEndpoint=r;return e(a.getSessionToken(r,y,{qosExtraData:{requestor:"GetFileHandlerData",endPoint:r,driveUrl:y}}))}).then(function(t){i.accessTokenObtained=!!t;return b.getFileHandlerData({accessToken:t,endpoint:r,includePromotedApp:!0,driveId:n}).then(function(t){if(t){var o={data:t,lastModified:Date.now(),signature:{endpoint:r,includePromotedApp:!0,driveId:n}};e(s({resultType:d.ResultTypeEnum.Success,extraData:i}));return o}e(s({resultType:d.ResultTypeEnum.Failure,resultCode:"NoDataFromFileHandlerService",extraData:i}))}).catch(function(t){e(s(v.mergeQosEndSchema({resultType:d.ResultTypeEnum.Failure,extraData:i},m.getQosEndSchemaFromError(t))));throw t})}).catch(function(t){e(s(v.mergeQosEndSchema({resultType:d.ResultTypeEnum.Failure,resultCode:"getSessionTokenError",extraData:i},m.getQosEndSchemaFromError(t))));throw t})}}t.fetchFileHandlerData=y});
define("yx",["require","exports","ww","$_","Bc","tc","K9","G9"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e){var t=e.endpoint,n=e.driveId;return"fileHandlerCache_"+JSON.stringify({endpoint:t,driveId:n})}t.getFileHandlerCacheKey=a;t.cacheFileHandlerData=function(e){if("localStorage"in window)try{var t=a(e.driveAppsKey);localStorage.setItem(t,JSON.stringify(e.data))}catch(e){}};t.resolveFileHandlers=function(e,t){var i=e.data,s=i.actions,a=i.preferences,c=i.version,h=e.signature,p=o.driveAppsKeyFacet.deserialize(t);return function(i){var d,v=new r.ItemResolver,m=(function(e,t){var n={};["custom","create","open","preview"].forEach(function(r){var i=f(e,t[r],r);n[r]=i});return n})(v,s),g=(function(e,t){for(var i,s=new r.ItemResolver,a=0,c=Object.keys(e);a<c.length;a++){var h=c[a],p=e[h],d={};d.open=f(s,p.open,"open",h);d.preview=f(s,p.preview,"preview",h);for(var v=(p.open||[]).concat(p.preview||[]),m=void 0,g=0;g<v.length;g++){var y=v[g],b=y.handler,w=y&&l(y.icon)||b&&l(b.fileTypeIcon),E=b.fileTypeDisplayName||b.displayName;if(w){m={displayName:E,url:w};break}}var S=o.driveAppsExtensionKeyFacet.serialize({endpoint:t,extension:h}),x=n.__assign(n.__assign({},u.fileHandlerActionsFacet.pack(d)),u.fileHandlerFileTypeIconFacet.pack(m));s.resolveItems({items:(i={},i[S]=x,i)})}return{preferencesItemResolver:s}})(a,p.endpoint).preferencesItemResolver;v.merge(g);v.resolveItems({items:(d={},d[t]=n.__assign(n.__assign(n.__assign({},u.fileHandlerActionsFacet.pack(m)),u.fileHandlerVersionFacet.pack(c)),u.fileHandlerRawDataFacet.pack({data:e.data,signature:h})),d)});i(v.execute())}};function f(e,t,r,a){var f,c=[];t.forEach(function(t){var r,s=t.handler,a=o.fileHandlerKeyFacet.serialize({id:s.id,appId:s.appId}),f=o.fileHandlerActionKeyFacet.serialize({handlerId:s.id,appId:s.appId,id:t.id||0}),h={displayName:s.actionMenuDisplayName,url:l(s.appIcon)},p={displayName:s.fileTypeDisplayName||s.displayName,url:l(t.icon||s.fileTypeIcon)},d=n.__assign(n.__assign({},i.displayNameFacet.pack(s.actionMenuDisplayName||s.displayName)),u.fileHandlerAppIconFacet.pack(h)),v=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},i.displayNameFacet.pack(t.displayName||s.displayName)),i.openUrlFacet.pack(t.url)),u.fileHandlerActionAvailableOnFacet.pack(t.availableOn)),u.fileHandlerKeyFacetFacet.pack(a)),u.fileHandlerFileTypeIconFacet.pack(p)),u.fileHandlerAppIdFacet.pack(s.appId)),void 0!==s.isPromoted?n.__assign({},u.fileHandlerIsPromotedFacet.pack(s.isPromoted)):{});e.resolveItems({items:(r={},r[a]=d,r[f]=v,r)});-1===c.indexOf(f)&&c.push(f)});var h=o.fileHandlerActionSetKeyFacet.serialize({type:r,extension:a}),p=n.__assign({},s.childItemsFacet.pack(0===c.length?void 0:{itemKeys:c}));e.resolveItems({items:(f={},f[h]=p,f)});return h}function l(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)}});
define("EQ",["require","exports","ww","$_","K_","LQ","Is","Ki","Jk","AQ","jo","Bc","k6","tc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.peopleGetItemsOperationHandler=i.createSingleItemOperationHandler()(function(e){var t=this,i=e.itemKey;return function(d){return n.__awaiter(t,void 0,void 0,function(){var t,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:t=new r.ItemResolver;v=d(o.readConfiguration({graphEndpoint:u.graphEndpointConfigurationFacet})).graphEndpoint;m=s.topCollaboratorSetKeyFacet.deserialize(i);g=v||m.endpoint;y=g+"/me/people/";return[4,d(a.getRawData({url:y,qosName:"getTopCollaborator",endpoint:g}))];case 1:b=O.sent();w=[];for(E=0,S=b.value;E<S.length;E++){x=S[E];T=x.id,N=x.displayName,C=x.userPrincipalName;k=f.topCollaboratorItemKeyFacet.serialize({id:T});d(l.resolveItems({items:(L={},L[k]=n.__assign(n.__assign({},c.displayNameFacet.pack(N)),h.emailFacet.pack(C)),L)}));w.push(k)}t.resolveItems({items:(A={},A[e.itemKey]=n.__assign({},p.childItemsFacet.pack({itemKeys:w})),A)});d(t.execute());return[2]}})})}})});
define("$J",["require","exports","ww","K_","I6","JJ","_y","nm","k4","Ye","Ia","$_","aJ","eX","Bc","tc","Vb","Jk","Ki","Is","PJ","eY","WI","MJ"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filterMediaContent=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})};t.recentItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var r=this,T=i.recentItemSetKeyFacet.deserialize(e.itemKey),N=T.filters,C=void 0===N?[]:N,k=T.groupBy,L=void 0===k?"":k,A=T,O=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(C),allowedMediaTypes:[f.ItemTypeFilter.photo,f.ItemTypeFilter.video],fileTypeIconMap:l.FileTypeIconMap}),M=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(C),allowedMediaTypes:[f.ItemTypeFilter.photo],fileTypeIconMap:l.FileTypeIconMap}),_=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(C),allowedMediaTypes:[f.ItemTypeFilter.video],fileTypeIconMap:l.FileTypeIconMap});return function(a){return n.__awaiter(r,void 0,void 0,function(){var r,f,l,T,N,k,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee;return n.__generator(this,function(te){switch(te.label){case 0:if(!(r=a(b.readConfiguration({graphRecentEndpoint:y.graphRecentEndpointConfigurationFacet})).graphRecentEndpoint))return[3,1];A=n.__assign(n.__assign({},A),{driveItemKey:n.__assign(n.__assign({},A.driveItemKey),{endpoint:r})});return[3,3];case 1:return[4,a(x.getOneDriveEndpoint({endpoint:A.driveItemKey.endpoint}))];case 2:(f=te.sent())!==A.driveItemKey.endpoint&&(A=n.__assign(n.__assign({},A),{driveItemKey:n.__assign(n.__assign({},A.driveItemKey),{endpoint:f})}));te.label=3;case 3:l=i.recentItemSetKeyFacet.serialize(A);T=h.recentGroupKeyFacet.serialize({relativeTime:"today"});N=h.recentGroupKeyFacet.serialize({relativeTime:"yesterday"});k=h.recentGroupKeyFacet.serialize({relativeTime:"thisWeek"});D=h.recentGroupKeyFacet.serialize({relativeTime:"lastWeek"});P=h.recentGroupKeyFacet.serialize({relativeTime:"twoWeeksAgo"});H=h.recentGroupKeyFacet.serialize({relativeTime:"threeWeeksAgo"});B=h.recentGroupKeyFacet.serialize({relativeTime:"lastMonth"});j=h.recentGroupKeyFacet.serialize({relativeTime:"twoMonthsAgo"});F=[];I=[];q=[];R=[];U=[];z=[];W=[];X=[];V="";$="date"===L;J=function(e){var t,r=e.driveItemKey,i=e.item,s=new c.ItemResolver;if(i&&r){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=m.driveItemKeyFacet.serialize(r);if($&&a){var l=new Date(a);switch(p.getRelativeDateBucketByDate(l)){case p.RelativeDateGroups.today:F.push(f);break;case p.RelativeDateGroups.yesterday:I.push(f);break;case p.RelativeDateGroups.thisWeek:q.push(f);break;case p.RelativeDateGroups.lastWeek:R.push(f);break;case p.RelativeDateGroups.twoWeeksAgo:U.push(f);break;case p.RelativeDateGroups.threeWeeksAgo:z.push(f);break;case p.RelativeDateGroups.lastMonth:W.push(f);break;case p.RelativeDateGroups.twoMonthsAgo:X.push(f);V=p.getMonthString[l.getMonth()]}}s.resolveItems({items:(t={},t[f]=n.__assign({},d.folderFacet.pack(void 0)),t)});return{itemResolver:s}}};K=!O&&$?function(t){var r,i,s=new c.ItemResolver;s.resolveItems({items:(r={},r[T]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Today")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:F})),r[N]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Yesterday")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:I})),r[k]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("This Week")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:q})),r[D]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Last Week")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:R})),r[P]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Two Weeks Ago")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:U})),r[H]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Three Weeks Ago")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:z})),r[B]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack("Last Month")),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:W})),r[j]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack(V)),u.isGroupFacet.pack(!0)),v.childItemsFacet.pack({itemKeys:X})),r)});var o=[];F.length>0&&o.push(T);I.length>0&&o.push(N);q.length>0&&o.push(k);R.length>0&&o.push(D);U.length>0&&o.push(P);z.length>0&&o.push(H);W.length>0&&o.push(B);X.length>0&&o.push(j);s.resolveItems({items:(i={},i[e.itemKey]=n.__assign({},v.childItemsFacet.pack({itemKeys:o})),i)});return{itemResolver:s}}:void 0;return[4,a(g.isConsumerDirectEndpoint(A.driveItemKey.endpoint))];case 4:Q=te.sent();G=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,a(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:O?"recentMedia":Q?"ODC-recent":"recent",itemKey:l,itemSetKeyFacet:i.recentItemSetKeyFacet,parentItemKeyFacet:o.recentRootItemKeyFacet,getUrl:function(e){var t=e.driveItemKey.endpoint+"/"+(e.driveItemKey.endpoint.indexOf("/v2.")>-1?"drives/me":"me/drive")+"/recent?";if(Q)t=e.driveItemKey.endpoint+"/drive/view.recent?";else if(O){return t+="$filter=(remoteItem/image ne null or remoteItem/video ne null)&$expand=thumbnails"}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],r=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?r.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||r.length>0?"&$filter="+(0===r.length?w.anyOf(t):0===t.length?w.allOf(r):w.allOf(n.__spreadArrays([w.anyOf(t)],r))):""})(C)},getDriveItemFacets:function(e){var t=E.getDriveItemFacets(e),r=e.driveItem,i=r.thumbnails,s=r.remoteItem,o=i||s&&s.thumbnails;return n.__assign(n.__assign({},t),o?n.__assign({},S.hasThumbnailAuthTokenFacet.pack(!1)):{})},expectedErrors:G,preprocessResponse:function(e){M?e=t.filterMediaContent(e,"image"):_&&(e=t.filterMediaContent(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:O?{Prefer:"ApiVersion=2.1,RecentOnlyMediaApp,NoPreAuthThumbnailUrls"}:{Prefer:"ApiVersion=2.1;ODC,returnparentresource,returnowner"},onProcessResponse:J,groupChildItems:K})))];case 5:Y=te.sent().itemResolver;O&&Y.resolveItems({items:(Z={},Z[e.itemKey]=n.__assign({},u.mediaGroupFacet.pack({})),Z)});Y.mapKeys({mappings:(ee={},ee[l]=e.itemKey,ee)});a(Y.execute());return[2]}})})}})});
define("nX",["require","exports","ww","K_","tc","I6","_y","Bc","$_","eC","Ki","Is"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=o.recentRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,p;return n.__generator(this,function(d){t=e(c.readConfiguration({groupBy:l.recentItemsGroupByFacet})).groupBy;(o=new a.ItemResolver).resolveItems({items:(p={},p[r]=n.__assign(n.__assign(n.__assign(n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:s.recentItemSetKeyFacet.serialize({driveItemKey:h,sortBy:"",isAscending:!0,groupBy:t||""})})),u.displayNameFacet.pack(f.default.recentTitle)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),p)});e(o.execute());return[2]})})}})});
define("ZJ",["require","exports","ww","K_","JJ","vO","my","Vb","n4","$_","Bc","tc","th","eY","Is","eC","Ki","MJ"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function y(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}t.savedForLaterItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,b,w,E,S,x;return n.__generator(this,function(T){switch(T.label){case 0:t=r(d.readConfiguration({saveForLaterGraphEndpoint:m.savedForLaterGraphEndpointConfigurationFacet})).saveForLaterGraphEndpoint;b=s.savedForLaterItemSetKeyFacet.deserialize(e.itemKey);if(!t||t===b.driveItemKey.endpoint)return[3,1];b=n.__assign(n.__assign({},b),{driveItemKey:n.__assign(n.__assign({},b.driveItemKey),{endpoint:t})});return[3,3];case 1:return[4,r(g.getOneDriveEndpoint({endpoint:b.driveItemKey.endpoint}))];case 2:(w=T.sent())!==b.driveItemKey.endpoint&&(b=n.__assign(n.__assign({},b),{driveItemKey:n.__assign(n.__assign({},b.driveItemKey),{endpoint:w})}));T.label=3;case 3:E=s.savedForLaterItemSetKeyFacet.serialize(b);S=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,r(i.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{itemKey:E,qosName:"savedForLater",itemSetKeyFacet:s.savedForLaterItemSetKeyFacet,parentItemKeyFacet:o.savedForLaterRootItemKeyFacet,getUrl:function(e){if(e.driveItemKey.endpoint===t){return e.driveItemKey.endpoint+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return e.driveItemKey.endpoint+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(e){var t,r,i=e.itemKey,s=e.driveItemKey,o=e.item,p=new f.ItemResolver;if(s&&o){var d=u.driveItemKeyFacet.serialize(s),v=a.driveFollowedItemKeyFacet.serialize({driveItemKey:s}),m=o&&(o.webDavUrl||o.webUrl);p.resolveItems({items:(t={},t[d]=n.__assign(n.__assign(n.__assign({},l.followedItemFacet.pack({itemKey:v})),l.canonicalUrlFacet.pack(m)),l.fileSizeFacet.pack(o.size)),t[v]=n.__assign(n.__assign({},l.isFollowedFacet.pack(!0)),h.getInvalidationFacet().forFacet(l.isFollowedFacet).thenInvalidate(i,c.childItemsFacet).pack()),t)});p.invalidateItems({items:(r={},r[i]=[c.childItemsFacet],r)})}return{itemResolver:p}},filterChildItems:y,getDriveItemFacets:function(e){var t=e.driveItem,r=t.root,i=t.remoteItem,s=t.name,o=r?v.default.files:s||i&&i.name||"",u=!t.webDavUrl,a=t.followed&&t.followed.followedDateTime;return n.__assign(n.__assign(n.__assign(n.__assign({},p.getDriveItemFacets(n.__assign(n.__assign({},e),{shouldReturnShareFacets:!1}))),l.fileNameFacet.pack(p.getFileName(o,u))),a?l.dateFollowedFacet.pack(new Date(a).getTime()):{}),l.folderFacet.pack(u?{}:void 0))},mapItemSetKey:function(){var t,n=new f.ItemResolver;n.mapKeys({mappings:(t={},t[E]=e.itemKey,t)});return{itemResolver:n}},expectedErrors:S})))];case 4:x=T.sent().itemResolver;r(x.execute());return[2]}})})}})});
define("tX",["require","exports","ww","K_","tc","vO","my","Bc","$_","eC"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=o.savedForLaterRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o;return n.__generator(this,function(c){(t=new a.ItemResolver).resolveItems({items:(o={},o[r]=n.__assign(n.__assign(n.__assign(n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:s.savedForLaterItemSetKeyFacet.serialize({driveItemKey:l,sortBy:"",isAscending:!0})})),u.displayNameFacet.pack(f.default.saved)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),o)});e(t.execute());return[2]})})}})});
define("QJ",["require","exports","ww","K_","fY","JJ","Jk","YJ"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a;return n.__generator(this,function(f){switch(f.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,r(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:"search",itemSetKeyFacet:i.searchItemSetKeyFacet,parentItemKeyFacet:u.searchRootItemKeyFacet,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return o.getDriveItemUrl(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:a=f.sent().itemResolver;r(a.execute());return[2]}})})}})});
define("aX",["require","exports","ww","K_","zJ","JJ","GJ"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(u){switch(u.label){case 0:return[4,r(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:"sharedByMe",itemSetKeyFacet:i.sharedByMeItemSetKeyFacet,parentItemKeyFacet:o.sharedByMeRootItemKeyFacet,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=u.sent().itemResolver;r(t.execute());return[2]}})})}})});
define("iX",["require","exports","ww","K_","GJ","tc","zJ","Bc","$_","eC"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.sharedByMeRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(c){(t=new a.ItemResolver).resolveItems({items:(i={},i[r]=n.__assign(n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:o.sharedByMeItemSetKeyFacet.serialize({driveItemKey:l})})),u.displayNameFacet.pack(f.default.sharedByMe)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),i)});e(t.execute());return[2]})})}})});
define("rX",["require","exports","ww","K_","Nb","JJ","Fx","Jk","uX","lX","Ki","Is","oX"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=i.sharedWithMeItemSetKeyFacet.deserialize(e.itemKey),p=r.filters,d=r.sortBy,v=r.isAscending;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,m,g,y,b,w,E,S;return n.__generator(this,function(x){switch(x.label){case 0:t=h.getSharedGroup(e.itemKey),m=t.onProcessResponse,g=t.groupChildItems;y=i.sharedWithMeItemSetKeyFacet.deserialize(e.itemKey);b=y.driveItemKey.endpoint;w=r(c.readConfiguration({graphSharedWithMeEndpoint:l.graphSharedWithMeEndpointConfigurationFacet})).graphSharedWithMeEndpoint;b=w||b;return[4,r(u.isConsumerDirectEndpoint(b))];case 1:E=x.sent();return[4,r(s.getAndProcessDriveItemSetData(n.__assign(n.__assign({},e),{qosName:"sharedWithMe",itemSetKeyFacet:i.sharedWithMeItemSetKeyFacet,parentItemKeyFacet:o.sharedWithMeRootItemKeyFacet,getUrl:function(e){return E?b+"/drive/view.sharedWithMe?allowExternal=true":b+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!a.filterItem(e,p)},sortChildItems:function(e){return f.sortItems(e,d,v,!0)},onProcessResponse:m,groupChildItems:g})))];case 2:S=x.sent().itemResolver;r(S.execute());return[2]}})})}})});
define("pX",["require","exports","ww","K_","Fx","tc","Nb","Bc","$_","eC"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.sharedWithMeRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(c){(t=new a.ItemResolver).resolveItems({items:(i={},i[r]=n.__assign(n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:o.sharedWithMeItemSetKeyFacet.serialize({driveItemKey:l,sortBy:"",isAscending:!0})})),u.displayNameFacet.pack(f.default.sharedWithMe)),u.folderFacet.pack({})),u.parentFolderItemFacet.pack(void 0)),i)});e(t.execute());return[2]})})}})});
define("RJ",["require","exports","ww","K_","NJ","Jk","Vb","eY","tc","RQ","$_","Os"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharesItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=i.sharesItemKeyFacet.deserialize(r),p=h.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:return[4,e(s.getRawData({url:s.getSharesItemUrl(h)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:p,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:t=E.sent();i=new l.ItemResolver;d=t&&t.parentReference;v=d&&d.driveId;m={endpoint:p,driveId:v,itemId:t.id};g=o.driveItemKeyFacet.serialize(m);y=d&&d.id?o.driveItemKeyFacet.serialize({endpoint:p,driveId:v,itemId:d.id}):void 0;i.resolveItems({items:(b={},b[g]=n.__assign(n.__assign(n.__assign({},u.getDriveItemFacets({driveItem:t,endpoint:p,parentFolderItemKey:y})),c.preferredKeyFacetFacet.pack(o.driveItemKeyFacet)),a.defaultChildItemSetFacet.pack({itemKey:f.driveItemSetKeyFacet.serialize({driveItemKey:m,sortBy:"",isAscending:!0})})),b)});i.mapKeys({mappings:(w={},w[g]=r,w)});e(i.execute());return[2]}})})}})});
define("_X",["require","exports","ww","K_","yJ","Jk","Vb","eY","tc","RQ","$_","Os"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialDriveItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=i.specialDriveItemKeyFacet.deserialize(r),p=h.driveId,d=h.endpoint,v=s.getDriveUrl(h);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,m,g,y,b,w,E,S;return n.__generator(this,function(x){switch(x.label){case 0:return[4,e(s.getRawData({url:s.getSpecialDriveItemUrl(h),driveUrl:v,qosName:"getItem",endpoint:d}))];case 1:t=x.sent();i=new l.ItemResolver;m=t&&t.parentReference;g=m&&m.driveId;y={endpoint:d,driveId:g||p,itemId:t.id};b=o.driveItemKeyFacet.serialize(y);w=m&&m.id?o.driveItemKeyFacet.serialize({endpoint:d,driveId:g,itemId:m.id}):void 0;i.resolveItems({items:(E={},E[b]=n.__assign(n.__assign(n.__assign({},u.getDriveItemFacets({driveItem:t,endpoint:d,parentFolderItemKey:w})),c.preferredKeyFacetFacet.pack(o.driveItemKeyFacet)),a.defaultChildItemSetFacet.pack({itemKey:f.driveItemSetKeyFacet.serialize({driveItemKey:y,sortBy:"",isAscending:!0})})),E)});i.mapKeys({mappings:(S={},S[b]=r,S)});e(i.execute());return[2]}})})}})});
define("DJ",["require","exports","ww","$k","$_","K_","qI","QI","Jk"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailUrlTokenOperationHandler=s.createSingleItemOperationHandler()(function(e){var t=this,s=e.itemKey,f=u.thumbnailTokenKeyFacet.deserialize(s),l=f.endpoint,c=f.driveId;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,f,h,p;return n.__generator(this,function(d){switch(d.label){case 0:t=a.getDriveUrl({endpoint:l,driveId:c});return[4,e(r.getSessionToken(l,t))];case 1:u=d.sent();f=u&&u.accessToken;(h=new i.ItemResolver).resolveItems({items:(p={},p[s]=n.__assign({},o.thumbnailAccessTokenFacet.pack(f)),p)});e(h.execute());return[2]}})})}})});
define("SY",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveFacet=new n.Facet("addToOneDrive");t.createFolderFacet=new n.Facet("createFolder");t.createLinkFacet=new n.Facet("createLink");t.deleteFacet=new n.Facet("delete");t.downloadFacet=new n.Facet("download");t.inviteFacet=new n.Facet("invite");t.moveFacet=new n.Facet("move");t.officeLensFacet=new n.Facet("officeLens");t.renameFacet=new n.Facet("rename");t.uploadFacet=new n.Facet("upload")});
define("rY",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemResponseFacet=new n.Facet("driveItemResponse")});
define("IN",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shortcutExistedAlreadyFacet=new n.Facet("shortcutExistedAlready");t.nestedDescendantShortcutExistsFacet=new n.Facet("nestedDescendantShortcutExists");t.nestedAscendantShortcutExistsFacet=new n.Facet("nestedAscendantShortcutExists")});
define("YI",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphThumbnailSetFacet=new n.Facet("graphThumbnailSet")});
define("JI",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hasPdfFacet=new n.Facet("hasPdfFacet")});
define("WI",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hasThumbnailAuthTokenFacet=new n.Facet("hasThumbnailAuthTokenFacet")});
define("tJ",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetEngagementExtraDataFacet=new n.Facet("itemSetEngagementExtraData")});
define("aY",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.officeAppFacet=new n.Facet("officeApp")});
define("AN",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharepointIdsFacet=new n.Facet("sharepointIds")});
define("oY",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByPersonFacet=new n.Facet("sharedBy")});
define("iz",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedFacet=new n.Facet("shared")});
define("tY",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialFolderFacet=new n.Facet("specialFolder")});
define("qI",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailAccessTokenFacet=new n.Facet("thumbnailAccessToken")});
define("UI",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPrintFileUrlOperation=new n.Facet("getPrintFileUrlOperation");t.universalPrintGetFileUrlItemFacet=new n.Facet("universalPrintGetFileUrlItem");t.getPrintFileUrlItem=r.implementOperation({operationTypeFacet:t.getPrintFileUrlOperation})});
define("iY",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.vaultFacet=new n.Facet("vault")});
define("yY",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandsItemKeyFacet=new n.KeyFacet("commands",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0})})});
define("FJ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemByCanonicalUrlKeyFacet=new n.KeyFacet("driveItem",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0}),canonicalUrl:n.stringPart()})});
define("KJ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPageKeyFacet=new n.KeyFacet("driveItemPage",{endpoint:n.stringPart(),setItemKey:n.stringPart(),token:n.stringPart()})});
define("RQ",["require","exports","Ji","Vb","Bb"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetKeyFacet=new n.KeyFacet("driveItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet),sortBy:n.stringPart(),isAscending:n.booleanPart(),extFilters:n.arrayPart(n.stringPart()),filters:n.arrayPart(n.subKeyPart(i.driveFilterKeyFacet)),groupBy:n.stringPart()})});
define("EJ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemVirtualizedPageKeyFacet=new n.KeyFacet("driveItemVirtualizedPage",{endpoint:n.stringPart(),setItemKey:n.stringPart(),skip:n.numberPart(),top:n.numberPart()})});
define("aJ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentGroupKeyFacet=new n.KeyFacet("recentGroup",{relativeTime:n.stringPart()})});
define("fY",["require","exports","Ji","Vb"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemSetKeyFacet=new n.KeyFacet("searchItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet),searchTerm:n.stringPart()})});
define("YJ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchRootItemKeyFacet=new n.KeyFacet("searchRootItem",{endpoint:n.stringPart()})});
define("zJ",["require","exports","Ji","Vb"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeItemSetKeyFacet=new n.KeyFacet("sharedByMeItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet)})});
define("GJ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemKeyFacet=new n.KeyFacet("sharedByMeRootItem",{endpoint:n.stringPart()})});
define("PQ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupBySharedByKeyFacet=new n.KeyFacet("SharedByPersonKeyFacet",{displayName:n.stringPart(),email:n.stringPart()});t.groupByDateSharedKeyFacet=new n.KeyFacet("dateSharedGroupKeyFacet",{relativeTime:n.stringPart(),sharedDateTime:n.stringPart()});t.groupByRelativeTimeKeyFacet=new n.KeyFacet("relativeTimeGroupKeyFacet",{relativeTime:n.stringPart()})});
define("NJ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharesItemKeyFacet=new n.KeyFacet("sharesItem",{endpoint:n.stringPart(),shareId:n.stringPart()})});
define("yJ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialDriveItemKeyFacet=new n.KeyFacet("specialDriveItem",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0}),name:n.stringPart()})});
define("QI",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailTokenKeyFacet=new n.KeyFacet("thumbnailToken",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0})})});
define("AQ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.topCollaboratorItemKeyFacet=new n.KeyFacet("topCollaboratorItemKeyFacet",{id:n.stringPart()})});
define("LQ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.topCollaboratorSetKeyFacet=new n.KeyFacet("topCollaboratorSetKeyFacet",{endpoint:n.stringPart()})});
define("ZQ",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.userByEmailKeyFacet=new n.KeyFacet("userByEmail",{email:n.stringPart(),endpoint:n.stringPart()})});
define("sY",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.userByIdKeyFacet=new n.KeyFacet("userById",{id:n.stringPart(),endpoint:n.stringPart()})});
define("gN",["require","exports","ww","kb","K_","G_","ih","Z_","we","vN","P7"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var h=((c={})[o.ProgressPhase.started]=function(e){return a.formatToArray(a.getLocalizedCountValue(f.default.removeFromOneDriveStartedTitle,f.default.removeFromOneDriveStartedTitleIntervals,e)||"",e)},c[o.ProgressPhase.completed]=function(e){return a.formatToArray(a.getLocalizedCountValue(f.default.removeFromOneDriveCompletedTitle,f.default.removeFromOneDriveCompletedTitleIntervals,e)||"",e)},c[o.ProgressPhase.failed]=function(e){return a.formatToArray(a.getLocalizedCountValue(f.default.removeFromOneDriveFailedTitle,f.default.removeFromOneDriveFailedTitleIntervals,e)||"",e)},c[o.ProgressPhase.canceled]=function(e){return a.formatToArray(a.getLocalizedCountValue(f.default.removeFromOneDriveFailedTitle,f.default.removeFromOneDriveFailedTitleIntervals,e)||"",e)},c);function p(e,t){var r=u.getOverallSimpleProgressBreakdown(e,t),i=r.count,s=r.phase,o=h[s](i);return n.__assign({},o&&"item"!==t.format?{title:o}:{})}function d(){return function(e){return p}}t.removeFromOneDriveProgressAddon=i.createAddon(function(){return function(e){e(r.registerControlHandler(l.removeFromOneDriveProgressKeyFacet,s.progressControl)(r.createControlHandler()(d)))}})});
define("SN",["require","exports","ww","we","r","ih","G_","Zv","Z_","xN","K_","kb","M9","Es","Ms","Mc","K_","vL","yL","IN","Ki","DN","SL","tc","Vb","Bc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveProgressAddon=l.createAddon(function(){return function(e){e(c.registerControlHandler(h.addToOneDriveProgressKeyFacet,o.progressControl)(c.createControlHandler()(C)));e(m.registerOperationHandler(h.addToOneDriveProgressKeyFacet,y.retryProgressItemsOperation)(g.createRetryProgressItemsOperationHandler(h.addToOneDriveProgressKeyFacet,h.addToOneDriveOperation)))}});function C(){return function(e){return k}}function k(e,t){var o,l,c,h,m,g=a.getOverallSimpleProgressBreakdown(e,t),y=g.phase,C=g.count,k=e.demandItemFacet(p.errorFacet,t.itemKey),L=(u.getConfiguration(e,{addToOneDriveConfgiuration:w.addToOneDriveConfgiurationFacet}).addToOneDriveConfgiuration||{}).hostAppIsOneDrive;if(k&&k instanceof d.ItemOperationError){o=b.shortcutExistedAlreadyFacet.unpack(k.facets);l=b.nestedAscendantShortcutExistsFacet.unpack(k.facets);c=b.nestedDescendantShortcutExistsFacet.unpack(k.facets)}var A=[],O=(function(e){var t;return(t={})[s.ProgressPhase.started]=function(t){var n=t.count;return r.formatToArray(r.getLocalizedCountValue(e?f.default.addToOneDriveStartedItemsTitle:f.default.addToOneDriveHostOutOfODStartedItemsTitle,f.default.addToOneDriveCompletedItemsTitleIntervals,n)||"",n)},t[s.ProgressPhase.completed]=function(t){var n=t.count,i=t.itemLink;return r.formatToArray(r.getLocalizedCountValue(e?f.default.addToOneDriveCompletedItemsTitle:f.default.addToOneDriveHostOutOfODCompletedItemsTitle,f.default.addToOneDriveCompletedItemsTitleIntervals,n)||"",n,i)},t[s.ProgressPhase.failed]=function(e){var t=e.count;return r.formatToArray(r.getLocalizedCountValue(f.default.addToOneDriveFailedItemsTitle,f.default.addToOneDriveFailedItemsTitleIntervals,t)||"",t)},t[s.ProgressPhase.canceled]=function(e){var t=e.count;return r.formatToArray(r.getLocalizedCountValue(f.default.addToOneDriveFailedItemsTitle,f.default.addToOneDriveFailedItemsTitleIntervals,t)||"",t)},t})(L);if("completed"===y){var M=(function(e,t){var n=(function(e,t){var n=void 0,r=void 0,i=void 0,o=void 0;i=e.demandItemFacet(s.sourceItemFacet,t.itemKey);n=i&&i.itemKey;o=e.demandItemFacet(N.parentFolderItemFacet,n);r=o&&o.itemKey;if(!n){var u=e.demandItemFacet(x.childItemsFacet,t.itemKey);if(u)for(var a=0,f=u.itemKeys;a<f.length;a++){var l=f[a];i=e.demandItemFacet(s.sourceItemFacet,l);n=i&&i.itemKey;var c=(o=e.demandItemFacet(N.parentFolderItemFacet,n))&&o.itemKey;if(c)if(r){if(c!==r)break}else r=c}}return{sourceItemKey:n,parentItemKey:r}})(e,{itemKey:t.itemKey}).sourceItemKey,r=(function(e,t){var n,r=e.demandItemFacet(T.driveItemKeyFacet,t.itemKey),i=r&&r.endpoint;i&&(n=T.driveItemKeyFacet.serialize({endpoint:i,driveId:"me",itemId:"root"}));return n})(e,{itemKey:n});return i.createElement(S.ItemLink,{key:"link",itemKey:r},f.default.addToOneDriveMyFiles)})(e,{itemKey:t.itemKey});h=O[y]({count:C,itemLink:M})}else h=O[y]({count:C});if(y===s.ProgressPhase.failed){var _,D=void 0,P=void 0;if(o){m=f.default.a2odErrorMessageAlreadyExisted;D=o.existShortcutUrl;_=o.existShortcutName}else if(l){D=l.existShortcutUrl;_=l.existShortcutName;m=r.formatToArray(f.default.a2odErrorMessageAscendantExists,_)}else if(c){m=r.formatToArray(f.default.a2odErrorMessageDescendantExists,t.title);P=c.nestDescendantItemKeys}if(D){var H=(function(e){var t=this,r=e.url;return i.createElement(v.Action,{onExecute:function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){window.open(r);return[2]})})}})})({url:D});A.push({key:"navigateToShortcut",name:f.default.a2odOpenExistedShortcutFolderCommand,action:H})}else P&&P.length>0&&A.push({key:"replaceShortcut",name:f.default.a2odReplaceExistedShortcutCommand,action:i.createElement(E.RetryReplaceShortcutProgressAction,{existedDescendants:P})})}return n.__assign(n.__assign(n.__assign({},h&&"item"!==t.format?{title:h}:{}),m?{description:m}:{}),{commands:A})}});
define("P7",["require","exports","qi","Z_","Ms"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromOneDriveOperation=new n.Facet("removeFromOneDrive");t.removeFromOneDriveProgressKeyFacet=new r.ProgressKeyFacet("removeFromOneDrive");t.removeFromOneDrive=i.implementOperation({operationTypeFacet:t.removeFromOneDriveOperation})});
define("GQ",["require","exports","ww","we","ih","G_","Z_","KQ","K_","kb","zU"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var h=((c={})[i.ProgressPhase.started]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeStartedItemsTitle,u.default.removeCompletedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.completed]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeCompletedItemsTitle,u.default.removeCompletedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.failed]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeFailedItemsTitle,u.default.removeFailedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.canceled]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeFailedItemsTitle,u.default.removeFailedItemsTitleIntervals,e)||"",e)},c);t.removeFromSharedListProgressAddon=a.createAddon(function(){return function(e){e(f.registerControlHandler(l.removeFromSharedListProgressKeyFacet,s.progressControl)(f.createControlHandler()(p)))}});function p(){return function(e){return d}}function d(e,t){var r,i=o.getOverallSimpleProgressBreakdown(e,t),s=i.phase,u=i.count;r=h[s](u);return n.__assign({},r&&"item"!==t.format?{title:r}:{})}});
define("zU",["require","exports","qi","Z_"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeItemsFromSharedListOperation=new n.Facet("removeItemsFromSharedList");t.removeFromSharedListProgressKeyFacet=new r.ProgressKeyFacet("removeItemsFromSharedList");t.removeItemsFromSharedList=r.implementOperationWithProgress({operationTypeFacet:t.removeItemsFromSharedListOperation,progressKeyFacet:t.removeFromSharedListProgressKeyFacet})});
define("lY",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ROOT_ITEM_ID="root";t.CONSUMER_ROOT_ITEM_PATH="/drive/root:";t.DEFAULT_PAGE_SIZE=30});
define("JJ",["require","exports","ww","Jk","TJ"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAndProcessDriveItemSetData=function(e){var t=this,s=e.itemKey,o=e.itemSetKeyFacet,u=e.getUrl,a=e.sortChildItems,f=e.qosName,l=e.preprocessResponse,c=e.expectedErrors,h=o.deserialize(s),p=h.driveItemKey.endpoint;return function(s){return n.__awaiter(t,void 0,void 0,function(){var t,o,d,v,m;return n.__generator(this,function(g){switch(g.label){case 0:t=r.getDriveUrl(h.driveItemKey);return[4,s(r.getRawDataWithCache({url:u(h),driveUrl:t,qosName:"getChildren"+(f?"."+f:""),endpoint:p,headers:e.additionalHeaders,expectedErrors:c}))];case 1:o=g.sent();d=n.__spreadArrays(o.value);v=l?l(d):o.value;m=a?a(v):v;return[4,s(i.processDriveItemSet(n.__assign(n.__assign({},e),{childItemsResponse:n.__assign(n.__assign({},o),{value:m})})))];case 2:return[2,{itemResolver:g.sent().itemResolver}]}})})}}});
define("eY",["require","exports","ww","Wi","Bc","tc","Vb","RQ","YI","rY","a4","iz","eC","C6","nm","vD","iY","M7","aY","nY","AN","tY","WI","th","JI","NI"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveItemFacets=function(e){var t,L=e.driveItemKey,A=e.driveItem,O=e.endpoint,M=e.parentFolderItemKey,_=e.shouldReturnShareFacets,D=void 0===_||_,P=A.file,H=A.fileSystemInfo,B=A.name,j=A.parentReference,F=A.remoteItem,I=A.root,q=A.size,R=A.thumbnails,U=A.image,z=A.video,W=A.eTag,X=A.specialFolder,V=A.lastModifiedDateTime,$=void 0===V?H&&H.lastModifiedDateTime||F&&F.lastModifiedDateTime:V,J=A.createdDateTime||H&&H.createdDateTime||F&&F.createdDateTime,K=j&&j.driveId,Q=j&&j.driveType||F&&F.parentReference&&F.parentReference.driveType,G="personal"===Q,Y=H&&H.lastAccessedDateTime||F&&F.fileSystemInfo&&F.fileSystemInfo.lastAccessedDateTime,Z=A.package||F&&F.package,ee=R||F&&F.thumbnails,te=U||F&&F.image,ne=z||F&&F.video,re=A.shared||F&&F.shared,ie={itemId:A.id,driveId:K,endpoint:O},se=H&&H.systemPath,oe=L||F&&F.parentReference&&{itemId:F.id,driveId:F.parentReference.driveId,endpoint:O}||ie,ue=o.driveItemKeyFacet.serialize(oe),ae=A.webDavUrl||F&&F.webDavUrl;t="business"!==Q&&"documentLibrary"!==Q&&"personal"!==Q||!I?B||F&&F.name||"":h.default.files;var fe=A.folder||F&&F.folder,le=q||F&&F.size,ce=fe&&fe.childCount,he=k(t,!!fe),pe=he.extension&&b.getOfficeAppFromExtension(he.extension),de=A.sharepointIds||F&&F.sharepointIds,ve=A.localItem,me=A.webUrl||F&&F.webUrl;return n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},o.driveItemKeyFacet.pack(oe)),i.displayNameFacet.pack(t)),void 0!==le?i.fileSizeFacet.pack(le):{}),H||A.folder||P||F&&F.folder?n.__assign({},i.folderFacet.pack(fe?{}:void 0)):{}),me?i.openUrlFacet.pack(me):{}),g.systemFilePathFacet.pack(se)),ae?i.canonicalUrlFacet.pack(decodeURIComponent(ae)):{}),i.dateModifiedFacet.pack($?new Date($).getTime():void 0)),i.dateCreatedFacet.pack(J?new Date(J).getTime():void 0)),Y?n.__assign({},i.dateAccessedFacet.pack(new Date(Y).getTime())):{}),r.oneNoteFacet.pack(Z&&"oneNote"===Z.type?{}:void 0)),ee?n.__assign(n.__assign(n.__assign({},a.graphThumbnailSetFacet.pack(ee)),S.hasThumbnailAuthTokenFacet.pack(!0)),T.hasPdfFacet.pack(N.isFileTransformableToPdf(he.extension))):{}),x.getInvalidationFacet().forFacet(p.thumbnailFacet).thenInvalidate(ue,a.graphThumbnailSetFacet).pack()),f.driveItemResponseFacet.pack(A)),W?i.eTagFacet.pack(W):{}),te&&te.width&&te.height?p.dimensionsFacet.pack({width:te.width,height:te.height}):{}),te&&!ne?p.photoFacet.pack({}):{}),ne?p.videoFacet.pack({}):{}),s.defaultChildItemSetFacet.pack({itemKey:u.driveItemSetKeyFacet.serialize({driveItemKey:oe,sortBy:"",isAscending:!0})})),i.analyticsItemFacet.pack({itemKey:l.driveAnalyticsItemKeyFacet.serialize({driveItemKey:oe})})),i.parentFolderItemFacet.pack(M?{itemKey:M}:void 0)),!G&&ae?n.__assign({},i.parentFolderItemNameFacet.pack(C(ae))):{}),v.driveTypeFacet.pack(Q)),G?n.__assign({},m.vaultFacet.pack(A.vault)):{}),i.fileNameFacet.pack(he)),D?n.__assign(n.__assign({},i.isSharedFacet.pack(!!re)),c.sharedFacet.pack(re)):{}),ve?g.localItemFacet.pack(ve):{}),"number"==typeof ce?d.countFacet.pack(ce):{}),g.mimeTypeFacet.pack(P&&P.mimeType)),pe?y.officeAppFacet.pack(pe):{}),de?w.sharepointIdsFacet.pack(de):{}),X?E.specialFolderFacet.pack(X.name):{})};function C(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0}t.getParentFolder=C;function k(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}t.getFileName=k});
define("PJ",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}t.anyOf=r;function i(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}t.allOf=i;t.getExtFiltersParams=function(e){if(!e||0===e.length)return"";for(var t=[],s=[],o=0;o<e.length;o++){var u=e[o],a=!1,f=u;if("!"===u[0]){f=u.slice(1);a=!0}if("folder"===f)!a&&t.push("folder ne null");else if("."!==f[0]);else{t=[];s=[]}}return t.length>0||s.length>0?"&$filter="+(0===s.length?r(t):0===t.length?i(s):i(n.__spreadArrays([r(t)],s))):""};t.getChildrenItemFilter=function(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:void 0===n?!r:n&&!r}}});
define("MJ",["require","exports","ww","Is","Ki"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getOneDriveEndpoint=function(e){var t=this;return function(s){return n.__awaiter(t,void 0,void 0,function(){var t,o,u,a,f;return n.__generator(this,function(n){switch(n.label){case 0:t=e.endpoint;o=s(r.readConfiguration({getUserOneDriveEndpoint:i.getUserOneDriveEndpointFacet,graphEndpoint:i.graphEndpointConfigurationFacet})),u=o.getUserOneDriveEndpoint;return(a=o.graphEndpoint)&&t!==a&&u?[4,s(u({endpoint:t}))]:[3,2];case 1:f=n.sent();t=f;n.label=2;case 2:return[2,t]}})})}}});
define("vY",["require","exports","ww","iz","SY","yY","Vb","cs","Wi"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.canAddToOneDriveFacet=new u.ComputedItemFacet("addToOneDrive",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.addToOneDriveFacet}))});t.canCreateFolderFacet=new u.ComputedItemFacet("canCreateFolder",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.createFolderFacet}))});t.canCreateLinkFacet=new u.ComputedItemFacet("canCreateLink",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.createLinkFacet}))});t.canDeleteFacet=new u.ComputedItemFacet("canDelete",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.deleteFacet}))});t.canDownloadFacet=new u.ComputedItemFacet("canDownload",function(e,t){return!e.demandItemFacet(a.oneNoteFacet,t.itemKey)&&f(e,n.__assign(n.__assign({},t),{commandFacet:i.downloadFacet}))});t.canInviteFacet=new u.ComputedItemFacet("canInvite",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.inviteFacet}))});t.canMoveFacet=new u.ComputedItemFacet("canMove",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.moveFacet}))});t.canUseOfficeLensFacet=new u.ComputedItemFacet("canUseOfficeLens",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.officeLensFacet}))});t.canRenameFacet=new u.ComputedItemFacet("canRename",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.renameFacet}))});t.canUploadFacet=new u.ComputedItemFacet("canUpload",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.uploadFacet}))});function f(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(o.driveItemKeyFacet,n);if(!i)return!1;var u=i.endpoint,a=i.driveId,f=e.demandItemFacet(r,s.commandsItemKeyFacet.serialize({endpoint:u,driveId:a}));return!!f&&!!f.roles&&l(e,{itemKey:n,oneOfRequiredRoles:f.roles})}t.hasPermission=f;function l(e,t){var n=t.itemKey;return c(e,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:p(e,n)})}t.hasRequiredItemRole=l;function c(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1}t.hasRequiredRole=c;function h(e,t){var n=e.demandItemFacet(r.sharedFacet,t);return!n||!n.effectiveRoles||!n.owner}t.isOwner=h;function p(e,t){if(h(e,t))return["read","write","owner"];var n=e.demandItemFacet(r.sharedFacet,t);return n&&n.effectiveRoles?n.effectiveRoles:[]}t.getEffectiveItemRoles=p});
define("vWe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(t.ItemAutoRefreshChangeType||(t.ItemAutoRefreshChangeType={}))});
define("CWe",["require","exports","ww","tc","Bc","$_","Yb","Le","r4","IWe","nM","W","vWe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=1e4,d={ODB:819,ODC:"EnablePushChannelLogging"},v={ODB:459},m=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new o.default;var e=t._async.debounce(function(){return t._onNotification()},p,{leading:!0,maxWait:p});t._pushChannelService.setupNotificationHandler({source:f.NotificationSource.WebhookSubscription},function(){t._log("PushChannelMessageSource",f.NotificationSource.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:f.NotificationSource.EventHub},function(){t._log("PushChannelMessageSource",f.NotificationSource.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?a.getUrlParts(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:f.NotificationSource.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i=this;return n.__generator(this,function(n){switch(n.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if("latest"!==this._syncToken)return[3,4];n.label=1;case 1:n.trys.push([1,3,,4]);return[4,this._getChangeMessages()];case 2:n.sent();return[3,4];case 3:t=n.sent();this._getChangesAttempts++;if(this._getChangesAttempts>10)return[2];r=!1;if(l.isGraphError(t))switch(t.status){case 404:case 410:r=!0;this._syncToken="latest"}r&&this._async&&this._async.setTimeout(function(){return i._onPushChannelConnection(i._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts));return[2];case 4:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var r=105001*Math.random()+15e3,i=Date.parse(t.expirationDateTime),s=Date.now(),o=i-s-r;if(o<12e4){if(u.default.isFeatureEnabled(v)){var a={refreshDelay:o,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:i,dateTimeNow:s,recreateBufferRandom:r};new c.default({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:a}).end({resultType:c.ResultTypeEnum.Failure,extraData:a})}o=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},o)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,o,u,a,f,l,c,p,d;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);e=new s.ItemResolver;return[4,this._getChangeMessages()];case 1:t=n.sent();this._log("Change messages",t);o=this._processMessages(t.messages);this._log("Changes",o);e.merge(t.itemResolver);for(u=0,a=o;u<a.length;u++)switch((f=a[u]).type){case h.ItemAutoRefreshChangeType.New:e.invalidateItems({items:(c={},c[f.invalidateKey]=[r.defaultChildItemSetFacet],c)});break;case h.ItemAutoRefreshChangeType.Update:f.hasSelection&&this._itemScopeItemKey?this._updateItems(f.invalidateKey):e.invalidateItems({items:(p={},p[f.invalidateKey]=[f.invalidateFacet],p)});break;case h.ItemAutoRefreshChangeType.Delete:e.invalidateItems({items:(d={},d[f.invalidateKey]=[i.deletedFacet],d)})}this._dispatch(e.execute());return[3,3];case 2:l=n.sent();this._log("onNotification error",l);return[3,3];case 3:return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];u.default.isFeatureEnabled(d)&&console.log.apply(console,n.__spreadArrays(["ItemAutoRefreshHelper"],e))};return e})();t.default=m});
define("kJ",["require","exports","ww","RQ","Vb","$_","cc","Jk","nm","TJ","PJ","vD","Es","MJ","Oo","I4"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadAndProcessPagedDriveItemSet=function(e){var t=this;return function(m){return n.__awaiter(t,void 0,void 0,function(){var t,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q;return n.__generator(this,function(G){switch(G.label){case 0:t=e.itemKey,g=e.top,y=e.skip;b=r.driveItemSetKeyFacet.deserialize(t);w=b.driveItemKey,E=b.extFilters;S=b.sortBy,x=b.isAscending;T=b;N=w;return w.driveId&&"me"!==w.driveId?[3,2]:[4,m(p.getOneDriveEndpoint({endpoint:w.endpoint}))];case 1:if((C=G.sent())!==w.endpoint){N=n.__assign(n.__assign({},w),{endpoint:C});T=n.__assign(n.__assign({},b),{driveItemKey:N})}G.label=2;case 2:k=i.driveItemKeyFacet.serialize(N);L=u.getDriveUrl(N);return[4,m(o.readItems(function(e){return{isParentItemResolved:e.isItemFacetResolved(i.driveItemKeyFacet,k),totalChildCount:e.isItemFacetResolved(a.countFacet,k)?e.demandItemFacet(a.countFacet,k):void 0,driveType:e.isItemFacetResolved(c.driveTypeFacet,k)?e.demandItemFacet(c.driveTypeFacet,k):void 0}}))];case 3:A=G.sent(),O=A.isParentItemResolved,M=A.totalChildCount,_=A.driveType;D=Promise.resolve(void 0);O||(D=m(u.getRawDataWithCache({url:u.getDriveItemUrl(N),driveUrl:L,qosName:"getItem",endpoint:N.endpoint})));P=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"}];H=u.getDriveItemUrl(w);B=y?"&skiptoken="+(y+1)+"/"+M+"&skip="+y:"";j=S&&void 0!==x?u.getOrderByQueryParamString(S,x):"";F=l.getExtFiltersParams(E);I=m(u.getRawDataWithCache({url:H+"/children?$top="+g+B+j+"&$expand=thumbnails&select=*,webDavUrl"+F,driveUrl:L,qosName:"getChildren.folder",endpoint:N.endpoint,expectedErrors:P}));q=[I,D];R=!1;if(!d.getMarkTime(v.itemsViewPerfMarkers.dataFetch.start)){d.mark(v.itemsViewPerfMarkers.dataFetch.start);R=!0}return[4,Promise.all(q)];case 4:U=G.sent(),z=U[0],W=U[1];R&&d.mark(v.itemsViewPerfMarkers.dataFetch.end);if(W){W.folder&&(M=W.folder.childCount);W.parentReference&&W.parentReference.driveType&&(_=W.parentReference.driveType)}X=m(u.supportsDriveItemSetRandomAccess(N.endpoint,_));(V=new s.ItemResolver).mapKeys({mappings:(K={},K[r.driveItemSetKeyFacet.serialize(T)]=e.itemKey,K[k]=i.driveItemKeyFacet.serialize(b.driveItemKey),K)});b.driveItemKey.driveId&&"me"!==b.driveItemKey.driveId||V.mapKeys({mappings:(Q={},Q[i.driveItemKeyFacet.serialize(n.__assign(n.__assign({},b.driveItemKey),{driveId:"me"}))]=i.driveItemKeyFacet.serialize(n.__assign(n.__assign({},b.driveItemKey),{driveId:""})),Q)});J=($=V).merge;return[4,m(f.processDriveItemSet({itemKey:t,itemSetKeyFacet:r.driveItemSetKeyFacet,parentItemKeyFacet:i.driveItemKeyFacet,parentItemResponse:W,childItemsResponse:z,filterChildItems:E&&E.length>0?l.getChildrenItemFilter(E):void 0,skip:y,enableRandomAccess:X,totalChildCount:M,onProcessResponse:function(e){var t,r=e.driveItemKey,o=new s.ItemResolver;r&&o.resolveItems({items:(t={},t[i.driveItemKeyFacet.serialize(r)]=n.__assign({},h.resolvedAsKeyFacetFacet.pack(i.driveItemKeyFacet)),t)});return{itemResolver:o}}}))];case 5:J.apply($,[G.sent().itemResolver]);return[2,V]}})})}}});
define("nY",["require","exports","oT"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getOfficeAppFromExtension=function(e){var t=e.replace(".",""),r=Object.keys(n.OfficeAppToExtensionsMap);for(var i in r)if(n.OfficeAppToExtensionsMap.hasOwnProperty(r[i])){var s=r[i];if(n.OfficeAppToExtensionsMap[s].indexOf(t)>-1)return s}}});
define("$Q",["require","exports","ww","th","Bc","tc","$_","t4","Ah","sY","k6","oY","ZQ","eY"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItem=function(e){var t,l=e.itemKey,v=e.driveItemKey,m=e.parentFolderItemKey,g=e.setItemKey,y=e.driveItemResponse,b=e.endpoint,w=e.getDriveItemFacets,E=void 0===w?p.getDriveItemFacets:w,S=e.shouldInvalidateItemSetOnChildItemRename,x=void 0===S?void 0:S,T=new o.ItemResolver,N=u.driveActivityItemKeyFacet.serialize({driveItemKey:v}),C=void 0;if(g){var k=r.getInvalidationFacet().forFacet(i.deletedFacet).thenInvalidate(g,s.childItemsFacet).forFacet(i.parentFolderItemFacet).thenInvalidate(g,s.childItemsFacet);x&&!x(b)||(k=k.forFacet(i.displayNameFacet).thenInvalidate(g,s.childItemsFacet));C=k.pack()}var L=n.__assign(n.__assign(n.__assign({},E({driveItemKey:v,driveItem:y,endpoint:b,parentFolderItemKey:m})),i.activityItemFacet.pack({itemKey:N})),C);T.resolveItems({items:(t={},t[l]=L,t)});if(y.lastModifiedBy){if(_=y.lastModifiedBy.user){var A=_.id&&f.userByIdKeyFacet.serialize({id:_.id,endpoint:b});if(A=_.email&&h.userByEmailKeyFacet.serialize({email:_.email,endpoint:b})){var O=d({itemKey:l,personFacet:i.modifiedByPersonFacet,userKey:A,user:_}).itemResolver;T.merge(O)}}}if(y.createdBy){var M=void 0;if((_=y.createdBy.user)&&_.email&&(M=h.userByEmailKeyFacet.serialize({email:_.email,endpoint:b}))){O=d({itemKey:l,personFacet:a.createdByPersonFacet,userKey:M,user:_}).itemResolver;T.merge(O)}}if(y.remoteItem&&y.remoteItem.shared&&y.remoteItem.shared.sharedBy&&y.remoteItem.shared.sharedBy.user){var _,D=void 0;if((_=y.remoteItem.shared.sharedBy.user).email&&(D=h.userByEmailKeyFacet.serialize({email:_.email,endpoint:b}))){O=d({itemKey:l,personFacet:c.sharedByPersonFacet,userKey:D,user:_}).itemResolver;T.merge(O)}}return{itemResolver:T}};function d(e){var t,r,s=e.itemKey,u=e.personFacet,a=e.userKey,f=e.user,c=new o.ItemResolver;c.resolveItems({items:n.__assign((t={},t[a]=n.__assign(n.__assign(n.__assign({},i.displayNameFacet.pack(f.displayName)),l.emailFacet.pack(f.email)),l.sipFacet.pack(f.id)),t),u&&(r={},r[s]=n.__assign({},u.pack({itemKey:a,displayValue:f.displayName})),r))});return{itemResolver:c}}t.resolveUserItems=d});
define("TJ",["require","exports","ww","HJ","th","tc","UJ","I4","Oo"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItemSet=function(e){var t=e.itemKey,f=e.itemSetKeyFacet,l=e.parentItemKeyFacet,c=e.childItemsResponse,h=e.parentItemResponse,p=e.mapItemSetKey,d=f.deserialize(t),v=l.serialize(d.driveItemKey),m=d.driveItemKey.endpoint;return function(f){var l;a.mark(u.itemsViewPerfMarkers.processData.start);var d=f(r.processDriveItemSetChildren(n.__assign(n.__assign({},e),{response:c,parentItemKey:v}))).itemResolver;if(p){var g=p().itemResolver;d.merge(g)}if(h){var y=o.processLocalOrRemoteDriveItem({setItemKey:t,driveItemResponse:h,endpoint:m}).itemResolver;d.merge(y)}d.resolveItems({items:(l={},l[v]=n.__assign({},i.getInvalidationFacet().forFacet(s.defaultChildItemSetFacet).thenInvalidate(e.itemKey,s.childItemsFacet).pack()),l)});a.mark(u.itemsViewPerfMarkers.processData.end);return{itemResolver:d}}}});
define("HJ",["require","exports","ww","th","tc","KJ","$_","aS","J3","Is","Ki","W_","W","u4","UJ","cc","nm","tJ"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItemSetChildren=function(e){return function(t){var y,b,w,E,S,x=e.itemKey,T=e.parentItemKey,N=e.itemSetKeyFacet,C=e.filterChildItems,k=e.onProcessResponse,L=e.groupChildItems,A=e.response,O=e.skip,M=void 0===O?0:O,_=e.enableRandomAccess,D=void 0!==_&&_,P=e.totalChildCount,H=e.getDriveItemFacets,B=N.deserialize(x),j=B.driveItemKey.endpoint,F=new o.ItemResolver,I=t(c.logQoS({name:"remoteItemsMissingParentRef"})),q="number"==typeof A["@odata.count"]?A["@odata.count"]:P||A.value.length,R=A["@odata.nextLink"],U=!!R,z=t(v.readItems(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(i.childItemsFacet,x),prevChildKeys:e.demandItemFacet(i.childItemsFacet,x)}})),W=z.childItemsFacetResolved,X=z.prevChildKeys,V=X&&X.itemKeys,$=0,J=0;D&&(W&&V?S=V.slice(0):"number"==typeof q&&(S=new Array(q+(U&&q<=A.value.length?1:0))));S||(S=new Array(A.value.length+(U?1:0)));for(var K=M,Q=0,G=0,Y=A.value;G<Y.length;G++){var Z=Y[G],ee=C&&C(Z),te=Z.remoteItem,ne=!(Z.remoteItem&&Z.remoteItem.parentReference&&Z.remoteItem.parentReference.driveId),re=te&&ne;re&&Q++;if(ee||re){S.splice(K,1);q--}else{var ie=Z.webDavUrl||Z.remoteItem&&Z.remoteItem.webDavUrl||Z.webUrl,se=t(f.readConfiguration({graphEndpoint:l.graphEndpointConfigurationFacet,graphRecentEndpoint:l.graphRecentEndpointConfigurationFacet,processDriveItemSet:l.processDriveItemSetFacet})),oe=se.graphEndpoint,ue=se.graphRecentEndpoint,ae=se.processDriveItemSet,fe=j.indexOf("/_api/v2.0")>-1||j.indexOf("/_api/v2.1")>-1,le=oe||ue;if(ie&&fe){var ce=ie&&decodeURIComponent(ie);j=le?new p.SimpleUri(ce).authority+"/_api/v2.0":""+new p.SimpleUri(ce).authority+new p.SimpleUri(j).path}var he=d.processLocalOrRemoteDriveItem({shouldInvalidateItemSetOnChildItemRename:ae&&ae.shouldInvalidateItemSetOnChildItemRename,setItemKey:x,driveItemResponse:Z,endpoint:j,getDriveItemFacets:H}),pe=he.itemResolver,de=he.actualItemKey,ve=he.actualDriveItemKey,me=Z.thumbnails,ge=Z.remoteItem;$++;(me||ge&&ge.thumbnails)&&J++;S[K]=de;F.merge(pe);if(k){var ye=k({itemKey:x,driveItemKey:ve,item:Z});ye&&F.merge(ye.itemResolver)}var be=t(f.readConfiguration({processDriveItemFromSharePoint:l.processDriveItemFromSharePointFacet})).processDriveItemFromSharePoint;if(be&&(fe||le)){var we=t(be.process({itemKey:de,driveItem:Z})).itemResolver;F.merge(we)}K++}}t(I(n.__assign({resultType:Q<1?h.ResultTypeEnum.Success:h.ResultTypeEnum.Failure},Q>0?{extraData:{count:Q}}:{})));if(U){var Ee=s.driveItemPageKeyFacet.serialize({setItemKey:x,endpoint:j,token:R});F.merge(u.resolveNewPage({itemKey:Ee}).itemResolver);S[K]=Ee}if(L){var Se=L(B);Se&&F.merge(Se.itemResolver)}else F.resolveItems({items:(y={},y[x]=n.__assign({},i.childItemsFacet.pack({itemKeys:S})),y)});F.resolveItems({items:(b={},b[x]=n.__assign({},g.itemSetEngagementExtraDataFacet.pack({childCount:$,childCount_withThumbnail:J})),b)});q!==P&&F.resolveItems({items:(w={},w[T]=n.__assign({},m.countFacet.pack(q)),w)});F.resolveItems({items:(E={},E[x]=n.__assign(n.__assign({},i.parentItemFacet.pack({itemKey:T})),r.getInvalidationFacet().forFacet(i.childItemsFacet).thenInvalidate(a.clearCacheIfNotOffline).pack()),E)});return{itemResolver:F}}}});
define("UJ",["require","exports","ww","eY","Vb","$Q","lY","FJ","u4","Bc"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processLocalOrRemoteDriveItem=function(e){var t,l,c,h,p=e.driveItemResponse,d=e.endpoint,v=e.getDriveItemFacets,m=void 0===v?r.getDriveItemFacets:v,g=p.remoteItem,y=g&&g.parentReference,b=p.parentReference,w=b||y,E=w&&w.driveId,S=w&&w.id,x="personal"===(w&&w.driveType),T=!!p.root;if(g){h=g.id;y&&(E=y.driveId)}else h=x&&p.root?o.ROOT_ITEM_ID:p.id;var N={endpoint:d,driveId:E,itemId:h},C=i.driveItemKeyFacet.serialize(N),k=p&&(p.webDavUrl||p.webUrl),L=x&&w&&w.path===o.CONSUMER_ROOT_ITEM_PATH?o.ROOT_ITEM_ID:S||void 0,A=w&&L?i.driveItemKeyFacet.serialize({endpoint:d,driveId:w.driveId||E,itemId:L}):void 0,O=[],M="";if(k){var _=new a.SimpleUri(k);O.push.apply(O,_.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));O.unshift(_.authority);M=O.join("/")}w&&!T&&!L&&M&&(A=u.driveItemByCanonicalUrlKeyFacet.serialize({endpoint:d,driveId:w.driveId,canonicalUrl:M}));var D=s.processDriveItem(n.__assign(n.__assign({},e),{itemKey:C,driveItemKey:N,parentFolderItemKey:A})).itemResolver;D.resolveItems({items:n.__assign({},A&&(t={},t[A]=n.__assign({},M?f.openUrlFacet.pack(M):{}),t))});if(g&&y){var P=i.driveItemKeyFacet.serialize({endpoint:d,driveId:b&&b.driveId,itemId:p.id}),H=i.driveItemKeyFacet.serialize({endpoint:d,driveId:y.driveId,itemId:g.id});D.mapKeys({mappings:(l={},l[P]=H,l)});D.resolveItems({items:(c={},c[H]=n.__assign({},m({driveItem:p,endpoint:d})),c)})}return{itemResolver:D,actualDriveItemKey:N,actualItemKey:C}}});
define("eX",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=864e5,i=7;(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"})(n=t.RelativeDateGroups||(t.RelativeDateGroups={}));t.getRelativeDateBucketByDate=function(e){var t=new Date;return(function(e,t){return s(t,e)})(e,t)?n.today:(function(e,t){return s(new Date(t.getTime()-r),e)})(e,t)?n.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*r;return e.getTime()>n})(e,t)?n.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+i)*r;return e.getTime()>n})(e,t)?n.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-2*i*r;return e.getTime()>n})(e,t)?n.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-3*i*r;return e.getTime()>n})(e,t)?n.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?n.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?n.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?n.twoMonthsAgo:""};function s(e,t){return e.toDateString()===t.toDateString()}t.getMonthString=["January","February","March","April","May","June","July","August","September","October","November","December"]});
define("fX",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substractDays=function(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}});
define("uX",["require","exports","Ye","Jy","jP","k4","Ye","fX","pH"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filterTypes={fileType:"fileName",sharedByUser:"sharedByName",dateModified:"dateModified"};var f=new Map([["code",n.ItemTypeFilter.text],["csv",n.ItemTypeFilter.excel],["docx",n.ItemTypeFilter.word],["dotx",n.ItemTypeFilter.word],["one",n.ItemTypeFilter.onenote],["onepkg",n.ItemTypeFilter.onenote],["onetoc",n.ItemTypeFilter.onenote],["pdf",n.ItemTypeFilter.pdf],["photo",n.ItemTypeFilter.media],["potx",n.ItemTypeFilter.powerpoint],["ppsx",n.ItemTypeFilter.powerpoint],["pptx",n.ItemTypeFilter.powerpoint],["rtf",n.ItemTypeFilter.text],["txt",n.ItemTypeFilter.text],["video",n.ItemTypeFilter.media],["xlsx",n.ItemTypeFilter.excel],["xltx",n.ItemTypeFilter.excel],["zip",n.ItemTypeFilter.zip]]);function l(e,t){var n,s,u=(n=e,s=r.getFileExtension(n,!0),i.getIconNameFromExtension(s)),a=f.get(u);return!!a&&o.containsItemTypeFilter(t.filters,a)}t.filterItem=function(e,n){void 0===n&&(n=[]);return n.every(function(n){var r,i=!(n.type===t.filterTypes.sharedByUser)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,n.values),o=!(n.type===t.filterTypes.fileType)||(function(e,t){return!!e.name&&l(e.name,t)})(e,s.getIItemTypeFilter(n.values)),f=!(n.type===t.filterTypes.dateModified)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case a.DateTimeSliderValue.today:return n;case a.DateTimeSliderValue.yesterday:return u.substractDays(n,1);case a.DateTimeSliderValue.last7Days:return u.substractDays(n,7);case a.DateTimeSliderValue.last30Days:return u.substractDays(n,30);case a.DateTimeSliderValue.last3Months:return u.substractDays(n,90);default:return new Date(0)}})((r=n.values).length<1?a.DateTimeSliderValue.none:-1===Object.keys(a.DateTimeSliderValue).indexOf(r[0])?a.DateTimeSliderValue.none:a.DateTimeSliderValue[r[0]]));return i&&o&&f})}});
define("oX",["require","exports","ww","Vb","PQ","Nb","$_","Bc","nm","tc","dX","GS","Oe","_2","Io","sX"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharedGroup=function(e){if(s.sharedWithMeItemSetKeyFacet.matches(e)){var t=s.sharedWithMeItemSetKeyFacet.deserialize(e).groupBy;if(t===p.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[p.SHARED_BY_COLUMN_KEY])return m(e);if(t===p.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[p.DATE_SHARED_COLUMN_KEY])return g(e)}return{onProcessResponse:void 0,groupChildItems:void 0}};function m(e){var t={};return{onProcessResponse:function(e){var n,s=e.driveItemKey,o=e.item;if(o&&s){var u=o.remoteItem,a=u&&u.shared&&u.shared.sharedBy,f=a&&a.user,l=r.driveItemKeyFacet.serialize(s);if(f&&f.email){var c=i.groupBySharedByKeyFacet.serialize({displayName:f.displayName,email:f.email});if(n=c,t.hasOwnProperty(n))t[c].push(l);else{t[c]=[];t[c].push(l)}}}},groupChildItems:function(r){for(var s,l,c=new o.ItemResolver,h=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n];if(!i.groupBySharedByKeyFacet.matches(s))return e;var o=i.groupBySharedByKeyFacet.deserialize(s);t.push(o)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return i.groupBySharedByKeyFacet.serialize(e)})})(Object.keys(t)),p=[],v=0,m=h;v<m.length;v++){var g=m[v];if(i.groupBySharedByKeyFacet.matches(g)){var y=i.groupBySharedByKeyFacet.deserialize(g);c.resolveItems({items:(s={},s[g]=n.__assign(n.__assign(n.__assign({},u.displayNameFacet.pack(y.displayName)),a.isGroupFacet.pack(!0)),f.childItemsFacet.pack({itemKeys:t[g]})),s)});p.push(g)}}c.resolveItems({items:(l={},l[e]=n.__assign(n.__assign({},f.childItemsFacet.pack({itemKeys:p})),d.allGroupsCollapsedFacet.pack(!0)),l)});return{itemResolver:c}}}}t.getSharedByGroup=m;function g(e){var t={};return{onProcessResponse:function(e){var n,s=e.driveItemKey,o=e.item;if(o&&s){var u=o.remoteItem,a=u&&u.shared&&u.shared.sharedDateTime,f=r.driveItemKeyFacet.serialize(s);if(a){var l=y(new Date(a),new Date),c=i.groupByDateSharedKeyFacet.serialize({relativeTime:l,sharedDateTime:a});if(n=c,t.hasOwnProperty(n))t[c].push(f);else{t[c]=[];t[c].push(f)}}}},groupChildItems:function(r){for(var s,l,c=new o.ItemResolver,h=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n];if(!i.groupByDateSharedKeyFacet.matches(s))return e;var o=i.groupByDateSharedKeyFacet.deserialize(s);t.push(o)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return i.groupByDateSharedKeyFacet.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},s=0,o=n;s<o.length;s++){var u=o[s];if(i.groupByDateSharedKeyFacet.matches(u)){var a=i.groupByDateSharedKeyFacet.deserialize(u).relativeTime,f=i.groupByRelativeTimeKeyFacet.serialize({relativeTime:a});if(r(f))for(var l=e[u],c=0,h=l;c<h.length;c++){var p=h[c];t[f].push(p)}else{t[f]=[];l=e[u];for(var d=0,v=l;d<v.length;d++){p=v[d];t[f].push(p)}}}}return t})(t),p=[],v=0,m=Object.keys(h);v<m.length;v++){var g=m[v];if(i.groupByRelativeTimeKeyFacet.matches(g)){var y=i.groupByRelativeTimeKeyFacet.deserialize(g).relativeTime;c.resolveItems({items:(s={},s[g]=n.__assign(n.__assign(n.__assign({},u.displayNameFacet.pack(y)),a.isGroupFacet.pack(!0)),f.childItemsFacet.pack({itemKeys:h[g]})),s)});p.push(g)}}c.resolveItems({items:(l={},l[e]=n.__assign(n.__assign({},f.childItemsFacet.pack({itemKeys:p})),d.allGroupsCollapsedFacet.pack(!0)),l)});return{itemResolver:c}}}}t.getDateGroup=g;function y(e,t){if(!e)return l.default.older;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return c.default.today;n.setDate(n.getDate()-1);if(e>=n)return c.default.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return l.default.thisWeek;n.setDate(n.getDate()-7);if(e>n)return l.default.lastWeek;var r=new Date(t.getFullYear(),t.getMonth(),1);if(e>=new Date(t.getFullYear(),t.getMonth()-1,1)&&e<r)return l.default.lastMonth;n.setDate(n.getDate()-7);if(e>n)return l.default.twoWeeksAgo;n.setDate(n.getDate()-7);if(e>n)return l.default.threeWeeksAgo;if(e>=r)return l.default.thisMonth;var i=t.getFullYear()===e.getFullYear(),s=v.months[e.getMonth()];return i?s:h.format(c.default.MonthAndYear,s,e.getFullYear())}t.getDateGroupName=y});
define("lX",["require","exports","ww","_2","Uh"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function o(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function u(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function a(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function f(e,t,r,i){return(function(e,t){return n.__spreadArrays(e).sort(t)})(e,function(e,n){var s=e.folder,o=n.folder;return r&&s&&!o?-1:r&&!s&&o?1:i(e,n,t)})}t.sortItems=function(e,t,n,l){void 0===l&&(l=!1);var c=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[r.DATE_SHARED_COLUMN_KEY],h=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[r.SHARED_BY_COLUMN_KEY],p=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[i.DISPLAY_NAME_COLUMN_KEY],d=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[r.ITEM_ACTIVITY_COLUMN_KEY],v=r.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[i.NAME_AND_PATH_COLUMN_KEY];switch(t){case c:return f(e,n,l,o);case h:return f(e,n,l,a);case p:case v:return f(e,n,l,u);case d:return f(e,n,l,s);default:return e}}});
define("LQe",["require","exports","iYe","tYe","zQe","VQe","UQe","kQe","K_","kb","nd","Q0","Xv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentAddon=a.createAddon(function(){return function(e){e(i.recentAddonDataOnly);e(f.registerControlHandler(n.recentRootItemSetKeyFacet,l.itemSetDetailsListControl)(r.recentRootItemSetDetailsListControlHandler));e(f.registerControlHandler(s.recentRootItemKeyFacet,c.itemsCommandBarControl)(o.recentRootItemCommandBarControlHandler));e(f.registerControlHandler(n.recentRootItemSetKeyFacet,h.itemSetColumnsControl)(u.recentRootItemSetColumnsControlHandler))}})});
define("zQe",["require","exports","VQe","eYe","iYe","NQe","XQe","YQe","KQe","K_","p3","kb","V7","GQe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentAddonDataOnly=f.createAddon(function(){return function(e){e(f.registerOperationHandler(n.recentRootItemKeyFacet,l.getItemsOperation)(u.recentRootItemGetItemsOperationHandler));e(f.registerOperationHandler(i.recentRootItemSetKeyFacet,l.getItemsOperation)(o.recentRootItemSetGetItemsOperationHandler));e(f.registerOperationHandler(r.recentItemKeyFacet,s.changePinStateOperation)(a.recentItemChangePinStateOperationHandler));e(c.registerControlHandler(i.recentRootItemSetKeyFacet,h.filteredItemSetControl)(p.recentRootItemSetFilteredItemSetControlHandler))}})});
define("RQe",["require","exports","ww","r","BQe","NQe","Wv","Mc","To","bc","Ac"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ChangePinStateAction=o.createItemCacheComponent(function(e,t){for(var o=t.itemKeys,f=t.targetPinState,c=o.length>0,h=0,p=o;h<p.length;h++){var d=p[h],v=e.demandItem({pinState:i.pinStateFacet},d).pinState;if(!v||v===f){c=!1;break}}var m=e.dispatch;return r.createElement(u.Action,n.__assign({isAvailable:c,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){e={targetPinState:f};m(s.changePinState({items:a.makeObject(o,function(){return e})}));return[2]})})}},l.getItemActionEngagement(e,{itemKey:o[0],engagement:{name:"ChangePinState",isIntentional:!0}})))});t.PinItemsAction=o.connectToItemCache(function(){return{targetPinState:2}})(f.withSelectedItems()(t.ChangePinStateAction));t.UnpinItemsAction=o.connectToItemCache(function(){return{targetPinState:1}})(f.withSelectedItems()(t.ChangePinStateAction))});
define("MQe",["require","exports","ww","C5","qi","PQe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateAccessedColumn=n.__assign(n.__assign({},r.dateModifiedColumn),{name:s.default.lastAccessedColumnHeaderText,key:new i.Facet("dateAccessedColumn").id,minWidth:200})});
define("TQe",["require","exports","ww","ab","qi"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileTypeIconColumn=n.__assign(n.__assign({},r.fileTypeIconColumn),{key:new i.Facet("fileTypeIconColumn").id,minWidth:32,maxWidth:32})});
define("jQe",["require","exports","r","RQe","HQe","qi"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pinItemsCommand={key:new s.Facet("pin").id,name:i.default.pinCommandText,action:n.createElement(r.PinItemsAction,null),iconProps:{iconName:"pin"}}});
define("FQe",["require","exports","r","RQe","HQe","qi"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.unpinItemsCommand={key:new s.Facet("unpin").id,name:i.default.unpinCommandText,action:n.createElement(r.UnpinItemsAction,null),iconProps:{iconName:"unpin"}}});
define("nYe",["require","exports","ww","r","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i){"use strict";i=i.RecentGroupItemDetailsHeader_9;Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?r.createElement("div",{className:i.root},this.props.group.name):null};return t})(r.PureComponent);t.RecentGroupItemDetailsHeader=s});
define("kQe",["require","exports","kb","TQe","xM","MQe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return u}});var o=[r.fileTypeIconColumn,i.nameAndPathColumn,s.dateAccessedColumn];function u(e,t){return{columns:o}}});
define("UQe",["require","exports","ww","kb","jQe","FQe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemCommandBarControlHandler=r.createControlHandler()(function(){return function(e){return o}});t.default=t.recentRootItemCommandBarControlHandler;function o(e,t){var r=t.commands;return r?{commands:n.__spreadArrays(r,[i.pinItemsCommand,s.unpinItemsCommand])}:{}}});
define("tYe",["require","exports","nYe","qd","kb"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetDetailsListControlHandler=i.createControlHandler()(function(){return function(e){return s}});function s(){return{groupHeaderRenderer:n.RecentGroupItemDetailsHeader,groupProps:{collapseAllVisibility:r.CollapseAllVisibility.hidden}}}});
define("GQe",["require","exports","ww","iYe","kb","G7","K7"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetFilteredItemSetControlHandler=i.createControlHandler()(function(){return function(e){return u}});function u(e,t){var i=t.handlers,u=t.itemKey,a=e.demandItemFacet(r.recentRootItemSetKeyFacet,u);if(i&&a){for(var f=[],l=0,c=i;l<c.length;l++){var h=c[l];if(h.key===o.itemPhotoTypeFilterHandler.key)f.push("photo");else if(h.key===o.itemVideoTypeFilterHandler.key)f.push("video");else if(h.key===o.itemFolderTypeFilterHandler.key)f.push("folder");else if(h.key===o.itemOneNoteFilterHandler.key)f.push("onenote");else if(h.key===o.itemNonPhotoTypeFilterHandler.key)f.push("!photo");else if(h.key===o.itemNonVideoTypeFilterHandler.key)f.push("!video");else if(h.key===o.itemNonFolderTypeFilterHandler.key)f.push("!folder");else if(h.key===o.itemNonOneNoteFilterHandler.key)f.push("!onenote");else{var p=s.getExtensionFilterFromFilterHandler(h);p&&f.push(p)}}return{itemKey:r.recentRootItemSetKeyFacet.serialize(n.__assign(n.__assign({},a),{filters:f}))}}return{}}});
define("KQe",["require","exports","ww","eYe","QQe","BQe","WQe","K_","Cs","th"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemChangePinStateOperationHandler=u.createSingleItemOperationHandler()(function(e){var t=this,u=e.itemKey,l=e.options.targetPinState,c=r.recentItemKeyFacet.deserialize(u).mru_id;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,h,p;return n.__generator(this,function(d){switch(d.label){case 0:t=e(a.readItem({mru:i.mruFacet},u));r=t&&t.mru;h=n.__assign({mru_id:c,is_pinned:2===l},r||{});return[4,e(o.getData({path:"/recent",method:"POST",body:h}))];case 1:d.sent();e(f.invalidateItems({items:(p={},p[u]=[s.pinStateFacet],p)}));return[2]}})})}})});
define("YQe",["require","exports","ww","iYe","K_","tc","Bc","$_","JQe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemGetItemsOperationHandler=i.createSingleItemOperationHandler()(function(e){var t=this,i=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,l;return n.__generator(this,function(c){t=r.recentRootItemSetKeyFacet.serialize({});(f=new u.ItemResolver).resolveItems({items:(l={},l[i]=n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:t})),o.displayNameFacet.pack(a.default.Recent)),o.parentFolderItemFacet.pack(void 0)),l)});e(f.execute());return[2]})})}})});
define("XQe",["require","exports","ww","JQe","VQe","$Qe","eYe","QQe","WQe","K_","tc","Bc","C6","th","nm","Wi","Os","$_","JQe","Qi","ZQe","we","J3","vM","Is","Gi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetGetItemsOperationHandler=f.createSingleItemOperationHandler()(function(e){var t=this,f=e.itemKey,x=i.recentRootItemKeyFacet.serialize({});return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me;return n.__generator(this,function(ge){switch(ge.label){case 0:t=e(T.readConfiguration({enableSharePointItemMapping:N.enableSharePointItemMappingConfigurationFacet})).enableSharePointItemMapping,i=void 0===t||t;return[4,e(a.getData({path:"/recent",method:"GET"}))];case 1:k=ge.sent();(L=new g.ItemResolver).resolveItems({items:(he={},he[x]=n.__assign(n.__assign({},l.defaultChildItemSetFacet.pack({itemKey:f})),c.displayNameFacet.pack(y.default.Recent)),he)});A=s.recentGroupKeyFacet.serialize({relativeTime:"today"});O=s.recentGroupKeyFacet.serialize({relativeTime:"yesterday"});M=s.recentGroupKeyFacet.serialize({relativeTime:"thisWeek"});_=s.recentGroupKeyFacet.serialize({relativeTime:"lastWeek"});D=s.recentGroupKeyFacet.serialize({relativeTime:"twoWeeksAgo"});P=s.recentGroupKeyFacet.serialize({relativeTime:"threeWeeksAgo"});H=s.recentGroupKeyFacet.serialize({relativeTime:"lastMonth"});B=s.recentGroupKeyFacet.serialize({relativeTime:"twoMonthsAgo"});j=[];F=[];I=[];q=[];R=[];U=[];z=[];W=[];X="";for(V=0,$=k.documents.items;V<$.length;V++){J=$[V];K=o.recentItemKeyFacet.serialize({mru_id:J.mru_id});Q=J.title,G=J.display_path,Y=void 0===G?[]:G,Z=J.category,ee=J.app,te=J.url,ne=J.type,re=J.time_stamp;ie=new Date(re);switch(w.getRelativeDateBucketByDate(ie)){case w.RelativeDateGroups.today:j.push(K);break;case w.RelativeDateGroups.yesterday:F.push(K);break;case w.RelativeDateGroups.thisWeek:I.push(K);break;case w.RelativeDateGroups.lastWeek:q.push(K);break;case w.RelativeDateGroups.twoWeeksAgo:R.push(K);break;case w.RelativeDateGroups.threeWeeksAgo:U.push(K);break;case w.RelativeDateGroups.lastMonth:z.push(K);break;case w.RelativeDateGroups.twoMonthsAgo:W.push(K);X=w.getMonthString[ie.getMonth()]}se=decodeURIComponent(te);oe={itemFullUrl:se};ue=Q||Y&&Y[Y.length-1]||te||"";ae=C(se),fe=ae.parentItemKey,le=ae.parentItemUrl;L.mapKeys({mappings:(pe={},pe[b.spItemFullUrlKeyFacet.serialize(oe)]=K,pe[b.spItemFullUrlKeyFacet.serialize({itemFullUrl:le})]=fe,pe)});L.resolveItems({items:(de={},de[K]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(ue)),c.fileNameFacet.pack({name:ue,extension:J.extension?""+J.extension:"OneNote"===ee?"one":""})),c.fileSizeFacet.pack(Q?J.file_size:void 0)),c.dateModifiedFacet.pack(new Date(J.time_stamp).getTime())),v.oneNoteFacet.pack("OneNote"===ee?{}:void 0)),i?n.__assign({},m.preferredKeyFacetFacet.pack(b.spItemFullUrlKeyFacet)):{}),b.spItemFullUrlKeyFacet.pack(oe)),c.openUrlFacet.pack(J.url)),u.mruFacet.pack({category:Z,app:ee,url:te,type:ne})),c.canonicalUrlFacet.pack(se)),h.thumbnailFacet.pack(void 0)),c.parentFolderItemFacet.pack({itemKey:fe})),p.getInvalidationFacet().pack()),de[fe]=n.__assign(n.__assign(n.__assign({},c.folderFacet.pack({})),c.canonicalUrlFacet.pack(le)),c.openUrlFacet.pack(le)),de)})}L.resolveItems({items:(ve={},ve[A]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.today)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:j})),ve[O]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.yesterday)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:F})),ve[M]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.thisWeek)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:I})),ve[_]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.lastWeek)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:q})),ve[D]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.twoWeeksAgo)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:R})),ve[P]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.threeWeeksAgo)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:U})),ve[H]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(r.default.lastMonth)),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:z})),ve[B]=n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(E.format(r.default.twoMonthsAgo,X))),d.isGroupFacet.pack(!0)),l.childItemsFacet.pack({itemKeys:W})),ve)});ce=[];j.length>0&&ce.push(A);O.length>0&&ce.push(O);I.length>0&&ce.push(M);q.length>0&&ce.push(_);R.length>0&&ce.push(D);U.length>0&&ce.push(P);z.length>0&&ce.push(H);W.length>0&&ce.push(B);L.resolveItems({items:(me={},me[f]=n.__assign(n.__assign(n.__assign({},l.childItemsFacet.pack({itemKeys:ce})),p.getInvalidationFacet().forFacet(l.childItemsFacet).thenInvalidate(S.clearCacheIfNotOffline).pack()),l.parentItemFacet.pack({itemKey:x})),me[x]=n.__assign({},p.getInvalidationFacet().forFacet(l.defaultChildItemSetFacet).thenInvalidate(f,l.childItemsFacet).pack()),me)});e(L.execute());return[2]}})})}});function C(e){var t=x.getParentItemUrl(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:b.spItemFullUrlKeyFacet.serialize(n)}}});
define("QQe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mruFacet=new n.Facet("mru")});
define("BQe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.unpinned=1]="unpinned";e[e.pinned=2]="pinned"})(t.PinState||(t.PinState={}));t.pinStateFacet=new n.Facet("pinState")});
define("qQe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tokenFetcherConfigurationFacet=new n.Facet("tokenFetcher")});
define("$Qe",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentGroupKeyFacet=new n.KeyFacet("recentGroup",{relativeTime:n.stringPart()})});
define("eYe",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemKeyFacet=new n.KeyFacet("recentItem",{mru_id:n.stringPart()})});
define("VQe",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemKeyFacet=new n.KeyFacet("recent",{})});
define("iYe",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetKeyFacet=new n.KeyFacet("recentRootItemSet",{filters:n.arrayPart(n.stringPart())})});
define("NQe",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.changePinStateOperation=new n.Facet("pinItems");t.changePinState=r.implementOperation({operationTypeFacet:t.changePinStateOperation})});
define("WQe",["require","exports","ww","qQe","Is"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(){var e=this;return function(t){return n.__awaiter(e,void 0,void 0,function(){var e,s;return n.__generator(this,function(n){switch(n.label){case 0:e=t(i.readConfiguration({tokenFetcher:r.tokenFetcherConfigurationFacet})).tokenFetcher;return(s=e)?[4,e.getToken("https://officeapps.live.com")]:[3,2];case 1:s=n.sent();n.label=2;case 2:return[2,s]}})})}}t.getAuthToken=s;t.getData=function(e){var t=this,r=e.method,i=e.path,o=e.body;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(s())];case 1:t=n.sent();u=new Headers;o&&u.set("Content-Type","application/json");t&&u.set("Authorization","Bearer "+t);a={headers:u,credentials:"omit",method:r,mode:"cors",cache:"default",body:o?JSON.stringify(o):void 0};return[4,fetch("https://ocws.officeapps.live.com/ocs/v2"+i,a)];case 2:return[4,n.sent().json()];case 3:return[2,n.sent()]}})})}}});
define("ZQe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=864e5,i=7;(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"})(n=t.RelativeDateGroups||(t.RelativeDateGroups={}));t.getRelativeDateBucketByDate=function(e){var t=new Date;return(function(e,t){return s(t,e)})(e,t)?n.today:(function(e,t){return s(new Date(t.getTime()-r),e)})(e,t)?n.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*r;return e.getTime()>n})(e,t)?n.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+i)*r;return e.getTime()>n})(e,t)?n.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-2*i*r;return e.getTime()>n})(e,t)?n.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-3*i*r;return e.getTime()>n})(e,t)?n.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?n.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?n.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?n.twoMonthsAgo:""};function s(e,t){return e.toDateString()===t.toDateString()}t.getMonthString=["January","February","March","April","May","June","July","August","September","October","November","December"]});
define("MT",["require","exports","ww","r","Wv","Mc","bc","Hs","Qi","Gi","Ac","PT","WM","ty","dS","Zv","zi","$p","Bc","Tc","b3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=w.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["rN"],t,n)})];case 1:return[2,t.sent().ApproveRejectDialog]}})})}),S=i.createItemCacheComponent(function(e,t){var i=t.onContinue,s=t.onCancel,o=t.resolve,a=t.reject,f=n.__rest(t,["onContinue","onCancel","resolve","reject"]);return r.createElement(E,n.__assign({},f,{onContinue:function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return i?[4,i(e)]:[3,2];case 1:t.sent();t.label=2;case 2:o();return[2]}})})},onCancel:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return s?[4,s()]:[3,2];case 1:e.sent();e.label=2;case 2:a(new u.CancelError);return[2]}})})}}))}),x=i.createItemCacheComponent(function(e,t){var i=t.itemKeys,u=o.getCurrentItemSetKey(e);if(!u)return null;var w=e.demandItem({setKey:a.spFolderItemSetKeyFacet},u).setKey;if(!w||!i||!i.length)return null;if(!v.getConfiguration(e,{enbableApproveRejectConfiguration:f.enableApproveRejectCommandConfigurationFacet}).enbableApproveRejectConfiguration)return null;var E=!0,x=e.demandItemFacet(f.listFacet,a.spListKeyFacet.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl}));if(x&&x.templateType===m.default.webPageLibrary&&i.length>1)return null;for(var T,N,C=!0,k=!0,L=!1,A={},O=0,M=i;O<M.length;O++){var _=M[O];if(!h.isApprovalRelevant(e,{itemKey:_,listFacets:x}))return null;var D=e.demandItem({permissions:f.permissionsFacet,moderationStatusType:f.moderationStatusTypeFacet,moderationComments:f.moderationCommentsFacet},_),P=D.permissions,H=D.moderationStatusType,B=D.moderationComments;if(x&&!x.isDocumentLibrary&&!p.default.hasItemPermission({permissions:P},p.default.layoutsPage))return null;if(void 0!==H){var j=A[d.ModerationStatusType[H]];A[d.ModerationStatusType[H]]=j?j+1:1}void 0===T?T=B:T!==B&&(C=!1);void 0===N?N=H:N!==H&&(k=!1);H===d.ModerationStatusType.draft&&(L=!0);if(!(E=h.isFolder(e,{itemKey:_,includeOneNote:!0})||H===d.ModerationStatusType.pending||!!x&&!x.enableMinorVersions))return null}if(x&&x.templateType===m.default.webPageLibrary){if(E){return(_=t.itemKeys?t.itemKeys[0]:void 0)?r.createElement(g.ItemOpenUrlAction,{itemKey:t.itemKeys?t.itemKeys[0]:"",engagement:{name:"ApproveReject",isIntentional:!0}}):null}return null}var F,I=k&&N===d.ModerationStatusType.draft&&!!x&&!!x.enableMinorVersions,q=L,R=e.dispatch,U=function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){t=[{FieldName:"_ModerationStatus",FieldValue:e.status.toString()}];void 0!==e.comment&&t.push({FieldName:"_ModerationComments",FieldValue:e.comment});return[2,R(c.bulkUpdateListItems({items:(r={},r[u]={itemKeys:i,formValues:t,qosName:"BulkApproveReject"},r)}))]})})},z=i.length,W=z>1?"BulkApproveReject":"ApproveReject";1===z&&(F=e.demandItemFacet(y.displayNameFacet,i[0]));var X=b.renderComponentOnExecute(function(e){return r.createElement(S,n.__assign({},e,{onContinue:U,hideApproveRejectOptions:I,showDraftOption:q,initialComment:C?T:void 0,initialStatus:k?N:void 0,itemCount:i.length,itemName:F,initialStatusMapForBulkEdit:A}))});return r.createElement(s.Action,n.__assign({isAvailable:E,onExecute:X},l.getItemActionEngagement(e,{itemKey:i[0],engagement:{name:W,isIntentional:!0}})))});t.ApproveRejectAction=o.withSelectedItems()(x)});
define("eH",["require","exports","ww","AH","EH","GD","UD","wH","OH","bU","xH","DH","uH","s7","cH","sH","nH","tH","MT","NM"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t);n.__exportStar(d,t);n.__exportStar(v,t);n.__exportStar(m,t);n.__exportStar(g,t);n.__exportStar(y,t);n.__exportStar(b,t)});
define("WKe",["require","exports","ww","r","Gi","Qi","Wv","Mc","N5","M","Ac","Yq","q","tc","Bc","Ke","Zv","Z_","po","jo","ih","So","qi","qKe","I7"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=new g.ProgressKeyFacet("ExportCSV");t.ExportListActionExecutor=o.createItemCacheComponent(function(e,t){var o=m.getConfiguration(e,{spExportToCSVWorkerUrl:i.spExportToCSVWorkerUrlConfigurationFacet,spPageFallbackWebAbsoluteUrl:i.spPageFallbackWebAbsoluteUrlConfigurationFacet}),c=o.spExportToCSVWorkerUrl,h=o.spPageFallbackWebAbsoluteUrl;return c&&h?(function(e,t,o,a){var f=this,c=t.itemKey,h=[],v=[],m="data:text/csv;charset=utf-8,",C=void 0,L=0,A=5,O=e.dispatch,M=e.demandItemFacet(s.spFolderItemSetKeyFacet,c);if(!M)return null;var _=T.getPageContextFromItemCache(e,c);if(!_)return null;var D=e.demandItemFacet(p.schemaFacet,c);if(D&&_){for(var P=0,H=D.columnKeys;P<H.length;P++){var B=H[P],j=e.demandItem({realFieldName:i.realFieldNameFacet,displayName:d.displayNameFacet},B),F=j.realFieldName,I=j.displayName;if(F&&I&&"DocIcon"!==F){h.push(F);v.push(I)}}m+=v.join(",")+"\r\n"}var q=void 0;return r.createElement(u.Action,n.__assign({isAvailable:!0,onExecute:function(){return n.__awaiter(f,void 0,void 0,function(){function e(){return n.__awaiter(this,void 0,void 0,function(){var i,s;return n.__generator(this,function(n){switch(n.label){case 0:return q&&t?[4,q.getItemsWithPagingToken({pageSize:5e3,nextPageToken:C})]:[3,2];case 1:i=n.sent();s=i.items;C=i.nextPage;t.postMessage([s,h]);t.onmessage=function(n){m+=n.data;C&&L++<A?e():(function(){var e,n,i=encodeURI(m),s=document.createElement("a");s.setAttribute("href",i);s.setAttribute("download",(null===(e=_)||void 0===e?void 0:e.listTitle)+".csv");document.body.appendChild(s);s.click();r.resolve();null===(n=t)||void 0===n||n.terminate();s.remove()})()};n.label=2;case 2:return[2]}})})}var t,r,i,s,u,f,l,v,T,D,P,H,B,j=this;return n.__generator(this,function(h){switch(h.label){case 0:t=void 0;r=new y.Signal;i=n.__awaiter(j,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,r.promise];case 1:e.sent();return[2]}})});s=n.__awaiter(j,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})});h.label=1;case 1:h.trys.push([1,4,,5]);if(!q&&_){q=new k({pageContext:_,listUrl:null===(T=M)||void 0===T?void 0:T.listFullUrl,webUrl:null===(D=M)||void 0===D?void 0:D.webAbsoluteUrl,viewId:null===(H=null===(P=M)||void 0===P?void 0:P.viewKey)||void 0===H?void 0:H.viewId});t=new Worker(a+"/_layouts/15/serviceworkerproxy.aspx?serviceWorkerUrl="+encodeURIComponent(o+"exportlistworker.js"))}if(!_||!t)return[3,3];u=g.progressBatchKeyFacet.serializeNext();f=N.serializeBatchKey(u);O(b.resolveItems({items:(v={},v[g.progressRootItemKey]=S.pack({childItems:p.childItemsFacet},{childItems:{itemKeys:new E.ArrayConcatIfNotMatchKeyPatch([f],function(e){return e})}}),v[f]=n.__assign(n.__assign(n.__assign({},d.displayNameFacet.pack(x.default.ExportingList)),w.sourceItemFacet.pack({itemKey:c})),w.progressPhaseFacet.pack(w.ProgressPhase.completed)),v)}));O(g.trackItemProgress({progressItemKey:f,started:s,completed:i}));e();return[4,i];case 2:h.sent();h.label=3;case 3:return[3,5];case 4:l=h.sent();r.reject(l);null===(B=t)||void 0===B||B.terminate();return[3,5];case 5:return[2]}})})}},l.getItemActionEngagement(e,{itemKey:c,engagement:{name:"ExportToCSV",isIntentional:!0}})))})(e,t,c,h):(function(e,t){var o=this,c=t.itemKey,h=e.demandItemFacet(s.spFolderItemSetKeyFacet,c),p="";if(h&&h.viewKey&&h.viewKey.viewId){var d="",v=s.spListKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl}),m=e.demandItemFacet(i.listFacet,v);m&&(d=m.id);if(d){p=h.webAbsoluteUrl+"/_vti_bin/owssvr.dll?";p+=a.serializeQuery({CS:65001,Using:"_layouts/15/query.iqy",List:d,View:f.default.normalizeUpper(h.viewKey.viewId),RootFolder:h.rootFolder,CacheControl:1})}}return r.createElement(u.Action,n.__assign({isAvailable:!0,onExecute:function(){return n.__awaiter(o,void 0,void 0,function(){return n.__generator(this,function(e){window.open(p);return[2]})})}},l.getItemActionEngagement(e,{itemKey:c,engagement:{name:"ExportToExcel",isIntentional:!0}})))})(e,t)});function C(e){var t,n,r,i=(function(e){return e.ListData?e.ListData:e})(e);return{items:(null===(t=i)||void 0===t?void 0:t.Row)||[],nextPage:null===(n=i)||void 0===n?void 0:n.NextHref,prevPage:null===(r=i)||void 0===r?void 0:r.PrevHref}}var k=(function(){function e(e){var t=e.pageContext,n=e.listUrl,r=e.webUrl,i=e.viewId;this._listUrl=n;this._viewId=i;this._webUrl=r;this._retriever=new c.SPListItemRetriever({pageContext:t})}e.prototype.getItemsWithPagingToken=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(r){switch(r.label){case 0:t=e.nextPageToken;return[4,this._getItemsCore(n.__assign(n.__assign({qosName:"ListDataProvider.getItems"},e),{pageKey:t}))];case 1:return[2,C(r.sent())]}})})};e.prototype._getItemsCore=function(e){var t=e.qosName,n=e.pageKey,r=e.needsSchema,i=void 0!==r&&r,s=e.needsViewMetadata,o=void 0!==s&&s,u=e.itemIds,a=void 0===u?[]:u,f=e.pageSize,l=void 0===f?0:f,c=new v.ItemUrlHelperBasic({context:{webAbsoluteUrl:this._webUrl}}).getUrlParts({webUrl:this._webUrl,listUrl:this._listUrl}),p={parentKey:"",isOnePageNavigation:!1,skipServiceWorkerCache:!0,pageSize:l||a.length||30,requestToken:n,needSchema:i,postDataContext:{requestToken:n,isOnePage:!1,needsSchema:i,needsContentTypes:!1,needsContentTypeOrder:!1,needsForms:!1,needsSpotlight:!1,needsViewMetadata:o}};return this._retriever.getItem(p,{viewIdForRequest:this._viewId,requestToken:n,listUrl:this._listUrl,urlParts:c,itemIds:a,needSchema:i},{qosEvent:new h.Qos({name:t}),qosName:t})};return e})()});
define("cH",["require","exports","ww","dH"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("DH",["require","exports","ww","r","Qi","Wv","Hs","Bc","Mc","Tc","Ac","IH","b3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=h.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["uH"],t,n)})];case 1:return[2,t.sent().ConnectedFilterPanel]}})})});t.LaunchFilterPanelAction=s.createItemCacheComponent(function(e,t){var s=t.columnKey,h=t.itemSetKey,d=t.isToggled,v=e.demandItemFacet(u.displayNameFacet,s),m=e.demandItemFacet(c.filterActionControl,h),g=e.demandItemFacet(i.spFolderItemSetKeyFacet,h),y=g&&g.viewKey&&i.spViewKeyFacet.serialize(g.viewKey),b=c.filterActionControl.evaluate(m)(e,{viewKey:y,isAvailable:!0}).isAvailable,w=f.renderComponentOnExecute(function(e){return r.createElement(p,{onClose:function(){e.reject(new o.CancelError)},onComplete:function(){e.resolve()},columnName:v||"",columnKey:s,itemSetKey:h})});return r.createElement(a.Action,n.__assign({isAvailable:b,isToggled:d,onExecute:w},l.getItemActionEngagement(e,{itemKey:h,engagement:{name:"LaunchFilterPanel",isIntentional:!0}})))})});
define("uH",["require","exports","ww","r","Gi","Qi","Wv","tc","p3","Mc","Md","Tc","am","Ac","yS","fH","o4","k","b3","US"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=y.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["PH"],t,n)})];case 1:return[2,t.sent().FilterPanel]}})})}),E=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,o=t.itemSetKey,d=t.filterableSet,v=t.internalName,m=t.filterOptionSet,y=t.fieldType,b=t.checkedFilterKeys;return r.createElement(l.WithItemCache,null,function(t){var l=t.itemCache,w=t.dispatch;if(!(v&&d&&m&&y))return r.createElement(c.WithAction,null);var E,S=l.demandItemFacet(u.parentItemFacet,o),x=l.demandItemFacet(s.spFolderItemSetKeyFacet,o),T=x&&x.viewKey&&s.spViewKeyFacet.serialize(x.viewKey);x&&(E=l.demandItemFacet(i.spPageContextFacet,s.spPageContextKeyFacet.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl})));for(var N=!(E&&g.getKillSwitch(E).isActivated("8E2ACEEF-1A9C-46FC-9D2D-9E95937355D1","07/07/2020","Include filter display value in filter params for datetime column")||"DateTime"!==y),C=[],k=[],L={},A=0,O=m;A<O.length;A++){var M=O[A];L[M.value]=M}for(var _=0,D=b;_<D.length;_++){var P=D[_];if(L[P]){C.push(L[P].value);k.push(L[P].display)}}var H=d.getFilteredItemSetKey({filterField:v,filterValues:C,filterType:y,useLookupId:!1,filterDisplays:N?k:void 0}),B=p.getItemActionEngagement(l,{itemKey:o,engagement:{name:"ApplyFilters",isIntentional:!0}});return r.createElement(c.WithAction,{action:r.createElement(h.ItemOpenAction,{itemKey:H})},function(t){var s=t.isAvailable,o=t.execute;return r.createElement(f.Action,n.__assign({isAvailable:s,onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r;return n.__generator(this,function(s){switch(s.label){case 0:w(a.resolveItems({items:n.__assign((e={},e[H]=n.__assign({},u.parentItemFacet.pack(S)),e),T?(r={},r[T]=n.__assign({},i.showViewModifiedIndicatorFacet.pack(!0)),r):{})}));return[4,o(t)];case 1:s.sent();return[2]}})})}},B))})})};return t})(r.PureComponent);t.ConnectedFilterPanel=o.connectToItemCache(function(e,t){var o=t.columnKey,a=t.itemSetKey,f=e.demandItem({fieldType:i.fieldTypeFacet,mappedColumnFieldType:i.mappedColumnFieldTypeFacet,internalName:i.internalNameFacet},o),l=f.fieldType,c=f.mappedColumnFieldType,h=f.internalName,p=e.demandItem({deserializedSetKey:s.spFolderItemSetKeyFacet,filterableSet:i.spFilterableSetFacet,filterOptionSets:u.filterOptionSetsFacet,childItems:u.childItemsFacet},a),y=p.deserializedSetKey,w=p.filterableSet,S=p.filterOptionSets,x=p.childItems,T=y&&e.demandItemFacet(i.spPageContextFacet,s.spPageContextKeyFacet.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl})),N=y&&e.demandItemFacet(i.spPeoplePickerDataSourceFacet,s.spPeoplePickerDataSourceKeyFacet.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl})),C=e.demandItemFacet(i.filterOptionSetFacet,S&&S[o]),k=y&&e.demandItemFacet(i.listFacet,s.spListKeyFacet.serialize(y));if((!T||!g.getKillSwitch(T).isActivated("C208B657-4ED1-44C1-BBC5-2F72D944C9E2","10/09/2020","Include filter options generating from current itemSet for large list or when no filter options return from RenderListFilterData"))&&(k&&k.itemCount&&k.itemCount>5e3||!C||!C.length)&&x&&x.itemKeys&&void 0!==c&&h){for(var L=[],A=0,O=x.itemKeys;A<O.length;A++){var M=O[A],_=e.demandItemFacet(i.rowDataFacet,M);_&&L.push({properties:_})}C=(function(e){for(var t=e.smartFilterOptionsFromItems,n=e.originFilterOptionSet,r=[],i={},s=0,o=t;s<o.length;s++){var u=o[s],a=u.values[0];if(!i[a]){var f={display:u.label,value:a};r.push(f);i[a]=f}}if(n)for(var l=0,c=n;l<c.length;l++){var h=c[l];if(!i[h.value]){r.push(h);i[h.value]=h}}return r})({smartFilterOptionsFromItems:(function(e){var t=e.mappedColumnFieldType,n=e.internalName,r=e.items;return v.getFilterOptionsFromItems(t,n,r,b.default,function(e,t,n,r){var i=t,s=[n];if(void 0===i){i=v.normalizeFilterDisplayString(e,n);s=[v.normalizeFilterValue(e,n)]}return{key:i=i||b.default.EmptyFilterOptionLabel,checked:!!r,values:s,label:i}})})({mappedColumnFieldType:c,internalName:h,items:L}),originFilterOptionSet:C})}var D=e.isItemFacetResolved(i.filterOptionSetFacet,S&&S[o]),P=w&&C&&w.appliedFilters&&h&&w.appliedFilters[h]?w.appliedFilters[h].values:[],H=y&&y.viewKey&&s.spViewKeyFacet.serialize(y.viewKey),B=H&&e.demandItemFacet(i.currentDerivedViewFacet,H),j=e.dispatch,F="User"===l||"UserMulti"===l||c===d.ColumnFieldType.Text||c===d.ColumnFieldType.Title?{pageContextForPicker:T,peoplePickerDataSource:N,getFilterSuggestions:function(e,t,r){return n.__awaiter(void 0,void 0,void 0,function(){var i,s;return n.__generator(this,function(n){i=[];if(B&&y){s=v.getViewXmlWithContainsFilter(B.getEffectiveViewXml(),e,t,r);return[2,j(m.getServerData({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl,currentPageContext:T,qosName:"FilterPanel.GetFilterSuggesitons",viewXml:s,rootFolder:y.rootFolder})).then(function(t){if(t.ListData&&t.ListData.Row){var n={};t.ListData.Row.forEach(function(t){var r=t[e],s={display:r,value:r};if(!n.hasOwnProperty(s.value)){n[s.value]=s;i.push(s)}})}return i})]}return[2,i]})})}}:void 0;return{filterOptionSet:C||[],mappedColumnFieldType:void 0!==c?c:d.ColumnFieldType.Text,fieldInternalName:h||"",applyFiltersAction:function(e){return r.createElement(E,n.__assign({},e,{itemSetKey:a,filterableSet:w,fieldType:l,internalName:h}))},isLoading:!D,checkedFilterValues:P,filterPickerProps:F}})(w)});
define("eXe",["require","exports","ww","r","Mc","Tc","Hs","b3","Wv","bc","Bc","I7","xI","Gi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=u.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["mBt"],t,n)})];case 1:return[2,t.sent().RulesPanel]}})})});t.LaunchManageRulesAction=f.withCurrentItemSet()(a.createItemCacheComponent(function(e,t){var n=t.itemKey,u=t.openManagementPanel,a=c.getPageContextFromItemCache(e,n),f=h.readItemSetSchemaFromItemCache(e,{mapping:{internalName:p.internalNameFacet,displayName:l.displayNameFacet,columnFieldType:p.mappedColumnFieldTypeFacet},itemSetKey:n||""});if(!a)return null;var v=s.renderComponentOnExecute(function(e){return r.createElement(d,{onDismiss:function(){e.reject(new o.CancelError)},pageContext:a,itemKey:n,columnData:f,openManagementPanel:u||!1})});return r.createElement(i.Action,{onExecute:v,engagement:{name:"LaunchRulesPanel",isIntentional:!0}})}))});
define("lT",["require","exports","ww","Wv","Mc","Ac","tc","To","Qi","uT"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={isAvailable:!1,onExecute:void 0};t.MoveToGroupAction=r.connectToItemCache(function(e,t){var r=t.itemKeys,i=t.groupKey;if(!(!!e.demandItemFacet(a.spItemGroupKeyFacet,i)&&r&&r.length>0))return l;var c=e.demandItem({childItems:o.childItemsFacet},i).childItems,h=c&&c.itemKeys||[],p=!!e.demandItemFacet(a.spItemGroupKeyFacet,h[0]);if(0===h.length||p)return l;var d=r.filter(function(e){return!h.some(function(t){return t===e})});if(0===d.length)return l;var v=d[0],m=e.dispatch;return n.__assign({isAvailable:!0,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){e={groupKey:i};return[2,m(f.assignItemToGroupWithProgress({items:u.makeObject(r,function(){return e})}))]})})}},s.getItemActionEngagement(e,{itemKey:v,engagement:{name:"Move",isIntentional:!0}}))})(i.Action)});
define("wH",["require","exports","ww","Wv","Mc","Ac","Qi","Gi","i4","Bc","Bc","XU","p4","Vb","k"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v={ODB:670},m={ODB:1602},g={ODB:1124},y={ODB:1523};t.OpenInBFileAction=r.connectToItemCache(function(e,t){var r=t.itemKey,i=e.demandItem({key:o.spItemKeyFacet,itemUrl:l.vroomUrlFacet},r),b=i.key,w=i.itemUrl,E="",S="",x="",T="",N=!1,C=!1,k=!1,L=!1,A=!1;if(b&&w){var O=e.demandItemFacet(u.spPageContextFacet,o.spPageContextKeyFacet.serialize({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl}));h.isFeatureEnabled(e,{feature:v,pageContext:O})&&(C=!0);k=h.isFeatureEnabled(e,{feature:m,pageContext:O});L=h.isFeatureEnabled(e,{feature:g,pageContext:O});A=h.isFeatureEnabled(e,{feature:y,pageContext:O});var M=o.spListKeyFacet.serialize({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl}),_=e.demandItem({driveUrl:u.driveUrlFacet},M).driveUrl,D=e.demandItemFacet(p.driveItemKeyFacet,r);if(_){var P=a.getDriveItemKey(_);if(P){E=P.driveId||"";var H=e.demandItemFacet(f.fileNameFacet,r);if(H){x=H.name;T=H.extension;(P=a.getDriveItemKey(w))&&(N=!!(S=P.itemId||""))}}}else if(D&&!d.Killswitch.isActivated("6e01adaa-b3ef-4d29-9210-6ec116fcbadb","9/13/2020","Use driveItem from item to get driveId and itemId")){E=D.driveId||"";N=!!(S=D.itemId||"")}}var B,j=b?c.btoa("spo:"+b.webAbsoluteUrl):void 0,F=encodeURIComponent(null!=j?j:""),I=encodeURIComponent(E),q=encodeURIComponent(S),R=T.toLowerCase();if((k||L)&&".note"===R)B=L?"https://www.onenote.com/meetingnotes/"+F+"/"+I+"/"+q:"https://www.onenote.com/meetings/"+F+"/"+I+"/"+q;else if(A&&".whiteboard"===R)B="https://whiteboard.microsoft.com/me/whiteboards/p/"+F+"/"+I+"/"+q;else if(C){var U=e.demandItemFacet(f.canonicalUrlFacet,r)||"",z=b?b.webAbsoluteUrl:"";B="https://www.office.com/launch/fluid/content?drive="+E+"&item="+S+"&file="+encodeURIComponent(U)+"&siteUrl="+encodeURIComponent(z)}else B="https://fluidpreview.office.net/p/"+j+"/"+E+"/"+S+"/"+encodeURIComponent(x);return n.__assign({isAvailable:N,onExecute:N?function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){window.open(B);return[2]})})}:void 0},s.getItemActionEngagement(e,{itemKey:r,engagement:{name:"OpenInBFile",isIntentional:!0}}))})(i.Action)});
define("nU",["require","exports","ww","bc","Wv","Mc","Qi","Gi","zi","MS","u4","ty","Ac","Zv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})};t.OpenItemFormUrlAction=r.withSelectedItems()(r.withExactlyOneItem()(i.connectToItemCache(function(e,t){var r=t.itemKey,i=t.isEditForm,s=!1,v=d;if(p.getConfiguration(e,{enableEditOrViewItemCommandConfiguration:u.enableEditOrViewItemCommandConfigurationFacet}).enableEditOrViewItemCommandConfiguration){var m=e.demandItem({key:o.spItemKeyFacet,itemId:u.listItemIdFacet,contentTypeId:u.contentTypeIdFacet,permissions:u.permissionsFacet},r),g=m.key,y=m.itemId,b=m.contentTypeId,w=m.permissions;if(g&&y&&(!i||w&&c.default.hasItemPermission({permissions:w},c.default.editListItems))){var E=g&&e.demandItemFacet(u.spPageContextFacet,o.spPageContextKeyFacet.serialize({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl}));if(E&&!E.isAnonymousGuestUser){var S=e.demandItem({list:u.listFacet,listFormUrls:u.listFormUrlsFacet},o.spListKeyFacet.serialize({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl})),x=S.list,T=S.listFormUrls,N=T?i?T.editFormUrl:T.displayFormUrl:void 0;if(x&&T&&x.templateType&&x.templateType!==a.default.mySiteDocumentLibrary&&N){var C=f.getListItemFormUrl(N,g.rootFolder||new l.default(g.listFullUrl).path,y,b);s=!0;v=function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){(e=window.open(C,"_blank"))&&e.focus();return[2]})})}}}}}return n.__assign({isAvailable:s,onExecute:v},h.getItemActionEngagement(e,{itemKey:r,engagement:{name:i?"OpenItemEditForm":"OpenItemDisplayForm",isIntentional:!0}}))})(s.Action)))});
define("cZe",["require","exports","ww","r","Wv","Mc","Tc","Hs","b3","I7","bc","Ac"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../components/powerBI/PowerBIPanel"],t,n)})];case 1:return[2,t.sent().PowerBIPanel]}})})});t.PowerBIAction=l.withCurrentItemSet()(i.createItemCacheComponent(function(e,t){var i=t.itemKey,a=f.getPageContextFromItemCache(e,i);if(!a)return null;var l=c.getItemActionEngagement(e,{itemKey:i,engagement:{name:"LaunchPowerBIPanel",isIntentional:!0}}),p=o.renderComponentOnExecute(function(e){return r.createElement(h,{pageContext:a,onDismiss:function(){e.reject(new u.CancelError)}})});return r.createElement(s.Action,n.__assign({onExecute:p},l))}))});
define("bU",["require","exports","ww","Wv","Mc","Qi","Gi","gU","Ac"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SetDefaultViewAction=r.connectToItemCache(function(e,t){var r=t.currentDerivedView,i=t.listViewSetKey,u=!1,f=i&&s.spListKeyFacet.serialize(i);if(i&&r){var l=e.demandItemFacet(o.listFacet,f);u=!(!(l&&l.permissions&&l.permissions.manageLists&&r&&r.id)||r.isPersonal||r.isDefault)}return n.__assign({isAvailable:u},a.getItemActionEngagement(e,{itemKey:f,engagement:{name:"SetDefaultView",isIntentional:!0}}))},function(e,t){var r=t.currentDerivedView,i=t.listViewSetKey;return{onExecute:r?function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,o;return n.__generator(this,function(n){e(u.modifyView({items:(t={},t[s.spListViewsSetKeyFacet.serialize(i)]={views:(o={},o[r.id]={isDefault:!0},o)},t)}));return[2]})})}:void 0}})(i.Action)});
define("s7",["require","exports","ww","c7"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("ZM",["require","exports","ww","r","Gi","ty","Bc","Wi","Wv","Qi","zi","b3","Tc","$s","Ac","Vs","Mc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=c.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["UKe"],t,n)})];case 1:return[2,t.sent().CheckOutItemWizard]}})})});t.CheckOutItemAction=a.createItemCacheComponent(function(e,t){var a=t.checkInOutType,c=v.getCurrentItemSetKey(e),y=p.getSelectedItemKeys(e);if(!y.length)return null;var b=e.demandItem({firstItemKey:f.spItemKeyFacet},y[0]).firstItemKey;if(!b)return null;var w=b&&e.demandItemFacet(i.spPageContextFacet,f.spPageContextKeyFacet.serialize({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl}));if(w&&(w.isAnonymousGuestUser||w.isEmailAuthenticationGuestUser))return null;for(var E=e.demandItemFacet(i.listFacet,f.spListKeyFacet.serialize({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl})),S=!!E&&E.templateType===l.ListTemplateType.mySiteDocumentLibrary,x=!!E&&!!E.enableMinorVersions,T=!1,N=0,C=y;N<C.length;N++){var k=C[N],L=e.demandItemFacet(o.folderFacet,k),A=e.demandItemFacet(u.oneNoteFacet,k);if(k&&!L&&!A){var O=e.demandItem({isCheckedOut:o.isCheckedOutFacet,isBFile:i.isBFileFacet},k),M=O.isCheckedOut,_=O.isBFile,D=e.demandItemFacet(i.permissionsFacet,k),P=s.PermissionMask.hasItemPermission({permissions:D},s.PermissionMask.editListItems),H=s.PermissionMask.hasItemPermission({permissions:D},s.PermissionMask.cancelCheckout);"checkOut"===a?T=!_&&!S&&!(M&&(M.byYou||M.byOther))&&P:"checkIn"!==a&&"undoCheckOut"!==a||!M||(T=P&&(!!M.byYou||H&&!!M.byOther))}if(!T)break}var B=y?h.renderComponentOnExecute(function(e){return r.createElement(g,n.__assign({},e,{itemSetKey:c,itemKeys:y,checkInOutType:a,enableMinorVersions:x}))}):void 0;return r.createElement(m.Action,n.__assign({isAvailable:T,onExecute:B},d.getItemActionEngagement(e,{itemKey:y[0],engagement:{name:a,isIntentional:!0,extraData:{isBulk:y.length>1}}})))})});
define("UKe",["require","exports","ww","r","QF","Md","To","Hs","IL","TT","Z_","FKe","Bc","KM","Gi","QM","b3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=m.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["QR"],t,n)})];case 1:return[2,t.sent().CheckInDialog]}})})}),y=l.implementOperationWithProgress({operationTypeFacet:i.updateCheckoutStateOperation,progressKeyFacet:i.checkoutProgressKeyFacet,initializeBatch:function(){return c.checkoutProgressAddon}});function b(e){var t=e.dispatch,n=e.itemKeys,i=e.itemSetKey;r.useEffect(function(){t(y({items:o.makeObject(n,function(){return{checkInOutType:"checkOut"}})})).then(function(){var e;i&&t(v.refreshItemsInSet({items:(e={},e[i]=o.makeObject(n,function(){return{}}),e)}))})},[]);return null}t.CheckOutItemExecutor=b;var w=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,i=t.reject,l=t.resolve,c=t.itemKeys,m=t.checkInOutType,w=t.enableMinorVersions,E=t.itemSetKey,S=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){i(new u.CancelError);return[2]})})};return r.createElement(s.WithItemCache,null,function(t){var i,s=t.dispatch,u=t.itemCache;if(1===(c&&c.length)){var x=c[0],T=u.demandItemFacet(h.displayNameFacet,x),N=p.getVersion(u,x),C=N.minor;i={major:N.major,minor:C,displayName:T,moderationStatusType:u.demandItemFacet(d.moderationStatusTypeFacet,x)}}var k=function(t){return n.__awaiter(e,void 0,void 0,function(){var e;return n.__generator(this,function(n){switch(n.label){case 0:l();e={checkInOutType:m,checkInText:t&&t.comment||"",checkInVersionType:t&&t.checkInVersionType};return[4,s(y({items:o.makeObject(c,function(){return e})})).then(function(){var e;E&&s(v.refreshItemsInSet({items:(e={},e[E]=o.makeObject(c,function(){return{}}),e)}))})];case 1:n.sent();return[2]}})})};return"undoCheckOut"===m?r.createElement(a.ConfirmationDialog,{onConfirm:k,onCancel:S,title:f.default.DiscardCheckoutTitle,prompt:f.default.DiscardCheckoutText}):"checkIn"===m?r.createElement(g,{onContinue:k,onCancel:S,itemCount:c&&c.length,itemInfo:i,enableMinorVersions:w}):"checkOut"===m?r.createElement(b,{dispatch:s,itemKeys:c,itemSetKey:E}):r.createElement(r.Fragment,null)})};return t})(r.PureComponent);t.CheckOutItemWizard=w});
define("iT",["require","exports","ww","r","Qi","Gi","ty","bc","Wv","Mc","Ac","b3","Tc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=a.connectToItemCache()(c.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["BKe"],t,n)})];case 1:return[2,t.sent().ContentTypeNavigationCreator]}})})})),d=a.createItemCacheComponent(function(e,t){var u,a=t.itemKey,c=e.demandItemFacet(i.spItemKeyFacet,a),d=!1;if(c&&(u=e.demandItemFacet(s.spPageContextFacet,i.spPageContextKeyFacet.serialize({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl})))&&!u.isAnonymousGuestUser){var v=e.demandItemFacet(s.permissionsFacet,a);d=o.PermissionMask.hasItemPermission({permissions:v},o.PermissionMask.insertListItems)}var m=h.renderComponentOnExecute(function(e){return r.createElement(p,n.__assign({},e,t,{pageContext:u}))});return r.createElement(f.Action,n.__assign({isAvailable:d,onExecute:m},l.getItemActionEngagement(e,{itemKey:a,engagement:{name:"ContentTypeNavigation",isIntentional:!0}})))});t.ContentTypeNavigationAction=u.withOnlyCurrentItem()(d)});
define("BKe",["require","exports","ww","r","Vh","GD","Md","Gi","eU","qT","k"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=i.asAutoAction()(a.CreateListItemAction),h=i.asAutoAction()(s.NewItemInOfficeClientAction),p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onComplete=function(){n.setState({isCompleted:!0});n.props.resolve()};n.state={isCompleted:!1};return n}t.prototype.render=function(){var e=this,t=this.props,n=t.contentTypeId,i=t.openInClient,s=t.contentTypeKey,a=t.pageContext,p=this.state.isCompleted;return n&&!p?r.createElement(o.WithItemCache,null,function(t){var o=t.itemCache.demandItemFacet(u.spListContentTypeFacet,s);if(o){var p=a&&!l.getKillSwitch(a).isActivated("E38C27E3-F930-424A-AE58-5E53C46F25DA","11/01/2019","Always open in client if appMap property exists except for infopath")&&!("ms-infopath"===o.appMap&&!i),d=o.templateUrl.indexOf("CreateNewDocument.aspx?id=")>-1,v=o.appMap&&f.getOfficeStringMap(o.appMap);if(i&&(d||v)||p&&o.appMap)return r.createElement(h,{contentTypeKey:s,onComplete:e._onComplete})}return r.createElement(c,{contentTypeId:n,onComplete:e._onComplete})}):null};return t})(r.Component);t.ContentTypeNavigationCreator=p});
define("eU",["require","exports","ww","Gi","ty","e7","bc"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function u(e,t){var n=t.itemKey,s=e.demandItemFacet(r.permissionsFacet,n);return i.PermissionMask.hasItemPermission({permissions:s},i.PermissionMask.insertListItems)}var a=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["HKe"],t,n)})];case 1:return[2,t.sent().CreateListItemExecutor]}})})};t.CreateListItemAction=o.withOnlyCurrentItem()(s.createDeferredOnExecuteAction(a,u));t.CreateListItemIgnoreSelectionAction=o.withCurrentItem()(s.createDeferredOnExecuteAction(a,u))});
define("HKe",["require","exports","ww","r","Qi","Gi","u4","MS","Ke","Wv","Mc","Ac","RKe","Tc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateListItemExecutor=f.createItemCacheComponent(function(e,t){var f,d=t.itemKey,v=t.contentTypeId,m=t.defaultValueOverride,g=void 0===m?{}:m,y=e.demandItemFacet(i.spItemKeyFacet,d),b="";if(y){var w=i.spListKeyFacet.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl}),E=e.demandItemFacet(s.listFormUrlsFacet,w);if(v){var S=i.spListContentTypeKeyFacet.serialize({listKey:{webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl},contentTypeId:v}),x=e.demandItemFacet(s.spListContentTypeFacet,S);if(x&&x.templateUrl){var T=new a.ItemUrlHelperBasic({context:{webAbsoluteUrl:y.webAbsoluteUrl,listUrl:y.listFullUrl}}).getUrlParts({path:x.templateUrl});T.fullItemUrl&&(b=T.fullItemUrl)}}b||(b=E&&E.newFormUrl||"");b&&(b=u.getListItemFormUrl(b,y.rootFolder||new o.default(y.listFullUrl).path,void 0,v));var N=v;if(!N){var C=e.demandItemFacet(s.contentTypeKeysFacet,w);if(C&&C.length){var k=e.demandItemFacet(s.spListContentTypeFacet,C[0]);k&&(N=k.contentTypeId)}}var L=e.demandItemFacet(h.createListItemActionControl,t.itemKey);f=h.createListItemActionControl.evaluate(L)(e,{itemKey:t.itemKey,formUrl:b,defaultValueOverride:g,contentTypeId:N}).action}return f?p.renderAction(f):r.createElement(l.Action,n.__assign({onExecute:(function(e){var t=this;return function(){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){e&&(t=window.open(e,"_blank"))&&t.focus();return[2]})})}})(b)},c.getItemActionEngagement(e,{itemKey:d,engagement:{name:"CreateItem",isIntentional:!0}})))})});
define("NKe",["require","exports","ww","r","Wv","Qi","Gi","bc","yU","Ac","Tc","Mc","b3","c3","fb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=h.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./FreshViewCreator"],t,n)})];case 1:return[2,t.sent().FreshViewCreator]}})})});t.CreateViewAction=i.createItemCacheComponent(function(e,t){var i=t.isEditing,h=t.currentViewKey,m=u.getCurrentItemSetKey(e),g=p.getItemsScope(e).itemsScopeItemKey,y=e.demandItemFacet(s.spFolderItemSetKeyFacet,m),b=e.demandItemFacet(a.saveViewActionControl,m),w=e.demandItemFacet(o.currentDerivedViewFacet,h),E=a.saveViewActionControl.evaluate(b)(e,{viewKey:h}).onViewSaved;if(!m||!g)return null;var S=!1;if(y&&w){var x=s.spListKeyFacet.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl}),T=e.demandItemFacet(o.listFacet,x);S=!!(T&&w&&"POWER"!==w.viewType&&T.permissions&&(T.permissions.managePersonalViews||T.permissions.manageLists))}var N=y?e.demandItemFacet(o.spPageContextFacet,s.spPageContextKeyFacet.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl})):void 0,C=l.renderComponentOnExecute(function(e){return r.createElement(d.ItemsScope,{itemsScopeItemKey:g},r.createElement(v,n.__assign({},e,t,{pageContext:N,itemSetKey:m,onViewSaved:E})))},{scope:"global"});return r.createElement(c.Action,n.__assign({isAvailable:S,onExecute:C},f.getItemActionEngagement(e,{itemKey:m,engagement:{name:i?"EditView":"CreateNewView",isIntentional:!0}})))})});
define("DT",["require","exports","ww","r","Mc","bc","Wv","Gi","DS","Qi","Ac","k","Cs","jo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})},v=o.createItemCacheComponent(function(e,t){var s=t.itemKeys,o=t.enabledForMultipleItems,h=void 0===o?t.enabledForMultipleItems||!1:o,p=t.isEnabledFunc,v=t.commandAdapter,g=e.dispatch,y=!!h||1===s.length;if(y&&1===s.length&&"function"==typeof p){var b=e.demandItem({key:f.spItemKeyFacet,permissions:u.permissionsFacet,rowData:u.rowDataFacet},s[0]),w="",E="",S="";if(b&&b.rowData){var x=b.rowData;w=x.File_x0020_Type||"";E=x.ContentTypeId||"";S=x.ProgId||""}else y=!1;y=y&&p({permissions:b&&b.permissions||0,extension:w,contentTypeId:E,progId:S})}if(y&&v){var T=[];s.forEach(function(t){var n=e.demandItemFacet(a.rowAdapterFacet,t);n&&T.push(n)});v.refresh(T);y=y&&v.visible}var N=d;v&&(N=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return[2,v.execute()]})})});var C=!c.Killswitch.isActivated("416CBFAD-51CE-4EFF-8231-D4EFCAC3DB3C","12/13/2019","Generate rowAdapter if not available");return r.createElement(r.Fragment,null,C?r.createElement(m,{dispatch:g,itemKeys:s}):null,r.createElement(i.Action,n.__assign({isAvailable:y,onExecute:N},l.getItemActionEngagement(e,{itemKey:s[0],engagement:{name:"ClientSideCommandSet",isIntentional:!0}}))))}),m=function(e){var t=e.dispatch,r=e.itemKeys;if(r.length<1)return null;var i=r[0],s=void 0;if(f.spItemKeyFacet.matches(i)){var o=f.spItemKeyFacet.deserialize(i);if(o){var l=f.spListKeyFacet.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl});s=t(h.readItem({listViewAdapter:a.listViewAdapterFacet},l)).listViewAdapter}}var c={};if(s){r.forEach(function(e){var r=t(h.readItem({rowData:u.rowDataFacet,rowAdapter:a.rowAdapterFacet},e)),i=r.rowData;if(!r.rowAdapter&&i&&s){var o=s.createRowAdapter({values:i});o&&(c[e]=n.__assign({},a.rowAdapterFacet.pack(o)))}});Object.keys(c).length>0&&t(p.resolveItems({items:c}))}return null};t.ClientSideCommandSetAction=s.withSelectedItems()(v)});
define("IT",["require","exports","ww","Mc","bc","Wv","Gi","Qi","CT","xT","Ac"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})};t.CustomActionNavigationAction=i.withCurrentItem()(i.withSelectedItems()(s.connectToItemCache(function(e,t){var r,i,s,h=t.itemKey,p=t.itemKeys,d=t.enabledForMultipleItems,v=void 0===d?t.enabledForMultipleItems||!1:d,m=t.isEnabledFunc,g=t.url,y=!!v||1===p.length,b=void 0,w=void 0;if(y&&p[0]){var E=e.demandItem({key:u.spItemKeyFacet,permissions:o.permissionsFacet,rowData:o.rowDataFacet},p[0])||void 0;if(E){w=E.key;b=E.rowData;s=E.permissions}}else if(y&&h){var S=e.demandItem({key:u.spItemKeyFacet,permissions:o.permissionsFacet},h);if(S){w=S.key;s=S.permissions}}r=w&&w.webAbsoluteUrl;i=w&&w.listFullUrl;var x=r&&i&&e.demandItemFacet(o.spPageContextFacet,u.spPageContextKeyFacet.serialize({webAbsoluteUrl:r,listFullUrl:i}))||void 0;if(y&&!v)if("boolean"==typeof m)y=m;else if("function"==typeof m){var T="",N="",C="";if(b){var k=b;T=k.File_x0020_Type||"";N=k.ContentTypeId||"";C=k.ProgId||""}else y=!1;y=m({permissions:s||0,extension:T,contentTypeId:N,progId:C})}if(y&&g){var L=[];p.forEach(function(t){var n=e.demandItem({itemId:o.listItemIdFacet,itemUrl:o.folderPathFacet},t);n&&L.push({id:n.itemId||"",url:n.itemUrl||""})});x&&(g=a.prepareAction(g,L,x))}var A=c;A=g&&"javascript:LaunchApp("===g.substring(0,21)&&");"===g.substring(g.length-2)?function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){g&&x&&f.invokeLaunchAppFunction(g,x);return[2]})})}:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){(e=window.open(g,"_blank"))&&e.focus();return[2]})})};return n.__assign({isAvailable:y,onExecute:A},l.getItemActionEngagement(e,{itemKey:p[0],engagement:{name:"CustomActionNavigation",isIntentional:!0}}))})(r.Action)))});
define("DU",["require","exports","ww","r","Wv","Qi","Gi","Ac","Mc","IU"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CustomizeViewActionn=i.createItemCacheComponent(function(e,t){var i=t.viewKey,l=t.itemSetKey,c=void 0,h=l&&e.demandItemFacet(s.spFolderItemSetKeyFacet,l),p=e.demandItemFacet(o.currentDerivedViewFacet,i);if(h&&p){var d=s.spListKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl}),v=e.demandItemFacet(o.listFacet,d),m=e.demandItemFacet(o.spPageContextFacet,s.spPageContextKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl}));m&&v&&v.id&&p&&"POWER"!==p.viewType&&v.permissions&&p.canUserEdit(v.permissions)&&(c=f.getClassicEditViewPageUrl({webAbsoluteUrl:h.webAbsoluteUrl,layoutsUrl:m.layoutsUrl,viewId:p.id,listId:v.id,sourceUrl:p.serverRelativeUrl||""}))}var g=!!c;return r.createElement(a.Action,n.__assign({isAvailable:g,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){window.open(c);return[2]})})}},u.getItemActionEngagement(e,{itemKey:l,engagement:{name:"CustomizeView",isIntentional:!0}})))})});
define("dT",["require","exports","r","nm","qi","lT","Sm","vm"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.dragDropKeyFacet.serialize({}),f=new i.Facet("moveToGroupDefaultDropActionHandler").id;t.moveToGroupDefaultDropActionHandler={key:f,evaluate:function(e,t){var i=t.itemKey,f=e.demandItemFacet(r.isGroupFacet,i),l=e.demandItemFacet(o.draggedItemFacet,a),c=l&&l.draggedItem;return{action:(!c||c.type===u.DOCUMENT_DRAG_TYPE)&&f?n.createElement(s.MoveToGroupAction,{itemKeys:c&&c.itemKeys||[],groupKey:i}):void 0}},canHandleEvent:function(e){return function(t){if(e&&e.event){var n=e.event.dataTransfer;return n&&n.type===u.DOCUMENT_DRAG_TYPE||!1}return!1}}}});
define("_T",["require","exports","r","nm","xm","fm","qi","Sm","vm"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=u.dragDropKeyFacet.serialize({}),l=new o.Facet("uploadToGroupDefaultDropActionHandler").id;t.uploadToGroupDefaultDropActionHandler={key:l,evaluate:function(e,t){var s=t.itemKey,o=e.demandItemFacet(u.draggedItemFacet,f),l=o&&o.draggedItem,c=!l||l.type===a.FILE_DRAG_TYPE,h=e.demandItemFacet(r.isGroupFacet,s);return{action:c&&h?n.createElement(i.ItemUploadEntriesAction,{itemKey:s}):void 0}},canHandleEvent:function(e){return function(t){return e.event&&e.event&&s.isFileDropEvent(e.event)||!1}}}});
define("AT",["require","exports","ww","r","ty","b3","LT","Wv","Tc","$s","Gi","Ac","Mc","Qi","zi","Zv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./EditItemWizard"],t,n)})];case 1:return[2,t.sent().EditItemWizard]}})})});t.EditItemAction=u.createItemCacheComponent(function(e,t){var s=f.getSelectedItemKeys(e),u=1===s.length?s[0]:void 0,g=v.getConfiguration(e,{enableEditItemCommand:l.enableEditItemCommandConfigurationFacet}).enableEditItemCommand,y=e.demandItemFacet(o.itemPropertiesFormControl,u),b=o.itemPropertiesFormControl.evaluate(y)(e,{itemKey:u}).getPropertiesForm,w=e.demandItemFacet(l.permissionsFacet,u),E=e.demandItemFacet(p.spItemKeyFacet,u),S=E&&e.demandItemFacet(l.listFacet,p.spListKeyFacet.serialize(E)),x=S&&S.templateType===d.ListTemplateType.mySiteDocumentLibrary,T=g&&!!b&&!!w&&!x&&i.default.hasItemPermission({permissions:w},i.default.editListItems),N=u&&b?a.renderComponentOnExecute(function(e){return r.createElement(m,n.__assign({},e,{itemKey:u,interactiveSave:t.interactiveSave,getPropertiesForm:b}))}):void 0;return r.createElement(h.Action,n.__assign({isAvailable:T,onExecute:N},c.getItemActionEngagement(e,{itemKey:u,engagement:{name:"EditItem",isIntentional:!0}})))})});
define("RT",["require","exports","ww","r","Qi","bc","Vs","Wv","tc","O9","Bc","Gi","ty","Ac","b3","vo","Tc","Mc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=u.connectToItemCache()(d.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["jKe"],t,n)})];case 1:return[2,t.sent().EditPinnedItemExecutor]}})})})),b=u.createItemCacheComponent(function(e,t){var s=t.itemKey,u=t.editType,d=v.getItemsScope(e).itemsScopeItemKey,b=(function(e,t){var n=o.getCurrentItemSetKey(e),r=e.demandItemFacet(i.spPinnedItemSetKeyFacet,n);if(r)return i.spPinnedItemSetKeyFacet.serialize(r);return})(e),w=e.demandItem({isMalwareDetected:l.malwareDetectedFacet,permissions:c.permissionsFacet},s),E=w.isMalwareDetected,S=w.permissions,x=!E&&!!s&&f.doesListSupportPinnedItems(e,t)&&!!b&&!!S&&h.PermissionMask.hasItemPermission({permissions:S},h.PermissionMask.manageLists)&&(function(e,t){var n=t.pinnedItemSetKey,r=t.editType,i=e.demandItemFacet(a.childItemsFacet,n),s=i?i.itemKeys:[],o=s.indexOf(t.itemKey),u=o>-1?0!==r:0===r;u&&(2===r?u=0!==o:3===r&&(u=o!==s.length-1));return u})(e,{itemKey:t.itemKey,pinnedItemSetKey:b,editType:u}),T=d?m.renderComponentOnExecute(function(e){return r.createElement(y,n.__assign({},e,t,{itemsScopeItemKey:d,pinnedItemSetKey:b}))}):void 0;return r.createElement(g.Action,n.__assign({isAvailable:x,onExecute:T},p.getItemActionEngagement(e,{itemKey:s,engagement:{name:"EditPinnedItem",isIntentional:!0}})))});t.EditPinnedItemAction=s.withSelectedItems()(s.withExactlyOneItem()(b))});
define("jKe",["require","exports","ww","r","YF","xF","HT","mL","kA","Hs","yo","VKe","Z_","cc","tc","xF"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.editPinnedItemWithProgress=h.implementOperationWithProgress({operationTypeFacet:i.editPinnedItemOperation,progressKeyFacet:i.editPinnedItemProgressKeyFacet,initializeBatch:function(){return c.editPinnedItemProgressAddon}});var m=(function(e){n.__extends(i,e);function i(t){var n=e.call(this,t)||this;n.state={editPinnedItemError:void 0};return n}i.prototype.componentDidMount=function(){var e,n,r=this,i=this.props,o=i.itemCacheDispatch,u=i.pinnedItemSetKey,a=i.itemKey,f=i.editType,c=i.resolve,h=i.itemsScopeItemKey,m=i.editPinnedItem,g=void 0===m?t.editPinnedItemWithProgress:m;if(u){var y=o(p.readItems(function(e){return e.demandItem({pinnedItems:d.childItemsFacet},u)})).pinnedItems;if(0===f&&y&&y.itemKeys&&y.itemKeys.length>=v.MAX_PINNED_ITEM_COUNT)this.setState({editPinnedItemError:new s.EditPinnedItemError({resultType:3})});else{o(g({items:(e={},e[u]={itemEditTypeMap:(n={},n[a]={editType:f},n)},e)})).then(function(){c()},function(e){r.setState({editPinnedItemError:e})});1===f&&o(l.selectItems({itemsScopeItemKey:h,selectedItemKeys:[],currentSelectionKey:void 0}))}}else this.props.reject(new Error("No pinned item set to modify."))};i.prototype.render=function(){var e=this.props,t=e.editType,i=e.reject,s=this.state.editPinnedItemError;if(s){var l=(function(e,t,n){var r,i,s=e.resultType,a=3===t||2===t;if(1===s){r=a?o.default.errorMoveItemMissingTitle:0===t?o.default.errorPinItemMissingTitle:o.default.errorUnpinItemMissingTitle;i=o.default.errorFolderMissingBody}else if(2===s){if(0!==t)return;r=a?o.default.errorMoveItemMissingTitle:o.default.errorPinItemMissingTitle;i=o.default.errorItemMissingBody}else if(3===s){r=a?o.default.errorMoveGenericTitle:o.default.errorPinnedItemsFullTitle;i=o.default.errorPinnedItemsFullBody}else{if(4===s)return;r=a?o.default.errorMoveGenericTitle:0===t?o.default.errorPinGenericTitle:o.default.errorUnpinGenericTitle;i=o.default.errorGenericErrorBody}return{title:r,prompt:i,cancelText:u.default.cancelActionText,onCancel:function(){n(new f.CancelError)}}})(s,t,i);if(l)return r.createElement(a.WarningDialog,n.__assign({},l))}return null};return i})(r.PureComponent);t.EditPinnedItemExecutor=m});
define("dH",["require","exports","ww","e7","Qi","Gi","lH","zi","Zv","Yr","to"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GroupByAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["sH"],t,n)})];case 1:return[2,t.sent().GroupByActionExecutor]}})})},function(e,t){var r=t.groupByFieldKey,c=t.itemSetKey,h=e.demandItemFacet(i.spFolderItemSetKeyFacet,c);if(!h)return!1;var p=l.spListKeyFacet.serialize(h),d=e.demandItemFacet(s.listFacet,p),v=d&&d.templateType===u.default.mySiteDocumentLibrary,m=a.getConfiguration(e,{enableGroupByInOneDrive:s.enableGroupByInOneDriveFacet}).enableGroupByInOneDrive,g=e.demandItemFacet(s.defaultGroupByFieldsFacet,c),y=h.groupByFieldKey===r||!!g&&-1!==g.indexOf(r),b=i.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},h),{groupByFieldKey:y?void 0:r})),w=h.viewKey&&f.spViewKeyFacet.serialize(h.viewKey),E=e.demandItemFacet(o.groupByActionControl,c);return o.groupByActionControl.evaluate(E)(e,{itemSetKey:c,viewKey:w,groupedItemSetKey:b,isAvailable:!v||!!m}).isAvailable},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,o=e.demandItemFacet(i.spFolderItemSetKeyFacet,r);if(!o)return!1;var u=e.demandItemFacet(s.defaultGroupByFieldsFacet,r);return o.groupByFieldKey===n||!!u&&-1!==u.indexOf(n)})});
define("sH",["require","exports","ww","r","Qi","Mc","tc","Gi","tc","am","Tc","Ac","Wv","$_","bF"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GroupByActionExecutor=h.createItemCacheComponent(function(e,t){var v=t.groupByFieldKey,m=t.itemSetKey,g=e.demandItemFacet(i.spFolderItemSetKeyFacet,m);if(!g)return r.createElement(l.WithAction,null);var y=e.demandItemFacet(u.defaultGroupByFieldsFacet,m),b=!g.groupByFieldKey&&!!y&&-1!==y.indexOf(v),w=g.groupByFieldKey===v||b,E=i.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},g),{groupByFieldKey:w?void 0:v})),S=i.spItemKeyFacet.serialize(g),x=g.viewKey&&i.spViewKeyFacet.serialize(g.viewKey),T=e.demandItemFacet(u.currentDerivedViewFacet,x),N=c.getItemActionEngagement(e,{itemKey:m,engagement:{name:"GroupBy",isIntentional:!0}}),C=e.dispatch,k=h.evaluateItemCacheComponent(e,r.createElement(f.ItemOpenAction,{itemKey:E}));return r.createElement(l.WithAction,{action:k},function(e){var t=e.execute;return r.createElement(s.Action,n.__assign({onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,i,s,f,l,c,h,m;return n.__generator(this,function(g){switch(g.label){case 0:r=new p.ItemResolver;if(x&&b&&T&&(i=T.getDomParts())&&i.groupBy){s=d.parseGroupBy(i.groupBy);f=void 0;s.group1.fieldName===v?s.group2&&(f={isCollapsed:s.isCollapsed,group1:s.group2}):(null===(m=s.group2)||void 0===m?void 0:m.fieldName)===v&&(f={isCollapsed:s.isCollapsed,group1:s.group1});T.updateGroupBy(f);r.invalidateItems({items:(l={},l[E]=[a.childItemsFacet],l[x]=[u.currentDerivedViewFacet],l)})}r.resolveItems({items:n.__assign((c={},c[E]=n.__assign({},o.parentItemFacet.pack({itemKey:S})),c),x?(h={},h[x]=n.__assign({},u.showViewModifiedIndicatorFacet.pack(!0)),h):{})});C(r.execute());return[4,t(e)];case 1:g.sent();return[2]}})})}},N))})})});
define("zKe",["require","exports","ww","WF","Wv","Mc","p3","Bc","Ac"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUpdateLikesExectuor=i.connectToItemCache(function(e,t){var i=t.itemKey,s=e.demandItemFacet(u.likesCountFacet,i)||0,f=e.demandItemFacet(u.hasUserLikedFacet,i)||!1,l=f?s-1:s+1,c=e.dispatch;return n.__assign(n.__assign({isAvailable:!0},a.getItemActionEngagement(e,{itemKey:i,engagement:{name:"UpdateLikes",isIntentional:!0}})),{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(s){switch(s.label){case 0:c(o.resolveItems({items:(e={},e[i]=n.__assign(n.__assign({},u.likesCountFacet.pack(l)),u.hasUserLikedFacet.pack(!f)),e)}));return[4,c(r.updateItemLikes({items:(t={},t[i]={liked:!f},t)}))];case 1:s.sent();return[2]}})})}})})(s.Action)});
define("nH",["require","exports","ww","Wv","Mc","Qi","Gi","$8","aH","p4","Qi","Gi","Ac"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={ODB:1318},d=!1;t.ModifyColumnAction=r.connectToItemCache(function(e,t){var r=t.itemSetKey,i=t.modifyType,u=t.columnKey,a=!1,v=e.demandItem({setKey:s.spFolderItemSetKeyFacet,canModifySchema:o.canModifySchemaFacet},r),m=v.setKey,g=v.canModifySchema,y=m&&m.viewKey?s.spViewKeyFacet.serialize(m.viewKey):void 0,b=e.demandItem({currentDerivedView:o.currentDerivedViewFacet},y).currentDerivedView,w=e.demandItemFacet(o.internalNameFacet,u);if(m&&g&&b&&b.baseViewXml&&w)if(1===i||2===i){var E=b.getEffectiveFieldNames();if(E&&E.length){var S=E.indexOf(w),x=m.groupByFieldKey?1:0;a=1===i?S>x+1:S>=x&&S<E.length-1}}else a=!0;if(m){var T=e.demandItemFacet(c.spPageContextFacet,l.spPageContextKeyFacet.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl})),N=e.demandItemFacet(o.listFacet,s.spListKeyFacet.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}));d=f.isFeatureEnabled(e,{feature:p,pageContext:T})&&!!(N&&N.permissions&&N.permissions.manageLists)}return n.__assign({isAvailable:a},h.getItemActionEngagement(e,{itemKey:r,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var r=t.itemSetKey,i=t.modifyType,s=t.columnKey,o=d?a.modifyColumnWithProgress:u.modifyColumn;return{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,u;return n.__generator(this,function(n){e(o({items:(t={},t[r]={columnModifyTypeMap:(u={},u[s]={modifyType:i},u)},t)}));return[2]})})}}})(i.Action)});
define("tH",["require","exports","ww","Wv","Mc","WU","_S","Ac","Gi"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ModifyColumnAggregateTypeAction=r.connectToItemCache(function(e,t){var r=t.itemSetKey,i=t.columnKey,s=t.aggregateType,f=e.demandItemFacet(a.columnTotalsFacet,r),l=f&&f[i]&&f[i].aggregateFunctionType||o.ColumnAggregateTypeName[0],c=l===o.ColumnAggregateTypeName[s]?void 0:o.ColumnAggregateTypeName[s];return n.__assign({isAvailable:!0,isToggled:l===o.ColumnAggregateTypeName[s]},c?u.getItemActionEngagement(e,{itemKey:r,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:c||"AggregateTypeNone",extraData:{PreviousAggregateType:l||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var r=t.itemSetKey,i=t.columnKey,o=t.aggregateType;return{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t;return n.__generator(this,function(n){e(s.modifyColumnAggregateType({items:(t={},t[r]={aggregateType:o,columnKey:i},t)}));return[2]})})}}})(i.Action)});
define("AH",["require","exports","ww","r","LH"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){t.props.resolve()};return t}t.prototype.render=function(){var e=this.props,t=e.title,n=e.linkLocation,s=e.launchBehaviorType;if(n&&void 0!==s){if("dialog"===s)return r.createElement(i.IFrameDialog,{url:n,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===s?window.open(n,"_self"):window.open(n,"_blank")}this.props.resolve();return null};return t})(r.PureComponent);t.OpenAsHyperLinkExecutor=s});
define("EH",["require","exports","ww","r"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.targetUrl;e&&window.open(e,"_blank");this.props.resolve();return null};return t})(r.PureComponent);t.OpenAsShortcutExecutor=i});
define("Cy",["require","exports","ww","r","Mc","Oy","Zv","Gi","Qi","Wv"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PinSiteAction=f.createItemCacheComponent(function(e,t){var o=t.itemKey,f=t.rootItemKey,h=t.pinOperationType,p=a.pinnedItemKeyFacet.serialize({rootItemKey:f,itemKey:o}),d=!!e.demandItemFacet(u.pinOrderFacet,p),v=e.dispatch;return r.createElement(i.Action,{isAvailable:c(e,d,h),isToggled:l(d,h),onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){v(s.default({items:(e={},e[f]=(t={},t[o]={type:d?"unpin":"pin"},t),e)}));return[2]})})}})});function l(e,t){return!t&&e}function c(e,t,n){var r=o.getConfiguration(e,{isSitePinningEnabled:u.enableSitePinningConfigurationFacet,isFilesWeightedFrequentSitesEnabled:u.enableFilesWeightedFrequentSitesConfigurationFacet}),i=r.isSitePinningEnabled,s=r.isFilesWeightedFrequentSitesEnabled,a=!!i&&!!s;return!(a&&n&&("pin"===n&&t||"unpin"===n&&!t))&&a}});
define("zM",["require","exports","ww","r","qM","Gi","VM","bc","Wv","Hs","Ac","Bc","kA","Tc","Mc","Vs","k","zi","Qi","KM","Y9","GM"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=a.connectToItemCache()(i.PublishItemExecutor),x=a.connectToItemCache(function(e,t){var r=t.onCancel,i=t.reject;return{onCancel:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){i(new f.CancelError);r&&r();return[2]})})},title:o.default.MissingMetadataDialogTitle,prompt:o.default.MissingMetadataDialogText,cancelText:o.default.MissingMetadataDialogButton}})(h.WarningDialog);t.ItemPublishAction=a.createItemCacheComponent(function(e,t){var i,o=t.itemKeys,u=t.publishType,a=t.source;if(!o||!o.length)return null;var f=v.getCurrentItemSetKey(e),h=e.demandItem({firstItemKey:y.spItemKeyFacet,hasMissingMetadata:c.missingMetadataFacet,contentTypeId:s.contentTypeIdFacet},o[0]),T=h.firstItemKey,N=h.hasMissingMetadata,C=h.contentTypeId;if(!T)return null;var k=T&&e.demandItemFacet(s.spPageContextFacet,y.spPageContextKeyFacet.serialize({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:T.listFullUrl}));if(k&&(k.isAnonymousGuestUser||k.isEmailAuthenticationGuestUser))return null;var L=!1,A=!!k&&m.getKillSwitch(k).isActivated("f307ef95-b7d3-4b5a-af39-d71f6f4eaaf1","06/09/2020","Dont show submit for approval button when multiple items are selected"),O=b.getPublishActionType(e,o[0]);if(!(!A&&o.length>1&&((null===(i=k)||void 0===i?void 0:i.listBaseTemplate)!==g.default.webPageLibrary||!(O===E.PublishActionType.Publish||O===E.PublishActionType.Republish||O===E.PublishActionType.PostNews||O===E.PublishActionType.UpdateNews))))for(var M=0,_=o;M<_.length;M++){var D=_[M];if(!(L=!!b.canPublishOrSchedule(e,D)&&(!(!A&&o.length>1&&!b.isSitePage(C))&&(w.isPublishStartDateInFuture(e,D)?1===u:0===u))))break}var P=p.renderComponentOnExecute(function(e){if(N){return r.createElement(x,n.__assign({},e,{onCancel:function(e){}}))}return r.createElement(S,n.__assign({},e,{itemKeys:o,itemSetKey:f}))});return r.createElement(d.Action,n.__assign({isAvailable:L,onExecute:P},l.getItemActionEngagement(e,{itemKey:o[0],engagement:{name:"PublishItem",isIntentional:!0,extraData:{publishSource:a}}})))});t.PublishItemAction=u.withSelectedItems()(t.ItemPublishAction)});
define("GM",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Publish=0]="Publish";e[e.Republish=1]="Republish";e[e.PostNews=2]="PostNews";e[e.UpdateNews=3]="UpdateNews";e[e.SubmitForApproval=4]="SubmitForApproval";e[e.CancelApproval=5]="CancelApproval";e[e.SchedulePublish=6]="SchedulePublish"})(t.PublishActionType||(t.PublishActionType={}))});
define("qM",["require","exports","ww","r","JM","To","GM","Qi","Bc","Gi","cc","th","KM","zi","YM","Z_","k","QM","Te"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updatePublishState=m.Killswitch.isActivated("991d2b61-3537-434c-8a72-45623f632435","1/13/2020","Use progress addon for publish")?v.implementOperationWithProgress({operationTypeFacet:i.updatePublishStateOperation,progressKeyFacet:i.publishProgressKeyFacet}):v.implementOperationWithProgress({operationTypeFacet:i.updatePublishStateOperation,progressKeyFacet:i.publishProgressKeyFacet,initializeBatch:function(){return d.publishProgressAddon}});var b=(function(e){n.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.state={publishItemError:void 0};return n}r.prototype.componentDidMount=function(){var e=this.props,n=e.itemCacheDispatch,r=e.itemKeys,i=e.itemSetKey,d=e.resolve,v=e.reject,b=r[0],w=n(l.readItems(function(e){return e.demandItem({firstItemKey:u.spItemKeyFacet,displayName:a.displayNameFacet},r[0])})),E=w.firstItemKey,S=w.displayName,x=n(l.readItems(function(e){return h.getPublishActionType(e,b)})),T={publishActionType:x},N=!1;if(E){var C=n(l.readItems(function(e){return e.demandItemFacet(f.listFacet,u.spListKeyFacet.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl}))}));N=!!C&&C.templateType===p.ListTemplateType.webPageLibrary}if(E&&N&&x===o.PublishActionType.SubmitForApproval){var k=m.Killswitch.isActivated("bb2acf46-d145-4ac4-9aed-542d0b2c2e0b","6/2/2020","FixPageUrlInLibSubFolder2"),L=k?"":new y.SimpleUri(E.webAbsoluteUrl).authority,A=k?"":n(l.readItems(function(e){return e.demandItemFacet(f.folderPathFacet,r[0])})),O=k?E.listFullUrl+"/"+S:""+L+A;window.location.href=O}else n(t.updatePublishState({items:s.makeObject(r,function(){return T})})).then(function(){var e,t;n(c.invalidateItems({items:(e={},e[b]=[f.uiVersionFacet],e[b]=[f.needsPublishingFacet],e)}));i&&n(g.refreshItemsInSet({items:(t={},t[i]=s.makeObject(r,function(){return{}}),t)}));d()}).catch(function(e){v(e)})};r.prototype.render=function(){return null};return r})(r.PureComponent);t.PublishItemExecutor=b});
define("YM",["require","exports","ww","r","K_","kb","G_","we","Z_","ih","SL","JM","tc","Bc","VM","GM"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";var m,g;Object.defineProperty(t,"__esModule",{value:!0});var y=((m={})[f.ProgressPhase.started]=function(e){var t=e.count,n=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(n?d.default.schedulePublishStartedItemsTitle:d.default.publishStartedItemsTitle,d.default.publishCompletedItemsTitleIntervals,t)||"",t)},m[f.ProgressPhase.completed]=function(e){var t=e.count,n=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(n?d.default.schedulePublishCompletedItemsTitle:d.default.publishCompletedItemsTitle,d.default.publishCompletedItemsTitleIntervals,t)||"",t)},m[f.ProgressPhase.failed]=function(e){var t=e.count,n=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(n?d.default.schedulePublishFailedItemsTitle:d.default.publishFailedItemsTitle,d.default.publishFailedItemsTitleIntervals,t)||"",t)},m[f.ProgressPhase.canceled]=function(e){var t=e.count,n=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(n?d.default.schedulePublishFailedItemsTitle:d.default.publishFailedItemsTitle,d.default.publishFailedItemsTitleIntervals,t)||"",t)},m),b=((g={})[f.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey,i=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(i?d.default.schedulePublishStartedItemsTitle:d.default.publishStartedItemsTitle,d.default.publishStartedItemsDestinationTitleIntervals,t)||"",t,r.createElement(l.ItemLink,{key:"link",itemKey:n}))},g[f.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey,i=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(i?d.default.schedulePublishCompletedItemsDestinationTitle:d.default.publishCompletedItemsDestinationTitle,d.default.publishCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(l.ItemLink,{key:"link",itemKey:n}))},g[f.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey,i=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(i?d.default.schedulePublishFailedItemsDestinationTitle:d.default.publishFailedItemsDestinationTitle,d.default.publishFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(l.ItemLink,{key:"link",itemKey:n}))},g[f.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey,i=e.isScheduled;return u.formatToArray(u.getLocalizedCountValue(i?d.default.schedulePublishFailedItemsDestinationTitle:d.default.publishFailedItemsDestinationTitle,d.default.publishFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(l.ItemLink,{key:"link",itemKey:n}))},g);t.publishProgressAddon=i.createAddon(function(){return function(e){e(s.registerControlHandler(c.publishProgressKeyFacet,o.progressControl)(s.createControlHandler()(w)))}});function w(){return function(e){return E}}function E(e,t){var r,i,s=a.getOverallSimpleProgressBreakdown(e,t),o=s.phase,u=s.count,l=(function(e,t){var n=void 0,r=e.demandItemFacet(h.childItemsFacet,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(f.sourceItemFacet,o),a=u&&u.itemKey,l=e.demandItemFacet(p.parentFolderItemFacet,a),c=l&&l.itemKey;if(c)if(n){if(c!==n)break}else n=c}return n})(e,t),d=e.demandItemFacet(h.childItemsFacet,t.itemKey),m=d&&d.itemKeys;m&&m.length>0&&(i=e.demandItemFacet(c.updatePublishStateOperation,m[0]));var g=!!i&&i.publishActionType===v.PublishActionType.SchedulePublish;r="group"===t.format&&l?b[o]({count:u,itemKey:l,isScheduled:g}):y[o]({count:u,isScheduled:g});return n.__assign(n.__assign({},r&&"item"!==t.format?{title:r}:{}),{})}});
define("pU",["require","exports","ww","bc","Gi","Zv","e7","Qs","d9"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExitQuickEditAction=r.withCurrentItemSet()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["GKe"],t,n)})];case 1:return[2,t.sent().ExitQuickEditActionExecutor]}})})},function(e,t){var n=s.getConfiguration(e,{enableQuickEdit:i.enableQuickEditFacet}).enableQuickEdit,r=!!n;if(n){r=u.getCurrentLayout(e)===a.quickEditLayoutType}return r}))});
define("GKe",["require","exports","ww","r","Mc","tc","Md","Tc","Ac","th","Dg","yc","Qi","Gi","ga","k","p3","KKe","Lk","Ak"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return r.createElement(o.WithItemCache,null,function(o){var w=o.itemCache,E=o.dispatch,S=a.getItemActionEngagement(w,{itemKey:t,engagement:{name:"ExitQuickEdit",isIntentional:!0}}),x=w.demandItem({deserizalizeKey:h.spFolderItemSetKeyFacet},t).deserizalizeKey,T=x&&h.spGridInitInfoKeyFacet.serialize({listKey:{webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl},viewKey:x.viewKey}),N=w.demandItem({completeExitingQuickEditSignal:p.completeExitingQuickEditSignalFacet},T).completeExitingQuickEditSignal,C=x&&x.viewKey&&h.spViewKeyFacet.serialize(x.viewKey),k=C&&w.demandItemFacet(p.currentDerivedViewFacet,C),L="HTML",A=w.demandItemFacet(p.quickEditExitLayoutType,C);if(A)L=g.getViewTypeFromLayoutType(A)||L;else{k&&k.viewType&&"GRIDFIXED"!==k.viewType&&"GRID"!==k.viewType&&(v.Killswitch.isActivated("E3C6F7C4-D470-41FE-B6C2-CE9B46D4AF45","06/11/2020","Exit quick edit to use current view's viewType if the viewType if not fixedGrid or datasheet")||(L=k.viewType));A=g.getLayoutTypeFromViewType(L)||c.detailsLayoutType}return r.createElement(u.WithAction,{action:r.createElement(l.SwitchLayoutAction,{layoutType:A})},function(o){var u=o.execute;return r.createElement(i.Action,n.__assign({isAvailable:!0,onExecute:function(r){return n.__awaiter(e,void 0,void 0,function(){var e,i,o=this;return n.__generator(this,function(a){switch(a.label){case 0:e=E(y.getSharePointDataEventSource);d.EventGroup.raise(e,b.SPGridEvents.startExitingQuickEditEventName);return N?[4,N.promise.then(function(){return n.__awaiter(o,void 0,void 0,function(){var e;return n.__generator(this,function(n){E(f.invalidateItems({items:(e={},e[t]=[s.childItemsFacet],e)}));return[2]})})})]:[3,2];case 1:a.sent();a.label=2;case 2:C&&E(m.resolveItems({items:(i={},i[C]=n.__assign(n.__assign({},p.viewTypeFacet.pack(L)),p.showViewModifiedIndicatorFacet.pack(!0)),i)}));return[4,u(r)];case 3:a.sent();return[2]}})})}},S))})})};return t})(r.PureComponent);t.ExitQuickEditActionExecutor=w});
define("EWe",["require","exports","ww","r","Mc","Md","Tc","Ac","Dg","d9","Qi","Gi","po","p3","k","AWe","Qs","c3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=d.Killswitch.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),b=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return r.createElement(s.WithItemCache,null,function(s){var d=s.itemCache,b=s.dispatch,w=u.getItemActionEngagement(d,{itemKey:t,engagement:{name:"QuickEdit",isIntentional:!0}}),E=d.demandItem({deserizalizeKey:l.spFolderItemSetKeyFacet},t).deserizalizeKey,S=E&&E.viewKey,x=E&&l.spGridInitInfoKeyFacet.serialize({listKey:{webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl},viewKey:S}),T=S&&l.spViewKeyFacet.serialize(S),N=g.getItemsScope(d).itemsScopeItemKey,C=m.getCurrentLayout(d,{itemsScopeItemKey:N});return r.createElement(o.WithAction,{action:r.createElement(a.SwitchLayoutAction,{layoutType:f.quickEditLayoutType})},function(t){var s=t.execute;return r.createElement(i.Action,n.__assign({isAvailable:!0,onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r;return n.__generator(this,function(i){switch(i.label){case 0:if(!y){v.resetRumOneMarker();v.addRumOneMarker("quickEdit.layoutManager.start")}x&&b(p.resolveItems({items:(e={},e[x]=n.__assign({},c.completeExitingQuickEditSignalFacet.pack(new h.Signal)),e)}));T&&b(p.resolveItems({items:(r={},r[T]=n.__assign({},c.quickEditExitLayoutType.pack(C)),r)}));return[4,s(t)];case 1:i.sent();y||v.addRumOneMarker("quickEdit.layoutManager.end");return[2]}})})}},w))})})};return t})(r.PureComponent);t.QuickEditActionExecutor=b});
define("bet",["require","exports","ww","r","Wv","Ac","Mc","bc","Qs","d9","Lk","ga","Ak","p4","I7"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v={ODB:1024},m=function(e){var t=e.undoRedoActionType,i=e.dispatch,s=e.isAvailable,u=r.useState(0),a=u[0],f=u[1],p=r.useState(0),d=p[0],v=p[1],m=r.useRef(new c.EventGroup({})),g=s&&("undo"===t&&a>0||"redo"===t&&d>0);r.useEffect(function(){var e=i(l.getSharePointDataEventSource);m.current.on(e,h.SPGridEvents.undoRealCmdCountChangeEventName,function(e){f(e.undoRealCmdCount)});m.current.on(e,h.SPGridEvents.redoRealCmdCountChangeEventName,function(e){v(e.redoRealCmdCount)});return function(){m.current.dispose()}},[]);return r.createElement(o.Action,n.__assign({},e,{isAvailable:g}))},g=i.createItemCacheComponent(function(e,t){var i=t.itemKey,o=t.undoRedoActionType,u="undo"===o,g=d.getPageContextFromItemCache(e,i),y=p.isFeatureEnabled(e,{feature:v,pageContext:g});if(y){y=a.getCurrentLayout(e)===f.quickEditLayoutType}var b=e.dispatch;return r.createElement(m,n.__assign({undoRedoActionType:o,dispatch:b,isAvailable:y,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){e=b(l.getSharePointDataEventSource);c.EventGroup.raise(e,u?h.SPGridEvents.undoChangeEventName:h.SPGridEvents.redoChangeEventName);return[2]})})}},s.getItemActionEngagement(e,{itemKey:i,engagement:{name:u?"QuickEditUndoAction":"QuickEditRedoAction",isIntentional:!0}})))});t.QuickEditUndoRedoAction=u.withCurrentItemSet()(g)});
define("xU",["require","exports","ww","bc","Gi","Zv","e7","p4","Qs","c3","d9","Qi"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:1725},p={ODB:1553};function d(e,t){var n=s.getConfiguration(e,{enableQuickEdit:i.enableQuickEditFacet}).enableQuickEdit,r=f.getItemsScope(e).itemsScopeItemKey,o=r&&a.getCurrentLayout(e,{itemsScopeItemKey:r}),c=o&&o.id===l.quickEditLayoutType.id;return!!(n&&!!c&&u.isFeatureEnabled(e,{feature:h})&&u.isFeatureEnabled(e,{feature:p}))}t.SwitchGridLayoutAction=r.withCurrentItemSet()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./SwitchGridLayoutActionExecutor"],t,n)})];case 1:return[2,t.sent().SwitchGridLayoutActionExecutor]}})})},d,function(e,t){var n=t.itemKey,r=t.viewType,s=e.demandItem({deserizalizedKey:c.spFolderItemSetKeyFacet},n).deserizalizedKey,o=s&&s.viewKey&&c.spViewKeyFacet.serialize(s.viewKey),u=o&&e.demandItemFacet(i.viewTypeFacet,o);return d(e)&&u===r}))});
define("QKe",["require","exports","ww","qF","Wv","Mc","Ac"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUpdateRatingExecutor=i.connectToItemCache(function(e,t){var i=t.itemKey,s=t.currentRating,u=e.dispatch;return n.__assign({onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,u(r.updateItemRating({items:(e={},e[i]={userNewRating:s},e)}))];case 1:t.sent();return[2]}})})},isAvailable:!0},o.getItemActionEngagement(e,{itemKey:i,engagement:{name:"UpdateRating",isIntentional:!0}}))})(s.Action)});
define("Ty",["require","exports","ww","r","Mc","Oy","Gi","Qi","Wv"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReorderPinnedSiteAction=a.createItemCacheComponent(function(e,t){var a=t.itemKey,f=t.rootItemKey,l=u.pinnedItemKeyFacet.serialize({rootItemKey:f,itemKey:a}),c=!!e.demandItemFacet(o.pinOrderFacet,l),h=e.dispatch;return r.createElement(i.Action,{isAvailable:c,onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,i,o,u,a,l;return n.__generator(this,function(n){t=e.event;r=t.dataTransfer,i=r.draggedItemKey,o=r.prevPinOrder,u=r.nextPinOrder;h(s.default({items:(a={},a[f]=(l={},l[i]={type:"reorderPin",reorderPinInfo:{prevPinOrder:o,nextPinOrder:u}},l),a)}));return[2]})})}})})});
define("vU",["require","exports","ww","r","Wv","Qi","Gi","bc","yU","Ac","Tc","Mc","c3","fb","b3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=d.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["eH"],t,n)})];case 1:return[2,t.sent().ViewCreator]}})})});t.SaveViewAction=i.createItemCacheComponent(function(e,t){var i=t.currentViewKey,d=u.getCurrentItemSetKey(e),m=h.getItemsScope(e).itemsScopeItemKey,g=!1,y=e.demandItemFacet(s.spFolderItemSetKeyFacet,d),b=e.demandItemFacet(o.currentDerivedViewFacet,i),w=e.demandItemFacet(a.saveViewActionControl,d),E=a.saveViewActionControl.evaluate(w)(e,{viewKey:i}).onViewSaved;if(y&&b){var S=s.spListKeyFacet.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl}),x=e.demandItemFacet(o.listFacet,S);g=!!(x&&b&&"POWER"!==b.viewType&&x.permissions&&(x.permissions.managePersonalViews||x.permissions.manageLists))}if(!b||!d||!m)return null;var T=l.renderComponentOnExecute(function(e){return r.createElement(p.ItemsScope,{itemsScopeItemKey:m},r.createElement(v,n.__assign({},e,t,{itemSetKey:d,viewTitle:b.title,isPublicView:!b.isPersonal,onViewSaved:E})))},{scope:"global"});return r.createElement(c.Action,n.__assign({isAvailable:g,onExecute:T},f.getItemActionEngagement(e,{itemKey:d,engagement:{name:"SaveView",isIntentional:!0}})))})});
define("mN",["require","exports","ww","r","ou","HA","oL","jR","Zm","CH","mL","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";c=c.SaveViewDialog_0;Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onCheckboxChanged=function(e,t){n.setState({isPublicView:!!t})};n._onNameRef=function(e){if(e){e.focus();e.select()}};n._onNameChanged=function(e,t){void 0===t&&(t="");var r=n.props.validator;n.setState(function(){return{viewTitle:t,errorMessage:r?r(t):void 0}})};n._onClickAction=function(){n.setState({showSpinner:!0});n.props.onContinue({viewTitle:n.state.viewTitle,isPublicView:n.state.isPublicView}).catch(function(e){n.setState({showSpinner:!1,errorMessage:e&&e.message})})};n._onKeyPress=function(e){13===e.which&&n._onClickAction()};n._initialViewTitle=t.viewTitle;n._initialIsPublicView=t.isPublicView;n.state={viewTitle:n._initialViewTitle,isPublicView:n._initialIsPublicView};return n}t.prototype.render=function(){var e=this.state,t=e.viewTitle,n=e.errorMessage,h=e.showSpinner;return r.createElement(s.Dialog,{hidden:!1,title:f.default.SaveAs,onDismiss:this.props.onCancel},r.createElement(o.TextField,{label:f.default.SaveViewExplanation,componentRef:this._onNameRef,value:t,onChange:this._onNameChanged,errorMessage:n,onKeyPress:this._onKeyPress,className:c.saveViewDialogTextField}),r.createElement(u.Checkbox,{label:f.default.SaveViewMakePublic,className:c.saveViewDialogTextField,disabled:t===this._initialViewTitle,defaultChecked:this._initialIsPublicView,onChange:this._onCheckboxChanged}),r.createElement(s.DialogFooter,null,r.createElement(a.PrimaryButton,{disabled:!t||!!n||h,onClick:this._onClickAction,text:f.default.SaveViewCommit}),h&&r.createElement(i.Spinner,{size:i.SpinnerSize.medium,className:c.saveViewDialogSpinner}),r.createElement(a.DefaultButton,{text:l.default.cancelActionText,onClick:this.props.onCancel})))};return t})(r.PureComponent);t.SaveViewDialog=h});
define("xH",["require","exports","ww","r","Gi","KF","Hs","lF","CH","we","Mo","Cs","OH","Vh","Qi","b3","Co","e3","Wv","c3","tc","JP","l3","$_","th","k","im"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=N.Killswitch.isActivated("93C218F9-D649-4531-939E-C60EAEA4509C","06/08/2020","Use switchViewAction after save existing view"),L=new l.AutoKeyFacet("saveViewProgressBatch"),A=v.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["mN"],t,n)})];case 1:return[2,t.sent().SaveViewDialog]}})})});function O(){return L.serializeNext()}var M=p.asAutoAction()(h.SwitchViewExecutor);function _(e){var t=this,l=e.viewTitle,h=e.isPublicView,p=e.onViewSaved,v=e.currentViewKey,y=e.itemSetKey,b=e.itemsScopeItemKey,N=e.listViewSetKey,L=e.reject,_=e.resolve,D=r.useState(!0),P=D[0],H=D[1],B=r.useState(O)[0],j=r.useState(),F=j[0],I=j[1],q=r.useState(),R=q[0],U=q[1],z=g.useItemCacheDispatch(),W=m.useEventHandler(function(){U(!0);p&&p();_()}),X=z(c.readItem({currentDerivedView:i.currentDerivedViewFacet},v)).currentDerivedView,V=m.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,o,l,h,m,g,A,O;return n.__generator(this,function(M){switch(M.label){case 0:t=e.viewTitle,r=e.isPublicView;o=X&&X.title!==t;l=z(c.readItem({deserializedSetKey:d.spFolderItemSetKeyFacet},y)).deserializedSetKey;if(!(o&&l&&X))return[3,3];if(!(h=t.trim()))throw new Error(a.default.CreateViewErrorNoTitle);return[4,z(u.getViewData({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}))];case 1:if(M.sent().some(function(e){return e.serverView.Title===t}))throw new Error(f.format(a.default.SaveViewErrorCannotOverwrite,t));return[4,z(s.createView({items:(A={},A[N]={views:(O={},O[h]={itemSetKey:y,isPublic:r,sourceView:X,progressItemKey:B},O)},A)}))];case 2:M.sent();if(m=z(c.readItem({createdViewKey:d.spViewKeyFacet},B)).createdViewKey){I(m.viewId);H(!1)}return[3,5];case 3:if(!b){L(new Error("Cannot save a view without a current ItemsScope"));return[2]}return[4,z((D={itemsScopeItemKey:b,listViewSetKey:N,itemSetKey:y,currentViewKey:v},function(e){var t,r,s=D.itemsScopeItemKey,o=D.listViewSetKey,u=D.itemSetKey,a=D.currentViewKey,f=e(c.readItem({childItems:w.childItemsFacet,parentItem:w.parentItemFacet,deserializedItemSetKey:d.spFolderItemSetKeyFacet},u)),l=f.childItems,h=f.parentItem,p=f.deserializedItemSetKey;return e(E.saveViewCore({items:(t={},t[o]={views:(r={},r[a]={itemSetKey:u},r)},t)})).then(function(){var t,r;if(p){var o=d.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},p),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),u=e(c.readItem({filterOptionSets:w.filterOptionSetsFacet},o)).filterOptionSets;if(u&&p.filterParams){var f={};for(var v in u)u.hasOwnProperty(v)&&(f[u[v]]=!0);e(S.clearItems({items:f}))}var m=new x.ItemResolver;m.resolveItems({items:(t={},t[o]=n.__assign(n.__assign({},l?w.childItemsFacet.pack(l):{}),h?w.parentItemFacet.pack(h):{}),t[a]=n.__assign({},i.showViewModifiedIndicatorFacet.pack(!1)),t)});e(m.execute());e(T.invalidateItems({items:(r={},r[a]=[i.serverViewFacet,i.currentDerivedViewFacet],r[o]=[w.childItemsFacet],r)}));k&&e(C.openItem({itemsScopeItemKey:s,currentItemKey:o}))}})}))];case 4:M.sent();if(k){p&&p();_()}else if(g=z(c.readItem({savedViewKey:d.spViewKeyFacet},v)).savedViewKey){I(g.viewId);H(!1)}M.label=5;case 5:return[2]}var D})})}),$=m.useEventHandler(function(){L(new o.CancelError)});return P?r.createElement(A,{viewTitle:l,isPublicView:h,onContinue:V,onCancel:$}):!R&&F?r.createElement(M,{viewId:F,currentDerivedView:X,onComplete:W,itemSetKey:y}):null}t.ViewCreator=y.createItemCacheComponent(function(e,t){var i=b.getItemsScope(e).itemsScopeItemKey;return r.createElement(_,n.__assign({},t,{itemsScopeItemKey:i}))})});
define("c7",["require","exports","ww","e7","tc","Qi","Zr","c3","s3","Io"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SortAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["YKe"],t,n)})];case 1:return[2,t.sent().SortActionExecutor]}})})},function(e,t){var r=t.sortFieldKey,i=t.itemSetKey,o=t.isAscending,l=e.demandItemFacet(s.spFolderItemSetKeyFacet,i);if(!l)return!1;var c=u.getItemsScope(e).itemsScopeItemKey;if(!c)return!1;var h=s.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},l),{sortFieldKey:r,sortAscending:o})),p=e.demandItemFacet(a.openActionControl,h),d=a.openActionControl.evaluate(p)(e,{itemKey:h,itemsScopeItemKey:c,isAvailable:!0}),v=d.itemKey;if(!d.isAvailable)return!1;var m=e.demandItemFacet(f.currentItemFacet,c),g=m&&m.itemKey;return!!v&&v!==g},function(e,t){var n=t.sortFieldKey,r=t.itemSetKey,u=t.isAscending,a=e.demandItemFacet(s.spFolderItemSetKeyFacet,r);if(!a)return!1;var f=e.demandItemFacet(i.sortFacet,r),l=f&&e.demandItemFacet(o.spListFieldKeyFacet,f.columnKey),c=l&&l.internalName||a.sortFieldKey,h=f?f.isAscending:a.sortAscending;return c===n&&h===u})});
define("YKe",["require","exports","ww","r","Qi","Zr","Mc","p3","tc","Gi","Md","Tc","am","Ac","e9","W3","zi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,g=t.sortFieldKey,y=t.itemSetKey,b=t.isAscending;return r.createElement(l.WithItemCache,null,function(t){var l=t.itemCache,w=t.dispatch,E=l.demandItemFacet(i.spFolderItemSetKeyFacet,y);if(!E)return r.createElement(c.WithAction,null);var S=i.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},E),{sortFieldKey:g,sortAscending:b})),x=i.spItemKeyFacet.serialize(E),T=E.viewKey&&i.spViewKeyFacet.serialize(E.viewKey),N=l.demandItemFacet(f.listFacet,i.spListKeyFacet.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl})),C=l.demandItemFacet(f.spPageContextFacet,i.spPageContextKeyFacet.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl})),k=p.getItemActionEngagement(l,{itemKey:y,engagement:{name:"Sort",isIntentional:!0}});return r.createElement(c.WithAction,{action:r.createElement(h.ItemOpenAction,{itemKey:S})},function(t){var i=t.execute;return r.createElement(o.Action,n.__assign({onExecute:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r;return n.__generator(this,function(o){switch(o.label){case 0:w((function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c;return n.__generator(this,function(n){switch(n.label){case 0:t=e.sortField,i=e.isAscending,s=e.webAbsoluteUrl,o=e.listFullUrl,u=e.pageContext,a=e.templateType;f=a===m.ListTemplateType.mySiteDocumentLibrary;if(!(u&&u.isSiteAdmin)||!f)return[3,2];l=d.getListApiUrl({webAbsoluteUrl:s,listFullUrl:o}).segment("DefaultView").segment("SetViewXml");c=i?"TRUE":"FALSE";return[4,r(v.getData({webAbsoluteUrl:s,listFullUrl:o,url:l.toString(),method:"POST",qosName:"SetDefaultView",noRedirect:!0,body:JSON.stringify({viewXml:'<View><Query><OrderBy><FieldRef Name="'+t+'" Ascending="'+c+'" /></OrderBy></Query></View>'})}))];case 1:return[2,n.sent()];case 2:return[4,Promise.resolve(void 0)];case 3:return[2,n.sent()]}})})}})({sortField:this.props.sortFieldKey,isAscending:this.props.isAscending,webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl,pageContext:C,templateType:N&&N.templateType}));w(u.resolveItems({items:n.__assign((e={},e[S]=n.__assign(n.__assign({},a.parentItemFacet.pack({itemKey:x})),a.sortFacet.pack({columnKey:s.spListFieldKeyFacet.serialize({listKey:E,internalName:this.props.sortFieldKey}),isAscending:this.props.isAscending})),e),T?(r={},r[T]=n.__assign({},f.showViewModifiedIndicatorFacet.pack(!0)),r):{})}));return[4,i(t)];case 1:o.sent();return[2]}})})}},k))})})};return t})(r.PureComponent);t.SortActionExecutor=g});
define("SU",["require","exports","ww","e7"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SwitchViewAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["OH"],t,n)})];case 1:return[2,t.sent().SwitchViewExecutor]}})})},function(e,t){return!0},function(e,t){var n=t.currentDerivedView,r=t.viewId;return n?r===n.id:""===r})});
define("OH",["require","exports","ww","r","bc","Mc","p3","tc","Qi","Gi","CS","Tc","am","th","Ac","Wv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemSwitchViewAction=v.createItemCacheComponent(function(e,t){var i=t.itemKey,v=t.itemSetKey,m=t.viewId,g=t.currentDerivedView,y=e.demandItemFacet(a.spItemKeyFacet,i);if(!y)return null;var b=y.webAbsoluteUrl,w=y.listFullUrl,E=e.demandItemFacet(a.spFolderItemSetKeyFacet,v),S=a.spFolderItemSetKeyFacet.serialize({webAbsoluteUrl:b,listFullUrl:w,rootFolder:E&&E.rootFolder||"",viewKey:{viewId:m}}),x=g&&a.spViewKeyFacet.serialize({viewId:g.id}),T=e.isItemFacetResolved(f.serverViewFacet,x)?e.demandItemFacet(f.serverViewFacet,x):void 0,N=d.getItemActionEngagement(e,{itemKey:i,engagement:{name:"SwitchView",isIntentional:!0}}),C=e.dispatch,k=c.evaluateAction(e,r.createElement(h.ItemOpenAction,{itemKey:S}));return r.createElement(c.WithAction,{action:k},function(e){var t=e.isAvailable,a=e.execute;return r.createElement(s.Action,n.__assign({isAvailable:t,isToggled:g?m===g.id:""===m,onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,s;return n.__generator(this,function(c){switch(c.label){case 0:C(o.resolveItems({items:n.__assign(n.__assign({},x?(t={},t[x]=n.__assign(n.__assign({},f.showViewModifiedIndicatorFacet.pack(!1)),T&&g&&g.isDirty()?n.__assign({},f.currentDerivedViewFacet.pack(new l.default(T))):{}),t):{}),i?(r={},r[S]=n.__assign({},u.parentItemFacet.pack({itemKey:i})),r):{})}));x&&g&&g.isDirty()&&C(p.invalidateItems({items:(s={},s[x]=[f.serverViewFacet,f.currentDerivedViewFacet],s)}));return[4,a(e)];case 1:c.sent();return[2]}})})}},N))})});t.SwitchViewExecutor=i.withCurrentItem()(t.ItemSwitchViewAction)});
define("JKe",["require","exports","ww","r","HA","Zm","$Ke","we","MA","W1e","ODBItemsScopeDeferred_mini_css","XKe","Gc","Wv","p8","q","Pc","Co","H","qg","e3","js","ou","N"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";l=l.SyncDialog_6;Object.defineProperty(t,"__esModule",{value:!0});var T="https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/sync_to_device_illustration.svg";function N(){return{button:{zIndex:100}}}function C(e){var t=e.clientDownloadUrl,n=e.resolve,h=e.reject,p=e.protocolCallback,d=e.telemetry,C=e.getSyncInfo,k=e.isTenantAdmin,L=w.useItemCacheDispatch(),A=r.useState(),O=A[0],M=A[1],_=r.useState(),D=_[0],P=_[1],H=r.useState(),B=H[0],j=H[1],F=r.useState(),I=F[0],q=F[1],R=r.useState(),U=R[0],z=R[1],W=E.usePreviousValue(C),X=E.usePreviousValue(k);r.useEffect(function(){if(C&&!W){var e=new(d(v.Qos))({name:"SyncDialog.getSyncInfo"});L(C()).then(function(t){e.end({resultType:v.ResultTypeEnum.Success});M(t)},function(t){e.end(m.getQosEndSchemaFromError(t));P(t)})}},[C]);r.useEffect(function(){if(k&&!X){var e=new(d(v.Qos))({name:"SyncDialog.isTenantAdmin"});L(k()).then(function(t){e.end({resultType:v.ResultTypeEnum.Success});j(t)},function(t){e.end(m.getQosEndSchemaFromError(t));q(t)})}},[k]);var V=O&&O.protocolUrl;r.useEffect(function(){if(p&&V)try{p(V)}catch(e){z(new x.ApiError({code:"ProtocolCallbackFailed",innerError:e}))}},[p,V]);var $=g.useEventHandler(function(){var e=O&&O.syncConfigParams||"";f.copyToClipboard(e)}),J=g.useEventHandler(function(){C?k?D?h(D):I?h(I):U&&h(U):h(new x.ApiError({code:"NoGetIsTenantAdmin",isExpected:!1})):h(new x.ApiError({code:"NoGetSyncInfo",isExpected:!1}));O?n():h(new y.CancelError)}),K=D?r.createElement("div",{className:l.errorContainer},r.createElement("div",null,b.default.genericFailedDescription),D.message?r.createElement("div",null,D.message):null):null,Q=r.createElement(r.Fragment,null,u.formatToArray(o.default.NGSCSyncDialogBody3Format,r.createElement("a",{className:l.pointerText,href:t,target:"_blank"},o.default.NGSCSyncDialogGetOneDriveButton))),G=B?r.createElement(r.Fragment,null,r.createElement("div",{className:l.adminContentContainer},r.createElement(a.Label,null,o.default.NGSCSyncDialogBody1,r.createElement(s.ActionButton,{className:l.copyLibraryId,onClick:$},o.default.NGSCSyncDialogBody4a),o.default.NGSCSyncDialogBody4b)),r.createElement("div",{className:l.separator},r.createElement(c.Separator,null)),r.createElement(a.Label,{className:l.footNote},Q)):r.createElement("div",{className:l.contentContainer},o.default.NGSCSyncDialogBody1,Q),Y=r.createElement(i.Dialog,{hidden:!1,onDismiss:J,containerClassName:l.syncDialog,dialogContentProps:{type:i.DialogType.close,styles:N}},r.createElement("div",{className:l.syncDialogContent},r.createElement("img",{className:l.syncImg,src:T,alt:o.default.syncImgAlt}),r.createElement("h2",{className:l.syncTitle},o.default.NGSCSyncDialogTitle),G,K,void 0!==B&&O&&t?null:r.createElement("div",{className:l.spinner,"aria-hidden":!0},r.createElement(S.Spinner,null))));return r.createElement(r.Fragment,null,Y,V&&!p?r.createElement("div",{style:{display:"none"}},r.createElement("iframe",{hidden:!0,src:V})):null)}t.SyncDialog=p.createItemCacheComponent(function(e,t){var i=t.itemKey,s=e.demandItemFacet(d.itemSyncDialogControl,i),o=d.itemSyncDialogControl.evaluate(s)(e,{itemKey:i}),u=o.clientDownloadUrl,a=o.getSyncInfo,f=o.isTenantAdmin,l=h.getTelemetry(e).telemetry;return r.createElement(C,n.__assign({},t,{telemetry:l,getSyncInfo:a,clientDownloadUrl:u,isTenantAdmin:f}))})});
define("LU",["require","exports","ww","K_","kb","n0","Qi","i0","f0","jU","u0","HU","wv","UU","a0","MU","kU"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointBasicActionsAddonDeferred=r.createAddon(function(){return function(t){t(r.registerOperationHandler(o.spItemKeyFacet,u.deleteItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["Ek"],t,n)})];case 1:return[2,t.sent().spItemDeleteItemsOperationHandler]}})})})));t(r.registerOperationHandler(o.spItemKeyFacet,a.renameItemOperation)(f.renameItem));t(i.registerControlHandler(o.spItemKeyFacet,l.renameActionControl)(c.renameActionControlHandler));t(i.registerControlHandler(o.spItemKeyFacet,h.downloadItemsActionControlFacet)(p.downloadItemsActionControlHandler));t(i.registerControlHandler(o.spItemKeyFacet,d.deleteActionControler)(v.deleteActionControlerHandler));t(i.registerControlHandler(o.spItemKeyFacet,s.deleteItemsActionControl)(m.deleteItemsActionControlerHandler))}})});
define("EU",["require","exports","K_","AU"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointBasicItemDataAddonDeferred=n.createAddon(function(){return function(e){e(r.sharePointItemByFullUrlAddon)}})});
define("dM",["require","exports","K_","kb","Qi","CC","pM","R6","fM","dD","Ls","lM","N9"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointWebItemTileAddon=n.createAddon(function(){return function(e){e(r.registerControlHandler(i.spItemKeyFacet,s.itemTileControl)(o.spItemTileControlHandler));e(r.registerControlHandler(i.spItemKeyFacet,u.itemThumbnailControl)(a.spItemThumbnailControlHandler));e(n.registerOperationHandler(f.spItemThumbnailKeyFacet,l.getItemsOperation)(c.spItemThumbnailGetItemsOperationHandler));e(h.sharePointWebBasicItemDataAddon)}})});
define("kT",["require","exports","r","qi","t7","MT","zi"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.approveRejectCommandKey=new r.Facet("ApproveReject").id;t.getApproveRejectCommand=function(e){var r=e.listFacets,u=r&&r.templateType===o.default.webPageLibrary&&r.isModerated?i.default.ReviewApprovals:i.default.ApproveReject;return{key:t.approveRejectCommandKey,automationId:"approveRejectCommand",iconProps:{iconName:"DocumentApproval"},name:u,action:n.createElement(s.ApproveRejectAction,null)}}});
define("ET",["require","exports","r","ZM","TT","qi","t7","kT","AT"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moreCommandsKey=new s.Facet("moreCommands").id;t.CheckOutItemCommand={key:new s.Facet("CheckOutItem").id,automationId:"checkOutItemCommand",name:i.default.CheckOut,iconProps:{iconName:"ArrowDownRight8"},action:n.createElement(r.CheckOutItemAction,{checkInOutType:"checkOut"})};t.CheckInItemCommand={key:new s.Facet("CheckInItem").id,automationId:"checkInItemCommand",name:i.default.CheckIn,iconProps:{iconName:"ArrowDownRight8"},action:n.createElement(r.CheckOutItemAction,{checkInOutType:"checkIn"})};t.UndoCheckoutItemCommand={key:new s.Facet("UndoCheckOutItem").id,automationId:"undoCheckoutItemCommand",name:i.default.UndoCheckOut,iconProps:{iconName:"ArrowDownRight8"},action:n.createElement(r.CheckOutItemAction,{checkInOutType:"undoCheckOut"})};t.viewDocumentPropertyCommand={key:new s.Facet("ViewDocumentProperties").id,name:o.default.ViewProperties,action:n.createElement(a.EditItemAction,{interactiveSave:!0})};t.MoreCommands={key:t.moreCommandsKey,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:[t.viewDocumentPropertyCommand,t.CheckOutItemCommand,t.CheckInItemCommand,t.UndoCheckoutItemCommand]}};t.getMoreCommands=function(e){var n=e.listFacets,r=u.getApproveRejectCommand({listFacets:n}),i=!!n&&!n.isDocumentLibrary;return{key:t.moreCommandsKey,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:i?[r]:[t.viewDocumentPropertyCommand,t.CheckOutItemCommand,t.CheckInItemCommand,t.UndoCheckoutItemCommand,r]}}}});
define("$T",["require","exports","r","tU","qi","H0","Ng","eU"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createListItemCommand={key:new i.Facet("createListItem").id,automationId:"createListItemCommand",name:r.default.listItem,action:n.createElement(o.HideWithSelection,null,n.createElement(u.CreateListItemAction,null)),iconProps:s.getCommandIconProps({size:16,type:4})}});
define("yT",["require","exports","r","qi","Bc","tc","DS","Qi","Gi","wT","IT","DT","hd","md","ODBItemsScopeDeferred_mini_css","vo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";d=d.CustomActionCommands_5;Object.defineProperty(t,"__esModule",{value:!0});var m=new r.Facet("customActionNavigationCommand").id;function g(e){var t=e.key,r=e.name,i=e.url,s=e.iconUrl,o=e.enabledForMultipleItems,u=e.isEnabledFunc,a=e.commandAdapter;return{key:m+"-"+t,automationId:"customactionNavigation",name:r,iconProps:{iconType:h.IconType.image,className:d.customActionCommandIcon,imageProps:{src:s||"",imageFit:p.ImageFit.contain,className:d.customActionCommandIcon}},action:a?n.createElement(c.ClientSideCommandSetAction,{enabledForMultipleItems:o,isEnabledFunc:u,commandAdapter:a}):i?n.createElement(l.CustomActionNavigationAction,{url:i,enabledForMultipleItems:o,isEnabledFunc:u}):void 0}}t.getCustomActionNavigationCommand=g;var y=new r.Facet("customActionGroupCommand").id;function b(e){var t=e.key,n=e.name,r=e.subCommands;return{key:y+"-"+t,automationId:"customActionGroupCommand",name:n,subMenuProps:{items:r}}}t.getCustomActionGroupCommand=b;t.getCustomActionCommands=function(e,t){var n=t.webAbsoluteUrl,r=t.listFullUrl,i=u.customActionSetKeyFacet.serialize({webAbsoluteUrl:n,listFullUrl:r}),s=E({itemCache:e,targetCustomActionSetKey:i,keys:{webAbsoluteUrl:n,listFullUrl:r}}),o=w(e,i);s&&(o=o.concat(w(e,s)));return o};function w(e,t){var n=[],r=e.demandItemFacet(s.childItemsFacet,t);r&&r.itemKeys&&r.itemKeys.forEach(function(t){var r=e.demandItem({displayName:i.displayNameFacet,openUrl:i.openUrlFacet,iconUrl:f.iconUrlFacet,childItemKeys:s.childItemsFacet,enabledForMultipleItems:f.enabledForMultipleItemsFacet,isEnabledFunc:f.isEnabledFunctionFacet,commandAdapter:o.commandAdapterFacet},t);if(r&&r.displayName){var u=r.displayName,a=r.openUrl,l=r.iconUrl,c=r.enabledForMultipleItems,h=r.isEnabledFunc,p=r.childItemKeys,d=r.commandAdapter;if(p&&p.itemKeys&&p.itemKeys.length>0){var v=[];p.itemKeys.forEach(function(n,r,s){var u=e.demandItem({subMenuDisplayName:i.displayNameFacet,openUrl:i.openUrlFacet,iconUrl:f.iconUrlFacet,enabledForMultipleItems:f.enabledForMultipleItemsFacet,isEnabledFunc:f.isEnabledFunctionFacet,commandAdapter:o.commandAdapterFacet},n);u&&u.subMenuDisplayName&&v.push(g({key:t+"-"+n,name:u&&u.subMenuDisplayName,url:u&&u.openUrl,iconUrl:u&&u.iconUrl,enabledForMultipleItems:u&&u.enabledForMultipleItems,isEnabledFunc:u&&u.isEnabledFunc,commandAdapter:u&&u.commandAdapter}))});n.push(b({key:t,name:u,subCommands:v}))}else u&&n.push(g({key:t,name:u,url:a,iconUrl:l,enabledForMultipleItems:c,isEnabledFunc:h,commandAdapter:d}))}});return n}t.getCustomActionSetCommands=w;function E(e){var t=e.keys,n=t.webAbsoluteUrl,r=t.listFullUrl,i=e.itemCache,f=e.targetCustomActionSetKey,l=void 0,c=u.spListKeyFacet.serialize({webAbsoluteUrl:n,listFullUrl:r}),h=i.demandItemFacet(o.isSpfxLoadedFacet,c),p=i.demandItemFacet(a.rawCustomActionsFacet,f),d=!!h&&!!p,m=v.getItemsScope(i).itemsScopeItemKey;if(d&&m){var g=u.customActionSetWithExtensionsKeyFacet.serialize({webAbsoluteUrl:n,listFullUrl:r,isSPFXandCustomActionsAvailable:d,targetCustomActionSetKey:f,itemsScopeItemKey:m});i.demandItemFacet(s.childItemsFacet,g)&&(l=g)}return l}t.demandCustomActionSetWithExtensions=E});
define("XT",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.editItemCommandKey=n.getNextId("EditItem")});
define("FT",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pinItemCommandKey=n.getNextId("pinItem");t.moveLeftPinnedItemCommandKey=n.getNextId("moveLeftPinnedItem");t.moveRightPinnedItemCommandKey=n.getNextId("moveRightPinnedItem");t.removePinnedItemCommandKey=n.getNextId("removePinnedItem");t.editPinnedItemCommandKey=n.getNextId("editPinnedItem")});
define("UT",["require","exports","r","RT","Pm","HT","FT"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pinItemCommand={key:o.pinItemCommandKey,automationId:"pinItemCommand",name:s.default.pinToTop,iconProps:{iconName:"Pin"},action:n.createElement(r.EditPinnedItemAction,{editType:0})};t.moveLeftPinnedItemCommand={key:o.moveLeftPinnedItemCommandKey,automationId:"moveLeftPinnedItemCommand",name:s.default.moveLeftPinnedItem,iconProps:{iconName:i.Locale.isRightToLeft?"Forward":"Back"},action:n.createElement(r.EditPinnedItemAction,{editType:2})};t.moveRightPinnedItemCommand={key:o.moveRightPinnedItemCommandKey,automationId:"moveRightPinnedItemCommand",name:s.default.moveRightPinnedItem,iconProps:{iconName:i.Locale.isRightToLeft?"Back":"Forward"},action:n.createElement(r.EditPinnedItemAction,{editType:3})};t.removePinnedItemCommand={key:o.removePinnedItemCommandKey,automationId:"removePinnedItemCommand",name:s.default.unpinFromTop,iconProps:{iconName:"UnPin"},action:n.createElement(r.EditPinnedItemAction,{editType:1})};t.editPinnedItemCommand={key:o.editPinnedItemCommandKey,automationId:"editPinnedItemCommand",name:s.default.editPin,iconProps:{iconName:"Pinned"},subMenuProps:{items:[t.moveLeftPinnedItemCommand,t.moveRightPinnedItemCommand,t.removePinnedItemCommand]}}});
define("fU",["require","exports","r","qi","t7","pU"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.exitQuickEditCommand={key:new r.Facet("exitQuickEdit").id,automationId:"exitQuickEditCommand",name:i.default.ExitGridView,action:n.createElement(s.ExitQuickEditAction,null),iconProps:{iconName:"ViewList"}};t.getExitQuickEditCommand=function(e){return t.exitQuickEditCommand}});
define("YT",["require","exports","r","t7","Zg","D0","bh","nU","AT","Z6","$T","ZT","a8","XT","JT"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.exportListCommand=f.exportListCommand;t.exportListCommandBrandIcon=f.exportListCommandBrandIcon;t.createListItemCommand=l.createListItemCommand;t.listNewCommands=c.listNewCommand;t.viewItemCommand={key:d.viewItemCommandKey,name:o.default.Open,action:n.createElement(u.OpenItemFormUrlAction,null)};t.editItemCommand={key:p.editItemCommandKey,name:r.default.Edit,action:n.createElement(a.EditItemAction,null),iconProps:{iconName:"Edit"}};t.getDefaultListCommands=function(e){return[c.listNewCommand,h.quickEditCommand,t.editItemCommand,s.shareCommand,s.copyLinkCommand,i.deleteCommand,f.exportListCommand]}});
define("ZT",["require","exports","T0","z0","$T"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.listNewCommand={key:n.newCommand.key,automationId:n.newCommand.automationId,name:n.newCommand.name,iconProps:n.newCommand.iconProps,subMenuProps:{items:[r.createFolderCommand,i.createListItemCommand]}}});
define("mU",["require","exports","ww","r","qi","t7","zM","Md","KM","bc","GM"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PublishCommandKey=new i.Facet("Publish").id;t.ScheduleCommandKey=new i.Facet("Schedule").id;var c=new Map([[l.PublishActionType.Publish,s.default.Publish],[l.PublishActionType.CancelApproval,s.default.CancelApproval],[l.PublishActionType.SubmitForApproval,s.default.SubmitForApproval],[l.PublishActionType.SchedulePublish,s.default.Schedule],[l.PublishActionType.Republish,s.default.Republish]]),h=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,i=e.itemKeys,o=n.__rest(e,["defaultRender","itemKeys"]),f=i[0];return r.createElement(u.WithItemCache,null,function(e){var i=e.itemCache,u=a.getPublishActionType(i,f),l=c.get(u)||s.default.Publish;return t?r.createElement(t,n.__assign({},o,{text:l})):null})};return t})(r.PureComponent);t.publishItemCommand={key:t.PublishCommandKey,automationId:"PublishCommand",iconProps:{iconName:"ReadingMode"},name:s.default.Publish,action:r.createElement(o.PublishItemAction,{publishType:0,source:"Command"}),commandBarButtonAs:f.withSelectedItems()(h)};t.scheduleItemCommand={key:t.ScheduleCommandKey,automationId:"ScheduleCommand",iconProps:{iconName:"DateTime2"},name:s.default.Schedule,action:r.createElement(o.PublishItemAction,{publishType:1,source:"Command"}),commandBarButtonAs:f.withSelectedItems()(h)}});
define("het",["require","exports","r","t7","get","bet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditRedoCommand={key:i.quickEditRedoCommandKey,automationId:"quickEditRedoCommand",name:r.default.quickEditRedo,iconProps:{iconName:"Redo"},action:n.createElement(s.QuickEditUndoRedoAction,{undoRedoActionType:"redo"})}});
define("get",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditRedoCommandKey=n.getNextId("quickEditRedo")});
define("vet",["require","exports","r","bet","t7","yet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditUndoCommand={key:s.quickEditUndoCommandKey,automationId:"quickEditUndoCommand",name:i.default.quickEditUndo,iconProps:{iconName:"Undo"},isPermanent:!0,action:n.createElement(r.QuickEditUndoRedoAction,{undoRedoActionType:"undo"})}});
define("yet",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditUndoCommandKey=n.getNextId("quickEditUndo")});
define("_U",["require","exports","ww","r","_p","Qi","Gi","Bc","M","b3","zi","ODBItemsScopeDeferred_mini_css","t7","we","Kg","p4","Dg","CU","xU","xg","DU","SU","vU","bU","hU","Mg","am","Q3","ys","tc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){"use strict";c=c.ViewCommands_5;Object.defineProperty(t,"__esModule",{value:!0});var O=[{ODB:1776},{ODB:60020}],M={ODB:1484},_={iconName:void 0,styles:{root:{display:"none!important"}}},D=f.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["NKe"],t,n)})];case 1:return[2,t.sent().CreateViewAction]}})})}),P={key:T.switchToFixedGridLayoutCommandKey,automationId:"switchToFixedGridLayoutCommand",name:h.default.fixedHeight,action:r.createElement(y.SwitchGridLayoutAction,{viewType:"GRIDFIXED"}),iconProps:{iconName:"ViewList"}},H={key:T.switchToDynamicGridLayoutCommandKey,automationId:"switchToDynamicGridLayoutCommand",name:h.default.dynamicHeight,action:r.createElement(y.SwitchGridLayoutAction,{viewType:"GRID"}),iconProps:{iconName:"DynamicList"}};t.getViewsCommands=function(e,t){var f,y,j=t.viewKeys,F=t.webAbsoluteUrl,I=t.listViewSetKey,q=t.itemSetKey,R=t.currentViewKey,U=s.spListKeyFacet.serialize({webAbsoluteUrl:I.webAbsoluteUrl,listFullUrl:I.listFullUrl}),z=v.isFeatureEnabled(e,{feature:M})&&O.some(function(t){return v.isFeatureEnabled(e,{feature:t})}),W=e.demandItemFacet(o.listFacet,U),X=!!W&&!!W.templateType&&l.isGenericList(W.templateType),V=!!W&&!!W.templateType&&W.templateType===l.default.webPageLibrary,$=!1,J=h.default.Views,K=e.demandItem({showViewModifiedIndicator:o.showViewModifiedIndicatorFacet,currentDerivedView:o.currentDerivedViewFacet,currentViewBasicInfo:o.viewBasicInfoFacet},R),Q=K.showViewModifiedIndicator,G=K.currentDerivedView,Y=K.currentViewBasicInfo;W&&G&&"POWER"!==G.viewType&&W.permissions&&G.canUserEdit(W.permissions)&&($=!0);G&&G.title?J=G.title:Y&&Y.Title&&(J=Y.Title);$&&(Q||G&&G.isDirty())&&(J=p.format(h.default.ViewModifiedIndicator,J));var Z=j.map(function(t){var n=e.demandItemFacet(o.serverViewFacet,t),r=e.demandItemFacet(o.viewBasicInfoFacet,t);return n&&!n.Hidden?B(n,F,q,G):r?B(r,F,q,G):void 0}).filter(function(e){return!!e}),ee=(function(e,t){var n=e.demandItemFacet(o.needsAttentionItemFacet,t);return!(!n||!e.demandItemFacet(u.missingMetadataFacet,n))})(e,q),te=(function(e,t){var i,o,u=t.isPagesLib,a=t.isList,f=t.itemsNeedAttention,l=t.currentDerivedView,p=t.itemSetKey,d=s.needsAttentionViewId;if(u&&v.isFeatureEnabled(e,{feature:{ODB:1743}})){i=h.default.PagesThatNeedAttention;o="PagesThatNeedAttention"}else{i=a?h.default.ItemsThatNeedAttention:h.default.FilesThatNeedAttention;o=a?"ItemsThatNeedAttention":"FilesThatNeedAttention"}return{key:T.needsAttentionCommandKey,automationId:"needsAttentionViewCommand",name:i,iconProps:f?{iconName:"error",styles:{root:c.needsAttentionIcon}}:_,action:r.createElement(E.SwitchViewAction,{viewId:d,currentDerivedView:l,itemSetKey:p}),facets:n.__assign({},N.isViewOnlyCommandFacet.pack(!0)),engagement:{name:o}}})(e,{isList:X,isPagesLib:V,itemsNeedAttention:ee,itemSetKey:q,currentDerivedView:G}),ne=(function(e,t,n){var r=s.spListKeyFacet.serialize({webAbsoluteUrl:t,listFullUrl:n}),i=e.demandItemFacet(o.contentTypeKeysFacet,r),u=[];i&&i.length&&i.forEach(function(t){var n=e.demandItemFacet(o.spListContentTypeFacet,t),r=n&&n.requiredFields&&n.requiredFields.split(",");r&&r.length>0&&(u=u.concat(r))});return u.length>0})(e,F,I.listFullUrl),re=X&&v.isFeatureEnabled(e,{feature:k.EnableNucleusListConflictsUX})&&!!e.demandItemFacet(o.spDataSyncClientFacet,L.configurationItemKey),ie=s.listSyncIssuesItemSetKeyFacet.serialize({webAbsoluteUrl:F,listFullUrl:I.listFullUrl}),se=re&&!!(null===(y=null===(f=e.demandItemFacet(A.childItemsFacet,ie))||void 0===f?void 0:f.itemKeys)||void 0===y?void 0:y.length),oe=se?{key:T.syncIssuesViewCommandKey,automationId:"itemsWithSyncIssuesViewCommand",name:"Items with Sync Issues",iconProps:se?{iconName:"error",styles:{root:c.needsAttentionIcon}}:_,action:ie?r.createElement(C.ItemOpenAction,{itemKey:ie}):void 0}:void 0,ue=G?(function(e){var t=e.isCreateNewViewEnabled,i=e.currentDerivedView,o=e.listViewSetKey,u=e.itemSetKey,a=e.allowEditCurrentView,f=s.spViewKeyFacet.serialize({viewId:i.id}),l=s.spListViewsSetKeyFacet.serialize(o),c=a||t&&"MODERNCALENDAR"===i.viewType;return n.__spreadArrays(t?[{key:T.createViewCommandKey,automationId:"createViewCommand",name:h.default.CreateNewView,iconProps:_,action:r.createElement(D,{listViewSetKey:l,currentViewKey:f,isEditing:!1})}]:[],[{key:T.saveViewCommandKey,automationId:"saveCommand",name:h.default.SaveViewAs,iconProps:_,action:r.createElement(S.SaveViewAction,{listViewSetKey:l,currentViewKey:f})},{key:T.setDefaultViewCommandKey,automationId:"setDefaultViewCommand",name:h.default.SetDefaultView,iconProps:_,action:r.createElement(x.SetDefaultViewAction,{currentDerivedView:i,listViewSetKey:o})}],c?[{key:T.customizeViewCommandKey,automationId:"customizeViewCommand",name:h.default.CustomizeView,iconProps:_,action:"MODERNCALENDAR"===i.viewType?r.createElement(D,{listViewSetKey:l,currentViewKey:f,isEditing:!0}):r.createElement(w.CustomizeViewActionn,{viewKey:f,itemSetKey:u})}]:[])})({listViewSetKey:I,isCreateNewViewEnabled:z,currentDerivedView:G,itemSetKey:q,allowEditCurrentView:$}):[],ae="MODERNCALENDAR"===e.demandItemFacet(o.viewTypeFacet,R)?[{key:T.calendarMonthCommandKey,isPermanent:!1,automationId:"calendarMonthCommand",name:h.default.calendarMonthTitle,title:h.default.calendarMonthDesc,action:r.createElement(m.SwitchLayoutAction,{layoutType:g.calendarMonthType}),iconProps:{iconName:"calendar"}}]:[],fe=[];if(d.switchLayoutCommand.subMenuProps){var le=e.demandItemFacet(o.viewFormatterFacet,R),ce=le&&le.viewFormatter,he=ce&&ce.isTileDesignerTemplateApplied(),pe=ce&&ce.getTileProps(),de=!!(pe&&pe.formatter&&pe.formatter);if(X&&(he||v.isFeatureEnabled(e,{feature:{ODB:1396}})&&!de))for(var ve=0,me=d.switchLayoutCommand.subMenuProps.items;ve<me.length;ve++){var ge=me[ve];ge.key!==b.tilesListCommandKey?fe.push(ge):fe.push(n.__assign(n.__assign({},ge),{name:h.default.GalleryLayout,title:h.default.GalleryLayoutCommandTooltip}))}else fe=d.switchLayoutCommand.subMenuProps.items}var ye=[];ne&&ye.push(te);se&&oe&&ye.push(oe);ye.length>0&&ye.push({name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider});var be=n.__spreadArrays(fe,ae,[{name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider}],ye,[P,H,{name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider}],Z,[{name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider}],ue,[{name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider}]),we={name:J,key:d.switchLayoutCommand.key,automationId:d.switchLayoutCommand.automationId,iconProps:d.switchLayoutCommand.iconProps,title:h.default.SwitchViewsCommandTitle,ariaLabel:p.format(h.default.SwitchViewsCommandAriaLabel,J),postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,r=t&&t.filter(function(e){return e.checked})[0];return n.__assign(n.__assign(n.__assign({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),r?{iconProps:n.__assign(n.__assign({},r.iconProps),ee||se?{styles:{root:c.needsAttentionIconOverlay}}:{})}:{})},subMenuProps:{items:be},facets:n.__assign({},N.isViewOnlyCommandFacet.pack(!0))},Ee=G?a.default.normalizeLower(G.id,!1):"";we.cacheKey=d.switchLayoutCommand.key+"_viewId_"+Ee;return we};function B(e,t,i,s){var o=a.default.normalizeLower(e.Id,!1);return{key:T.switchViewCommandBaseKey+"-"+o,automationId:"switchViewCommand_"+o,name:e.Title,iconProps:_,action:r.createElement(E.SwitchViewAction,{viewId:o,currentDerivedView:s,itemSetKey:i}),facets:n.__assign({},N.isViewOnlyCommandFacet.pack(!0))}}});
define("hU",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createViewCommandKey=n.getNextId("createView");t.switchViewCommandBaseKey=n.getNextId("switchView");t.needsAttentionCommandKey=n.getNextId("needsAttentionView");t.setDefaultViewCommandKey=n.getNextId("setDefaultView");t.customizeViewCommandKey=n.getNextId("customizeView");t.switchToFixedGridLayoutCommandKey=n.getNextId("switchToFixedGridLayoutCommand");t.switchToDynamicGridLayoutCommandKey=n.getNextId("switchToDynamicGridLayoutCommand");t.calendarMonthCommandKey=n.getNextId("calendarMonth");t.saveViewCommandKey=n.getNextId("saveView");t.syncIssuesViewCommandKey=n.getNextId("syncIssues")});
define("JT",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.viewItemCommandKey=n.getNextId("ViewItem")});
define("$F",["require","exports","r","qi","bc","Vs","Qi","Cy","wy","Wv"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i.withSelectedItems()(i.withExactlyOneItem()(u.PinSiteAction)),c=f.createItemCacheComponent(function(e,t){var r=s.getCurrentItemSetKey(e)||"";return e.demandItemFacet(o.spAllSitesKeyFacet,r)?n.createElement(l,{rootItemKey:r,pinOperationType:t.pinOperationType}):null});t.pinSiteCommand={key:new r.Facet("pinSiteCommand").id,automationId:"pinSiteCommand",name:a.default.PinLibrary,ariaLabel:a.default.PinLibrary,action:n.createElement(c,{pinOperationType:"pin"})};t.unpinSiteCommand={key:new r.Facet("unpinSiteCommand").id,automationId:"unpinSiteCommand",name:a.default.UnpinLibrary,ariaLabel:a.default.UnpinLibrary,action:n.createElement(c,{pinOperationType:"unpin"})}});
define("MH",["require","exports","ww","mN","rN","QR","PH"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t)});
define("PH",["require","exports","ww","r","Zm","_A","ou","ODBItemsScopeDeferred_mini_css","we","WR","NR","RR","Tc","LA","ER","wR","yS","TH","we"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";u=u.FilterPanel_7;Object.defineProperty(t,"__esModule",{value:!0});var b=g.BasePickerListBelow,w=f.default.ApplyFilterButtonAriaDescription,E=f.default.ApplyFilterButtonLabel,S=f.default.ClearAllButtonLabel,x=function(e){return a.format(f.default.ClearAllButtonAriaDescription,e)},T=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._onSelectedSuggestionOptionChange=function(e){i.setState(function(t){for(var r=-1,i=0;i<t.filterOptionSet.length;i++)if(t.filterOptionSet[i].value===e.value){r=i;break}return{filterOptionSet:-1===r?n.__spreadArrays(t.filterOptionSet,[e]):t.filterOptionSet,checkedFilterValues:-1===t.checkedFilterValues.indexOf(e.value)?n.__spreadArrays(t.checkedFilterValues,[e.value]):t.checkedFilterValues}})};i._onSelectedPersonasChange=function(e){var t=e&&e.length>0&&e[e.length-1];if(t){var n={display:t.name,value:t.name};i._onSelectedSuggestionOptionChange(n)}};i._onRenderNoResultFound=function(){return r.createElement("div",{className:u.filterPanelSuggestionsNone},y.format(f.default.NoResultFoundUsingContains,i._currentText))};i._onResolveSuggestions=function(e,t){i._currentText=e;var n=i.props.filterPickerProps;return n&&n.getFilterSuggestions?n.getFilterSuggestions(i.props.fieldInternalName,i.props.mappedColumnFieldType,e):[]};i._onSelectedSuggestionsChange=function(e){var t=e&&e.length>0&&e[e.length-1];if(t){var n={display:t.display,value:t.value};i._onSelectedSuggestionOptionChange(n)}};i._onCheckboxGroupChange=function(e,t,r){i.setState(function(e){var i=e.checkedFilterValues;if(r)i=n.__spreadArrays(i,[t.key]);else{var s=i.indexOf(t.key);s>-1&&(i=n.__spreadArrays(i.slice(0,s),i.slice(s+1)))}return{checkedFilterValues:i}})};i._onClearAllClick=function(){i.setState({checkedFilterValues:[]})};i._currentText="";i.state={filterOptionSet:t.filterOptionSet,checkedFilterValues:t.checkedFilterValues};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.isLoading&&!e.isLoading&&this.setState({filterOptionSet:e.filterOptionSet,checkedFilterValues:e.checkedFilterValues})};t.prototype.render=function(){var e=this,t=this.props,d=t.columnName,v=t.onClose,g=t.mappedColumnFieldType,b=(t.fieldInternalName,t.isLoading),T=t.applyFiltersAction,N=this.state,C=N.checkedFilterValues,k=N.filterOptionSet,L=k?(function(e,t,n){var r=[];e&&e.length&&(r=e.map(function(e){var n={key:e.value,label:e.display};t===m.ColumnFieldType.User?n.renderType=c.CheckboxGroupOptionRenderType.user:t===m.ColumnFieldType.FileIcon&&(n.renderType=c.CheckboxGroupOptionRenderType.fileType);return n}));return r})(k,g):void 0,A=(function(e){return a.format(f.default.FilterSelectPanelTitle,e)})(d),O=C.length?y.format(f.default.SectionTitleWithNumber,A,C.length):A,M=a.format(a.getLocalizedCountValue(f.default.CheckedFiltersCountAlert,f.default.CheckedFiltersCountIntervals,C.length)||"",C.length);return r.createElement(p.KeyboardZone,null,r.createElement(s.Panel,{"data-automationid":"FilterPanel",className:u.filterPanelRoot,isOpen:!0,type:s.PanelType.smallFixedFar,headerText:O,onDismiss:v,closeButtonAriaLabel:f.default.closeButtonAriaLabel,onRenderFooterContent:b?void 0:function(){return r.createElement("div",{className:u.filterPanelFooter},r.createElement(h.WithAction,{action:T({filterOptionSet:k,checkedFilterKeys:C})},function(t){var s=t.isAvailable,o=t.execute;return r.createElement(i.PrimaryButton,{"data-automationid":"FilterPanel-Apply",onClick:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);return[4,o({})];case 1:e.sent();this.props.onComplete();return[3,3];case 2:e.sent();return[3,3];case 3:return[2]}})})},disabled:!s,ariaDescription:w,text:E})}),r.createElement(i.DefaultButton,{className:u.filterPanelClearAllButton,"data-automationid":"FilterPanel-ClearAll",onClick:e._onClearAllClick,ariaDescription:x(d),text:S}))}},b?r.createElement(o.Spinner,null):r.createElement(r.Fragment,null,this._renderFilterPicker(A),r.createElement("div",{role:"alert",className:u.alert},M),r.createElement(l.CheckboxGroup,{ariaLabel:A,options:L,checkedKeys:C,onChange:this._onCheckboxGroupChange}))))};t.prototype._onRenderItem=function(){return null};t.prototype._getTextFromItem=function(e){return e.display};t.prototype._onRenderSuggestionsItem=function(e){return r.createElement("div",{className:u.filterPanelSuggestionItem},e.display)};t.prototype._renderFilterPicker=function(e){var t=this.props,n=t.mappedColumnFieldType,i=t.filterPickerProps;return n===m.ColumnFieldType.User&&i&&i.peoplePickerDataSource?r.createElement(d.PeoplePicker,{className:u.peoplePickerRoot,context:i.pageContextForPicker,peoplePickerType:v.PeoplePickerType.listBelow,dataSource:i.peoplePickerDataSource,onRenderItem:this._onRenderItem,onSelectedPersonasChange:this._onSelectedPersonasChange,inputProps:{placeholder:f.default.PeoplePickerPlaceholder,"aria-label":e},noResultsFoundText:f.default.NoResults}):n===m.ColumnFieldType.Text||n===m.ColumnFieldType.Title?r.createElement(b,{className:u.filterPickerRoot,onResolveSuggestions:this._onResolveSuggestions,getTextFromItem:this._getTextFromItem,onRenderItem:this._onRenderItem,onRenderSuggestionsItem:this._onRenderSuggestionsItem,pickerSuggestionsProps:{onRenderNoResultFound:this._onRenderNoResultFound},inputProps:{placeholder:f.default.FilterPickerPlaceholder,"aria-label":e},onChange:this._onSelectedSuggestionsChange}):null};return t})(r.PureComponent);t.FilterPanel=T});
define("LH",["require","exports","ww","r","Nd","HA","ou","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u){"use strict";u=u.IFrameDialog_9;Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,a=t.url,f=(t.heightOffset,n.__rest(t,["url","heightOffset"])),l=this.state.isIFrameLoaded;return r.createElement(s.Dialog,n.__assign({className:u.IFrameDialog,hidden:!this.state.isOpen,type:s.DialogType.close},f),r.createElement(i.FocusZone,null,!l&&r.createElement(o.Spinner,{size:o.SpinnerSize.large}),r.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:a,style:{display:l?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(r.Component);t.IFrameDialog=a});
define("rN",["require","exports","ww","r","ou","HA","oL","Zm","JR","cN","sN","ODBItemsScopeDeferred_mini_css","dS","we"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";c=c.ApproveRejectDialog_9;Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._textField=r.createRef();i._onChoiceGroupRef=function(e){e&&e.focus()};i._choiceGroupOnChange=function(e,t){i.setState({status:t?t.statusType:void 0})};i._onClickAction=function(){return n.__awaiter(i,void 0,void 0,function(){var e,t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:e=this.state.status;t=this._textField.current?this._textField.current.value:void 0;if(void 0===e)return[2];this.setState({showSpinner:!0});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,this.props.onContinue({status:e,comment:t})];case 2:n.sent();return[3,5];case 3:r=n.sent();i=r;this._isDisposed||this.setState({errorMessage:i&&i.message});return[3,5];case 4:this._isDisposed||this.setState({showSpinner:!1});return[7];case 5:return[2]}})})};i._options=(function(e){var t=e.hideApproveRejectOptions,n=e.showDraftOption,r=e.itemCount,i=[],s=r&&r>1;if(!t){i.push({key:h.ModerationStatusType[h.ModerationStatusType.approved],text:s?l.default.approve_approved_mult:l.default.approve_approved,statusLabel:l.default.approve_approved_label,statusType:h.ModerationStatusType.approved,"data-is-focusable":!0,onRenderLabel:v});i.push({key:h.ModerationStatusType[h.ModerationStatusType.denied],text:s?l.default.approve_rejected_mult:l.default.approve_rejected,statusLabel:l.default.approve_rejected_label,statusType:h.ModerationStatusType.denied,"data-is-focusable":!0,onRenderLabel:v})}n&&i.push({key:h.ModerationStatusType[h.ModerationStatusType.draft],text:s?l.default.approve_draft_mult:l.default.approve_draft,statusLabel:l.default.approve_draft_label,statusType:h.ModerationStatusType.draft,"data-is-focusable":!0,onRenderLabel:v});i.push({key:h.ModerationStatusType[h.ModerationStatusType.pending],text:s?l.default.approve_pending_mult:l.default.approve_pending,statusLabel:l.default.approve_pending_label,statusType:h.ModerationStatusType.pending,"data-is-focusable":!0,onRenderLabel:v});return i})(t);void 0!==t.initialStatus&&(i._defaultSelectedKey=h.ModerationStatusType[t.initialStatus]);i.state={errorMessage:"",showSpinner:!1,status:t.initialStatus};return i}t.prototype.componentWillUnmount=function(){this._isDisposed=!0};t.prototype.render=function(){var e=this.props,t=e.onCancel,n=e.initialComment,h=e.itemCount,p=this.state,d=p.errorMessage,v=p.showSpinner,m=p.status,g=h&&h>1,y=this._getDialogMessage();return r.createElement(s.Dialog,{maxWidth:450,hidden:!1,dialogContentProps:{title:this._getDialogTitle()},onDismiss:t},y&&r.createElement(f.MessageBar,{className:c.approveRejectDialogMessageBar}," ",y),r.createElement(a.ChoiceGroup,{componentRef:this._onChoiceGroupRef,label:l.default.ApproveRejectChoiceGroupLabel,options:this._options,onChange:this._choiceGroupOnChange,defaultSelectedKey:this._defaultSelectedKey}),r.createElement(o.TextField,{className:c.commentRoot,label:l.default.CommentLabel,ariaLabel:g?l.default.approve_commentsdesc_mult:l.default.approve_commentsdesc,componentRef:this._textField,defaultValue:n,rows:5,placeholder:g?l.default.approve_commentsdesc_mult:l.default.approve_commentsdesc,multiline:!0}),r.createElement(s.DialogFooter,null,r.createElement(u.PrimaryButton,{disabled:void 0===m||!!d||v,onClick:this._onClickAction},l.default.ContinueButtonText),r.createElement(u.DefaultButton,{onClick:t},l.default.CancelButtonText),v&&r.createElement(i.Spinner,{size:i.SpinnerSize.medium,className:c.approveRejectDialogSpinner})))};t.prototype._getDialogTitle=function(){var e=this.props,t=e.itemName,n=e.itemCount;return n&&n>1?p.format(l.default.ApproveRejectDialogTitle_mult,n):p.format(l.default.ApproveRejectDialogTitle,t)};t.prototype._getDialogMessage=function(){var e=this.props,t=e.initialStatus,n=e.initialStatusMapForBulkEdit,r=e.itemCount,i="";if(r&&r>1&&void 0===t&&n)for(var s=0,o=Object.keys(n);s<o.length;s++){var u=o[s],a=n[u];if(a>0){i&&(i+=", ");var f=p.getLocalizedCountValue(l.default.ApproveRejectDialogStatusMessage,l.default.ApproveRejectDialogStatusMessageIntervals,a);f&&(i+=p.format(f,a,u))}}return i};return t})(r.PureComponent);t.ApproveRejectDialog=d;function v(e){var t=e;return e?r.createElement("span",{id:e.labelId,className:"ms-ChoiceFieldLabel"},r.createElement("span",{className:c.approveRejectDialogStatusLabel},t.statusLabel)," - ",e.text):null}});
define("QR",["require","exports","ww","r","ou","HA","oL","Zm","JR","YR","we","dS"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._textField=r.createRef();i._choiceGroupRef=r.createRef();i._onClickAction=function(){return n.__awaiter(i,void 0,void 0,function(){var e,t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:e=this._textField.current?this._textField.current.value:void 0;t=this._choiceGroupRef&&this._choiceGroupRef.current&&this._choiceGroupRef.current.checkedOption?this._choiceGroupRef.current.checkedOption.checkInVersionType:void 0;this.setState({showSpinner:!0});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,this.props.onContinue({checkInVersionType:t,comment:e})];case 2:n.sent();return[3,5];case 3:r=n.sent();i=r;this._isDisposed||this.setState({errorMessage:i&&i.message});return[3,5];case 4:this._isDisposed||this.setState({showSpinner:!1});return[7];case 5:return[2]}})})};i.state={errorMessage:"",showSpinner:!1};i._options=(function(e,t){var n="",r="",i="";if(t){r=t.major+1+".0";n=0!==t.minor?t.major+"."+t.minor:t.major+".1";i=t.major+"."+(t.minor-1)}var s=[{key:f.default.MinorVersionLabel,text:t?l.format(f.default.MinorVersionLabelWithVersion,n):f.default.MinorVersionLabel,checkInVersionType:0,"data-is-focusable":!0},{key:f.default.MajorVersionLabel,text:t?l.format(f.default.MajorVersionLabelWithVersion,r):f.default.MajorVersionLabel,checkInVersionType:1,"data-is-focusable":!0}];1===e&&t&&t.minor>1&&t.moderationStatusType!==c.ModerationStatusType.approved&&s.push({key:f.default.OverwriteVersionLabel,text:t?l.format(f.default.OverwriteVersionLabelWithVersion,i):f.default.OverwriteVersionLabel,checkInVersionType:2,"data-is-focusable":!0});return s})(t.itemCount,t.itemInfo);return i}t.prototype.componentWillUnmount=function(){this._isDisposed=!0};t.prototype.render=function(){var e=this.props,t=e.onCancel,n=e.enableMinorVersions,l=this.state,c=l.errorMessage,h=l.showSpinner;return r.createElement(s.Dialog,{minWidth:450,maxWidth:450,hidden:!1,dialogContentProps:{title:this._getDialogTitle()},onDismiss:t},n&&r.createElement(a.ChoiceGroup,{componentRef:this._choiceGroupRef,label:f.default.VersionLabel,options:this._options,defaultSelectedKey:f.default.MinorVersionLabel}),r.createElement(o.TextField,{styles:n?{root:{marginTop:20}}:{},label:f.default.CommentLabel,componentRef:this._textField,rows:5,placeholder:f.default.CheckinCommentPlaceHolder,multiline:!0}),r.createElement(s.DialogFooter,null,r.createElement(u.PrimaryButton,{disabled:!!c||h,onClick:this._onClickAction,text:f.default.CheckIn}),h&&r.createElement(i.Spinner,{size:i.SpinnerSize.medium})))};t.prototype._getDialogTitle=function(){var e=this.props,t=e.itemInfo,n=e.itemCount;return n&&n>1?l.format(f.default.CheckInDialogTitle_mult,n):l.format(f.default.CheckInDialogTitle,t&&t.displayName||"")};return t})(r.PureComponent);t.CheckInDialog=h});
define("MWe",["require","exports","ww","r","Vc","Wv","tc","Es","Gi","HWe","Qi","Zr","W3","II","Yj","p4","xI","l7","Gc","Ac","eH","Vh","ga","QM","th","ou","k","A5","Kh","L5","IS","F8","yo","c3","AWe","Zv","Gp","b3","Lk","B9e","cc","bv","K","tC","$s","FWe","UWe","TWe","PWe","Q3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var Q=new B.PlatformDetection,G=j.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../actions/launchColumnManagementPanel/LaunchColumnManagementPanelExecutor"],t,n)})];case 1:return[2,t.sent().LaunchColumnManagementPanelAction]}})})}),Y=n.__assign(n.__assign({},L.default),A.default),Z={ODB:1261},ee={ODB:1746},te={ODB:1725},ne={ODB:1439},re={ODB:1806},ie={ODB:1507},se={ODB:1892},oe={ODB:1947},ue={ODB:1948},ae={ODB:1170},fe={ODB:1310},le={ODB:1757},ce=E.asAutoAction()(w.LaunchFilterPanelAction),he=E.asAutoAction()(w.SortAction),pe=E.asAutoAction()(G),de={ODB:1553},ve={ODB:420},me={ODB:1024},ge={ODB:1300},ye={ODB:1206},be={ODB:60017},we={ODB:1198},Ee={ODB:1672},Se={ODB:1722},xe={ODB:1740},Te={ODB:1918},Ne={ODB:1843},Ce={ODB:60053},ke=C.Killswitch.isActivated("69C410FF-8191-4047-AB22-9C64BCA7F076","07/02/2020","ensure Sort or Filter get correct schema"),Le=C.Killswitch.isActivated("8559E6CC-ECD4-46B1-8036-5674441D68C2","8/20/2020","Refresh the whole EQ when we update the schema of a specific column"),Ae=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._refreshChangedItemsInCache=function(e){var t=n.props.refreshItemsById,r=Object.keys(n._itemIdsToRefresh);return t&&r.length?t({itemIds:r,shouldInvalidateDataForLayout:e}).then(function(){n._itemIdsToRefresh={}}):Promise.resolve()};n._onItemCreatedFromClientForm=function(e){return n._onItemCreatedOrUpdatedFromClientForm(I.ClientFormEvents.newItemCreated,e.args)};n._onItemUpdatedFromClientForm=function(e){return n._onItemCreatedOrUpdatedFromClientForm(I.ClientFormEvents.itemUpdated,e.args)};n._onItemCreatedOrUpdatedFromClientForm=function(e,t){var r=n.props,i=r.telemetry,s=r.refreshItemsById;if(s&&t&&t.itemIds){s({itemIds:t.itemIds,shouldReturnRefreshedRows:!0}).then(function(e){e&&e.length&&n.setState({refreshedRows:e})});i&&i(R.default).logData({name:e+"QuickEdit",isIntentional:!0,extraData:{isBulkEdit:t.itemIds.length>1}})}};n._onSelectionChanged=function(e){var t=n.props.onSelectionChanged;e&&e.length&&n._refreshChangedItemsInCache();t&&t(e)};n.onColumnChangeSucceeded=function(){n._isSchemaChanged=!0};n.onPaging=function(e){n._refreshChangedItemsInCache();if(n.props.onPaging){n.props.onPaging(e);n.setState({currentFirstRow:e.isBackward?e.firstRowInGrid-n.props.rowLimit:e.lastRowInGrid+1})}};n.onLaunchFilterPanel=function(e){var t=n.props.setKey;e&&t&&n.setState({filterPanel:{columnKey:c.spListFieldKeyFacet.serialize({listKey:t,internalName:e})}})};n.onFormatColumn=function(e){e&&n.setState({formatColumnProps:{internalName:e}})};n.onFormatColumnComplete=function(){n.setState({formatColumnProps:void 0})};n.onEditColumns=function(){n.setState({editColumns:!0})};n.onEditColumnsComplete=function(){n.setState({editColumns:!1})};n.onPinToFiltersPane=function(e,t){n.setState({pinToFiltersPaneProps:{column:e,showInFiltersPane:t}})};n.onPinToFiltersPaneComplete=function(){n.setState({pinToFiltersPaneProps:void 0})};n.onSort=function(e,t){e&&n.setState({sortActionProps:{itemSetKey:n.props.itemKey,isAscending:t,sortFieldKey:e}})};n.onSortActionComplete=function(){n.setState({sortActionProps:void 0})};n.closeFilterPanel=function(){n.setState({filterPanel:void 0})};n.onLaunchColumnManagementPanel=function(e,t){t&&(n._columnManagementPanelActionOnComplete=t);n.setState({columnPanelProps:{createField:e.createField,editField:e.editField,isHyperlink:e.isHyperlink,isQuickEdit:!0}})};n.onColumnManagementPanelActionComplete=function(){var e;if(n._columnManagementPanelActionOnComplete){n._columnManagementPanelActionOnComplete();n._columnManagementPanelActionOnComplete=void 0}n._isSchemaChanged=!0;if(!Le&&(null===(e=n.state.columnPanelProps)||void 0===e?void 0:e.editField)){n._columnEditCounter++;n.props.invalidateSchema&&n.props.invalidateSchema()}n.setState({columnPanelProps:void 0})};n.closeColumnManagementPanel=function(){n.setState({columnPanelProps:void 0})};P.addRumOneMarker("quickEdit.pltafterlayoutswitch.start");n.state={filterPanel:void 0,itemKey:t.itemKey};n._events=new S.EventGroup(n);n._itemIdsToRefresh={};n._isSchemaChanged=!1;n._columnEditCounter=0;return n}t.getDerivedStateFromProps=function(e,t){return t.itemKey&&t.itemKey!==e.itemKey?{itemKey:e.itemKey,currentFirstRow:void 0,isLoading:!0}:null};t.prototype.componentDidMount=function(){var e=this;this._events.on(document,"quickEditWriteChangesToList",function(t){if(t&&t.itemIds)for(var n=0,r=t.itemIds;n<r.length;n++){var i=r[n];e._itemIdsToRefresh[i]=!0}});this._events.on(window,I.ClientFormEvents.itemUpdated,this._onItemUpdatedFromClientForm);this._events.on(window,I.ClientFormEvents.newItemCreated,this._onItemCreatedFromClientForm)};t.prototype.componentWillUnmount=function(){this._isSchemaChanged&&this.props.invalidateSchema&&this.props.invalidateSchema();this._events.dispose()};t.prototype.componentDidUpdate=function(e){var t=this;if(!ke&&(this.state.sortActionProps||this.state.filterPanel)&&this._isSchemaChanged&&this.props.invalidateSchema){this.props.invalidateSchema();this._isSchemaChanged=!1}this.state.isLoading&&this._refreshChangedItemsInCache(!0).then(function(){t.setState({isLoading:!1})})};t.prototype.render=function(){var e,t,i,s=this.props,o=s.itemResponseJsonString,u=s.getAuthToken,a=s.pageContext,l=s.gridInitInfo,c=s.completeExitingQuickEditSignal,h=s.customFormatterProps,p=s.additionalColumnSchema,d=s.telemetry,v=s.baseEngagementData,m=s.itemKey,g=s.rows,y=s.isDataReadyForLayout,b=s.rowLimit,w=s.hasNextPage,S=s.flightStatus,x=s.getEventSource,T=s.gridLayoutType,C=s.selectedItemIds,k=s.portalManager,L=s.launchColumnCustomization,A=s.launchColumnsEditorPanel,M=s.pinToFiltersPane,_=this.state,D=_.filterPanel,P=_.isLoading,H=_.sortActionProps,B=_.columnPanelProps,j=_.currentFirstRow,F=_.refreshedRows,I=_.formatColumnProps,q=_.editColumns,R=_.pinToFiltersPaneProps,U=!!P||!y||j&&g.length<j,z=g,W=g.length;if(!U&&a&&l&&void 0!==j){W=Math.min(j-1+b,W);z=g.slice(j-1,W)}L&&(e=E.asAutoAction()(L));A&&(t=E.asAutoAction()(A));M&&(i=E.asAutoAction()(M));return r.createElement("div",{className:"quickEditParentDiv"},U&&r.createElement(N.Spinner,{size:N.SpinnerSize.large}),!U&&a&&l&&r.createElement(f.default,{key:m+(j||1)+this._columnEditCounter,itemResponseJsonString:o,rows:z,firstRowInGrid:j||1,hasNextPage:w||W<g.length,onPaging:this.onPaging,getAuthToken:u,pageContext:a,gridInitInfo:l,completeExitingQuickEditSignal:c,customFormatterProps:h,additionalColumnSchema:p,telemetry:d,baseEngagementData:v,onLaunchFilterPanel:this.onLaunchFilterPanel,onSort:this.onSort,onLaunchColumnManagementPanel:this.onLaunchColumnManagementPanel,getColumnWidthsFromLocalStorage:O.getColumnWidthsFromLocalStorage,setColumnWidthsToLocalStorage:O.setColumnWidthsToLocalStorage,flightStatus:S,onColumnChangeSucceeded:this.onColumnChangeSucceeded,onSelectionChanged:this._onSelectionChanged,getEventSource:x,refreshedRows:F,gridLayoutType:T,selectedItemIds:C,portalManager:k,launchColumnCustomization:this.onFormatColumn,launchColumnsEditor:this.onEditColumns,onPinToFiltersPane:this.onPinToFiltersPane}),!U&&D&&D.columnKey&&r.createElement(ce,{columnKey:D.columnKey,itemSetKey:this.props.itemKey,onComplete:this.closeFilterPanel,onError:this.closeFilterPanel}),!!H&&H.sortFieldKey&&r.createElement(he,n.__assign({},H,{onComplete:this.onSortActionComplete})),!!B&&r.createElement(pe,{itemSetKey:this.props.itemKey,columnManagementPanelExecutorProps:B,onComplete:this.onColumnManagementPanelActionComplete,onError:this.closeColumnManagementPanel}),!!I&&e&&r.createElement(e,{internalName:I.internalName,onComplete:this.onFormatColumnComplete}),!!q&&t&&r.createElement(t,{onComplete:this.onEditColumnsComplete}),!!R&&i&&r.createElement(i,{column:R.column,showInFiltersPane:R.showInFiltersPane,onComplete:this.onPinToFiltersPaneComplete}))};return t})(r.PureComponent);var Oe=y.withTelemetry()(i.withLayoutRenderComplete()(function(e){var t=X.usePortalManager(),i=t[0],s=t[1];return r.createElement(r.Fragment,null,s,r.createElement(Ae,n.__assign({portalManager:i},e)))}));t.ItemSetQuickEditList=s.connectToItemCache(function(e,t){var r=t.itemKey,i=e.dispatch,s=30,f=void 0,c=e.isItemFacetResolved(a.getItemResponseJsonStringFacet,t.itemKey)||e.isItemFacetResolved(u.errorFacet,t.itemKey),y=function(e){return i(h.getAuthToken({url:e}))},w=e.demandItem({setKey:l.spFolderItemSetKeyFacet,itemResponseJsonString:a.getItemResponseJsonStringFacet},r),E=w.setKey,S=w.itemResponseJsonString,x=e.demandItemFacet(a.viewFormatterFacet,M.getViewKeyFromItemSetKey(e,{itemSetKey:r}));if(!E||!S)return{itemResponseJsonString:S||"",rows:[],gridInitInfo:void 0,pageContext:void 0,getAuthToken:y,isDataReadyForLayout:!1,rowLimit:s};var N=[];if(S){var C=e.demandItemFacet(o.childItemsFacet,r);if(C&&C.itemKeys)for(var L=0,A=C.itemKeys;L<A.length;L++){var O=A[L];if(e.isItemFacetResolved(o.pageFacet,O))f=O;else{if(!e.isItemFacetResolved(a.rowDataFacet,O)){N=[];c=!1;break}var P=e.demandItemFacet(a.rowDataFacet,O);P&&N.push(n.__assign({},P))}}}var B=e.demandItemFacet(a.spPageContextFacet,l.spPageContextKeyFacet.serialize(E)),j=l.spGridInitInfoKeyFacet.serialize({listKey:{webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl},viewKey:E.viewKey});ke||(c=c&&e.isItemFacetResolved(a.gridInitInfoFacet,j));var I=e.demandItem({gridInitInfo:a.gridInitInfoFacet,completeExitingQuickEditSignal:a.completeExitingQuickEditSignalFacet},j),q=I.gridInitInfo,R=I.completeExitingQuickEditSignal,z=[],X=W.getSelectedItemKeys(e);if(X&&X.length)for(var G=0,ce=X;G<ce.length;G++){var he=ce[G],pe=e.demandItemFacet(a.listItemIdFacet,he);pe&&z.push(pe)}for(var Le=p.getCustomFormatterSchemaFromItemCache({itemCache:e,itemSetKey:r}),Ae=v.isFeatureEnabled(e,{feature:Z,pageContext:B}),Oe=[],De=0,Pe=m.readItemSetSchemaFromItemCache(e,{mapping:{internalName:a.internalNameFacet,isFilterable:g.isFilterableFacet,customFormatter:a.customFormatterFacet,isSortable:g.isSortableFacet,mappedColumnFieldType:a.mappedColumnFieldTypeFacet,fieldType:a.fieldFieldTypeFacet,isEditable:g.isEditableFacet,isCalculated:a.isCalculatedFacet},itemSetKey:r});De<Pe.length;De++){var He=Pe[De];if(He.internalName){var Be={internalName:He.internalName,filterable:!!He.isFilterable,customFormatter:He.customFormatter,fieldType:He.fieldType,isEditable:He.isEditable,isCalculated:He.isCalculated};if(He.isSortable){var je=k.getSortMenuStrings({fieldType:He.mappedColumnFieldType,internalName:He.internalName},Y),Fe=je.ascendingString,Ie=je.descendingString;Be.ascendingString=Fe;Be.descendingString=Ie}Oe.push(Be)}}var qe,Re=void 0;if(E.viewKey){var Ue=l.spViewKeyFacet.serialize(E.viewKey),ze=e.isItemFacetResolved(a.serverViewFacet,Ue)?e.demandItemFacet(a.serverViewFacet,Ue):void 0;ze&&ze.RowLimit&&(s=ze.RowLimit);qe=e.demandItemFacet(a.viewTypeFacet,Ue);var We=H.getConfiguration(e,{expandedPageRowLimitNumber:a.spItemPageExpandedRowLimitConfigurationFacet}).expandedPageRowLimitNumber;if(We&&(!s||s<We)){s=We;if(f){var Xe=e.demandItemFacet(l.spItemPageKeyFacet,f),Ve=Xe&&Xe.token;if(Ve){var $e=Ve&&U.deserializeQuery(Ve.toLowerCase()),Je=$e&&$e.pagefirstrow;if(Number(Je)-1<s){c=!1;Me(f,i)}}}}Re=function(){var e,t=E&&l.spListKeyFacet.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl});return i(T.invalidateItems({items:(e={},e[Ue]=[a.serverViewFacet,a.currentDerivedViewFacet],e[j]=[a.gridInitInfoFacet],e[t]=[a.contentTypeKeysFacet],e[r]=[o.childItemsFacet],e)}))}}var Ke={};Ke[ee.ODB]=v.isFeatureEnabled(e,{feature:ee,pageContext:B});Ke[ne.ODB]=v.isFeatureEnabled(e,{feature:ne,pageContext:B});Ke[te.ODB]=v.isFeatureEnabled(e,{feature:te,pageContext:B})&&!Q.isIE;Ke[re.ODB]=v.isFeatureEnabled(e,{feature:re,pageContext:B});Ke[ie.ODB]=v.isFeatureEnabled(e,{feature:ie,pageContext:B});Ke[se.ODB]=v.isFeatureEnabled(e,{feature:se,pageContext:B});Ke[oe.ODB]=v.isFeatureEnabled(e,{feature:oe,pageContext:B});Ke[ue.ODB]=v.isFeatureEnabled(e,{feature:ue,pageContext:B});Ke[ae.ODB]=v.isFeatureEnabled(e,{feature:ae,pageContext:B});Ke[fe.ODB]=v.isFeatureEnabled(e,{feature:fe,pageContext:B});Ke[le.ODB]=v.isFeatureEnabled(e,{feature:le,pageContext:B});Ke[de.ODB]=v.isFeatureEnabled(e,{feature:de,pageContext:B});Ke[ve.ODB]=v.isFeatureEnabled(e,{feature:ve,pageContext:B});Ke[me.ODB]=v.isFeatureEnabled(e,{feature:me,pageContext:B});Ke[ge.ODB]=v.isFeatureEnabled(e,{feature:ge,pageContext:B});Ke[ye.ODB]=v.isFeatureEnabled(e,{feature:ye,pageContext:B});Ke[be.ODB]=v.isFeatureEnabled(e,{feature:be,pageContext:B})&&Ke[te.ODB];Ke[we.ODB]=v.isFeatureEnabled(e,{feature:we,pageContext:B});Ke[Ee.ODB]=v.isFeatureEnabled(e,{feature:Ee,pageContext:B});Ke[Se.ODB]=v.isFeatureEnabled(e,{feature:Se,pageContext:B});Ke[xe.ODB]=v.isFeatureEnabled(e,{feature:xe,pageContext:B});Ke[Te.ODB]=v.isFeatureEnabled(e,{feature:Te,pageContext:B});Ke[K.NucleusPreviewEnabled.ODB]=v.isFeatureEnabled(e,{feature:K.NucleusPreviewEnabled,pageContext:B});Ke[Ne.ODB]=v.isFeatureEnabled(e,{feature:Ne,pageContext:B});Ke[Ce.ODB]=v.isFeatureEnabled(e,{feature:Ce,pageContext:B});var Qe=void 0;x&&x.viewFormatter&&!x.viewFormatter.getRowFormatter()&&(Qe=x.viewFormatter.getAdditionalRowClass());var Ge,Ye=b.getItemEngagement(e,{itemKey:l.spItemKeyFacet.serialize(E),engagement:{isIntentional:!0}}),Ze=D.getItemsScope(e).itemsScopeItemKey,et=e.demandItemFacet(V.launchColumnCustomizationControl,r),tt=V.launchColumnCustomizationControl.evaluate(et)(e,{itemKey:r}).action,nt=e.demandItemFacet($.launchColumnsEditorPanelActionControl,r),rt=$.launchColumnsEditorPanelActionControl.evaluate(nt)(e,{itemKey:r}).onClickAction,it=e.demandItemFacet(J.pinToFiltersPaneActionControl,r),st=J.pinToFiltersPaneActionControl.evaluate(it)(e,{itemKey:r}).onClickAction;Ze&&(Ge=function(e){if(e){for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n],o={webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl,itemId:s},u=l.spItemKeyFacet.serialize(o);t.push(u)}i(_.selectItems({itemsScopeItemKey:Ze,selectedItemKeys:t,currentSelectionKey:void 0}))}});Ye.objectType=void 0;return{itemResponseJsonString:S||"",rows:N,gridInitInfo:q,pageContext:B,getAuthToken:y,isDataReadyForLayout:c,completeExitingQuickEditSignal:R,customFormatterProps:{customFormatterSchema:Le,getItemData:function(e,t){return d.getItemData(e,t,Ae)},additionalRowClass:Qe},additionalColumnSchema:Oe,baseEngagementData:Ye,refreshItemsById:function(e){return _e(i,r,E.webAbsoluteUrl,E.listFullUrl,e)},invalidateSchema:Re,onPaging:function(e){var t,n=e.lastRowInGrid;!e.isBackward&&f&&N&&n+s>N.length&&(t=f);t&&Me(t,i)},rowLimit:s,hasNextPage:!!f,flightStatus:Ke,onSelectionChanged:Ge,getEventSource:function(){return i(F.getSharePointDataEventSource)},gridLayoutType:qe,selectedItemIds:z,setKey:E,launchColumnCustomization:tt,launchColumnsEditorPanel:rt,pinToFiltersPane:st}})(Oe);var Me=function(e,t){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(z.demandItems(function(t){t.demandItemFacet(o.childItemsFacet,e)}))];case 1:n.sent();return[2]}})})},_e=function(e,t,r,i,s){var o,u=s.itemIds,f=s.shouldInvalidateDataForLayout,c=s.shouldReturnRefreshedRows;if(!u||!u.length)return Promise.resolve([]);for(var h={},p={},d=0,v=u;d<v.length;d++){var m=v[d],g=l.spItemKeyFacet.serialize({webAbsoluteUrl:r,listFullUrl:i,itemId:m});h[g]={};p[g]=[a.rowDataFacet]}f&&e(T.invalidateItems({items:p}));return e(x.refreshItemsInSet({items:(o={},o[t]=h,o)})).then(function(){if(!c)return[];for(var t=[],r=function(r){var i=e(q.readItems(function(e){return e.demandItemFacet(a.rowDataFacet,r)}));i&&i.ID&&t.push(n.__assign({},i))},i=0,s=Object.keys(h);i<s.length;i++){r(s[i])}return t})}});
define("kWe",["require","exports","ww","b3","bc","Lo","Wv","d9","r8"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=r.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["MWe"],t,n)})];case 1:return[2,t.sent().ItemSetQuickEditList]}})})}),l=s.asLayout(u.quickEditLayoutType)(f);t.QuickEditLayout=i.withCurrentItemSet()(o.connectToItemCache(function(e,t){return{isAvailable:a.getIsQuickEditLayoutAvailable(e,t),allowEmptyFolder:!1,allowPinnedItems:!1}})(l))});
define("xy",["require","exports","ww","r","od","bl","Wv","Tc","wy","ODBItemsScopeDeferred_mini_css","Cy","fe"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";f=f.PinSite_9;Object.defineProperty(t,"__esModule",{value:!0});var h={default:"PinnedSolid",siteHovered:"PinnedSolid",pinHovered:"Unpin"},p={default:"Pinned",siteHovered:"Pinned",pinHovered:"PinnedSolid"};t.PinSiteButton=o.createItemCacheComponent(function(e,t){var d=o.evaluateItemCacheComponent(e,r.createElement(l.PinSiteAction,n.__assign({},t)));return r.createElement(u.WithAction,{action:d},function(e){var t=e.isAvailable,n=e.isToggled,o=e.execute;if(!t)return null;var u=n?h:p,l=n?a.default.UnpinLibrary:a.default.PinLibrary;return r.createElement("span",{className:f.odSitePinContainer,onClick:function(e){if(e){e.stopPropagation();e.preventDefault()}o({event:e}).catch(function(e){c.default.logError(e)})}},r.createElement(s.Link,{"aria-label":l,className:f.odSitePinButtonDefault},r.createElement(i.Icon,{iconName:u.default,className:f.odSitePinIcon,style:{opacity:n?1:0}})),r.createElement(s.Link,{"aria-label":l,className:f.odSitePinButtonHover},r.createElement(i.Icon,{iconName:u.siteHovered,className:f.odSitePinIcon})),r.createElement(s.Link,{"aria-label":l,className:f.odSitePinPinHover},r.createElement(i.Icon,{iconName:u.pinHovered,className:f.odSitePinIcon})))})})});
define("yQe",["require","exports","ww","r","bg","H1","DQe","Bo","lo","fE","Yv","qd","SQe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=u.withItemSetSelection(void 0,{isPrivate:!0})(a.withSelectedItemsContextMenu()(f.ItemSetTilesList)),d=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKey,t=n.__assign({},s.itemSetTilesListControl.pack(v));return r.createElement(l.ControlHandlerProvider,{controlHandlers:t},r.createElement(p,{itemKey:e,selectionMode:c.SelectionMode.multiple,doNotRenderShimmerTile:!0,disableMarqueeSelection:!0,ariaLabel:h.default.pinnedItemRegionLabel,"data-automationid":"PinnedItemsCardList"}))};return t})(r.PureComponent);t.PinnedItemCardListDefer=d;function v(e,t){var n=t.responsiveMode,r=void 0===n?i.ResponsiveMode.xxLarge:n,s=r<=i.ResponsiveMode.xLarge?216:259,u=r<=i.ResponsiveMode.xLarge?180:190;return{tileRenderer:o.PinnedItemCardRenderer,tileControlHandler:function(){return{desiredSize:{width:s,height:u}}},grid:{minRowHeight:u}}}});
define("DQe",["require","exports","ww","r","XG","b2","ME","Md","Bc","nm","Wi","xh","ODBItemsScopeDeferred_mini_css","Gi","w5","yh","Wv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";h=h.PinnedItemsCardRenderer_0;Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return r.createElement(u.WithItemCache,null,function(n){var o=n.itemCache,u=o.demandItemFacet(p.friendlyDateModifiedFacet,t),a=!1,f=m.evaluateItemCacheComponent(o,r.createElement(s.ItemActivityField,{itemKey:t,isCompact:!0,hideDate:!0}));if(null===f){a=!0;f=u?r.createElement(d.DateField,{text:u}):r.createElement("div",null)}var l=v.getLifeCycleSignals(o,t,3,!0),h=l&&l.map(function(e){return e.signal}),g=a?f:r.createElement(c.SignalField,{signalsFieldMode:"compact",after:h},f);return r.createElement(i.ItemCard,{key:t,telemetryPrefix:"PinnedItemCardRenderer",itemActivityElement:g,folderCoverElement:e._renderFolderCoverElement(),itemKey:t,cardIndex:e.props.selectionIndex||0,itemSetKey:t,selection:e.props.selection,selectionIndex:e.props.selectionIndex,isSelectable:!0,hideThumbnail:!1,inlineFileIcon:!1,roleValue:"gridcell"})})};t.prototype._renderFolderCoverElement=function(){var e=this,t=this.props.itemKey;return r.createElement(u.WithItemCache,null,function(n){var i=n.itemCache.demandItem({isFolder:a.folderFacet,count:f.countFacet,oneNote:l.oneNoteFacet,isShared:a.isSharedFacet},t),s=i.isFolder,u=i.count,c=i.oneNote,p=i.isShared;if(s&&!c){var d=r.createElement(o.FolderCover,{key:"folder",className:h.folderCover,folderCoverSize:"large",folderCoverType:"default",metadata:u,signal:e._getFolderCoverSignal(p),isFluent:!0}),v=o.getFolderCoverLayout(d).contentSize;return o.renderFolderCoverWithLayout(d,{children:u?r.createElement("span",{className:h.blankFolderCover,role:"gridcell",style:{width:v.width+"px",height:v.height+"px"}}):null})}return null})};t.prototype._getFolderCoverSignal=function(e){return e?r.createElement(c.SharedSignal,null):null};return t})(r.PureComponent);t.PinnedItemCardRenderer=g});
define("vC",["require","exports","r","Wv","Bc","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s){"use strict";s=s.SiteHeaderTileCell_3;Object.defineProperty(t,"__esModule",{value:!0});t.SiteHeaderTileCell=r.createItemCacheComponent(function(e,t){var r=e.demandItemFacet(i.displayNameFacet,t.itemKey)||"";return n.createElement("div",null,n.createElement("h3",{className:s.name},r))})});
define("_C",["require","exports","r","Gi","ODBItemsScopeDeferred_mini_css","Co","Wv","ra"],function(e,t,n,r,i,s,o,u){"use strict";i=i.SiteIcon_5;Object.defineProperty(t,"__esModule",{value:!0});var a=.4,f=.72;function l(e){var t=e.size,r=void 0===t?24:t,o=e.acronymColor,l=e.acronym,c=e.siteLogoUrl,h=e.className,p=e.acronymHeightRatio,d=void 0===p?a:p,v=e.acronymFontSizeRatio,m=void 0===v?f:v,g=n.useState(!1),y=g[0],b=g[1],w=n.useState(!1),E=w[0],S=w[1],x=s.useEventHandler(function(){S(!0)}),T=s.useEventHandler(function(){b(!0)}),N=r*d*m;return n.createElement("div",{className:u.css(h,i.acronym),style:{backgroundColor:o,width:r+"px",height:r+"px"}},n.createElement("p",{className:i.acronymText,style:{fontSize:Math.ceil(N)+"px"}},l),c&&!y?n.createElement("img",{className:E?i.siteLogo:i.siteLogoHidden,src:c,onLoad:x,onError:T}):null)}t.SiteIcon=o.createItemCacheComponent(function(e,t){var i=t.itemKey,s=t.size,o=t.className,u=t.acronymHeightRatio,a=t.acronymFontSizeRatio,f=e.demandItem({acronym:r.acronymFacet,acronymColor:r.bannerColorFacet,siteLogoUrl:r.bannerImageUrlFacet},i),c=f.acronym,h=f.acronymColor,p=f.siteLogoUrl;return n.createElement(l,{acronym:c,acronymColor:h,className:o,siteLogoUrl:p,size:s,acronymHeightRatio:u,acronymFontSizeRatio:a})})});
define("IC",["require","exports","r","rb","ODBItemsScopeDeferred_mini_css","xy","Wv","ra"],function(e,t,n,r,i,s,u,a){"use strict";var o=i.PinSite_9;i=i.SiteItemTile_3;Object.defineProperty(t,"__esModule",{value:!0});t.SiteItemTile=u.createItemCacheComponent(function(e,t){var l=t.itemKey,c=t.itemName,h=t.itemActivity,p=t.contentSize,d=t.groupKey,v=p?p.height:16,m=f(v),g=u.evaluateItemCacheComponent(e,n.createElement(r.ItemFileTypeIcon,{itemKey:l,size:m})),y=d&&l?u.evaluateItemCacheComponent(e,n.createElement(s.PinSiteButton,{itemKey:l,rootItemKey:d})):null;return n.createElement("div",{className:a.css(i.root,o.sitePinAllSitesParent)},n.createElement("div",{className:i.icon,style:{width:v+"px"}},g),n.createElement("div",{className:i.nameplate},n.createElement("span",{className:i.name},c),y?n.createElement("span",null,y):null,n.createElement("div",{className:i.activity},h)))});function f(e){return"number"==typeof e?e>=96?96:e>=64?64:e>=48?48:e>=40?40:e>=32?32:e>=20?20:16:16}t.getIconHeight=f});
define("SC",["require","exports","r","xy","Wv","ra","ODBItemsScopeDeferred_mini_css","_C"],function(e,t,n,r,i,s,o,a){"use strict";var u=o.PinSite_9;o=o.SiteItemTile_v2_7;Object.defineProperty(t,"__esModule",{value:!0});t.SiteItemTileV2=i.createItemCacheComponent(function(e,t){var f=t.itemKey,l=t.itemName,c=t.itemActivity,h=t.contentSize,p=t.groupKey,d=(function(e){var t,n;if("number"==typeof e)n=(e-(t=e>=72?48:e>=48?32:16))/2;else{t=16;n=0}return{height:t,padding:n}})(h?.9*h.height:16),v=i.evaluateItemCacheComponent(e,n.createElement(a.SiteIcon,{itemKey:f,size:d.height,className:o.icon,acronymHeightRatio:.5,acronymFontSizeRatio:.82})),m=p&&f?i.evaluateItemCacheComponent(e,n.createElement(r.PinSiteButton,{itemKey:f,rootItemKey:p})):null;return n.createElement("div",{className:s.css(o.root,u.sitePinAllSitesParent)},n.createElement("div",{style:{padding:d.padding+"px"}},v),n.createElement("div",{className:o.nameplate},n.createElement("span",{className:o.name},l),m?n.createElement("span",null,m):null,n.createElement("div",{className:o.activity},c)))})});
define("eWe",["require","exports","ww","tWe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("IH",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filterActionControl=new n.ControlFacet("filterActionControl")});
define("lH",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupByActionControl=new n.ControlFacet("groupByActionControl")});
define("uet",["require","exports","aU"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getOpenFileCommandWithHandler=n.getOpenFileCommandWithHandler;t.SHOW_FILEHANDLER_COMMANDS_FIRST=n.SHOW_FILEHANDLER_COMMANDS_FIRST});
define("iWe",["require","exports","Sk","rWe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameValidator=function(e,t){return n.checkFilename(t,r.default,e)}});
define("yU",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveViewActionControl=new n.ControlFacet("saveViewActionControl")});
define("Xx",["require","exports","ww","K_","Qi","p3","rC","$x","Zx","Oy","ZD"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointOneDriveAddonDataOnly=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(l.sharePointOneDriveLibraryAddon);e(r.registerOperationHandler(i.businessNavSetKeyFacet,s.getItemsOperation)(o.getBusinessNavSet));e(r.registerOperationHandler(i.oneDriveNavSetKeyFacet,s.getItemsOperation)(u.getOneDriveNavSet));e(r.registerOperationHandler(i.spAllSitesKeyFacet,f.pinSiteOperation)(a.spAllSitesPinSiteOperationHandler));return[2]})})}})});
define("kF",["require","exports","ww","Gi","PF","MF","Qi","Zr","yS","K_","Cs","$_","Is","Gi","M"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPFilterOptionSetHandler=f.createSingleItemOperationHandler({maxParallelOperationCount:8})(function(e){var t=this,f=e.itemKey,v=o.spFilterOptionSetKeyFacet.deserialize(f);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,m,g,y,b;return n.__generator(this,function(w){switch(w.label){case 0:t=e((function(e){var t=e.itemSetKey,n=e.fieldKey;return function(e){var i=e(h.readConfiguration({spDataSourceConfiguration:r.spDataSourceConfigurationFacet})).spDataSourceConfiguration,s=i&&i.ensureAuthToken,f=o.spItemKeyFacet.serialize(t),c=e(l.readItem({folderPath:r.folderPathFacet},f)),v=e(l.readItem({internalName:r.internalNameFacet,mappedColumnFieldType:r.mappedColumnFieldTypeFacet,isCalculated:r.isCalculatedFacet},u.spListFieldKeyFacet.serialize(n))),m=c&&c.folderPath,g=v&&v.internalName&&v.internalName,y=v&&v.mappedColumnFieldType===a.ColumnFieldType.Taxonomy,b=v&&v.isCalculated,w=o.spPageContextKeyFacet.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),E=e(l.readItem({pageContext:p.spPageContextFacet},w)).pageContext,S=t.viewKey&&t.viewKey.viewId,x=S===d.default.Empty?E&&E.viewId:S;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:m,ensureAuthToken:s,fieldInternalName:g,isCalculatedField:b,filterParams:t.filterParams,excludeFieldFilteringHtml:y,viewId:x}}})({itemSetKey:v.itemSetKey,fieldKey:v.fieldKey}));return[4,e(i.getFilterData(t))];case 1:m=w.sent();g=s.default.getFilterData(m,t.fieldInternalName||"",t.isCalculatedField);(y=new c.ItemResolver).resolveItems({items:(b={},b[f]=n.__assign({},r.filterOptionSetFacet.pack(g)),b)});e(y.execute());return[2]}})})}})});
define("dC",["require","exports","ww","K_","OC","Wm","Ov","Qi","kb","h6","Sy","H1","gC","wI","Cv","bC","vd","mC","pC","fC","uC","E8","R9","lC","sc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=E.forModuleExport(E.asModuleWithRetries(function(){return new Promise(function(t,n){e(["XF"],t,n)})},{chunkName:"addon-sharepointhome-deferred"}),"sharePointHomeAddonDeferred");t.sharePointHomeAddon=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(i.sharePointHomeAddonDataOnly);e(a.registerControlHandler(u.spAllSitesKeyFacet,f.itemSetNavGroupControl)(l.allSitesNavGroupControlHandler));e(a.registerControlHandler(u.spAllSitesKeyFacet,c.itemSetTilesListControl)(h.spAllSitesItemSetTilesListControlHandler));e(a.registerControlHandler(u.spAllSitesKeyFacet,o.itemEngagementControl)(b.spAllSitesItemEngagementControlHandler));e(a.registerControlHandler(u.spAllSitesKeyFacet,p.itemsViewControl)(v.spAllSitesItemsViewControlHandler));e(a.registerControlHandler(u.spAllSitesKeyFacet,d.itemsViewLayoutsControl)(v.spAllSitesItemsViewLayoutsControlHandler));e(a.registerControlHandler(u.spWebKeyFacet,m.itemFileTypeIconControl)(g.spWebItemFileTypeIconControlHandler));e(a.registerControlHandler(u.spWebKeyFacet,o.itemEngagementControl)(y.spWebItemEngagementControlHandler));e(a.registerControlHandler(u.spFrequentSitesItemSetKeyFacet,s.childItemsControl)(w.frequentSitesItemSetControlHandler));e(a.registerControlHandler(u.spAllSitesKeyFacet,T.itemSetSelectionControl)(x.spAllSitesItemSetSelectionControlHandler));e(S.loadDeferredAddon(N));return[2]})})}})});
define("OC",["require","exports","ww","K_","p3","Qi","Bc","tc","PC","MC","LC","AC","EC","E8","V7","wC","kb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=p.forModuleExport(p.asModuleWithRetries(function(){return new Promise(function(t,n){e(["LN"],t,n)})},{chunkName:"addon-sharepointhome-deferred"}),"getSPFollowedSitesItemSet");t.sharePointHomeAddonDataOnly=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(i.supportFacets({keyFacet:s.spWebKeyFacet,facets:[o.displayNameFacet,u.defaultChildItemSetFacet]}));e(i.supportFacets({keyFacet:s.spFollowedSitesItemSetKeyFacet,facets:[s.spFollowedSitesItemSetKeyFacet,u.childItemsFacet]}));e(i.supportFacets({keyFacet:s.spFrequentSitesItemSetKeyFacet,facets:[s.spFrequentSitesItemSetKeyFacet,u.childItemsFacet]}));e(i.supportFacets({keyFacet:s.spLibrariesItemSetKeyFacet,facets:[s.spLibrariesItemSetKeyFacet,u.childItemsFacet,u.defaultChildItemSetFacet]}));e(r.registerOperationHandler(s.spHomeContextKeyFacet,i.getItemsOperation)(r.createSingleItemOperationHandler({maxParallelOperationCount:4})(a.getSPHomeContext)));e(r.registerOperationHandler(s.spAllSitesKeyFacet,i.getItemsOperation)(r.createSingleItemOperationHandler()(f.getSPAllSites)));e(r.registerOperationHandler(s.spFrequentSitesItemSetKeyFacet,i.getItemsOperation)(r.createSingleItemOperationHandler()(l.getSPFrequentSitesItemSet)));e(r.registerOperationHandler(s.spWebKeyFacet,i.getItemsOperation)(r.createSingleItemOperationHandler({maxParallelOperationCount:4})(c.getSPWeb)));e(r.registerOperationHandler(s.spLibrariesItemSetKeyFacet,i.getItemsOperation)(r.createSingleItemOperationHandler({maxParallelOperationCount:8})(h.getSPLibrariesItemSet)));e(m.registerControlHandler(s.spLibrariesItemSetKeyFacet,d.filteredItemSetControl)(v.spLibrariesItemSetFilteredItemSetControlHandler));e(r.registerOperationHandler(s.spFollowedSitesItemSetKeyFacet,i.getItemsOperation)(r.createDeferredOperationHandler(g)));return[2]})})}})});
define("XF",["require","exports","ww","K_","kb","F1","ZF","Qi"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointHomeAddonDeferred=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(i.registerControlHandler(u.spAllSitesKeyFacet,s.itemsContextMenuControl)(o.itemsContextControllerHandler));return[2]})})}})});
define("sWe",["require","exports","K_","kb","Qi","OWe","cWe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointAddonAutoRefresh=n.createAddon(function(){return function(e){e(r.registerControlHandler(i.spFolderItemSetKeyFacet,s.itemAutoRefreshControl)(o.itemAutoRefreshControlHandler))}})});
define("wU",["require","exports","ww","K_","D8","p3","I8","Qi","YF","QF","JM","qF","WF","fT","gU","JP","KF","GF","zF","kb","$8","VF","OC","Xx","BF","NF","RF","HF","FF","UF","kF","LF","AF","EF","wF","OF","xF","IF","SF","yF","vF","gF","mF","pF","fF","uF","dF","oF","rF","iF","aF","nF","xk","tF","QM","$U","ZU","JU","AM","YU","RM","QU","qU","WU","PT","GU","Tk","qk","Wk","y8","zU","VU","LU","EU"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge,ye,be){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPFilterOptionSetHandler=O.getSPFilterOptionSetHandler;t.spItemUploadItemsOperationHandler=he.spItemUploadItemsOperationHandler;t.spItemCreateFolderOperationHandler=pe.spItemCreateFolderOperationHandler;t.spItemCreateDocumentOperationHandler=de.spItemCreateDocumentOperationHandler;t.spDataOnlyAddonDeferred=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(r.registerOperationHandler(u.spNeedsAttentionItemKeyFacet,s.getItemsOperation)(A.getNeedsAttentionFlagOperationHandler));e(r.registerOperationHandler(u.spItemKeyFacet,f.updateCheckoutStateOperation)(M.updateCheckoutState));e(r.registerOperationHandler(u.spItemKeyFacet,l.updatePublishStateOperation)(_.publishItem));e(r.registerOperationHandler(u.spItemKeyFacet,c.updateItemRatingOperation)(D.updateItemRating));e(r.registerOperationHandler(u.spItemKeyFacet,h.updateItemLikesOperation)(P.updateItemLikes));e(ye.sharePointBasicActionsAddonDeferred);e(r.registerOperationHandler(u.spItemKeyFacet,o.createCustomDocumentOperation)(H.createCustomDocument));e(r.registerOperationHandler(u.spPinnedItemSetKeyFacet,a.editPinnedItemOperation)(B.editPinnedItem));e(r.registerOperationHandler(u.spItemKeyFacet,p.assignItemToGroupOperation)(K.assignItemsToGroup));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,m.createViewOperation)(j.createView));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,g.createFreshViewOperation)(F.createFreshView));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,y.updateViewOperation)(I.updateView));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,d.modifyViewOperation)(q.modifyView));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,v.saveViewCoreOperation)(U.saveViewCoreOperationHandler));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,w.modifyColumnOperation)(z.modifyColumn));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,fe.modifyColumnAggregateTypeOperation)(ae.modifyColumnAggregateType));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,E.updateColumnFormatterOperation)(W.updateColumnFormatter));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,ee.refreshItemsInSetOperation)(te.refreshItemsInSet));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,le.bulkUpdateListItemsOperation)(ce.bulkUpdateListItems));e(r.registerOperationHandler(u.spItemGroupKeyFacet,i.uploadItemsOperation)(X.uploadItemsToGroupOperationHandler));e(r.registerOperationHandler(u.likedByItemKeyFacet,s.getItemsOperation)(R.likedByPeopleOperationHandler));e(r.registerOperationHandler(u.spListViewsSetKeyFacet,s.getItemsOperation)(V.getViewsItemOperationHandler));e(r.registerOperationHandler(u.customActionSetKeyFacet,s.getItemsOperation)($.getCustomActionsOperationHandler));e(r.registerOperationHandler(u.customActionSetWithExtensionsKeyFacet,s.getItemsOperation)($.getCustomActionSetWithExtensionsOperationHandler));e(r.registerOperationHandler(u.spWebPageContextKeyFacet,s.getItemsOperation)(J.spWebPageContextGetItemsOperationHandler));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,N.updateCustomFormatterOperation)(C.updateCustomFormatter));e(r.registerOperationHandler(u.spFolderItemSetKeyFacet,k.modifyFieldPropertiesOperation)(L.modifyFieldProperties));e(b.registerControlHandler(u.spItemKeyFacet,ie.fileHandlerActionControlFacet)(se.fileHandlerActionControlHandler));e(b.registerControlHandler(u.spItemKeyFacet,oe.getDriveItemFullUrlControlFacet)(ue.getDriveItemFullUrlControlHandler));e(be.sharePointBasicItemDataAddonDeferred);e(ve.sharePointNewAndUploadAddonDataOnly);e(S.sharePointHomeAddonDataOnly);e(x.sharePointOneDriveAddonDataOnly);e(T.sharePointTenantAddon);e(b.registerControlHandler(u.spItemKeyFacet,Q.shareLinkActionControl)(G.defaultShareLinkControlHandler));e(r.registerOperationHandler(u.spItemKeyFacet,Y.updateListItemOperation)(Z.updateListItem));e(b.registerControlHandler(u.spItemKeyFacet,ne.permissionInviteActionControl)(re.permissionInviteControlHandler));e(r.registerOperationHandler(u.spItemKeyFacet,me.removeItemsFromSharedListOperation)(ge.spItemRemoveItemsFromSharedListOperationHandler));e(r.registerOperationHandler(u.spItemFullUrlKeyFacet,me.removeItemsFromSharedListOperation)(ge.spItemFullUrlRemoveItemsFromSharedListOperationHandler));return[2]})})}})});
define("Qk",["require","exports","ww","K_","kb","Lv","JF","s3","Q0","F1","Ri","Qi","wU","aU","vT","gT","bT","hT","cT","sT","rT","aT","p3","ZP","Uk","XP","MP","L7","kP","wP","H1","_h","eP","N6","$M","XM","jM","_8","wM","OM","IM","Xv","SM","yM","bM","mM","U7","U7","U7","f8","Gi","Is","e8","dM","cM","sM","U9","P9","oM","Y1","iM","e4","Yk"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spProjectedUploadedItemSetAddon=ie.spProjectedUploadedItemSetAddon;t.SpAddonDeferred=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(k.removeFromOneDriveAddon);e(j.sharePointNewAndUploadAddon);e(K.sharePointSyncAddon);e(h.spDataOnlyAddonDeferred);if(e(G.readConfiguration({enablePltCommands:Q.enablePltCommandsConfigurationFacet})).enablePltCommands)e(i.registerControlHandler(c.spItemKeyFacet,Y.deferredItemsCommandBarControl)(p.deferredItemsCommandBarControlerHandler));else{e(i.registerControlHandler(c.spItemKeyFacet,a.itemsCommandBarControl)(p.itemsCommandBarControlerHandler));e(i.registerControlHandler(c.spItemKeyFacet,ne.addToOneDriveActionControl)(re.addToOneDriveActionControlHandler))}e(i.registerControlHandler(c.spItemKeyFacet,f.itemsContextMenuControl)(d.itemsContextMenuControlerHandler));e(i.registerControlHandler(c.spItemGroupKeyFacet,u.openActionControl)(v.openGroupControlHandler));e(i.registerControlHandler(c.spItemKeyFacet,o.itemsBreadcrumbControl)(g.itemsBreadcrumbControlerHandler));e(i.registerControlHandler(c.spItemGroupKeyFacet,l.defaultDropActionControl)(y.defaultDropActionControlHandler));e(i.registerControlHandler(c.spItemGroupKeyFacet,s.uploadItemsActionControl)(b.uploadItemsToGroupActionControlHandler));e(Z.sharePointWebItemTileAddon);e(r.registerOperationHandler(c.spContentTypeCreateDocumentActionKeyFacet,S.getItemsOperation)(w.getContentTypeCreateDocumentActionItemOperationHandler));e(r.registerOperationHandler(c.spContentTypeNavigationActionKeyFacet,S.getItemsOperation)(E.getContentTypeNavigationActionItemOperationHandler));e(r.registerOperationHandler(c.spPeoplePickerDataSourceKeyFacet,S.getItemsOperation)(x.spPeoplePickerDataSourceGetItemsOperationHandler));e(r.registerOperationHandler(c.spListKeyFacet,T.saveUploadedTemplateToViewOperation)(C.saveUploadedTemplateToView));e(r.registerOperationHandler(c.spListKeyFacet,N.saveTemplatesToViewOperation)(L.saveTemplatesToView));e(i.registerControlHandler(c.spFolderItemSetKeyFacet,O.itemSetTilesListControl)(A.spFolderItemSetTilesListControlHandler));e(i.registerControlHandler(c.spItemKeyFacet,M.sharingCalloutControl)(_.sharingCalloutControlHandler));e(i.registerControlHandler(c.spItemKeyFacet,D.hoverCardCommandsControl)(H.hoverCardCommandsControlHandler));e(i.registerControlHandler(V.sharedByMeRootItemKeyFacet,a.itemsCommandBarControl)(F.sharedByMeCommandBarControlHandler));e(i.registerControlHandler($.sharedByMeItemSetKeyFacet,R.itemSetColumnsControl)(q.sharedByMeRootItemSetColumnsControlHandler));e(i.registerControlHandler(V.sharedByMeRootItemKeyFacet,f.itemsContextMenuControl)(I.sharedByMeContextMenuControlHandler));e(r.registerOperationHandler(V.sharedByMeRootItemKeyFacet,S.getItemsOperation)(U.sharedByMeRootItemGetItemsOperationHandler));e(r.registerOperationHandler($.sharedByMeItemSetKeyFacet,S.getItemsOperation)(z.sharedByMeItemSetGetItemsOperationHandler));e(r.registerOperationHandler(J.sharedByMePageKeyFacet,S.getItemsOperation)(W.sharedByMePageGetItemsOperationHandler));e(r.registerOperationHandler(ue.spItemPlacesSetKeyFacet,S.getItemsOperation)(ae.spItemPlacesSetGetItemsOperationHandler));e(i.registerControlHandler(c.spWebKeyFacet,u.openActionControl)(m.webOpenActionControlHandler));e(i.registerControlHandler(c.spItemKeyFacet,P.hoverCardLifeCycleStatusControl)(B.spHoverCardLifeCycleStatusControlHandler));e(r.registerOperationHandler(c.spProjectedUploadedItemSetKeyFacet,S.getItemsOperation)(X.spProjectedUploadedItemSetGetItemsOperationHandler));e(i.registerControlHandler(c.spFolderByIdKeyFacet,se.itemErrorControl)(oe.spFolderByIdErrorControlHandler));e(i.registerControlHandler(c.spItemKeyFacet,ee.removeFromSharedActionListControl)(te.removeFromSharedListControlHandler));return[2]})})}})});
define("wWe",["require","exports","ww","K_","kb","Qi","hI","LWe","EWe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(a,t);t.sharePointAddonQuickEdit=r.createAddon(function(){return function(e){e(i.registerControlHandler(s.spFolderItemSetKeyFacet,o.itemSetQuickEditListControl)(u.itemSetQuickEditListControlHandler))}})});
define("BF",["require","exports","ww","K_","Qi","p3","jF"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePointTenantAddon=r.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(r.registerOperationHandler(i.spTenantKeyFacet,s.getItemsOperation)(o.SPTenantGetItemsOperationHandler));return[2]})})}})});
define("eF",["require","exports","ww","Cs","Gi","De","Qi","xI","cc","I7"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spDataSourceConfigurationFacet=i.spDataSourceConfigurationFacet;t.spPrefetchDataConfigurationFacet=i.spPrefetchDataConfigurationFacet;t.constructRefreshItemsInSetContext=function(e){return function(t){for(var l=e.itemSetKey,c=e.itemKeys,h=t(a.readItems(function(e){var t=e.demandItemFacet(o.spFolderItemSetKeyFacet,l)||o.spFolderItemSetKeyFacet.deserialize(l);return n.__assign(n.__assign({},t),{pageContext:f.getPageContextFromItemCache(e,o.spItemKeyFacet.serialize(t))})})),p=h.webAbsoluteUrl,d=h.listFullUrl,v=h.pageContext,m=[],g=0,y=c;g<y.length;g++){var b=y[g],w=o.spItemKeyFacet.deserialize(b).itemId;if(!w){w=t(r.readItem({listItemId:i.listItemIdFacet},b)).listItemId}w&&m.push(w)}var E=t(u.readItemSetSchema({internalName:i.internalNameFacet},l)),S=["Modified"];if(E)for(var x=0,T=E;x<T.length;x++){var N=T[x];N.internalName&&"Modified"!==N.internalName&&S.push(N.internalName)}return{webAbsoluteUrl:p,listFullUrl:d,currentPageContext:v,qosName:"refreshItemsInSet",viewXml:s.getViewXml({itemIds:m,recurseInFolders:!0,pageSize:c.length,fieldNames:S.length>0?S:void 0}),postDataContext:{needsSchema:!0}}}}});
define("PF",["require","exports","W3","TF","X7","e9"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFilterData=function(e){return function(t){return t(n.getData({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"POST",url:o(e),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}};function o(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,o=e.fieldInternalName,u=e.viewId,a=e.rootFolder,f=e.excludeFieldFilteringHtml,l=e.filterParams,c=s.getListApiUrl({webAbsoluteUrl:t,listFullUrl:n}).segment("RenderListFilterData").parameter("FieldInternalName",o||"");u&&(c=c.parameter("ViewId",u));a&&(c=c.parameter("RootFolder",{raw:r.encodeURIComponent(a)}));f&&(c=c.parameter("ExcludeFieldFilteringHtml",!0));if(l){var h=i.default.getFilterParams(l,!0);c=c.rawParameter(h)}return c.toString()}});
define("oWe",["require","exports","ww","W3","e9"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getListRootFolder=function(e){var t=this,s=e.webAbsoluteUrl,o=e.listFullUrl,u=e.qosName;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t=i.getListApiUrl({webAbsoluteUrl:s,listFullUrl:o}).segment("RootFolder");return[4,e(r.getDataWithCache({url:t.toString(),method:"GET",webAbsoluteUrl:s,listFullUrl:o,qosName:"rootFolder."+u,noRedirect:!0}))];case 1:return[2,n.sent()]}})})}}});
define("UF",["require","exports","ww","f4","K_","Bc","Qi","$_","o4"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNeedsAttentionFlagOperationHandler=i.createSingleItemOperationHandler()(function(e){var t=this,i=e.itemKey,s=o.spNeedsAttentionItemKeyFacet.deserialize(i),u={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,rootFolder:"",viewKey:{viewId:o.needsAttentionViewId}};return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,o;return n.__generator(this,function(n){switch(n.label){case 0:t=e(r.getContentTypes({itemSetKey:u}));return[4,e(r.constructGetItemSetContext({itemSetKey:u,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:s=n.sent();n.label=2;case 2:n.trys.push([2,5,,7]);return[4,e(a.getServerData(s))];case 3:o=n.sent();return[4,e(f(o,i))];case 4:n.sent();return[3,7];case 5:n.sent();return[4,e(f(void 0,i))];case 6:n.sent();return[3,7];case 7:return[2]}})})}});function f(e,t){var r=this;return function(i){return n.__awaiter(r,void 0,void 0,function(){var r,o,a,f;return n.__generator(this,function(l){r=!1;(o=e&&e.ListData&&e.ListData.Row)&&o.length>0&&o[0]&&(r=!0);(a=new u.ItemResolver).resolveItems({items:(f={},f[t]=n.__assign({},s.missingMetadataFacet.pack(r||void 0)),f)});i(a.execute());return[2]})})}}});
define("lF",["require","exports","W3","e9","zi","CS"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getViewData=function(e){return function(t){return t(n.getDataWithCache({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:a(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){return{serverView:t,view:o(t,!1,e.listTemplate)}})},noRedirect:!0}))}};t.getViewById=function(e){return function(t){return t(n.getDataWithCache({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:a(e),qosName:"getViewDataById",parseResponse:function(e){var t=JSON.parse(e).d;return{serverView:t,view:o(t,!0)}},noRedirect:!0}))}};function o(e,t,n){if(e.ViewType&&e.Id){var r=s.default.isAppView(e),o=e.Hidden&&!r,u=n===i.ListTemplateType.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!o&&!u){var a=new s.default(e);if(a.viewType)return a}}}var u=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function a(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,i=e.viewId,s=r.getListApiUrl({webAbsoluteUrl:t,listFullUrl:n});return(s=i?s.method("Views",i):s.segment("Views")).oDataParameter("$select",u).toString()}});
define("Vj",["require","exports","ww","CS","m4","zi","t7","Cs","Gi","Qi","Le","ro"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNeedsAttentionView=function(e,t,h){var p=f.spListKeyFacet.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),d=h(u.readItem({list:a.listFacet},p)),v=d&&d.list&&d.list.templateType&&s.isGenericList(d.list.templateType),m=v?"LinkTitle":"LinkFilename",g={},y=[];if(e)for(var b=0,w=e;b<w.length;b++){var E=w[b];if(E.contentTypeId&&E.requiredFields&&E.requiredLookups){for(var S={fieldName:"ContentTypeId",operator:"Eq",values:[E.contentTypeId]},x=i.filterToCaml(S),T=[],N=E.requiredFields.split(","),C=E.requiredLookups.split(","),k=0;k<N.length;k++){var L=N[k],A="True"===C[k];void 0===g[L]&&(g[L]=A);var O={fieldName:L,lookupId:!!A||void 0,operator:"Eq",values:[""]};T.push(O)}var M=i.filtersToCaml(T,"Or");if(M){var _=i.filtersToCaml([x,M],"And");y.push(_)}}}0===y.length&&y.push(i.filterToCaml({fieldName:"FileLeafRef",operator:"Eq",values:[""]}));var D=Object.keys(g),P=D.map(function(e){return g[e]}),H=n.__spreadArrays(["DocIcon",m,"Editor","Modified"],D,["FileDirRef"]),B=n.__spreadArrays([void 0,void 0,void 0,void 0],P,[void 0]),j=!!d&&!!d.list&&!!d.list.templateType&&d.list.templateType===s.default.webPageLibrary,F=new r.default("<View Scope='Recursive'/>");j&&l.default.isFeatureEnabled({ODB:1743})?F.title=o.default.PagesThatNeedAttention:F.title=v?o.default.ItemsThatNeedAttention:o.default.FilesThatNeedAttention;F.isReadOnly=!0;F.id=c.needsAttentionViewId;F.replaceFields(H,B);F.updateSort({fieldName:"ID",isAscending:!0});F.updateRowLimit({rowLimit:30,isPerPage:!0});var I=i.filtersToCaml(y,"Or");F.addFilters([I]);return F}});
define("bk",["require","exports","ww","qk","Wk","Tk","Ek","vk","gk"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t)});
define("L7",["require","exports","ww","kb","K_","T7","P7","Qi","k7"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromOneDriveAddon=i.createAddon(function(){return function(t){t(r.registerControlHandler(u.spItemKeyFacet,s.removeFromOneDriveActionControl)(a.removeFromOneDriveActionControlHandler));t(i.registerOperationHandler(u.spItemKeyFacet,o.removeFromOneDriveOperation)(i.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["CN"],t,n)})];case 1:return[2,t.sent().removeFromOneDriveOperationHandler]}})})})))}})});
define("uT",["require","exports","Ms","Z_","pT","fT"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.assignItemToGroup=n.implementOperation({operationTypeFacet:s.assignItemToGroupOperation});t.assignItemToGroupWithProgress=r.implementOperationWithProgress({operationTypeFacet:s.assignItemToGroupOperation,progressKeyFacet:s.assignToGroupProgressKeyFacet,initializeBatch:function(){return i.assignToGroupProgressAddon}})});
define("fT",["require","exports","qi","Z_"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.assignItemToGroupOperation=new n.Facet("assignItemToGroup");t.assignToGroupProgressKeyFacet=new r.ProgressKeyFacet("assignToGroup")});
define("pT",["require","exports","ww","we","mT","fT","K_","kb","G_","z_","Z_","tc","ih","Bc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d;Object.defineProperty(t,"__esModule",{value:!0});var v=((d={})[h.ProgressPhase.started]=function(e,t){return r.format(r.getLocalizedCountValue(i.default.assignToGroupStartedItemsTitle,i.default.assignToGroupTitleIntervals,e)||"",e,t)},d[h.ProgressPhase.completed]=function(e,t){return r.format(r.getLocalizedCountValue(i.default.assignToGroupCompletedItemsTitle,i.default.assignToGroupTitleIntervals,e)||"",e,t)},d[h.ProgressPhase.failed]=function(e,t){return r.format(r.getLocalizedCountValue(i.default.assignToGroupFailedItemsTitle,i.default.assignToGroupTitleIntervals,e)||"",e,t)},d[h.ProgressPhase.canceled]=function(e,t){return r.format(r.getLocalizedCountValue(i.default.assignToGroupFailedItemsTitle,i.default.assignToGroupTitleIntervals,e)||"",e,t)},d);t.assignToGroupProgressAddon=o.createAddon(function(){return function(e){e(u.registerControlHandler(s.assignToGroupProgressKeyFacet,a.progressControl)(u.createControlHandler()(g)));e(u.registerControlHandler(s.assignToGroupProgressKeyFacet,f.progressCommandSummaryControl)(u.createControlHandler()(m)))}});function m(){return function(e){return function(e,t){return{reportMode:f.ProgressSummaryReportMode.pin}}}}function g(){return function(e){return y}}function y(e,t){var r=t.itemKey,i=l.getOverallSimpleProgressBreakdown(e,t),o=i.phase,u=i.count,a=v,f=e.demandItemFacet(c.childItemsFacet,r),h=f&&f.itemKeys,d="",m="";if(h&&h.length>0){var g=e.demandItemFacet(s.assignItemToGroupOperation,h[0]),y=g&&g.groupKey;y&&(d=e.demandItemFacet(p.displayNameFacet,y)||"");m=a[o](u,d)}else{var b=e.demandItemFacet(s.assignToGroupProgressKeyFacet,r);if(b){var w=b.taskKey,E=w&&e.demandItemFacet(p.displayNameFacet,w);E&&(m=E)}}return n.__assign({},m&&"item"!==t.format?{title:m}:{})}});
define("PT",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.bulkUpdateListItemsOperation=new n.Facet("bulkUpdateListItems");t.bulkUpdateListItems=r.implementOperation({operationTypeFacet:t.bulkUpdateListItemsOperation})});
define("LF",["require","exports","ww","W3","Qi","Gi","Ms","K_","Cs","i3","Bc","p3","e9","M","kk","$_"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateCheckoutState=u.createBatchedItemsOperationHandler()(function(e){var t=e.items;return function(h){return n.__awaiter(void 0,void 0,void 0,function(){var y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U;return n.__generator(this,function(z){switch(z.label){case 0:y=void 0;b=void 0;for(w=0,E=Object.keys(t);w<E.length;w++){L=E[w];S=h(a.readItem({key:i.spItemKeyFacet,folderPath:s.folderPathFacet},L));x=e.items[L];if(S&&S.key&&S.folderPath){if(!y){b=S.key.listFullUrl;y={webAbsoluteUrl:S.key.webAbsoluteUrl,items:[],checkInOutType:x.checkInOutType,checkInText:x.checkInText,checkInVersionType:x.checkInVersionType};b=S.key.listFullUrl}y.items.push({key:L,itemFullUrl:S.folderPath})}}if(!(T=y)||!T.items.length)return[3,4];N=T.items.length>1;C=void 0;C="checkIn"===T.checkInOutType?N?"batchCheckInItems":"CheckInItem":"checkOut"===T.checkInOutType?N?"batchCheckOutItems":"CheckOutItem":N?"batchUndoCheckOutItems":"UndoCheckOutItem";k="checkOut"===T.checkInOutType;if(N)return[3,2];L=T.items[0].key;A=m(T.webAbsoluteUrl,T.items[0].itemFullUrl,T.checkInOutType,T.checkInText,T.checkInVersionType);return[4,h(r.getData({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:b,url:A,method:"POST",qosName:C}))];case 1:z.sent();h(c.resolveItems({items:(R={},R[L]=n.__assign({},l.isCheckedOutFacet.pack({byYou:!!k,byOther:void 0})),R)}));return[3,4];case 2:O=p.default.generate();M="multipart/mixed; boundary=batch_"+O;return[4,h(r.getData({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:b,url:d.default.getBatchOperationUrl(T.webAbsoluteUrl),body:g(T,O),method:"POST",additionalHeaders:void 0,contentType:M,parseResponse:function(e){return d.default.processBatchResponse(e,T.items)},qosName:"batch",telemetryHandler:function(e){var t=e.response,r=e.eventData;return t&&r.resultType===f.ResultType.success?{eventData:n.__assign(n.__assign({},r),{resultType:t.hasError?f.ResultType.failure:f.ResultType.success})}:{eventData:r}}}))];case 3:if((_=z.sent()).hasError){j={items:{}};for(F=0,I=_.items;F<I.length;F++)(q=I[F]).error&&q.key&&(j.items[q.key]=new o.ItemOperationError({message:q.error.message}));throw new u.BatchedItemsOperationHandlerError(j)}D=new v.ItemResolver;for(P=0,H=T.items;P<H.length;P++){B=H[P];D.resolveItems({items:(U={},U[B.key]=n.__assign({},l.isCheckedOutFacet.pack({byYou:!!k,byOther:void 0})),U)})}h(D.execute());z.label=4;case 4:return[2]}})})}});function m(e,t,n,r,i){var s;s="checkIn"===n?"CheckIn":"undoCheckOut"===n?"UndoCheckOut":"CheckOut";var o=h.getWebApiUrl({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(o="checkIn"===n?o.methodWithAliases("CheckIn",{comment:r,checkintype:i||0}):o.segment(s)).toString()}function g(e,t){var n=e.items,r=d.default.defaultBatchRequestPostData,i=n.map(function(t){return m(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText,e.checkInVersionType)});return d.default.getBatchContentExtended(t,i,"POST",r)}t.getBatchCheckoutContent=g});
define("QF",["require","exports","qi","Z_"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateCheckoutStateOperation=new n.Facet("updateCheckoutState");t.checkoutProgressKeyFacet=new r.ProgressKeyFacet("checkout");t.updateCheckoutState=r.implementOperationWithProgress({operationTypeFacet:t.updateCheckoutStateOperation,progressKeyFacet:t.checkoutProgressKeyFacet})});
define("FKe",["require","exports","ww","we","TT","QF","K_","kb","G_","Z_","tc","ih"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h,p,d;Object.defineProperty(t,"__esModule",{value:!0});var v=((h={})[c.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutStartedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h[c.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutCompletedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h[c.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h[c.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},h),m=((p={})[c.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutStartedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p[c.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutCompletedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p[c.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p[c.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.undoCheckoutFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},p),g=((d={})[c.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinStartedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d[c.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinCompletedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d[c.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d[c.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.checkinFailedItemsTitle,i.default.checkoutCompletedItemsTitleIntervals,e)||"",e)},d);t.checkoutProgressAddon=o.createAddon(function(){return function(e){e(u.registerControlHandler(s.checkoutProgressKeyFacet,a.progressControl)(u.createControlHandler()(y)))}});function y(){return function(e){return b}}function b(e,t){var r=t.itemKey,i=f.getOverallSimpleProgressBreakdown(e,t),o=i.phase,u=i.count,a=v,c=e.demandItemFacet(l.childItemsFacet,r),h=c&&c.itemKeys;if(h&&h.length>0){var p=e.demandItemFacet(s.updateCheckoutStateOperation,h[0]),d=p&&p.checkInOutType;"checkIn"===d?a=g:"undoCheckOut"===d&&(a=m)}var y=a[o](u);return n.__assign({},y&&"item"!==t.format?{title:y}:{})}});
define("OF",["require","exports","ww","K_","tc","th","u4","Ke","p3","Bc","e9","W3","Qi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createCustomDocument=r.createSingleItemOperationHandler({maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,l=e.options,d=l.newDocumentKey,v=l.extension;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,l,m,g,y;return n.__generator(this,function(b){switch(b.label){case 0:t=h.spItemKeyFacet.deserialize(r);l=t.rootFolder||new o.SimpleUri(t.listFullUrl).path;m=new u.ItemUrlHelperBasic({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}});g=m.getUrlParts({path:l});y=g.fullItemUrl;return[4,e(c.getData({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:p({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:g.listRelativeItemUrl||"",extension:v}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var o,u,l=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!l)throw"Fail to create custom document";var c=y+"/"+l;e(a.resolveItems({items:(o={},o[d]=n.__assign(n.__assign({},f.displayNameFacet.pack(l)),f.canonicalUrlFacet.pack(c)),o)}));e(s.invalidateItems({items:(u={},u[r]=[i.defaultChildItemSetFacet],u)}))})];case 1:b.sent();return[2]}})})}});function p(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.extension,i=e.parentFolderPath;if(!r)throw new Error("document extension is not valid");return l.getListApiUrl({webAbsoluteUrl:t,listFullUrl:n}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:i,extension:r}).toString()}});
define("Wk",["require","exports","ww","K_","yk"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCreateDocumentUrl=i.getCreateDocumentUrl;t.getRedirectUrlFromResponse=i.getRedirectUrlFromResponse;t.spItemCreateDocumentOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(t){var r=this;return function(i){return n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["vk"],t,n)})];case 1:return[4,(0,n.sent().createDocumentsCore)(i,t)];case 2:n.sent();return[2]}})})}})});
define("yk",["require","exports","Sk","j0","zL","e9"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRedirectUrlFromResponse=function(e){var t=e.responseText,r=e.documentType,i=e.fileName,s="",o="";if(null!=t){var u=JSON.parse(t);if(null!==u&&null!==u.d&&null!==u.d.CreateDocumentAndGetEditLink){o=u.d.CreateDocumentAndGetEditLink;s=n.getRedirectToEditNewDocument(o,r,i||"",!1)}else try{o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"";s=n.getRedirectToEditNewDocument(o,r,i||"",!1)}catch(e){}}return{originalEditLink:o,redirectUrl:s}};t.getCreateDocumentUrl=function(e){var t=r.DocumentType.Visio,n=e.webAbsoluteUrl,o=e.listFullUrl,u=e.parentFolderPath,a=e.templateUrl,f=e.docName,l=e.docType;if(null!==l&&l>=r.DocumentType.Word&&l<=t&&l!==r.DocumentType.Text){if(l!==r.DocumentType.OneNote||f){if(f){f+=i.getDocExtension(l)}}else f="Notebook"+Math.floor(100*Math.random())+1;f||(f="");l===r.DocumentType.ExcelForm&&(l=r.DocumentType.ExcelSurvey);return s.getListApiUrl({webAbsoluteUrl:n,listFullUrl:o}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:f,folderPath:u,documentTemplateType:l,templateUrl:a||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}});
define("vk",["require","exports","ww","W3","Ke","u4","j0","p3","Bc","th","tc","Wi","K","Gi","qS","zL","e9","Ck","Yb","Cs","ys","Qi","Ik","cc","yk"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createDocumentsCore=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le;return n.__generator(this,function(ce){switch(ce.label){case 0:C=t.itemKey,k=t.options,L=k.documentType,A=k.fileName,O=k.newDocumentKey,M=k.templateItemKey,_=k.targetWindow;D=E.spItemKeyFacet.deserialize(C);P=D.rootFolder||new s.SimpleUri(D.listFullUrl).path;H=new i.ItemUrlHelperBasic({context:{webAbsoluteUrl:D.webAbsoluteUrl,listUrl:D.listFullUrl}});B=H.getUrlParts({path:P});j=new y.default(null);F=e(b.readItem({createDocumentFormDigest:p.spCreateDocumentFormDigestFacet,spCookieDomainConfiguration:p.spCookieDomainConfigurationFacet},w.configurationItemKey)),I=F.createDocumentFormDigest,q=F.spCookieDomainConfiguration;R=!q||new s.SimpleUri(q).authority!==new s.SimpleUri(D.webAbsoluteUrl).authority;if(M||!I||R||L!==o.DocumentType.Word&&L!==o.DocumentType.PowerPoint&&L!==o.DocumentType.Bohemia&&L!==o.DocumentType.Prague&&L!==o.DocumentType.Visio)return[3,2];"_layouts/15";U=L===o.DocumentType.Prague?"prague":"doc";z=D.webAbsoluteUrl+"/_layouts/15/"+U+".aspx";W=e(b.readItem({folderUniqueId:p.uniqueIdFacet},C)).folderUniqueId;return[4,g.createDocumentByDocAspxWithItemUrlParts(L,z,D.webAbsoluteUrl,j,_,A,B,void 0,W)];case 1:ce.sent();e(f.invalidateItems({items:(ue={},ue[C]=[l.defaultChildItemSetFacet],ue)}));return[3,8];case 2:X="";V=void 0;if($=e(x.readItems(function(e){return e.demandItemFacet(E.spNewDocumentTemplateKeyFacet,M)})))if((J=e(b.readItem({documentTemplate:p.newDocumentTemplateFacet},M)).documentTemplate)&&J.url){V=J;X=J.url}else X=$.templateUrl;K=T.getCreateDocumentUrl({webAbsoluteUrl:D.webAbsoluteUrl,listFullUrl:D.listFullUrl,parentFolderPath:B.listRelativeItemUrl||"",docType:L,docName:A,templateUrl:X});return[4,e(r.getData({webAbsoluteUrl:D.webAbsoluteUrl,listFullUrl:D.listFullUrl,url:K,method:"POST",parseResponse:function(e){return e},qosName:"createDocument",noRedirect:!0}))];case 3:Q=ce.sent();G=T.getRedirectUrlFromResponse({responseText:Q,documentType:L,fileName:A}),Y=G.redirectUrl;if(!(Z=G.originalEditLink))return[3,7];ee=h.deserializeQuery(h.getQueryStringFromUrl(Z.toLowerCase()));te=ee.sourcedoc;ne=te&&d.normalizeLower(te);re=v.getDocExtension(L);if(!(ie=V)||!ie.url)return[3,6];se=(function(e){var t=e.listFullUrl,n=e.uniqueId,r=e.webAbsoluteUrl;return m.getListApiUrl({webAbsoluteUrl:r,listFullUrl:t}).methodWithAliases("GetItemByUniqueId",{uniqueId:n}).toString()})({listFullUrl:D.listFullUrl,webAbsoluteUrl:D.webAbsoluteUrl,uniqueId:ne});return[4,e(r.getData({listFullUrl:D.listFullUrl,webAbsoluteUrl:D.webAbsoluteUrl,url:se,method:"POST",parseResponse:N,qosName:"getItemByUniqueId",noRedirect:!0}))];case 4:return(oe=ce.sent())?[4,e(S.updateListItem({items:(ae={},ae[E.spItemKeyFacet.serialize({itemId:oe,listFullUrl:D.listFullUrl,webAbsoluteUrl:D.webAbsoluteUrl})]={formValues:[{FieldName:"ContentTypeId",FieldValue:ie.contentTypeId||""}],qosName:"updateTemplateDocContentType"},ae)}))]:[3,6];case 5:ce.sent();ce.label=6;case 6:e(u.resolveItems({items:(fe={},fe[O]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},Y?a.openUrlFacet.pack(Y):{}),a.fileNameFacet.pack({name:A||"",extension:re})),ne?p.uniqueIdFacet.pack(ne):{}),c.oneNoteFacet.pack(L===o.DocumentType.OneNote?{}:void 0)),l.parentItemFacet.pack({itemKey:C})),fe)}));ce.label=7;case 7:e(f.invalidateItems({items:(le={},le[C]=[l.defaultChildItemSetFacet],le)}));ce.label=8;case 8:return[2]}})})};function N(e){if(e)try{var t=JSON.parse(e);if(t&&t.d&&t.d.Id)return t.d.Id}catch(e){}return""}});
define("qk",["require","exports","ww","u4","Qi","Gi","W3","Ms","Cs","p3","th","K_","ih","tc","Bc","e9","Q1","i3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=-2147023080,b=-2130575282,w="-2130575257",E="-2130575245",S="-2130247139";t.spItemCreateFolderOperationHandler=c.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,c=e.itemKey,v=e.options.folders;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,m,y,b,N,C,k,L,A,O,M;return n.__generator(this,function(_){switch(_.label){case 0:t=Object.keys(v)[0];m=i.spItemKeyFacet.deserialize(c);y=m.rootFolder||new r.SimpleUri(m.listFullUrl).path;b=i.spListKeyFacet.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl});N=e(a.readItem({list:s.listFacet},b));C=x({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,parentFolderPath:y,isDocLib:!!N&&!!N.list&&N.list.isDocumentLibrary,folderName:t});return[4,e(o.getData({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,url:C,method:"POST",qosName:"createFolder",telemetryHandler:function(e){var t=e.errorData,r=e.eventData;if(t){var i=t.code,s=i&&(i.indexOf(w)>-1||i.indexOf(E)>-1||i.indexOf(S)>-1)?g.ResultType.expectedFailure:g.ResultType.failure;return{eventData:n.__assign(n.__assign({},r),{resultType:s})}}return{eventData:r}}})).catch(function(e){if(e instanceof o.GetDataError&&e.message&&y){var t=y;"/"===t[0]&&(t=t.substr(1));"/"!==t[t.length-1]&&(t+="/");e.message=e.message.replace(t,"")}throw new u.ItemOperationError({innerError:e,facets:T(e)})})];case 1:_.sent();if(k=v[t].progressItemKey){L=y+"/"+t;A=i.spItemKeyFacet.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,rootFolder:L});e(f.resolveItems({items:(O={},O[k]=n.__assign({},h.createdItemFacet.pack({itemKey:A})),O[A]=n.__assign(n.__assign({},s.folderPathFacet.pack(L)),d.parentFolderItemFacet.pack({itemKey:c})),O)}))}e(l.invalidateItems({items:(M={},M[c]=[p.defaultChildItemSetFacet],M)}));return[2]}})})}});function x(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.parentFolderPath,i=e.isDocLib,s=void 0===i||i,o=e.folderName,u=v.getWebApiUrl({webAbsoluteUrl:t,listOrItemFullUrl:n}),a=o?o.trim():"";return(u=s?(u=u.segment("folders")).methodWithAliases("AddUsingPath",{DecodedUrl:r+"/"+a,overwrite:!1}).oDataParameter("$Expand","ListItemAllFields/PermMask"):u.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:r}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:a||"Folder"+(Math.floor(100*Math.random())+1)})).toString()}t.getCreateFolderUrl=x;function T(e){if(e instanceof o.GetDataError){switch((function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]})(e)){case y:case b:return m.overQuotaErrorFacet.pack({})}}}});
define("SF",["require","exports","ww","Qi","K_","Cs","DF","e9","W3","CS","M","Gi","tc","th","IS","$_"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFreshView=i.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,i=e.options.views;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j;return n.__generator(this,function(F){m=r.spListViewsSetKeyFacet.deserialize(t);g=Object.keys(i)[0];y=i[g],b=y.isPublic,w=y.viewType,E=y.viewFields,S=y.viewStyles,x=y.viewData,T=y.queryXml,N=y.rowLimit,C=y.itemSetKey,k=y.progressItemKey;if(m){L=e(s.readItem({deserializedItemSetKey:r.spFolderItemSetKeyFacet,childItems:h.childItemsFacet,parentItem:h.parentItemFacet,schema:h.schemaFacet},C)),A=L.deserializedItemSetKey,O=L.childItems,M=L.parentItem;_=u.getListApiUrl({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl});D=_.segment("Views").segment("Add");return[2,e(a.getData({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl,url:D.toString(),method:"POST",body:JSON.stringify({parameters:n.__assign(n.__assign({__metadata:{type:"SP.ViewCreationInformation"},Title:g,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:E}},o.ViewTypesSecondary.indexOf(w)>=0?{ViewType2:w}:{}),{ViewData:x,CalendarViewStyles:S,Query:T,Paged:!0,PersonalView:!b,RowLimit:N})}),qosName:"addView",noRedirect:!0})).then(function(t){var i,s,o;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var u=t.d;H=l.default.normalizeLower(u.Id,!1);B={viewId:H};P=new f.default(u);d.setColumnWidthsFromViewToLocalStorage(P);var a=new v.ItemResolver;a.resolveItems({items:(i={},i[r.spViewKeyFacet.serialize(B)]=n.__assign(n.__assign(n.__assign(n.__assign({},r.spViewKeyFacet.pack(B)),c.serverViewFacet.pack(u)),c.currentDerivedViewFacet.pack(P)),c.showViewModifiedIndicatorFacet.pack(!1)),i)});if(A){j=r.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},A),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:B}));a.resolveItems({items:(s={},s[j]=n.__assign(n.__assign(n.__assign({},O?h.childItemsFacet.pack(O):{}),M?h.parentItemFacet.pack(M):{}),h.schemaFacet.pack({columnKeys:[]})),s)})}k&&a.resolveItems({items:(o={},o[k]=n.__assign({},r.spViewKeyFacet.pack(B)),o)});return e(a.execute())}).then(function(){var n;return e(p.invalidateItems({items:(n={},n[t]=[h.childItemsFacet],n)}))})]}return[2]})})}})});
define("GF",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFreshViewOperation=new n.Facet("createFreshView");t.createFreshView=r.implementOperation({operationTypeFacet:t.createFreshViewOperation})});
define("IF",["require","exports","ww","Qi","K_","Cs","_F","DF","e9","W3","CS","gU","M","Gi","tc","th","IS","$_","Is"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createView=i.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,i=e.options.views;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R;return n.__generator(this,function(U){b=r.spListViewsSetKeyFacet.deserialize(t);w=Object.keys(i)[0];E=i[w],S=E.sourceView,x=E.isPublic,T=E.itemSetKey,N=E.progressItemKey;if(S&&b){C=e(s.readItem({deserializedItemSetKey:r.spFolderItemSetKeyFacet,filterableSet:p.spFilterableSetFacet,childItems:d.childItemsFacet,parentItem:d.parentItemFacet,schema:d.schemaFacet},T)),k=C.deserializedItemSetKey,L=C.filterableSet,A=C.childItems,O=C.parentItem,M=C.schema;_=k&&k.viewKey&&r.spViewKeyFacet.serialize(k.viewKey)||"";D=e(s.readItem({viewType:p.viewTypeFacet},_)).viewType;(P=k?o.combineItemSetInfoAndView({sourceView:S,deserializedItemSetKey:k,appliedFilters:L&&L.appliedFilters}):S).prepareForSaving();H=a.getListApiUrl({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl}).segment("Views").segment("Add");I=S.getEffectiveAggregatesFieldXml();q=S.viewData,R=S.customFormatter;return[2,e(f.getData({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl,url:H.toString(),method:"POST",body:JSON.stringify({parameters:n.__assign({__metadata:{type:"SP.ViewCreationInformation"},Title:w,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:S.getEffectiveFieldNames()},Query:P.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!x,RowLimit:S.rowLimit},D&&u.ViewTypesSecondary.indexOf(D)>=0?{ViewData:q,ViewType2:D}:{})}),qosName:"addView",noRedirect:!0})).then(function(t){var i,s,o;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var u=t.d;j={viewId:h.default.normalizeLower(u.Id,!1)};B=new l.default(t.d);m.setColumnWidthsFromViewToLocalStorage(B);var a=new g.ItemResolver;a.resolveItems({items:(i={},i[r.spViewKeyFacet.serialize(j)]=n.__assign(n.__assign(n.__assign(n.__assign({},r.spViewKeyFacet.pack(j)),p.serverViewFacet.pack(u)),p.currentDerivedViewFacet.pack(B)),p.showViewModifiedIndicatorFacet.pack(!1)),i)});if(k){F=r.spFolderItemSetKeyFacet.serialize(n.__assign(n.__assign({},k),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:j}));a.resolveItems({items:(s={},s[F]=n.__assign(n.__assign(n.__assign({},A?d.childItemsFacet.pack(A):{}),O?d.parentItemFacet.pack(O):{}),M?d.schemaFacet.pack(M):{}),s)})}N&&a.resolveItems({items:(o={},o[N]=n.__assign({},r.spViewKeyFacet.pack(j)),o)});return e(a.execute())}).then(function(){var r,i;if(S.scope||I||R){var s={};S.scope&&(s.scope=S.scope);e(y.readConfiguration({enableModernColumnTotalsSettings:p.enableModernColumnTotalsSettingsFacet})).enableModernColumnTotalsSettings&&I&&(s.aggregations=I);R&&(s.customFormatter=R);return e(c.modifyView({items:(r={},r[t]={views:(i={},i[B.id]=n.__assign({},s),i)},r)}))}}).then(function(){var i,s;return e(v.invalidateItems({items:n.__assign((i={},i[t]=[d.childItemsFacet],i),I?(s={},s[r.spViewKeyFacet.serialize(j)]=[p.spAggregatesFacet],s):{})}))})]}return[2]})})}})});
define("KF",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createViewOperation=new n.Facet("createView");t.createView=r.implementOperation({operationTypeFacet:t.createViewOperation})});
define("oF",["require","exports","ww","Qi","Jr","Gi","l7","wT","DS","nm","tc","Bc","K_","Cs","CT","cF","zi","M","$_","tC","cc","X4","Gi","Vs","sF"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCustomActionsOperationHandler=h.createSingleItemOperationHandler()(function(e){var t=e.itemKey,i=r.customActionSetKeyFacet.deserialize(t),s=i.webAbsoluteUrl,o=i.listFullUrl;return function(e){var r,i=e(v.getParseCustomActionsContext({webAbsoluteUrl:s,listFullUrl:o}));if(i.listTemplate===m.ListTemplateType.mySiteDocumentLibrary){var u=new y.ItemResolver;u.resolveItems({items:(r={},r[t]=n.__assign({},l.childItemsFacet.pack(void 0)),r)});e(u.execute());return Promise.resolve()}return e(v.getLegacyCustomActionsData(s,o,i)).then(function(n){return e(T.resolveCustomActions({customActionSetKey:t,customActions:n,context:i}))}).then(function(t){return e(t.execute())})}});t.getCustomActionSetWithExtensionsOperationHandler=h.createSingleItemOperationHandler()(L);function N(e){return n.__awaiter(this,void 0,void 0,function(){var t,i,s,o,u,a,c,h,p,v,m;return n.__generator(this,function(g){switch(g.label){case 0:t=e.setKey,i=e.actions,s=e.listViewAdapter;o=new y.ItemResolver;u=[];a=0;c=function(e){var t,i,f,l,c,h,p,v,m,g,y,b;return n.__generator(this,function(n){switch(n.label){case 0:t=[];if(!d.isGroup(e))return[3,5];i=e.children;f=0;l=0,c=i;n.label=1;case 1:if(!(l<c.length))return[3,5];h=c[l];p=h.id?h.id:h.text+a+"."+f;v=r.customActionKeyFacet.serialize({actionId:p});return k(h)&&s?[4,C({action:h,listViewAdapter:s})]:[3,3];case 2:m=n.sent(),b=m.actionKeys,y=m.itemResolver;o.merge(y);b.forEach(function(e){t.push(e)});n.label=3;case 3:t.push(v);f++;n.label=4;case 4:l++;return[3,1];case 5:return!d.isGroup(e)&&k(e)&&s?[4,C({action:e,listViewAdapter:s})]:[3,7];case 6:g=n.sent(),y=g.itemResolver,b=g.actionKeys;o.merge(y);u=u.concat(b);n.label=7;case 7:a++;return[2]}})};h=0,p=i;g.label=1;case 1:if(!(h<p.length))return[3,4];v=p[h];return[5,c(v)];case 2:g.sent();g.label=3;case 3:h++;return[3,1];case 4:o.resolveItems({items:(m={},m[t]=n.__assign(n.__assign({},f.isGroupFacet.pack(!0)),l.childItemsFacet.pack(0===u.length?void 0:{itemKeys:u})),m)});return[2,{itemResolver:o}]}})})}t.addCustomActionSetToCacheWhenSpfxLoaded=N;function C(e){return n.__awaiter(this,void 0,void 0,function(){var t,i,s,o,f,l,h;return n.__generator(this,function(p){switch(p.label){case 0:t=e.action,i=e.listViewAdapter;s=new y.ItemResolver;o=[];f=t.clientSideComponentId&&t.clientSideComponentId.toString()||"";l=t.clientSideComponentProperties||"";return f&&f!==g.default.Empty?[4,i.loadCommandSet(f,l).catch(function(){})]:[2,{itemResolver:s,actionKeys:[]}];case 1:(h=p.sent())&&h.commandAdapters&&h.commandAdapters.forEach(function(e){var i,f=t.clientSideComponentId+"."+e.commandId,l=r.customActionKeyFacet.serialize({actionId:f});s.resolveItems({items:(i={},i[l]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},c.displayNameFacet.pack(e.title)),c.openUrlFacet.pack(t.action)),u.enabledForMultipleItemsFacet.pack(t.allowMultiSelect)),u.isEnabledFunctionFacet.pack(t.isEnabled||!1)),u.iconUrlFacet.pack(e.iconUrl||t.iconUrl)),a.commandAdapterFacet.pack(e)),i)});o.push(l)});return[2,{itemResolver:s,actionKeys:o}]}})})}function k(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==g.default.Empty)||!1}function L(e){var t=this,u=e.itemKey,f=r.customActionSetWithExtensionsKeyFacet.deserialize(u),h=f.webAbsoluteUrl,d=f.listFullUrl,v=f.isSPFXandCustomActionsAvailable,m=f.targetCustomActionSetKey,T=f.itemsScopeItemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,C,k,L,A,O,M,_,D,P;return n.__generator(this,function(H){switch(H.label){case 0:t=new y.ItemResolver;f=r.spListKeyFacet.serialize({webAbsoluteUrl:h,listFullUrl:d});C=e(w.readItems(E.getLoadSpfxAdapterFunction));k=function(){var n;t.resolveItems({items:(n={},n[f]=a.listViewAdapterFacet.pack(void 0),n)});e(t.execute())};if(!v&&!C){k();return[2]}return(A=C)?[4,C()]:[3,2];case 1:A=H.sent();H.label=2;case 2:O=!1;if(!(L=A))return[3,7];M=L.createListViewAdapter();t.resolveItems({items:(P={},P[f]=n.__assign({},M?a.listViewAdapterFacet.pack(M):{}),P)});_=e(p.readItem({rawCustomActions:s.rawCustomActionsFacet},m)).rawCustomActions;return[4,N({setKey:u,actions:_||[],listViewAdapter:M})];case 3:D=H.sent().itemResolver;t.merge(D);return[4,e(b.demandItems(function(e){var u=x.getCurrentItemSetKey(e,T);if(u&&M){var f=e.demandItemFacet(l.childItemsFacet,u),p=f&&f.itemKeys,v=function(i){var s,o=e.isItemFacetResolved(S.rowDataFacet,i)?e.demandItemFacet(S.rowDataFacet,i):void 0;if(o&&M){var u=M.createRowAdapter({values:o});t.resolveItems({items:(s={},s[i]=n.__assign({},u?a.rowAdapterFacet.pack(u):{}),s)})}else if(e.demandItemFacet(r.spItemGroupKeyFacet,i)){var f=e.isItemFacetResolved(l.childItemsFacet,i)?e.demandItemFacet(l.childItemsFacet,i):void 0;if(f)for(var c=0,h=f.itemKeys;c<h.length;c++){var p=h[c];v(p)}}};if(p)for(var m=0,y=p;m<y.length;m++){var b=y[m];v(b)}var w=e.demandItemFacet(l.schemaFacet,u),E=w&&w.columnKeys||[];if(E&&M)for(var N=function(n){var r,u=e.demandItem({fieldId:s.fieldIdFacet,internalName:s.internalNameFacet,realFieldName:s.realFieldNameFacet,fieldType:s.fieldFieldTypeFacet,isRequired:o.isRequiredFacet,displayName:c.displayNameFacet,clientSideComponentId:a.clientSideComponentIdFacet,clientSideComponentProperties:a.clientSideComponentPropertiesFacet},n),f=u.fieldId,l=u.internalName,p=u.realFieldName,v=u.fieldType,m=u.isRequired,y=u.displayName,b=u.clientSideComponentId,w=u.clientSideComponentProperties;if(f&&l){O=!0;var E={listKey:{webAbsoluteUrl:h,listFullUrl:d},internalName:l},S={id:f,internalName:p||l,fieldType:v||"Text",isRequired:m||!1,isVisible:!0,displayName:y||"",clientSideComponentId:b||g.default.Empty,clientSideComponentProperties:w||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+l+",\n                      componentId: "+b+", error: "+e.message)}},x=M.addColumnAdapter(S);if(b&&b!==g.default.Empty){var T=i.spListColumnAdapterKeyFacet.serialize(E);t.resolveItems({items:(r={},r[T]=a.columnAdapterFacet.pack(x),r[n]=a.columnAdapterKeyFacet.pack(T),r)})}}},C=0,k=E;C<k.length;C++){N(k[C])}}}))];case 4:H.sent();return O?[4,M.loadFieldCustomizers()]:[3,6];case 5:H.sent();H.label=6;case 6:return[3,8];case 7:k();H.label=8;case 8:e(t.execute());return[2]}})})}}t.getCustomActionSetWithExtensions=L});
define("fF",["require","exports","ww","K_","p3","Gi"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateColumnFormatter=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,o,u,a,f;return n.__generator(this,function(l){r=Object.keys(t)[0];o=t[r],u=o.updateType,a=o.formatter;return 0===u?[2,e(i.resolveItems({items:(f={},f[r]=n.__assign({},s.customFormatterFacet.pack(a)),f)}))]:[2]})})}})});
define("VF",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.preview=0]="preview";e[e.save=1]="save"})(t.ColumnFormatterUpdateType||(t.ColumnFormatterUpdateType={}));t.updateColumnFormatterOperation=new n.Facet("updateColumnFormatter");t.updateColumnFormatter=r.implementOperation({operationTypeFacet:t.updateColumnFormatterOperation})});
define("RF",["require","exports","ww","K_","p3","Gi","Q4","tC","tc","CD","p4","K8"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:1855};t.updateCustomFormatter=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.formatterMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var p,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:p=Object.keys(r)[0];d=r[p],v=d.updateType,m=d.formatter;return 0!==v?[3,1]:[2,e(i.resolveItems({items:(b={},b[p]=n.__assign({},s.customFormatterFacet.pack(m)),b)}))];case 1:return 2!==v?[3,4]:[4,e(u.demandItems(function(e){e.demandItemFacet(f.customFormatterFeatureFacet,f.customFormatterFeatureKeyFacet.serialize({}))}))];case 2:E.sent();g=!1;y={};return[4,e(u.demandItems(function(e){if(g=l.isFeatureEnabled(e,{feature:h})){var n=e.demandItem({schema:a.schemaFacet},t).schema,r=n&&n.columnKeys;r&&(y=c.getFieldFormatters(e,r))}}))];case 3:E.sent();return[2,e(i.resolveItems({items:(w={},w[p]=n.__assign({},s.viewFormatterFacet.pack(o.getViewFormatterFacetObjFromString({formatter:m,fieldFormatters:y,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:g}}))),w)}))];case 4:return[2]}})})}})});
define("Ek",["require","exports","ww","Qi","K_","Pk","Qi","Gi","W3","Mk","kk","M","Ms","K_","Bc","Q1","cc","Wi","$_","i3","ys","Is","Z4","tc","k","Lk","ga","Ak","nm","P7","To"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDeleteSingleItemUrl=s.getDeleteSingleItemUrl;t.spItemDeleteItemsOperationHandler=i.createBatchedItemsOperationHandler()(D);var M="-2130575306",_="Prefer";function D(e){var t=this;return function(D){return n.__awaiter(t,void 0,void 0,function(){var t,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge,ye,be;return n.__generator(this,function(we){switch(we.label){case 0:t=e.items;P=void 0;H=void 0;B=void 0;j=void 0;F=D(N.getSharePointDataEventSource);I={};q=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n],s=I[i];s&&s.id&&t.push(s.id)}t.length&&C.EventGroup.raise(F,k.SPGridEvents.deleteCompletedEventName,{itemIds:t})};R=[];U=D(E.readConfiguration({enableOverrideDeleteFileLocks:w.enableOverrideDeleteFileLocksFacet,enableDeleteCommandForMountPointConfiguration:u.enableDeleteCommandForMountPointConfigurationFacet})),z=U.enableOverrideDeleteFileLocks,W=U.enableDeleteCommandForMountPointConfiguration;X=function(e){j=t[e].currentItemSetKey;var n=D(m.readItems(function(t){return t.demandItem({key:r.spItemKeyFacet,folder:d.folderFacet,uniqueId:u.uniqueIdFacet,folderPath:u.folderPathFacet,oneNote:g.oneNoteFacet,itemId:u.listItemIdFacet,mountPoint:u.mountPointFacet},e)}));if(n)if(W&&n.mountPoint)R.push(e);else if(n.key&&n.folderPath){H=n.key.webAbsoluteUrl;B=n.key.listFullUrl;if(!P){var i=o.spListKeyFacet.serialize({webAbsoluteUrl:H,listFullUrl:B}),s=D(m.readItems(function(e){return e.demandItemFacet(u.listFacet,i)}));P={webAbsoluteUrl:H,listFullUrl:B,items:[],deletionType:f.default.Recycle,listId:s&&s.id}}var a={key:e,serverRelativeItemUrl:n.folderPath,id:n.itemId,uniqueId:n.uniqueId,isFolder:!!n.folder||!!n.oneNote};P.items.push(a);I[a.key]=a}};for(V=0,$=Object.keys(t);V<$.length;V++){J=$[V];X(J)}if(!(R&&R.length>0))return[3,2];K={currentItemSetKey:j};Q={items:O.makeObject(R,function(){return K})};return[4,D(A.removeFromOneDrive(Q))];case 1:we.sent();we.label=2;case 2:G=P;Y=[];Z=D(m.readItems(function(e){return H&&B?e.demandItemFacet(u.spPageContextFacet,o.spPageContextKeyFacet.serialize({webAbsoluteUrl:H,listFullUrl:B})):void 0}));if(!G||!G.items.length)return[3,7];if(1!==G.items.length)return[3,4];ee=G.items[0];te=s.getDeleteSingleItemUrl({webAbsoluteUrl:G.webAbsoluteUrl,listFullUrl:G.listFullUrl,deletionType:G.deletionType,listId:G.listId,serverRelativeItemUrl:ee.serverRelativeItemUrl,uniqueId:ee.uniqueId,isFolder:!!ee.isFolder,itemId:ee.id});ne={};G.deletionType===f.default.PermanantDelete&&(ne["X-HTTP-Method"]="DELETE");fe=t[Object.keys(t)[0]];(re=!!fe.breakLock)&&(ne[_]="bypass-shared-lock");return[4,D(a.getData({webAbsoluteUrl:G.webAbsoluteUrl,listFullUrl:B||"",url:te,body:void 0,method:"POST",additionalHeaders:ne,qosName:"deleteSingleItem",telemetryHandler:function(e){var t=e.errorData,r=e.eventData;if(t){var i=t.status===h.STATUS_CODE_ZERO||z&&t.code&&t.code.indexOf(M)>-1?b.ResultType.expectedFailure:b.ResultType.failure;return{eventData:n.__assign(n.__assign({},r),{resultType:i})}}return{eventData:r}}})).then(function(){Y.push(ee.key);q(Y)}).catch(function(e){if(e instanceof a.GetDataError){if(e.code&&e.code.indexOf(M)>-1){z&&D(S.logEngagement({name:"DeleteOperationFileLockedWithForcedDeleteEnabled",isIntentional:!1,extraData:{errorCode:e.code,overrideFileLocksEnabled:z,isBatch:!1}}));throw new h.ItemOperationError({innerError:e,facets:n.__assign({},v.fileLockedErrorFacet.pack({}))})}re&&D(S.logEngagement({name:"DeleteOperationOverrideFilelockedFailed",isIntentional:!1,extraData:{errorCode:e.code,overrideFileLocksEnabled:z,isBatch:!1}}));if(e.errorData.status===h.STATUS_CODE_ZERO)throw new h.ItemOperationError({innerError:e,facets:n.__assign({},v.offlineErrorFacet.pack({}))})}throw e})];case 3:we.sent();return[3,6];case 4:if(!(G.items.length>1))return[3,6];ie=c.default.generate();se="multipart/mixed; boundary=batch_"+ie;return[4,D(a.getData({webAbsoluteUrl:G.webAbsoluteUrl,listFullUrl:B||"",url:l.DataBatchOperationHelper.getBatchOperationUrl(G.webAbsoluteUrl),body:i(G,ie),method:"POST",additionalHeaders:void 0,contentType:se,parseResponse:function(e){return l.DataBatchOperationHelper.processBatchResponse(e,G.items)},qosName:"deleteMultipleItems"})).then(function(e){for(var t=0,r=e.items;t<r.length;t++){!(u=r[t]).error&&u.key&&Y.push(u.key)}q(Y);if(e.hasError){for(var i={items:{}},s=0,o=e.items;s<o.length;s++){var u;if((u=o[s]).error&&u.key){var a=u.error.code&&u.error.code.toString()===M;z&&D(S.logEngagement({name:"DeleteOperationFileLockedInBatchWithForcedDeleteEnabled",isIntentional:!1,extraData:{errorCode:u.error.code,overrideFileLocksEnabled:z,isBatch:!0}}));i.items[u.key]=new h.ItemOperationError({message:u.error.message,facets:a?n.__assign({},v.fileLockedErrorFacet.pack({})):void 0})}}throw new p.BatchedItemsOperationHandlerError(i)}return Promise.resolve({data:e})})];case 5:we.sent();we.label=6;case 6:oe=new y.ItemResolver;for(ue=0,ae=G.items;ue<ae.length;ue++){fe=ae[ue];oe.invalidateItems({items:(ge={},ge[fe.key]=[d.deletedFacet],ge)});oe.resolveItems({items:(ye={},ye[fe.key]=d.deletedFacet.pack({}),ye)})}le=!Z||!T.getKillSwitch(Z).isActivated("C5C6F559-B975-4336-BEFB-0483A5A24929","02/14/2020","Resolve remaining items for current itemSet after delete to avoid going back to first page for current itemSet.");ce=!Z||!T.getKillSwitch(Z).isActivated("53BF5F56-AF6E-4509-AB0C-6E6F3923C492","08/07/2020","Do not resolve remaining items for current itemSet after delete for group by view");le&&j&&Y.length&&(he=D(m.readItems(function(e){var t=e.demandItemFacet(x.childItemsFacet,j);if(t&&t.itemKeys){for(var n=[],i=0,s=t.itemKeys;i<s.length;i++){var u=s[i];if(ce&&o.spItemGroupKeyFacet.matches(u))return;var a=e.demandItemFacet(r.spItemKeyFacet,u),f=a&&r.spItemKeyFacet.serialize(a)||u;Y.indexOf(f)<0&&n.push(u)}return n}})))&&oe.resolveItems({items:(be={},be[j]=x.childItemsFacet.pack({itemKeys:he}),be)});if(!Z||!T.getKillSwitch(Z).isActivated("126A8F89-8146-4B38-A8DE-6F115DCF594C","03/26/2020","Invalidate parent folder countFacet of the deleted items")){pe=function(e){var t,n=D(m.readItems(function(t){return t.demandItemFacet(d.parentFolderItemFacet,e)}));n&&n.itemKey&&oe.invalidateItems({items:(t={},t[n.itemKey]=[L.countFacet],t)})};for(de=0,ve=Y;de<ve.length;de++){me=ve[de];pe(me)}}D(oe.execute());we.label=7;case 7:return[2]}})})};function i(e,t){var n=e.items,r=e.deletionType===f.default.PermanantDelete?"DELETE":"POST",i=e.deletionType===f.default.PermanantDelete?"If-Match: *":l.DataBatchOperationHelper.defaultBatchRequestPostData,o=n.map(function(t){return s.getDeleteSingleItemUrl({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,deletionType:e.deletionType,serverRelativeItemUrl:t.serverRelativeItemUrl,uniqueId:t.uniqueId,isFolder:t.isFolder,listId:e.listId,itemId:t.id})});return l.DataBatchOperationHelper.getBatchContentExtended(t,o,r,i)}}t.deleteItemsCore=D});
define("Pk",["require","exports","e9","Mk"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDeleteSingleItemUrl=function(e){var t=e.webAbsoluteUrl,i=e.listFullUrl,s=e.serverRelativeItemUrl,o=e.deletionType,u=e.uniqueId,a=e.isFolder,f=e.listId,l=e.itemId,c=n.getWebApiUrl({webAbsoluteUrl:t,listOrItemFullUrl:i});c=a?u?c.method("GetFolderById",u):c.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:s}):f&&l?c.method("Lists",f).method("GetItemById",l):c.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:s});o===r.default.Recycle&&(c=c.segment("recycle"));return c.toString()}});
define("kP",["require","exports","ww","K_","p3","Gi"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveTemplatesToView=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.templates;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var o;return n.__generator(this,function(u){e(i.resolveItems({items:(o={},o[t]=n.__assign({},s.newDocumentTemplatesFacet.pack(r)),o)}));return[2]})})}})});
define("MP",["require","exports","ww","K_","Bc","Cs","p3","Gi","Qi","JP","PP"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveUploadedTemplateToView=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.childItemKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){c=e(s.readItem({deserializedItemKey:a.spItemKeyFacet,displayName:i.displayNameFacet},r)),h=c.deserializedItemKey,p=c.displayName;if(h&&p){d=e(s.readItem({contentTypeKeys:u.contentTypeKeysFacet},t)).contentTypeKeys;v=[];d&&d.length&&d.forEach(function(t){var n=e(s.readItem({contentType:u.spListContentTypeFacet},t)).contentType;n&&v.push(n)});m=v.length?v[0].contentTypeId:void 0;g=p.replace(/\.[^.]+$/,"");if(!(y={contentTypeId:m,isUpload:!0,templateId:g,title:g,url:h.itemId,visible:!0}).url)throw new Error("No template URL to save.");if((b=e(s.readItem({defaultView:u.defaultViewFacet},t)).defaultView)&&b.viewKey){w=b.viewKey;E=e(s.readItem({existingTemplates:u.newDocumentTemplatesFacet},t)).existingTemplates,S=void 0===E?[]:E;(x=n.__spreadArrays(S)).length||(T=e(s.readItem({newCommands:l.newDocumentTemplateCommandsFacet},t)).newCommands)&&T.forEach(function(e){var t=e.contentTypeId,n=e.isContentType,r=e.templateId,i=e.title,s=e.visible;x.push({contentTypeId:t,isContentType:n,templateId:r,title:i,visible:s})});x.filter(function(e){return e.url===y.url}).length>0||x.push(n.__assign({},y));N=a.spListKeyFacet.deserialize(t);C=a.spNewDocumentTemplateKeyFacet.serialize({templateUrl:y.url,listKey:N});e(o.resolveItems({items:(k={},k[t]=n.__assign({},u.newDocumentTemplatesFacet.pack(x)),k[C]=n.__assign({},u.newDocumentTemplateFacet.pack(y)),k)}));return[2,e(f.saveViewCore({items:(L={},L[a.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl})]={views:(A={},A[w]={newDocumentTemplatesJsonString:JSON.stringify(x)},A),qosName:"saveNewTemplatesToDefaultView"},L)}))]}}return[2]})})}})});
define("Uk",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveUploadedTemplateToViewOperation=new n.Facet("saveUploadedTemplateToView");t.saveUploadedTemplateToView=r.implementOperation({operationTypeFacet:t.saveUploadedTemplateToViewOperation})});
define("xF",["require","exports","ww","Qi","CF","W3","u4","X3","K_","tc","p3","Gi","cc","KU","To","th","Bc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MAX_PINNED_ITEM_COUNT=3;var g=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.resultType,i=void 0===r?8:r;n.resultType=i;return n}return t})(u.CustomError);t.EditPinnedItemError=g;t.editPinnedItem=a.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var u=e.itemKey,a=e.options.itemEditTypeMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I;return n.__generator(this,function(q){switch(q.label){case 0:y=Object.keys(a)[0];b=a[y].editType;return[4,e(p.getSPItemInfo(y))];case 1:w=q.sent(),E=w.key,S=w.itemId;x=e(h.readItems(function(e){return e.demandItem({deserializedPinnedItemSetKey:r.spPinnedItemSetKeyFacet,pinnedItems:f.childItemsFacet},u)})),T=x.deserializedPinnedItemSetKey,N=x.pinnedItems;T||(T=r.spPinnedItemSetKeyFacet.deserialize(u));if(!E||!T||!S)throw new g({resultType:5});if(!(E&&T&&S))return[3,3];C="";"";T.viewKey&&(C=T.viewKey.viewId);k=T.parentItemKey.rootFolder||new o.SimpleUri(T.parentItemKey.listFullUrl).path;L=void 0;(A=N&&N.itemKeys||[])&&(O=A.indexOf(y))>-1&&(2===b&&O>=2?L=A[O-2]:3===b&&O<A.length-1&&(L=A[O+1]));M=void 0;L&&(M=e(h.readItems(function(e){return e.demandItemFacet(c.listItemIdFacet,L)})));_={webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl,itemId:S,editType:b,viewId:C,rootFolder:k,afterItemId:M};u&&(D=(function(e,t,n,r){var i=r.editType,s=[];(0===i||void 0===n&&1!==i)&&s.push(e);for(var o=0,u=t;o<u.length;o++){var a=u[o];a!==e&&s.push(a);a===n&&s.push(e)}return s})(y,A,L,_)).length<=t.MAX_PINNED_ITEM_COUNT&&e(l.resolveItems({items:n.__assign((F={},F[u]=n.__assign({},f.childItemsFacet.pack({itemKeys:D})),F),d.makeObject(D,function(){return n.__assign({},v.getInvalidationFacet().forFacet(m.deletedFacet).thenInvalidate(u,f.childItemsFacet).pack())}))}));return(P=i.getEditPinnedItemUrl(_))?[4,e(s.getData({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl,url:P,method:"POST",additionalHeaders:void 0,qosName:"editPinnedItem",noRedirect:!0}))]:[3,3];case 2:H=q.sent();if(0!==(B=i.parseEditPinnedItemResponse(H)).resultType){j=(function(e,t){var i=[];if(e.order)for(var s=0,o=e.order;s<o.length;s++){var u=o[s];i.push(r.spItemKeyFacet.serialize(n.__assign(n.__assign({},t),{itemId:u.toString()})))}return i})(B,E);e(l.resolveItems({items:n.__assign((I={},I[u]=n.__assign({},f.childItemsFacet.pack({itemKeys:j})),I),d.makeObject(j,function(){return n.__assign({},v.getInvalidationFacet().forFacet(m.deletedFacet).thenInvalidate(u,f.childItemsFacet).pack())}))}));throw new g({resultType:B.resultType})}q.label=3;case 3:return[2]}})})}})});
define("YF",["require","exports","qi","Ms","Z_","Ji"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.editPinnedItemOperation=new n.Facet("editPinnedItem");t.editPinnedItemProgressItemKeyFacet=new s.KeyFacet("editPinnedItemProgressItem",{itemKey:s.stringPart(),editType:s.numberPart()});t.editPinnedItemProgressKeyFacet=new i.ProgressKeyFacet("editPinnedItemProgress",function(e,n){var r=Object.keys(n.itemEditTypeMap)[0],i=n.itemEditTypeMap[r].editType;return t.editPinnedItemProgressItemKeyFacet.serialize({itemKey:r,editType:i})});t.editPinnedItem=r.implementOperation({operationTypeFacet:t.editPinnedItemOperation})});
define("VKe",["require","exports","ww","we","HT","K_","kb","G_","Z_","tc","ih","YF","Bc","z_"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d,v,m,g;Object.defineProperty(t,"__esModule",{value:!0});var y=((d={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.pinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},d),b=((v={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.unpinItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},v),w=((m={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveLeftItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},m),E=((g={})[l.ProgressPhase.started]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemStartedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g[l.ProgressPhase.completed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemCompletedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g[l.ProgressPhase.failed]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g[l.ProgressPhase.canceled]=function(e){return r.format(r.getLocalizedCountValue(i.default.moveRightItemFailedItemsTitle,i.default.editPinCompletedItemsTitleIntervals,e)||"",e)},g);t.editPinnedItemProgressAddon=s.createAddon(function(){return function(e){e(o.registerControlHandler(c.editPinnedItemProgressKeyFacet,u.progressControl)(o.createControlHandler()(S)));e(o.registerControlHandler(c.editPinnedItemProgressKeyFacet,p.progressCommandSummaryControl)(o.createControlHandler()(x)))}});function S(){return function(e){return function(e,t){var r,i=t.itemKey,s=t.format,o=a.getOverallSimpleProgressBreakdown(e,t),u=o.phase,l=o.count,p=void 0,d=e.demandItemFacet(f.childItemsFacet,i),v=d&&d.itemKeys,m=0;if(v&&v.length>0){var g=e.demandItemFacet(c.editPinnedItemOperation,v[0]);if(g&&g.itemEditTypeMap){var S=g.itemEditTypeMap;for(var x in S)if(x&&S[x]){m=S[x].editType;break}}switch(m){case 0:p=y;break;case 1:p=b;break;case 3:p=E;break;case 2:p=w}r=p&&p[u](l)}else if("item"===s){var T=e.demandItemFacet(c.editPinnedItemProgressKeyFacet,i),N=T&&T.taskKey;if(N){var C=e.demandItemFacet(c.editPinnedItemProgressItemKeyFacet,N),k=C&&C.itemKey;if(k){r=e.demandItemFacet(h.displayNameFacet,k)}}}return n.__assign({},r&&"item"!==t.format?{title:r}:{})}}}function x(){return function(){return function(){return{reportMode:"pin"}}}}});
define("aT",["require","exports","ww","r","Qi","Gi","iT","p3","K_","Cs"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getContentTypeNavigationActionItemOperationHandler=a.createSingleItemOperationHandler()(function(e){var t=this,a=e.itemKey,l=i.spContentTypeNavigationActionKeyFacet.deserialize(a);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,c,h,p;return n.__generator(this,function(d){t=e(f.readItem({listFacets:s.listFacet},i.spListKeyFacet.serialize(l.listKey))).listFacets;c=i.spListContentTypeKeyFacet.serialize({listKey:{webAbsoluteUrl:l.listKey.webAbsoluteUrl,listFullUrl:l.listKey.listFullUrl},contentTypeId:l.contentTypeId});h=!!t&&t.openInClient;e(u.resolveItems({items:(p={},p[a]=n.__assign({},s.actionFacet.pack(function(){return r.createElement(o.ContentTypeNavigationAction,{contentTypeId:l.contentTypeId,openInClient:h,contentTypeKey:c})})),p)}));return[2]})})}})});
define("dF",["require","exports","ww","lF","Gi","Qi","K_","tc","Cs","Is","ys","IS","$_","cc","oS"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getViewsItemOperationHandler=o.createSingleItemOperationHandler({maxParallelOperationCount:8})(function(e){var t=this,o=e.itemKey,v=s.spListViewsSetKeyFacet.deserialize(o),m=v.webAbsoluteUrl,g=v.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,y,b,w,E,S,x,T,N,C;return n.__generator(this,function(k){switch(k.label){case 0:t=[];y=new h.ItemResolver;b=s.spListKeyFacet.serialize({webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl});w=e(a.readItem({list:i.listFacet},b));E=e(f.readConfiguration({localeConfiguration:l.localeFacet})).localeConfiguration;return[4,e(r.getViewData({webAbsoluteUrl:m,listFullUrl:g,listTemplate:w.list&&w.list.templateType,preferredLanguage:E&&E.language}))];case 1:S=k.sent();x={};T=void 0;S.filter(function(e){return!!e.view}).map(function(r){var o,u=r.serverView,a=r.view,f={viewId:a.id},l=s.spViewKeyFacet.serialize(f);if(a.isDefault){T=l;var h=a.getDomParts().newDocumentTemplates;h&&h.textContent&&y.merge(d.processNewDocumentTemplates({webAbsoluteUrl:m,listFullUrl:g,newDocumentTemplatesString:h.textContent}).itemResolver)}x[l]=a;c.setColumnWidthsFromViewToLocalStorage(a);var v=e(p.readItems(function(e){if(e.isItemFacetResolved(i.currentDerivedViewFacet,l))return e.demandItemFacet(i.currentDerivedViewFacet,l)})),b=!!v&&v.getEffectiveViewXml().replace(/ \/>/g,"/>")===a.getEffectiveViewXml().replace(/ \/>/g,"/>");y.resolveItems({items:(o={},o[l]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},s.spViewKeyFacet.pack(f)),i.serverViewFacet.pack(u)),b?{}:i.currentDerivedViewFacet.pack(a)),i.showViewModifiedIndicatorFacet.pack(!1)),i.viewTypeFacet.pack(a.viewType)),o)});t.push(l)});t.sort(function(e,t){return x[e].compareTo(x[t])});y.resolveItems({items:(N={},N[o]=n.__assign(n.__assign({},s.spListViewsSetKeyFacet.pack(v)),u.childItemsFacet.pack({itemKeys:t})),N)});T&&y.resolveItems({items:(C={},C[b]=n.__assign({},i.defaultViewFacet.pack({viewKey:T})),C)});e(y.execute());return[2]}})})}})});
define("wF",["require","exports","ww","W3","Qi","Gi","K_","th","Bc","cc","KU","e9"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateItemLikes=o.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,o=e.options;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g,y,b;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(l.getSPItemInfo(t))];case 1:h=n.sent(),p=h.key,d=h.itemId;v=p.webAbsoluteUrl,m=p.listFullUrl;g=i.spListKeyFacet.serialize({webAbsoluteUrl:v,listFullUrl:m});return(y=e(f.readItems(function(e){return e.demandItemFacet(s.listFacet,g)})))&&y.id&&d?[4,e(r.getData({webAbsoluteUrl:v,listFullUrl:m,url:c.getStaticApiUrl({webAbsoluteUrl:v}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:y.id,itemID:d,like:o.liked}).toString(),method:"POST",qosName:"updateLikes"}))]:[3,3];case 2:n.sent();e(u.invalidateItems({items:(b={},b[t]=[a.displayNameFacet],b)}));n.label=3;case 3:return[2]}})})}})});
define("WF",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateItemLikesOperation=new n.Facet("updateItemLikes");t.updateItemLikes=r.implementOperation({operationTypeFacet:t.updateItemLikesOperation})});
define("pF",["require","exports","ww","Qi","K_","Cs","Gi","tc","$_","p4","cc","JP","fe","to"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyColumn=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.columnModifyTypeMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H;return n.__generator(this,function(B){switch(B.label){case 0:if(!(d=e(s.readItem({setKey:r.spFolderItemSetKeyFacet},t)).setKey))return[3,3];v=Object.keys(i)[0];m=i[v],g=m.modifyType,y=m.targetIndex;if(!(b=d.viewKey?r.spViewKeyFacet.serialize(d.viewKey):void 0))return[3,3];if(!(w=e(s.readItem({currentDerivedView:o.currentDerivedViewFacet},b)).currentDerivedView))return[3,3];E=w.getEffectiveFieldNames();if(!(S=e(s.readItem({internalName:o.internalNameFacet},v)).internalName))return[3,3];if((x=E.indexOf(S))<0||1===g&&0===x||2===g&&x===E.length-1)return[2];T=w.isDirty();switch(g){case 0:w.updateField(S);break;case 1:w.updateField(S,x-1);break;case 2:w.updateField(S,x+1);break;case 3:w.updateField(S,y)}N={ODB:1318};C=e(l.readItems(function(e){return e.demandItemFacet(o.spPageContextFacet,r.spPageContextKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}))}));k=e(l.readItems(function(e){return{isAutoSaveEnabled:f.isFeatureEnabled(e,{feature:N,pageContext:C}),list:e.demandItemFacet(o.listFacet,p.spListKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}))}})),L=k.isAutoSaveEnabled,A=k.list;O=!1;return L&&A&&A.permissions&&A.permissions.manageLists?[4,e(c.saveViewCore({items:(_={},_[r.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl})]={views:(D={},D[b]={shouldSaveViewFieldsOnly:!0},D),qosName:"autoSaveModifyColumn"},_)})).then(function(){T||(w.baseViewXml=w.getEffectiveViewXml());O=!0},function(e){h.default.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:S,modifyType:g,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:B.sent();B.label=2;case 2:M=new a.ItemResolver;L&&O||M.resolveItems({items:(P={},P[b]=n.__assign({},o.showViewModifiedIndicatorFacet.pack(!0)),P)});M.invalidateItems({items:(H={},H[t]=[u.childItemsFacet],H[b]=[o.currentDerivedViewFacet],H)});e(M.execute());B.label=3;case 3:return[2]}})})}})});
define("rH",["require","exports","ww","oH","K_","kb","G_","z_","dk","Z_","tc","ih","iH","Gi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d;Object.defineProperty(t,"__esModule",{value:!0});var v=((d={})[c.ProgressPhase.started]=r.default.columnOperationStarted,d[c.ProgressPhase.completed]=r.default.columnOperationCompleted,d[c.ProgressPhase.failed]=r.default.columnOperationFailed,d);t.modifyColumnProgressAddon=i.createAddon(function(){return function(e){e(s.registerControlHandler(h.modifyColumnProgressKeyFacet,o.progressControl)(s.createControlHandler()(m)));e(s.registerControlHandler(h.modifyColumnProgressKeyFacet,u.progressCommandSummaryControl)(s.createControlHandler()(g)));e(s.registerControlHandler(h.modifyColumnProgressKeyFacet,a.progressListGroupControl)(s.createControlHandler()(y)))}});function m(){return function(e){return function(e,t){var r,i=t.itemKey,s=t.format,o=f.getOverallSimpleProgressBreakdown(e,t).phase,u=void 0,a=e.demandItemFacet(l.childItemsFacet,i),c=a&&a.itemKeys;if(c&&c.length>0)r=(u=v)&&u[o];else if("item"===s){var d=e.demandItemFacet(h.modifyColumnProgressKeyFacet,i),m=d&&d.taskKey;if(m){var g=e.demandItemFacet(h.modifyColumnProgressItemKeyFacet,m),y=g&&g.columnKey;if(y){r=e.demandItemFacet(p.internalNameFacet,y)}}}return n.__assign({},r?{title:r}:{})}}}function g(){return function(e){return function(e,t){return{reportMode:u.ProgressSummaryReportMode.pin}}}}function y(){return function(e){return function(e,t){return{maxChildItemCount:0}}}}});
define("iH",["require","exports","Z_","Ji"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyColumnProgressItemKeyFacet=new r.KeyFacet("modifyColumnProgressItem",{columnKey:r.stringPart(),modifyType:r.numberPart(),targetIndex:r.numberPart()});t.modifyColumnProgressKeyFacet=new n.ProgressKeyFacet("modifyColumnProgress",function(e,n){var r=Object.keys(n.columnModifyTypeMap)[0],i=n.columnModifyTypeMap[r].modifyType,s=n.columnModifyTypeMap[r].targetIndex;return t.modifyColumnProgressItemKeyFacet.serialize({columnKey:r,modifyType:i,targetIndex:s})})});
define("aH",["require","exports","$8","Z_","rH","iH"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyColumnWithProgress=r.implementOperationWithProgress({operationTypeFacet:n.modifyColumnOperation,progressKeyFacet:s.modifyColumnProgressKeyFacet,initializeBatch:function(){return i.modifyColumnProgressAddon}})});
define("qU",["require","exports","ww","Qi","K_","Cs","Gi","tc","$_","JP","_S","fe","CS"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyColumnAggregateType=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options,p=i.aggregateType,d=i.columnKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,v,m,g,y,b,w,E,S,x,T,N,C;return n.__generator(this,function(n){switch(n.label){case 0:if(!(i=e(s.readItem({setKey:r.spFolderItemSetKeyFacet},t)).setKey))return[3,2];if(!(v=i.viewKey?r.spViewKeyFacet.serialize(i.viewKey):void 0))return[3,2];if(!(m=e(s.readItem({currentDerivedView:o.currentDerivedViewFacet},v)).currentDerivedView))return[3,2];g=e(s.readItem({internalName:o.internalNameFacet,fieldType:o.fieldTypeFacet,fieldFieldType:o.fieldFieldTypeFacet},d)),y=g.internalName,b=g.fieldType,w=g.fieldFieldType;if(!y)return[3,2];E=e(s.readItem({spFolderAggregates:o.columnTotalsFacet},t)).spFolderAggregates;S=m.isDirty();if(!(x=E&&E[d]?E[d].aggregateFunctionType:void 0)&&0===p||x===l.ColumnAggregateTypeName[p])return[2];T=0===p?void 0:l.ColumnAggregateTypeName[p];m.updateColumnAggregateType(y,T);return[4,e(f.saveViewCore({items:(N={},N[r.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})]={views:(C={},C[v]={shouldSaveAggregationsOnly:!0},C),qosName:"SaveModifyColumnAggregateType"},N)})).then(function(){var n,r=m.getEffectiveViewXml(),i=new h.default(m.baseViewXml||"");i.replaceAggregates(m.getEffectiveAggregatesData());m.baseViewXml=i.getEffectiveViewXml();m.setDom(r);m.setIsDirty(S);var s=new a.ItemResolver;s.invalidateItems({items:(n={},n[t]=[u.childItemsFacet],n[v]=[o.spAggregatesFacet],n)});e(s.execute())},function(e){c.default.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:b,fieldFieldType:w,currentAggregateType:x||"None",newAggregateType:T||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});m.updateColumnAggregateType(y,x);m.setIsDirty(S);throw e})];case 1:n.sent();n.label=2;case 2:return[2]}})})}})});
define("WU",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyColumnAggregateTypeOperation=new n.Facet("modifyColumnAggregateType");t.modifyColumnAggregateType=r.implementOperation({operationTypeFacet:t.modifyColumnAggregateTypeOperation})});
define("FF",["require","exports","ww","Qi","K_","e9","Cs","Gi","W3","SS","p3","Bc"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyFieldProperties=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.fields;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g,y,b,w;return n.__generator(this,function(E){h=Object.keys(i)[0];p=i[h],d=p.displayName,v=p.fieldDescription,m=p.showInFiltersPane;if((g=e(o.readItem({setKey:r.spFolderItemSetKeyFacet},t)).setKey)&&h&&(y=e(o.readItem({id:u.fieldIdFacet},h)).id)){b={__metadata:{type:"SP.Field"},Title:d,SchemaXml:v,ShowInFiltersPane:m};w=s.getListApiUrl({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl}).method("Fields",y).toString();return[2,e(a.getData({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl,url:w,qosName:"modifyFieldProperties",body:JSON.stringify(b),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(l.resolveItems({items:(t={},t[h]=n.__assign(n.__assign({},void 0!==m?f.showInFiltersPaneStatusFacet.pack(m):{}),void 0!==d?c.displayNameFacet.pack(d):{}),t)}))})]}return[2]})})}})});
define("HF",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyFieldPropertiesOperation=new n.Facet("modifyFieldProperties");t.modifyFieldProperties=r.implementOperation({operationTypeFacet:t.modifyFieldPropertiesOperation})});
define("vF",["require","exports","ww","Qi","K_","Cs","e9","W3","tc","Gi","$_"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyView=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.views,c=r.spListViewsSetKeyFacet.deserialize(t),h=Object.keys(i)[0];return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var p,d,v;return n.__generator(this,function(m){if(c&&h){p=i[h];d=o.getListApiUrl({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl}).method("Views",h);v={__metadata:{type:"SP.View"},DefaultView:p.isDefault,Title:p.title};"number"==typeof p.scope&&(v.Scope=p.scope);if(p.aggregations){v.Aggregations=p.aggregations;v.AggregationsStatus="On"}p.customFormatter&&(v.CustomFormatter="<![CDATA["+p.customFormatter+"]]>");return[2,e(u.getData({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,url:d.toString(),method:"POST",body:JSON.stringify(v),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var i,o,u=e(s.readItem({childItems:a.childItemsFacet},t)).childItems;if(u){for(var c=new l.ItemResolver,d=r.spViewKeyFacet.serialize({viewId:h}),v=void 0,m=void 0,g=void 0,y=0,b=u.itemKeys;y<b.length;y++){var w=b[y],E=e(s.readItem({view:f.currentDerivedViewFacet},w)).view;if(E){if(E.isDefault){v=E;m=w}w===d&&(g=E)}}if("boolean"==typeof p.isDefault){if(p.isDefault&&v&&m){v.isDefault=!1;c.resolveItems({items:(i={},i[m]=n.__assign({},f.currentDerivedViewFacet.pack(v)),i)})}if(g&&d){g.isDefault=p.isDefault;c.resolveItems({items:(o={},o[d]=n.__assign({},f.currentDerivedViewFacet.pack(g)),o)})}}return e(c.execute())}})]}return[2]})})}})});
define("gU",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.modifyViewOperation=new n.Facet("modifyView");t.modifyView=r.implementOperation({operationTypeFacet:t.modifyViewOperation})});
define("AF",["require","exports","ww","W3","Qi","Gi","K_","Cs","p3","GM","KM","e9"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.publishItem=o.createBatchedItemsOperationHandler()(function(e){var t=e.items;return function(o){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return n.__generator(this,function(D){switch(D.label){case 0:h=void 0;p=void 0;d="";v=!0;for(m=0,g=Object.keys(t);m<g.length;m++){A=g[m];y=o(u.readItem({key:i.spItemKeyFacet,folderPath:s.folderPathFacet},A));b=o(u.readItem({key:i.spItemKeyFacet,uiVersion:s.uiVersionFacet,contentTypeId:s.contentTypeIdFacet},A)),w=b.uiVersion,E=b.contentTypeId;d=l.getNextPublishedVersion(w);v=l.isSitePage(E);S=e.items[A];x=o(u.readItem({listItemId:s.listItemIdFacet},A)).listItemId;if(y&&y.key&&y.folderPath){if(!h){p=y.key.listFullUrl;h={webAbsoluteUrl:y.key.webAbsoluteUrl,items:[],publishActionType:S.publishActionType,publishText:S.publishText};p=y.key.listFullUrl}h.items.push({key:A,itemFullUrl:y.folderPath,listItemId:x})}}if(!(T=h)||!T.items.length)return[3,4];N=T.publishActionType===f.PublishActionType.SchedulePublish;C=N?"ScheduleItem":"PublishItem";k=0;D.label=1;case 1:if(!(k<T.items.length))return[3,4];L=T.items[k];A=L.key;O=v&&T.publishActionType!==f.PublishActionType.CancelApproval;M=O?(function(e,t,n){return e+"/_api/sitepages/pages("+t+")/"+(n?"schedulepublish":"publish")})(T.webAbsoluteUrl,L.listItemId,N):(function(e,t,n){var r="Publish";n&&n===f.PublishActionType.CancelApproval&&(r="UnPublish");var i=c.getWebApiUrl({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(i=i.segment(r)).toString()})(T.webAbsoluteUrl,T.items[0].itemFullUrl,T.publishActionType);return[4,o(r.getData({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:p,url:M,body:!N&&O?'{"__metadata":{"type":"SP.Publishing.SitePage"}}':"",method:"POST",qosName:C}))];case 2:D.sent();""!==d&&o(a.resolveItems({items:(_={},_[A]=n.__assign({},s.uiVersionFacet.pack(d)),_)}));D.label=3;case 3:k++;return[3,1];case 4:return[2]}})})}})});
define("JM",["require","exports","qi","Z_"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updatePublishStateOperation=new n.Facet("updatePublishState");t.publishProgressKeyFacet=new r.ProgressKeyFacet("publish")});
define("qF",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateItemRatingOperation=new n.Facet("updateItemRating");t.updateItemRating=r.implementOperation({operationTypeFacet:t.updateItemRatingOperation})});
define("EF",["require","exports","ww","W3","Qi","Gi","K_","th","Bc","cc","KU","e9"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateItemRating=o.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,o=e.options;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g,y,b;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(l.getSPItemInfo(t))];case 1:h=n.sent(),p=h.key,d=h.itemId;v=p.webAbsoluteUrl,m=p.listFullUrl;g=i.spListKeyFacet.serialize({webAbsoluteUrl:v,listFullUrl:m});return(y=e(f.readItems(function(e){return e.demandItemFacet(s.listFacet,g)})))&&y.id&&d?[4,e(r.getData({webAbsoluteUrl:v,listFullUrl:m,url:c.getStaticApiUrl({webAbsoluteUrl:v}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:y.id,itemID:d,rating:o.userNewRating}).toString(),method:"POST",qosName:"updateRating"}))]:[3,3];case 2:n.sent();e(u.invalidateItems({items:(b={},b[t]=[a.displayNameFacet],b)}));n.label=3;case 3:return[2]}})})}})});
define("jU",["require","exports","ww","K_"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameItem=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(t){return function(r){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["gk"],t,n)})];case 1:return[4,(0,n.sent().renameItemCore)(r,t)];case 2:n.sent();return[2]}})})}})});
define("gk",["require","exports","ww","W3","Qi","Ke","u4","$7","Ms","i3","th","Bc","Q1","p3","cc","e9","Gi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g="-2130575257",y="-2147024894",b="-2147024891";t.renameItemCore=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z;return n.__generator(this,function(W){switch(W.label){case 0:w=t.itemKey,E=t.options.names;S=Object.keys(E)[0];x=E[S].newName;T=e(d.readItems(function(e){return e.demandItem({existingFileName:c.fileNameFacet,spItemKey:i.spItemKeyFacet,listItemId:m.listItemIdFacet,isFolder:c.folderFacet},w)})),N=T.existingFileName,C=T.spItemKey,k=T.listItemId,L=T.isFolder;A=C||i.spItemKeyFacet.deserialize(w);if(!(O=k||A.itemId))throw new Error("Cannot find itemId for itemKey: "+w);M=A.rootFolder||new o.SimpleUri(A.listFullUrl).path;_=new s.ItemUrlHelperBasic({context:{webAbsoluteUrl:A.webAbsoluteUrl,listUrl:A.listFullUrl}});D=_.getUrlParts({path:M});P=_.getUrlParts({path:A.webAbsoluteUrl});H=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return v.getListApiUrl({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).toString()})({webAbsoluteUrl:A.webAbsoluteUrl,listFullUrl:A.listFullUrl,itemId:O});B={};return(j=P.serverRelativeItemUrl)?[3,2]:[4,e(r.getData({webAbsoluteUrl:A.webAbsoluteUrl,listFullUrl:A.listFullUrl,url:(X={webAbsoluteUrl:A.webAbsoluteUrl,listFullUrl:A.listFullUrl},V=X.webAbsoluteUrl,$=X.listFullUrl,J=v.getListApiUrl({webAbsoluteUrl:V,listFullUrl:$}).segment("ParentWeb").segment("ServerRelativeUrl"),J.toString()),method:"POST",qosName:"GetWebUrl",noRedirect:!0})).then(function(e){j=e.d.ServerRelativeUrl})];case 1:W.sent();W.label=2;case 2:if(!j&&D.serverRelativeListUrl){(F=D.serverRelativeListUrl.indexOf("/lists/"))<0&&(F=D.serverRelativeListUrl.lastIndexOf("/"));F>=0&&(j=D.serverRelativeListUrl.substring(0,F))}(I=D.serverRelativeListUrl)&&(B.__metadata={type:u.getListEntityTypeName(I,j)});q=(q=N&&N.extension?x+N.extension:x).trim();B.FileLeafRef=q;L&&(B.Title=q);(R={})["X-HTTP-Method"]="MERGE";R["If-Match"]="*";R.Prefer="bypass-shared-lock";return[4,e(r.getData({webAbsoluteUrl:A.webAbsoluteUrl,listFullUrl:A.listFullUrl,url:H,method:"POST",body:JSON.stringify(B),additionalHeaders:R,qosName:"renameItem",telemetryHandler:function(e){var t=e.errorData,r=e.eventData;if(t){var i=!1;t.status===a.STATUS_CODE_ZERO?i=!0:t.code&&(t.code.indexOf(g)>-1||t.code.indexOf(y)>-1||t.code.indexOf(b)>-1)&&(i=!0);var s=i?f.ResultType.expectedFailure:f.ResultType.failure;return{eventData:n.__assign(n.__assign({},r),{resultType:s})}}return{eventData:r}}})).catch(function(e){if(e instanceof r.GetDataError&&e.errorData.status===a.STATUS_CODE_ZERO)throw new a.ItemOperationError({facets:n.__assign({},h.offlineErrorFacet.pack({})),innerError:e});throw e})];case 3:W.sent();e(l.invalidateItems({items:(U={},U[w]=[c.displayNameFacet],U)}));e(p.resolveItems({items:(z={},z[w]=n.__assign(n.__assign({},c.displayNameFacet.pack(N&&N.extension?x+N.extension:x)),c.fileNameFacet.pack({name:x,extension:N&&N.extension||""})),z)}));return[2]}var X,V,$,J})})}});
define("Ik",["require","exports","Ms","xk"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateListItem=n.implementOperation({operationTypeFacet:r.updateListItemOperation})});
define("xk",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateListItemOperation=new n.Facet("updateItem")});
define("yF",["require","exports","ww","Qi","K_","e9","W3"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateView=i.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,i=e.options.views;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var u,a,f,l,c;return n.__generator(this,function(n){u=r.spListViewsSetKeyFacet.deserialize(t);a=Object.keys(i)[0];f=i[a].viewXml;if(u){l=s.getListApiUrl({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl});c=l.method("Views",a).method("SetViewXml");return[2,e(o.getData({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl,url:c.toString(),method:"POST",body:JSON.stringify({viewXml:f}),qosName:"saveViewXML"}))]}return[2]})})}})});
define("zF",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateViewOperation=new n.Facet("updateView");t.updateView=r.implementOperation({operationTypeFacet:t.updateViewOperation})});
define("Hk",["require","exports","ww","A","Q1","Bk","Hs","Nk","D8","Gi","Rk"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.handleUploadError=function(e){if(r.default.isCanceled(e))throw new o.CancelError;if(e instanceof u.UploadError)throw new a.UploadItemOperationError({facets:c(e),innerError:e});if(l.isErrorData(e))throw new a.UploadItemOperationError({facets:n.__assign(n.__assign({},"-2130575257"===e.code?n.__assign({},i.conflictErrorFacet.pack({supportsRename:!1})):n.__assign({},i.retryErrorFacet.pack({}))),f.spErrorDataFacet.pack(e)),message:l.getErrorMessage(e)})};function c(e){switch(e.errorType){case s.UploadErrorType.conflict:return n.__assign({},i.conflictErrorFacet.pack({supportsRename:!1}));case s.UploadErrorType.accessDenied:return n.__assign({},i.accessDeniedErrorFacet.pack({}));case s.UploadErrorType.disconnected:return n.__assign({},i.offlineErrorFacet.pack({}));case s.UploadErrorType.emptyFileOrFolder:case s.UploadErrorType.emptyFileOrFolderForDocLib:return n.__assign({},i.emptyFolderUnsupportedFacet.pack({}));case s.UploadErrorType.folderUploadNotSupported:return n.__assign({},i.folderUploadUnsupportedFacet.pack({}));case s.UploadErrorType.invalidName:return n.__assign({},i.invalidNameErrorFacet.pack({}));case s.UploadErrorType.lockMismatch:return n.__assign({},i.lockMismatchErrorFacet.pack({}));case s.UploadErrorType.malwareDetected:return n.__assign({},i.malwareErrorFacet.pack({}));case s.UploadErrorType.overQuota:return n.__assign({},i.overQuotaErrorFacet.pack({}));case s.UploadErrorType.targetFolderMissing:return n.__assign({},i.targetFolderErrorFacet.pack({}));case s.UploadErrorType.throttled:return n.__assign({},i.throttleErrorFacet.pack({}));case s.UploadErrorType.versionMismatch:return n.__assign({},i.versionMismatchFacet.pack({}))}return n.__assign({},i.retryErrorFacet.pack({}))}});
define("S$e",["require","exports","ww","M","Qi","k","ty","TAe","D$e","W3","Gi","Da","Ki","Cs","hk","p3","qi","ih","e9","cc","is","Bc","zi","Is","Hk","I7"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=w.asOnceOnly(function(){return new a.UploadThrottler({maxParallelUploads:1/0})}),k=function(e){return function(t){var n=N.getPageContextFromItemCache(t,e);if(n){if(!!s.getKillSwitch(n).isActivated("3E300045-4874-4525-A1A3-29E5A7BF6BC7","10/21/2020","No longer disable streaming when download is disabled.")&&n.blockDownloadsExperienceEnabled)return!1}var r=t.demandItemFacet(l.permissionsFacet,e);return!(r&&!o.default.hasItemPermission({permissions:r},o.default.editListItems))}};t.uploadListItem=function(e){var t=this,s=e.itemKey,o=e.options.sourceEntries,a=i.spItemKeyFacet.deserialize(s),w=a.webAbsoluteUrl,N=a.listFullUrl,L=Object.keys(o)[0],A=o[L],O=A.progressItemKey,M=A.conflictResolution;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,A,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re;return n.__generator(this,function(ie){switch(ie.label){case 0:t=e(f.getDataRequestor({webAbsoluteUrl:w,listFullUrl:N})),o=t.dataRequestor,A=t.hasDigest;if(!t.hasTokenProvider)return[3,1];D=void 0;return[3,3];case 1:return[4,e(f.getAuthToken({url:w||N,disallowCookies:!A}))];case 2:D=ie.sent();ie.label=3;case 3:_=D;if(!(P=e(p.readItem({sourceFile:d.sourceFileFacet},L)).sourceFile))throw new Error("No source file for upload.");H=e(p.readItem({folderPath:l.folderPathFacet},s)).folderPath;if(!(B=void 0===H?a.rootFolder:H))throw new Error("No path information for target folder.");j=y.getWebApiUrl({webAbsoluteUrl:w,listOrItemFullUrl:N});F=new c.Async(void 0);I=F.debounce(function(t){var n;O&&e(v.resolveItems({items:(n={},n[O]=m.pack({progressSize:g.progressSizeFacet},{progressSize:{current:t}}),n)}))},300,{leading:!1});q=i.spListKeyFacet.serialize({webAbsoluteUrl:w,listFullUrl:N});R=e(b.readItems(function(e){return e.demandItemFacet(l.listFacet,q)}));U=!(!R||!R.contentTypesEnabled||R.templateType===S.ListTemplateType.mySiteDocumentLibrary);z="replace"===M?1:0;W=e(x.readConfiguration({clientName:h.clientNameFacet})).clientName;X=new u.SharePointUploader({authToken:_,onProgress:I,dataRequestor:o,nameConflictBehavior:z,webApiUrl:j,fileUpload:P,destinationUrl:B,appName:W||"Unknown",throttler:e(C),canStream:e(b.readItems(k(s))),itemExpansion:U?"ListItemAllFields/ContentType/Fields":"ListItemAllFields"});O&&e(v.resolveItems({items:(ne={},ne[O]=n.__assign({},g.progressSizeFacet.pack({total:P.size,current:0})),ne)}));V=X.upload();$=e(b.readItems(function(e){return e.demandItemFacet(g.cancelSourceFacet,O)}));J=$?$.token.subscribe(function(){X.abort()}):void 0;ie.label=4;case 4:ie.trys.push([4,6,7,8]);return[4,V];case 5:K=ie.sent();return[3,8];case 6:Q=ie.sent();X.abort();T.handleUploadError(Q);throw Q;case 7:J&&J();X.dispose();return[7];case 8:G=K.ServerRelativeUrl;Y=K.ListItemAllFields&&K.ListItemAllFields.Id?String(K.ListItemAllFields.Id):K.ServerRelativeUrl;Z=i.spItemKeyFacet.serialize({webAbsoluteUrl:w,listFullUrl:N,itemId:Y});ee=K.UniqueId?r.default.normalizeLower(K.UniqueId):"";te=K.Name;e(v.resolveItems({items:(re={},re[Z]=n.__assign(n.__assign(n.__assign(n.__assign({},E.displayNameFacet.pack(te)),ee?l.uniqueIdFacet.pack(ee):{}),G?l.folderPathFacet.pack(G):{}),E.parentFolderItemFacet.pack({itemKey:s})),re)}));return[2,{itemKey:Z}]}})})}}});
define("Fk",["require","exports","ww","Qi","jk","W3","Gi","Da","Cs","hk","p3","qi","ih","e9","cc","Bc","zi","Hk"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadListItem=function(e){var t=this,y=e.itemKey,b=e.options.sourceEntries,w=r.spItemKeyFacet.deserialize(y),E=w.webAbsoluteUrl,S=w.listFullUrl,x=Object.keys(b)[0],T=b[x],N=T.progressItemKey,C=T.conflictResolution;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,b,T,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J;return n.__generator(this,function(K){switch(K.label){case 0:t=e(s.getDataRequestor({webAbsoluteUrl:E,listFullUrl:S})),b=t.dataRequestor,T=t.hasDigest;if(!t.hasTokenProvider)return[3,1];L=void 0;return[3,3];case 1:return[4,e(s.getAuthToken({url:E||S,disallowCookies:!T}))];case 2:L=K.sent();K.label=3;case 3:k=L;A=e(a.readItem({sourceFile:f.sourceFileFacet},x)).sourceFile;O=e(a.readItem({folderPath:o.folderPathFacet},y)).folderPath,M=void 0===O?w.rootFolder:O;if(!A)throw new Error("No source file for upload.");if(!M)throw new Error("No path information for target folder.");_=p.getWebApiUrl({webAbsoluteUrl:E,listOrItemFullUrl:S});D=new u.Async(void 0);P=D.debounce(function(t){var n;N&&e(l.resolveItems({items:(n={},n[N]=c.pack({progressSize:h.progressSizeFacet},{progressSize:{current:t}}),n)}))},300,{leading:!1});H=e(d.readItems(function(e){return e.demandItemFacet(o.listFacet,r.spListKeyFacet.serialize({webAbsoluteUrl:E,listFullUrl:S}))}));B=H&&H.contentTypesEnabled&&H.templateType!==m.ListTemplateType.mySiteDocumentLibrary;(j=new i.ItemUploader({authToken:k,dataRequestor:b,parentItemKey:"",targetItemKey:"",fileUpload:A,iconName:"",serverRelativeItemUrl:M,webApiUrl:_,onProgress:P,expandAllItemFields:B})).nameConflictBehavior="replace"===C?1:0;N&&e(l.resolveItems({items:($={},$[N]=n.__assign({},h.progressSizeFacet.pack({total:A.size,current:0})),$)}));F=j.start();I=e(d.readItems(function(e){return e.demandItemFacet(h.cancelSourceFacet,N)}));q=I?I.token.subscribe(function(){j.abort()}):void 0;K.label=4;case 4:K.trys.push([4,6,7,8]);return[4,F];case 5:K.sent();return[3,8];case 6:R=K.sent();j.abort();g.handleUploadError(R);throw R;case 7:q&&q();j.dispose();return[7];case 8:U=j.item;z=U.properties;W=z&&z.ID||U.id;X=z&&z.uniqueId;V=r.spItemKeyFacet.serialize({webAbsoluteUrl:E,listFullUrl:S,itemId:W});e(l.resolveItems({items:(J={},J[V]=n.__assign(n.__assign(n.__assign(n.__assign({},v.displayNameFacet.pack(U.displayName)),U.id?o.folderPathFacet.pack(U.id):{}),X?o.uniqueIdFacet.pack(X):{}),v.parentFolderItemFacet.pack({itemKey:y})),J)}));return[2,{itemKey:V}]}})})}}});
define("HY",["require","exports","ww","K_","p3","ys","Ki","$_","Qi","Os","So","qi","AU","Bc","vM","Gi","Is","XD"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function y(e){var t=e.itemKey,r=e.driveItem;return function(e){var i,s,o=e(m.readConfiguration({enableSharePointItemMapping:v.enableSharePointItemMappingConfigurationFacet})).enableSharePointItemMapping,h=void 0===o||o,g=new u.ItemResolver,y=r.webDavUrl||r.remoteItem&&r.remoteItem.webDavUrl||r.webUrl,b=y&&decodeURIComponent(y);if(b){var w={itemFullUrl:b},E=d.getParentItemUrl(b),S={itemFullUrl:E},x=a.spItemFullUrlKeyFacet.serialize(w),T=a.spItemFullUrlKeyFacet.serialize(S);g.mapKeys({mappings:(i={},i[x]=t,i)});g.resolveItems({items:(s={},s[x]=n.__assign(n.__assign({},h?n.__assign({},c.pack({preferredKeyFacet:f.preferredKeyFacetFacet},{preferredKeyFacet:new l.IfNotMatchPatch(a.spItemFullUrlKeyFacet,function(e){return e===a.spItemKeyFacet})})):{}),p.parentFolderItemFacet.pack({itemKey:T})),s[T]=n.__assign(n.__assign(n.__assign({},p.folderFacet.pack({})),p.canonicalUrlFacet.pack(E)),p.openUrlFacet.pack(encodeURI(E))),s)})}return{itemResolver:g}}}t.sharePointGraphAddon=r.createAddon(function(){return function(e){var t;e(g.sharePointGraphOneDriveAddon);e(h.sharePointItemByFullUrlAddon);e(i.resolveItems({items:(t={},t[s.configurationItemKey]=n.__assign({},o.processDriveItemFromSharePointFacet.pack({process:y})),t)}))}})});
define("Ey",["require","exports","ww","r","ODBItemsScopeDeferred_mini_css","Tc","Qi","Gi","Ty","My","Ay","Dy","Wv"],function(e,t,n,r,i,s,o,u,a,f,l,c,p){"use strict";var h=i.PinSite_9;i=i.teamSiteNavLink_1;Object.defineProperty(t,"__esModule",{value:!0});t.DragDropNavLinkRenderer=p.createItemCacheComponent(function(e,t){var d,v,m,g=t.itemKey,y=t.groupKey;if(y&&g){var b=o.pinnedItemKeyFacet.serialize({rootItemKey:y,itemKey:g}),w=e.demandItem({prevPinOrder:u.prevPinOrderFacet,pinOrder:u.pinOrderFacet,nextPinOrder:u.nextPinOrderFacet},b);if(w){d=w.prevPinOrder;v=w.pinOrder;m=w.nextPinOrder}}var E=p.evaluateItemCacheComponent(e,r.createElement(c.TeamSiteNavLinkRenderer,n.__assign({},t)));if(!v||!g)return E;var S=p.evaluateItemCacheComponent(e,r.createElement(f.TeamSiteDropTarget,{itemKey:g,prevPinOrder:d,nextPinOrder:v,isTop:!0})),x=p.evaluateItemCacheComponent(e,r.createElement(f.TeamSiteDropTarget,{itemKey:g,prevPinOrder:v,nextPinOrder:m,isTop:!1})),T=p.evaluateItemCacheComponent(e,r.createElement(l.TeamSiteDragSource,{itemKey:g},E));var N=y?p.evaluateItemCacheComponent(e,r.createElement(a.ReorderPinnedSiteAction,{itemKey:g,rootItemKey:y})):null;return r.createElement(s.WithAction,{action:N},function(e){var t=e.isAvailable,n=e.execute;return r.createElement("div",{className:h.sitePinLeftNavParent},r.createElement("div",{className:i.parentContainer},r.createElement("div",{className:i.dropZoneParent},S?r.cloneElement(S,{execute:n,isAvailable:t}):null,x?r.cloneElement(x,{execute:n,isAvailable:t}):null),T))})})});
define("Dy",["require","exports","r","rb","xy","ODBItemsScopeDeferred_mini_css","Wv"],function(e,t,n,r,i,s,u){"use strict";var o=s.teamSiteNavLink_1;s=s.PinSite_9;Object.defineProperty(t,"__esModule",{value:!0});t.TeamSiteNavLinkRenderer=u.createItemCacheComponent(function(e,t){var a=t.itemKey,f=t.groupKey,l=t.name;return n.createElement("div",{className:o.siteContainer},n.createElement("div",{className:o.icon},u.evaluateItemCacheComponent(e,n.createElement(r.ItemFileTypeIcon,{itemKey:a,size:24}))),n.createElement("div",{className:o.siteNameContainer,draggable:!1},n.createElement("span",{className:s.sitePinLeftNavParent},n.createElement("span",{className:o.siteName},l),f&&a?n.createElement("span",null,u.evaluateItemCacheComponent(e,n.createElement(i.PinSiteButton,{itemKey:a,rootItemKey:f}))):null)))})});
define("Ay",["require","exports","ww","r","ODBItemsScopeDeferred_mini_css","Ly","od","d3","Wv","vm"],function(e,t,n,r,i,s,o,u,a,f){"use strict";i=i.teamSiteNavLink_1;Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){var t=e.itemKey,n=e.children,u=e.pageLoadBarrier,a=r.useCallback(function(){return!0},[]),l=r.useCallback(function(e){return{dragSourceKey:t,type:f.PINNED_SITE_DRAG_TYPE}},[t]),c=r.useCallback(function(e){},[]),h=r.useMemo(function(){return{canDragHandler:a,onBeginHandler:l,onEndHandler:c}},[a,l,c]);return r.createElement(s.DragSourceRelay,{dragSourceKey:e.itemKey,type:f.PINNED_SITE_DRAG_TYPE,handlers:h,barrier:u,showDefaultDragPreview:!0},r.createElement("div",{className:i.dragContainer},r.createElement(o.Icon,{iconName:"GripperDotsVertical",className:i.dragHandler,draggable:!0}),n))};t.TeamSiteDragSource=a.createItemCacheComponent(function(e,t){var i=u.getPageLoadBarrier(e);return r.createElement(l,n.__assign({},t,{pageLoadBarrier:i}))})});
define("My",["require","exports","ww","r","Py","ODBItemsScopeDeferred_mini_css","d3","Wv","vm"],function(e,t,n,r,i,s,o,u,a){"use strict";s=s.teamSiteNavLink_1;Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){var t=e.isAvailable,n=e.execute,o=e.itemKey,u=e.prevPinOrder,f=e.nextPinOrder,l=e.isTop,c=e.pageLoadBarrier,h=r.useCallback(function(e){return!!t},[t]),p=r.useCallback(function(e){var t={dataTransfer:{draggedItemKey:e.draggedItem.dragSourceKey,prevPinOrder:u,nextPinOrder:f}};n&&n({event:t});return{dropTargetKey:e.dropTargetKey}},[u,f,n]),d=r.useMemo(function(){return{canDropHandler:h,onDropHandler:p}},[h,p]);return r.createElement(i.DropTargetRelay,{acceptType:[a.PINNED_SITE_DRAG_TYPE],dropTargetKey:o,handlers:d,showDropTargetHint:!1,showDragOverHint:!1,barrier:c},function(e){var t=e.isDroppable,n=e.isDropping,i=t&&n?l?s.topDropZoneHover:s.bottomDropZoneHover:s.dropZone;return r.createElement("div",{className:i})})};t.TeamSiteDropTarget=u.createItemCacheComponent(function(e,t){var i=o.getPageLoadBarrier(e);return r.createElement(f,n.__assign({},t,{pageLoadBarrier:i}))})});
define("Sy",["require","exports","ww","r","tc","nm","kb","Fy","Qi","ODBItemsScopeDeferred_mini_css","Gi","Zv","Wm","Ey","Dy"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";f=f.teamSiteNavLink_1;Object.defineProperty(t,"__esModule",{value:!0});var v=8;function m(e){var t=e.name;return r.createElement("div",{className:f.linkName},t)}t.BasicNavLinkRenderer=m;function g(e,t){var r=t.itemKey;if(e.demandItemFacet(a.spAllSitesKeyFacet,r))return{commandControlHandler:function(e,t){var r=t.command;return r?{command:n.__assign(n.__assign({},r),{name:u.default.MoreSitesText})}:{}},navLinkRenderer:m};var i=c.getConfiguration(e,{isPinningEnabled:l.enableSitePinningConfigurationFacet,isPinnedSiteDragDropEnabled:l.enablePinnedSiteDragDropConfigurationFacet}),s=i.isPinningEnabled,o=i.isPinnedSiteDragDropEnabled;return{navLinkRenderer:s&&o?p.DragDropNavLinkRenderer:d.TeamSiteNavLinkRenderer}}function y(e,t){var r=t.commandGroup;return{commandGroup:n.__assign(n.__assign({},r),{name:u.default.SharedLibrariesHeader})}}function b(e,t){return c.getConfiguration(e,{enableSitePinningConfiguration:l.enableSitePinningConfigurationFacet}).enableSitePinningConfiguration?Math.max(t,v):v}t.allSitesNavGroupControlHandler=o.createControlHandler()(function(){return function(e){return function(e,t){var n={},r=t.itemKey,o=t.childItemKeys;if(!o)return{};for(var u=[],f=!1,l=v,c=0,p=o;c<p.length;c++){var d=p[c];if(f)break;if(e.demandItemFacet(s.isGroupFacet,d,{suppressGetItems:!0})){var m=e.demandItemFacet(i.childItemsFacet,d),w=m&&m.itemKeys,E=e.demandItemFacet(h.childItemsControl,d),S=h.childItemsControl.evaluate(E)(e,{itemKeys:w,itemKey:d}).itemKeys;e.demandItemFacet(a.spFrequentSitesItemSetKeyFacet,d)&&S&&(l=b(e,S.length));if(S){for(var x=0,T=S;x<T.length;x++){var N=T[x];if(u.length>=l){f=!0;u.push(r);break}if(!n[N]){u.push(N);n[N]=!0}}if(!f&&u.length>=v){f=!0;u.push(r)}}}}return{childItemKeys:u,commandGroupControlHandler:y,navLinkControlHandler:g}}}})});
define("nWe",["require","exports","ww","aWe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("uC",["require","exports","ww","kb","Qi","Gi","tx","Zv"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.frequentSitesItemSetControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.itemKeys,i=e.demandItemFacet(s.parentGroupKeyFacet,n);return{itemKeys:a(e,i&&i.itemKey,r)}}}});function a(e,t,r,a){void 0===a&&(a=o.DEFAULT_LEFT_NAV_SITE_COUNT);if(u.getConfiguration(e,{enableSitePinningConfiguration:s.enableSitePinningConfigurationFacet}).enableSitePinningConfiguration&&t&&r&&r.length>a){for(var f=[],l=(function(e,t,r){return n.__spreadArrays(r).sort(function(n,r){var o=e.demandItemFacet(s.pinOrderFacet,i.pinnedItemKeyFacet.serialize({rootItemKey:t,itemKey:n})),u=e.demandItemFacet(s.pinOrderFacet,i.pinnedItemKeyFacet.serialize({rootItemKey:t,itemKey:r})),a=e.demandItemFacet(s.siteWeightageFacet,n),f=e.demandItemFacet(s.siteWeightageFacet,r);return u||o?o?u?u-o:-1:1:f||a?a?f?f-a:-1:1:0})})(e,t,r),c=0,h=Math.min(l.length,o.MAX_PINNED_FREQUENTSITES_COUNT);c<h;c++){var p=i.pinnedItemKeyFacet.serialize({rootItemKey:t,itemKey:l[c]});if(!e.demandItemFacet(s.pinOrderFacet,p))break;f.push(l[c])}var d=c,v=0;v=d>=a-o.MIN_NONPINNED_FREQUENT_SITE_COUNT?o.MIN_NONPINNED_FREQUENT_SITE_COUNT:a-d;h=Math.min(h,d+v);for(;c<h;c++)f.push(l[c]);return f}return r}});
define("xQe",["require","exports","ww","CQe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("IM",["require","exports","kb","ab","xM","S5"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return u}});var o=[r.fileTypeIconColumn,i.nameAndPathColumn,s.modifiedByColumn];function u(e,t){return{columns:o}}});
define("wM",["require","exports","kb","M0","D0","M8","BM","aU","k","u4","K9","EM"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=!a.Killswitch.isActivated(u.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands");t.sharedByMeCommandBarControlHandler=n.createControlHandler()(function(){return function(e){return d}});t.default=t.sharedByMeCommandBarControlHandler;var p=[r.openCommand,i.shareCommand,i.copyLinkCommand,o.manageAccessCommand];function d(e,t){var n=v(e,t.itemKey);return{commands:m(p,n)}}t.itemsCommandBarControlHandler=d;function v(e,t){var n,r=e.demandItemFacet(s.sharedByMeRootItemKeyFacet,t);if(r){var i=new f.SimpleUri(r.tenantRootUrl).authority+"/_api/v2.0",o=l.driveAppsKeyFacet.serialize({endpoint:i});n=c.getFileHandlerCommands(e,{itemKey:o})}return n}t.getSharedByMeFileHandlerCommands=v;function m(e,t){return e.map(function(e){return e.key===r.openCommand.key?u.getOpenFileCommandWithHandler(t,h):e})}t.extendOpenFileCommands=m});
define("OM",["require","exports","kb","M0","D0","wM","vT","aU","k"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=!a.Killswitch.isActivated(u.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands"),l=[r.openCommand,i.shareCommand,i.copyLinkCommand];t.sharedByMeContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return c}});function c(e,t){var n=t.itemKey,r=s.getSharedByMeFileHandlerCommands(e,n);return{commands:o.getOverrideDefaultCommands(l,r,!0,f)}}t.itemsContextMenuControlHandler=c});
define("fC",["require","exports","kb"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spAllSitesItemEngagementControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{engagement:{objectType:"AllSites"}}}}})});
define("lC",["require","exports","kb","Zv","Gi"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spAllSitesItemSetSelectionControlHandler=n.createControlHandler()(function(){return function(){return s}});function s(e,t){var n=r.getConfiguration(e,{isSitePinningEnabled:i.enableSitePinningConfigurationFacet,isFilesWeightedFrequentSitesEnabled:i.enableFilesWeightedFrequentSitesConfigurationFacet}),s=n.isSitePinningEnabled,o=n.isFilesWeightedFrequentSitesEnabled;return s&&o?{}:{selectionMode:"none"}}});
define("gC",["require","exports","ww","r","kb","Yv","CC","IC","SC","Wv","Zv","Gi","vC"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spAllSitesItemSetTilesListControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){var n,r=l.getConfiguration(e,{enableSiteItemTileV2Configuration:c.enableSiteItemTileV2ConfigurationFacet}).enableSiteItemTileV2Configuration,i=2,s=64,o={width:352,height:s};if(r){s=80;n=24;o.height=s;i=3}return{tileRenderer:v,tileControlHandler:function(e,t){return{desiredSize:o}},groupControlHandler:function(e,t){return r?{headerRenderer:h.SiteHeaderTileCell}:{}},grid:{minRowHeight:s,mode:i,maxAspectRatio:5.5,spacing:n}}}}});var p=f.createItemCacheComponent(function(e,t){var i=t.defaultRender,s=t.itemName,o=t.itemActivity,f=t.itemKey,h=t.itemSetKey,p=n.__rest(t,["defaultRender","itemName","itemActivity","itemKey","itemSetKey"]),d=l.getConfiguration(e,{enableSiteItemTileV2Configuration:c.enableSiteItemTileV2ConfigurationFacet}).enableSiteItemTileV2Configuration?a.SiteItemTileV2:u.SiteItemTile;return i?r.createElement(i,n.__assign({},p,{showForegroundFrame:!1,showBackgroundFrame:!1,foreground:null,background:r.createElement(d,{itemKey:f,itemName:s,itemActivity:o,contentSize:t.contentSize,groupKey:h})})):null});function d(e,t){return{tileAs:p}}var v=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return t?r.createElement(s.ControlHandlerProvider,{controlHandlers:o.itemTileControl.pack(d)},r.createElement(t,n.__assign({},i))):null};return t})(r.PureComponent)});
define("ZF",["require","exports","ww","kb","$F"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsContextControllerHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.commands;return{commands:n.__spreadArrays([i.pinSiteCommand,i.unpinSiteCommand],r||[])}}}})});
define("bC",["require","exports","kb","Eo"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spAllSitesItemsViewControlHandler=n.createControlHandler()(i);t.spAllSitesItemsViewLayoutsControlHandler=n.createControlHandler()(i);function i(){return function(e){return function(e,t){return{defaultLayout:r.tilesLayoutType,isLayoutResolved:!0}}}}});
define("iM",["require","exports","ww","r","kb","Qi","c8","rM","Tc","Zm","Wv","vo","Io","N","Bc","we"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spFolderByIdErrorControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){return{errorRenderer:m}}}});var m=l.createItemCacheComponent(function(e,t){var i=t.defaultRender,l=(t.itemKey,t.title,n.__rest(t,["defaultRender","itemKey","title"])),m=l.error;if(m instanceof p.ApiError&&m.extraData&&404===m.extraData.status){var g=c.getItemsScope(e).itemsScopeItemKey,y=e.demandItemFacet(h.currentItemFacet,g),b=e.demandItemFacet(s.remoteItemKeyFacet,y&&y.itemKey),w=b&&s.spItemKeyFacet.serialize(b.mountPointItem),E=void 0,S=u.default.mountPointNotFoundDefaultErrorMessage;if(w){var x=e.demandItemFacet(d.displayNameFacet,w);x&&(S=v.format(u.default.mountPointNotFoundErrorMessage,x));E=r.createElement("div",null,r.createElement(a.WithAction,{action:r.createElement(o.ItemRemoveFromOneDriveAction,{itemKeys:[w]})},function(e){var t=e.execute;return r.createElement(f.DefaultButton,{onClick:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,t().then(function(){window.location.href="#"}).catch()];case 1:e.sent();return[2]}})})}},u.default.removeThisShortcut)}))}return r.createElement(r.Fragment,null,i?r.createElement(i,n.__assign({key:"error"},l,{title:u.default.mountPointNotFoundErrorTitle,subText:S,actions:E})):null)}return i?r.createElement(i,n.__assign({},t)):null})});
define("wP",["require","exports","kb","Gi","EP","p4","R8","Zv"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spFolderItemSetTilesListControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemSetKey;return n&&s.isFeatureEnabled(e,{feature:{ODB:1294}})?i.getCustomFormatterItemTileOverrides(e,n):u.getConfiguration(e,{enableMediaTilesInDocumentGroup:r.enableMediaTilesInDocumentGroupConfigurationFacet}).enableMediaTilesInDocumentGroup?{tileControlHandler:o.mediaTileControlHandler}:{}}}})});
define("oM",["require","exports","kb","Zv","Qi","tc","Qi","Bc","Gi","mM","b8","K_"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,l=t.itemKeys,c=r.getConfiguration(e,{isProjectedUploadedItemSetEnabled:a.enableProjectedUploadedItemSetConfigurationFacet}).isProjectedUploadedItemSetEnabled;if(void 0!==c&&c){var h=e.demandItemFacet(i.spFolderItemSetKeyFacet,n);if(h){var p=(function(e,t,n){var r=[],a=o.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:t}),l=e.demandItemFacet(s.childItemsFacet,a);e.demandItemFacet(f.projectionFacet,o.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:t}));if(!l||l.itemKeys&&0===l.itemKeys.length)return;for(var c={},h={},p=0,d=l.itemKeys;p<d.length;p++){var v=d[p];r.push(v);var m=e.demandItemFacet(i.spItemKeyFacet,v);if(m){m.itemId&&(c[m.itemId]=!0);m.rootFolder&&(h[m.rootFolder]=!0)}c[v]=!0}if(n)for(var g=0,y=n;g<y.length;g++){var b=y[g],w=e.demandItemFacet(i.spItemKeyFacet,b);if(w){if(e.demandItemFacet(u.folderFacet,b)){if(w.rootFolder&&w.rootFolder in h)continue}else if(w.itemId&&w.itemId in c)continue}r.push(b)}return r})(e,h,l);return p?{itemKeys:p}:{}}}return{}}}});t.spProjectedUploadedItemSetAddon=c.createAddon(function(){return function(e){e(n.registerControlHandler(i.spFolderItemSetKeyFacet,l.projectedUploadedItemSetControl)(n.createControlHandler()(h)))}})});
define("cWe",["require","exports","ww","r","W_","kb","Zv","CWe","Jk","$k","Ki","r4","xWe","SWe","zi","k","xS","p4","Gi","Qi","W3","yWe","gWe","bWe","e3","is","c3","Ji","Qs","d9","N","ys","dWe","Q3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P={ODB:860},H={ODB:818},B=new k.KeyFacet("itemAutoRefreshHelper",{itemsScopeItemKey:k.stringPart(),spPageContextKey:k.stringPart()}),j=N.asOnceOnly(function(e){return{}});function F(e){var t=e.spPageContextKey,n=e.pageContext,r=e.listId,s=e.webAbsoluteUrl,o=e.listFullUrl,f=e.isTAB,l=e.itemKey,c=e.driveUrl,d=e.itemsScopeItemKey,m=e.getDataSyncClient;return function(g){var y=g(j),b=B.serialize({itemsScopeItemKey:d,spPageContextKey:t}),w=y[b];if(!w){var E,T=void 0,N=void 0,C=!n||!v.getKillSwitch(n).isActivated("f3c67c53-3465-4927-924d-963e1011836b","09/29/2020","Skip checking the subscription service");if(m&&e.pushChannelService&&(C||e.subscriptionService)){T=e.pushChannelService;N=e.subscriptionService}else{if(n&&!v.getKillSwitch(n).isActivated("1280C2A6-E41F-4140-9BBD-AD7F6BC4C604","10/31/2019","Use socketIo api for list subscriptions")){var k=g(a.getDataRequestor).dataRequestor;N=new h.default({listId:r,webAbsoluteUrl:s},{dataRequestor:k})}else N=new x.default({dispatch:g,webAbsoluteUrl:s,listFullUrl:o,listId:r});T=new p.default({disableWebSockets:!0},{subscriptionService:N})}E=new S.default({pushChannelService:T,subscriptionService:N,webAbsoluteUrl:s,listFullUrl:o,itemSetKey:l});w=y[b]=new u.default({id:b,isTestMode:f,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:c,dispatch:g,template:E,itemsScopeItemKey:d,pushChannelService:T,logQoS:function(e){var t=g(i.logQoS(e));return function(e){return g(t(e))}},onUnsubscribe:function(e){0===e&&delete y[b]}})}return w}}function I(e){var t=T.useItemCacheDispatch();r.useLayoutEffect(function(){if(e.getDataSyncClient){var r=new Promise(function(r){var i,s,o,u;(s=(i=e).pageContext,o=i.listId,(u=i.getDataSyncClient)?u.then(function(e){var t=void 0,r=void 0;if(e&&s&&o&&s.siteId&&e.isListDataSyncEnabled({listId:o,siteId:s.siteId})){t=new _.DataSyncPushChannelService({listId:o,siteId:s.siteId,dataSyncClient:e});r=void 0}return F(n.__assign(n.__assign({},i),{subscriptionService:r,pushChannelService:t}))}):Promise.resolve(F(i))).then(function(e){var n=t(e);r(n.subscribe())})});return function(){r.then(function(e){return e()})}}return t(F(e)).subscribe()},[]);return null}function q(e){var t=T.useItemCacheDispatch();r.useLayoutEffect(function(){return t((function(e){var t=this,r=e.spPageContextKey,s=e.webAbsoluteUrl,o=e.listFullUrl,l=e.isTAB,c=e.driveAccessToken,d=e.pageContext,m=e.driveUrl,g=e.endpoint,y=e.itemsScopeItemKey;return function(e){var S=e(j),x=B.serialize({itemsScopeItemKey:y,spPageContextKey:r}),T=S[x];if(!T){var N,C,k=e(a.getDataRequestor).dataRequestor;C=new E.default({dataRequestor:k,rootItemKey:b.spItemKeyFacet.serialize({webAbsoluteUrl:s,listFullUrl:o,rootFolder:""})});N=new p.default({disableWebSockets:!0},{subscriptionService:new h.default({},{dataRequestor:k}),sessionTokenFetcher:function(){return n.__awaiter(t,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:if(!d||!v.getKillSwitch(d).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!l)return[3,1];t=c;return[3,3];case 1:return[4,e(w.getAuthToken({url:m,disallowCookies:!0}))];case 2:t=n.sent();n.label=3;case 3:return[3,7];case 4:return(i=g)?[4,e(f.getSessionToken(g,m))]:[3,6];case 5:i=n.sent();n.label=6;case 6:t=(r=i)&&r.accessToken;n.label=7;case 7:if(!t)throw new O.ApiError({code:"authFailure"});return[2,{accessToken:t,tokenUrl:m}]}})})}});T=S[x]=new u.default({id:x,isTestMode:l,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:m,dispatch:e,itemsScopeItemKey:y,template:C,pushChannelService:N,logQoS:function(t){var n=e(i.logQoS(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete S[x]}})}return T}})(e)).subscribe()},[]);return null}t.itemAutoRefreshControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){var n,i=t.itemKey;if(!i)return{};var s=e.demandItem({key:b.spFolderItemSetKeyFacet},i).key;if(!s||!s.webAbsoluteUrl||!s.listFullUrl)return{};var u=s.webAbsoluteUrl,a=s.listFullUrl,f=b.spPageContextKeyFacet.serialize({webAbsoluteUrl:u,listFullUrl:a}),h=e.demandItemFacet(y.spPageContextFacet,f);if(!g.isFeatureEnabled(e,{feature:P,pageContext:h})||!g.isFeatureEnabled(e,{feature:H,pageContext:h}))return{};var p=D.isDataSyncEnabled(function(t){return g.isFeatureEnabled(e,{feature:t})},D.DataSyncEntityType.SharePointList)?null===(n=e.demandItemFacet(y.spDataSyncClientFacet,M.configurationItemKey))||void 0===n?void 0:n.dataSyncClient:void 0,v=b.spListKeyFacet.serialize({webAbsoluteUrl:u,listFullUrl:a}),w=e.demandItem({listFacets:y.listFacet,listMediaTransformSchema:m.listMediaTransformFacet},v),E=w.listFacets,S=w.listMediaTransformSchema;if(!E||void 0===E.id||void 0===E.templateType)return{};var x=E.isDocumentLibrary,T=d.isGenericList(E.templateType);if(!x&&!T)return{};var N,k=o.getConfiguration(e,{isTAB:l.isTestMode}).isTAB,O=S&&S[".driveUrl"],_=O&&c.getUrlParts(O),B=_&&_.endpoint,j=C.getItemsScope(e).itemsScopeItemKey||"itemsSCopeItemKey";if(x&&!O)return{};var F=L.getCurrentLayout(e,{itemsScopeItemKey:j});if(F&&F.id===A.quickEditLayoutType.id)return{};if(x){if(!S)return{};if(!O)return{};if(k){var R=S[".driveAccessToken"];N=R&&R.replace("access_token=","")}if(!_)return{};var U=_.driveId;return B&&U?{isAvailable:!0,itemSubscriber:r.createElement(q,{spPageContextKey:f,driveUrl:O,isTAB:k,listFullUrl:a,endpoint:B,driveAccessToken:N,webAbsoluteUrl:u,pageContext:h,itemsScopeItemKey:j})}:{}}return{isAvailable:!0,itemSubscriber:r.createElement(I,{spPageContextKey:f,isTAB:k,itemKey:i,listFullUrl:a,webAbsoluteUrl:u,listId:E.id,pageContext:h,driveUrl:O,itemsScopeItemKey:j,getDataSyncClient:p})}}}})});
define("LWe",["require","exports","r","kWe","kb"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetQuickEditListControlHandler=i.createControlHandler()(s);function s(){return function(e){return function(e,t){return{quickEditLayout:n.createElement(r.QuickEditLayout,null)}}}}t.getItemSetQuickEditListControlHandler=s});
define("jM",["require","exports","ww","r","Qi","kb","zi","Tc","zM","Gi","X9","VM","k","Y9"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spHoverCardLifeCycleStatusControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){var s=t.signalData,d=t.itemKey;if(s&&d&&s.key===l.needsPublishingSignal.key){var v=e.demandItemFacet(f.needsPublishingFacet,d),m=e.demandItemFacet(i.spItemKeyFacet,d),g=m&&i.spPageContextKeyFacet.serialize(m),y=e.demandItemFacet(f.spPageContextFacet,g);if(!v||!y||y.listBaseTemplate!==o.default.webPageLibrary)return{};var b=y&&h.getKillSwitch(y);if(!(!!b&&b.isActivated("eccf828d-ab98-4d4e-b9dd-25467f4f2f10","9/7/2020","Remove file card flight"))){var w=e.demandItemFacet(f.uiVersionFacet,d),E=e.demandItemFacet(f.moderationStatusTypeFacet,d),S=p.isPublishStartDateInFuture(e,d),x=!!b&&b.isActivated("0b95f189-dff4-441e-a8e1-e860c9d15392","4/9/2020","add schedule action to hoverCard"),T=c.default.publishNowAction,N=0,C=l.needsPublishingSignal.signal,k=c.default.pageNeedsRepublishing;if(E)T=c.default.submitNowAction;else if(!x&&S){T=c.default.scheduleAction;N=1;C=l.itemScheduledSignal.signal;k=c.default.pageNeedsScheduling}else if(w){var L=Math.floor(Number(w)/512);T=0===L?c.default.publishNowAction:c.default.republishNowAction}return{onRenderLifeCycleSignal:function(e,t){return t?r.createElement(u.WithAction,{action:r.createElement(a.ItemPublishAction,{itemKeys:[d],publishType:N,source:"FileCard"})},function(r){var i=r.isAvailable,s=r.execute,o=i?function(){s()}:void 0,u=n.__assign(n.__assign({},e),{actionName:T,action:o,content:k,signal:C});return t(u)}):null}}}return{}}return{}}}})});
define("pM",["require","exports","ww","r","Gi","kb","Gi","w5","b2","Zv","Wv"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemTileControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){return c(e,t)}}});function c(e,t){var s=t.itemKey,c=f.getConfiguration(e,{enableItemActivityField:o.enableItemActivityFieldFacet}).enableItemActivityField,p=e.demandItemFacet(o.friendlyDateModifiedFacet,s),d=c&&l.evaluateItemCacheComponent(e,r.createElement(a.ItemActivityField,{itemKey:s,isCompact:!0,hideDate:!0}))||p&&r.createElement(u.DateField,{text:p}),v=e.demandItemFacet(i.mountPointFacet,s);return n.__assign(n.__assign({},d?{itemActivity:d}:{}),{folderCoverControlHandler:function(e,t){return v?{folderCoverAs:h}:{}}})}t.itemTileControlHandler=c;function h(e){var t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return t?r.createElement(t,n.__assign({},i,{folderCoverType:"linked"})):null}});
define("tWe",["require","exports","Qi","Ke","u4","Gi","kb","RU"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderDialogControlHandler=o.createControlHandler()(function(){return function(e){return function(e,t){var o,a=t.itemKey,f=e.demandItemFacet(n.spItemKeyFacet,a),l=u.nameValidator;if(f&&a){var c=f.rootFolder||new i.SimpleUri(f.listFullUrl).path,h=new r.ItemUrlHelperBasic({context:{webAbsoluteUrl:f.webAbsoluteUrl,listUrl:f.listFullUrl}}).getUrlParts({path:c});h.fullItemUrl&&(o=400-h.fullItemUrl.length);var p=f&&e.demandItemFacet(s.spPageContextFacet,n.spPageContextKeyFacet.serialize({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}));!p||p.supportPoundStorePath&&p.supportPercentStorePath||(l=u.nameValidatorWithoutPoundPercent)}return{validator:l,maxLength:o}}}})});
define("cT",["require","exports","ww","_T","dT","kb"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultDropActionControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){var s=t.handlers;return{handlers:n.__spreadArrays([r.uploadToGroupDefaultDropActionHandler,i.moveToGroupDefaultDropActionHandler],s||[])}}}})});
define("nF",["require","exports","ww","kb","Qi","W3","Bc","XU","Ue"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultShareLinkControlHandler=r.createControlHandler()(f);function f(){return function(e){return l}}t.getDefaultShareLinkActionControlHandler=f;function l(e,t){var r=t.itemKey,f=e.demandItem({driveItem:i.spItemKeyFacet,canonicalLinkUrl:o.canonicalUrlFacet},r),l=f.driveItem,c=f.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,f,l,c,h,p,d,v,m;return n.__generator(this,function(n){switch(n.label){case 0:t=e.driveItem,i=e.canonicalLinkUrl;if(t&&i)return[3,1];throw new Error("Unable to obtain default share URL");case 1:o=void 0;if(i){f=new a.SPResourcePath(i);l=f.authority;for(c=0,h=f.segments;c<h.length;c++)""!==(p=h[c])&&(l=l+"/"+encodeURIComponent(p));d=u.btoa(l.toString());o="u!"+d.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}v=new a.SPResourcePath(t.webAbsoluteUrl).authority;return[4,r(s.getData({webAbsoluteUrl:v,listFullUrl:void 0,url:v+"/_api/v2.0/shares/"+o+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(m=n.sent()).value[0].link.webUrl,scope:m.value[0].link.scope}]}})})}})({driveItem:l,canonicalLinkUrl:c})}}}});
define("MU",["require","exports","ww","r","Gi","ty","we","kb","Wv","Zv","TU","PU"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.deleteActionControlerHandler=u.createControlHandler()(function(){return function(e){return function(e,t){var n,r=t.itemKey,o=t.isBatchDelete,u=e.demandItemFacet(i.mountPointFacet,r,{suppressGetItems:!0}),a=e.demandItemFacet(i.permissionsFacet,r,{suppressGetItems:!0}),l=e.demandItemFacet(i.rowDataFacet,r,{suppressGetItems:!0}),p=c.isProgIdTeamChannelFolder(null===(n=l)||void 0===n?void 0:n.ProgId),d=s.PermissionMask.hasItemPermission({permissions:a},s.PermissionMask.deleteListItems)&&!p;if(d&&u){d=!!f.getConfiguration(e,{enableDeleteCommandForMountPointConfiguration:i.enableDeleteCommandForMountPointConfigurationFacet}).enableDeleteCommandForMountPointConfiguration&&o}return{isAvailable:d,deleteWizard:h}}}});var h=a.createItemCacheComponent(function(e,t){var s,u,a,c,h,p,d=t.itemKeys,v=t.defaultRender,m=n.__rest(t,["itemKeys","defaultRender"]),g=void 0,y=f.getConfiguration(e,{enableDeleteCommandForMountPointConfiguration:i.enableDeleteCommandForMountPointConfigurationFacet}).enableDeleteCommandForMountPointConfiguration;if(1===d.length){var b=e.demandItemFacet(i.mountShortcutCountFacet,d[0]);if(b){var w=b&&o.formatToArray(o.getLocalizedCountValue(l.default.deleteItemThatIsMountedDescription,l.default.deleteItemThatIsMountedIntervals,b)||"",b),E=m.deleteWizardStrings.confirmText;g=n.__assign(n.__assign({},m),{deleteWizardStrings:n.__assign(n.__assign({},m.deleteWizardStrings),{confirmTitle:l.default.deleteItemThatIsMountedTitle,confirmText:[w," ",E]})})}}else if(y){s=0;d.forEach(function(t){e.demandItemFacet(i.mountPointFacet,t,{suppressGetItems:!0})&&s++});if(s>0){var S=d.length-s;g=n.__assign(n.__assign({},m),{deleteWizardStrings:n.__assign(n.__assign({},m.deleteWizardStrings),{confirmTitle:l.default.deleteItems,confirmText:(u=s,a=S,c=o.format(o.getLocalizedCountValue(l.default.deleteShortcutsFormat,l.default.deleteShortcutsIntervals,u)||"",u),h=o.format(o.getLocalizedCountValue(l.default.deleteOtherItemsFormat,l.default.deleteOtherItemsIntervals,a)||"",a),p=o.format(l.default.deleteItemsAndMountPointsFormat,c,h),p)})})}}var x=g||m;return v?r.createElement(v,n.__assign({itemKeys:d},x)):null})});
define("kU",["require","exports","Gi","kb","Zv"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.deleteItemsActionControlerHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.itemKeys;if(!i.getConfiguration(e,{enableDeleteCommandForMountPointConfiguration:n.enableDeleteCommandForMountPointConfigurationFacet}).enableDeleteCommandForMountPointConfiguration)return{};for(var s=0,o=r;s<o.length;s++){var u=o[s];if(!e.demandItemFacet(n.mountPointFacet,u,{suppressGetItems:!0}))return{}}return{isAvailable:!1}}}})});
define("aWe",["require","exports","kb","iWe","I7"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemDocumentCreatorControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,s=i.getPageContextFromItemCache(e,n),o=!(!s||!s.isAnonymousGuestUser);return{validator:r.nameValidator.bind(void 0,!!s&&!!s.supportPoundStorePath),askForFileName:o}}}})});
define("UU",["require","exports","ww","r","Gi","Qi","W3","K4","zi","ty","FU","M","kb","Bc","q4","e9","O4","Wi","Zv","u4","N5","Gp","k"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function x(e){var t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return t?r.createElement(t,n.__assign({},i,{preferOpenInBrowser:!0})):null}function T(e){var t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return t?r.createElement(t,n.__assign({},i,{preferSameWindow:!0})):null}t.downloadItemsActionControlHandler=h.createControlHandler()(function(){return function(e){var t=new E.PlatformDetection;return function(e,r){var h=r.itemKeys,E=h[0],k=e.demandItemFacet(p.folderFacet,E),L=e.demandItemFacet(g.oneNoteFacet,E),A=e.demandItemFacet(i.documentSetFacet,E);return 1!==h.length||k||L||A?h.length>0?(function(e,t){var r=t.itemKeys,l=e.demandItemFacet(s.spItemKeyFacet,r[0]);if(!l||!l.webAbsoluteUrl||!l.listFullUrl)return{};var h=l.webAbsoluteUrl,v=l.listFullUrl,w=s.spListKeyFacet.serialize({webAbsoluteUrl:h,listFullUrl:v}),E=e.demandItem({listFacets:i.listFacet,downloadZipApiUrl:d.downloadAsZipApiUrlFacet},w),S=E.listFacets,x=E.downloadZipApiUrl;if(!S||!x||S.templateType===a.ListTemplateType.webPageLibrary)return{};for(var T=[],C=y.getConfiguration(e,{enableOAuthTokenInDownload:i.enableOAuthTokenInDownloadConfigurationFacet}).enableOAuthTokenInDownload,k=void 0!==C&&C,L=!1,A=0,O=r;A<O.length;A++){var M=O[A],_=e.demandItem({name:p.displayNameFacet,size:p.fileSizeFacet,itemUrl:p.vroomUrlFacet,folder:p.folderFacet,permissions:i.permissionsFacet,itemComplianceStatus:m.itemComplianceStatusFacet,isOneNote:g.oneNoteFacet},M),D=_.name,P=_.size,H=_.itemUrl,B=_.folder,j=_.permissions,F=_.itemComplianceStatus;if(_.isOneNote)return{isAvailable:!1};var I=void 0,q=void 0,R=e.demandItemFacet(i.mountPointFacet,M,{suppressGetItems:!0});if(R){I=void 0;q=new b.SimpleUri(R.siteUrl).authority+"/_api/v2.1/drives/"+R.driveId+"/items/"+R.itemId;L=!0}else{if(!H)return{};I=e.demandItemFacet(d.driveAccessTokenFacet,w);q=u.getItemUrlWithToken(H,(I?I.accessToken:void 0)||"")}if(q){var U=!!B;3!==F&&4!==F&&f.PermissionMask.hasItemPermission({permissions:j},f.PermissionMask.openItems)&&T.push({name:D||"",size:P||0,docId:q,isFolder:U})}}if(0===T.length)return{};return{isAvailable:!0,getDownloadData:function(){return(function(e){var t=this,r=e.zipApiUrl,i=e.itemsData,s=e.useOAuthToken;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a;return n.__generator(this,function(n){switch(n.label){case 0:t=void 0;return s?[4,e(o.getAuthToken({url:new b.SimpleUri(r).authority}))]:[3,2];case 1:t=n.sent();n.label=2;case 2:u=i&&1===i.length?i[0].name+".zip":"OneDrive_"+ ++N+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";a=c.default.generate();return[2,{url:r,method:"POST",postData:{zipFileName:u,guid:a,provider:"spo",files:JSON.stringify({items:i}),oAuthToken:t||""}}]}})})}})({zipApiUrl:x,itemsData:T,useOAuthToken:k||L})}}})(e,{itemKeys:h}):{}:(function(e,t){var r=t.itemKey,u=t.platformDetection,c=e.demandItem({spItem:s.spItemKeyFacet,permissions:i.permissionsFacet,folderPath:i.folderPathFacet,uniqueId:i.uniqueIdFacet,itemComplianceStatus:m.itemComplianceStatusFacet,isBFile:i.isBFileFacet},t.itemKey),h=c.spItem,d=c.permissions,g=c.folderPath,E=c.uniqueId,N=c.itemComplianceStatus,k=c.isBFile,L=e.demandItemFacet(p.malwareDetectedFacet,t.itemKey),A=h&&s.spPageContextKeyFacet.serialize(h),O=e.demandItemFacet(i.spPageContextFacet,A);if(!O||!h||k)return{};var M=h.webAbsoluteUrl,_=h.listFullUrl,D=s.spListKeyFacet.serialize(h),P=e.demandItemFacet(i.listFacet,D);if(P&&P.templateType===a.ListTemplateType.webPageLibrary)return{};if(3===N||4===N||!f.PermissionMask.hasItemPermission({permissions:d},f.PermissionMask.openItems))return{};var H=y.getConfiguration(e,{spCookieDomainConfiguration:i.spCookieDomainConfigurationFacet,enableMalwareDownloadInNewWindow:i.enableMalwareDownloadInNewWindowConfigurationFacet}),B=H.spCookieDomainConfiguration,j=H.enableMalwareDownloadInNewWindow;if(L){if(!O.allowInfectedDownload)return{};var F=e.demandItemFacet(p.canonicalUrlFacet,r);return F?j?{isAvailable:!0,downloader:x,getDownloadData:function(){return C({canconicalUrl:F})}}:B?new b.SimpleUri(B).authority!==new b.SimpleUri(F).authority?{}:n.__assign(n.__assign({isAvailable:!!E},u.isIE?{downloader:T}:{}),{getDownloadData:function(){return C({canconicalUrl:F})}}):{}:{}}if(!g)return{};var I=O.layoutsUrl;if(!I)return{};var q=!B||new b.SimpleUri(B).authority!==new b.SimpleUri(M).authority,R=O&&S.getKillSwitch(O),U=!!R&&R.isActivated("d1181e40-8c18-49bf-bff9-efd9518c28c0","10/10/2020","Use PostBody Download"),z=y.getConfiguration(e,{disableDownloadWithAspxUrlWithToken:i.disableAspxUrlWithTokenConfigurationFacet}).disableDownloadWithAspxUrlWithToken,W=void 0!==z&&z;return n.__assign(n.__assign({isAvailable:!0},u.isIE?{downloader:T}:{}),{getDownloadData:function(){return U||W?B&&E&&!q?(function(e){var t=this,r=e.webAbsoluteUrl,i=e.layoutsUrl,s=e.uniqueId;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,{url:r+"/"+i+"/download.aspx?"+w.serializeQuery({UniqueId:s}),method:"GET"}]})})}})({webAbsoluteUrl:M,uniqueId:E,layoutsUrl:I}):(function(e){var t=this,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.folderPath;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,f,c,h;return n.__generator(this,function(n){switch(n.label){case 0:t=e(o.getDataRequestor({webAbsoluteUrl:r,listFullUrl:i})),u=t.dataRequestor,a=t.hasDigest;if(!t.hasTokenProvider)return[3,1];c=void 0;return[3,3];case 1:return[4,e(o.getAuthToken({url:r||i,disallowCookies:!a}))];case 2:c=n.sent();n.label=3;case 3:f=c;h=v.getWebApiUrl({webAbsoluteUrl:r,listOrItemFullUrl:i});return[4,l.getPreAuthorizedAccessUrl({dataRequestor:u,authToken:f,serverRelativeItemUrl:s,webApiUrl:h})];case 4:return[2,{url:n.sent(),method:"GET"}]}})})}})({webAbsoluteUrl:M,listFullUrl:_,folderPath:g,layoutsUrl:I}):(function(e){var t=this,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.uniqueId,u=e.layoutsUrl,a=e.isCrossSite;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,l,c;return n.__generator(this,function(n){switch(n.label){case 0:t=e(o.getDataRequestor({webAbsoluteUrl:r,listFullUrl:i})),f=t.hasDigest;if(!t.hasTokenProvider&&a)return[3,1];c=void 0;return[3,3];case 1:return[4,e(o.getAuthToken({url:r||i,disallowCookies:!f}))];case 2:c=n.sent();n.label=3;case 3:l=c;return[2,{url:r+"/"+u+"/download.aspx?"+w.serializeQuery({UniqueId:s}),method:a?"POST":"GET",postData:{oAuthToken:l||""}}]}})})}})({webAbsoluteUrl:M,listFullUrl:_,uniqueId:E||"",layoutsUrl:I,isCrossSite:q})}})})(e,{itemKey:E,platformDetection:t})}}});var N=0;function C(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1");return[2,{url:t,method:"GET"}]})})}}});
define("YU",["require","exports","Qi","Gi","kb","zi"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileHandlerActionControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){var i=t.itemKey,o=e.demandItemFacet(n.spItemKeyFacet,i);if(!o)return{};var u={webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl},a=e.demandItemFacet(r.listFacet,n.spListKeyFacet.serialize(u)),f=e.demandItemFacet(r.spPageContextFacet,n.spPageContextKeyFacet.serialize(u));if(!f)return{};var l=a&&a.templateType===s.ListTemplateType.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:f.currentUICultureName||f.currentCultureName||"en-US",client:l?"OneDrive":"SharePoint",domainHint:"organizations",userId:f.userLoginName}}}}})});
define("QU",["require","exports","Qi","kb","Vb","Jk","xS","Ke"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveItemFullUrlControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.itemKey,a=void 0,f=e.demandItem({key:n.spItemKeyFacet,driveItemKey:i.driveItemKeyFacet},r),l=f.key,c=f.driveItemKey;if(c)return{driveItemFullUrl:s.getDriveItemUrl(c)};if(l){var h={webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl},p=e.demandItem({listMediaFacets:o.listMediaTransformFacet},n.spListKeyFacet.serialize(h)).listMediaFacets;if(p&&p[".driveUrl"]){var d=p[".driveUrl"],v=l.rootFolder||"",m="";if(v){var g=new u.ItemUrlHelperBasic({context:{webAbsoluteUrl:l.webAbsoluteUrl,listUrl:l.listFullUrl}}).getUrlParts();g.serverRelativeListUrl&&"/"!==(m=v.replace(g.serverRelativeListUrl,"")).charAt(0)&&(m="/"+m)}return{driveItemFullUrl:a=d+"/items/root"+(m?":":"")+m}}}return{driveItemFullUrl:a}}}})});
define("gT",["require","exports","ww","Qi","Gi","kb","Vs","tc","mo","p3","gS","k"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openGroupControlHandler=s.createControlHandler()(function(){return function(e){return function(e,t){var s=o.getCurrentItemSetKey(e),h=(function e(t,s,o){var u=s,a=o;if(s&&o){var f=t.demandItem({spGroupField:i.spGroupFieldFacet,groupValue:i.groupValueFacet,parentGroupKey:i.parentGroupKeyFacet,groupFilterByValue:i.groupFilterByValueFacet},s),h=f.spGroupField,p=f.groupValue,d=f.parentGroupKey,v=f.groupFilterByValue;d&&(a=e(t,d.itemKey,o));var m=t.demandItemFacet(r.spFolderItemSetKeyFacet,a);if(m){var g=t.demandItemFacet(r.spItemGroupKeyFacet,s),y=l.getFilteredItemSetKey(n.__assign(n.__assign({},m),g?{viewKey:g.viewKey}:{})),b=v||p;if(void 0!==b&&h&&h.internalName&&h.fieldType){var w=!c.Killswitch.isActivated("b53559e1-298d-4488-a512-60e0d8b8b827","09/15/2020","Include fitler displays for group that has raw value for filterByValue")&&"DateTime"===h.fieldType;u=y({filterField:h.internalName,filterValues:[b],filterDisplays:w&&[p||b]||[],filterType:h.fieldType,useLookupId:!1})}}}return u})(e,t.itemKey,s),p=e.demandItem({parentItem:u.parentItemFacet},s).parentItem,d=(function(e){var t=this,r=e.stageItem,i=e.parentItemKey;return r?a.createAsyncActionCreator(function(e){var s=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(a){switch(a.label){case 0:i&&e(f.resolveItems({items:(t={},t[o]=n.__assign({},u.parentItemFacet.pack({itemKey:i})),t)}));return[4,e(r({currentItemKey:o,itemsScopeItemKey:s}))];case 1:a.sent();return[2]}})})}}):void 0})({parentItemKey:p&&p.itemKey,stageItem:t.stageItem});return h?n.__assign({itemKey:h},d?{stageItem:d}:{}):{}}}})});
define("sT",["require","exports","ty","Qi","Gi","zi","kb","nm"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadItemsToGroupActionControlHandler=o.createControlHandler()(function(){return function(e){return function(e,t){var o=t.itemKey,a=e.demandItem({key:r.spItemGroupKeyFacet,isDropEnabled:u.isDropEnabledFacet},o),f=a.key,l=a.isDropEnabled,c=f&&f.itemSetKey&&r.spItemKeyFacet.serialize(f.itemSetKey),h=c&&e.demandItemFacet(i.permissionsFacet,c),p=n.PermissionMask.hasItemPermission({permissions:h},n.PermissionMask.insertListItems);if(p){var d=f&&f.itemSetKey&&e.demandItemFacet(i.listFacet,r.spListKeyFacet.serialize({webAbsoluteUrl:f.itemSetKey.webAbsoluteUrl,listFullUrl:f.itemSetKey.listFullUrl}));p=!!l&&!!d&&!!d.isDocumentLibrary&&d.templateType!==s.ListTemplateType.webPageLibrary}return{isAvailable:p}}}})});
define("XM",["require","exports","kb","Bc","Be","r","ZM","Gi","W3","Qi"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hoverCardCommandsControlHandler=n.createControlHandler()(function(){return function(e){return function(t,n){var l=n.itemKey,c=t.demandItemFacet(f.spItemKeyFacet,l),h=c&&f.spPageContextKeyFacet.serialize(c),p=t.demandItemFacet(u.spPageContextFacet,h),d=t.demandItemFacet(u.uniqueIdFacet,l),v=t.demandItemFacet(r.canonicalUrlFacet,l),m=c&&c.listFullUrl,g=c&&c.webAbsoluteUrl,y=t.demandItemFacet(r.fileNameFacet,l);return{checkInAction:s.createElement(o.CheckOutItemAction,{checkInOutType:"checkIn"}),undoCheckOutAction:s.createElement(o.CheckOutItemAction,{checkInOutType:"undoCheckOut"}),onDismiss:function(t,n){var r=e(a.getDataRequestor({webAbsoluteUrl:g||"",listFullUrl:m})).dataRequestor,s={ListId:p&&p.listId,ListItemUniqueId:d,Operation:"RecommendationActedOn",AffectedResourceUrl:v,ItemType:"File",json:JSON.stringify({FileName:y&&y.name,Scenario:"RecommendedActions",SourceRelativeUrl:m,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(n+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:t,Canvas:"Web",Workload:"SharePoint",WebId:p&&p.webId,SiteId:p&&p.siteId,SiteUrl:p&&p.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:y&&y.name,SourceFileExtension:y&&y.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:t,ActionType:"Dismiss"})},o=new i.default(g+"/_api/web/ActivityLogger/FeedbackDirect");r.getData({url:o.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(s),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})}}}}})});
define("hT",["require","exports","Qi","X7","Y7","US","kb","Vs","Bc","Gi"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsBreadcrumbControlerHandler=o.createControlHandler()(function(){return function(e){return function(e,t){var o=t.createOpenItem,c=t.rootItemKey,h=t.itemKey,p=u.getCurrentItemSetKey(e),d=void 0;if(c){var v=e.demandItemFacet(n.spItemKeyFacet,c);v&&(d=n.spItemKeyFacet.serialize(v))}return{getBreadcrumbItems:function(){var t=[],u={},v=e.demandItemFacet(n.spFolderItemSetKeyFacet,p),m=v&&v.filterParams,g=e.demandItemFacet(f.spFilterableSetFacet,p),y=g&&g.filterList;!g&&m&&(y=r.default.getFilterList(m,void 0,!0));if(y&&y.length&&m)for(var b=y.length-1;b>=0;b--){var w=y[b],E=(w.displays&&w.displays.length?w.displays:w.values).map(function(e){return e||s.default.EmptyFilterOptionLabel}),S=r.default.formatBreadcrumbFilterValues(E,w.type||"",{booleanFalse:s.default.booleanFalse,booleanTrue:s.default.booleanTrue}),x=l(m,y,b+1),T=(N=i.getOverrideItemSetKeyForFolder(e,{folderItemKey:h,currentItemSetKey:p,newFilterParams:x}))?n.spFolderItemSetKeyFacet.serialize(N):h;t.unshift({key:w.fieldName,text:S,onClick:o&&T?o(T):void 0})}for(;h&&!u[h];){u[h]=!0;var N,C=e.demandItem({displayName:a.displayNameFacet,parentFolder:a.parentFolderItemFacet},h),k=C.displayName,L=C.parentFolder;T=(N=i.getOverrideItemSetKeyForFolder(e,{folderItemKey:h,currentItemSetKey:p,newFilterParams:""}))?n.spFolderItemSetKeyFacet.serialize(N):h;t.unshift({key:h,text:k||"",onClick:o&&T?o(T):void 0});if(c&&(c===h||d===h))break;h=L&&L.itemKey||""}return t}}}}});function l(e,t,n){for(var i=n=n||0;i<t.length;i++){var s=t[i];e=r.default.addFilterInfo(e,s.fieldName,"",!0)}return e}t.clearFilterInfo=l});
define("aU",["require","exports","ww","Qi","Gi","YT","Z6","NT","_U","UT","mU","ET","t8","a8","fU","kb","tc","M","T0","Kg","yT","D0","Zg","zi","dU","sU","EM","S8","NP","TP","UP","p4","d9","c3","Zv","I7","kT","k","x0","Qs","Ki","iU","p0"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var z={ODB:1544},W=[c.CheckOutItemCommand,c.CheckInItemCommand,c.UndoCheckoutItemCommand],X=[T.showKeymapShortcut,N.navigateUpShortcut],V={ODB:1231};t.SHOW_FILEHANDLER_COMMANDS_FIRST="658D384B-C862-48CC-986B-F1CD32B00BFE";t.deferredItemsCommandBarControlerHandler=v.createControlHandler()(J);t.itemsCommandBarControlerHandler=v.createControlHandler()(J);t.getOpenFileCommandWithHandler=function(e,t){var r=n.__rest(u.openFileCommand,[]);if(e&&e.open&&e.open.length>0){r.subMenuProps=r.subMenuProps||{};r.subMenuProps.items=C.mergeFileHandlerCommands(r.subMenuProps&&r.subMenuProps.items||[],e.open,t);!j.Killswitch.isActivated("BC85A80B-0AA5-41F5-98B6-C875D1773EE5","12/9/2019","Log engagement for open menu for promoted file handler")&&e.open.some(function(e){return e.isPromoted||!1})&&(r.engagement={name:"OpenCommand",isIntentional:!0,extraData:{hasPromotedFileHandler:!0}})}return r};function $(e,c){var v,T,N=c.itemKey,$=c.itemSetKey,J=c.commands,K=c.overflowCommands,Q=c.farCommands,G=c.shortcutCommands,Y=e.demandItemFacet(r.spItemKeyFacet,N),Z=e.demandItemFacet(r.spFolderItemSetKeyFacet,$),ee=K?n.__spreadArrays(K):[],te=!0,ne=!1,re=void 0,ie=void 0,se=void 0,oe=J?n.__spreadArrays(J):[],ue=Q,ae=[],fe="",le=Y&&r.spListKeyFacet.serialize(Y),ce=e.demandItemFacet(r.spListKeyFacet,le);Z&&Z.viewKey&&(fe=Z.viewKey.viewId);var he,pe,de,ve=[],me=!1;if(Y&&ce){me=k.getIsAvailable(e,N,Y);var ge=e.demandItemFacet(i.listFacet,le);te=!!ge&&!!ge.isDocumentLibrary;he=H.getPageContextFromItemCache(e,N);te?ae=G?n.__spreadArrays(G,X):n.__spreadArrays(X):oe=s.getDefaultListCommands(he);if(!(ne=!!ge&&ge.templateType===x.ListTemplateType.mySiteDocumentLibrary)){te&&ee.push.apply(ee,W);ee&&ee.push(B.getApproveRejectCommand({listFacets:ge}));var ye={webAbsoluteUrl:ce.webAbsoluteUrl,listFullUrl:ce.listFullUrl},be=r.spListViewsSetKeyFacet.serialize(ye),we=e.demandItemFacet(m.childItemsFacet,be);if(we&&we.itemKeys&&Q){!fe&&he&&he.viewId&&(fe=g.default.normalizeLower(he.viewId,!1));T=e.demandItemFacet(i.newDocumentTemplatesFacet,le);ue=(pe=Q,de=a.getViewsCommands(e,{viewKeys:we.itemKeys,webAbsoluteUrl:Y.webAbsoluteUrl,listViewSetKey:ye,itemSetKey:$,currentViewKey:r.spViewKeyFacet.serialize({viewId:fe})}),pe.map(function(e){return e.key===b.switchLayoutCommand.key?de:e}))}}ge&&ce&&(ve=(v=O.processContentTypeCommands(e,{key:Y,listFacets:ge,listKey:ce,pageContext:he})).contentTypes,re=v.contentTypeCommands);ie=w.getCustomActionCommands(e,Y);he&&ge&&(se=A.processFileHandlerCommands(e,{isODB:ne,key:Y,listFacets:ge,pageContext:he}).fileHandlerCommands)}var Ee=P.getConfiguration(e,{enableQuickEdit:i.enableQuickEditFacet,enableUniversalPrint:q.enablePrintToUniversalPrinterFacet}),Se=Ee.enableQuickEdit,xe=Ee.enableUniversalPrint,Te=!!he&&!!Se&&M.isFeatureEnabled(e,{feature:V,pageContext:he});if(Te){var Ne=D.getItemsScope(e).itemsScopeItemKey;if(I.getCurrentLayout(e,{itemsScopeItemKey:Ne})===_.quickEditLayoutType)return{commands:[d.exitQuickEditCommand],overflowCommands:[],farCommands:[],shortcutCommands:[]}}var Ce=(function(e,n){for(var r=n.quickEditEnabled,i=n.defaultCommands,s=n.isDocumentLibrary,a=n.isODB,c=n.contentTypeCommands,d=n.customActionCommands,v=n.fileHandlerCommands,m=n.newDocumentTemplates,g=n.contentTypes,b=n.isCreateFolderAvailable,w=n.listKey,x=n.pageContext,T=n.printEnabled,N=[],k=!j.Killswitch.isActivated(t.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands"),A={},O=0,_=i;O<_.length;O++){var D=_[O];A[D.key]=D}for(var P=0,H=i;P<H.length;P++){if((D=H[P]).key===y.newCommand.key){var B=L.getNewCommand(e,{contentTypes:g,newCommandMenu:D,fileHandlerCommands:v,isCreateFolderAvailable:b,newDocumentTemplates:m,contentTypeCommands:c,listKey:w}).visibleNewCommands;N.push(B)}else if(D.key===F.uploadCommand.key&&r&&!A[p.quickEditCommand.key])N.push(D,p.quickEditCommand);else if(D.key===u.openFileCommand.key){var I=t.getOpenFileCommandWithHandler(v,k);N.push(I)}else if(D.key===E.copyLinkCommand.key&&s&&!A[h.syncCommand.key])N.push(D,h.syncCommand);else if(D.key===S.deleteCommand.key&&s){N.push(D);a||A[o.exportListCommand.key]||N.push(o.exportListCommand);N.push(f.pinItemCommand,f.editPinnedItemCommand)}else if(D.key===E.shareCommand.key){!s&&M.isFeatureEnabled(e,{feature:z,pageContext:x})?N.push(E.addPeopleCommand):N.push(D);N.push(l.publishItemCommand,l.scheduleItemCommand)}else D.key===U.downloadCommand.key&&T?N.push(U.downloadCommand,R.printToUniversalPrinterCommand):N.push(D)}d&&d.length>0&&N.push.apply(N,d);v&&v.custom&&v.custom.length>0&&(N=C.mergeFileHandlerCommands(N,v.custom));return{overrideDefaultCommands:N}})(e,{defaultCommands:oe,isDocumentLibrary:te,isODB:ne,contentTypeCommands:re,customActionCommands:ie,fileHandlerCommands:se,newDocumentTemplates:T,contentTypes:ve,isCreateFolderAvailable:me,quickEditEnabled:Te,listKey:Y,pageContext:he,printEnabled:!!xe});return{commands:oe=Ce.overrideDefaultCommands,overflowCommands:ee,farCommands:ue,shortcutCommands:ae}}t.baseItemsCommandBarControlHandler=$;function J(){return function(e){return function(e,t){return $(e,t)}}}});
define("vT",["require","exports","ww","Qi","Gi","YT","NT","UT","ET","kb","yT","u4","K9","l8","s8","EM","p4","zi","k","aU","Zg","p0","D0","S4","Is","i3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C={ODB:1544};t.itemsContextMenuControlerHandler=f.createControlHandler()(function(){return function(e){return function(t,o){var f,p=o.itemKey,d=o.commands,w=t.demandItemFacet(r.spItemKeyFacet,p);if(w){var E=r.spListKeyFacet.serialize(w);f=t.demandItemFacet(i.listFacet,E)}var L=d?n.__spreadArrays(d):[];L.push(u.pinItemCommand,u.editPinnedItemCommand);var A=void 0;if(w){var O=w.listFullUrl,M=w.webAbsoluteUrl,_=a.getMoreCommands({listFacets:f}),D=t.demandItemFacet(i.spPageContextFacet,r.spPageContextKeyFacet.serialize({webAbsoluteUrl:M,listFullUrl:O}));if(f&&!f.isDocumentLibrary){L=[s.viewItemCommand];for(var P=0,H=s.getDefaultListCommands(D);P<H.length;P++){var B=H[P];B.key===S.shareCommand.key&&m.isFeatureEnabled(t,{feature:C,pageContext:D})?L.push(S.addPeopleCommand):B.key!==s.exportListCommand.key&&L.push(B)}}L.push(_);var j=r.contextMenuCustomActionSetKeyFacet.serialize({webAbsoluteUrl:M,listFullUrl:O}),F=l.demandCustomActionSetWithExtensions({itemCache:t,targetCustomActionSetKey:j,keys:{webAbsoluteUrl:M,listFullUrl:O}});L=L.concat(l.getCustomActionSetCommands(t,j));F&&(L=L.concat(l.getCustomActionSetCommands(t,F)));if(D&&f&&(f.templateType===g.ListTemplateType.documentLibrary||f.templateType===g.ListTemplateType.mySiteDocumentLibrary)){var I=new c.SimpleUri(M||O).authority+"/_api/v2.0",q=h.driveAppsKeyFacet.serialize({endpoint:I});A=v.getFileHandlerCommands(t,{itemKey:q})}}var R=!y.Killswitch.isActivated(b.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands");return{commands:k(L,A,f&&f.templateType===g.ListTemplateType.mySiteDocumentLibrary,R),onMenuOpened:function(){e(function(e){var t=(e(T.readConfiguration({spLoggerConfiguration:N.loggerFacet})).spLoggerConfiguration||{}).scenarioId,n=void 0===t?"":t;e(x.logRUMOneForContextMenu(n))})}}}}});function k(e,t,n,r){for(var i=[],s=0,u=e;s<u.length;s++){var a=u[s],f=a.key;if(f===o.openFileCommand.key){var l=t&&t.open||[];l.length>0&&o.openFileCommandForContextMenu.subMenuProps&&(o.openFileCommandForContextMenu.subMenuProps.items=v.mergeFileHandlerCommands(o.openFileCommandForContextMenu.subMenuProps.items,l,r));i.push(o.openFileCommandForContextMenu)}else{i.push(a);f===w.deleteCommand.key?i.push(d.removeShortcutFromFilesCommand):f===E.downloadCommand.key&&i.push(p.addShortcutFromTeamSiteCommand)}}return t&&t.custom&&t.custom.length>0?v.mergeFileHandlerCommands(i,t.custom):i}t.getOverrideDefaultCommands=k});
define("JU",["require","exports","ww","kb","Qi","W3","XU","Ue"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.permissionInviteControlHandler=r.createControlHandler()(a);function a(){return function(e){return f}}t.getPermissionInviteActionControlHandler=a;function f(e,t){var r=t.itemKey,a=t.link,f=t.recipients,l=e.demandItem({driveItem:i.spItemKeyFacet},r).driveItem;return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,a,f,l,c,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:t=e.driveItem,i=e.link,a=e.recipients;if(!t)return[3,2];void 0;l=o.btoa(i);f="u!"+l.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");c=a.map(function(e){return{email:e}});h={recipients:c,roles:["read"]};p=new u.SPResourcePath(t.webAbsoluteUrl).authority;return[4,r(s.getData({webAbsoluteUrl:p,listFullUrl:void 0,url:p+"/_api/v2.0/shares/"+f+"/permission/invite",body:JSON.stringify(h),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))];case 1:d=n.sent();v=d.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:v}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}})({driveItem:l,link:a,recipients:f})}}}});
define("k7",["require","exports","kb","Gi","M7"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromOneDriveActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,s=e.demandItemFacet(r.mountPointFacet,n,{suppressGetItems:!0}),o=e.demandItemFacet(i.localItemFacet,n);return{isAvailable:!!s||!!o}}}})});
define("sM",["require","exports","Qi","kb"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromSharedListControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.itemKey;return{isAvailable:!!e.demandItemFacet(n.spItemKeyFacet,r)}}}})});
define("HU",["require","exports","ww","Qi","Gi","ty","BU","kb","Bc","RU","Bc","PU"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameActionControlHandler=u.createControlHandler()(function(){return function(e){return function(e,t){var u,h=t.itemKey,p=e.demandItem({key:r.spItemKeyFacet,permissions:i.permissionsFacet,isCheckedOut:a.isCheckedOutFacet,isFolder:l.folderFacet,rowData:i.rowDataFacet},h),d=p.key,v=p.permissions,m=p.isCheckedOut,g=p.isFolder,y=p.rowData,b=d&&e.demandItemFacet(i.spPageContextFacet,r.spPageContextKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl})),w=void 0,E=!1,S=f.nameValidator;if(b){w=y&&m&&!!m.byOther;var x=e.demandItemFacet(i.mountPointFacet,h,{suppressGetItems:!0}),T=c.isProgIdTeamChannelFolder(null===(u=y)||void 0===u?void 0:u.ProgId);E=!(x||b.isAnonymousGuestUser||T)&&s.PermissionMask.hasItemPermission({permissions:v},s.PermissionMask.deleteListItems)&&s.PermissionMask.hasItemPermission({permissions:v},s.PermissionMask.editListItems);b.supportPercentStorePath&&b.supportPoundStorePath||(S=f.nameValidatorWithoutPoundPercent)}var N={},C=d&&e.demandItemFacet(i.listFacet,r.spListKeyFacet.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}));if(w){N.lockedWarningMessage=o.default.FileCheckedoutOrLockedWarning;N.title=o.default.FileCheckedoutOrLockedWarningTitle}else if(C&&C.isForceCheckout&&m&&!m.byYou&&!g){N.lockedWarningMessage=o.default.CheckoutRequired;N.title=o.default.Error}return n.__assign({isAvailable:E,validator:S,isFolder:!!g},N)}}})});
define("eP",["require","exports","ww","kb","I7","ys","aI","tP","ld","u4","Xk","Gi","Zv","i3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharingCalloutControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=t.itemKey,d=h.getConfiguration(e,{graphTokenProvider:l.graphTokenProviderConfigurationFacet,spRestTokenProvider:c.spRestTokenProviderConfigurationFacet,logger:p.loggerFacet}),v=d.graphTokenProvider,m=d.spRestTokenProvider,g=d.logger,y=i.getPageContextFromItemCache(e,r),b=y&&(y.env2||y.env),w=g&&g.scenarioId;return{initializeShareFrame:function(e){var t=e.parentElement,r=e.calloutProps,i=e.sharingInformation,l=e.onError,c=r.defaultRecipients,h=r.itemName,d=r.locale,g=r.mode,y=r.openManageAccess,E=r.theme,S=r.getClientId,x=i.authToken,T=i.isListSharing,N=i.listId,C=i.serverRelativeItemUrl,k=i.shareItemKey,L=i.webAbsoluteUrl,A=S(),O={authToken:x||"",clientId:A,defaultRecipients:c,itemName:h,mode:Number(g),theme:E||a.getTheme(),webAbsoluteUrl:L||""},M={};if(k&&o.shareItemByUniqueIdKeyFacet.matches(k)){var _=o.shareItemByUniqueIdKeyFacet.deserialize(k);M={listId:_.listId,uniqueId:_.uniqueId,webAbsoluteUrl:_.webAbsoluteUrl}}else{var D=""+new f.default(L).authority+C;T&&A===p.ClientId[p.ClientId.listsHome]&&(w="list");M={isListSharing:T,itemUrl:D,listId:N,scenarioId:w}}new u.SharePrefetch({element:t,environment:b||s.Environment.prod,locale:d,context:n.__assign(n.__assign({},O),M),options:{onError:l,openManageAccess:y,graphTokenProvider:v,spRestTokenProvider:m}}).initializeUI()}}}}})});
define("CQe",["require","exports","ww","Qi","kb","mo","Gi","fv","Vte","Bte","t2","qe","ys","Bc","u4","Gp","T9","k","fe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemSyncDialogControlHandler=i.createControlHandler()(function(){return function(t){var i=(function(e){var t;t=e.isMac?"https://go.microsoft.com/fwlink/p/?LinkId=248255":e.isWindows?"https://go.microsoft.com/fwlink/p/?LinkId=248256":"https://go.microsoft.com/fwlink/?LinkID=708540";return t})(new v.PlatformDetection);return function(t,v){var w=this,E=t.demandItemFacet(r.spItemKeyFacet,v.itemKey);if(!E)return{};var S=E&&r.spPageContextKeyFacet.serialize(E),x=t.demandItemFacet(o.spPageContextFacet,S);if(!x)return{};var T=r.spListKeyFacet.serialize(E),N=t.demandItemFacet(o.listFacet,T);if(!N)return{};var C=Number(x.webTemplate)===u.WebTemplateType.mySite,k=new d.SimpleUri(E.webAbsoluteUrl).authority,L=r.spTenantKeyFacet.serialize({tenantRootUrl:k}),A=t.demandItemFacet(p.folderFacet,v.itemKey),O=t.demandItemFacet(o.spDataSourceConfigurationFacet,h.configurationItemKey);return{userLoginName:x.userLoginName,clientDownloadUrl:i,isTenantAdmin:s.createAsyncActionCreator(function(t){return function(t){return n.__awaiter(w,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,new Promise(function(t,n){e(["uk"],t,n)})];case 1:r=n.sent().demandItems;return[4,t(r(function(e){return e.demandItemFacet(o.spTenantAdminFacet,L)}))];case 2:return[2,!!n.sent()];case 3:n.sent();return[2,!1];case 4:return[2]}})})}}),getSyncInfo:s.createAsyncActionCreator(function(t){return function(t){return n.__awaiter(w,void 0,void 0,function(){var r,i,s,o,u,h,p=this;return n.__generator(this,function(d){switch(d.label){case 0:r=new a.SyncDataSource({},{pageContext:x,dataRequestorType:(function(e){n.__extends(t,e);function t(t){return e.call(this,t,{pageContext:x})||this}return t})(l.DataRequestor),getAuthToken:O&&O.ensureAuthToken,apiUrlHelperType:c.ApiUrlHelperBasic});return[4,f.getSyncQueryParams({getUserInfo:function(){return n.__awaiter(p,void 0,void 0,function(){var i,s,o,u,a,f;return n.__generator(this,function(l){switch(l.label){case 0:i=x&&g.getKillSwitch(x).isActivated("8CCCA24D-26C2-4FBD-85EF-734251D8E89A","4/20/2020","Avoid OneDrive lookup for guest users.");s=!i&&(x.isAnonymousGuestUser||x.isExternalGuestUser||x.isEmailAuthenticationGuestUser);if(!C||s)return[3,5];l.label=1;case 1:l.trys.push([1,4,,5]);return[4,new Promise(function(t,n){e(["uk"],t,n)})];case 2:u=l.sent().demandItems;return[4,t(u(function(e){return m.getUserOneDriveUrl(e,{tenantRootUrl:k})}))];case 3:o=l.sent();return[3,5];case 4:a=l.sent();y.default.logError(a);return[3,5];case 5:f=[{}];return[4,r.getSyncUserInfo({webUrl:E.webAbsoluteUrl})];case 6:return[2,n.__assign.apply(void 0,[n.__assign.apply(void 0,f.concat([l.sent()])),{oneDriveWebUrl:o}])]}})})},getWebInfo:function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(e){if(!x.siteId)throw new Error("Unknown siteId for Sync.");if(!x.webId)throw new Error("Unknown webId for Sync.");return[2,{onPrem:!x.isSPO,siteId:x.siteId,webId:x.webId,webLogoUrl:x.webLogoUrl,webTemplateType:Number(x.webTemplate),webTitle:x.webTitle,webUrl:E.webAbsoluteUrl}]})})},getListInfo:function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(e){if(!N.id)throw new Error("Unknown listId for Sync.");if(!N.title)throw new Error("Unknown list title for Sync.");return[2,{listId:N.id,listTemplateType:N.templateType,listTitle:N.title}]})})},getFolderInfo:function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return A&&E.rootFolder?[4,t(b({itemKey:v.itemKey,spItem:E}))]:[2,void 0];case 1:return[2,e.sent()]}})})}},x)];case 1:i=d.sent();s=!g.getKillSwitch(x).isActivated("7b4719be-2180-47f6-8e5e-af8d3ac9a5e4","08/23/2019","siteSubscriptionID is diff from AADtenantID");o=x&&x.siteSubscriptionId||"";u=x&&x.aadTenantId||"";return s&&o!==u?[4,f.getSyncConfigParams(u,i)]:[3,3];case 2:h=d.sent();return[3,5];case 3:return[4,f.getSyncConfigParams(o,i)];case 4:h=d.sent();d.label=5;case 5:return[2,{protocolUrl:f.getSyncProtocolUrl(i),syncConfigParams:h}]}})})}})}}}});function b(t){var r=this,i=t.itemKey,s=t.spItem;return function(t){return n.__awaiter(r,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["uk"],t,n)})];case 1:r=n.sent().demandItems;return[2,t(r(function(e){var t=e.demandItemFacet(p.fileNameFacet,i),n=t&&t.name,r=e.demandItemFacet(o.uniqueIdFacet,i),u=e.demandItemFacet(o.folderPathFacet,i);if(!r)throw new Error("Unable to determine folderId for Sync.");if(!n)throw new Error("Unable to determine folderName for Sync.");return{folderName:n,folderId:r,folderUrl:""+new d.SimpleUri(s.webAbsoluteUrl).authority+u}}))]}})})}}});
define("wC",["require","exports","ww","Qi","kb","G7"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spLibrariesItemSetFilteredItemSetControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){var i=t.itemKey,o=t.handlers,u=e.demandItemFacet(r.spLibrariesItemSetKeyFacet,i);if(o&&u){for(var a=[],f=0,l=o;f<l.length;f++){var c=l[f];".JPEG"===s.getExtensionFilterFromFilterHandler(c)&&a.push("media")}return a.length<1?{}:{itemKey:r.spLibrariesItemSetKeyFacet.serialize(n.__assign(n.__assign({},u),{types:a}))}}return{}}}})});
define("pC",["require","exports","kb","Gi"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spWebItemEngagementControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItem({pinOrder:r.pinOrderFacet,webId:r.webIdFacet,siteId:r.siteIdFacet},n),s=i.pinOrder,o=i.webId,u=i.siteId;return{engagement:{objectType:"Site",webId:o,siteId:u,extraData:{TargetSiteId:u,TargetWebId:o,isPinned:!!s}}}}}})});
define("mC",["require","exports","kb","_C"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spWebItemFileTypeIconControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{fileTypeIconAs:r.SiteIcon}}}})});
define("bT",["require","exports","ww","kb","tc","cs"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new s.ComputedItemFacet("siteTargetDocumentLibraryItem",function(e,t){var n=t.itemKey,r=e.demandItemFacet(i.defaultChildItemSetFacet,n),s=r&&r.itemKey,o=e.demandItemFacet(i.childItemsFacet,s),u=o&&o.itemKeys;if(u&&1===u.length)return{itemKey:u[0]}});t.webOpenActionControlHandler=r.createControlHandler()(function(){var t=this;return function(){return function(r,i){var s=i.itemKey,u=i.stageItem,a=r.demandItemFacet(o,s,{suppressGetItems:!0});return n.__assign({},a?{itemKey:a.itemKey}:{stageItem:function(r){return function(i){return n.__awaiter(t,void 0,void 0,function(){var t,s,a,f,l,c;return n.__generator(this,function(h){switch(h.label){case 0:a=[n.__assign({},r)];return(f=u)?[4,i(u(r))]:[3,2];case 1:f=h.sent();h.label=2;case 2:t=n.__assign.apply(void 0,a.concat([f||{}])).currentItemKey,s=void 0===t?r.currentItemKey:t;return[4,new Promise(function(t,n){e(["tC"],t,n)})];case 3:l=h.sent().demandItems;return[4,i(l(function(e){return e.demandItemFacet(o,s)}))];case 4:return(c=h.sent())?[2,{currentItemKey:c.itemKey}]:[2]}})})}}})}}})});
define("GU",["require","exports","ww","Qi","K_","Cs","Gi","KU","e9","W3","QM"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.bulkUpdateListItems=i.createSingleItemOperationHandler()(function(e){var t=e.itemKey,i=e.options,c=i.itemKeys,h=i.bNewDocumentUpdate,p=i.checkInComment,d=i.formValues,v=i.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(n){switch(n.label){case 0:if(!(d&&d.length&&c&&c.length))return[2];i=r.spFolderItemSetKeyFacet.deserialize(t),m=i.viewKey,g=i.rootFolder,y=i.webAbsoluteUrl,b=i.listFullUrl;w=g||"";m&&(!(E=e(s.readItem({currentDerivedView:o.currentDerivedViewFacet},r.spViewKeyFacet.serialize(m))).currentDerivedView)||1!==E.scope&&2!==E.scope||(w=""));S=[];x={};T=0,N=c;n.label=1;case 1:if(!(T<N.length))return[3,4];C=N[T];return[4,e(u.getSPItemInfo(C))];case 2:k=n.sent().itemId;S.push(parseInt(k,10));x[k]=C;n.label=3;case 3:T++;return[3,1];case 4:L=a.getListApiUrl({webAbsoluteUrl:y,listFullUrl:b}).method("BulkValidateUpdateListItems").toString();A={itemIds:S,formValues:d,folderPath:w,bNewDocumentUpdate:h,checkInComment:p};return[4,e(f.getData({body:JSON.stringify(A),listFullUrl:b,method:"POST",qosName:v,url:L,webAbsoluteUrl:y,noRedirect:!0})).then(function(n){for(var r,i="",s={},o=0,u=n.d.BulkValidateUpdateListItems.results;o<u.length;o++){var a=u[o];if(a.HasException)i=a.ErrorMessage+"\n"+i;else{x[a.ItemId]&&(s[x[a.ItemId]]={})}}Object.keys(s).length>0&&e(l.refreshItemsInSet({items:(r={},r[t]=s,r)}));if(i)throw new Error(i)})];case 5:n.sent();return[2]}})})}})});
define("rC",["require","exports","ww","K_","$_","Qi","tc"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getBusinessNavSet=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,u=s.businessNavSetKeyFacet.deserialize(r).tenantRootUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a;return n.__generator(this,function(f){(t=new i.ItemResolver).resolveItems({items:(a={},a[r]=n.__assign({},o.childItemsFacet.pack({itemKeys:[s.oneDriveNavSetKeyFacet.serialize({tenantRootUrl:u}),s.spAllSitesKeyFacet.serialize({tenantRootUrl:u})]})),a)});e(t.execute());return[2]})})}})});
define("MC",["require","exports","ww","Bc","nm","kC","Qi","Gi","tc","$_","Fy"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPAllSites=function(e){var t=this;return function(c){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v,m;return n.__generator(this,function(g){t=o.spAllSitesKeyFacet.deserialize(e.itemKey).tenantRootUrl;h=new f.ItemResolver;p=o.spFrequentSitesItemSetKeyFacet.serialize({tenantRootUrl:t});d=o.spFollowedSitesItemSetKeyFacet.serialize({tenantRootUrl:t});v=[p,d];h.resolveItems({items:(m={},m[p]=n.__assign(n.__assign(n.__assign({},i.isGroupFacet.pack(!0)),r.displayNameFacet.pack(s.default.frequent)),u.parentGroupKeyFacet.pack({itemKey:e.itemKey})),m[d]=n.__assign(n.__assign(n.__assign({},i.isGroupFacet.pack(!0)),r.displayNameFacet.pack(s.default.followed)),u.parentGroupKeyFacet.pack({itemKey:e.itemKey})),m[e.itemKey]=n.__assign(n.__assign(n.__assign({},r.displayNameFacet.pack(l.default.SharedLibrariesHeader)),i.isGroupFacet.pack(!0)),a.childItemsFacet.pack({itemKeys:v})),m)});c(h.execute());return[2]})})}}});
define("LC",["require","exports","ww","Bc","Qi","kC","tc","ex","Gi","tx","$_","th","Is"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPFrequentSitesItemSet=function(e){var t=this;return function(u){return n.__awaiter(t,void 0,void 0,function(){var t,f,h,d,v,m,g,y;return n.__generator(this,function(b){switch(b.label){case 0:t=i.spFrequentSitesItemSetKeyFacet.deserialize(e.itemKey).tenantRootUrl;f=new l.ItemResolver;return[4,u(p(t))];case 1:h=b.sent();d=[];v=i.spAllSitesKeyFacet.serialize({tenantRootUrl:t});m=void 0;g=void 0;h&&h.Items&&h.Items.forEach(function(t,s){var u,l=i.spWebKeyFacet.serialize({webAbsoluteUrl:t.Url}),p=i.spLibrariesItemSetKeyFacet.serialize({webAbsoluteUrl:t.Url}),y=t.ItemReference||{},b=y.SiteId,w=void 0===b?void 0:b,E=y.WebId,S=void 0===E?void 0:E,x=y.GroupId,T=void 0===x?void 0:x,N=i.pinnedItemKeyFacet.serialize({rootItemKey:v,itemKey:l});m=h.Items[s-1]&&h.Items[s-1].PinOrder;g=h.Items[s+1]&&h.Items[s+1].PinOrder;f.resolveItems({items:(u={},u[l]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},r.displayNameFacet.pack(t.Title)),a.acronymFacet.pack(t.Acronym)),a.bannerColorFacet.pack(t.BannerColor)),a.bannerImageUrlFacet.pack(t.BannerImageUrl)),a.isSiteFacet.pack(!0)),r.folderFacet.pack({})),a.siteWeightageFacet.pack(t.Weight)),i.spWebKeyFacet.pack({webAbsoluteUrl:t.Url})),a.siteIdFacet.pack(w)),a.webIdFacet.pack(S)),a.groupIdFacet.pack(T)),o.defaultChildItemSetFacet.pack({itemKey:p})),u[N]=n.__assign(n.__assign(n.__assign(n.__assign({},a.prevPinOrderFacet.pack(m)),a.pinOrderFacet.pack(t.PinOrder)),a.nextPinOrderFacet.pack(g)),c.getInvalidationFacet().forFacet(a.pinOrderFacet).thenInvalidate(e.itemKey,o.childItemsFacet).pack()),u[p]=n.__assign({},o.parentItemFacet.pack({itemKey:l})),u)});d.push(l)});f.resolveItems({items:(y={},y[e.itemKey]=n.__assign(n.__assign(n.__assign({},r.displayNameFacet.pack(s.default.frequent)),o.childItemsFacet.pack({itemKeys:d})),a.parentGroupKeyFacet.pack({itemKey:v})),y)});u(f.execute());return[2]}})})}};function p(t){var r=this;return function(i){return n.__awaiter(r,void 0,void 0,function(){var r,s,o,l;return n.__generator(this,function(n){switch(n.label){case 0:r=i(h.readConfiguration({enableSitePinningConfiguration:a.enableSitePinningConfigurationFacet,enableSPHomeServiceConfiguration:a.enableSPHomeServiceConfigurationFacet})),s=r.enableSitePinningConfiguration;return!1!==r.enableSPHomeServiceConfiguration?[3,3]:[4,new Promise(function(t,n){e(["Fq"],t,n)})];case 1:o=n.sent().getFrequentSitesData;return[4,i(o(t))];case 2:return[2,n.sent()];case 3:l=s?f.MAX_PINNED_FREQUENTSITES_COUNT:f.DEFAULT_LEFT_NAV_SITE_COUNT;return[4,i(u.getSPHomeFrequentSitesData(t,void 0,l))];case 4:return[2,n.sent()]}})})}}});
define("PC",["require","exports","ww","Qi","Gi","ex","$_"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPHomeContext=function(e){var t=this;return function(u){return n.__awaiter(t,void 0,void 0,function(){var t,a,f,l;return n.__generator(this,function(c){switch(c.label){case 0:t=r.spHomeContextKeyFacet.deserialize(e.itemKey).tenantRootUrl;a=new o.ItemResolver;return[4,u(s.getSPHomeContextData({tenantRootUrl:t}))];case 1:f=c.sent();a.resolveItems({items:(l={},l[e.itemKey]=n.__assign(n.__assign({},i.spHomeResourceFacet.pack(f.resource)),i.spHomePayloadHeaderFacet.pack(f.payloadHeader)),l)});u(a.execute());return[2]}})})}}});
define("EC",["require","exports","ww","Bc","Qi","tc","$_","Ke","th","J3","uS","Is","Te","Gi","e9","W3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function m(e){var t=e.webAbsoluteUrl,n=e.isMediaQuery;return function(e){var r=e(c.readConfiguration({spHostPageWebAbsoluteUrl:p.spHostPageWebAbsoluteUrlConfigurationFacet,spSitesListsDataWebAbsoluteUrl:p.spSitesListsDataWebAbsoluteUrlConfigurationFacet})),i=r.spHostPageWebAbsoluteUrl,s=r.spSitesListsDataWebAbsoluteUrl,o=new h.default(t).authority,u=i||s,a=u&&new h.default(u).authority,f=n&&o===a,l=d.getStaticApiUrl({webAbsoluteUrl:a||o}).segment(f?"SP.Web.GetDocumentAndMediaLibaries":"SP.Web.GetDocumentLibraries").parameter("webFullUrl",t);return e(v.getDataWithCache({webAbsoluteUrl:a||o,method:"POST",url:l.toString(),qosName:f?"getDocumentAndMediaLibraries":"getDocumentLibraries",noRedirect:!0}))}}t.getSPLibrariesItemSet=function(e){var t=this;return function(c){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v,g,y,b,w,E,S,x,T,N,C,k,L;return n.__generator(this,function(A){switch(A.label){case 0:t=i.spLibrariesItemSetKeyFacet.deserialize(e.itemKey),h=t.webAbsoluteUrl,p=t.types;d=i.spWebKeyFacet.serialize({webAbsoluteUrl:h});v=new o.ItemResolver;return[4,c(m({webAbsoluteUrl:h,isMediaQuery:!!p&&p.indexOf("media")>-1}))];case 1:g=A.sent();y=[];for(b=0,w=g.d.GetDocumentLibraries.results;b<w.length;b++){E=w[b];S=new u.ItemUrlHelperBasic({context:{webAbsoluteUrl:h}});x=S.getUrlParts({webUrl:h,listUrl:E.AbsoluteUrl,path:E.AbsoluteUrl});T={webAbsoluteUrl:h,listFullUrl:x.fullListUrl||"",rootFolder:""};N=i.spItemKeyFacet.serialize(T);C=i.spFolderItemSetKeyFacet.serialize({webAbsoluteUrl:h,listFullUrl:x.fullListUrl||"",rootFolder:""});v.merge(c(l.processSpFolderItemWithoutListRow({itemKey:N,spItem:T})).itemResolver);v.resolveItems({items:(k={},k[N]=n.__assign({},r.displayNameFacet.pack(E.Title)),k[C]=n.__assign({},s.parentItemFacet.pack({itemKey:N})),k)});y.push(N)}v.resolveItems({items:(L={},L[e.itemKey]=n.__assign(n.__assign(n.__assign(n.__assign({},s.childItemsFacet.pack({itemKeys:y})),a.getInvalidationFacet().forFacet(s.childItemsFacet).thenInvalidate(f.clearCacheIfNotOffline).pack()),i.spWebKeyFacet.pack({webAbsoluteUrl:h})),s.parentItemFacet.pack({itemKey:d})),L)});c(v.execute());return[2]}})})}}});
define("ZP",["require","exports","ww","Cs","Gi","Qi","W3","$P","K_","$_"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spPeoplePickerDataSourceGetItemsOperationHandler=a.createSingleItemOperationHandler()(function(e){var t=this,a=s.spPeoplePickerDataSourceKeyFacet.deserialize(e.itemKey),l=a.webAbsoluteUrl,c=a.listFullUrl;return function(a){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v,m;return n.__generator(this,function(g){t=a(r.readItem({pageContext:i.spPageContextFacet},s.spPageContextKeyFacet.serialize({webAbsoluteUrl:l,listFullUrl:c}))).pageContext;h=a(o.getDataRequestor({webAbsoluteUrl:l,listFullUrl:c})).hasTokenProvider;if(t){p=h?void 0:function(e){return a(o.getAuthToken({url:e}))};d=new u.PeoplePickerDataSource({},{pageContext:t,getAuthToken:p});(v=new f.ItemResolver).resolveItems({items:(m={},m[e.itemKey]=n.__assign({},i.spPeoplePickerDataSourceFacet.pack(d)),m)});a(v.execute())}return[2]})})}})});
define("AC",["require","exports","ww","Qi","tc","$_"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPWeb=function(e){var t=this;return function(o){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,f;return n.__generator(this,function(l){t=r.spWebKeyFacet.deserialize(e.itemKey).webAbsoluteUrl;u=new s.ItemResolver;a=r.spLibrariesItemSetKeyFacet.serialize({webAbsoluteUrl:t});u.resolveItems({items:(f={},f[e.itemKey]=n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:a})),f)});o(u.execute());return[2]})})}}});
define("$x",["require","exports","ww","tC","cc","K_","$_","Wi","ys","Qi","Gi","tc","Bc","eC","_y","my","Fx","US","Ki"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getOneDriveNavSet=s.createSingleItemOperationHandler()(function(e){var t=this,s=e.itemKey,b=f.oneDriveNavSetKeyFacet.deserialize(s).tenantRootUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I;return n.__generator(this,function(q){switch(q.label){case 0:t=new o.ItemResolver;return[4,e(r.demandItems(function(e){var t=f.spOneDriveDocumentLibraryKeyFacet.serialize({tenantRootUrl:b});return e.demandItemFacet(f.spItemKeyFacet,t,{suppressGetItems:!1})}))];case 1:return(w=q.sent())?[4,e(r.demandItems(function(e){return e.demandItemFacet(l.spPageContextFacet,f.spPageContextKeyFacet.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl}))}))]:[2];case 2:E=q.sent();S=e(i.readItems(function(e){return{isSavedForLaterEnabled:e.demandItemFacet(a.enableFollowItemConfigurationFacet,a.configurationItemKey),isSharedWithMeEnabled:!!e.demandItemFacet(y.graphSharedWithMeEndpointConfigurationFacet,a.configurationItemKey)}})),x=S.isSavedForLaterEnabled,T=S.isSharedWithMeEnabled;N={};C=E&&E.userDisplayName;k=f.spItemKeyFacet.serialize(w);N[k]={icon:"FabricFolder",displayName:g.default.files};L=d.recentRootItemKeyFacet.serialize({endpoint:b+"/_api/v2.0"});N[L]={icon:"History",displayName:p.default.recentTitle};A=v.savedForLaterRootItemKeyFacet.serialize({endpoint:b+"/_api/v2.0"});N[A]={icon:"SingleBookmark",displayName:p.default.saved};O=m.sharedWithMeRootItemKeyFacet.serialize({endpoint:""+b});N[O]={icon:"People",displayName:p.default.sharedWithMe};M=n.__spreadArrays([k,L],T?[O]:[],x?[A]:[]);for(_=0,D=M;_<D.length;_++){P=D[_];H=N[P],B=H.icon,j=H.displayName;t.resolveItems({items:(F={},F[P]=n.__assign(n.__assign(n.__assign({},u.iconFacet.pack(B)),h.displayNameFacet.pack(j)),h.folderFacet.pack({})),F)})}t.resolveItems({items:(I={},I[s]=n.__assign(n.__assign({},c.childItemsFacet.pack({itemKeys:M})),h.displayNameFacet.pack(C)),I)});e(t.execute());return[2]}})})}})});
define("rF",["require","exports","ww","Qi","K_","W3","$_","Gi","e9"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spWebPageContextGetItemsOperationHandler=i.createSingleItemOperationHandler({maxParallelOperationCount:4})(function(e){var t=this,i=e.itemKey,f=r.spWebPageContextKeyFacet.deserialize(i).webAbsoluteUrl;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,c,h,p,d;return n.__generator(this,function(v){switch(v.label){case 0:t=a.getStaticApiUrl({webAbsoluteUrl:f}).segments("ComponentContextInfo");return[4,r(s.getData({url:t.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:f,noRedirect:!0}))];case 1:i=v.sent();l=JSON.parse(i.d.SerializedData);c=l.isSPO,h=void 0===c||c;(p=new o.ItemResolver).resolveItems({items:(d={},d[e.itemKey]=n.__assign(n.__assign({},u.onPremFacet.pack(h?void 0:{})),u.spPageContextFacet.pack(l)),d)});r(p.execute());return[2]}})})}})});
define("Oy",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pinSiteOperation=new n.Facet("pinSite");var i=r.implementOperation({operationTypeFacet:t.pinSiteOperation});t.default=i});
define("Zx",["require","exports","ww","K_","$_","Qi","cc","ex","Gi","N5"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spAllSitesPinSiteOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=this,r=Object.keys(e.options),u=e.itemKey,f=r[0],h=e.options[f],p=h.type,d=h.reorderPinInfo,v=s.pinnedItemKeyFacet.serialize({itemKey:f,rootItemKey:u});return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,h,m,g,y,b,w,E;return n.__generator(this,function(S){switch(S.label){case 0:t=e(o.readItems(function(e){return e.demandItem({siteId:a.siteIdFacet,webId:a.webIdFacet,groupId:a.groupIdFacet},f)})),r=t.siteId,h=t.webId,m=t.groupId;g=new i.ItemResolver;y=(function(e,t){switch(e){case"pin":return c();case"unpin":return;case"reorderPin":if(t){var n=t.nextPinOrder,r=t.prevPinOrder;if(n||r)return r?n?(r+n)/2:r/2:c()}return;default:return}})(p,d);g.resolveItems({items:(w={},w[v]=n.__assign({},a.pinOrderFacet.pack(y)),w)});e(g.execute());return(b=s.spAllSitesKeyFacet.deserialize(u).tenantRootUrl)?[4,e(l(b,{siteId:r||"",webId:h||"",groupId:m},p,d))]:[3,2];case 1:S.sent();(g=new i.ItemResolver).invalidateItems({items:(E={},E[v]=[a.pinOrderFacet],E)});e(g.execute());S.label=2;case 2:return[2]}})})}});function l(e,t,r,i){var s=this;return function(o){return n.__awaiter(s,void 0,void 0,function(){var s,a,l,c,h;return n.__generator(this,function(n){switch(n.label){case 0:if("pin"===r){s="api/v1/sites/pinned/add";a="pinSite"}else if("unpin"===r){s="api/v1/sites/pinned/remove";a="unpinSite"}else{if("reorderPin"!==r)return[2];if(!i)return[2];l=f.serializeQuery({PreviousPinOrder:i.prevPinOrder||"",NextPinOrder:i.nextPinOrder||""},void 0,!0);s="api/v1/sites/pinned/update?"+l;a="reorderSite"}return[4,o(u.getSPHomeContextData({tenantRootUrl:e}))];case 1:c=n.sent();h="";t&&(h=JSON.stringify({Title:t.title,Acronym:t.acronym,BannerColor:t.color,Url:t.url,Type:"Site",ItemReference:{Type:t.groupId?"GroupReference":"SiteReference",SiteId:t.siteId,WebId:t.webId,GroupId:t.groupId}}));return[4,o(u.getData({path:s,method:"POST",qosName:a,context:c,body:h}))];case 2:n.sent();return[2]}})})}}function c(e){void 0===e&&(e=new Date);return 621355968e9+1e4*e.getTime()}});
define("$U",["require","exports","ww","Qi","K_","eF","o4","iS","f4","nS"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.refreshItemsInSet=i.createSingleItemOperationHandler()(function(e){var t=e.itemKey;return function(i){return n.__awaiter(void 0,void 0,void 0,function(){var l,c,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:l=r.spFolderItemSetKeyFacet.deserialize(t);c=i(a.getContentTypes({itemSetKey:l}));h=Object.keys(e.options);return[4,i(s.constructRefreshItemsInSetContext({itemSetKey:t,itemKeys:h}))];case 1:p=n.sent();return[4,i(o.getServerData(p))];case 2:d=n.sent();v=i(u.processResponse({serverData:d,itemSetKey:l,currentPageContext:p.currentPageContext,contentTypes:c,isItemSetRequest:!0})).itemResolver;i(v.execute());i(f.invokeHostResponseCallback({itemSetKey:t,serverData:d,isItemSetRequest:!0}));return[2]}})})}})});
define("yM",["require","exports","ww","K_","W3","gM","D6","k8","$_","aS","tc","e9","M8","Pe","th"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,v=o.sharedByMeItemSetKeyFacet.deserialize(r).webAbsoluteUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,m,g,y,b,w,E,S,x;return n.__generator(this,function(T){switch(T.label){case 0:t=(t=c.getWebApiUrl({webAbsoluteUrl:v,listOrItemFullUrl:""})).segment("OneDriveSharedItems").parameter("$top",100).parameter("$expand",{raw:"SpItemUrl,DriveAccessToken,DriveAccessTokenV21,DriveUrl"});m=t.toString();return[4,e(i.getData({url:m,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:v}))];case 1:g=T.sent();y=new a.ItemResolver;b=s.getAndProcessSharedByMeItemData(g,y);w=""+new p.SimpleUri(v).authority;E=h.sharedByMeRootItemKeyFacet.serialize({tenantRootUrl:w});if(g.d.__next){S=u.sharedByMePageKeyFacet.serialize({itemSet:o.sharedByMeItemSetKeyFacet.deserialize(r),after:g.d.__next});b.push(S);y.merge(f.resolveNewPage({itemKey:S}).itemResolver)}y.resolveItems({items:(x={},x[r]=n.__assign(n.__assign({},l.childItemsFacet.pack({itemKeys:b})),l.parentItemFacet.pack({itemKey:E})),x[E]=n.__assign({},d.getInvalidationFacet().forFacet(l.defaultChildItemSetFacet).thenInvalidate(r,l.childItemsFacet).pack()),x)});e(y.execute());return[2]}})})}})});
define("bM",["require","exports","ww","K_","k8","$_","W3","aS","D6","gM"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMePageGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.sharedByMePageKeyFacet.deserialize(r).after,c=i.sharedByMePageKeyFacet.deserialize(r).itemSet;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(o.getData({url:l,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:c.webAbsoluteUrl}))];case 1:t=n.sent();h=a.sharedByMeItemSetKeyFacet.serialize(c);p=new s.ItemResolver;d=f.getAndProcessSharedByMeItemData(t,p);if(t.d.__next){v=i.sharedByMePageKeyFacet.serialize({itemSet:c,after:t.d.__next});d.push(v);p.merge(u.resolveNewPage({itemKey:v}).itemResolver)}p.merge(u.resolveExistingPage({itemKey:r,itemSetKey:h,childItemKeys:d}).itemResolver);e(p.execute());return[2]}})})}})});
define("SM",["require","exports","ww","K_","Ms","tc","Bc","$_","D6","M8","DM","e9","W3","Q1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,d=f.sharedByMeRootItemKeyFacet.deserialize(r).tenantRootUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,v,m,g,y;return n.__generator(this,function(b){switch(b.label){case 0:t=c.getStaticApiUrl({webAbsoluteUrl:d}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return[4,e(h.getData({url:t.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:d,noRedirect:!0}))];case 1:if(!((f=b.sent())&&f.d&&f.d.mySite))throw new i.ItemOperationError({facets:n.__assign({},p.itemNotFoundErrorFacet.pack({}))});v=f.d.mySite.replace(/\/$/,"");m=a.sharedByMeItemSetKeyFacet.serialize({webAbsoluteUrl:v||d});(g=new u.ItemResolver).resolveItems({items:(y={},y[r]=n.__assign(n.__assign(n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:m})),o.displayNameFacet.pack(l.default.sharedByYou)),o.folderFacet.pack({})),y)});e(g.execute());return[2]}})})}})});
define("iF",["require","exports","ww","K_","Cs","th","cc","nm","tc","Qi","Zr","X7","PT","Gi","QM"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.assignItemsToGroup=r.createBatchedItemsOperationHandler()(function(e){var t=e.items,r=Object.keys(t),v=t[r[0]].groupKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P;return n.__generator(this,function(n){switch(n.label){case 0:t=e(o.readItems(function(e){return e.demandItemFacet(f.spItemGroupKeyFacet,v)}));if(!(m=t&&t.itemSetKey&&f.spFolderItemSetKeyFacet.serialize(t.itemSetKey))||r.length<1||!v)return[2];g=e(i.readItem({spGroupField:p.spGroupFieldFacet,groupValue:p.groupValueFacet,parentGroupKey:p.parentGroupKeyFacet,defaultCollapsed:u.defaultCollapsedFacet},v)),y=g.spGroupField,b=g.groupValue,w=g.parentGroupKey,E=g.defaultCollapsed;S=[];y&&y.internalName&&b&&S.push({FieldName:y.internalName,FieldValue:b});if(w&&w.itemKey){x=e(i.readItem({parentGroupField:p.spGroupFieldFacet,parentGroupValue:p.groupValueFacet},w.itemKey)),T=x.parentGroupField,N=x.parentGroupValue;T&&T.internalName&&N&&S.push({FieldName:T.internalName,FieldValue:N})}if(t&&t.itemSetKey&&t.itemSetKey.filterParams&&(C=c.default.getFilterList(t.itemSetKey.filterParams,void 0,!0)).length>0)for(k=0;k<C.length;k++){L=C[k];A=e(i.readItem({isReadOnly:p.isReadOnlyFacet},l.spListFieldKeyFacet.serialize({listKey:t.itemSetKey,internalName:L.fieldName}))).isReadOnly;1===L.values.length&&!1===A&&S.push({FieldName:L.fieldName,FieldValue:L.values[0]})}return[4,e(h.bulkUpdateListItems({items:(M={},M[m]={itemKeys:r,formValues:S,qosName:"AssignItemsToGroup"},M)}))];case 1:n.sent();O={};r.forEach(function(e){O[e]={}});return[4,e(d.refreshItemsInSet({items:(_={},_[m]=O,_)}))];case 2:n.sent();e(E?s.invalidateItems({items:(D={},D[v]=[a.childItemsFacet],D)}):s.invalidateItems({items:(P={},P[m]=[a.childItemsFacet],P)}));return[2]}})})}})});
define("gF",["require","exports","ww","K_","qi","Qi","Bc","Bc","k6","$_","e9","W3"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={key:s.spPersonKeyFacet,displayName:u.displayNameFacet,email:a.emailFacet,picture:a.pictureFacet};t.likedByPeopleOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,u=s.likedByItemKeyFacet.deserialize(r),a=u&&u.spItem,p=a.webAbsoluteUrl,d=a.listFullUrl,v=a.itemId;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,m,g,y,b;return n.__generator(this,function(w){switch(w.label){case 0:t=v&&l.getListApiUrl({webAbsoluteUrl:p,listFullUrl:d}).method("GetItemById",v).segment("likedByInformation");u=new f.ItemResolver;return(m=t)?[4,e(c.getDataWithCache({url:t.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:p,listFullUrl:d}))]:[3,2];case 1:m=w.sent();w.label=2;case 2:g=[];(y=(a=m)&&a.d&&a.d.likedBy&&a.d.likedBy.results)&&y.forEach(function(e){var t,n=e.email,r=s.spPersonKeyFacet.serialize({id:String(n)});u.resolveItems({items:(t={},t[r]=i.pack(h,{key:{id:String(n)},displayName:e.name,email:n,picture:n}),t)});g.push(r)});u.resolveItems({items:(b={},b[r]=n.__assign({},o.likedByPeopleFacet.pack({personKeys:g})),b)});e(u.execute());return[2]}})})}})});
define("VU",["require","exports","ww","Ms","cc","Bc","K_","$_","tc","Y_","e9","W3","Qi","uk","Nb","u4"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemRemoveItemsFromSharedListOperationHandler=o.createBatchedItemsOperationHandler()(m);t.spItemFullUrlRemoveItemsFromSharedListOperationHandler=o.createBatchedItemsOperationHandler()(m);function m(e){var t=this,o=e.items,h=o[Object.keys(o)[0]].itemSetKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,p,d,v,m,y,b,w,E,S,x,T,N;return n.__generator(this,function(n){switch(n.label){case 0:t=[];return[4,e(g({itemSetKey:h}))];case 1:d=n.sent();v=function(n){var r=e(i.readItems(function(e){return e.demandItemFacet(s.canonicalUrlFacet,n)}))||"",o={DecodedUrl:decodeURIComponent(r)};o&&t.push(o)};for(m=0,y=Object.keys(o);m<y.length;m++){b=y[m];v(b)}p=JSON.stringify({itemPaths:t});w="RemoveItemsFromSharedWithMeViewByPath";E=l.getStaticApiUrl({webAbsoluteUrl:d}).segment("SP.Sharing.DocumentSharingManager."+w);return[4,e(c.getData({url:E.toString(),qosName:"RemoveFromSharedList",method:"POST",webAbsoluteUrl:d,body:p,noRedirect:!0}))];case 2:if((S=n.sent())&&S.d&&S.d[w]&&S.d[w].results){if((x=S.d[w].results).length<1)throw new r.ItemOperationError({message:f.default.DefaultTitle});x.forEach(function(e){if(!e.Success&&-3!==e.ErrorCode)throw new r.ItemOperationError({message:e.ErrorMessage||void 0})})}(T=new u.ItemResolver).invalidateItems({items:(N={},N[h]=[a.childItemsFacet],N)});e(T.execute());return[2]}})})}}function g(e){var t=this,r=e.itemSetKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,o;return n.__generator(this,function(n){switch(n.label){case 0:"";t=e(i.readItems(function(e){return e.demandItemFacet(d.sharedWithMeItemSetKeyFacet,r)}));s=t&&t.driveItemKey.endpoint||"";return[4,e(p.demandItems(function(e){return e.demandItemFacet(h.spItemKeyFacet,h.spOneDriveDocumentLibraryKeyFacet.serialize({tenantRootUrl:new v.default(s).authority}))}))];case 1:o=n.sent();return[2,o&&o.webAbsoluteUrl||""]}})})}}});
define("tF",["require","exports","ww","K_","W3","e9","KU"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateListItem=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,u=r.bNewDocumentUpdate,a=r.checkInComment,f=r.formValues,l=r.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,c,h,p,d;return n.__generator(this,function(n){switch(n.label){case 0:return f.length>0?[4,e(o.getSPItemInfo(t))]:[3,3];case 1:r=n.sent(),c=r.key,h=r.itemId;p=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return s.getListApiUrl({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).method("ValidateUpdateListItem").toString()})({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,itemId:h||c.itemId||""});(d={}).formValues=f;d.bNewDocumentUpdate=u;d.checkInComment=a;return[4,e(i.getData({body:JSON.stringify(d),listFullUrl:c.listFullUrl,method:"POST",qosName:l,url:p,webAbsoluteUrl:c.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=e.d.ValidateUpdateListItem.results[0];if(t.HasException)throw new Error(t.ErrorMessage||void 0)})];case 2:n.sent();n.label=3;case 3:return[2]}})})}})});
define("Tk",["require","exports","ww","Qi","Fk","K_","Cs","hk","qi","ih","tc","$_","Uk","u4","Is","Gi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemUploadItemsOperationHandler=s.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,s=e.itemKey,m=e.options.sourceEntries,g=r.spItemKeyFacet.deserialize(s),y=g.webAbsoluteUrl,b=g.listFullUrl,w=Object.keys(m)[0],E=m[w].progressItemKey;return function(m){return n.__awaiter(t,void 0,void 0,function(){var t,S,x,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:t=m(o.readItem({sourceFile:u.sourceFileFacet},w)).sourceFile;S=m(d.readConfiguration({listItemUploader:v.listItemUploaderConfigurationFacet})).listItemUploader,x=void 0===S?i.uploadListItem:S;return[4,m(x(e))];case 1:T=M.sent().itemKey;N=new c.ItemResolver;E&&t&&N.resolveItems({items:(L={},L[E]=n.__assign(n.__assign({},f.createdItemFacet.pack({itemKey:T})),a.pack({progressSize:f.progressSizeFacet},{progressSize:{current:t.size}})),L)});N.invalidateItems({items:(A={},A[s]=[l.defaultChildItemSetFacet],A)});if(g.listFullUrl){C=new p.SimpleUri(g.listFullUrl+"/Forms").path;if(g.rootFolder&&(g.rootFolder+"/").slice(0,C.length+1)===C+"/"){k=r.spListKeyFacet.serialize({webAbsoluteUrl:y,listFullUrl:b});m(h.saveUploadedTemplateToView({items:(O={},O[k]={childItemKey:T},O)}))}}m(N.execute());return[2]}})})}})});
define("uF",["require","exports","ww","Qi","uT","Fk","K_","Cs","hk","th","tc","p3","ih","qi","Is","Gi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadItemsToGroupOperationHandler=o.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,o=e.itemKey,m=e.options.sourceEntries,g=r.spItemGroupKeyFacet.deserialize(o),y=g&&g.itemSetKey,b=y.webAbsoluteUrl,w=y.listFullUrl,E=y.rootFolder,S=r.spItemKeyFacet.serialize({webAbsoluteUrl:b,listFullUrl:w,rootFolder:E}),x=Object.keys(m)[0],T=m[x].progressItemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,g,y,b,w,E;return n.__generator(this,function(N){switch(N.label){case 0:t=e(u.readItem({sourceFile:a.sourceFileFacet},x)).sourceFile;r=e(d.readConfiguration({listItemUploader:v.listItemUploaderConfigurationFacet})).listItemUploader,g=void 0===r?s.uploadListItem:r;return[4,e(g({itemKey:S,options:{sourceEntries:m}}))];case 1:y=N.sent().itemKey;N.label=2;case 2:N.trys.push([2,4,,5]);return[4,e(i.assignItemToGroup({items:(b={},b[y]={groupKey:o},b)}))];case 3:N.sent();return[3,5];case 4:N.sent();return[3,5];case 5:e(f.invalidateItems({items:(w={},w[S]=[l.defaultChildItemSetFacet],w)}));T&&t&&e(c.resolveItems({items:(E={},E[T]=n.__assign(n.__assign({},h.createdItemFacet.pack({itemKey:y})),p.pack({progressSize:h.progressSizeFacet},{progressSize:{current:t.size}})),E)}));return[2]}})})}})});
define("Yk",["require","exports","ww","qi","Bc","K_","Gi","Qi","e4","$_","Jk","k6"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={key:u.spPersonKeyFacet,displayName:i.displayNameFacet,email:c.emailFacet};t.spItemPlacesSetGetItemsOperationHandler=s.createSingleItemOperationHandler()(function(e){var t=e.itemKey,s=a.spItemPlacesSetKeyFacet.deserialize(t);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,c,p,d,v,m,g,y,b;return n.__generator(this,function(w){switch(w.label){case 0:a=s.siteUrl||"";c=s.listId||"";p=s.uniqueId||"";d=a+"/_api/web/Lists('"+c+"')/GetPlacesInformation('"+p+"')?$expand=places";w.label=1;case 1:w.trys.push([1,3,,4]);return[4,e(l.getRawData({url:d,qosName:"GetPlacesInformation",method:"GET",endpoint:a}))];case 2:v=w.sent();m=new f.ItemResolver;g=[];(y=v&&v.places)&&y.forEach(function(e){var t,n=e.userEntity.email,i=u.spPersonKeyFacet.serialize({id:String(n)});m.resolveItems({items:(t={},t[i]=r.pack(h,{key:{id:String(n)},displayName:e.userEntity.name,email:n}),t)});g.push(i)});m.resolveItems({items:(b={},b[t]=n.__assign(n.__assign(n.__assign({},o.placeMountedLocationsFacet.pack({locationKeys:g})),o.itemSourcePathFacet.pack(v.itemSourcePath)),i.displayNameFacet.pack(v.itemSourceSiteTitle)),b)});e(m.execute());return[3,4];case 3:throw w.sent();case 4:return[2]}})})}})});
define("lM",["require","exports","ww","dD","tC","$_","xS","K_","Qi","xS","uM","th"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spItemThumbnailGetItemsOperationHandler=u.createSingleItemOperationHandler({maxParallelOperationCount:16})(function(e){var t=this,u=r.spItemThumbnailKeyFacet.deserialize(e.itemKey).itemKey;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d;return n.__generator(this,function(v){switch(v.label){case 0:return[4,r(i.demandItems(function(e){var t=e.demandItemFacet(a.spItemKeyFacet,u),n=t&&a.spListKeyFacet.serialize(t),r=e.demandItemFacet(f.listMediaTransformFacet,n),i=e.demandItemFacet(f.itemMediaTransformFacet,u);return{generator:l.createThumbnailUrlGenerator({listMediaTransformSchema:r,itemMediaTransformSchema:i})}}))];case 1:t=v.sent().generator;(h=new s.ItemResolver).resolveItems(((p={items:(d={},d[e.itemKey]=n.__assign({},o.mediaTransformThumbnailUrlGeneratorFacet.pack(t)),d)})[u]=n.__assign({},c.getInvalidationFacet().forFacet(f.itemMediaTransformFacet).thenInvalidate(e.itemKey,o.mediaTransformThumbnailUrlGeneratorFacet).pack()),p));r(h.execute());return[2]}})})}})});
define("mM",["require","exports","ww","Qi","K_","$_","th","qi","tc","_M"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.projectionFacet=new u.Facet("projection");t.spProjectedUploadedItemSetGetItemsOperationHandler=i.createSingleItemOperationHandler()(function(e){var i=this,u=r.spProjectedUploadedItemSetKeyFacet.deserialize(e.itemKey).itemSetKey;return function(l){return n.__awaiter(i,void 0,void 0,function(){var i,c,h;return n.__generator(this,function(p){i=r.spFolderItemSetKeyFacet.serialize(u);(c=new s.ItemResolver).resolveItems({items:(h={},h[e.itemKey]=n.__assign(n.__assign({},t.projectionFacet.pack({})),o.getInvalidationFacet().forFacet(t.projectionFacet).thenInvalidate(function(){return function(){l(f.clearProjection({itemSetKey:i}))}}).pack()),h[i]=o.getInvalidationFacet().forFacet(a.childItemsFacet).thenInvalidate(e.itemKey,t.projectionFacet).pack(),h)});l(c.execute());return[2]})})}})});
define("jF",["require","exports","ww","Qi","Gi","K_","W3","$_","tC","ys","cc","ys","N5","e9"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SPTenantGetItemsOperationHandler=s.createSingleItemOperationHandler({maxParallelOperationCount:4})(function(e){var t=this,s=e.itemKey,d=r.spTenantKeyFacet.deserialize(s).tenantRootUrl;return function(s){return n.__awaiter(t,void 0,void 0,function(){var t,v,m,g,y,b,w,E,S,x,T,N;return n.__generator(this,function(C){switch(C.label){case 0:t=r.spWebPageContextKeyFacet.serialize({webAbsoluteUrl:d});return[4,s(a.demandItems(function(e){return e.demandItemFacet(i.onPremFacet,t)}))];case 1:v=C.sent();m=s(l.readItems(function(e){return e.demandItemFacet(f.localeFacet,c.configurationItemKey)}));g=!v;b=m&&m.language||"en-US";w=h.serializeQuery({Locale:b,v:2,msajax:1,cv:2});y=g?d+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+w:p.getStaticApiUrl({webAbsoluteUrl:d}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:b});return[4,s(o.getData({url:y.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:d,noRedirect:!0}))];case 2:E=C.sent();S=g?E:JSON.parse(E.d.GetSuiteNavData);x=!(!S.NavBarData||!S.NavBarData.AdminLink)||void 0;(T=new u.ItemResolver).resolveItems({items:(N={},N[e.itemKey]=n.__assign({},i.spTenantAdminFacet.pack(x)),N)});s(T.execute());return[2]}})})}})});
define("mF",["require","exports","ww","Qi","K_","Cs","Gi","e9","W3","_F","lF"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveViewCoreOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options,c=i.views,h=i.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(n){switch(n.label){case 0:i=r.spListViewsSetKeyFacet.deserialize(t);p=Object.keys(c)[0];if(!i||!p)return[3,4];d=c[p],v=d.itemSetKey,m=d.shouldSaveViewFieldsOnly,g=d.newDocumentTemplatesJsonString,y=d.shouldSaveAggregationsOnly;b=e(s.readItem({deserializedViewKey:r.spViewKeyFacet,currentDerivedView:o.currentDerivedViewFacet},p)),w=b.deserializedViewKey,E=b.currentDerivedView;S=w&&w.viewId;if(!E||!S)return[3,4];x=void 0;return m||g||y?[4,e(l.getViewById({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl,viewId:S}))]:[3,2];case 1:if((T=n.sent())&&T.view){x=T.view;m?x.replaceFields(E.getEffectiveFieldNames()):g?x.updateNewDocumentTemplates(g):y&&x.replaceAggregates(E.getEffectiveAggregatesData())}return[3,3];case 2:N=e(s.readItem({deserializedItemSetKey:r.spFolderItemSetKeyFacet,filterableSet:o.spFilterableSetFacet},v)),C=N.deserializedItemSetKey,k=N.filterableSet;if(C){x=f.combineItemSetInfoAndView({sourceView:E,deserializedItemSetKey:C,appliedFilters:k&&k.appliedFilters});(L=e(s.readItem({viewType:o.viewTypeFacet},p)).viewType)&&x.updateViewType(L)}n.label=3;case 3:if(x){x.prepareForSaving();if(E.isDirty()||x.isDirty()){A=u.getListApiUrl({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl}).method("Views",S).method("SetViewXml");return[2,e(a.getData({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl,url:A.toString(),method:"POST",body:JSON.stringify({viewXml:x.getEffectiveViewXml()}),qosName:h||"saveView"}))]}}n.label=4;case 4:return[2]}})})}})});
define("Rk",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isErrorData=function(e){return!!e&&("status"in e||!(!e.message||"object"!=typeof e.message))};t.getErrorMessage=function(e){return e&&e.message&&("object"==typeof e.message?e.message.value:e.message.toString())||""}});
define("Lk",["require","exports","is"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharePointDataEventSource=n.asOnceOnly(function(e){return{}})});
define("EP",["require","exports","ww","r","Q4","Wv","Gi","CD","Z4","LP","p4","r","Yv","CC","cs","xI","CD","tc","Qi","H8","zi","ODBItemsScopeDeferred_mini_css","ra","vI","pc","K8","Nd"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";E=E.CustomFormatterItemTile_6;Object.defineProperty(t,"__esModule",{value:!0});function k(e,t){return{enableItemHoverCard:!1}}var L=s.connectToItemCache(function(e,t){var n=O(e,t.itemSetKey),r=n.viewFormatter,i=n.isGenerated,s=n.isTileDesignerTemplateApplied;return{customFormatterFeature:r&&e.demandItemFacet(u.customTileFormatterFeatureFacet,u.customFormatterFeatureKeyFacet.serialize({})),viewFormatter:r,isGenerated:i,isTileDesignerTemplateApplied:s,dispatch:e.dispatch,isDefaultCardEnabled:l.isFeatureEnabled(e,{feature:{ODB:1615}}),cardDesignerFeatureEnabled:b.cardDesignerFeatureFlightEnabled(e)}})(function(e){c.useEffect(function(){if(y&&y.isTileFormatterAvailable()&&0===A){x||N.isTileDesignerTemplateApplied?e.dispatch(a.logEngagement({name:"GalleryViewRender",isIntentional:!0})):e.dispatch(a.logEngagement({name:"CustomFormatterTileLoad",isIntentional:!0}));y.hasFormatterReferences()&&e.dispatch(a.logEngagement({name:"FormatterReferenceTile",isIntentional:!0}))}},[]);var t=r.useState(!1),i=t[0],s=t[1],o=r.useState([]),u=o[0],f=o[1],l=r.useState(-1),d=l[0],v=l[1],m=e.defaultRender,g=e.customFormatterFeature,y=e.viewFormatter,b=e.isDefaultCardEnabled,w=e.cardDesignerFeatureEnabled,x=e.isGenerated,N=n.__rest(e,["defaultRender","customFormatterFeature","viewFormatter","isDefaultCardEnabled","cardDesignerFeatureEnabled","isGenerated"]);if(!m)return null;var L=g&&g.tileRenderer,A=N.selectionIndex,O=N.itemKey,M=N.itemSetKey,_=void 0===M?"":M;if(y&&y.isTileFormatterAvailable()&&L){var D=y.shouldHideSelectionInTiles(),P=y.getTileFormatter(),H=r.createElement(m,n.__assign({},N,w?{href:void 0,invokeSelection:!1}:{},{className:S.css(N.className,E.customTile),itemName:null,itemActivity:null,foreground:null,isSelectable:!D,selection:D?void 0:N.selection,selectionIndex:D?-1:N.selectionIndex,background:r.createElement(C.FocusZone,{handleTabKey:C.FocusZoneTabbableElements.all,direction:C.FocusZoneDirection.domOrder,tabIndex:i?0:-1,onKeyDown:function(e){if(e.which===T.KeyCodes.tab){var t=d+1;if(t<u.length&&u[t]){u[t].focus();v(t);e.stopPropagation();e.preventDefault()}}else v(-1)},className:E.customTileFocusZone},r.createElement(L,{rowIndex:A,itemKey:O,itemSetKey:_,formatter:P})),onFocus:function(e){s(!0);var t=e.currentTarget.querySelectorAll(".sp-card-keyboard-focusable");f(t)},onBlur:function(e){s(!1);f([]);v(-1)}}));return b&&P?r.createElement(h.ControlHandlerProvider,{controlHandlers:p.itemTileControl.pack(k)},H):H}return r.createElement(m,n.__assign({},N))}),A=new d.ComputedItemFacet("generatedViewFormatter",function(e,t){var n=t.itemKey;if(e.isItemFacetResolved(o.listSchemaFacet,n)&&n){var r=f.getKeyForViewFormatter(e,{itemSetKey:n}),s=e.demandItemFacet(m.customTileFormatterFeatureFacet,m.customFormatterFeatureKeyFacet.serialize({})),u=e.demandItemFacet(y.spFolderItemSetKeyFacet,n);if(u&&r&&s){var a=e.demandItemFacet(o.listFacet,y.spListKeyFacet.serialize(u)),c=v.readItemSetSchemaFromItemCache(e,{mapping:{fieldData:o.fieldDataFacet},itemSetKey:n}),h=l.isFeatureEnabled(e,{feature:{ODB:522}}),p=l.isFeatureEnabled(e,{feature:{ODB:1822}}),d=c.map(function(e){return e.fieldData}),b={};if(p){var E=e.demandItem({schema:g.schemaFacet},n).schema,S=E&&E.columnKeys;S&&h&&(b=N.getFieldFormatters(e,S))}var x=a&&a.templateType||w.default.invalidType,T=d&&d.length>0&&x===w.default.genericList,C=i.getViewFormatterFacetObjFromString({formatter:void 0,fieldFormatters:b,generatedTileProps:T?s.tileDesigner.createDefaultTileProps(d,Object.keys(b).length>0?{fieldFormatters:b}:void 0):void 0,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:p}});if(C)return C.viewFormatter}}});function O(e,t){var n=!1;if(!t)return{viewFormatter:void 0,isGenerated:n,isTileDesignerTemplateApplied:!1};var r=e.demandItemFacet(o.viewFormatterFacet,f.getKeyForViewFormatter(e,{itemSetKey:t})),i=r&&r.viewFormatter,s=i&&i.getTileProps(),u=Boolean(i&&i.isTileDesignerTemplateApplied());u&&(i=e.demandItemFacet(M,t));if(!(s&&s.formatter&&s.formatter)&&b.cardDesignerFeatureFlightEnabled(e)){i=e.demandItemFacet(A,t);n=!0}return{viewFormatter:i,isGenerated:n,isTileDesignerTemplateApplied:u}}var M=new d.ComputedItemFacet("postColumnDeleteViewFormatterFacet",function(e,t){var n=t.itemKey,r=e.demandItemFacet(o.viewFormatterFacet,f.getKeyForViewFormatter(e,{itemSetKey:n})),s=r&&r.viewFormatter;if(n){for(var u=v.readItemSetSchemaFromItemCache(e,{mapping:{fieldData:o.fieldDataFacet},itemSetKey:n}),a=[],c={},h=0;h<u.length;h++){var p=u[h],d=p.fieldData?p.fieldData.RealFieldName:"";if(d){a.push(p.fieldData);c[d]=p.fieldData}}var b=s&&s.getTileFormatterDesignerConfig(),E=e.demandItemFacet(m.customTileFormatterFeatureFacet,m.customFormatterFeatureKeyFacet.serialize({})),S=e.demandItemFacet(y.spFolderItemSetKeyFacet,n),x=S&&e.demandItemFacet(o.listFacet,y.spListKeyFacet.serialize(S)),T=x&&x.templateType||w.default.invalidType,C=l.isFeatureEnabled(e,{feature:{ODB:522}}),k=l.isFeatureEnabled(e,{feature:{ODB:1822}});if(E){var L=E.tileDesigner,A=L.encodeTileDesignerConfig,O=L.decodeTileDesignerConfig,M=L.createJSONFromConfig,_=L.shouldExcludeColumnInCards,D=L.encodeTileDesignerConfigForDocLib,P=b&&O(b),H=[],B={};if(C){var j=e.demandItem({schema:g.schemaFacet},n).schema,F=j&&j.columnKeys;F&&(B=N.getFieldFormatters(e,F))}if(P){var I=!1;for(h=0;h<P.columns.length;h++){var q=P.columns[h],R=void 0;switch(q.id){case"LinkTitle":R="Title";break;case"LinkFilename":R="FileLeafRef";break;default:R=q.id}_(c[R],R)?I=!0:H.push(q)}P.columns=H;var U=T===w.default.documentLibrary?D(P,!0):A(P);if(I||C){var z=M(a,U,Object.keys(B).length>0?{fieldFormatters:B}:void 0,T),W=i.getViewFormatterFacetObjFromString({formatter:JSON.stringify({tileProps:z}),fieldFormatters:B,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:k}});return W&&W.viewFormatter}}}}return s});t.getCustomFormatterItemTileOverrides=function(e,t){var n=O(e,t).viewFormatter,r=n&&n.isTileFormatterAvailable(),i=x.isGroupHeaderFooterFormatterFlightEnabled(e)?x.getCustomGroupHeader(t,"TILES"):void 0;if(!r)return i?{groupControlHandler:_(i)}:{};var s=(function(e){var t=254,n=340,r=e&&e.getTileProps(),i=r&&r.width&&r.width>=0?r.width:t;return{height:r&&r.height&&r.height>=0?r.height:n,width:i,disableMarqueeSelection:r&&r.hideSelection}})(n),o=s.height,u=s.width,a=s.disableMarqueeSelection,f=n&&n.fillCardsHorizontally()?3:1;return{tileRenderer:L,grid:{minRowHeight:o,mode:f},className:"sp-gallery-listContainer",disableMarqueeSelection:a,tileControlHandler:function(){return{desiredSize:{width:u,height:o}}},groupControlHandler:_(i)}};function _(e){return function(){return n.__assign(n.__assign({},e?{headerRenderer:e}:{}),{maxItemCount:30})}}});
define("XU",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.endsWith=function(e,t){var n=e.length,r=t.length,i=!0;if(n>=r)for(var s=0;s<r&&i;s++)e.charAt(n-(s+1))!==t.charAt(r-(s+1))&&(i=!1);else i=!1;return i};t.btoa=function(e){for(var t=e,n="",r=0,i=void 0,s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|s)||(o="=",s%1);n+=o.charAt(63&r>>8-s%1*8)){if((i=t.charCodeAt(s+=.75))>255)throw new Error("Unable to obtain default share URL: btoa failed");r=r<<8|i}return n}});
define("_M",["require","exports","ww","cc","Qi","tc","Z_","Zv","hM","ih","p3","Gi"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.clearProjection=function(e){var t=this,h=e.itemSetKey,p=i.spFolderItemSetKeyFacet.deserialize(h),d=i.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:p});return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(h){e(r.readItems(function(e){var t=u.getConfiguration(e,{isProjectedUploadedItemSetEnabled:c.enableProjectedUploadedItemSetConfigurationFacet}).isProjectedUploadedItemSetEnabled;if(void 0!==t&&t){var n=i.spItemKeyFacet.serialize(p),r=e.demandItemFacet(c.activeUploadProjectionFoldersFacet,n);if(r&&Object.keys(r).length>0)return!1;for(var l=e.demandItemFacet(s.childItemsFacet,o.progressRootItemKey),h=0,d=l&&l.itemKeys||[];h<d.length;h++){var v=d[h];if(e.demandItemFacet(a.uploadProgressKeyFacet,v)){var m=e.demandItemFacet(f.destinationItemFacet,v),g=e.demandItemFacet(i.spItemKeyFacet,m&&m.itemKey);if(g&&g.rootFolder===p.rootFolder)return!1}}}return!0}))&&e(l.resolveItems({items:(t={},t[d]=n.__assign({},s.childItemsFacet.pack({itemKeys:[]})),t)}));return[2]})})}}});
define("gM",["require","exports","ww","Ue","FS","th","tc","Bc","k6","Wi","vM","Qi","sb","t4","i4","a4","n4","Vb","Gi","qS"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAndProcessSharedByMeItemData=function(e,t){var w=[];e.d.results.forEach(function(e){var E,S,x,T,N=""+new r.SPResourcePath(e.SiteUrl).authority+e.UrlPath,C=e.LinkingUrl?e.LinkingUrl:N,k=c.spItemFullUrlKeyFacet.serialize({itemFullUrl:N});w.push(k);var L=i.iso8601DateTimeToJsDate(e.Modified),A=(function(e){var t=l.getParentItemUrl(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:c.spItemFullUrlKeyFacet.serialize(n)}})(N),O=A.parentItemKey,M=A.parentItemUrl;t.mapKeys({mappings:(E={},E[c.spItemFullUrlKeyFacet.serialize({itemFullUrl:M})]=O,E)});var _=(function(e,t){var n=void 0!==t?t:3,r=!1,i=!1;if(e.IsContainer){n=h.FileIconType.folder;i=!0}"OneNote.Notebook"===e.ProgId&&(r=!0);return{isOneNote:r,isDocSet:!1,fileIconType:n,isFolder:i}})(e),D=e.SpItemUrl?d.getDriveItemKey(e.SpItemUrl):void 0;if(D)for(var P=0,H=d.getEndpointVersionKeyAliases(D);P<H.length;P++){var B=H[P];t.mapKeys({mappings:(S={},S[B]=k,S)})}var j=e.Editor,F=c.spPersonKeyFacet.serialize({id:j.email}),I={itemKey:F,displayValue:j.name};t.resolveItems({items:(x={},x[F]=n.__assign(n.__assign({},u.displayNameFacet.pack(j.name)),a.emailFacet.pack(j.email)),x)});t.resolveItems({items:(T={},T[k]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},u.displayNameFacet.pack(e.FileLeafRef)),u.isSharedFacet.pack(!0)),u.fileNameFacet.pack({name:e.FileLeafRef,extension:e.Extension})),f.fileIconTypeFacet.pack(_.fileIconType)),u.dateModifiedFacet.pack(L.getTime())),u.canonicalUrlFacet.pack(N)),u.parentFolderItemFacet.pack({itemKey:O})),u.modifiedByPersonFacet.pack(I)),f.oneNoteFacet.pack(_.isOneNote?{}:void 0)),u.folderFacet.pack(_.isFolder?{}:void 0)),u.openUrlFacet.pack(C)),g.driveItemKeyFacet.pack(D)),y.listItemIdFacet.pack(e.ListItemId.toString())),e.UniqueId?y.uniqueIdFacet.pack(b.normalizeLower(e.UniqueId,!1)):{}),e.ListId?y.listIdFacet.pack(b.normalizeLower(e.ListId,!1)):{}),D?n.__assign(n.__assign(n.__assign({},u.analyticsItemFacet.pack({itemKey:v.driveAnalyticsItemKeyFacet.serialize({driveItemKey:D})})),u.followedItemFacet.pack({itemKey:m.driveFollowedItemKeyFacet.serialize({driveItemKey:D})})),u.activityItemFacet.pack({itemKey:p.driveActivityItemKeyFacet.serialize({driveItemKey:D})})):{}),s.getInvalidationFacet().forFacet(u.displayNameFacet).thenInvalidate(k,o.childItemsFacet).pack()),T[O]=n.__assign(n.__assign(n.__assign({},u.folderFacet.pack({})),u.canonicalUrlFacet.pack(M)),u.openUrlFacet.pack(M)),T)})});return w}});
define("WM",["require","exports","Gi","Bc","ty","Wi"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isFolder=function(e,t){var n=t.itemKey,i=t.includeOneNote,o=e.demandItem({folder:r.folderFacet,oneNote:s.oneNoteFacet},n),u=o.folder,a=o.oneNote;return i?!!u||!!a:!!u&&!a};t.isApprovalRelevant=function(e,t){var s=t.itemKey,o=t.listFacets,u=!!o&&!!o.isModerated;if(u){var a=e.demandItem({permissions:n.permissionsFacet,checkoutInfo:r.isCheckedOutFacet},s),f=a.permissions,l=a.checkoutInfo;u=!!(!l||!l.byOther&&!l.byYou)&&!!f&&i.PermissionMask.hasItemPermission({permissions:f},i.PermissionMask.editListItems)&&i.PermissionMask.hasItemPermission({permissions:f},i.PermissionMask.approveItems)}return u}});
define("KU",["require","exports","ww","Qi","Gi","tC","cc"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSPItemInfo=function(e){var t=this;return function(u){return n.__awaiter(t,void 0,void 0,function(){var t,a,f;return n.__generator(this,function(n){switch(n.label){case 0:t=u(o.readItems(function(t){return t.demandItemFacet(r.spItemKeyFacet,e)}));return[4,u(s.demandItems(function(t){return t.demandItem({listItemId:i.listItemIdFacet},e)}))];case 1:a=n.sent().listItemId;if(!t)throw new Error("Cannot get spItemKeyFacet for itemKey: "+e);if(!(f=a||t.itemId))throw new Error("Cannot find itemId for itemKey: "+e);return[2,{key:t,itemId:f}]}})})}}});
define("vM",["require","exports","Qi","Te"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mapParentItemKey=function(e,t){var i,s=""+new r.SimpleUri(e.webAbsoluteUrl).authority+e.rootFolder;e.rootFolder||(s=e.listFullUrl);t.mapKeys({mappings:(i={},i[n.spItemKeyFacet.serialize(e)]=n.spItemFullUrlKeyFacet.serialize({itemFullUrl:s}),i)})};t.getParentItemUrl=function(e){return""+(""+new r.SimpleUri(e).authority)+new r.SimpleUri(e).segments.slice(0,-1).join("/")}});
define("KM",["require","exports","Gi","Bc","ty","dS","Gi","GM","Qi","WM","cS","Y9"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h="0x0101009D1CB255DA76424F860D91F20E6C4118";(function(e){e[e.publish=0]="publish";e[e.schedule=1]="schedule"})(t.PublishType||(t.PublishType={}));t.canPublishOrSchedule=function(e,t){var u,l,h;if(!t)return!1;var d=e.demandItem({firstItemKey:a.spItemKeyFacet,permissions:n.permissionsFacet,checkoutInfo:r.isCheckedOutFacet,needsPublishing:n.needsPublishingFacet},t),v=d.firstItemKey,m=d.permissions,g=d.checkoutInfo,y=d.needsPublishing;if(!v)return!1;var b=e.demandItemFacet(n.listFacet,a.spListKeyFacet.serialize({webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl}));return Boolean(y&&i.PermissionMask.hasItemPermission({permissions:m},i.PermissionMask.editListItems)&&(null===(u=b)||void 0===u?void 0:u.enableMinorVersions)&&(null===(l=b)||void 0===l?void 0:l.isDocumentLibrary)&&!(null===(h=g)||void 0===h?void 0:h.byOther)&&!c.isPageScheduled(e,t)&&!(function(e,t){var n=t.itemKey,r=t.listFacets,i=e.demandItem({moderationStatusType:o.moderationStatusTypeFacet},n).moderationStatusType;if(r&&r.isModerated)return"number"==typeof i&&i!==s.ModerationStatusType.draft&&i!==s.ModerationStatusType.denied&&i!==s.ModerationStatusType.pending;var u=p(e,n);return 0===u.minor&&0!==u.major})(e,{itemKey:t,listFacets:b})&&!f.isFolder(e,{itemKey:t,includeOneNote:!0}))};t.getNextPublishedVersion=function(e){return e?""+512*(Math.floor(Number(e)/512)+1):""};t.isSitePage=function(e){return!!e&&0===e.indexOf(h)};function p(e,t){var n=e.demandItem({uiVersion:o.uiVersionFacet},t).uiVersion;return l.parseUIVersionString(n)}t.getVersion=p;t.getPublishActionType=function(e,t){var r,i=e.demandItem({firstItemKey:a.spItemKeyFacet,moderationStatusType:o.moderationStatusTypeFacet},t),f=i.firstItemKey,l=i.moderationStatusType;return f?(null===(r=e.demandItemFacet(n.listFacet,a.spListKeyFacet.serialize({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl})))||void 0===r?void 0:r.isModerated)?l===s.ModerationStatusType.pending?u.PublishActionType.CancelApproval:u.PublishActionType.SubmitForApproval:c.isPublishStartDateInFuture(e,t)?u.PublishActionType.SchedulePublish:0===p(e,t).major?u.PublishActionType.Publish:u.PublishActionType.Republish:u.PublishActionType.Publish}});
define("PU",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isProgIdTeamChannelFolder=function(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}});
define("yWe",["require","exports","ww","Cs","cc","Bc","$_","Is","vWe","Vb","i4","Ki","Yy","p4","xS","Qi","W3","$k","Gi","k","N"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey}e.prototype.onUnsubscribe=function(e){};e.prototype.getSubscription=function(e){var t,n,r,s,o,u,a,f,l,c=this,h=e(i.readItems(function(e){return{spItem:e.demandItemFacet(v.spItemKeyFacet,c._rootItemKey)}})).spItem;if((null===(t=h)||void 0===t?void 0:t.webAbsoluteUrl)&&h.listFullUrl){var p=v.spListKeyFacet.serialize({webAbsoluteUrl:null===(n=h)||void 0===n?void 0:n.webAbsoluteUrl,listFullUrl:null===(r=h)||void 0===r?void 0:r.listFullUrl}),d=e(i.readItems(function(e){return e.demandItemFacet(y.listSubscriptionFacet,p)}));if((null===(s=d)||void 0===s?void 0:s.notificationUrl)&&(null===(o=d)||void 0===o?void 0:o.expirationDateTime)&&(null===(u=d)||void 0===u?void 0:u.subscribeID))return{notificationUrl:null===(a=d)||void 0===a?void 0:a.notificationUrl,expirationDateTime:null===(f=d)||void 0===f?void 0:f.expirationDateTime,id:null===(l=d)||void 0===l?void 0:l.subscribeID}}};e.prototype.getChangeMessages=function(e,t,s){var a;return n.__awaiter(this,void 0,void 0,function(){var E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z=this;return n.__generator(this,function(n){switch(n.label){case 0:if(void 0===s||void 0===s.endpoint||void 0===s.driveId)throw"Invalid drive url parts";E=s.endpoint+"/drives/"+s.driveId;S=e(u.readConfiguration({isTAB:c.isTestMode})).isTAB;x=e(i.readItems(function(e){var t=e.demandItemFacet(v.spItemKeyFacet,Z._rootItemKey);return{spItem:t,pageContext:t&&e.demandItemFacet(y.spPageContextFacet,v.spPageContextKeyFacet.serialize(t)),clientTimeStampEnabled:p.isFeatureEnabled(e,{feature:{ODB:1844}})}})),T=x.spItem,N=x.pageContext,C=x.clientTimeStampEnabled;k=new o.ItemResolver;if(C&&"latest"===t&&T){L=v.spListKeyFacet.serialize({webAbsoluteUrl:T.webAbsoluteUrl,listFullUrl:T.listFullUrl});A=e(i.readItems(function(e){return e.demandItemFacet(y.listFacet,L)}));if(O=null===(a=A)||void 0===a?void 0:a.tick){M=O-621355968e9;M/=1e4;return[2,{syncToken:""+new Date(M).toISOString(),messages:[],itemResolver:k}]}}if(!N||!b.getKillSwitch(N).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!S)return[3,1];_=e(i.readItems(function(e){var t=T&&v.spListKeyFacet.serialize(T),n=e.demandItemFacet(d.listMediaTransformFacet,t),r=n&&n[".driveAccessToken"];return r&&r.replace("access_token=","")}));return[3,3];case 1:return[4,e(m.getAuthToken({url:E,disallowCookies:!0}))];case 2:_=n.sent();n.label=3;case 3:return[3,7];case 4:return(P=s.endpoint)?[4,e(g.getSessionToken(s.endpoint,E))]:[3,6];case 5:P=n.sent();n.label=6;case 6:_=(D=P)&&D.accessToken;n.label=7;case 7:if(void 0===_)throw new w.ApiError({code:"authFailure"});H=N&&b.getKillSwitch(N).isActivated("C827C03F-4B57-4B6A-8BAB-3AE30D6AB56B","01/23/2020","including drive endpoint in the path")?"/drive/root/view.delta?token="+encodeURIComponent(t):E+"/root/view.delta?token="+encodeURIComponent(t);return[4,this._dataRequestor.send({apiName:"viewDelta",path:H,accessToken:{accessToken:_,tokenUrl:E},useAuthorizationHeaders:!0,headers:{"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"}})];case 8:B=n.sent();j=[];if(B&&B.value)for(F=0,I=B.value;F<I.length;F++){q=I[F];R=void 0;U={endpoint:s.endpoint,driveId:s.driveId,itemId:q.id};if(q.root){$=l.getEndpointVersionKeyAliases(U);for(z=0,W=$;z<W.length;z++){Q=W[z];k.mapKeys({mappings:(G={},G[Q]=this._rootItemKey,G)})}}else if(q.webUrl&&(X=h.getDecodedUrl(q.webUrl))){V=v.spItemFullUrlKeyFacet.serialize({itemFullUrl:X});if(e(r.readItem({spItemKey:v.spItemKeyFacet},V)).spItemKey){$=l.getEndpointVersionKeyAliases(U);for(J=0,K=$;J<K.length;J++){Q=K[J];k.mapKeys({mappings:(Y={},Y[Q]=V,Y)})}}}if(!q.root){q.parentReference&&(R=q.parentReference.id);j.push({itemKey:f.driveItemKeyFacet.serialize(U),parentItemKey:R&&f.driveItemKeyFacet.serialize({endpoint:s.endpoint,driveId:s.driveId,itemId:R}),isDeleted:!!q.deleted,isShared:!!q.shared,name:q.name,dateModified:q.lastModifiedDateTime,eTag:q.eTag})}}return[2,{syncToken:B["@delta.token"],messages:j,itemResolver:k}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(r.readItem({deleted:s.deletedFacet},t.itemKey)).deleted)return;return{type:a.ItemAutoRefreshChangeType.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(r.readItem({spItemKey:v.spItemKeyFacet,mediaTransformSchema:d.itemMediaTransformFacet,displayName:s.displayNameFacet},t.itemKey)),o=i.spItemKey,u=i.mediaTransformSchema,f=i.displayName;if(void 0===o){if(!t.parentItemKey)return;return{type:a.ItemAutoRefreshChangeType.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(u&&t.eTag){var l=u[".etag"];if(l&&t.eTag&&t.eTag!==l)return{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:d.itemMediaTransformFacet,reason:"eTag changed from "+l+" to "+t.eTag}}if(void 0!==t.name&&f!==t.name)return{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:s.displayNameFacet,reason:"Name changed from "+f+" to "+t.name}};return e})();t.default=E});
define("gWe",["require","exports","ww","Cs","cc","Bc","tc","$_","vWe","Ae","xe","CS","yS","Gi","Qi","bWe","o4","I7","$s","iS","f4","k"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof v.default){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getSubscription=function(e){var t,n,r,s,o,u;if(this._webAbsoluteUrl&&this._listFullUrl){var a=d.spListKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),f=e(i.readItems(function(e){return e.demandItemFacet(p.listSubscriptionFacet,a)}));if((null===(t=f)||void 0===t?void 0:t.notificationUrl)&&(null===(n=f)||void 0===n?void 0:n.expirationDateTime)&&(null===(r=f)||void 0===r?void 0:r.subscribeID))return{notificationUrl:null===(s=f)||void 0===s?void 0:s.notificationUrl,expirationDateTime:null===(o=f)||void 0===o?void 0:o.expirationDateTime,id:null===(u=f)||void 0===u?void 0:u.subscribeID}}};e.prototype.getChangeMessages=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var r,s,o,a,h,p,v,y,b,w,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W=this;return n.__generator(this,function(X){switch(X.label){case 0:if(o=!!t&&"SPO_LIST,"===t.substr(0,9)){a=t.split(",");h=a[1];p=a[2];v='<Eq><FieldRef Name="Modified" />';v+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+p+"</Value></Eq>";y='<Gt><FieldRef Name="ID" /><Value Type="Number">'+h+"</Value></Gt>";r=f.combineFilters([v,y],l.CamlTags.and);b='<Gt><FieldRef Name="Modified" />';b+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+p+"</Value>";b+="</Gt>";r=f.combineFilters([r,b],l.CamlTags.or);s=["ID","FileRef","Modified","Title"];w=this._getListColumns(e);for(S=0,x=w;S<x.length;S++)"ID"!==(T=x[S]).internalName&&"FileRef"!==T.internalName&&"Modified"!==T.internalName&&"Title"!==T.internalName&&s.push(T.internalName)}else s=["ID","FileRef","Modified"];"ID";N=o;C=o?200:1;k=new c.default("<View></View>");r&&k.addFilters([r]);s&&k.replaceFields(s);k.updateSort({fieldName:"ID",isAscending:N});k.updateRowLimit({rowLimit:C,isPerPage:!1});L=e(i.readItems(function(e){return g.getPageContextFromItemCache(e,d.spItemKeyFacet.serialize({webAbsoluteUrl:W._webAbsoluteUrl,listFullUrl:W._listFullUrl}))}));this._requestDatesInUtc=!L||E.getKillSwitch(L).isActivated("3599C6B2-C5C1-42F2-A5E1-CA0C352D20AB","01/09/2020","Do not request dates in UTC for autorefresh");return[4,e(m.getServerData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:k.getEffectiveViewXml(),postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:L}))];case 1:A=X.sent();this._serverResponse=A;O=A.ListData;M=O&&O.Row||[];_=[];D=this._getLastIdInList(M);P=o?this._getLastModifiedTimeInList(M,L):(new Date).toISOString();for(H=0,B=M;H<B.length;H++)if(void 0!==(j=B[H]).FileRef){F={};I=Object.keys(j);for(q=0,R=I;q<R.length;q++){U=R[q];z=0===U.indexOf("OData_")?U.substr(6):U;F[z]=j[U]}_.push(n.__assign(n.__assign({itemKey:d.spItemKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:j.ID}),parentItemKey:d.spItemKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:j.Title||""},j.Modified?{dateModified:""+j.Modified}:{}),{fields:F}))}0===_.length&&_.push({itemKey:d.spItemKeyFacet.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});return[2,{syncToken:"SPO_LIST,"+D+","+P,messages:_,itemResolver:new u.ItemResolver}]}})})};e.prototype.updateItems=function(e,t){if(t&&d.spFolderItemSetKeyFacet.matches(this._itemSetKey)&&this._serverResponse){var n=d.spFolderItemSetKeyFacet.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(w.getContentTypes({itemSetKey:r})),s=e(w.constructGetItemContext(n,i,"getSPItem")),o=e(b.processResponse({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(o.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){if(void 0===t.parentItemKey)return{type:a.ItemAutoRefreshChangeType.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"};if(t.isDeleted){if(e(r.readItem({deleted:s.deletedFacet},t.itemKey)).deleted)return;return{type:a.ItemAutoRefreshChangeType.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var o=e(i.readItems(function(e){return e.isItemFacetResolved(d.spItemKeyFacet,t.itemKey)?{rowData:e.demandItemFacet(p.rowDataFacet,t.itemKey),spItemKey:e.demandItemFacet(d.spItemKeyFacet,t.itemKey),title:e.demandItemFacet(p.titleFacet,t.itemKey),selectedItemKeys:y.getSelectedItemKeys(e,{itemsScopeItemKey:n})}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:void 0}})),u=o.rowData,f=o.spItemKey,l=o.title,c=o.selectedItemKeys,h=c&&c.length>0;if(void 0===f||void 0===u){if(!t.parentItemKey)return;if(void 0===e(r.readItem({spParentItemKey:d.spItemKeyFacet},t.parentItemKey)).spParentItemKey)return;return h?void 0:{type:a.ItemAutoRefreshChangeType.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==l&&void 0!==t.name&&l!==t.name)return{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:p.titleFacet,reason:'Item title changed from "'+l+'" to '+t.name+")"};if(t.fields){h||(this._serverResponse=void 0);for(var v=this._getListColumns(e),m=function(e){for(var n=e.internalName,r=0,i=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});r<i.length;r++){var s=i[r],o=u&&u[s],f=t.fields[s];try{"object"==typeof o&&(o=JSON.stringify(o));"object"==typeof f&&(f=JSON.stringify(f));if(g._requestDatesInUtc&&"DateTime"===e.fieldType){var l=Date.parse(o),c=Date.parse(f);if(!isNaN(l)&&!isNaN(c)){o=l;f=c}}}catch(e){continue}if(o!==f)return{value:{type:a.ItemAutoRefreshChangeType.Update,invalidateKey:t.itemKey,invalidateFacet:p.rowDataFacet,hasSelection:h,reason:'Item field "'+n+'" changed from "'+o+'" ('+typeof o+') to "'+f+'" ('+typeof f+")"}}}},g=this,b=0,w=v;b<w.length;b++){var E=m(w[b]);if("object"==typeof E)return E.value}}};e.prototype._getLastIdInList=function(e){return e&&e.length>0?Math.max.apply(Math,e.map(function(e){return parseInt(e.ID,10)})):0};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n=""+u}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(r.readItem({schema:o.schemaFacet},this._itemSetKey)).schema,i=n&&n.columnKeys;if(i)for(var s=0,u=i;s<u.length;s++){var a=u[s],f=e(r.readItem({internalName:p.internalNameFacet,fieldType:p.fieldTypeFacet,mappedFieldType:p.mappedColumnFieldTypeFacet},a)),l=f.internalName,c=f.fieldType,d=f.mappedFieldType;void 0!==l&&void 0!==c&&void 0!==d&&d!==h.default.Title&&t.push({internalName:l,fieldType:c,mappedFieldType:d})}return t};return e})();t.default=S});
define("bWe",["require","exports","ww","W_","i3","Is","Ki","aM","M","q3","W3","e9"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:819,ODC:"EnablePushChannelLogging"},p=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,p,d,v,m,g,y,b,w,E,S,x,T,N,C;return n.__generator(this,function(n){switch(n.label){case 0:if(e.existingSubscription)return[3,5];p=c.getStaticApiUrl({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(l.getData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:p.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){f.default.isFeatureEnabled(h)&&console.log("Error getting service url: ",e)})];case 1:d=n.sent();v=this._dispatch(s.readConfiguration({isTest:o.isTestMode})).isTest;if(!(m=d&&d.d&&d.d.GetServiceUrls&&d.d.GetServiceUrls.results&&d.d.GetServiceUrls.results[0])&&!v)throw new Error("Unable to retrieve PushChannel base url");v&&(m="https://northcentralus0-pushs.svc.ms");g=m+"/notifications/register";y=a.default.generate();b=this._dispatch(r.logQoS({name:"SubscriptionServiceGenericList.Register"}));w={correlationId:y};n.label=2;case 2:n.trys.push([2,4,,5]);return[4,u.default.start({url:g,method:"GET",headers:{"X-Correlation-Id":y},requestTimeoutInMS:1e4})];case 3:(E=n.sent())&&E.responseText&&E.responseText.length>0&&(S=JSON.parse(E.responseText))&&S.serverUrl&&S.webhookUrl&&(t=S.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(b({resultType:i.ResultType.success,extraData:w}));return[3,5];case 4:x=n.sent();this._dispatch(b({resultType:i.ResultType.failure,extraData:w}));throw x;case 5:T=c.getWebApiUrl({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){T=T.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else T=T.segments("Subscriptions","Add");N={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(l.getData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:T.toString(),body:JSON.stringify(N),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((C=n.sent())&&C.d){delete C.d.__metadata;if(e.existingSubscription){C.d.id=e.existingSubscription.id;C.d.notificationUrl=e.existingSubscription.notificationUrl;C.d.expirationDateTime=N.parameters.expirationDateTime}return[2,C.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=c.getWebApiUrl({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(l.getData({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})();t.default=p});
define("dWe",["require","exports","ww","lWe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){this._connectionCallbacks={};this._notificationCallback=void 0;this._notificationId=void 0;this._siteId=e.siteId;this._listId=e.listId;this._isConnected=!1;this._client=e.dataSyncClient}e.prototype.isConnected=function(){return this._isConnected};e.prototype.getSocketIoSubscription=function(){};e.prototype.addConnectionHandler=function(e,t){this._connectionCallbacks[e]=t};e.prototype.removeConnectionHandler=function(e){this._connectionCallbacks[e]&&delete this._connectionCallbacks[e]};e.prototype.setupNotificationHandler=function(e,t){this._notificationCallback=t;return!0};e.prototype.disconnect=function(){this._notificationCallback=void 0;this._connectionCallbacks={};this._notificationId&&this._client&&this._client.removeListStatusCallback(this._notificationId);this._isConnected=!1};e.prototype.refreshSubscription=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,!0]})})};e.prototype.connect=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,i,s;return n.__generator(this,function(n){switch(n.label){case 0:t=(e=this)._client,r=e._siteId,i=e._listId;s={siteId:r,listId:i};return[4,t.isListDataSyncEnabled(s)];case 1:if(n.sent()){this._notificationId=t.addListStatusCallback(this._onNotification.bind(this),s,{sendConnectionNotifications:!0});return[2,!0]}return[2,!1]}})})};e.prototype._onNotification=function(e){if(1===e.length){var t=e[0];t.dataRefreshNeeded?this._notificationCallback&&this._notificationCallback(void 0):t.state===r.DataSyncListStatus.ListStatusConnected?this._notifyConnectionHandlers(!0):t.state===r.DataSyncListStatus.ListStatusConnectionLost&&this._notifyConnectionHandlers(!1)}};e.prototype._notifyConnectionHandlers=function(e){this._isConnected=e;for(var t in this._connectionCallbacks)this._connectionCallbacks.hasOwnProperty(t)&&this._connectionCallbacks[t](e)};return e})();t.DataSyncPushChannelService=i});
define("uM",["require","exports","ww","N5","R5"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createThumbnailUrlGenerator=function(e){var t=e.listMediaTransformSchema,s=e.itemMediaTransformSchema;if(t&&s){var o=t[".transformUrl"],u=s[".hasThumbnail"],a=n.__assign(n.__assign(n.__assign({},t),s),{".method":"thumbnail"});if("True"===u&&o)return function(e,t){var n=t?{width:e,height:t}:{width:e};return i.buildUrl(o,a)+"&"+r.serializeQuery(n)}}}});
define("CF",["require","exports","e9"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.pin=0]="pin";e[e.unpin=1]="unpin";e[e.movePrevious=2]="movePrevious";e[e.moveNext=3]="moveNext"})(t.PinnedItemEditType||(t.PinnedItemEditType={}));t.getEditPinnedItemUrl=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,i=e.viewId,s=e.editType,o=e.itemId,u=e.afterItemId,a=e.rootFolder,f=n.getListApiUrl({webAbsoluteUrl:t,listFullUrl:r});i&&(f=f.methodWithAliases("GetView",{viewGuid:i}));if(1!==s){var l=u?parseInt(u,10):-1;isNaN(l)&&(l=-1);f=f.methodWithAliases("AddToSpotlight",{itemId:o,folderPath:a||"",afterItemId:l})}else f=f.methodWithAliases("RemoveFromSpotlight",{itemId:o,folderPath:a||""});return f.toString()};(function(e){e[e.success=0]="success";e[e.folderDoesNotExist=1]="folderDoesNotExist";e[e.itemDoesNotExist=2]="itemDoesNotExist";e[e.tooManyItems=3]="tooManyItems";e[e.itemNotInSpotlight=4]="itemNotInSpotlight";e[e.invalidArgument=5]="invalidArgument";e[e.serverError=6]="serverError";e[e.invalidServerJSON=7]="invalidServerJSON";e[e.unknownServerResult=8]="unknownServerResult"})(t.EditPinnedItemResultType||(t.EditPinnedItemResultType={}));t.parseEditPinnedItemResponse=function(e){try{if(e.d){var t=e.d.Order?e.d.Order.results:void 0;return{resultType:e.d.ResultCode,order:t}}return{resultType:8,order:void 0}}catch(e){return{resultType:7,order:void 0}}}});
define("_F",["require","exports","CS","hF","IS"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.combineItemSetInfoAndView=function(e){var t=e.sourceView,s=e.deserializedItemSetKey,o=e.appliedFilters,u=new n.default(t.getEffectiveViewXml());s.sortFieldKey&&u.updateSort({fieldName:s.sortFieldKey,isAscending:s.sortAscending},{overwriteAll:!0});s.groupByFieldKey&&u.updateGroupBy({group1:{fieldName:s.groupByFieldKey,isAscending:!0}});if(o)for(var a in o)if(o.hasOwnProperty(a)){var f=o[a];r.updateFilter(u,f)}try{var l=i.getColumnWidthsFromLocalStorage(t.id,!0);if(l){u.updateColumnWidths(l);i.removeColumnWidthsFromLocalStorage(t.id)}}catch(e){}return u}});
define("KKe",["require","exports","Eo","yc","CU"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getLayoutTypeFromViewType=function(e){switch(e){case"TILES":return n.tilesLayoutType;case"COMPACTLIST":return r.compactDetailsLayoutType;case"MODERNCALENDAR":return i.calendarMonthType;case"HTML":return r.detailsLayoutType;default:return}};t.getViewTypeFromLayoutType=function(e){switch(e){case n.tilesLayoutType:return"TILES";case r.detailsLayoutType:return"HTML";case r.compactDetailsLayoutType:return"COMPACTLIST";case i.calendarMonthType:return"MODERNCALENDAR";default:return}}});
define("IU",["require","exports","N5","M"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClassicEditViewPageUrl=function(e){var t=e.webAbsoluteUrl,i=e.layoutsUrl,s=e.viewId,o=e.listId,u=e.sourceUrl;return t+"/"+i+"/ViewEdit.aspx?"+n.serializeQuery({View:r.default.normalizeUpper(s,!0),List:r.default.normalizeUpper(o,!0),Source:u})}});
define("JV",["require","exports","ww","bc","Wv","Mc","Gi"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenFileLocationAction=r.withSelectedItems()(r.withExactlyOneItem()(i.connectToItemCache(function(e,t){var r=t.itemKey,i=e.demandItemFacet(o.folderPathFacet,r)||"";return{isAvailable:!!i,onExecute:i?function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){window.location.href=i;return[2]})})}:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})}}})(s.Action)))});
define("$V",["require","exports","ww","bc","Wv","Mc","Bc","Gp","Gi","WD"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=new u.PlatformDetection,c=function(e){window.location.href=e};t.OpenInOfficeClientAction=r.withSelectedItems()(r.withExactlyOneItem()(i.connectToItemCache(function(e,t){var r=t.itemKey,i=e.demandItem({appMap:a.officeAppFacet,fileName:o.fileNameFacet,openUrl:o.openUrlFacet,folderPath:a.folderPathFacet},r),s=i.appMap,u=i.fileName,h=i.openUrl,p=i.folderPath,d=!1,v=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})};r&&(d=!!s&&!!h&&(l.isMac||l.isWindows||l.isIOS||l.isWinPhone||l.isAndroid));if(d){var m=function(){h&&window.open(h)};v=function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){f.executeCore({app:s||"",itemUrl:h||"",extension:u&&u.extension||"",shouldEdit:!0,isNew:!1,defaultLocation:p||"",platformDetection:l,onNavigate:c,onFailureCallback:m});return[2]})})}}return{isAvailable:d,onExecute:v}})(s.Action)))});
define("OQe",["require","exports","ww","p3","K_","wQe","zx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substrateFileCardAddon=i.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(i.registerOperationHandler(o.substrateRelatedFilesKeyFacet,r.getItemsOperation)(s.relatedFilesGetItemsOperationHandler));return[2]})})}})});
define("FV",["require","exports","ww","p3","K_","kb","Px","nz","Tx","tz","Q0","ez","F1","qV","Kx","BV","NV","HV","R6","Gx","wI"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substrateSearchAddon=i.createAddon(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){e(s.registerControlHandler(a.searchItemsRootItemKeyFacet,l.itemsCommandBarControl)(c.searchCommandBarControllerHandler));e(s.registerControlHandler(a.searchItemsRootItemKeyFacet,h.itemsContextMenuControl)(p.itemsContextControllerHandler));e(i.registerOperationHandler(a.searchItemsRootItemKeyFacet,r.getItemsOperation)(f.searchItemsRootItemGetItemsOperationHandler));e(i.registerOperationHandler(o.searchItemSetKeyFacet,r.getItemsOperation)(u.searchItemSetGetItemsOperationHandler));e(i.registerOperationHandler(d.searchItemPageKeyFacet,r.getItemsOperation)(v.searchItemPageGetItemsOperationHandler));e(s.registerControlHandler(o.searchItemSetKeyFacet,w.itemsViewControl)(m.searchItemSetItemsViewControlHandler));e(s.registerControlHandler(b.searchItemKeyFacet,y.itemThumbnailControl)(g.searchItemThumbnailControlHandler));return[2]})})}})});
define("XV",["require","exports","ww","r","Mg","M0","GT","jT","ZV"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openFileCommand={key:s.openCommand.key,automationId:s.openCommand.automationId,title:"Open",subMenuProps:{items:[u.openInOfficeOnlineCommand,a.openInOfficeClientCommand]},onRender:function(e){return r.createElement(o.OpenCommandButton,n.__assign({},e,{menuProps:e.subMenuProps}))},facets:n.__assign({},i.isReadonlyFacet.pack(!0))}});
define("QV",["require","exports","JV","YV"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openFileLocationCommand={key:"OpenFileLocation",name:r.default.OpenFileLocationName,title:r.default.OpenFileLocationTitle,action:n.OpenFileLocationAction,iconProps:{iconName:"FabricFolder"}}});
define("ZV",["require","exports","ww","r","Mg","$V","VT"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeClientCommand={key:o.openInOfficeClientCommand.key,automationId:"openInOfficeClientCommand",action:r.createElement(s.OpenInOfficeClientAction,null),facets:n.__assign({},i.isReadonlyFacet.pack(!0))}});
define("B$e",["require","exports","r","yre","FV","Tc","am","Qi","j$e","bb","Wv","Vs","Px"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p,d=f.createItemCacheStore({});function v(){var e=n.useState(""),t=e[0],u=e[1];return n.createElement(s.WithAction,{action:n.createElement(o.ItemOpenAction,{itemKey:t})},function(e){var s=e.execute,o=n.useRef(!1);n.useEffect(function(){if(o.current){o.current=!1;s();d.dispatch(i.substrateSearchAddon)}},[t]);return n.createElement(r.SearchBox,{onSearch:function(e){o.current=!0;u(p?h.searchItemSetKeyFacet.serialize({root:{queryPath:""},query:e||"",filters:p}):h.searchItemSetKeyFacet.serialize({root:{queryPath:""},query:e||""}))},placeholder:a.default.SearchBarPlaceholder})})}t.SearchBarInner=v;t.SearchBar=l.createItemCacheComponent(function(e){var t=c.getCurrentItemSetKey(e),r=e.demandItemFacet(u.spFolderItemSetKeyFacet,t);r&&(p=r.extFilters);return n.createElement(v,null)})});
define("qV",["require","exports","M0","XV","QV","kb"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsContextControllerHandler=s.createControlHandler()(function(){return function(e){return function(e,t){return o(e,t)}}});function o(e,t){var s=t.commands,o=[];if(s)for(var u=0,a=s;u<a.length;u++){var f=a[u];if(f.key===n.openCommand.key){o.push(r.openFileCommand);o.push(i.openFileLocationCommand)}else o.push(f)}return{commands:o}}t.itemsContextControlHandler=o});
define("ez",["require","exports","ww","kb","QV","M0","XV"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SHOW_FILEHANDLER_COMMANDS_FIRST="658D384B-C862-48CC-986B-F1CD32B00BFE";t.searchCommandBarControllerHandler=r.createControlHandler()(function(){return function(e){return function(e,t){return u(e,t)}}});function u(e,t){var r=t.commands,u=t.overflowCommands,a=t.farCommands,f=t.shortcutCommands,l=u?n.__spreadArrays(u):[],c=r?n.__spreadArrays(r):[],h=(function(e,t){for(var n=t.defaultCommands,r=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===s.openCommand.key){r.push(o.openFileCommand);r.push(i.openFileLocationCommand)}else r.push(f)}return{overrideDefaultCommands:r}})(0,{defaultCommands:c});return{commands:c=h.overrideDefaultCommands,overflowCommands:l,farCommands:a,shortcutCommands:f}}t.baseItemsCommandBarControlHandler=u});
define("NV",["require","exports","kb","Eo","Px","k4","Ye","Ia"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemSetItemsViewControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,a=e.demandItemFacet(i.searchItemSetKeyFacet,n);return a&&a.filters&&s.doExtFiltersHaveMediaTypesOnly({extFilters:s.getIItemTypeFilter(a.filters),allowedMediaTypes:[o.ItemTypeFilter.photo,o.ItemTypeFilter.video],fileTypeIconMap:u.FileTypeIconMap})?{defaultLayout:r.tilesLayoutType,isLayoutResolved:!0}:{}}}})});
define("HV",["require","exports","kb","Gx","RV","QI","qI","N5","Te"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemThumbnailControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey,f=t.desiredSize,l=e.demandItemFacet(i.searchThumbnailDataFacet,n),c=e.demandItemFacet(r.searchItemKeyFacet,n);if(!l)return{};if(!c)return{};var h=l.siteId,p=l.uniqueId,d=l.listId,v=l.webId,m=l.id,g=new a.default(c.path).authority+"/_api/v2.1",y=s.thumbnailTokenKeyFacet.serialize({endpoint:g,driveId:""}),b=e.demandItemFacet(o.thumbnailAccessTokenFacet,y);if(b){return{thumbnail:{url:g+"/sites/"+h+","+v+"/lists/"+d+"/items/"+p+"/driveItem"+"/thumbnails/0/c"+Math.ceil(f.width)+"x"+Math.ceil(f.height)+"/content?"+u.serializeQuery({prefer:"noredirect,closestavailablesize",cb:m||"",access_token:b}),width:0,height:0}}}return{}}}})});
define("GV",["require","exports","ww","Bc","$_","tc","Te","Px","aS","Kx","Gi","Wi","oT","WV","Qi","Gx","Tx","KV","we","k4","Ye","Ia","nm","RV","M"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processSearchResponse=function(e){return function(t){var o,a=e.resultSet,f=e.itemSetKey,l=e.from,c=u.searchItemSetKeyFacet.deserialize(f),h=new i.ItemResolver,p=N({itemResolver:h,itemSet:c,resultSet:a,previousFrom:l}),d=c?c.query:void 0,v=!1;c.filters&&(v=b.doExtFiltersHaveMediaTypesOnly({extFilters:b.getIItemTypeFilter(c.filters),allowedMediaTypes:[w.ItemTypeFilter.photo,w.ItemTypeFilter.video],fileTypeIconMap:E.FileTypeIconMap}));h.resolveItems({items:(o={},o[f]=n.__assign(n.__assign(n.__assign(n.__assign({},s.childItemsFacet.pack({itemKeys:p})),{itemSetKeyFacet:u.searchItemSetKeyFacet,parentItemKeyFacet:m.searchItemsRootItemKeyFacet}),r.displayNameFacet.pack(y.format(g.default.SearchItemsTitle,d))),v?S.mediaGroupFacet.pack({}):{}),o)});t(h.execute())}};function N(e){var t,i,s,u=e.itemSet,m=e.itemResolver,g=e.resultSet,y=e.previousFrom,b=g.Results,w=g.MoreResultsAvailable,E=[];if(b)for(var S=0,N=b;S<N.length;S++){var C=N[S];if(C.Source){var k=v.searchItemKeyFacet.serialize({path:C.Source.Path||""}),L=C.Source.Path?(s=C.Source.Path,""+new o.default(s).authority+new o.default(s).segments.slice(0,-1).join("/")):"",A={name:C.Source.Filename?C.Source.IsContainer?C.Source.Filename:C.Source.Filename.split(".").slice(0,-1).join("."):"",extension:C.Source.FileExtension||""},O=d.spItemFullUrlKeyFacet.serialize({itemFullUrl:L}),M=p.substrateUserByNameKeyFacet.serialize({name:C.Source.ModifiedBy||""}),_=C.Source,D=_.UniqueID,P=_.SiteId,H=_.ListID,B=_.WebId,j=_.Id,F=C.Source.FileExtension?h.OfficeIconFileTypeMap[C.Source.FileExtension]:"";m.resolveItems({items:(t={},t[O]=n.__assign({},r.openUrlFacet.pack(L)),t[M]=n.__assign({},r.displayNameFacet.pack(C.Source.ModifiedBy)),t)});m.resolveItems({items:(i={},i[k]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},r.fileNameFacet.pack(A)),c.oneNoteFacet.pack(C.Source.FileExtension&&"one"===C.Source.FileExtension?{}:void 0)),x.searchThumbnailDataFacet.pack(D&&P&&H&&B&&j?{uniqueId:T.default.normalizeLower(C.Source.UniqueID),siteId:T.default.normalizeLower(C.Source.SiteId),listId:T.default.normalizeLower(C.Source.ListID),webId:T.default.normalizeLower(C.Source.WebId),id:T.default.normalizeLower(C.Source.Id)}:void 0)),r.displayNameFacet.pack(C.Source.Filename)),r.openUrlFacet.pack(C.Source.LinkingUrl)),r.folderFacet.pack(C.Source.IsContainer?{}:void 0)),r.modifiedByPersonFacet.pack({itemKey:M})),r.fileSizeFacet.pack(C.Source.Size)),r.dateModifiedFacet.pack(C.Source.LastModifiedTime)),r.parentFolderItemFacet.pack({itemKey:O})),l.officeAppFacet.pack(F)),l.folderPathFacet.pack(L)),i)});E.push(k)}}if(w){var I=f.searchItemPageKeyFacet.serialize({from:y+25,itemSet:u});E.push(I);m.merge(a.resolveNewPage({itemKey:I}).itemResolver)}return E}t.getSearchChildItemKeys=N});
define("wQe",["require","exports","ww","K_","jV","$_","zx","EQe","tc","Bc","M","cc","I7","Vb","k"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.relatedFilesGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,v=o.substrateRelatedFilesKeyFacet.deserialize(r);return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,o,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H;return n.__generator(this,function(B){switch(B.label){case 0:t=r(c.readItems(function(e){return e.demandItemFacet(p.driveItemKeyFacet,v.itemKey)}));o=t&&t.itemId;m=r(c.readItems(function(e){return h.getPageContextFromItemCache(e,v.itemKey)}));g=m&&m.listId&&m.listId.replace(/{|}/g,"");y=m&&m.siteId&&m.siteId.replace(/{|}/g,"");b=m&&m.webId&&m.webId.replace(/{|}/g,"");if(!(o&&m&&g&&y&&b)){(w=new Error("Missing itemId or pageContext for Substrate related files request")).name="missingItemInformation";throw w}E=(function(e,t,n,r){var i=encodeURI(t+","+n+","+r);return"SPO_"+btoa(i).slice(0,-1)+"_"+e})(o,y,b,g);S="/search/api/v1/recommendations";return[4,r(i.getAuthToken())];case 1:x=B.sent();"FileCard.RelatedFiles";T={EntityRequests:[{EntityType:"Document",Context:{EntityId:E}}],LogicalId:l.default.generate(),Scenario:{Name:"fileinsights"}};return[4,r(i.getData({qosName:"FileCard.RelatedFiles",path:S,method:"POST",token:x,body:T,timeOut:d.Killswitch.isActivated("db63a446-a15b-418d-ad2b-9677ffaa6c0f","07/23/2020","timeout option for getData")?void 0:6e3}))];case 2:N=B.sent();C=new s.ItemResolver;k=N.EntitySets[0].ResultSets[0];L=[];if(k.Results){A=k.Results;for(O=0,M=A;O<M.length;O++)if((_=M[O]).Source.FileName&&_.Source.WebUrl){D=u.relatedFilesItemSetKeyFacet.serialize({fileId:_.Id});L.push(D);C.resolveItems({items:(P={},P[D]=n.__assign(n.__assign({},f.displayNameFacet.pack(_.Source.FileName)),f.openUrlFacet.pack(_.Source.WebUrl)),P)})}}C.resolveItems({items:(H={},H[e.itemKey]=n.__assign({},a.childItemsFacet.pack({itemKeys:L})),H)});r(C.execute());return[2]}})})}})});
define("BV",["require","exports","ww","Kx","K_","Px","$_","aS","qx","Is","GV","jV","nz"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemPageGetItemsOperationHandler=i.createSingleItemOperationHandler()(function(e){var t=this,i=e.itemKey,p=r.searchItemPageKeyFacet.deserialize(i);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,d,v,m,g,y,b,w,E,S,x,T;return n.__generator(this,function(n){switch(n.label){case 0:t=p.from,r=p.itemSet;d=e(f.readConfiguration({config:a.searchConfigurationFacet})).config;v=s.searchItemSetKeyFacet.serialize(r);m=new o.ItemResolver;g={Results:[],MoreResultsAvailable:!1};return d&&d.getData?[4,d.getData({query:r?r.query:"",queryPath:r?r.root.queryPath:"",from:t})]:[3,2];case 1:g=n.sent();return[3,5];case 2:return[4,e(c.getAuthToken())];case 3:y=n.sent();return[4,e(c.getData({qosName:"",path:h.substrateSearchPath,method:"POST",token:y,body:h.getSubstrateSearchRequestBody(r.query,t,h.getCvid(),r.filters)}))];case 4:b=n.sent();w=b.EntitySets[0].ResultSets[0];g={Results:null===(x=w)||void 0===x?void 0:x.Results,MoreResultsAvailable:null===(T=w)||void 0===T?void 0:T.MoreResultsAvailable};n.label=5;case 5:E={itemResolver:m,itemSet:r,resultSet:g,previousFrom:t};S=l.getSearchChildItemKeys(E);m.merge(u.resolveExistingPage({itemKey:i,itemSetKey:v,childItemKeys:S}).itemResolver);e(m.execute());return[2]}})})}})});
define("nz",["require","exports","ww","K_","Px","GV","Is","qx","jV","QS"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;t.getCvid=function(){return l};t.substrateSearchPath="/search/api/v2/query";function c(e,t,n,r){return{EntityRequests:[{EntityType:"File",ContentSources:["OneDriveBusiness","SharePoint"],Query:{QueryString:e+" "+h(r)},Sort:[{Score:"Desc"}]}],TimeZone:"UTC",Scenario:{Name:"onedriveweb"},Cvid:n,LogicalId:n,from:t}}t.getSubstrateSearchRequestBody=c;function h(e){if(!e)return"";for(var t="AND (",n=0;n<e.length-1;n++)if(e[n]){t+="FileType:"+("."===e[n][0]?e[n].slice(1):e[n])+" OR "}return t+="FileType:"+e[e.length-1]+")"}t.searchItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var r=this,h=e.itemKey,p=i.searchItemSetKeyFacet.deserialize(h);return function(e){return n.__awaiter(r,void 0,void 0,function(){var r,i,d,v,m,g,y,b;return n.__generator(this,function(n){switch(n.label){case 0:r=0;i=e(o.readConfiguration({config:u.searchConfigurationFacet})).config;d={Results:[],MoreResultsAvailable:!1};return i&&i.getData&&p?[4,i.getData({query:p.query,queryPath:p.root.queryPath,from:r})]:[3,2];case 1:d=n.sent();return[3,4];case 2:0!==r&&void 0!==l||(l=f.generate());return[4,e(a.getData({qosName:"",path:t.substrateSearchPath,method:"POST",body:c(p.query,r,l,p.filters)}))];case 3:v=n.sent();m=v.EntitySets[0].ResultSets[0];d={Results:null===(y=m)||void 0===y?void 0:y.Results,MoreResultsAvailable:null===(b=m)||void 0===b?void 0:b.MoreResultsAvailable};n.label=4;case 4:g={itemSetKey:h,resultSet:d,from:r};e(s.processSearchResponse(g));return[2]}})})}})});
define("tz",["require","exports","ww","jo","tc","K_","Px","Tx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemsRootItemGetItemsOperationHandler=s.createSingleItemOperationHandler()(function(e){var t=this,s=u.searchItemsRootItemKeyFacet.deserialize(e.itemKey);return function(u){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(a){u(r.resolveItems({items:(t={},t[e.itemKey]=n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:o.searchItemSetKeyFacet.serialize({root:s,query:""})})),t)}));return[2]})})}})});
define("RV",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchThumbnailDataFacet=new n.Facet("SearchItem")});
define("VV",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substrateConfigurationFacet=new n.Facet("substrateConfiguration")});
define("zV",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substrateHeaderConfigurationFacet=new n.Facet("substrateHeaderConfiguration")});
define("EQe",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.relatedFilesItemSetKeyFacet=new n.KeyFacet("relatedFilesItem",{fileId:n.stringPart()})});
define("zx",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substrateRelatedFilesKeyFacet=new n.KeyFacet("substrateRelatedFiles",{itemKey:n.stringPart()})});
define("WV",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.substrateUserByNameKeyFacet=new n.KeyFacet("substrateUserByName",{name:n.stringPart()})});
define("jV",["require","exports","ww","P","W_","Cs","i3","ys","Ms","Is","FC","zV","VV"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function p(){var e=this;return function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:e=t(f.readConfiguration({tokenFetcher:l.tokenFetcherConfigurationFacet})).tokenFetcher;return(r=e)?[4,e.getToken("https://substrate.office.com")]:[3,2];case 1:r=n.sent();n.label=2;case 2:return[2,r]}})})}}t.getAuthToken=p;t.getData=function(e){var t=this,f=e.method,l=e.path,m=e.body,g=e.timeOut;return function(y){return n.__awaiter(t,void 0,void 0,function(){var t,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return n.__generator(this,function(n){switch(n.label){case 0:t=y(s.readItem({config:h.substrateConfigurationFacet,headerConfig:c.substrateHeaderConfigurationFacet},u.configurationItemKey)),b=t.config,w=t.headerConfig;return b&&b.getData?[4,b.getData(e)]:[3,2];case 1:return[2,n.sent()];case 2:return(S=e.token)?[3,4]:[4,y(p())];case 3:S=n.sent();n.label=4;case 4:E=S;x=new Headers;m&&x.set("Content-Type","application/json");E&&x.set("Authorization","Bearer "+E);T=r.generate();x.set("X-CorrelationId",T);if(w){w.applicationId&&x.set("X-Office-Application",w.applicationId);w.aadUserId&&w.aadTenantId&&x.set("X-AnchorMailbox",w.aadUserId+"@"+w.aadTenantId)}N={headers:x,credentials:"omit",method:f,mode:"cors",cache:"default",body:m?JSON.stringify(m):void 0};C=y(i.logQoS({name:"substrate.getData."+e.qosName,extraData:{correlationId:T}}));n.label=5;case 5:n.trys.push([5,13,,14]);k=void 0;return g?[4,v("https://substrate.office.com"+l,N,g)]:[3,7];case 6:k=n.sent();return[3,9];case 7:return[4,fetch("https://substrate.office.com"+l,N)];case 8:k=n.sent();n.label=9;case 9:return k.ok?[3,11]:[4,d(k)];case 10:L=n.sent();y(C(L));throw new a.ItemOperationError({message:L.error});case 11:A=k.headers.get("x-rdl-latency");y(C({resultType:o.ResultType.success,extraData:{serverLatency:A}}));return[4,k.json()];case 12:return[2,n.sent()];case 13:O=n.sent();M=O&&O.message||"No error message given.";_="A failure occurred while trying to fetch a substrate resource ("+M+")";y(C({resultType:o.ResultType.failure,error:_}));throw O;case 14:return[2]}})})}};function d(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,e.json()];case 1:t=n.sent();return[3,3];case 2:r=n.sent();return[2,{resultType:o.ResultType.failure,error:r.message,resultCode:"["+e.status+"] ResponseParseFailure",extraData:{url:e.url}}];case 3:i=t&&t.error_data&&t.error_data.message||"Unknown substrate error response";return[2,{resultType:o.ResultType.failure,error:i,resultCode:"["+e.status+"] "+(t&&t.response_code||"UnknownError"),extraData:{url:e.url,diagnostics:JSON.stringify(t&&t.diagnostics_data)}}]}})})}t.handleSubstrateError=d;function v(e,t,n){var r=new Promise(function(e,t){setTimeout(function(){return t(new Error("Request Timeout"))},n)});return Promise.race([fetch(e,t),r]).then(function(e){return e})}});
define("PKe",["require","exports","ww","K_","jo","ys","TKe","bm"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.asDeferredActionDropZone()(u.ItemDefaultDropAction);t.reactDragDropAddon=r.createAddon(function(){return function(e){var t;e(i.resolveItems({items:(t={},t[s.configurationItemKey]=n.__assign({},s.reactDragDropConfigurationFacet.pack(a)),t)}))}})});
define("nW",["require","exports","ww","DW","yW","vW","hW","aW"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t)});
define("ZL",["require","exports","ww","r","Zm","tA","sa","U_","ODBItemsScopeDeferred_mini_css","Wv","Mg"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";a=a.CommandButton_8;Object.defineProperty(t,"__esModule",{value:!0});t.ActionCommandButtonStrip=f.createItemCacheComponent(function(e,t){var c=t.commands,h=n.__rest(t,["commands"]);return f.evaluateItemCacheComponent(e,r.createElement(u.CommandSet,{commands:c},function(e){var t=e.menuItems;return r.createElement(s.LayoutGroup,n.__assign({direction:"horizontal"},h),t.map(function(e){var t=e.facets,s=t&&l.isPrimaryFacet.unpack(t)?i.PrimaryButton:i.DefaultButton,u=e.commandBarButtonAs,f=u?o.composeComponentAs(u,s):s;return r.createElement(f,n.__assign({},e,{className:a.commandButton,key:e.key}),e.name)}))}))})});
define("YE",["require","exports","ww","qL","KL","GL","jL","_L","OA","JE"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t)});
define("jL",["require","exports","ww","r","zL","j0","VL","Mo","Vh","Xp","aL","Hs","I8","em","Yv","Wv","g8","B0","Co","e3","ys","Gp","Zv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=new u.AutoKeyFacet("newDocument"),T=new E.PlatformDetection;function N(){return x.serializeNext()}var C=a.asAutoAction()(f.ItemDefaultClickAction);function k(e){var t=this,s=e.itemKey,u=e.resolve,a=e.reject,f=e.askForFileName,v=e.documentType,m=e.openWindow,g=e.templateItemKey,w=e.validator,E=r.useState(null),S=E[0],x=E[1],T=r.useState(f),k=T[0],L=T[1],A=r.useState(N)[0],O=r.useState(!1),M=O[0],_=O[1],D=b.useItemCacheDispatch(),P=r.useCallback(function(e,t){return!t.targetWindow&&S?{targetWindow:S}:{}},[S]),H=y.useEventHandler(function(){_(!0);u()}),B=y.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:t=e.name;r=m({});x(r);return!f||f&&t?[4,D(h.createDocument({items:(i={},i[s]={documentType:v,newDocumentKey:A,targetWindow:r,fileName:t,templateItemKey:g},i)}))]:[3,2];case 1:n.sent();n.label=2;case 2:L(!1);return[2]}})})}),j=y.useEventHandler(function(){a(new c.CancelError)});r.useLayoutEffect(function(){k||B({name:void 0})},[]);return k?r.createElement(l.NameDialog,{title:i.getDialogTitle(v,o.default)||"",name:"",placeHolder:o.default.NewNamePlaceholder,fileExtensionText:i.getDocExtension(v),onContinue:B,onCancel:j,continueText:o.default.CreateCommit,validator:w}):M?null:r.createElement(d.ControlHandlerProvider,{controlHandlers:p.targetWindowControl.pack(P)},r.createElement(C,{onComplete:H,itemKey:A}))}t.createDocumentExecutor=function(e,t,n,r){var i,s=t.itemCacheDispatch,o=t.itemKey,u=t.documentType,a=t.askForFileName,f=t.templateItemKey,l=e.newDocumentKey;return!a||a&&n?s(h.createDocument({items:(i={},i[o]={documentType:u,newDocumentKey:l,targetWindow:r,fileName:n,templateItemKey:f},i)})):Promise.resolve()};t.DocumentCreator=v.createItemCacheComponent(function(e,t){var i=t.itemKey,o=t.documentType,u=o===s.DocumentType.OneNote||o===s.DocumentType.ExcelSurvey||o===s.DocumentType.ExcelForm,a=S.getConfiguration(e,{enableOpenNewOfficeOnlineDocsInPWA:w.enableOpenNewOfficeOnlineDocsInPWAFacet}).enableOpenNewOfficeOnlineDocsInPWA,f=void 0!==a&&a,l=e.demandItemFacet(m.documentCreatorControl,i),c=m.documentCreatorControl.evaluate(l)(e,{itemKey:i,documentType:o,openWindow:f&&T.isPWA?A:L}),h=e.demandItemFacet(g.createDocumentActionControl,i),p=g.createDocumentActionControl.evaluate(h)(e,{itemKey:i,documentType:o,openWindow:f&&T.isPWA?A:L});return r.createElement(k,n.__assign({},t,{validator:p.validator||c.validator,askForFileName:u||p.askForFileName||c.askForFileName,openWindow:p.openWindow||c.openWindow}))});function L(e){return window.open(e.url||"","_blank")}function A(e){return window.open(e.url||"","_self")}});
define("KL",["require","exports","ww","r","Hs","aL","VL","WL","we","jh","xo"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateFolderWizard=function(e){var t=this,c=e.resolve,h=e.reject,p=e.onCreateFolder,d=e.maxLength,v=e.title,m=e.validator,g=r.useState(),y=g[0],b=g[1],w=l.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return p?[4,p(e)]:[3,2];case 1:t.sent();t.label=2;case 2:b(e.name);return[2]}})})}),E=l.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){h(new i.CancelError);return[2]})})});return y?r.createElement(f.Alert,{onStart:c},a.format(u.default.createFolderCompletedFormat,y)):r.createElement(s.NameDialog,{nameFieldAriaLabel:o.default.FolderNamePlaceholder,onContinue:w,onCancel:E,title:v||o.default.CreateFolder,maxLength:d,continueText:o.default.CreateCommit,name:"",placeHolder:o.default.FolderNamePlaceholder,validator:m})}});
define("_L",["require","exports","ww","r","H","Md","mL","Lm","Zv","ys","Bc","kA","IL","i0","Z_","hL","Co"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DeleteWizard=function(e){var t=this,p=e.resolve,d=e.reject,v=e.onDelete,g=e.defaultToDelete,y=void 0===g||g,b=e.deleteWizardStrings,w=e.itemKeys,E=m.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:p();return[4,v()];case 1:e.sent();return[2]}})})}),S=m.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){d(new i.CancelError);return[2]})})}),x=r.useCallback(function(e){var t=e.itemCache,n=a.getConfiguration(t,{enableDeleteCancelConfirmationStrings:f.enableDeleteCancelConfirmationStringsConfigurationFacet}).enableDeleteCancelConfirmationStrings,i=void 0===n||n,s=1===w.length&&w.some(function(e){var n=t.demandItemFacet(l.isCheckedOutFacet,e);return!!(n&&n.byOther)}),p=w.length>=1&&w.some(function(e){return!!t.demandItemFacet(l.isSharedFacet,e)&&!1})?o.default.deleteSharedConfirmPrefixText+" ":"";return s?r.createElement(c.WarningDialog,{onCancel:S,cancelText:o.default.cancelActionText,title:u.default.checkedOutOrLockedWarningTitle,prompt:u.default.checkedOutOrLockedWarning}):r.createElement(h.ConfirmationDialog,{onCancel:S,onConfirm:E,yesText:i?b.confirmButtonText:void 0,noText:i?o.default.cancelActionText:void 0,defaultToYes:y,title:b.confirmTitle,prompt:[p,p?" ":"",b.confirmText]})},[w,b,y]);return r.createElement(s.WithItemCache,null,x)};t.deleteItemsWithProgress=d.implementOperationWithProgress({operationTypeFacet:p.deleteItemsOperation,progressKeyFacet:p.deleteProgressKeyFacet,initializeBatch:function(){return v.deleteProgressAddon}})});
define("RJe",["require","exports","ww","r","bc","Mc","Tc","Wv","gc","h3","b3","Ac","o3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=f.afterPageLoad()(l.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["YE"],t,n)})];case 1:return[2,t.sent().LaunchMoveCopyPickerWizard]}})})}));t.ItemLaunchMoveCopyPickerAction=u.createItemCacheComponent(function(e,t){var i=t.itemKeys,u=t.isMove,f=void 0!==u&&u;if(0===i.length)return null;var l=a.getCurrentItemKey(e);if(!l)return null;var d=e.demandItemFacet(h.launchMoveCopyPickerActionControl,i[0]),v=h.launchMoveCopyPickerActionControl.evaluate(d)(e,{entryItemKey:l,sourceItemKeys:i,isMove:f,isAvailable:!1,moveCopyPickerWizard:p}),m=v.isAvailable,g=v.moveCopyPickerWizard;if(!m||!g)return null;var y=o.renderComponentOnExecute(function(e){return r.createElement(g,n.__assign({isMove:f,entryItemKey:l,sourceItemKeys:i},e))},{scope:"global"});return r.createElement(s.Action,n.__assign({onExecute:y},c.getItemActionEngagement(e,{itemKey:i[0],engagement:{name:f?"MoveTo":"CopyTo"}})))});var d=i.withSelectedItems()(t.ItemLaunchMoveCopyPickerAction);t.LaunchMovePickerAction=u.connectToItemCache(function(){return{isMove:!0}})(d);t.LaunchCopyPickerAction=u.connectToItemCache(function(){return{isMove:!1}})(d)});
define("JE",["require","exports","ww","r","_A","Zm","fb","fA","O1","uA","iA","Hs","Mc","Tc","tA","eA","ZE","Dm","mo","XE","we","Xv","ab","E_","Yv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPickerWizard=function(e){var t=this,S=e.resolve,x=e.reject,C=e.entryItemKey,k=e.sourceItemKeys,L=e.isMove,A=r.useState(!0),O=A[0],M=A[1],_=r.useMemo(function(){return o.createInitializer(function(){},C)},[C]),D=r.useCallback(function(e){var i=e.itemKeys;if(1!==i.length)return null;var s=i[0];return r.createElement(p.WithAction,{action:r.createElement(g.ItemMoveCopyAction,{itemKeys:k,itemKey:s,isMove:L})},function(e){var i=e.isAvailable,s=e.execute;return r.createElement(h.Action,{isAvailable:i,onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);M(!1);return[4,s(e)];case 1:n.sent();S();return[3,3];case 2:t=n.sent();x(t);return[3,3];case 3:return[2]}})})}})})},[]),P=r.useMemo(function(){return u.createPickerFailAction(y.createAsyncActionCreator(function(e){return function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){x(e.error);return[2]})})}}))},[]),H=w.format(w.getLocalizedCountValue(L?b.default.MovePanelTitleFormat:b.default.CopyPanelTitleFormat,L?b.default.MovePanelTitleIntervals:b.default.CopyPanelTitleIntervals,k.length)||"",k.length),B=r.useCallback(function(){return r.createElement(d.LayoutGroup,{direction:"horizontal"},r.createElement(p.WithAction,{action:r.createElement(v.PickerCompleteAction,null)},function(e){var t=e.isAvailable,n=e.execute;return r.createElement(s.PrimaryButton,{disabled:!t,onClick:function(){n()}},L?b.default.MovePanelSelectActionText:b.default.CopyPanelSelectActionText)}),r.createElement(p.WithAction,{action:r.createElement(m.PickerCancelAction,null)},function(e){var t=e.isAvailable,n=e.execute;return r.createElement(s.DefaultButton,{disabled:!t,onClick:function(){n()}},b.default.MoveCopyPanelCancelActionText)}))},[]),j=r.useMemo(function(){return n.__assign({},E.itemSetColumnsControl.pack(N))},[]);return r.createElement(T.ControlHandlerProvider,{controlHandlers:j},r.createElement(o.ItemsScope,{initializer:_},r.createElement(u.ItemsPicker,{itemMode:"folders",selectionMode:"pick",commandMode:"none",completeAction:D,failAction:P},r.createElement(i.Panel,{headerText:H,isOpen:O,onDismiss:function(){return x(new c.CancelError)},isLightDismiss:!0,onRenderFooterContent:B},r.createElement(a.ItemsBreadcrumbBeta,null),r.createElement(f.ItemsLayoutGroup,null,r.createElement(l.DetailsLayout,null))))))};function N(e,t){return{columns:[S.fileTypeIconColumn,x.displayNameColumn]}}});
define("cU",["require","exports","r","Bc","am","bc","Wv"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.createItemCacheComponent(function(e,t){var s=t.itemKey,o=e.demandItemFacet(r.parentFolderItemFacet,s),u=o&&o.itemKey;return n.createElement(i.ItemOpenAction,{itemKey:u})});t.NavigateUpAction=s.withOnlyCurrentItem()(u)});
define("oJ",["require","exports","r","bc","Wv","Bc","Xp"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenParentFolderAction=r.withSelectedItems()(r.withExactlyOneItem()(i.createItemCacheComponent(function(e,t){var r=t.itemKey,i=e.demandItemFacet(s.parentFolderItemFacet,r);return i?n.createElement(o.ItemDefaultClickAction,{itemKey:i.itemKey}):null})))});
define("OA",["require","exports","ww","r","H","mL","pL","AA","f0","Z_","wA","Co"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenameWizard=function(e){var t=this,a=e.resolve,f=e.reject,l=e.onRename,h=e.lockedWarningMessage,p=e.title,d=e.validator,v=e.fileExtensionText,m=e.oldName,g=e.nameFieldAriaLabel,y=c.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:a();return l?[4,l(e)]:[3,2];case 1:t.sent();t.label=2;case 2:return[2]}})})}),b=c.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){f(new i.CancelError);return[2]})})}),w=p||s.default.Rename;return r.createElement(u.RenameDialog,{onContinue:y,onCancel:b,placeHolder:o.default.newNamePlaceholder,title:w,continueText:s.default.RenameCommit,name:m,validator:d,fileExtensionText:v,lockedWarningMessage:h,warningDialogCancelText:s.default.cancelActionText,cancelText:s.default.cancelActionText,nameFieldAriaLabel:g})};t.renameItemWithProgress=f.implementOperationWithProgress({operationTypeFacet:a.renameItemOperation,progressKeyFacet:a.renameProgressKeyFacet,initializeBatch:function(){return l.renameProgressAddon}})});
define("AA",["require","exports","ww","r","aL","kA","LA"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenameDialog=function(e){var t=e.lockedWarningMessage,u=e.warningDialogCancelText,a=e.onCancel,f=e.title;return t?r.createElement(s.WarningDialog,{cancelText:u,title:f,prompt:t,onCancel:a}):r.createElement(o.KeyboardZone,null,r.createElement(i.NameDialog,n.__assign({},e)))}});
define("cet",["require","exports","ww","r","Mc","Wv"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SetFocusAction=s.createItemCacheComponent(function(e,t){return r.createElement(i.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})})});
define("lU",["require","exports","r","Zm","HA","ac","Mc","ODBItemsScopeDeferred_mini_css","LA","Wv","Tc","Co"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";u=u.ShowKeyboardMap_4;Object.defineProperty(t,"__esModule",{value:!0});var h=[{keys:"Ctrl + a",desc:s.default.selectAllDesc},{keys:"Ctrl + d",desc:s.default.deselectAllDesc},{keys:"esc",desc:s.default.escDesc},{keys:"space",desc:s.default.spaceDesc},{keys:"enter",desc:s.default.enterDesc}],p=[{keys:"F2",desc:s.default.renameDesc},{keys:"Delete",desc:s.default.deleteDesc},{keys:"s",desc:s.default.showShareDesc},{keys:"alt + up",desc:s.default.altUpDesc},{keys:"?",desc:s.default.showKeymapDesc},{keys:"g",desc:s.default.showActionDetailsDesc},{keys:"i",desc:s.default.toggleInfoDesc}];function d(e){var t=e.resolve,o=c.useEventHandler(function(){t()}),f=[h,p],l=-1,d=-1;return n.createElement(a.KeyboardZone,null,n.createElement(i.Dialog,{onDismiss:o,hidden:!1,dialogContentProps:{type:i.DialogType.close,title:s.default.KeyboardMapTitle},styles:v},f.map(function(e){return n.createElement("div",{className:u.keyboardMapGroup,key:"keyMap"+ ++l},n.createElement("ul",{className:u.keyboardMapTable,key:""+l},e.map(function(e){return n.createElement("li",{className:u.keyboardMapRow,key:""+ ++d},n.createElement("span",{className:u.keyboardMapKey,key:l+"."+d+".0.0"},e.keys),n.createElement("span",{className:u.keyboardMapVal,key:l+"."+d+".1.1"},e.desc))})))}),n.createElement(i.DialogFooter,null,n.createElement(r.PrimaryButton,{onClick:o},s.default.okButtonText))))}t.KeyboardMapDialog=d;t.ShowKeyboardMapAction=f.createItemCacheComponent(function(e){var t=l.renderComponentOnExecute(d);return n.createElement(o.Action,{onExecute:t})});function v(){return{main:{maxWidth:"700px !important"}}}});
define("DW",["require","exports","ww","r","we","MA","HA","Zm","Hs","IW","mL","ld","Tc","g0","Co"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MalwareDetectedDialog=function(e){var t=this,m=e.itemKey,g=e.resolve,y=e.reject,b=r.useState(!1),w=b[0],E=b[1],S=d.useEventHandler(function(){y(new a.CancelError)}),x=c.getTheme();return r.createElement(h.WithAction,{action:r.createElement(p.ItemDownloadAction,{itemKeys:[m]})},function(e){var a=e.isAvailable,c=e.execute,h=a?function(){return n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);E(!0);return[4,c()];case 1:t.sent();g();return[3,3];case 2:e=t.sent();y(e);return[3,3];case 3:return[2]}})})}:void 0,p=a?f.default.malwareDetectedAllowDownloadMessage:f.default.malwareDetectedMessage;return w?null:r.createElement(o.Dialog,{hidden:!1,onDismiss:S,title:f.default.malwareDetectedDialogHeader,closeButtonAriaLabel:f.default.closeButtonAriaLabel,type:o.DialogType.close,styles:v,dialogContentProps:{styles:function(){return{title:{color:x.semanticColors.errorText,fontWeight:"500"}}}}},r.createElement(s.Label,null,i.formatToArray(p,r.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},f.default.malwareDetectedLearnMore))),r.createElement(o.DialogFooter,null,h?r.createElement(u.DefaultButton,{onClick:h},f.default.malwareDialogDownload):null,r.createElement(u.DefaultButton,{onClick:S,primary:!0},l.default.cancelActionText)))})};function v(){return{main:{maxWidth:"450px !important"}}}});
define("GL",["require","exports","ww","r","v8","x8","Wv"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateFolderDialog=o.createItemCacheComponent(function(e,t){var o=t.createFolderWizard,u=n.__rest(t,["createFolderWizard"]),a=u.itemKey,f=e.demandItemFacet(i.createFolderDialogControl,a),l=i.createFolderDialogControl.evaluate(f)(e,{itemKey:a,validator:void 0}),c=l.validator,h=l.maxLength,p=l.title,d=e.dispatch;return r.createElement(o,n.__assign({},u,{onCreateFolder:function(e){var t=e.name;return n.__awaiter(void 0,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,d(s.createFolder({items:(e={},e[a]={folders:(r={},r[t]={},r)},e)}))];case 1:n.sent();return[2]}})})},validator:c,maxLength:h,title:p}))})});
define("dJ",["require","exports","Wh","nb","qi","w5","Bc","ys","jS"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateAccessedColumn=n.createColumn({key:new i.Facet("dateAccessedColumn").id,name:r.default.AccessedDate,fieldName:"",minWidth:n.ColumnWidth.regularMin,maxWidth:n.ColumnWidth.regularMax,isCollapsable:!0},s.DateField)(function(e,t){var n=e.demandItemFacet(o.dateAccessedFacet,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(u.localeFacet,u.configurationItemKey),s=i&&i.language||window.navigator.language;return s?{text:a.getRelativeDateTimeStringPast(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(o.dateAccessedFacet,t)})});
define("XY",["require","exports","Wh","nb","qi","w5","Bc","ys","jS"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateFollowedColumn=n.createColumn({key:new i.Facet("dateFollowedColumn").id,name:r.default.SavedDate,fieldName:"",minWidth:n.ColumnWidth.regularMin,maxWidth:n.ColumnWidth.regularMax,isCollapsable:!0},s.DateField)(function(e,t){var n=e.demandItemFacet(o.dateFollowedFacet,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(u.localeFacet,u.configurationItemKey),s=i&&i.language||window.navigator.language;return s?{text:a.getRelativeDateTimeStringPast(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(o.dateFollowedFacet,t)})});
define("xM",["require","exports","nb","CM","Uh","Wh","Fh","qh","Th","Lh","A_"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameAndPathColumn=o.createRenderHandlerColumn({key:i.NAME_AND_PATH_COLUMN_KEY,name:n.default.Name,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:s.TEXT_COLUMN_SORT_PROPS},[u.displayNameColumnRenderHandler,l.signalsColumnRenderHandler,r.pathColumnRenderHandler,a.heroColumnRenderHandler,f.itemHoverCardColumnRenderHandler])});
define("HJe",["require","exports","r","qi","bh","Ng","RJe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.launchCopyPickerCommand={key:r.getNextId("launchCopyPickerCommand"),automationId:"launchCopyPickerCommand",name:i.default.CopyItem,ariaLabel:i.default.CopyItem,action:n.createElement(s.ShowOnlyWithSelection,null,n.createElement(o.LaunchCopyPickerAction,null)),iconProps:{iconName:"Copy"}}});
define("NJe",["require","exports","r","qi","bh","Ng","RJe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.launchMovePickerCommand={key:r.getNextId("launchMovePickerCommand"),automationId:"launchMovePickerCommand",name:i.default.MoveItem,ariaLabel:i.default.MoveItem,action:n.createElement(s.ShowOnlyWithSelection,null,n.createElement(o.LaunchMovePickerAction,null)),iconProps:{iconName:"FabricMoveToFolder"}}});
define("BM",["require","exports","ww","r","qi","mh","bh","Ng","Mg"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAccessCommand={key:new i.Facet("manageAccess").id,automationId:"manageAccessCommand",name:o.default.ManageAccess,title:o.default.ManageAccessCommandTooltipV3,action:r.createElement(u.ShowOnlyWithSelection,null,r.createElement(s.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"},facets:n.__assign({},a.isShareFacet.pack(!0))}});
define("det",["require","exports","r","ac","qi","cet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNPSSurveyFocusShortcut={key:new i.Facet("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:r.default.getNPSSurveyFocusShortcut},action:n.createElement(s.SetFocusAction,{elementId:"obf-TPromptContainer"})}});
define("sU",["require","exports","ww","r","ac","qi","cU","Mg"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.navigateUpShortcut={key:new s.Facet("NavigateUpShortcut").id,automationId:"NavigateUpShortcut",shortcutProps:{keySequences:["AltUp"],content:i.default.altUpDesc},action:r.createElement(o.NavigateUpAction,null),facets:n.__assign({},u.isViewOnlyCommandFacet.pack(!0))}});
define("dU",["require","exports","r","ac","qi","lU"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.showKeymapShortcut={key:new i.Facet("ShowKeymapShortcut").id,automationId:"ShowKeymapShortcut",shortcutProps:{keySequences:["Shift/"],content:r.default.showKeymapDesc},action:n.createElement(s.ShowKeyboardMapAction,null)}});
define("TKe",["require","exports","ww","r","Tc","Py","Ly","jo","Sm","So","qi","uo","cc","Uo","d3","fm","$s","Wv","xo","vm","Yp","yo","c3","e3","Kc","w7"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=a.dragDropKeyFacet.serialize({}),k=[b.FILE_DRAG_TYPE,b.DOCUMENT_DRAG_TYPE],L=[];t.asDeferredActionDropZone=function(){return function(e){var t=e;return g.connectToItemCache(function(e,t){return{pageLoadBarrier:d.getPageLoadBarrier(e)}})(function(e){var d=e.children,g=e.layoutMode,A=e.enableDrag,O=e.showDropTargetHint,M=e.showDragOverHint,_=e.pageLoadBarrier,D=n.__rest(e,["children","layoutMode","enableDrag","showDropTargetHint","showDragOverHint","pageLoadBarrier"]),P=D.itemKey,H=void 0===P?"":P;function B(e){var t=e.isAvailable,i=e.execute,w=t?k:L,D=A,P=N.useContextualControlHandlerCache(),B=T.useContextualControlHandlers(),j=x.useItemCacheDispatch(),F=y.useEventHandler(function(e){var r;if(t&&!e.didDrop){var s=e.dragItemType===b.FILE_DRAG_TYPE?{files:v.getFileDropData(e.draggedItem)}:e.draggedItem;i({event:{dataTransfer:s}})}j(u.resolveItems({items:(r={},r[C]=n.__assign({},l.pack({draggedItem:a.draggedItemFacet},{draggedItem:new f.Delete})),r)}));j(c.forceStoreUpdate());return{dropTargetKey:e.dropTargetKey}}),I=y.useEventHandler(function(e){var n=e.dragItemType||"";return!!w.some(function(e){return e===n})&&t}),q=y.useEventHandler(function(e){}),R=y.useEventHandler(function(e){return!0}),U=y.useEventHandler(function(e){var t,r=j(h.readItems(function(e){return{itemsScopeItemKey:S.getItemsScope(e).itemsScopeItemKey,itemKeys:m.getSelectedItemKeys(e)}},{contextualControlHandlerCache:P,contextualControlHandlers:B})),i=r.itemKeys,s=r.itemsScopeItemKey;if(!(i.indexOf(H)>-1)){i=[H];s&&j(E.selectItems({itemsScopeItemKey:s,selectedItemKeys:i,currentSelectionKey:void 0}))}var o={dragSourceKey:H,type:b.DOCUMENT_DRAG_TYPE,itemKeys:i};j(u.resolveItems({items:(t={},t[C]=n.__assign({},l.pack({draggedItem:a.draggedItemFacet},{draggedItem:new f.ReplacePatch({draggedItem:o})})),t)}));j(c.forceStoreUpdate());return o}),z=y.useEventHandler(function(e){var t;j(u.resolveItems({items:(t={},t[C]=n.__assign({},l.pack({draggedItem:a.draggedItemFacet},{draggedItem:new f.Delete})),t)}));j(c.forceStoreUpdate())}),W=r.useMemo(function(){return{canDropHandler:I,onDropHandler:F,onHoverHandler:q}},[]),X=r.useMemo(function(){return{canDragHandler:R,onBeginHandler:U,onEndHandler:z}},[]),V=r.useCallback(function(e){return D?r.createElement(o.DragSourceRelay,{dragSourceKey:H,type:b.DOCUMENT_DRAG_TYPE,handlers:X,barrier:_,layoutMode:g},e):e},[H,_]);return r.useCallback(function(e){return r.createElement(s.DropTargetRelay,{acceptType:k,dropTargetKey:H,handlers:W,layoutMode:g,showDropTargetHint:O,showDragOverHint:M,barrier:_},function(t){return V(p.renderChildrenWithProps(e,t))})},[H,g,O,M,_])(d)}return r.createElement(w.DeferredRender,{barrier:_},function(e){var s=e.hasResolved;return r.createElement(i.WithAction,{action:s?r.createElement(t,n.__assign({},D)):r.createElement(i.ActionBase,{isAvailable:!0})},B)})})}}});
define("CM",["require","exports","r","aD","Bc","Tc","Xp","u4","Wv"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pathColumnRenderHandler=function(e,t){var f=t.itemKey,l=t.renderer,c=e.demandItemFacet(i.parentFolderItemFacet,f),h=c&&e.demandItemFacet(i.openUrlFacet,c.itemKey)||"",p=h?(function(e){for(var t=[],n=new u.SimpleUri(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(h):[],d=c&&h?a.evaluateItemCacheComponent(e,n.createElement(o.ItemDefaultClickAction,{itemKey:c.itemKey})):null;return{renderer:function(e,t,i){var o=l?l(e,t,i):null;return n.createElement(n.Fragment,null,o?n.createElement(n.Fragment,{key:"content"},o):null,d?n.createElement(s.WithAction,{key:"path",action:d},function(e){var t=e.execute,i=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return n.createElement(r.PathField,{displayPathSegments:p,parentLink:h,onClick:i})}):null)}}}});
define("kKe",["require","exports","r","Nd","HB","ra","Bc","Ah","ul","_A","Md","B6","Bc","k6","we","MKe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";m=m.SocialBar_2;Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=n.useState(!0),i=t[0],c=t[1],h=function(){return c(!1)};return n.createElement(l.WithItemCache,null,function(t){var c,p=t.itemCache,y=p.demandItemFacet(o.analyticsItemFacet,e.itemKey),b=y&&y.itemKey,w=p.demandItemFacet(u.likeCountFacet,b);return n.createElement(f.Panel,{className:m.socialBarPanel,closeButtonAriaLabel:v.default.panelCloseAriaLabel,customWidth:"320px",isOpen:i,onDismiss:h,isBlocking:!0,isLightDismiss:!0,focusTrapZoneProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},type:f.PanelType.custom,onDismissed:e.resolve,headerText:""+(c=Number(w),d.format(d.getLocalizedCountValue(v.default.panelLikesHeaderText,v.default.panelLikesHeaderTextInterval,c)||"",c))},(function(e){return n.createElement(l.WithItemCache,null,function(t){var i=t.itemCache,u=i.demandItemFacet(o.likedByItemFacet,e.itemKey),f=i.demandItemFacet(o.likedByPeopleFacet,u&&u.likedByItemKey),l=f&&f.personKeys;return n.createElement("div",{className:s.css(m.socialBarPanelContent)},l&&l.length>0&&(function(e){return n.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical},n.createElement(a.List,{className:m.socialBarList,items:e&&e.map(function(e){return{key:e}}),onRenderCell:g}))})(l))})})(e))})};function g(e,t,r){return e&&n.createElement(l.WithItemCache,null,function(r){var s=r.itemCache,o=e&&e.key,u=s.demandItemFacet(c.userHoverCardControl,o),a=s.demandItemFacet(h.displayNameFacet,o),f=s.demandItemFacet(p.emailFacet,o),l=c.userHoverCardControl.evaluate(u)(s,{personKey:o}).userHoverCard,d=n.createElement(i.ActivityItem,{className:m.socialBarPanelPersona,activityPersonas:[{imageUrl:f,imageAlt:a}],activityDescription:n.createElement("div",{className:m.socialBarPanelPersonaDescription},a)});return l?n.createElement(l,{personKey:o,key:t},d):d})}});
define("$$e",["require","exports","r","bc","Wv","OWe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e){var t=e.subscribe;n.useLayoutEffect(function(){return t()},[t]);return null}t.ItemAutoRefresh=i.createItemCacheComponent(function(e,t){var r=t.itemKey,i=e.demandItemFacet(s.itemAutoRefreshControl,r),u=s.itemAutoRefreshControl.evaluate(i)(e,{itemKey:r,itemSubscriber:null}),a=u.isAvailable,f=u.itemSubscriber,l=u.subscribe;return a?f||(l?n.createElement(o,{subscribe:l}):null):null});t.CurrentItemAutoRefresh=r.withCurrentItemSet()(t.ItemAutoRefresh)});
define("SL",["require","exports","r","Md","Tc","bl","Xp","Bc","gc","DL"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemLink=function(e){var t=e.itemKey,l=e.action;return n.createElement(r.WithItemCache,null,function(r){var c,h=r.itemCache;if(e.children)c=e.children;else{var p=h.demandItemFacet(u.displayNameFacet,t);c=p}var d=a.getCurrentItemKey(h),v=(l||!f.haveSameParentItem(h,{itemKey1:t,itemKey2:d}))&&t?n.createElement(o.ItemDefaultClickAction,{itemKey:t}):null;return n.createElement(i.WithAction,{action:v},function(e){var t=e.isAvailable,r=e.execute,i=t?function(){r().catch(function(){})}:void 0;return i?n.createElement(s.Link,{onClick:i},c):n.createElement("span",null,c)})})}});
define("yE",["require","exports","r"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SELECTION_CONTEXT=n.createContext(void 0);t.SET_SIZE_CONTEXT=n.createContext(0)});
define("xE",["require","exports","r","Wv","Bc"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HeaderTileCell=r.connectToItemCache(function(e,t){return{text:e.demandItemFacet(i.displayNameFacet,t.itemKey)||""}})(function(e){return n.createElement("div",null,n.createElement("h3",null,e.text))})});
define("gE",["require","exports","ww","r","Um","Vc","ODBItemsScopeDeferred_mini_css","Xn","yE","vE","pc"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";o=o.ItemSetTilesList_2;Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.props,i=r.selection,s=r.selectionItems;i&&i.setItems(s,!0);n._initPerfCounterRef=!1;return n}t.prototype.render=function(){var e=this.props,t=e.selection,s=e.selectionMode,u=(e.ref,e.disableMarqueeSelection),c=e.ariaLabel,v=(e.selectionItems,e.onRenderTilesList),m=e.enterModalSelectionOnTouch,g=e.className,y=n.__rest(e,["selection","selectionMode","ref","disableMarqueeSelection","ariaLabel","selectionItems","onRenderTilesList","enterModalSelectionOnTouch","className"]);if(!this._initPerfCounterRef){if(void 0===f.tilesSelectorCount.read()){f.tilesSelectorCount.reset();f.tilesSelectorTime.reset();f.tilesRenderCount.reset();f.tilesRenderTime.reset()}this._initPerfCounterRef=!0}var b=v(n.__assign({className:l.css(o.root,g),"aria-label":c,role:"grid",onRenderRoot:p,onRenderRow:d},y)),w=t?r.createElement(i.SelectionZone,{selection:t,selectionMode:s,onItemInvoked:this.props.onItemInvoked,onItemContextMenu:this.props.onItemContextMenu,disableAutoSelectOnInputElements:!0,enterModalOnTouch:m,enableTouchInvocationTarget:!0},r.createElement(a.SELECTION_CONTEXT.Provider,{value:t},b)):b;return t?u?w:r.createElement(i.MarqueeSelection,{selection:t,onShouldStartSelection:h},w):b};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.selection,n=e.selectionItems;t&&t.setItems(n,e.setKey!==this.props.setKey||!e.setKey)};return t})(r.PureComponent);t.InjectableItemSetTilesList=s.withLayoutRenderComplete({qosName:"Tiles"})(c);function h(e){return!u.findElementRecursive(e.target,function(e){return null!==e.getAttribute("data-selection-index")})}function p(e,t){return e&&t?t(n.__assign(n.__assign({},e),{divProps:n.__assign(n.__assign({},e.divProps),{"aria-colcount":e.columnCount,"aria-rowcount":e.rowCount})})):null}function d(e,t){return e&&t?t(n.__assign(n.__assign({},e),{divProps:n.__assign(n.__assign({},e.divProps),{role:"row"})})):null}});
define("fE",["require","exports","ww","r","bg","DE","gE","pE"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return r.createElement(u.TilesList,n.__assign({},e))};t.ItemSetTilesList=i.withResponsiveMode()(function(e){var t=s.useItemSetTileCells(e);return r.createElement(o.InjectableItemSetTilesList,n.__assign({},e,t,{onRenderTilesList:a}))});t.ItemSetTilesList.displayName="ItemSetTilesList"});
define("CE",["require","exports","ww","r","OE","lm","Tc","Xp","nc","Wv","Ro","Ji","cs"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=new c.KeyFacet("itemTile",{itemKey:c.stringPart(),itemIndex:c.numberPart()}),d={defaultClickActionElement:null,dragDropElement:null};function v(e){var t=e.performanceData,u=n.__rest(e,["performanceData"]),f=l.useShallowMemo(function(){return u},u),c=l.useShallowMemo(function(){return t},t),h=c.defaultClickActionElement;return o.useAction(h,r.useCallback(function(e){return(function(e){var t=e.invokeActionStateProps,o=e.performanceData,u=e.tileProps,f=o.dragDropElement,l=u.itemKey,c=u.selectionIndex,h=t.isAvailable;a.useInvokeAction(n.__assign(n.__assign({},t),{itemKey:l,index:c}));var p=r.useMemo(function(){return r.createElement(i.ItemTile,n.__assign({role:"listitem",invokeSelection:h,href:h?"javascript:;":void 0},u))},[u,h]);return r.useMemo(function(){return s.renderChildrenWithDropZoneElement(p,f)},[p,f])})({invokeActionStateProps:e,performanceData:c,tileProps:f})},[c,f]))[1]}var m=new h.ComputedItemFacet("itemTileData",function(e,t){var n=e.demandItemFacet(p,t.itemKey);if(n){var i=n.itemIndex,a=n.itemKey;return{defaultClickActionElement:o.evaluateAction(e,r.createElement(u.ItemDefaultClickAction,{itemKey:a})),dragDropElement:f.evaluateItemCacheComponent(e,r.createElement(s.ItemDefaultDropZone,{itemKey:a,layoutMode:"absolute",enableDrag:!0,itemIndex:i}))}}});t.ItemTileCell=f.createItemCacheComponent(function(e,t){var i=t.itemKey,s=t.selectionIndex,o=e.demandItemFacet(m,p.serialize({itemIndex:s,itemKey:i}))||d;return r.createElement(v,n.__assign({},t,{performanceData:o}))});t.ItemTileCell.displayName="ItemTileCell"});
define("IE",["require","exports","r","Wv","Tc","Xp","I_","ODBItemsScopeDeferred_mini_css","bl"],function(e,t,n,r,i,s,o,u,a){"use strict";u=u.ItemSetTilesList_2;Object.defineProperty(t,"__esModule",{value:!0});t.ShowAllTileCell=r.connectToItemCache(function(e,t){var r=t.itemKey,o=void 0===r?"":r;return{defaultClickAction:i.evaluateAction(e,n.createElement(s.ItemDefaultClickAction,{itemKey:o}))}})(function(e){var t=e.defaultClickAction;return n.createElement(i.WithAction,{action:t},function(e){return n.createElement("div",{className:u.showAllCell},n.createElement(a.Link,{onClick:function(){return e.execute({})}},o.default.ShowAll))})})});
define("DE",["require","exports","ww","r","FE","Qm","Wm","tc","nm","Es","Bc","Fp","H1","C6","To","yE","CE","xE","IE","es","e3","Km","lc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SIZES={small:{tileDefaultHeight:135,tileDefaultWidth:138,documentGroupTileMargin:12,photoGroupTileMargin:8,groupMargin:40},large:{tileDefaultHeight:171,tileDefaultWidth:176,documentGroupTileMargin:8,photoGroupTileMargin:8,groupMargin:40}};t.useItemSetTileCells=function(e){var t=e.itemKey,n=e.doNotRenderShimmerTile,r=e.responsiveMode,i=e.layoutSupportsRandomAccess;return w.useItemCacheSelector(b.bindItemCacheSelectorToProps(x,e),[t,n,r,i])};function x(e,r){var i=r.itemKey,s=r.doNotRenderShimmerTile,p=void 0!==s&&s,d=r.responsiveMode,v=void 0===d?c.ResponsiveMode.large:d,b=r.layoutSupportsRandomAccess,w=e.demandItemFacet(E.itemSetPagingControl,r.itemKey),S=E.itemSetPagingControl.evaluate(w)(e,{setItemKey:r.itemKey}),x=S.totalItemCount,M=S.getPageKey,_=S.pageSize,D=b&&!!x&&void 0!==M,P=e.demandItemFacet(u.childItemsFacet,i),H=e.demandItemFacet(a.mediaGroupFacet,i),B=e.demandItemFacet(o.childItemsControl,i),j=o.childItemsControl.evaluate(B)(e,{itemKey:i,itemKeys:P&&P.itemKeys}).itemKeys,F=v>c.ResponsiveMode.large?"large":"small",I=t.SIZES[F],q=L(F),R=e.demandItemFacet(h.itemSetTilesListControl,i),U={mode:2,spacing:I.photoGroupTileMargin},z={mode:"large"===F?1:3,marginBottom:I.groupMargin,spacing:I.documentGroupTileMargin,minRowHeight:I.tileDefaultHeight},W=h.itemSetTilesListControl.evaluate(R)(e,{itemSetKey:i,itemKeys:j,responsiveMode:v,tileRenderer:m.ItemTileCell,disableMarqueeSelection:!1,grid:n.__assign(n.__assign({},z),H?U:{})}),X=W.tileRenderer,V=W.groupControlHandler,$=W.tileControlHandler,J=W.grid,K=W.disableMarqueeSelection,Q=W.className,G=[],Y=[],Z=[],ee=!0,te=0,ne=!0;if(j){for(var re=0,ie=j;re<ie.length;re++){var se=ie[re],oe=D&&void 0===se;if(oe||e.demandItemFacet(u.pageFacet,se,{suppressGetItems:!0})){Z.push({key:oe?te.toString():se,content:{key:se,setKey:i,index:-1,tileSize:F,tileMode:"document",enableRandomAccess:D},desiredSize:q,onRenderCell:C});oe&&te++}else if(e.demandItemFacet(a.isGroupFacet,se,{suppressGetItems:!0})){if(Z.length>0){G.push(n.__assign({key:"",items:Z},J));Z=[]}var ue=O(e,{itemKey:se}),ae=ue.itemKeys;ue.isResolved||(ne=!1);ue.hasContent||(ee=!1);var fe=e.demandItemFacet(a.mediaGroupFacet,se)||H,le=h.itemSetTilesListGroupControl.evaluate(V)(e,{groupKey:se,itemKeys:ae,tileRenderer:X,headerRenderer:g.HeaderTileCell,tileControlHandler:$,showHeader:!!e.demandItemFacet(l.displayNameFacet,se),maxItemCount:ae.length,grid:n.__assign(n.__assign({},J),fe?U:{})}),ce=le.tileRenderer,he=le.headerRenderer,pe=le.tileControlHandler,de=le.showHeader,ve=le.maxItemCount,me=le.grid,ge=!1;de&&he&&G.push({key:se,content:{key:se,index:-1,setKey:i,tileSize:F,tileMode:"document",headerRenderer:he},onRenderCell:N});for(var ye=[],be=0,we=ae;be<we.length;be++){var Ee=we[be];Y.push({key:Ee});var Se=h.itemSetTilesListTileControl.evaluate(pe)(e,{itemKey:Ee,desiredSize:fe&&A(e,{itemKey:Ee})||q,tileMode:fe?"media":"document"}),xe=Se.desiredSize,Te=Se.tileMode;e.demandItemFacet(u.pageFacet,Ee,{suppressGetItems:!0})?ye.push({key:se,content:{key:se,setKey:i,index:-1,tileSize:F,tileMode:"document"},desiredSize:xe,onRenderCell:C}):ye.push({key:Ee,content:{key:Ee,index:te,tileSize:F,tileMode:Te,setKey:i,tileRenderer:ce},desiredSize:xe,onRenderCell:T});te++;if(ye.length===ve&&ae.length>ve){ge=!0;break}}var Ne=n.__assign({key:se,items:ye},me);G.push(Ne);ge&&G.push({key:"ShowAll -"+se,content:{key:se,index:-1,setKey:i,tileSize:F,tileMode:"document",headerRenderer:y.ShowAllTileCell},onRenderCell:N})}else{Y.push({key:se});var Ce=h.itemSetTilesListTileControl.evaluate($)(e,{itemKey:se,desiredSize:H&&A(e,{itemKey:se})||q,tileMode:H?"media":"document"}),ke=(xe=Ce.desiredSize,Ce.tileMode);Z.push({key:se,content:{key:se,index:te,tileSize:F,tileMode:ke,setKey:i,tileRenderer:X},desiredSize:xe,onRenderCell:T});te++}}Z.length>0&&G.push(n.__assign({key:"",items:Z},J))}var Le=[],Ae=e.isItemFacetResolved(u.childItemsFacet,i)&&ne||!!e.demandItemFacet(f.errorFacet,i,{suppressGetItems:!0});!(Ae||j&&0!==j.length&&ee)&&Le.push(n.__assign(n.__assign({key:"",items:[{key:"",content:{key:"",setKey:i,index:te,tileSize:F,tileMode:H?"media":"document"},desiredSize:L(F),onRenderCell:k,isPlaceholder:!0}]},z),{isPlaceholder:!0}));return{setKey:i||"",items:Le.length>0?p?[]:Le:G,selectionItems:Y,isDataReadyForLayout:Ae,getPageKey:M,pageSize:_,disableMarqueeSelection:K,className:Q}}function T(e){var t=e.item,n=t.tileRenderer,i=t.key,s=t.setKey,o=t.index,u=t.tileMode,a=t.tileSize,f=e.item,l=e.finalSize,c=e.position.column;return n?r.createElement(v.SELECTION_CONTEXT.Consumer,null,function(e){return r.createElement(n,{role:"gridcell","aria-colindex":c+1,contentSize:l,itemKey:i,itemSetKey:s,tileSize:a,itemTileMode:u,isSelectable:e&&e.mode!==S.SelectionMode.none&&e.canSelectItem(f),selectionIndex:o,selection:e})}):null}function N(e){var t=e.item,n=t.headerRenderer,i=t.key;return n?r.createElement(v.SELECTION_CONTEXT.Consumer,null,function(e){return r.createElement(n,{itemKey:i,selection:e})}):null}function C(e){var t=e.item,n=e.finalSize;return t.enableRandomAccess?null:r.createElement(s.ItemPage,{itemKey:t.key,layout:"tile",contentSize:n})}function k(e){var t=e.finalSize;return r.createElement(i.ShimmerTile,{contentSize:t,itemName:!0,itemActivity:!0,itemThumbnail:!0,role:"presentation"})}function L(e){var n=t.SIZES[e];return{width:n.tileDefaultWidth,height:n.tileDefaultHeight}}function A(e,t){var n=e.demandItemFacet(p.thumbnailFacet,t.itemKey)||e.demandItemFacet(p.dimensionsFacet,t.itemKey);return n&&d.pickObject(n,["width","height"])}function O(e,t){var n=!0,r=!0,i=e.demandItemFacet(u.childItemsFacet,t.itemKey),s=e.demandItemFacet(f.errorFacet,t.itemKey,{suppressGetItems:!0});if(!e.isItemFacetResolved(u.childItemsFacet,t.itemKey)&&!s){i||(r=!1);n=!1}for(var l=i&&i.itemKeys||[],c=e.demandItemFacet(o.childItemsControl,t.itemKey),h=[],p=0,d=o.childItemsControl.evaluate(c)(e,{itemKeys:l,itemKey:t.itemKey}).itemKeys;p<d.length;p++){var v=d[p];if(e.demandItemFacet(a.isGroupFacet,v,{suppressGetItems:!0})){var m=O(e,{itemKey:v}),g=m.itemKeys,y=m.isResolved,b=m.hasContent;h.push.apply(h,g);b||(r=!1);y||(n=!1)}else h.push(v)}return{itemKeys:h,isResolved:n,hasContent:r}}});
define("OE",["require","exports","ww","r","FE","ME","xh","$h","ODBItemsScopeDeferred_mini_css","rb","yh","dm","Em","wE","Md","ra","Pm","Bc","nm","C6","Mh","CC","ys","O5","Wi","Wv","Oo","Oo","vE","Qp"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){"use strict";a=a.ItemTile_8;Object.defineProperty(t,"__esModule",{value:!0});var O={small:{iconSize:48},large:{iconSize:64}},M=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=(e.itemKey,e.className),s=n.__rest(e,["itemKey","className"]);return r.createElement(i.Tile,n.__assign({},s,{className:v.css(a.defaultTile,t)}))};return t})(r.PureComponent),_=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onThumbnailLoad=function(){n.setState({thumbnailLoaded:!0})};n.state={};return n}t.prototype.render=function(){var e=this,t=this.props,_=t.itemKey,D=t.className,P=t.itemTileMode,H=void 0===P?"document":P,B=t.background,j=t.foreground,F=n.__rest(t,["itemKey","className","itemTileMode","background","foreground"]),I=this.props,q=I.tileSize,R=void 0===q?"large":q,U=I.selectionIndex,z=this.state.thumbnailLoaded;return r.createElement(d.WithItemCache,null,function(t){var d,P=t.itemCache;C.mark("ItemTile.render("+U+")");var I=k.now(),q=P.demandItem({displayName:g.displayNameFacet,dateModified:g.dateModifiedFacet,folder:g.folderFacet,oneNote:T.oneNoteFacet,isGroup:y.isGroupFacet,count:y.countFacet,isShared:g.isSharedFacet},_),W=q.displayName,X=q.folder,V=q.oneNote,$=q.isGroup,J=q.count,K=q.isShared,Q=P.demandItemFacet(E.itemTileControl,_),G=E.itemTileControl.evaluate(Q)(P,{itemKey:_,itemName:r.createElement(u.BaseText,{className:a.name,"data-automationid":"name",text:W||"",title:W||""}),itemActivity:r.createElement(x.DateRenderer,{itemKey:_}),tileAs:M,enableItemHoverCard:!0}),Y=G.tileAs,Z=G.itemName,ee=G.itemActivity,te=G.enableItemHoverCard,ne=G.folderCoverControlHandler,re=l.getLifeCycleSignals(P,_,1,!0),ie=re&&re.map(function(e){return e.signal}),se=P.isItemFacetResolved(b.thumbnailFacet,_),oe=se?P.demandItemFacet(b.thumbnailFacet,_):void 0,ue=P.demandItemFacet(c.itemAriaLabelControl,_),ae=h.getRowAriaLabel(P,{itemKey:_}),fe=c.itemAriaLabelControl.evaluate(ue)(P,{itemKey:_,itemAriaLabel:ae}).itemAriaLabel,le=P.demandItemFacet(S.enableFluentIconsFacet,S.configurationItemKey),ce=h.getRowCheckboxAriaLabel(P,{itemKey:_}),he=N.evaluateItemCacheComponent(P,Z),pe=N.evaluateItemCacheComponent(P,ee),de=r.createElement(Y,n.__assign({itemKey:_,className:v.css(a.tile,D,(d={},d[a.hideThumbnail]=!z,d[a.hideFileTypeIcon]=!!z||!!oe,d)),itemName:he?r.createElement(o.SignalField,{signalsFieldMode:"compact",before:ie},he):null,ariaLabel:fe,toggleSelectionAriaLabel:ce,"data-automationid":"ItemTile",itemActivity:pe?r.createElement(o.SignalField,null,pe):null},F,{showForegroundFrame:!("document"!==H||X&&!V),showBackgroundFrame:"media"===H,hideForeground:!!oe&&!z,hideBackground:!!oe&&!z,foreground:r.createElement("div",null)})),ve=i.getTileLayout(de),me=ve.foregroundSize,ge=void 0===me?{width:0,height:0}:me,ye=ve.backgroundSize,be=void 0===ye?{width:0,height:0}:ye,we=[],Ee=[];if(X&&!V||$){var Se=E.itemTileFolderCoverControl.evaluate(ne)(P,{itemKey:_,signalData:e._getFolderCoverSignalData(K),folderCoverAs:s.FolderCover}),xe=Se.signalData,Te=Se.folderCoverAs,Ne=xe&&xe.signal,Ce=r.createElement(Te,{key:"folder",itemKey:_,className:a.folderCover,folderCoverSize:e.props.tileSize,folderCoverType:"default",metadata:J?J.toLocaleString(m.Locale.language):J,signal:Ne,isFluent:le}),ke=s.getFolderCoverLayout(Ce).contentSize;we.push(s.renderFolderCoverWithLayout(Ce,{children:J?r.createElement("span",{className:a.blankFolderCover,style:{width:ke.width+"px",height:ke.height+"px"}}):null}))}else if(!se||z||oe){"media"===H?Ee.push(N.evaluateItemCacheComponent(P,r.createElement(p.ItemThumbnail,{key:"thumbnail",itemKey:_,className:a.thumbnail,desiredSize:be,onLoad:e._onThumbnailLoad}))):we.push(N.evaluateItemCacheComponent(P,r.createElement(p.ItemThumbnail,{key:"thumbnail",itemKey:_,className:a.thumbnail,desiredSize:ge,onLoad:e._onThumbnailLoad})));we.push(N.evaluateItemCacheComponent(P,r.createElement(f.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:_,className:z?a.tileAppIcon:a.fileTypeIcon,size:z?16:O[R].iconSize,preferAppIcon:!!z})))}else se&&z||we.push(N.evaluateItemCacheComponent(P,r.createElement(f.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:_,className:a.fileTypeIcon,preferAppIcon:!1,size:O[R].iconSize})));var Le=N.evaluateItemCacheComponent(P,i.renderTileWithLayout(de,{foreground:j||null===j?j:we.length>0?we:null,background:B||null===B?B:Ee.length>0?Ee:null})),Ae=te&&w.getItemHoverCard(P,{itemKey:_}),Oe=k.now()-I;L.tilesSelectorTime.add(Oe);return r.createElement(A.RenderPerformanceMeasurer,{renderPerformanceCounter:L.tilesRenderTime},Ae?N.evaluateItemCacheComponent(P,r.createElement(Ae,{itemKey:_},Le)):Le)})};t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.itemKey!==this.props.itemKey&&this.setState({thumbnailLoaded:!1})};t.prototype._getFolderCoverSignalData=function(e){return{signal:e?r.createElement(o.SharedSignal,null):null,key:e?"shared":""}};return t})(r.PureComponent);t.ItemTile=_});
define("hW",["require","exports","ww","r","_p","U_","Ug","bW","Wv","sa"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NO_ITEMS=[];t.ActionContextMenu=a.createItemCacheComponent(function(e,a){var l=a.items,c=void 0===l?t.NO_ITEMS:l,h=a.directionalHint,p=void 0===h?i.DirectionalHint.rightTopEdge:h,d=a.isBeakVisible,v=void 0!==d&&d,m=a.isOpen,g=a.contextMenuAs,y=n.__rest(a,["items","directionalHint","isBeakVisible","isOpen","contextMenuAs"]),b=g?f.composeComponentAs(g,i.ContextualMenu):i.ContextualMenu;return r.createElement(s.CommandSet,{commands:a.commands},function(e){var t=e.menuItems,i=o.concat(c,u.cleanContextMenuItems(t,a));return m?r.createElement(b,n.__assign({},y,{items:i,directionalHint:p,isBeakVisible:v})):null})})});
define("vW",["require","exports","ww","r","bc","Wv","hW","F1","T0","M0","x0","D0","p0","o0","Zg","Gc","Nm","gc","Pg","Ug","Oo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=[a.newCommand,f.openCommand,l.uploadCommand,c.shareCommand,c.copyLinkCommand,y.followCommand,h.downloadCommand,d.deleteCommand,p.renameCommand],S=v.createTelemetryProvider({withContext:{component:"ContextMenu"}});t.ItemsContextMenu=m.wrapWithParent(S)(s.createItemCacheComponent(function(e,t){t.isOpen&&w.mark("ItemsContextMenu.render");var s=g.getCurrentItemKey(e),a=i.getCurrentItemSetKey(e),f=t.commands,l=void 0===f?[]:f,c=e.demandItemFacet(u.itemsContextMenuControl,s),h=u.itemsContextMenuControl.evaluate(c)(e,{itemKey:s||"",itemSetKey:a,commands:E,preserveIcons:t.preserveIcons}),p=h.commands,d=h.onMenuOpened,v=h.contextMenuAs,m=h.preserveIcons;return r.createElement(o.ActionContextMenu,n.__assign({},t,{commands:b.concat(p,l),onMenuOpened:d,contextMenuAs:v,preserveIcons:m}))}));t.ItemsContextMenu.displayName="ItemsContextMenu"});
define("bW",["require","exports","ww","gW"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cleanContextMenuItems=function e(t,i){var s=i.target,o=i.preserveIcons,u=void 0!==o&&o;return t.map(function(t){var o=t.subMenuProps,a=t.onClick,f=t.hasLaunchTarget,l=n.__rest(t,["subMenuProps","onClick","hasLaunchTarget"]);return n.__assign(n.__assign({},l),{name:t.iconProps&&"More"===t.iconProps.iconName?r.default.More:t.name,icon:void 0,iconProps:u?t.iconProps:void 0,subMenuProps:o?n.__assign(n.__assign({},o),{items:e(o.items,i)}):void 0,onClick:f&&a?function(e){e&&s&&(s instanceof Event?e.target=s.target:s instanceof Element&&(e.target=s));a(e)}:a})})}});
define("LA",["require","exports","r","rc","Uo","ga"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=0;t.KeyboardZone=function(e){var t=e.isDefault,s=void 0!==t&&t,u=n.useState(""+ ++o)[0],f=n.useContext(r.KEYBOARD_CONTEXT),l=n.useRef(),c=l.current||s&&f.keyboardManager||(l.current=new r.KeyboardManager({isDefault:!1,id:u,parent:f.keyboardManager})),h=a(c),p=h.isActive,d=h.isChildActive;n.useEffect(function(){return function(){if(!s){c.setIsActive(!1);c.dispose()}}},[]);var v=n.useMemo(function(){return{keyboardManager:c}},[c]);return n.createElement("div",{"data-keyboard-zone-id":u},n.createElement(r.KEYBOARD_CONTEXT.Provider,{value:v},i.renderChildrenWithProps(e.children,{isActive:p,isChildActive:d})))};t.WithKeyboardZone=function(e){var t=u(),n=t.isActive,r=t.isChildActive;return i.renderChildrenWithProps(e.children,{isActive:n,isChildActive:r})};function u(){return a(n.useContext(r.KEYBOARD_CONTEXT).keyboardManager)}t.useKeyboardZone=u;function a(e){var t=n.useState(function(){return e.getIsActive()}),r=t[0],i=t[1],o=n.useState(function(){return e.hasActiveChildren()}),u=o[0],a=o[1];n.useEffect(function(){var t=new s.EventGroup(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:r,isChildActive:u}}});
define("aL",["require","exports","ww","r","ou","HA","oL","Zm","ODBItemsScopeDeferred_mini_css","iL"],function(e,t,n,r,i,s,o,u,a,f){"use strict";a=a.NameDialog_8;Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onNameRef=function(e){r._textField=e;r._focusOnTextfield()};r._onNameChanged=function(e,t){void 0===t&&(t="");var n=r.props.validator;r.setState({name:t,errorMessage:n?n(t):void 0})};r._onClickAction=function(){return n.__awaiter(r,void 0,void 0,function(){var e,t,r=this;return n.__generator(this,function(n){switch(n.label){case 0:this.setState({showSpinner:!0});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,this.props.onContinue({name:this.state.name})];case 2:n.sent();return[3,5];case 3:t=n.sent();e=t;this._isDisposed||this.setState({errorMessage:e&&e.message});return[3,5];case 4:this._isDisposed||this.setState({showSpinner:!1},function(){e&&r._focusOnTextfield()});return[7];case 5:return[2]}})})};r._onKeyPress=function(e){if(13===e.which){e.preventDefault();e.stopPropagation();r._onClickAction()}};r.state={name:r.props.name};return r}t.prototype.render=function(){var e=this.state,t=e.name,n=e.errorMessage,l=e.showSpinner,c=this.props,h=c.continueText,p=void 0===h?f.default.continue:h,d=c.cancelText,v=c.onCancel,m=c.placeHolder,g=c.maxLength,y=c.fileExtensionText,b=c.isMultiline,w=c.cols;return r.createElement(s.Dialog,{dialogContentProps:{type:s.DialogType.close},hidden:!1,title:this.props.title,onDismiss:v},r.createElement("div",{className:a.nameDialogContent},r.createElement(o.TextField,{ariaLabel:m,componentRef:this._onNameRef,value:t,onChange:this._onNameChanged,errorMessage:n,placeholder:m,maxLength:g,onKeyPress:this._onKeyPress,multiline:b,cols:w}),y&&r.createElement("span",{className:a.nameDialogContentFileExtension},y)),r.createElement(s.DialogFooter,null,r.createElement(u.PrimaryButton,{disabled:!t||!!n||l,onClick:this._onClickAction,"data-automation-id":p},p),d&&r.createElement(u.DefaultButton,{onClick:v},d),l&&r.createElement(i.Spinner,{size:i.SpinnerSize.medium,className:a.nameDialogSpinner})))};t.prototype.componentWillUnmount=function(){this._isDisposed=!0};t.prototype._focusOnTextfield=function(){if(this._textField){this._textField.focus();this._textField.select()}};return t})(r.PureComponent);t.NameDialog=function(e){return r.createElement(l,n.__assign({},e))}});
define("tk",["require","exports","ww","r","nk","To","Mc","Z_","bc","Wv"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemCancelProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys.filter(function(t){return"started"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),f=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){f(i.cancelProgressItems({items:s.makeObject(a,function(){return{}})}));return[2]})})},isAvailable:a.length>0})});t.CancelProgressAction=a.withSelectedItems()(t.ItemCancelProgressAction)});
define("ek",["require","exports","ww","r","To","Mc","Z_","nm","bc","Wv"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemExpireProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys.filter(function(t){var n=e.demandItemFacet(u.isGroupFacet,t),r=o.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase;return n&&"failed"===r}),f=e.dispatch;return r.createElement(s.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){f(o.expireProgressItems({items:i.makeObject(a,function(){return!0})}));return[2]})})},isAvailable:a.length>0})});t.ExpireProgressAction=a.withSelectedItems()(t.ItemExpireProgressAction)});
define("lW",["require","exports","ww","r","cW","To","Mc","Z_","bc","Wv"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemResolveProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys,f=t.conflictResolution,l=a.filter(function(t){return"failed"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),c=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){c(i.resolveProgressItems({items:s.makeObject(l,function(){return{conflictResolution:f}})}));return[2]})})},isAvailable:l.length>0})});t.ResolveProgressAction=a.withSelectedItems()(t.ItemResolveProgressAction)});
define("gL",["require","exports","ww","r","yL","To","Mc","Z_","bc","jo","i0","Ac","Wv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRetryDeleteWithBreakLockProgressAction=h.createItemCacheComponent(function(e,t){var a=t.itemKeys,h=a.filter(function(t){return"failed"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),p=e.dispatch;return r.createElement(o.Action,n.__assign({onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){p(f.resolveItems({items:s.makeObject(h,function(){return l.deleteItemsOperation.pack({breakLock:!0})})}));p(i.retryProgressItems({items:s.makeObject(h,function(){return{}})}));return[2]})})},isAvailable:h.length>0},c.getItemActionEngagement(e,{itemKey:a[0],engagement:{name:"ForceDeleteWithBreakLock",isIntentional:!0}})))});t.RetryDeleteWithBreakLockProgressAction=a.withSelectedItems()(t.ItemRetryDeleteWithBreakLockProgressAction)});
define("pW",["require","exports","ww","r","yL","To","Mc","Z_","bc","Wv"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRetryProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys.filter(function(t){return"failed"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),f=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){f(i.retryProgressItems({items:s.makeObject(a,function(){return{}})}));return[2]})})},isAvailable:a.length>0})});t.RetryProgressAction=a.withSelectedItems()(t.ItemRetryProgressAction)});
define("qL",["require","exports","ww","r","Wf","sa","Yf","ODBItemsScopeDeferred_mini_css","To","Yv","dk","YL","b_","qg","Z_","Wv","ih","e3","xo","Bs","QL"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";u=u.ProgressCallout_7;Object.defineProperty(t,"__esModule",{value:!0});function E(e){var t=r.useState(!0),i=t[0],s=t[1];r.useEffect(function(){var e=setTimeout(function(){s(!1)},0);return function(){clearTimeout(e)}},[]);return r.createElement(o.FocusTrapZone,n.__assign({},e,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disabled:i}),e.children)}function S(e){return r.createElement(r.Fragment,null,r.createElement("div",{className:u.progressList,role:"presentation"},r.createElement(f.ControlHandlerProvider,{controlHandlers:l.progressListControl.pack(x)},r.createElement(c.ProgressList,{itemKeys:e.itemKeys,role:"presentation"}))),e.showViewAll?r.createElement("div",{className:u.viewAllButton,role:"presentation"},r.createElement(h.ActionButton,{onClick:e.onViewAllClick},p.default.progressViewAllActionText)):null)}t.ProgressCallout=v.connectToItemCache(function(e,t){var n=t.finishedItemKeys.filter(function(t){var n=d.getOverallProgressPhase(e,{itemKey:t});return n===m.ProgressPhase.completed||n===m.ProgressPhase.canceled}),r=e.demandItemFacet(w.progressCalloutControl,d.progressRootItemKey);return{contentAs:w.progressCalloutControl.evaluate(r)(e,{contentAs:S}).contentAs,itemKeysToExpire:n}})(function(e){var t=e.isExecuting,n=e.finishedItemKeys,o=e.target,f=e.doNotExpire,l=e.onDismiss,c=e.onViewAll,h=e.itemKeysToExpire,p=r.useState(!0),v=p[0],m=p[1],w=g.useItemCacheDispatch(),x=r.useMemo(function(){return a.makeObject(n||[],function(){return!0})},[n]),T=b.usePreviousValue(x);r.useEffect(function(){if(!t){for(var e=T||{},r=!1,i=0,s=n;i<s.length;i++){s[i]in e||(r=!0)}r&&m(!1)}},[t,n]);var N=r.useMemo(function(){return n.slice(-1)},[n]),C=b.usePreviousValue(N);r.useEffect(function(){if(C){var e=C[0];e&&(e in x||m(!0))}},[x]);r.useEffect(function(){if(v){f||w(d.expireProgressItems({items:a.makeObject(h,function(){return!0})}));l()}},[v,l]);var k=y.useEventHandler(function(e){e&&e.stopPropagation();c&&c(e)}),L=function(){m(!0)};if(t||v||!n.length)return null;var A=e.contentAs!==S?s.composeComponentAs(e.contentAs,S):S;return r.createElement(i.Callout,{target:o,role:"alert","aria-live":"assertive",directionalHint:i.DirectionalHint.bottomCenter,onDismiss:L,isBeakVisible:!1},r.createElement(E,{className:u.callout,role:"presentation"},r.createElement(A,{itemKeys:N,onViewAllClick:k,onCalloutDismiss:L,showViewAll:n.length>1})))});function x(e,t){return{groupControlHandler:N}}var T=3;function N(e,t){return(t.childItemKeys?t.childItemKeys.length:0)>T?{maxChildItemCount:0}:{}}});
define("dW",["require","exports","r","lW","qi","qg"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameProgressCommand={key:new i.Facet("renameProgressCommand").id,name:s.default.progressRenameActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"rename"})}});
define("uW",["require","exports","r","lW","qi","qg"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.replaceProgressCommand={key:new i.Facet("renameProgressCommand").id,name:s.default.progressReplaceActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"replace"})};t.addNewVersionProgressCommand={key:new i.Facet("addNewVersionProgressCommand").id,name:s.default.progressAddNewVersionActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"replace"})}});
define("bL",["require","exports","r","qi","gL","r0"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryForceDeleteCommand={key:new r.Facet("forceDeleteCommand").id,name:s.default.deleteConfirmButtonText,action:n.createElement(i.RetryDeleteWithBreakLockProgressAction,null)}});
define("fW",["require","exports","r","pW","qi","qg"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryProgressCommand={key:new i.Facet("retryProgressCommand").id,name:s.default.progressRetryActionText,action:n.createElement(r.RetryProgressAction,null)}});
define("XL",["require","exports","ww","r","ra","ODBItemsScopeDeferred_mini_css","ak","Md","G_","rb","Z_","t_","we","qg","ih","Bc","Es","Tc","tk","ek","Hs","ZL","Yv","ec"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";s=s.ProgressItemTile_3;var T,N;Object.defineProperty(t,"__esModule",{value:!0});var C=[],k=((T={})[d.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericStartedItemsTitle,p.default.genericCompletedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericCompletedItemsTitle,p.default.genericCompletedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericFailedItemsTitle,p.default.genericFailedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericFailedItemsTitle,p.default.genericFailedItemsTitleIntervals,e)||"",e)},T),L=((N={})[d.ProgressPhase.created]=p.default.genericCreatedDescription,N[d.ProgressPhase.canceled]=p.default.genericCanceledDescription,N[d.ProgressPhase.completed]=p.default.genericCompletedDescription,N),A=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t,n=this.props,u=n.icon,a=n.actions,f=n.cancel,l=n.description,c=n.title,h=c?r.createElement("div",{className:i.css(s.title)},c):c,p=l?r.createElement("div",{className:i.css(s.description)},l):l;return r.createElement("div",{className:i.css(s.tile,(e={},e[s.hasIcon]=!!u,e[s.error]=!!this.props.error,e))},u?r.createElement("span",{className:i.css(s.icon,(t={},t[s.hasProgress]=!this.props.progressHidden,t))},this.props.icon):null,r.createElement("div",{className:i.css(s.progress)},r.createElement(o.ProgressIndicator,{label:h,description:p,percentComplete:this.props.percentComplete,progressHidden:this.props.progressHidden})),a?r.createElement("div",{className:i.css(s.actions)},a):null,f?r.createElement("span",{className:i.css(s.cancel)},f):null)};return t})(r.PureComponent);t.ProgressTile=A;var O=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,i=t.itemKey,s=t.format;return r.createElement(u.WithItemCache,null,function(t){var o=t.itemCache,u=(t.dispatch,o.demandItemFacet(d.sourceItemFacet,i)),h=u&&u.itemKey,T=o.demandItemFacet(v.displayNameFacet,i)||o.demandItemFacet(v.displayNameFacet,h),N=o.demandItemFacet(m.errorFacet,i),O=o.demandItemFacet(a.progressControl,i),M=l.getItemCountsByProgressPhase(o,{itemKey:i}),_=l.getOverallSimpleProgressBreakdown(o,{itemKey:i}),D=_.phase,P=_.count,H=l.getOverallProgressPhase(o,{itemKey:i}),B=o.demandItemFacet(d.overallProgressSizeFacet,i),j=B?0!==B.total?B.current/B.total:void 0:D!==d.ProgressPhase.started?1:void 0,F=a.progressControl.evaluate(O)(o,n.__assign(n.__assign({itemKey:e.props.itemKey,title:T||k[D](P),description:N&&!w.isCancel(N)?N.message:L[H]},j?{percentComplete:j}:{}),{itemCountsByPhase:M,format:s,commands:C})),I=F.title,q=F.description,R=F.percentComplete,U=F.commands,z="started"===D?r.createElement(y.CancelProgressAction,null):"failed"===D?r.createElement(b.ExpireProgressAction,null):null,W="started"===D||"failed"===D&&"number"==typeof R&&R<1;return r.createElement(S.ControlHandlerProvider,{controlHandlers:x.selectedItemsControl.pack(function(e,t){return{itemKeys:[i]}})},r.createElement(g.WithAction,{action:z},function(e){var t=e.execute,n=e.isAvailable?function(){t().catch(function(){})}:void 0;return r.createElement(A,{title:I,description:q,percentComplete:R,error:N&&!w.isCancel(N)?N:void 0,progressHidden:!W,icon:"item"===s?r.createElement(f.ItemFileTypeIcon,{itemKey:h,size:48}):void 0,cancel:n?r.createElement(c.IconButton,{iconProps:{iconName:"Cancel"},ariaLabel:"started"===D?p.default.progresslistCancelButtonAriaLabel:p.default.progresslistRemoveButtonAriaLabel,onClick:n}):void 0,actions:U.length>0?r.createElement(E.ActionCommandButtonStrip,{commands:U}):void 0})}))})};return t})(r.PureComponent);t.ProgressItemTile=O});
define("YL",["require","exports","r","pE","XL","ODBItemsScopeDeferred_mini_css","qg","ra","ih","tc","Z_","dk","Wv","yE"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";s=s.ProgressList_3;Object.defineProperty(t,"__esModule",{value:!0});var d=n.createContext(void 0),v=function(){var e=n.createRef();n.useEffect(function(){e&&e.current&&e.current.focus()});return n.createElement("p",{ref:e,tabIndex:-1},o.default.progressNoItemsMessage)};t.ProgressList=h.createItemCacheComponent(function(e,t){for(var i=t.itemKeys,o=t.groupsOnly,u=t.role,h=[],g=e.demandItemFacet(c.progressListControl,void 0),b=c.progressListControl.evaluate(g)(e,{}).groupControlHandler,w=function(t){if(l.getOverallProgressPhase(e,{itemKey:t})===a.ProgressPhase.expired)return"continue";var n=function(r,i){h.push({key:r,content:{itemKey:r,index:h.length},onRender:0===i?m:y});if(!(o&&i>=1)){var s,u=e.demandItemFacet(c.progressListGroupControl,t),l=e.demandItemFacet(f.childItemsFacet,r),p=l&&l.itemKeys;p&&(s=p.filter(function(t){return!e.demandItemFacet(a.progressAggregationOnlyFacet,t)}));var d=c.progressListGroupControl.evaluate(u,b)(e,{itemKey:r,childItemKeys:s,maxChildItemCount:void 0}).maxChildItemCount;if(s)for(var v=0,g="number"==typeof d?s.slice(0,d):s;v<g.length;v++){var w=g[v];n(w,i+1)}}};n(t,0)},E=0,S=i;E<S.length;E++){w(S[E])}return h.length>0?n.createElement(p.SET_SIZE_CONTEXT.Provider,{value:h.length},n.createElement(d.Provider,{value:u},n.createElement(r.TilesList,{className:s.root,items:h,role:u}))):n.createElement(v,null)});function m(e){var t=e.itemKey,r=e.index;return n.createElement(g,{itemKey:t,index:r})}function g(e){var t=e.itemKey,r=e.index,o=n.useContext(p.SET_SIZE_CONTEXT),a=n.useContext(d);return n.createElement("div",{className:u.css(s.group),role:a?"presentation":"listitem","aria-posinset":a?void 0:r+1,"aria-setsize":a?void 0:o},n.createElement(i.ProgressItemTile,{itemKey:t,format:"group"}))}function y(e){var t=e.itemKey,r=e.index;return n.createElement(b,{itemKey:t,index:r})}function b(e){var t=e.itemKey,r=e.index,o=n.useContext(p.SET_SIZE_CONTEXT),a=n.useContext(d);return n.createElement("div",{className:u.css(s.item),role:a?"presentation":"listitem","aria-posinset":a?void 0:r+1,"aria-setsize":a?void 0:o},n.createElement(i.ProgressItemTile,{itemKey:t,format:"item"}))}});
define("yW",["require","exports","r","_A","Z_","qg","YL","Md","To","tc","ih","xo","SW"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=[];t.ProgressPanel=function(e){var t=e.resolve,d=n.useState(!0),v=d[0],m=d[1],g=c.useEventHandler(function(){m(!1)}),y=n.useCallback(function(e){var u=e.itemCache,c=e.dispatch,d=u.demandItemFacet(f.childItemsFacet,i.progressRootItemKey),m=d&&d.itemKeys||p,y=m.filter(function(e){var t=i.getOverallProgressPhase(u,{itemKey:e});return t===l.ProgressPhase.completed||t===l.ProgressPhase.canceled}),b=u.demandItemFacet(h.progressPanelControl,i.progressRootItemKey),w=h.progressPanelControl.evaluate(b)(u,{itemKeys:m,panelAs:r.Panel}).panelAs;return n.createElement(w,{isOpen:v,headerText:s.default.progressTitle,isLightDismiss:!0,onDismiss:g,onDismissed:function(){c(i.expireProgressItems({items:a.makeObject(y,function(){return!0})}));t()},closeButtonAriaLabel:s.default.progressCloseActionText},n.createElement(o.ProgressList,{itemKeys:m}))},[v,t]);return n.createElement(u.WithItemCache,null,y)}});
define("TN",["require","exports","ww","r","Au","KN","GN","VN","RN","UN"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DropTargetHook=function(e){return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(o.DropTargetHookWrapper,n.__assign({},e)))};t.DragSourceHook=function(e){var t=e.dragSourceKey,i=e.type;return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(u.DragSourceHookWrapper,n.__assign({},e)),e.showDefaultDragPreview?null:r.createElement(u.DragLayerHookWrapper,{dragSourceKey:t,type:i},r.createElement(a.DragLayerPreview,null)))};t.DragDropHook=r.memo(function(e){var t=e.dragDropKey,i=e.dragType;return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(f.DragDropHookWrapper,n.__assign({},e)),e.showDefaultDragPreview?null:r.createElement(u.DragLayerHookWrapper,{dragSourceKey:t,type:i,as:l,getItemStyles:c},r.createElement(a.DragLayerPreview,null)))});var l=r.forwardRef(function(e,t){return r.createElement(i.Layer,null,r.createElement("div",{className:e.className,ref:t},e.children))});function c(e,t,n,r,i){if(!(e&&t&&n&&r))return{display:"none"};var s={top:0,left:0};if(null!==i){var o=i.getBoundingClientRect();if(o){s.top=o.top;s.left=o.left}}var u=t||{x:0,y:0},a=u.x,f=u.y,l="translate("+a+"px, "+(f-=s.top)+"px)";return{transform:l,WebkitTransform:l}}});
define("RN",["require","exports","r","we","sb","jN","ODBItemsScopeDeferred_mini_css","rb","NN","Md"],function(e,t,n,r,i,s,o,u,a,f){"use strict";o=o.DragLayerPreview_5;Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){var t=e.draggedItem,a=t.dragSourceKey,f=t.itemKeys,l=void 0===f?[]:f,c=l[0]||a,h=l.length>0?l.length:a?1:0,p="",d=null;if(h<1)return null;p=r.format(r.getLocalizedCountValue(s.default.dragMoveItemsPreviewText,s.default.dragMoveItemsPreviewTextIntervals,h)||"",h);d=1===h?n.createElement(u.ItemFileTypeIcon,{itemKey:c,size:20,className:o.dragPreviewIcon}):n.createElement(u.FileTypeIcon,{type:i.FileIconType.genericFile,size:20,className:o.dragPreviewIcon});return p?n.createElement("div",{className:o.dragPreviewRoot},d||null,n.createElement("span",{className:o.dragPreviewText},p)):null};t.DragLayerPreview=n.memo(function(e){var t=e.draggedItem,r=n.useCallback(function(e){var r=e.itemCache;if(!t)return null;var i=t.dragSourceKey,s=t.itemKeys,o=s||[i],u=r.demandItemFacet(a.dragLayerPreviewControl,i),f=a.dragLayerPreviewControl.evaluate(u)(r,{itemKeys:o,dragLayerPreviewRenderer:l}).dragLayerPreviewRenderer;return n.createElement(f,{draggedItem:t})},[t?t.dragSourceKey:void 0]);return n.createElement(f.WithItemCache,null,r)})});
define("Ly",["require","exports","ww","r","r","b3","Uo","mm","ra","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";var l=f.LayoutMode_0;f=f.DragDropWrapper_0;Object.defineProperty(t,"__esModule",{value:!0});var c="DragSourceRelay",h="dragsourcekey";function p(e){var t,i,s=e.children,p=e.collectedProps,d=e.connectDragSource,v=e.dragSourceKey,m=e.layoutMode,g=void 0===m?"static":m,y=o.renderChildrenWithProps(s,u.DEFAULT_ACTION_DROP_ZONE_STATE_PROPS),b=(p||{}).isDragging,w=void 0!==b&&b;return r.createElement("div",n.__assign({ref:d,"data-drag-source-key":v,"data-is-dragging":w},((t={})[h]=v,t),{className:a.css(c,l.root,(i={},i[l.absolute]="absolute"===g,i[l.fullHeight]="full-height"===g,i[f.dragging]=w,i))}),y)}t.useConnectedDragSource=p;var d=p,v=s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["TN"],t,n)})];case 1:return[2,t.sent().DragSourceHook]}})})});t.DragSourceRelay=function(e){var t=e.children,s=e.dragSourceKey,o=e.type,u=e.handlers,a=e.barrier,f=e.showDefaultDragPreview,l=void 0!==f&&f,c=n.__rest(e,["children","dragSourceKey","type","handlers","barrier","showDefaultDragPreview"]),h=i.useState(),p=h[0],m=h[1],g=p&&p.collectedProps||void 0,y=p&&p.connectDragSource||void 0;return r.createElement(r.Fragment,null,r.createElement(v,{dragSourceKey:s,type:o,handlers:u,hookCallback:function(e){e.connectDragSource&&m({collectedProps:e.collectedProps,connectDragSource:e.connectDragSource})},barrier:a,showDefaultDragPreview:l}),r.createElement(d,n.__assign({dragSourceKey:s,collectedProps:g,connectDragSource:y},c),t))}});
define("Py",["require","exports","ww","r","r","b3","ra","ODBItemsScopeDeferred_mini_css","Uo"],function(e,t,n,r,i,s,o,u,a){"use strict";var f=u.LayoutMode_0;u=u.DragDropWrapper_0;Object.defineProperty(t,"__esModule",{value:!0});var l="DropTargetRelay",c="itemType",h="droptargetkey",p={canDrop:!1,isOver:!1,isOverCurrent:!1,didDrop:!1,itemType:void 0};function d(e){var t,i,s=e.children,d=e.collectedProps,v=e.connectDropTarget,m=e.layoutMode,g=void 0===m?"static":m,y=e.showDropTargetHint,b=void 0!==y&&y,w=e.showDragOverHint,E=void 0===w||w,S=e.dropTargetKey,x=d||p,T=x.canDrop,N=void 0!==T&&T,C=x.isOver,k=void 0!==C&&C,L=x.isOverCurrent,A=void 0!==L&&L,O=x.didDrop,M=void 0!==O&&O,_=x.itemType,D=void 0===_?void 0:_,P={isDroppable:N,isDropping:A,hasDropped:M,hasDropFinished:M},H=a.renderChildrenWithProps(s,P);return r.createElement("div",n.__assign({ref:v,"data-drop-target-key":S,"data-drop-item-type":D,"data-is-dropping":A},((t={})[h]=S,t[c]=D,t),{className:o.css(l,f.root,(i={},i[f.absolute]="absolute"===g,i[f.fullHeight]="full-height"===g,i[u.canDrop]=b&&N&&!k&&!A,i[u.dragOver]=E&&A&&N,i))}),H)}t.useConnectedDropTarget=d;var v=d,m=s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["TN"],t,n)})];case 1:return[2,t.sent().DropTargetHook]}})})});t.DropTargetRelay=function(e){var t=e.children,s=e.acceptType,o=e.dropTargetKey,u=e.handlers,a=e.showDropTargetHint,f=e.showDragOverHint,l=e.barrier,c=n.__rest(e,["children","acceptType","dropTargetKey","handlers","showDropTargetHint","showDragOverHint","barrier"]),h=i.useState(),p=h[0],d=h[1],g=p&&p.collectedProps||void 0,y=p&&p.connectDropTarget||void 0;return r.createElement(r.Fragment,null,r.createElement(m,{acceptType:s,dropTargetKey:o,handlers:u,hookCallback:function(e){e.connectDropTarget&&d({collectedProps:e.collectedProps,connectDropTarget:e.connectDropTarget})},barrier:l}),r.createElement(v,n.__assign({dropTargetKey:o,collectedProps:g,connectDropTarget:y,showDropTargetHint:a,showDragOverHint:f},c),t))}});
define("aW",["require","exports","ww","r","Hs","_W","iW","_k","Bs","xo","e3"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Uploader=function(e){var t=this,c=e.resolve,h=e.reject,p=e.entries,d=e.itemKey,v=e.onUploadStarted,m=e.onUploadCompleted,g=e.onUploadFailed,y=e.onItemQueued,b=e.onItemUploaded,w=e.onItemFailed,E=r.useState(!1),S=E[0],x=E[1],T=r.useState(!1),N=T[0],C=T[1],k=r.useState(),L=k[0],A=k[1],O=r.useState(!1),M=O[0],_=O[1],D=r.useRef(),P=D.current||(D.current=new i.CancelSource);r.useLayoutEffect(function(){return function(){P.dispose();D.current=void 0}},[]);var H=a.usePreviousValue(N),B=a.usePreviousValue(L),j=a.usePreviousValue(M),F=l.useItemCacheDispatch(),I=f.useEventHandler(function(e){v&&v(e)}),q=f.useEventHandler(function(e){m&&m(e)}),R=f.useEventHandler(function(e){g&&g(e)}),U=f.useEventHandler(function(e){y&&y(e)}),z=f.useEventHandler(function(e){b&&b(e)}),W=f.useEventHandler(function(e){w&&w(e)}),X=f.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:x(!0);n.label=1;case 1:n.trys.push([1,3,,4]);F(o.uploadProgressAddon);e=F(u.createEntryBatch({entries:p})).itemKey;return[4,F(s.uploadEntryBatch({parentItemKey:d,sourceEntryKey:e,callbacks:{onEntryBatchCreated:I,onEntryBatchFailed:R,onEntryBatchUploaded:q,onItemFailed:W,onItemUploaded:z,onItemQueued:U},cancelToken:P.token}))];case 2:n.sent();if(P.token.isCanceled())return[2];_(!0);return[3,4];case 3:t=n.sent();if(P.token.isCanceled())return[2];i.isCancel(t)?C(!0):A(t);return[3,4];case 4:return[2]}})})});r.useLayoutEffect(function(){M&&!j?c():L&&!B?h(L):N&&!H?h(new i.CancelError):S||X()},[S,N,L,M]);return null}});
define("LKe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TEMP={}});
define("kA",["require","exports","r","HA","Zm","MA"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WarningDialog=function(e){var t=e.title,o=e.prompt,u=e.cancelText,a=e.onCancel;return n.createElement(r.Dialog,{onDismiss:a,hidden:!1,title:t,maxWidth:e.maxWidth},n.createElement(s.Label,null,o),n.createElement(r.DialogFooter,null,n.createElement(i.PrimaryButton,{onClick:a,componentRef:function(e){e&&e.focus()}},u)))}});
define("Ky",["require","exports","Uo","Wv","Mc","Tc"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WizardAction=r.connectToItemCache(o("local"))(i.Action);t.BackgroundAction=r.connectToItemCache(o("global"))(i.Action);t.HeadlessAction=r.connectToItemCache(o("headless"))(i.Action);function o(e){return function(t,r){var i=r.children;return{onExecute:s.renderComponentOnExecute(function(e){return n.renderChildrenWithProps(i,e)},{scope:e})}}}});
define("NN",["require","exports","Ni","id"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dragLayerPreviewControl=new n.ControlFacet("dragLayerPreviewControl",{dragLayerPreviewRenderer:r.defaultRenderComponentOption()})});
define("aF",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shareLinkActionControl=new n.ControlFacet("getDefaultShareLinkActionControl")});
define("OWe",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemAutoRefreshControl=new n.ControlFacet("itemAutoRefreshControl")});
define("p6",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetNavCommandPropsControl=new n.ControlFacet("itemSetNavLinkPropsControl")});
define("h6",["require","exports","id","Ni","f6","m6"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetNavGroupControl=new r.ControlFacet("itemSetNavGroupControl",{groupHeaderRenderer:n.defaultRenderComponentOption({useItemCache:!0}),commandGroupControlHandler:r.childControlOption(s.itemSetNavGroupPropsControl),navLinkControlHandler:r.childControlOption(i.itemSetNavLinkControl)})});
define("m6",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetNavGroupPropsControl=new n.ControlFacet("itemSetNavCommandGroupControl")});
define("f6",["require","exports","Ni","id","p6"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetNavLinkControl=new n.ControlFacet("itemSetNavLinkControl",{linkAsRenderer:r.defaultRenderComponentOption(),navLinkRenderer:r.defaultRenderComponentOption({useItemCache:!0}),commandControlHandler:n.childControlOption(i.itemSetNavCommandPropsControl)})});
define("CC",["require","exports","Ni","id"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemTileFolderCoverControl=new n.ControlFacet("itemTileFolderCoverControl",{folderCoverAs:r.defaultRenderComponentOption()});t.itemTileControl=new n.ControlFacet("itemTileControl",{tileAs:r.defaultRenderComponentOption(),folderCoverControlHandler:n.childControlOption(t.itemTileFolderCoverControl)})});
define("JF",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsBreadcrumbControl=new n.ControlFacet("itemsBreadcrumbControl")});
define("ZU",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.permissionInviteActionControl=new n.ControlFacet("permissionInviteActionControl")});
define("dk",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.progressListGroupControl=new n.ControlFacet("progressListGroupControl",{});t.progressListControl=new n.ControlFacet("progressListControl",{groupControlHandler:n.childControlOption(t.progressListGroupControl)})});
define("SW",["require","exports","Ni","id"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.progressPanelControl=new n.ControlFacet("progressPanelControl",{panelAs:r.defaultRenderComponentOption()})});
define("$v",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressControl=new n.ControlFacet("uploadProgress")});
define("hk",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.entryBatchFacet=new n.Facet("entryBatch");t.sourceFileFacet=new n.Facet("sourceFile")});
define("ZB",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(t.AnalyticsLifeCycleStatus||(t.AnalyticsLifeCycleStatus={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(t.ConversationType||(t.ConversationType={}))});
define("DL",["require","exports","Gs","Xs"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.haveSameParentItem=function(e,t){var i=n.getItemKey(e,{itemKey:t.itemKey1}),s=n.getItemKey(e,{itemKey:t.itemKey2});return r.getPreferredItemKey(e,{itemKey:i})===r.getPreferredItemKey(e,{itemKey:s})}});
define("uk",["require","exports","ww","_k","fk","tC"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("hL",["require","exports","ww","r","K_","kb","G_","we","Z_","r0","ih","SL","i0","tc","Bc","yL","vL","Ms","Q1","qi","Es","Zv","ys","bL"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";var T,N;Object.defineProperty(t,"__esModule",{value:!0});var C=((T={})[l.ProgressPhase.started]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteStartedItemsTitle,f.default.deleteCompletedItemsTitleIntervals,t)||"",t)},T[l.ProgressPhase.completed]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteCompletedItemsTitle,f.default.deleteCompletedItemsTitleIntervals,t)||"",t)},T[l.ProgressPhase.failed]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsTitle,f.default.deleteFailedItemsTitleIntervals,t)||"",t)},T[l.ProgressPhase.canceled]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsTitle,f.default.deleteFailedItemsTitleIntervals,t)||"",t)},T),k=((N={})[l.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteStartedItemsDestinationTitle,f.default.deleteStartedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N[l.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteCompletedItemsDestinationTitle,f.default.deleteCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N[l.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsDestinationTitle,f.default.deleteFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N[l.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsDestinationTitle,f.default.deleteFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N);t.deleteProgressAddon=i.createAddon(function(){return function(e){e(s.registerControlHandler(h.deleteProgressKeyFacet,o.progressControl)(s.createControlHandler()(L)));e(i.registerOperationHandler(h.deleteProgressKeyFacet,v.retryProgressItemsOperation)(m.createRetryProgressItemsOperationHandler(h.deleteProgressKeyFacet,h.deleteItemsOperation)))}});function L(){return function(e){return A}}function A(e,t){var r,i,s,o=a.getOverallSimpleProgressBreakdown(e,t),u=o.phase,c=o.count,h=(function(e,t){var n=void 0,r=e.demandItemFacet(p.childItemsFacet,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(l.sourceItemFacet,o),a=u&&u.itemKey,f=e.demandItemFacet(d.parentFolderItemFacet,a),c=f&&f.itemKey;if(c)if(n){if(c!==n)break}else n=c}return n})(e,t),v=e.demandItemFacet(w.errorFacet,t.itemKey),m=E.getConfiguration(e,{enableOverrideDeleteFileLocks:S.enableOverrideDeleteFileLocksFacet}).enableOverrideDeleteFileLocks;v&&v instanceof g.ItemOperationError&&(r=b.unpack({fileLocked:y.fileLockedErrorFacet},v.facets));var T=[];if("group"===t.format&&h)i=k[u]({count:c,itemKey:h});else{i=C[u]({count:c});if(m&&u===l.ProgressPhase.failed&&r){s=f.default.fileLockedConfirmDeleteText;T.push(x.retryForceDeleteCommand)}}return n.__assign(n.__assign(n.__assign({},i&&"item"!==t.format?{title:i}:{}),s&&"summary"!==t.format?{description:s}:{}),{commands:T})}});
define("pk",["require","exports","ww","K_","kb","G_","Jx","Bc","Z_","mk","ih","tc","we"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";var p,d;Object.defineProperty(t,"__esModule",{value:!0});var v=((p={})[l.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveStartedItemsTitle,f.default.moveCompletedItemsTitleIntervals,e)||"",e)},p[l.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveCompletedItemsTitle,f.default.moveCompletedItemsTitleIntervals,e)||"",e)},p[l.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveFailedItemsTitle,f.default.moveFailedItemsTitleIntervals,e)||"",e)},p[l.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveFailedItemsTitle,f.default.moveFailedItemsTitleIntervals,e)||"",e)},p),m=((d={})[l.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyStartedItemsTitle,f.default.copyCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyCompletedItemsTitle,f.default.copyCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyFailedItemsTitle,f.default.copyFailedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyFailedItemsTitle,f.default.copyFailedItemsTitleIntervals,e)||"",e)},d);t.moveCopyProgressAddon=r.createAddon(function(){return function(e){e(i.registerControlHandler(o.moveCopyItemsProgressKeyFacet,s.progressControl)(i.createControlHandler()(g)))}});function g(){return function(e){return y}}function y(e,t){var r,i=t.itemKey;if("item"===t.format){(l=e.demandItemFacet(o.moveCopyItemsOperation,i))&&(r=e.demandItemFacet(u.displayNameFacet,i))}else{var s=e.demandItemFacet(c.childItemsFacet,i),f=s&&s.itemKeys;if(f&&f[0]){var l;if(l=e.demandItemFacet(o.moveCopyItemsOperation,f[0])){var h=l[Object.keys(l)[0]].isMove,p=a.getOverallSimpleProgressBreakdown(e,t),d=p.phase,g=p.count;r=h?v[d](g):m[d](g)}}}return n.__assign({},r?{title:r}:{})}});
define("fk",["require","exports","ww","Ms","Jx","mo","Z_","$_","ih","qi","tc","So","nm","Us","pk"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveCopyItems=s.createAsyncActionCreator(function(e){return function(t){return n.__awaiter(void 0,void 0,void 0,function(){var s,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F;return n.__generator(this,function(I){switch(I.label){case 0:s=[];t(d.moveCopyProgressAddon);for(v=0,m=Object.keys(e.items);v<m.length;v++){g=m[v];y=e.items[g];b=o.progressBatchKeyFacet.serializeNext();w=i.moveCopyItemsProgressKeyFacet.serializeBatchKey(b);E=[];S=new u.ItemResolver;for(x=0,T=Object.keys(y);x<T.length;x++){k=T[x];L=((D={})[k]=y[k],D);A=i.moveCopyItemsProgressKeyFacet.serializeTaskKey(b,k,L);S.resolveItems({items:(P={},P[A]=n.__assign(n.__assign(n.__assign(n.__assign({},a.sourceItemFacet.pack({itemKey:k})),a.destinationItemFacet.pack({itemKey:g})),f.pack({options:i.moveCopyItemsOperation},{options:L})),a.progressPhaseFacet.pack(a.ProgressPhase.created)),P)});E.push(A)}S.resolveItems({items:(H={},H[o.progressRootItemKey]=f.pack({childItems:l.childItemsFacet},{childItems:{itemKeys:new c.ArrayConcatIfNotMatchKeyPatch([w],function(e){return e})}}),H[w]=n.__assign(n.__assign({},f.pack({childItems:l.childItemsFacet},{childItems:{itemKeys:new c.ArrayConcatIfNotMatchKeyPatch(E,function(e){return e})}})),h.isGroupFacet.pack(!0)),H)});t(S.execute());for(N=0,C=Object.keys(y);N<C.length;N++){k=C[N];L=((B={})[k]=y[k],B);A=i.moveCopyItemsProgressKeyFacet.serializeTaskKey(b,k,L);O=t(r.startOperation({operationTypeFacet:i.moveCopyItemsOperation,items:(j={},j[g]=(F={},F[k]=n.__assign(n.__assign({},y[k]),{progressItemKey:A}),F),j)})),M=O.completed,_=O.items;t(o.trackItemProgress(n.__assign({progressItemKey:A,progressSize:1},_[g])));s.push(M)}}return[4,p.waitForAll(s)];case 1:I.sent();return[2]}})})}})});
define("Jx",["require","exports","ww","qi","Ms","Z_"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveCopyItemsOperation=new r.Facet("moveCopyItems");t.moveCopyItemsProgressKeyFacet=new s.ProgressKeyFacet("moveCopyItems");var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(i.ItemOperationError);t.MoveCopyItemOperationError=o});
define("nk",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelProgressItemsOperation=new n.Facet("cancelProgressItemsOperation");t.cancelProgressItems=r.implementOperation({operationTypeFacet:t.cancelProgressItemsOperation})});
define("rW",["require","exports","ww","K_","cc","$_","ih","qi","Es","So","tc"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createCancelProgressItemsOperationHandler=function(e){return r.createBatchedItemsOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,c,h;return n.__generator(this,function(p){t=r(i.readItems(function(t){var r=new s.ItemResolver,i=[];function c(e){var s,h=t.demandItemFacet(o.cancelSourceFacet,e);h&&i.push(h);r.resolveItems({items:(s={},s[e]=n.__assign(n.__assign({},h?{}:n.__assign({},o.progressPhaseFacet.pack(o.ProgressPhase.canceled))),u.pack({error:a.errorFacet},{error:new f.Delete})),s)});var p=t.demandItemFacet(l.childItemsFacet,e);if(p)for(var d=0,v=p.itemKeys;d<v.length;d++){c(v[d])}}for(var h in e.items)Object.prototype.hasOwnProperty.call(e.items,h)&&c(h);return{itemResolver:r,sourcesToCancel:i}}));r(t.itemResolver.execute());for(c=0,h=t.sourcesToCancel;c<h.length;c++)h[c].cancel();return[2]})})}})}});
define("vL",["require","exports","ww","Ms","K_","cc","$_","qi","Es","So","ih","Z_","tc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createRetryProgressItemsOperationHandler=function(e,t){return i.createBatchedItemsOperationHandler()(function(e){var i=this;return function(p){return n.__awaiter(i,void 0,void 0,function(){var i,d,v,m,g,y,b,w,E,S,x;return n.__generator(this,function(T){switch(T.label){case 0:i=p(s.readItems(function(r){var i={operationTypeFacet:t,items:{}},s=new o.ItemResolver;function p(e){var o,d=r.demandItemFacet(l.sourceItemFacet,e),v=d&&d.itemKey,m=r.demandItemFacet(t,e),g=c.getOverallSimpleProgressBreakdown(r,{itemKey:e}).phase;if(v&&m&&"failed"===g){i.items[v]=n.__assign(n.__assign({},m),{progressItemKey:e});s.resolveItems({items:(o={},o[e]=n.__assign({},u.pack({error:a.errorFacet},{error:new f.Delete})),o)})}var y=r.demandItemFacet(h.childItemsFacet,e);if(y)for(var b=0,w=y.itemKeys;b<w.length;b++){p(w[b])}}for(var d=0,v=Object.keys(e.items);d<v.length;d++){p(v[d])}return{itemResolver:s,operationPayload:i}}));p(i.itemResolver.execute());d=p(r.startOperation(i.operationPayload)),v=d.completed,m=d.items;for(g=0,y=Object.keys(m);g<y.length;g++){b=y[g];w=m[b],E=w.started,S=w.completed;(x=i.operationPayload.items[b].progressItemKey)&&p(c.trackItemProgress({progressItemKey:x,started:E,completed:S}))}return[4,v];case 1:T.sent();return[2]}})})}})}});
define("cW",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resolveProgressItemsOperation=new n.Facet("resolveProgressItemsOperation");t.resolveProgressItems=r.implementOperation({operationTypeFacet:t.resolveProgressItemsOperation})});
define("yL",["require","exports","qi","Ms"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryProgressItemsOperation=new n.Facet("retryProgressItemsOperation");t.retryProgressItems=r.implementOperation({operationTypeFacet:t.retryProgressItemsOperation})});
define("wA",["require","exports","ww","K_","kb","G_","we","Z_","EA","ih","f0"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var h=((c={})[f.ProgressPhase.started]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameStartedItemsTitle,a.default.renameCompletedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.completed]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameCompletedItemsTitle,a.default.renameCompletedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.failed]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameFailedItemsTitle,a.default.renameFailedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.canceled]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameFailedItemsTitle,a.default.renameFailedItemsTitleIntervals,e)||"",e)},c);t.renameProgressAddon=r.createAddon(function(){return function(e){e(i.registerControlHandler(l.renameProgressKeyFacet,s.progressControl)(i.createControlHandler()(p)))}});function p(){return function(e){return d}}function d(e,t){var r=u.getOverallSimpleProgressBreakdown(e,t),i=r.phase,s=r.count,o=h[i](s);return n.__assign({},o&&"item"!==t.format?{title:o}:{})}});
define("_k",["require","exports","ww","p3","jo","l3","i0","Ji","Mo","qi","K_","tc","Bc","cc","$_","aS","hk","rm","is","po"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=y.asOnceOnly(function(e){var t,n=[];return function(r){var i=new b.Signal,s=i.resolve,o=i.promise;n.push({resolve:s,itemResolver:r});t||(t=setTimeout(function(){(function(){var r=n;n=[];t=void 0;var i=[];e(g.asBatch(function(){for(var t=0,n=r;t<n.length;t++){var s=n[t],o=s.resolve,u=s.itemResolver;i.push(o);e(u.execute())}}));for(var s=0,o=i;s<o.length;s++){(0,o[s])()}})()},500));return o}}),E=new a.AutoKeyFacet("batch");var S=new u.KeyFacet("batchChildren",{batch:u.subKeyPart(E)}),x=new u.KeyFacet("fileEntry",{batch:u.subKeyPart(E),index:u.numberPart(),path:u.stringPart()}),T=new u.KeyFacet("fileEntryChildren",{fileEntry:u.subKeyPart(x)}),N=new u.KeyFacet("fileEntryDirectoryPage",{fileEntryChildren:u.subKeyPart(T),startIndex:u.numberPart()}),C=new f.Facet("entry"),k=new f.Facet("rootEntries"),L=new f.Facet("directoryPage");t.fileEntryAddon=l.createAddon(function(){return function(e){e(g.asBatch(function(){e(i.supportFacets({keyFacet:E,facets:[c.defaultChildItemSetFacet]}));e(i.supportFacets({keyFacet:S,facets:[c.childItemsFacet]}));e(i.supportFacets({keyFacet:x,facets:[h.displayNameFacet,c.defaultChildItemSetFacet,m.sourceFileFacet,h.fileSizeFacet,h.fileNameFacet,h.folderFacet,h.parentFolderItemFacet,h.dateModifiedFacet]}));e(i.supportFacets({keyFacet:T,facets:[c.childItemsFacet]}));e(i.supportFacets({keyFacet:N,facets:[c.childItemsFacet]}));e(l.registerOperationHandler(E,r.getItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:8})(A)));e(l.registerOperationHandler(S,r.getItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:8})(O)));e(l.registerOperationHandler(x,r.getItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:128})(M)));e(l.registerOperationHandler(T,r.getItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:32})(_)));e(l.registerOperationHandler(N,r.getItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:32})(D)));e(l.registerOperationHandler(E,o.deleteItemsOperation)(l.createSingleItemOperationHandler({maxParallelOperationCount:8})(P)))}))}});t.createEntryBatch=function(e){return function(r){var i;r(t.fileEntryAddon);var s=E.serializeNext(),o=new d.ItemResolver;o.resolveItems({items:(i={},i[s]=n.__assign(n.__assign({},m.entryBatchFacet.pack({})),k.pack(e.entries)),i)});r(o.execute());return{itemKey:s}}};function A(e){var t=this,r=e.itemKey,i=E.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s;return n.__generator(this,function(o){switch(o.label){case 0:if(!e(p.readItems(function(e){return e.demandItemFacet(k,r)})))return[3,2];(t=new d.ItemResolver).resolveItems({items:(s={},s[r]=n.__assign(n.__assign({},m.entryBatchFacet.pack({})),c.defaultChildItemSetFacet.pack({itemKey:S.serialize({batch:i})})),s)});return[4,e(w)(t)];case 1:o.sent();o.label=2;case 2:return[2]}})})}}function O(e){var t=this,r=e.itemKey,i=S.deserialize(r).batch,s=E.serialize(i);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,u,a,f,l,h,v,m,g;return n.__generator(this,function(y){switch(y.label){case 0:if(!(t=e(p.readItems(function(e){return e.demandItemFacet(k,s)}))))return[3,2];o=new d.ItemResolver;u=[];a=0;for(f=0,l=t;f<l.length;f++){h=l[f];v=x.serialize({batch:i,index:a,path:h.name});o.resolveItems({items:(m={},m[v]=n.__assign({},C.pack(h)),m)});u.push(v);a++}o.resolveItems({items:(g={},g[r]=n.__assign({},c.childItemsFacet.pack({itemKeys:u})),g)});return[4,e(w)(o)];case 1:y.sent();y.label=2;case 2:return[2]}})})}}function M(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,o,u;return n.__generator(this,function(a){switch(a.label){case 0:if(!(t=e(p.readItems(function(e){return e.demandItemFacet(C,r)}))))return[2];(i=new d.ItemResolver).resolveItems({items:(o={},o[r]=n.__assign(n.__assign(n.__assign({},h.displayNameFacet.pack(t.name)),2===t.type?n.__assign(n.__assign(n.__assign({},h.folderFacet.pack({})),h.fileNameFacet.pack({name:t.name,extension:""})),c.defaultChildItemSetFacet.pack({itemKey:T.serialize({fileEntry:x.deserialize(r)})})):n.__assign(n.__assign({},c.defaultChildItemSetFacet.pack(void 0)),h.folderFacet.pack(void 0))),1===t.type?n.__assign({},h.fileNameFacet.pack(H(t.name))):{}),o)});return 1!==t.type&&0!==t.type?[3,2]:[4,t.getFile()];case 1:s=a.sent();i.resolveItems({items:(u={},u[r]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},h.fileNameFacet.pack(H(s.name))),h.folderFacet.pack(void 0)),h.fileSizeFacet.pack(s.size)),h.dateModifiedFacet.pack(s.lastModified)),m.sourceFileFacet.pack(s)),u)});a.label=2;case 2:return[4,e(w)(i)];case 3:a.sent();return[2]}})})}}function _(e){var t=this,r=e.itemKey,i=T.deserialize(r),s=i.fileEntry,o=x.serialize(s);return function(e){return n.__awaiter(t,void 0,void 0,function(){function t(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,i,u,c,p;return n.__generator(this,function(d){switch(d.label){case 0:e=a.entries,t=a.getEntries;for(r=0,i=e;r<i.length;r++){u=i[r];c=x.serialize(n.__assign(n.__assign({},s),{index:l,path:s.path+"/"+u.name}));m.resolveItems({items:(p={},p[c]=n.__assign(n.__assign({},C.pack(u)),h.parentFolderItemFacet.pack({itemKey:o})),p)});f.push(c);l++}return t?[4,t()]:[3,2];case 1:a=d.sent();d.label=2;case 2:return[2,!!t]}})})}var u,a,f,l,m,g,y,b,E;return n.__generator(this,function(h){switch(h.label){case 0:return(u=e(p.readItems(function(e){return e.demandItemFacet(C,x.serialize(s))})))&&2===u.type?[4,u.getEntries()]:[2];case 1:a=h.sent();f=[];l=0;m=new d.ItemResolver;return[4,t()];case 2:return(g=h.sent())?[4,t()]:[3,4];case 3:g=h.sent();h.label=4;case 4:if(g){y=N.serialize({fileEntryChildren:i,startIndex:l});m.merge(v.resolveNewPage({itemKey:y}).itemResolver);m.resolveItems({items:(b={},b[y]=n.__assign({},L.pack(a)),b)});f.push(y)}m.resolveItems({items:(E={},E[r]=n.__assign(n.__assign({},c.childItemsFacet.pack({itemKeys:f})),c.parentItemFacet.pack({itemKey:o})),E)});return[4,e(w)(m)];case 5:h.sent();return[2]}})})}}function D(e){var t=this,r=e.itemKey,i=N.deserialize(r),s=i.fileEntryChildren,o=i.startIndex,u=s.fileEntry,a=x.serialize(u);return function(e){return n.__awaiter(t,void 0,void 0,function(){function t(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,i,s,o,p;return n.__generator(this,function(d){switch(d.label){case 0:e=f.entries,t=f.getEntries;for(r=0,i=e;r<i.length;r++){s=i[r];o=x.serialize(n.__assign(n.__assign({},u),{index:l,path:u.path+"/"+s.name}));m.resolveItems({items:(p={},p[o]=n.__assign(n.__assign({},C.pack(s)),h.parentFolderItemFacet.pack({itemKey:a})),p)});c.push(o);l++}return t?[4,t()]:[3,2];case 1:f=d.sent();d.label=2;case 2:return[2,!!t]}})})}var i,f,l,c,m,g,y,b;return n.__generator(this,function(u){switch(u.label){case 0:return(i=e(p.readItems(function(e){return e.demandItemFacet(L,r)})))&&i.getEntries?[4,i.getEntries()]:[2];case 1:f=u.sent();l=o;c=[];m=new d.ItemResolver;return[4,t()];case 2:return(g=u.sent())?[4,t()]:[3,4];case 3:g=u.sent();u.label=4;case 4:if(g){y=N.serialize({fileEntryChildren:s,startIndex:l});m.merge(v.resolveNewPage({itemKey:y}).itemResolver);m.resolveItems({items:(b={},b[y]=n.__assign({},L.pack(f)),b)});c.push(y)}m.merge(v.resolveExistingPage({itemKey:r,itemSetKey:T.serialize(s),childItemKeys:c}).itemResolver);return[4,e(w)(m)];case 5:u.sent();return[2]}})})}}function P(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){e(s.clearItems({items:e(p.readItems(function(e){for(var t,n={},i=[r];t=i.pop();){n[t]=!0;var s=e.demandItemFacet(c.defaultChildItemSetFacet,t),o=s&&s.itemKey;o&&(n[o]=!0);var u=e.demandItemFacet(c.childItemsFacet,o),a=u&&u.itemKeys;a&&i.push.apply(i,a)}return n}))}));return[2]})})}}function H(e){var t=e.lastIndexOf(".");return t>-1?{name:e.slice(0,t),extension:e.slice(t)}:{name:e,extension:""}}});
define("oW",["require","exports","ww","ih","tc","Bc","cs","hk"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadStatsProgressFacet=new o.ComputedItemFacet("uploadStats",function(e,n){var o,c={file:a(),folder:a(),extensions:{}},h=e.demandItemFacet(i.childItemsFacet,n.itemKey);if(h)for(var p=0,d=h.itemKeys;p<d.length;p++){var v=d[p],m=e.demandItemFacet(t.uploadStatsProgressFacet,v);if(m){f(c.file,m.file);f(c.folder,m.folder);l(c.extensions,m.extensions)}}var g=e.demandItemFacet(r.sourceItemFacet,n.itemKey),y=g&&g.itemKey;if(y){var b=e.demandItemFacet(s.folderFacet,y),w=e.demandItemFacet(r.progressPhaseFacet,n.itemKey),E=r.getSimpleProgessPhase(w||r.ProgressPhase.expired),S=r.getItemCountsBySimpleProgressPhase(E);if(e.demandItemFacet(u.entryBatchFacet,y));else if(b)f(c.folder,S);else{f(c.file,S);var x=e.demandItemFacet(s.fileNameFacet,y),T=x&&x.extension||"unknown";l(c.extensions,((o={})[T]=S,o))}}return c});t.overallUploadProgressSizeFacet=new o.ComputedItemFacet("overallUploadProgressSize",function(e,n){var o=e.demandItemFacet(r.progressSizeFacet,n.itemKey);if(o)return o;var u=e.demandItemFacet(i.childItemsFacet,n.itemKey);if(u){for(var a={total:0,current:0},f=0,l=u.itemKeys;f<l.length;f++){var c=l[f],h=e.demandItemFacet(t.overallUploadProgressSizeFacet,c);if(!h)return;a.total+=h.total;a.current+=h.current}return a}var p=e.demandItemFacet(r.sourceItemFacet,n.itemKey);if(p){var d=e.demandItemFacet(s.fileSizeFacet,p.itemKey);if("number"!=typeof d)return;return{total:d,current:e.demandItemFacet(r.createdItemFacet,n.itemKey)?d:0}}});function a(e){var t={started:0,completed:0,canceled:0,failed:0};if(e){t.started+=e.started;t.completed+=e.completed;t.failed+=e.failed;t.canceled+=e.canceled}return t}function f(e,t){e.started+=t.started;e.completed+=t.completed;e.failed+=t.failed;e.canceled+=t.canceled}function l(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var s=i[r],o=t[s];s in e?f(e[s],o):e[s]=n.__assign({},o)}}});
define("iW",["require","exports","ww","r","K_","Ms","kb","G_","we","mW","qg","Mm","Z_","ih","Bc","hk","cc","SL","nk","fW","yL","uW","dW","cW","qi","Q1","Es","hM","_W","sW","ys","Zv","oW","rW","$v"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P){"use strict";var H,B;Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressKeyFacet=k.uploadProgressKeyFacet;t.getUploadProgressKey=k.getUploadProgressKey;var j=((H={})[p.ProgressPhase.started]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadStartedItemsTitle,f.default.uploadCompletedItemsTitleIntervals,t)||"",t)},H[p.ProgressPhase.completed]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadCompletedItemsTitle,f.default.uploadCompletedItemsTitleIntervals,t)||"",t)},H[p.ProgressPhase.failed]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsTitle,f.default.uploadFailedItemsTitleIntervals,t)||"",t)},H[p.ProgressPhase.canceled]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsTitle,f.default.uploadFailedItemsTitleIntervals,t)||"",t)},H),F=((B={})[p.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadStartedItemsDestinationTitle,f.default.uploadCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(g.ItemLink,{key:"link",itemKey:n}))},B[p.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadCompletedItemsDestinationTitle,f.default.uploadCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(g.ItemLink,{key:"link",itemKey:n}))},B[p.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsDestinationTitle,f.default.uploadFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(g.ItemLink,{key:"link",itemKey:n}))},B[p.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsDestinationTitle,f.default.uploadFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(g.ItemLink,{key:"link",itemKey:n}))},B);t.uploadProgressAddon=i.createAddon(function(){return function(e){e(o.registerControlHandler(k.uploadProgressKeyFacet,u.progressControl)(o.createControlHandler()(I)));e(i.registerOperationHandler(k.uploadProgressKeyFacet,y.cancelProgressItemsOperation)(D.createCancelProgressItemsOperationHandler(k.uploadProgressKeyFacet)));e(i.registerOperationHandler(k.uploadProgressKeyFacet,w.retryProgressItemsOperation)(i.createSingleItemOperationHandler()(R)));e(i.registerOperationHandler(k.uploadProgressKeyFacet,x.resolveProgressItemsOperation)(i.createSingleItemOperationHandler()(U)))}});function I(){return function(e){return q}}function q(e,t){var r,i=e.demandItemFacet(p.sourceItemFacet,t.itemKey),o=e.demandItemFacet(v.entryBatchFacet,i&&i.itemKey);r=i&&!o?(function(e,t){var r,i=M.getConfiguration(e,{enableNewConflictUploadErrorStrings:O.enableNewConflictUploadErrorStringsConfigurationFacet}).enableNewConflictUploadErrorStrings,o=e.demandItemFacet(_.overallUploadProgressSizeFacet,t.itemKey),u=o?o.total>0?o.current/o.total:1:void 0,a=h.getOverallProgressPhase(e,t),v=e.demandItemFacet(d.folderFacet,t.sourceItemKey);a===p.ProgressPhase.completed&&o?r=c.default.getDisplayString(o.total):v?a!==p.ProgressPhase.created&&a!==p.ProgressPhase.started||(r=z(o)||l.default.genericStartedIndeterminateDescription):a===p.ProgressPhase.started?r=z(o):a===p.ProgressPhase.created&&(r=l.default.genericCreatedDescription);var m,g=e.demandItemFacet(C.errorFacet,t.itemKey),y=[];if(g)if(g instanceof s.ItemOperationError){var w=T.unpack({conflict:N.conflictErrorFacet,retry:N.retryErrorFacet,offline:N.offlineErrorFacet,accessDenied:N.accessDeniedErrorFacet,invalidName:N.invalidNameErrorFacet,emptyFolder:N.emptyFolderUnsupportedFacet,overQuota:N.overQuotaErrorFacet,lockMismatch:N.lockMismatchErrorFacet,authFailure:N.authFailureErrorFacet,folderUpload:N.folderUploadUnsupportedFacet,targetFolder:N.targetFolderErrorFacet,malware:N.malwareErrorFacet,throttle:N.throttleErrorFacet},g.facets),x=w.conflict,k=w.retry,L=w.offline,D=w.accessDenied,P=w.invalidName,H=w.emptyFolder,B=w.overQuota,j=w.lockMismatch,F=w.authFailure,I=w.folderUpload,q=w.targetFolder,R=w.malware,U=w.throttle;if(x){r=i?f.default.newConflictUploadWithoutRenameErrorText:f.default.conflictUploadWithoutRenameErrorText;y.push(i?E.addNewVersionProgressCommand:E.replaceProgressCommand);if(x.supportsRename){r=i?f.default.newConflictUploadErrorText:f.default.conflictUploadErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"conflict+rename"});y.push(S.renameProgressCommand)}else m=A.uploadProgressErrorKeyFacet.serialize({type:"conflict"})}else if(D){r=f.default.accessDeniedUploadErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"accessDenied"})}else if(P){r=f.default.invalidNameUploadErrorText;y.push(S.renameProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"invalidName"})}else if(H||I){r=f.default.folderUploadNotSupported;m=A.uploadProgressErrorKeyFacet.serialize({type:"folderUpload"})}else if(B){r=f.default.overQuotaSharedFolderUploadErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"overQuota"})}else if(j){r=f.default.lockMismatchUploadErrorText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"lockMismatch"})}else if(F){r=f.default.authFailureUploadErrorText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"authFailure"})}else if(q){r=f.default.targetFolderMissingUploadErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"targetFolder"})}else if(R){r=f.default.malwareDetectedUploadErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"malware"})}else if(U){r=f.default.throttledUploadErrorText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"throttle"})}else if(L){r=f.default.disconnectedUploadText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"offline"})}else if(!k){r=g.message||f.default.generalUploadNoRetryErrorText;m=A.uploadProgressErrorKeyFacet.serialize({type:"noRetry"})}if(k){r=f.default.generalUploadErrorText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"retry"})}}else{r=g.message||f.default.generalUploadErrorText;y.push(b.retryProgressCommand);m=A.uploadProgressErrorKeyFacet.serialize({type:"unknown"})}return n.__assign(n.__assign(n.__assign({percentComplete:u},m?{errorKey:m}:{}),r?{description:r}:{}),{commands:y})})(e,{itemKey:t.itemKey,sourceItemKey:i.itemKey}):(function(e,t){var r,i,s=e.demandItemFacet(_.overallUploadProgressSizeFacet,t.itemKey),o=s?s.total>0?s.current/s.total:1:void 0,u=e.demandItemFacet(p.destinationItemFacet,t.itemKey),a=u&&u.itemKey,f=h.getOverallSimpleProgressBreakdown(e,t),d=f.phase,v=f.count;d===p.ProgressPhase.completed&&s?r=c.default.getDisplayString(s.total):d===p.ProgressPhase.started&&(r=z(s)||l.default.genericStartedIndeterminateDescription);i="group"===t.format&&a?F[d]({count:v,itemKey:a}):j[d]({count:v});return n.__assign(n.__assign(n.__assign({},i&&"item"!==t.format?{title:i}:{}),r?{description:r}:{}),{percentComplete:o})})(e,t);var u=e.demandItemFacet(P.uploadProgressControl,t.itemKey),a=P.uploadProgressControl.evaluate(u)(e,{itemKey:t.itemKey,commands:r.commands,description:r.description}),m=a.description,g=a.commands,y=void 0===g?[]:g;return n.__assign(n.__assign(n.__assign({},r),{commands:y}),m?{description:m}:{})}function R(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,o,u;return n.__generator(this,function(n){switch(n.label){case 0:t=e(m.readItems(function(e){return{sourceItem:e.demandItemFacet(p.sourceItemFacet,r),destinationItem:e.demandItemFacet(p.destinationItemFacet,r)}})),i=t.sourceItem,s=t.destinationItem;o=i&&i.itemKey;u=s&&s.itemKey;if(!o)throw new Error("No source entry to retry.");if(!u)throw new Error("No parent item to retry.");return[4,e(L.uploadEntryBatch({sourceEntryKey:o,parentItemKey:u}))];case 1:n.sent();return[2]}})})}}function U(e){var t=this,r=e.itemKey,i=e.options;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,o,u,a;return n.__generator(this,function(n){switch(n.label){case 0:t=e(m.readItems(function(e){return{sourceItem:e.demandItemFacet(p.sourceItemFacet,r),destinationItem:e.demandItemFacet(p.destinationItemFacet,r)}})),s=t.sourceItem,o=t.destinationItem;u=s&&s.itemKey;a=o&&o.itemKey;if(!u)throw new Error("No source entry to retry.");if(!a)throw new Error("No parent item to retry.");return[4,e(L.uploadEntryBatch({sourceEntryKey:u,parentItemKey:a,options:i}))];case 1:n.sent();return[2]}})})}}function z(e){return e&&e.total>0?a.format(l.default.genericStartedByteProgressDescription,c.default.getDisplayString(e.current),c.default.getDisplayString(e.total)):void 0}});
define("sW",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressErrorKeyFacet=new n.KeyFacet("uploadProgress",{type:n.stringPart()})});
define("hM",["require","exports","Ji"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressKeyFacet=new n.KeyFacet("uploadProgress",{sourceEntryKey:n.stringPart()});t.getUploadProgressKey=function(e){return t.uploadProgressKeyFacet.serialize({sourceEntryKey:e})}});
define("_W",["require","exports","ww","tC","aC","tc","mo","Bc","D8","x8","ih","Ms","Z_","p3","So","qi","nm","Hs","Us","cc","hk","Es","hM","bs","W_","oW","Lc","Pc","pb","$_"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var O=0;var M=function(){},_={onItemQueued:M,onItemUploaded:M,onItemFailed:M,onEntryBatchCreated:M,onEntryBatchUploaded:M,onEntryBatchFailed:M};t.uploadEntryBatch=function e(t){var r=this,i=t.parentItemKey,s=t.sourceEntryKey,o=t.callbacks,u=void 0===o?_:o,a=t.options,f=void 0===a?{}:a;return function(o){return n.__awaiter(r,void 0,void 0,function(){var r,a,l,c,p,d;return n.__generator(this,function(n){switch(n.label){case 0:o(h.progressAddon);r=++O;a={operation:e};o(x.registerItemDemands({owner:a,items:(d={},d[s]={},d)}));l=new g.CancelSource;t.cancelToken&&t.cancelToken.subscribe(l.cancel);return[4,o(H({sourceEntryKey:s}))];case 1:c=n.sent();return[4,o(c({parentItemKey:i,cancelToken:l.token,callbacks:u,options:f,uploadId:r}))];case 2:p=n.sent().completed;n.label=3;case 3:n.trys.push([3,,5,6]);return[4,p];case 4:n.sent();return[3,6];case 5:l.dispose();o(x.removeItemDemands({owner:a}));return[7];case 6:return[2]}})})}};function D(e){var t=this,r=e.sourceEntryKey,i=e.cancelToken,o=e.onReceiveChildUploader,u=S.getUploadProgressKey(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,f,l=this;return n.__generator(this,function(c){switch(c.label){case 0:t={operation:D};e(x.registerItemDemands({owner:t,items:(a={},a[u]={},a)}));c.label=1;case 1:c.trys.push([1,,3,4]);e(p.resolveItems({items:(f={},f[u]=n.__assign({},s.childItemsFacet.pack({itemKeys:[]})),f)}));return[4,e(P({itemKey:r,cancelToken:i,onReceiveChildKeys:function(t){return n.__awaiter(l,void 0,void 0,function(){var r,a,f,l,c,h,p=this;return n.__generator(this,function(m){switch(m.label){case 0:i.throwIfCanceled();r=new A.ItemResolver;for(a=0,f=t;a<f.length;a++){l=f[a];c=S.getUploadProgressKey(l);r.resolveItems({items:(h={},h[c]=n.__assign({},s.parentItemFacet.pack({itemKey:u})),h[u]=v.pack({childItems:s.childItemsFacet},{childItems:{itemKeys:new d.ArrayConcatIfNotMatchKeyPatch([c],function(e){return e})}}),h)})}e(r.execute());return[4,y.waitForAll(t.map(function(t){return n.__awaiter(p,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:r=o;return[4,e(H({sourceEntryKey:t}))];case 1:r.apply(void 0,[n.sent()]);return[2]}})})}))];case 1:m.sent();return[2]}})})}}))];case 2:c.sent();return[3,4];case 3:e(x.removeItemDemands({owner:t}));return[7];case 4:return[2]}})})}}function P(e){var t=this,o=e.itemKey,u=e.cancelToken,a=e.onReceiveChildKeys;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,l=this;return n.__generator(this,function(c){switch(c.label){case 0:t={};return[4,e(r.demandItems(function(e){var t=e.demandItemFacet(s.defaultChildItemSetFacet,o);return t&&t.itemKey}))];case 1:return(f=c.sent())?[4,e(i.observeItemsUntilResolved(function(e){u&&u.throwIfCanceled();var t=e.demandItemFacet(s.childItemsFacet,f),n=[];if(t)for(var r=0,i=t.itemKeys;r<i.length;r++){var o=i[r];e.isItemFacetResolved(s.pageFacet,o)?e.demandItemFacet(s.childItemsFacet,o):n.push(o)}return n},function(e){return n.__awaiter(l,void 0,void 0,function(){var r,i,s,o;return n.__generator(this,function(n){switch(n.label){case 0:r=[];for(i=0,s=e;i<s.length;i++)if(!((o=s[i])in t)){r.push(o);t[o]=!0}return[4,a(r)];case 1:n.sent();return[2]}})})}))]:[2];case 2:c.sent();return[2]}})})}}function H(e){var t=this,i=e.sourceEntryKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(r.demandItems(function(e){return e.demandItemFacet(w.entryBatchFacet,i)}))];case 1:return t.sent()?[2,B(i)]:[4,e(r.demandItems(function(e){return e.demandItemFacet(u.folderFacet,i)}))];case 2:return t.sent()?[2,j(i)]:[2,F(i)]}})})}}function B(e){var t=this;return o.createAsyncActionCreator(function(r){var i=r.parentItemKey,o=r.callbacks,u=r.options,a=r.uploadId,f=S.getUploadProgressKey(e);return function(c){var b,w,E=new g.CancelSource;r.cancelToken.subscribe(E.cancel);var S={operation:B};c(x.registerItemDemands({owner:{},items:(b={},b[f]={},b)}));c(p.resolveItems({items:(w={},w[h.progressRootItemKey]=v.pack({childItems:s.childItemsFacet},{childItems:{itemKeys:new d.ArrayConcatIfNotMatchKeyPatch([f],function(e){return e})}}),w[f]=n.__assign(n.__assign(n.__assign(n.__assign({},m.isGroupFacet.pack(!0)),l.cancelSourceFacet.pack(E)),l.sourceItemFacet.pack({itemKey:e})),l.destinationItemFacet.pack({itemKey:i})),w)}));var T=n.__awaiter(t,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:t=[];r=[];return[4,c(D({sourceEntryKey:e,cancelToken:E.token,onReceiveChildUploader:function(e){E.token.throwIfCanceled();var n=c(e({parentItemKey:i,cancelToken:E.token,callbacks:o,options:u,uploadId:a})),s=n.started,f=n.completed;t.push(s);r.push(f)}}))];case 1:n.sent();return[2,{startedWork:t,completedWork:r}]}})}),N=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:t=(e=Promise).race;return[4,T];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:n.sent();return[2]}})}),C=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=y.waitForAll;return[4,T];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:t.sent();return[2]}})}),k=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e=c(I({uploadProgressKey:f,uploadId:a,qosName:"Uploader.uploadBatch"}));o.onEntryBatchCreated({progressItemKey:f});n.label=1;case 1:n.trys.push([1,,3,4]);return[4,c(h.trackItemProgress({progressItemKey:f,started:N,completed:C,onStarted:function(e){},onCompleted:function(t){o.onEntryBatchUploaded({progressItemKey:f});c(e({error:t.error}))},onFailed:function(t){o.onEntryBatchFailed({error:t.error||new Error("No error reported from batch upload."),progressItemKey:f});c(e({error:t.error}))}}))];case 2:n.sent();return[3,4];case 3:c(p.resolveItems({items:(t={},t[f]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),t)}));c(x.removeItemDemands({owner:S}));return[7];case 4:return[2]}})});return{started:N,completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y.waitForAll([C,k])];case 1:e.sent();return[2]}})})}}})}function j(e){var t=this;return o.createAsyncActionCreator(function(i){var s=i.parentItemKey,o=i.callbacks,a=i.options,w=i.uploadId,T=S.getUploadProgressKey(e);return function(N){var C,k,L=new g.CancelSource;i.cancelToken.subscribe(L.cancel);var O={operation:j};N(x.registerItemDemands({owner:O,items:(C={},C[T]={},C[e]={},C)}));N(p.resolveItems({items:(k={},k[T]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},E.errorFacet.pack(void 0)),l.progressPhaseFacet.pack(l.ProgressPhase.created)),m.isGroupFacet.pack(!0)),l.destinationItemFacet.pack({itemKey:s})),l.sourceItemFacet.pack({itemKey:e})),l.cancelSourceFacet.pack(L)),k)}));var M=N((function(e){var t=this;return function(i){var s=e.sourceEntryKey,o=e.parentItemKey,a=e.cancelToken,h=S.getUploadProgressKey(s),d=n.__awaiter(t,void 0,void 0,function(){var e,t,d,v,m,g,y,w,E,S=this;return n.__generator(this,function(x){switch(x.label){case 0:return[4,i(r.demandItems(function(e){return e.demandItemFacet(u.fileNameFacet,s)}))];case 1:if(!(e=x.sent()))throw new Error("Invalid folder name.");t={folders:(y={},y[e.name]={progressItemKey:h},y)};i(p.resolveItems({items:(w={},w[h]=n.__assign({},f.createFolderOperation.pack(t)),w)}));d=i(c.startOperation({operationTypeFacet:f.createFolderOperation,items:(E={},E[o]=t,E)})),v=d.started,m=d.completed;g=a.subscribe(function(){var e;i(c.cancelOperation({operationTypeFacet:f.createFolderOperation,items:(e={},e[o]=t,e)}))});n.__awaiter(S,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,v];case 1:e.sent();g();return[2]}})});return[2,{started:v,itemCreated:n.__awaiter(S,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,m];case 1:n.sent();e=i(b.readItems(function(e){return e.demandItemFacet(l.createdItemFacet,h)}));if(!(t=e&&e.itemKey))throw new Error("No folder created.");return[2,t]}})})}]}})});return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,d];case 1:return[4,e.sent().started];case 2:e.sent();return[2]}})}),itemCreated:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,d];case 1:return[4,e.sent().itemCreated];case 2:return[2,e.sent()]}})})}}})({sourceEntryKey:e,parentItemKey:s,cancelToken:L.token})),_=M.started,P=M.itemCreated,H=n.__awaiter(t,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,P];case 1:t=n.sent();r=[_];i=[];return[4,N(D({sourceEntryKey:e,cancelToken:L.token,onReceiveChildUploader:function(e){var n=N(e({parentItemKey:t,cancelToken:L.token,callbacks:o,options:a,uploadId:w})),s=n.started,u=n.completed;r.push(s);i.push(u)}}))];case 2:n.sent();return[2,{startedWork:r,completedWork:i}]}})}),B=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:t=(e=Promise).race;return[4,H];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:n.sent();return[2]}})}),F=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=y.waitForAll;return[4,H];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:t.sent();return[2]}})}),q=n.__awaiter(t,void 0,void 0,function(){var e,t,r=this;return n.__generator(this,function(i){switch(i.label){case 0:e=N(I({uploadProgressKey:T,uploadId:w,qosName:"Uploader.createFolder"}));o.onItemQueued({progressItemKey:T});i.label=1;case 1:i.trys.push([1,,3,4]);return[4,N(h.trackItemProgress({progressItemKey:T,started:B,completed:n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,P];case 1:e.sent();return[2]}})}),onStarted:function(e,t){t&&t(e)},onCompleted:function(t,n){n&&n(t);o.onItemUploaded({progressItemKey:T});N(e({error:t.error}))},onFailed:function(t,n){n&&n(t);o.onItemFailed({progressItemKey:T});N(e({error:t.error}))}}))];case 2:i.sent();return[3,4];case 3:N(p.resolveItems({items:(t={},t[T]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),t)}));L.dispose();N(x.removeItemDemands({owner:O}));return[7];case 4:return[2]}})}),R=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=N(I({uploadProgressKey:T,uploadId:w,qosName:"Uploader.uploadFolder"}));return[4,N(h.trackItemProgress({progressItemKey:T,started:B,completed:F,onStarted:function(e,t){},onCompleted:function(t,r){var i,s=N(b.readItems(function(e){return{overallProgressCounts:e.demandItemFacet(l.overallProgressCountsFacet,T),overallProgressSize:e.demandItemFacet(l.overallProgressSizeFacet,T)}})),o=s.overallProgressCounts,u=s.overallProgressSize,a=new A.ItemResolver;a.resolveItems({items:(i={},i[T]=n.__assign(n.__assign({},l.progressCountsFacet.pack(o)),l.progressSizeFacet.pack(u)),i)});N(a.execute());N(e({error:t.error}))},onFailed:function(t,n){N(e({error:t.error}))}}))];case 1:t.sent();return[2]}})});return{started:B,completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y.waitForAll([F,q,R])];case 1:e.sent();return[2]}})})}}})}function F(e){var t=this;return o.createAsyncActionCreator(function(i){var s=i.parentItemKey,o=i.callbacks,f=i.options,w=i.uploadId,T=S.getUploadProgressKey(e);return function(N){var C,k,L=new g.CancelSource;i.cancelToken.subscribe(L.cancel);var A=N(I({uploadProgressKey:T,uploadId:w,qosName:"Uploader.uploadFile"}));if(N(b.readItems(function(e){return e.demandItemFacet(l.createdItemFacet,T)})))return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})}),completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})};var O={operation:F};N(x.registerItemDemands({owner:O,items:(C={},C[T]={},C[e]={},C)}));N(p.resolveItems({items:(k={},k[T]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},E.errorFacet.pack(void 0)),l.progressPhaseFacet.pack(l.ProgressPhase.created)),m.isGroupFacet.pack(!1)),l.destinationItemFacet.pack({itemKey:s})),l.sourceItemFacet.pack({itemKey:e})),l.cancelSourceFacet.pack(L)),k)}));var M=N((function(e){var t=this,i=e.sourceEntryKey,s=e.parentItemKey,o=e.cancelToken,f=e.options,h=S.getUploadProgressKey(i);return function(e){var d,v,m={sourceEntries:(d={},d[i]=n.__assign({progressItemKey:h},f),d)};e(p.resolveItems({items:(v={},v[h]=n.__assign({},a.uploadItemsOperation.pack(m)),v)}));var g=n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(r.demandItems(function(e){return{fileSize:e.demandItemFacet(u.fileSizeFacet,i),fileName:e.demandItemFacet(u.fileNameFacet,i)}}))];case 1:return[2,t.sent()]}})}),y=n.__awaiter(t,void 0,void 0,function(){var t,r,i,u,f,d,v,y=this;return n.__generator(this,function(b){switch(b.label){case 0:return[4,g];case 1:void 0!==(t=b.sent().fileSize)&&e(p.resolveItems({items:(d={},d[h]=n.__assign({},l.progressSizeFacet.pack({total:t,current:0})),d)}));r=e(c.startOperation({operationTypeFacet:a.uploadItemsOperation,items:(v={},v[s]=m,v)})),i=r.started,u=r.completed;f=o.subscribe(function(){var t;e(c.cancelOperation({operationTypeFacet:a.uploadItemsOperation,items:(t={},t[s]=m,t)}))});n.__awaiter(y,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,i];case 1:e.sent();f();return[2]}})});return[2,{started:i,completed:u}]}})});return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y];case 1:return[4,e.sent().started];case 2:e.sent();return[2]}})}),completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y];case 1:return[4,e.sent().completed];case 2:e.sent();return[2]}})})}}})({sourceEntryKey:e,parentItemKey:s,cancelToken:L.token,options:f})),_=M.started,D=M.completed,P=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:o.onItemQueued({progressItemKey:T});t.label=1;case 1:t.trys.push([1,,3,4]);return[4,N(h.trackItemProgress({progressItemKey:T,started:_,completed:D,onStarted:function(e,t){t&&t(e)},onCompleted:function(e,t){t&&t(e);o.onItemUploaded({progressItemKey:T});N(A({error:e.error}))},onFailed:function(e,t){t&&t(e);o.onItemFailed({progressItemKey:T});N(A({error:e.error}))}}))];case 2:t.sent();return[3,4];case 3:N(p.resolveItems({items:(e={},e[T]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),e)}));L.dispose();N(x.removeItemDemands({owner:O}));return[7];case 4:return[2]}})});return{started:_,completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y.waitForAll([D,P])];case 1:e.sent();return[2]}})})}}})}function I(e){var t=e.qosName,r=e.uploadProgressKey,i=e.uploadId;return function(e){var s=e(T.logQoS({name:t}));return function(t){var o=t.error;return function(){var t=e(b.readItems(function(e){var t=e.demandItemFacet(l.sourceItemFacet,r),n=t&&t.itemKey,i=e.demandItemFacet(u.folderFacet,n),s=e.demandItemFacet(w.entryBatchFacet,n);return{entryBatch:s,folder:i,fileName:e.demandItemFacet(u.fileNameFacet,n),uploadStats:i||s?e.demandItemFacet(N.uploadStatsProgressFacet,r):void 0,progressSize:e.demandItemFacet(N.overallUploadProgressSizeFacet,r)}})),a=t.entryBatch,f=t.folder,c=t.fileName,h=t.uploadStats,p=t.progressSize,d=C.getTelemetrySafeFileExtension(c&&c.extension),v=a?"Batch":f?"Folder":"File",m=p?p.total:0,g=p?p.current:0;e(s(L.mergeQosEndSchema(k.getQosEndSchemaFromError(o),{extraData:n.__assign(n.__assign({uploadId:i,totalBytes:m,uploadedBytes:g,objectType:v},a?{}:{extension:d}),h?{"count.file.started":h.file.started,"count.file.completed":h.file.completed,"count.file.failed":h.file.failed,"count.file.canceled":h.file.canceled,"count.folder.started":h.folder.started,"count.folder.completed":h.folder.completed,"count.folder.failed":h.folder.failed,"count.folder.canceled":h.folder.canceled}:{})})))}}}}});
define("RU",["require","exports","we","NU"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e[e.InvalidStart=0]="InvalidStart";e[e.InvalidEnd=1]="InvalidEnd";e[e.InvalidCharacters=2]="InvalidCharacters";e[e.Empty=3]="Empty"})(i=t.ValidatorErrorType||(t.ValidatorErrorType={}));function s(e,t){var n=e.trim();return 0===n.length?i.Empty:t.invalidCharactersRegex.test(n)?i.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(n)?i.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(n)?i.InvalidEnd:void 0}t.isNameValid=s;function o(e,t){switch(e){case i.InvalidCharacters:return n.format(r.default.invalidNameError,t.invalidCharacters);case i.InvalidStart:return n.format(r.default.invalidNameStartError,t.cannotStartWith);case i.InvalidEnd:return n.format(r.default.invalidNameEndError,t.cannotEndWith);case i.Empty:return r.default.emptyNameError;case void 0:return}}t.getErrorString=o;function u(e){return function(t){return o(s(t,e),e)}}t.createNameValidator=u;t.nameValidator=u({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'});t.nameValidatorWithoutPoundPercent=u({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})});
define("vE",["require","exports","Vp"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tilesRenderCount=n.createPerformanceCounter("itemTiles.render.count");t.tilesRenderTime=n.createPerformanceCounter("itemTiles.render",{dependentCounter:t.tilesRenderCount});t.tilesSelectorCount=n.createPerformanceCounter("itemTiles.selectStoreData.count");t.tilesSelectorTime=n.createPerformanceCounter("itemTiles.selectStoreData",{dependentCounter:t.tilesSelectorCount})});
define("pQe",["require","exports","Dqe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._objBag=e;this.Init()}e.prototype.Init=function(){this._delegateMgr=this._objBag.delegateMgr;this._objBag.addColumnMgr=this};e.prototype.PopulateNewColumnMenu=function(e,t,r,i,s){return this._delegateMgr.Apply(n.JsGridConstants.DelegateType.AddNewColumnMenuItems,e,t,r,i,s)};e.prototype.EditColumn=function(e,t,r,i,s){return this._delegateMgr.Apply(n.JsGridConstants.DelegateType.EditColumn,e,t,r,i,s)};e.prototype.ShouldShowAddColumnMenu=function(){return 1==this._objBag.showAddColumnMenu};e.prototype.Dispose=function(){this._objBag.addColumnMgr=null};return e})();t.default=r});
define("Sqe",["require","exports","ww","r","Su","Ku","pc","bv","So","od","ODBItemsScopeDeferred_mini_css","q","Lqe","k"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";l=l.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var d=p.Killswitch.isActivated("9F26415E-BD34-4DD5-905E-D4067CB79A3F","3/05/2020","Correctly calculate drop hint element locations when sticky headers are on."),v=[],m={ODB:1757},g={ODB:1725},y=(function(){function e(e){var t=this;this._draggedColumnIndex=-1;this._dropHintDetails={};this._updateDroppingState=function(e,n){t._draggedColumnIndex>=0&&"drop"!==n.type&&(e||t._resetDropHints())};this._onDragOver=function(e,n){if(t._draggedColumnIndex>=0){n.stopPropagation();try{t._computeDropHintToBeShown(n.clientX)}catch(e){if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Failure,resultCode:"FailToComputeDropHintToShow",error:e.message});t._qos=void 0}}}};this._onDrop=function(e,n){var r=t._columnReorderProps;if(t._draggedColumnIndex>=0&&n){var i=t._draggedColumnIndex>t._currentDropHintIndex?t._currentDropHintIndex:t._currentDropHintIndex-1,s=t._isValidCurrentDropHintIndex();n.stopPropagation();if(s){t._onDropIndexInfo.sourceIndex=t._draggedColumnIndex;t._onDropIndexInfo.targetIndex=i;if(r&&r.onColumnDrop){var o={draggedIndex:t._draggedColumnIndex,targetIndex:i};try{r.onColumnDrop(o);if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Success});t._qos=void 0}}catch(e){if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Failure,resultCode:"FailToDropColumn",error:e.message});t._qos=void 0}}}else r&&r.handleColumnReorder&&r.handleColumnReorder(t._draggedColumnIndex,i)}}t._resetDropHints();t._dropHintDetails={};t._draggedColumnIndex=-1};this._updateDragInfo=function(e,n){var r=t._columnReorderProps,i=e.itemIndex;if(i>=0){t._telemetry&&(t._qos=new(t._telemetry(c.Qos))({name:"QuickEditColumnReorder"}));t._draggedColumnIndex=i-1;try{t._getDropHintPositions()}catch(e){if(t._qos){t._qos.end({resultType:c.ResultTypeEnum.Failure,resultCode:"FailToGetDropHintPositions",error:e.message});t._qos=void 0}}r&&r.onColumnDragStart&&r.onColumnDragStart(!0)}else if(n&&t._draggedColumnIndex>=0){t._resetDropHints();t._draggedColumnIndex=-1;t._dropHintDetails={};if(r&&r.onColumnDragEnd){var s=t._isEventOnHeader(n);r.onColumnDragEnd({dropLocation:s},n)}}};this._onColumnDragStart=function(e){t.logEngagement({name:"ColumnDragStart",isIntentional:!0})};this._onColumnDragEnd=function(e,n){var r=t._columnReorderProps,i=s.ColumnDragEndLocation.outside;if(r&&r.onDragEnd){if(e.dropLocation&&e.dropLocation!==s.ColumnDragEndLocation.header)i=e.dropLocation;else if(t._rootElement){var o=t._rootElement.getBoundingClientRect();n.clientX>o.left&&n.clientX<o.right&&n.clientY>o.top&&n.clientY<o.bottom&&(i=s.ColumnDragEndLocation.surface)}r.onDragEnd(i)}};this._onDragEnd=function(e){t.logEngagement({name:"ColumnDragEnd",extraData:{DragEndLocation:s.ColumnDragEndLocation[e]},isIntentional:!0})};this._onColumnDrop=function(e,n){var r=t.getColumns()[n.draggedIndex];if(t.ganttControl){t.ganttControl.MoveColumn({columnInfo:r,dragDropDetails:n,onColumnChangeSucceeded:e.onColumnChangeSucceeded});t.logEngagement({name:"ReorderColumn",isIntentional:!0})}};this._telemetry=e.telemetry;this._baseEngagementData=e.baseEngagementData;this._events=e.events;this._dragDropHelper=new i.DragDropHelper({selection:{getSelection:function(){}}});this._currentDropHintIndex=-1;this._columnReorderProps={frozenColumnCountFromStart:0,frozenColumnCountFromEnd:0,onColumnDragStart:this._onColumnDragStart,onColumnDragEnd:this._onColumnDragEnd,onColumnDrop:this._onColumnDrop.bind(this,e),onDragEnd:this._onDragEnd};this._onDropIndexInfo={sourceIndex:-1,targetIndex:-1}}e.prototype.subscribe=function(){if(this._columnReorderProps)!this._subscriptionObject&&this._dragDropHelper&&this._rootElement&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement,this._events,this._getHeaderDragDropOptions()));else if(this._subscriptionObject){this._subscriptionObject.dispose();delete this._subscriptionObject}};e.prototype.dispose=function(){if(this._subscriptionObject){this._subscriptionObject.dispose();delete this._subscriptionObject}this._dragDropHelper&&this._dragDropHelper.dispose()};e.prototype.setPaneManager=function(e){this.paneMgr=e;this._rootElement=this.paneMgr.GetGridPane().tableMgr.GetColumnHeaderTr();this.subscribe()};e.prototype.setGanttControl=function(e){this.ganttControl=e};e.prototype.getDragDropHelper=function(){return this._dragDropHelper};e.prototype._getHeaderDragDropOptions=function(){return{selectionIndex:1,context:{data:this,index:0},canDrag:function(){return!1},canDrop:function(){return!0},onDragStart:function(){},updateDropState:this._updateDroppingState,onDrop:this._onDrop,onDragEnd:function(){},onDragOver:this._onDragOver}};e.prototype._isValidCurrentDropHintIndex=function(){return this._currentDropHintIndex>=0};e.prototype._resetDropHints=function(){if(this._currentDropHintIndex>=0){this._updateDropHintElement(this._dropHintDetails[this._currentDropHintIndex].dropHintElementRef,"none");this._currentDropHintIndex=-1}};e.prototype._updateDropHintElement=function(e,t){e.childNodes[1].style.display=t;e.childNodes[0].style.display=t};e.prototype._getDropHintPositions=function(){for(var e,t=this.getColumns(),n=this._columnReorderProps,r=0,i=0,s=n&&n.frozenColumnCountFromStart?n.frozenColumnCountFromStart:0,o=n&&n.frozenColumnCountFromEnd?n.frozenColumnCountFromEnd:0,u=0,a=s;a<t.length-o+1;a++)if(this._rootElement){var f=this._rootElement.querySelectorAll("#columnDropHint_"+a)[0];if(f){var l=f.offsetParent,c=f.offsetLeft+l.offsetLeft;if(a===s){r=c;i=c;e=f}else{!d&&h.JsGridUtil.Internal.IsFeatureEnabled(m)&&l&&l.parentElement&&(c=u+l.parentElement.clientWidth);var p=(c+r)/2;this._dropHintDetails[a-1]={originX:r,startX:i,endX:p,dropHintElementRef:e};i=p;e=f;r=c;a===t.length-o&&(this._dropHintDetails[a]={originX:r,startX:i,endX:c,dropHintElementRef:e})}!d&&h.JsGridUtil.Internal.IsFeatureEnabled(m)&&l&&l.parentElement&&(u+=l.parentElement.clientWidth)}}};e.prototype._liesBetween=function(e,t,n){return o.getRTL()?e<=t&&e>=n:e>=t&&e<=n};e.prototype._isBefore=function(e,t){return o.getRTL()?e>=t:e<=t};e.prototype._isAfter=function(e,t){return o.getRTL()?e<=t:e>=t};e.prototype._computeDropHintToBeShown=function(e){if(this._rootElement){var t=e-this._rootElement.getBoundingClientRect().left,n=this._currentDropHintIndex;if(this._isValidCurrentDropHintIndex()&&this._liesBetween(t,this._dropHintDetails[n].startX,this._dropHintDetails[n].endX))return;var r=this.getColumns(),i=this._columnReorderProps,s=i&&i.frozenColumnCountFromStart?i.frozenColumnCountFromStart:0,o=i&&i.frozenColumnCountFromEnd?i.frozenColumnCountFromEnd:0,u=s,a=r.length-o,f=-1;this._isBefore(t,this._dropHintDetails[u].endX)?f=u:this._isAfter(t,this._dropHintDetails[a].startX)?f=a:this._isValidCurrentDropHintIndex()&&(this._dropHintDetails[n+1]&&this._liesBetween(t,this._dropHintDetails[n+1].startX,this._dropHintDetails[n+1].endX)?f=n+1:this._dropHintDetails[n-1]&&this._liesBetween(t,this._dropHintDetails[n-1].startX,this._dropHintDetails[n-1].endX)&&(f=n-1));if(-1===f)for(var l=s,c=a;l<c;){var h=Math.ceil((c+l)/2);if(this._liesBetween(t,this._dropHintDetails[h].startX,this._dropHintDetails[h].endX)){f=h;break}this._isBefore(t,this._dropHintDetails[h].originX)?c=h:this._isAfter(t,this._dropHintDetails[h].originX)&&(l=h)}if(f===this._draggedColumnIndex||f===this._draggedColumnIndex+1)this._isValidCurrentDropHintIndex()&&this._resetDropHints();else if(n!==f&&f>=0){this._resetDropHints();this._updateDropHintElement(this._dropHintDetails[f].dropHintElementRef,"inline-block");this._currentDropHintIndex=f}}};e.prototype._isEventOnHeader=function(e){if(this._rootElement){var t=this._rootElement.getBoundingClientRect();if(e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom)return s.ColumnDragEndLocation.header}};e.prototype.logEngagement=function(e){this._telemetry&&this._telemetry(u.default).logData(n.__assign(n.__assign({},this._baseEngagementData),{component:"SPGrid",name:e.name,extraData:a.graft(this._baseEngagementData.extraData,e.extraData),isIntentional:e.isIntentional}))};e.prototype.getColumns=function(){var e=this.paneMgr.GetColumns(null);e||(e=v);return e};e.prototype.renderDropHint=function(e){var t=h.JsGridUtil.Internal.IsFeatureEnabled(g),n=t?" "+l.containerRefreshed:"",i=t?" "+l.caretRefreshed:"",s=t?" "+l.lineRefreshed:"";return r.createElement("div",{key:"dropHintKey",className:""+l.dropHintStyle+n,id:"columnDropHint_"+e},r.createElement(f.Icon,{key:"dropHintCaretKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:""+l.dropHintCaretStyle+i,iconName:"CaretUpSolid8"}),r.createElement("div",{key:"dropHintLineKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:""+l.dropHintLineStyle+s}))};return e})();t.ColumnDragDropManager=y});
define("Rqe",["require","exports","Eqe","Lqe","Dqe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t,n,r,s,o,u,a){this.key=e;this.hasDataValue=t;this.hasLocalizedValue=n;this.textDirection=r;this._defaultCellStyleId=s;this._editMode=null==o?i.JsGridConstants.EditMode.Defer:o;this._propType=null;this._multiValue=!1;this.dateOnly=null==u||u;this.csrInfo=a}e.prototype.GetEditMode=function(){return this._editMode};e.prototype.SetEditMode=function(e){this._editMode=e};e.prototype.GetDefaultCellStyleId=function(){return this._defaultCellStyleId};e.prototype.CompareSingleDataEqual=function(e,t){var n=this.GetSingleValuePropType().IsDataEqual;return null==n?e==t:n(e,t)};e.prototype.GetPropType=function(){return this._propType};e.prototype.GetSingleValuePropType=function(){return this._multiValue?this._propType.singleValuePropType:this._propType};e.prototype.GetMultiValuePropType=function(){return this._multiValue?this._propType:null};e.prototype.SetSingleValuePropType=function(e){if(this._multiValue&&!r.JsGridUtil.Internal.IsNullOrUndefined(e)){var t=new n.PropertyType.MultiValuePropType(e.ID,this._listSeparator,null,null);n.PropertyType.RegisterNewDerivedCustomPropType(t,e.ID);this._propType=t}else this._propType=e};e.prototype.SetIsMultiValue=function(e){if(!this._multiValue){this._listSeparator=e;this._multiValue=!0;this.SetSingleValuePropType(this._propType)}};e.prototype.GetIsMultiValue=function(){return this._multiValue};return e})();t.GridField=s;var o=(function(){function e(e,t,n,i){this.isVisible=!0;this.isHidable=!0;this.isResizable=!0;this.isSortable=!0;this.isAutoFilterable=!0;this.isFooter=!1;this.bOpenMenuOnContentClick=!1;this.fnShouldLinkSingleValue=null;this.fnSingleValueClicked=null;this.fnGetCellEditMode=null;this.fnGetDisplayControlName=null;this.fnGetEditControlName=null;this.fnGetWidgetControlNames=null;this.fnGetCellStyleId=null;this.fnGetSingleValueTooltip=null;this.name=e;this.imgSrc=t;this.columnKey=n;this.fieldKeys=[n];this.width=i;this.bOpenMenuOnContentClick=!r.JsGridUtil.Internal.IsNullOrUndefined(this.imgSrc)}e.prototype.ColumnType=function(){return"column"};return e})();t.ColumnInfo=o;var u=(function(){function e(e){this.colInfoMap={};this._colInfoArray=e;this.BuildMap()}e.prototype.GetColumnByKey=function(e){return this.colInfoMap[e]};e.prototype.GetColumnArray=function(e){var t=[];if(e)for(var n=0;n<this._colInfoArray.length;++n)this._colInfoArray[n].isVisible&&t.push(this._colInfoArray[n]);else t=this._colInfoArray;return t};e.prototype.GetColumnMap=function(){return this.colInfoMap};e.prototype.AppendColumn=function(e){this.InsertColumnAt(this._colInfoArray.length,e)};e.prototype.InsertColumnAt=function(e,t){this._colInfoArray.splice(e,0,t);this.BuildMap()};e.prototype.RemoveColumn=function(e){var t=this.colInfoMap[e],n=r.JsGridUtil.Internal.FindKey(this._colInfoArray,function(e){return e==t},null);r.JsGridUtil.Internal.IsNullOrUndefined(n)||this._colInfoArray.splice(n,1);this.BuildMap();return n};e.prototype.GetColumnPosition=function(e){for(var t=0,n=0;n<this._colInfoArray.length;++n)if(this._colInfoArray[n].isVisible){if(this._colInfoArray[n].columnKey==e)return t;t++}return null};e.prototype.BuildMap=function(){for(var e=0;e<this._colInfoArray.length;++e)this.colInfoMap[this._colInfoArray[e].columnKey]=this._colInfoArray[e]};return e})();t.ColumnInfoCollection=u});
define("uQe",["require","exports","pQe","Dqe","Hqe","fQe","Iqe","we","Lqe","k","J8","vS","_p"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=f.Killswitch.isActivated("FCBB4612-13ED-47B8-9E17-79F91890AC92","9/26/2019","Translate the title column to linktitle when comparing Grid columns to the additionalColumnSchema"),d=f.Killswitch.isActivated("FE3155B7-42CB-443A-96A5-A7250085F375","7/8/2020","Command to move column left or right"),v={ODB:1672},m={ODB:1722},g={ODB:1918},y={ODB:1843},b=(function(){function e(e,t,n,r,i,s){var o=this;this._sortStateMap={};this.OnPropertyChanged=function(e){delete o.cache[e.fieldKey]};this.OnRecordInserted=function(e){o.ClearCache()};this.OnRecordDeleted=function(e){o.ClearCache()};this._objBag=e;this._autoFilterState=t;this._fnGetLocStr=i;if(s)for(var u=0,a=s;u<a.length;u++){var f=a[u];this._sortStateMap[f.fieldKey]=f.isDescending}this.cache=n||{};this.paneMgr=e.paneMgr;this.delegateMgr=e.delegateMgr;this.jsGridObj=e.jsGridObj;this.Init()}e.prototype.Init=function(){this._autoFilterState=null==this._autoFilterState?{}:this._autoFilterState;this.jsGridObj.AttachEvent(r.JsGridConstants.EventType.OnPropertyChanged,this.OnPropertyChanged);this.jsGridObj.AttachEvent(r.JsGridConstants.EventType.OnRecordInserted,this.OnRecordInserted);this.jsGridObj.AttachEvent(r.JsGridConstants.EventType.OnRecordDeleted,this.OnRecordDeleted);this.addColumnMgr=new n.default(this._objBag)};e.prototype.Dispose=function(){this.jsGridObj.DetachEvent(r.JsGridConstants.EventType.OnPropertyChanged,this.OnPropertyChanged);this.jsGridObj.DetachEvent(r.JsGridConstants.EventType.OnRecordInserted,this.OnRecordInserted);this.jsGridObj.DetachEvent(r.JsGridConstants.EventType.OnRecordDeleted,this.OnRecordDeleted);this.addColumnMgr.Dispose()};e.prototype.SetAutoFilterState=function(e){this._autoFilterState=null==e?{}:e;this.ClearCache()};e.prototype.SeedAutoFilterEntryCache=function(e){this.cache=e||{}};e.prototype.ClearCache=function(){this.cache={}};e.prototype.CanExpandMenu=function(e,t,n,i,s){return t||s||n&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.Sort)||i&&e.isAutoFilterable&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetAutoFilterEntries)&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.AutoFilter)&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.LaunchFilterDialog)||e.columnKey==r.JsGridConstants.RecordIndicatorCheckboxColumnKey||this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.WillAddColumnMenuItems)&&this.delegateMgr.Apply(r.JsGridConstants.DelegateType.WillAddColumnMenuItems,e.columnKey)};e.prototype.ExpandMenu=function(e,t,n,f,b,w,E){var S=this;var x=e.columnKey,T=E||this.jsGridObj.parentNode;this.columnMenu=new i.ContextMenuWrapper({target:T,id:this.jsGridObj.parentNode.id+"_columnmenu",OnMenuHidden:function(){n()},portalManager:this.jsGridObj.objBag?this.jsGridObj.objBag.portalManager:void 0});var N=a.JsGridUtil.Internal.IsFeatureEnabled(m);if(e.isFooter)this.addColumnMgr.PopulateNewColumnMenu(this.columnMenu,this._objBag.jsGridParams.onColumnChangeSucceeded,this._objBag.jsGridParams.onLaunchColumnManagementPanel);else{this.columnMenu.InsertMenuItem({key:"RenameColumn",text:this._fnGetLocStr("RenameColumn"),onClick:function(){S.OnColumnRename(x,S._objBag.jsGridParams.onColumnChangeSucceeded)}});if(b&&e.isSortable&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onSort){this.columnMenu.InsertSeparator();var C=this._sortStateMap[x];this.columnMenu.InsertMenuItem({key:"SortAsc",text:e.ascendingString||this._fnGetLocStr("SortAsc"),onClick:function(){S._objBag.jsGridParams.onSort(x,!0)},canCheck:!0,checked:!1===C});this.columnMenu.InsertMenuItem({key:"SortDesc",text:e.descendingString||this._fnGetLocStr("SortDesc"),onClick:function(){S._objBag.jsGridParams.onSort(x,!1)},canCheck:!0,checked:!0===C})}if(e.isFilterable&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onLaunchFilterPanel){var k=this._autoFilterState[x],L=s.default.columnMenuFilter;if(k){var A=k.split(";#");L=u.format(s.default.columnMenuFilterByWithNumber,A.length)}this.columnMenu.InsertMenuItem({key:"FilterBy",text:L,onClick:function(){p?S._objBag.jsGridParams.onLaunchFilterPanel(x):S._objBag.jsGridParams.onLaunchFilterPanel(a.JsGridUtil.Internal.normalizeColumnKey(x))}})}var O=[];if(e.fieldType&&-1!==l.FieldTypeSwitcherHelper.getSupportedPanelTypes().indexOf(e.fieldType)&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onLaunchColumnManagementPanel&&e.isEditable&&!e.isCalculated&&e.internalName&&"Title"!==e.internalName){var M=this.addColumnMgr.EditColumn(this.columnMenu,this._objBag.jsGridParams.onLaunchColumnManagementPanel,e.fieldType,e.internalName,!0);M&&O.push(M)}a.JsGridUtil.Internal.IsFeatureEnabled(v)&&O.push({key:"CustomizeColumn",text:s.default.columnMenuFormat,onClick:function(){S._objBag.jsGridParams.launchColumnCustomization(a.JsGridUtil.Internal.normalizeColumnKey(x,!0))}});if(!d){this.isMoveColumnAvailable(!0,x)&&O.push({key:"columnMenuMoveLeft"+x,text:s.default.columnMenuMoveLeft,onClick:function(){S.onMoveColumn(e,x,!0)}});this.isMoveColumnAvailable(!1,x)&&O.push({key:"columnMenuMoveRight"+x,text:s.default.columnMenuMoveRight,onClick:function(){S.onMoveColumn(e,x,!1)}})}N&&e.isHidable&&O.push({key:"HideColumn",text:s.default.columnMenuHideThisColumn,onClick:function(){if(S.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.RemoveColumnFromView)){var e=a.JsGridUtil.Internal.normalizeColumnKey(x,!0);S.delegateMgr.Apply(r.JsGridConstants.DelegateType.RemoveColumnFromView,e)}}});if(a.JsGridUtil.Internal.IsFeatureEnabled(g)&&e.isFilterable){var _=a.JsGridUtil.Internal.getColumnFromListSchema(this.jsGridObj,x),D=c.ShowInFiltersPaneStatus[_.ShowInFiltersPane];if(_){D===c.ShowInFiltersPaneStatus.Auto&&O.push({key:"PinToFiltersPane",text:s.default.columnMenuPinToFiltersPane,onClick:function(){S.onPinToFiltersPane(_,c.ShowInFiltersPaneStatus.Pinned);_.ShowInFiltersPane=c.ShowInFiltersPaneStatus[c.ShowInFiltersPaneStatus.Pinned]}});D===c.ShowInFiltersPaneStatus.Pinned&&O.push({key:"UnpinFromFiltersPane",text:s.default.columnMenuUnpinFromFiltersPane,onClick:function(){S.onPinToFiltersPane(_,c.ShowInFiltersPaneStatus.Auto);_.ShowInFiltersPane=c.ShowInFiltersPaneStatus[c.ShowInFiltersPaneStatus.Auto]}})}}if(N){O.push({key:"divider_1",itemType:h.ContextualMenuItemType.Divider});O.push({key:"LaunchColumnsEditorPanel",text:s.default.addColumnShowHide,onClick:function(){S._objBag.jsGridParams.launchColumnsEditor()}})}if(a.JsGridUtil.Internal.IsFeatureEnabled(y)&&this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.onLaunchColumnManagementPanel){N||O.push({key:"divider_1",itemType:h.ContextualMenuItemType.Divider});var P=this.addColumnMgr.PopulateNewColumnMenu(this.columnMenu,this._objBag.jsGridParams.onColumnChangeSucceeded,this._objBag.jsGridParams.onLaunchColumnManagementPanel,a.JsGridUtil.Internal.normalizeColumnKey(e.internalName,!0),!0);P&&P.length&&O.push({key:"AddColumn",text:o.default.L_AddColumn_Text,subMenuProps:{items:P}})}if(O.length){this.columnMenu.InsertSeparator();this.columnMenu.InsertMenuItem({key:"ColumnSettings",text:s.default.columnMenuColumnSettings,subMenuProps:{items:O}})}}if(x==r.JsGridConstants.RecordIndicatorCheckboxColumnKey){this.columnMenu.InsertSeparator();this.columnMenu.InsertMenuItem({key:"CheckAllRecords",text:this._fnGetLocStr("CheckAllRecords"),onClick:function(){S.jsGridObj.GetCheckSelectionManager().CheckAllRecords()}});this.columnMenu.InsertMenuItem({key:"ClearCheckedRecords",text:this._fnGetLocStr("ClearCheckedRecords"),onClick:function(){S.jsGridObj.GetCheckSelectionManager().ClearCheckedRecords()}})}this.columnMenu.IsEmpty()||this.columnMenu.Show();return!this.columnMenu.IsEmpty()};e.prototype.isMoveColumnAvailable=function(e,t){var n=!1,r=this.paneMgr.gridPane.GetAllColumns()._colInfoArray.map(function(e){return e.columnKey});if(r&&r.length){var i=r.indexOf(t);n=e?i>1:i>=0&&i<r.length-2}return n};e.prototype.onMoveColumn=function(e,t,n){var i=this.paneMgr.gridPane.GetAllColumns().GetColumnPosition(t),s=n?i-1:i+1;this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.MoveColumn)&&this.delegateMgr.Apply(r.JsGridConstants.DelegateType.MoveColumn,{columnInfo:e,dragDropDetails:{draggedIndex:i,targetIndex:s},onColumnChangeSucceeded:this._objBag.jsGridParams.onColumnChangeSucceeded})};e.prototype.onPinToFiltersPane=function(e,t){this._objBag.jsGridParams.onPinToFiltersPane({id:e.ID,internalName:a.JsGridUtil.Internal.normalizeColumnKey(e.RealFieldName,!0),showInFiltersPane:c.ShowInFiltersPaneStatus[e.ShowInFiltersPane],filterable:!0},t)};e.prototype.OnColumnRename=function(e,t){this.columnMenu.Hide();this.paneMgr.RenameColumn(e,t)};return e})();t.default=b});
define("Hqe",["require","exports","r","Lqe","_p","Pqe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e){var t=this;this._itemCount=0;this._seperatorCount=0;this._menuItems=[];this._functionDispatch=[];this._isOpen=!1;this.Hide=function(){if(t.IsOpen()){t._onMenuHidden&&t._onMenuHidden();t.Dispose()}};this.Show=function(){if(t._itemCount){var e=n.createElement(i.ContextualMenu,{items:t._menuItems,target:t._target,onDismiss:t.Hide,calloutProps:{shouldRestoreFocus:!0}});t._portalManager.render(e,t._popupAnchor);t._isOpen=!0}};this.Dispose=function(){t._isOpen=!1;t._portalManager.unmount(t._popupAnchor);if(!r.JsGridUtil.Internal.IsNullOrUndefined(t._popupAnchor)&&r.JsGridUtil.Internal.DomElement.GetInstance().GetParentElement(t._popupAnchor)){t._popupAnchor.parentNode.removeChild(t._popupAnchor);t._popupAnchor=null}window[t._id+"_onclick"]=null};var o=e.target,u=e.id,a=e.OnMenuHidden,f=e.portalManager;this._target=o;this._id=u;this._onMenuHidden=a;this._portalManager=f||s.defaultPortalManger;this._popupAnchor=document.createElement("div");this._popupAnchor.style.cssText="position:absolute;visibility:hidden;width:250px;";window[this._id+"_onclick"]=function(e){setTimeout(t._functionDispatch[e],0)}}e.prototype.IsOpen=function(){return this._isOpen};e.prototype.IsEmpty=function(){return 0==this._itemCount};e.prototype.InsertMenuItem=function(e){e.onClick&&this._functionDispatch.push(e.onClick);this._menuItems.push(e);this._itemCount++};e.prototype.InsertSeparator=function(){if(this._menuItems.length&&this._menuItems[this._menuItems.length-1].itemType!==i.ContextualMenuItemType.Divider){this._menuItems.push({key:"divider_"+this._seperatorCount,itemType:i.ContextualMenuItemType.Divider});this._seperatorCount++}};e.prototype.RemoveMenuItem=function(e){this._menuItems.splice(e,1)};return e})();t.ContextMenuWrapper=o});
define("sQe",["require","exports","Dqe","Eqe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t,n,r,i){this._registeredEditControlsAPI={};this._registeredWidgetControlsAPI={};this._objBag=e;this._fnGetEditControlManagerAPI=n;this._fnGetWidgetControlManagerAPI=r;this._fnOnRegisterWidgetControl=i}e.prototype.RegisterEditControl=function(e){e in this._registeredEditControlsAPI||this.CreateEditControlInstance(e);return this._registeredEditControlsAPI[e]};e.prototype.RegisterWidgetControl=function(e){e in this._registeredWidgetControlsAPI||this.CreateWidgetControlInstance(e);return this._registeredWidgetControlsAPI[e]};e.prototype.GetEditControlAPI=function(e){return this._registeredEditControlsAPI[e]};e.prototype.GetWidgetControlAPI=function(e){return this._registeredWidgetControlsAPI[e]};e.prototype.GetActorAPI=function(e){return this._registeredEditControlsAPI[e]||this._registeredWidgetControlsAPI[e]};e.prototype.IsActorWidget=function(e){return e in this._registeredWidgetControlsAPI};e.prototype.GetEditAndWidgetControlsAPI=function(e,t,n,i){var s={editControlAPI:null,widgetControlsAPI:[]},o=r.PropertyType.Internal.Property.GetInstance().GetEditAndWidgetControlNamesForProperty(e,t,n,i);s.editControlAPI=this.RegisterEditControl(o.editControlName);for(var u=0;u<o.widgetControlNames.length;u++)s.widgetControlsAPI.push(this.RegisterWidgetControl(o.widgetControlNames[u]));return s};e.prototype.Dispose=function(){for(var e in this._registeredEditControlsAPI)this._registeredEditControlsAPI[e].actor.Dispose();for(var e in this._registeredWidgetControlsAPI)this._registeredWidgetControlsAPI[e].actor.Dispose()};e.prototype.CreateEditControlInstance=function(e){var t=this._fnGetEditControlManagerAPI(e),n=[t.GetGridContext()],i=this._objBag.focusMgr.GetFocusElementForTextInput(e);null!=i&&n.push(i);t.actor=r.PropertyType.Internal.Property.GetInstance().GetEditControl(e,n);this._registeredEditControlsAPI[e]=t};e.prototype.CreateWidgetControlInstance=function(e){var t=this._fnGetWidgetControlManagerAPI(e),i=[t.GetGridContext()];e==n.JsGridConstants.ErrorWidgetId&&i.push(this._objBag.errorMgr);t.actor=r.PropertyType.Internal.Property.GetInstance().GetWidgetControl(e,i);this._fnOnRegisterWidgetControl(e,t.actor);this._registeredWidgetControlsAPI[e]=t};return e})();t.EditActorsRegistrationManager=i});
define("Xqe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){this._touchableActions=t||{};this.Init()}e.prototype.Init=function(){};e.prototype.RegisterTouchableAction=function(e,t){this._touchableActions[e]=t};e.prototype.UnregisterTouchableAction=function(e){delete this._touchableActions[e]};e.prototype.Dispose=function(){null!=this._touchManager&&this._touchManager.Dispose()};return e})();t.GridTouchManager=n});
define("cQe",["require","exports","Aqe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this.Clear()}e.prototype.AddCell=function(e,t){var n=this.Hash(e,t);this._cells.Add(n)};e.prototype.Clear=function(){this._cells=new n.Set};e.prototype.IsCellIn=function(e,t){return this._cells.Contains(this.Hash(e,t))};e.prototype.Hash=function(e,t){return[e,t].join()};return e})();t.ChangeHighlightManager=r});
define("vQe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.JSONParse=function(e){var t=!1,n=JSON.parse(e,r);t&&(function e(t,n){if(null!=t&&"object"==typeof t)for(var r in t)if(t.hasOwnProperty(r)){e(t[r],n);t[r]=n(r,t[r])}})(n,r);return n;function r(e,n){(function(e,n){t=t||null==n&&/^\d+$/.test(e)})(e,n);if("string"==typeof n){var r=/^\/Date\((-?\d+\))\/$/g.exec(n);if(null!=r){var i=parseInt(r[1]);return new Date(i)}}return n}}});
define("qqe",["require","exports","Lqe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){this._tableCache=e;this._objBag=t}e.prototype.SetScrollBarObj=function(e){this.vertScrollBar=e};e.prototype.SetPaneMgrObj=function(e){this.paneMgr=e};e.prototype.GetTopViewIdx=function(){return this.vertScrollBar.GetTopItemIdx()};e.prototype.GetWholeRowDisplayCapacity=function(){return this.vertScrollBar.GetWholeItemDisplayCapacity()};e.prototype.RecordIdxToRecordKey=function(e){var t;if(this._objBag.editUtil.IsNewRowEnabled()&&e>=this._tableCache.GetRecordCount()){var n=this._objBag.entryRecordMgr.GetEntryRecords();n.length>0&&(t=n[Math.min(e-this._tableCache.GetRecordCount(),n.length-1)].key())}else t=this._tableCache.RecordIdxToKey(e);return t};e.prototype.RecordIdxToViewIdx=function(e){return e};e.prototype.ViewIdxToRecordIdx=function(e){return e};e.prototype.ViewIdxToRelViewIdx=function(e){return e-this.vertScrollBar.GetTopItemIdx()};e.prototype.RelViewIdxToViewIdx=function(e){return e+this.vertScrollBar.GetTopItemIdx()};e.prototype.IsRecordOnScreen=function(e){return null!=this.paneMgr.RecordKeyToViewIdx(e)};e.prototype.GetLastRecordKey=function(){return this._tableCache.RecordIdxToKey(this._tableCache.GetRecordCount()-1)};e.prototype.RecordKeyToViewIdx=function(e){var t,n=this.paneMgr.RecordKeyToViewIdx(e);return null!=n?n:null==(t=this._objBag.entryRecordMgr.IsEntryRecordKey(e)?this._objBag.entryRecordMgr.GetEntryRecordIdx(e)+this.GetViewRecordCount():this._tableCache.KeyToRecordIdx(e))?null:this.RecordIdxToViewIdx(t)};e.prototype.RecordKeyToRelViewIdx=function(e){var t=this.RecordKeyToViewIdx(e);return null!=t?this.ViewIdxToRelViewIdx(t):null};e.prototype.RecordKeyToRecordIdx=function(e){var t=this.paneMgr.RecordKeyToViewIdx(e);return null!=t?this.ViewIdxToRecordIdx(t):this._tableCache.KeyToRecordIdx(e)};e.prototype.ViewIdxToRecordKey=function(e){return this.RecordIdxToRecordKey(this.ViewIdxToRecordIdx(e))};e.prototype.GetViewRecordCount=function(){return this._tableCache.GetRecordCount()};e.prototype.GetViewRecords=function(e,t,r){var i=0;this._objBag.editUtil.IsNewRowEnabled()&&(i=Math.min(Math.max(e+t-this.GetViewRecordCount(),0),t));var s=0==(t-=i)?null:this._tableCache.GetRecords([{pos:e,count:t}],function(n,i){r(e,t,i)});null==s?s={recordSetComplete:!0,records:[]}:s.records=n.JsGridUtil.Internal.Flatten2LevelArray(s.records);if(i>0){var o=Math.max(e-this.GetViewRecordCount(),0);s.records=s.records.concat(this._objBag.entryRecordMgr.GetEntryRecords().slice(o,o+i))}return s};return e})();t.PositionConverter=r});
define("kqe",["require","exports","Lqe","Dqe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this.data=e;this.localized=t}e.prototype.HasDataValue=function(){return this.data!==n.JsGridUtil.EmptyValue};e.prototype.HasLocalizedValue=function(){return this.localized!==n.JsGridUtil.EmptyValue};return e})();t.PropertyUpdate=i;t.CreateUnvalidatedPropertyUpdate=function(e,t,n,r){return new s(e,t,n,r)};t.CreateValidatedPropertyUpdate=function(e,t,n,r){return new o(e,t,n,r)};var s=function(e,t,r,i){this.validated=!1;this.recordKey=e;this.fieldKey=t;this.newValue=r;this.newValueIsLocalized=i;if(!n.JsGridUtil._locationFilldownKillswitchIsActive&&!i&&"string"==typeof this.newValue)try{this.newValue=JSON.parse(this.newValue)}catch(e){}};t.UnvalidatedPropertyUpdate=s;var o=function(e,t,n,r){this.validated=!0;this.recordKey=e;this.fieldKey=t;this.newDataValue=n;this.newLocalizedValue=r};t.ValidatedPropertyUpdate=o;var u=(function(){function e(e,t){this._objBag=e}e.prototype.ApplyPropUpdates=function(e,t){for(var n=0;n<e.length;n++)this.ApplySinglePropUpdateRequest(e[n],t)};e.prototype.ApplySinglePropUpdateRequest=function(e,t){var s=this,o=function(o){f=!1;o.isValid?u(new i(o.dataValue,o.normalizedLocValue),r.JsGridConstants.ValidationState.Valid,null):u(e.newValueIsLocalized?new i(n.JsGridUtil.InvalidValue,e.newValue):new i(e.newValue,n.JsGridUtil.InvalidValue),r.JsGridConstants.ValidationState.Invalid,o.errorMsg);l&&s._objBag.pendingChangeMgr.DecrementPendingChangeCount(t)},u=function(n,i,o){e.fieldKey!==r.JsGridConstants.RecordIndicatorCheckboxColumnKey?s._objBag.versionMgr.AddPropChange(e.recordKey,e.fieldKey,t,n,i,o):n.data?s._objBag.checkSelMgr.ExternalAPI.CheckRecord(e.recordKey):s._objBag.checkSelMgr.ExternalAPI.UncheckRecord(e.recordKey)};if(e.validated)u(new i(e.newDataValue,e.newLocalizedValue),r.JsGridConstants.ValidationState.Valid,null);else{var a=this._objBag.controller.GetPropType(e.recordKey,e.fieldKey);n.JsGridUtil.DebugAssert(null!=a);e.newValueIsLocalized&&(e.newValue=null==e.newValue?"":e.newValue.replace(/^\s+|\s+$/g,""));var f=!0,l=!1;a.BeginValidateNormalizeConvert(e.recordKey,e.fieldKey,e.newValue,e.newValueIsLocalized,o,function(){var e={isValid:!1,errorMsg:SP.JsGrid.Res.vncfailed};o(e)});if(f){this._objBag.pendingChangeMgr.IncrementPendingChangeCount(t);l=!0;u(e.newValueIsLocalized?new i(n.JsGridUtil.InvalidValue,e.newValue):new i(e.newValue,n.JsGridUtil.InvalidValue),r.JsGridConstants.ValidationState.Pending,null)}}};return e})();t.PropertyUpdateManager=u;var a=(function(){function e(e){this.callbackCount=0;this.pendingCount=0;this.activeChangeKeys={};this.pendingCallbacks=[];this.completeCallbacks=[];this.pendingChangeKeys={};this.newRowChanges={};e.intEventMgr.AttachEvent(r.JsGridConstants.Internal.EventType.OnChangeKeyCreated,this.NotifyKeyCreated.bind(this));e.intEventMgr.AttachEvent(r.JsGridConstants.Internal.EventType.OnChangeKeyInitialUpdateFinished,this.NotifyKeyInitiallyComplete.bind(this));e.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordPropertyChanged,this.EntryRecordPropertyChanged.bind(this));e.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordCommitted,this.EntryRecordCommitted.bind(this));e.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnVacateChange,this.OnVacateChange.bind(this));this._objBag=e}e.prototype.OnVacateChange=function(e){var t=e.changeKey.GetVersionNumber();delete this.activeChangeKeys[t];delete this.pendingChangeKeys[t]};e.prototype.EntryRecordPropertyChanged=function(e){var t=e.recordKey;t in this.newRowChanges||(this.newRowChanges[t]=[]);this.newRowChanges[t].push(e.changeKey);this.IncrementPendingChangeCountForChangeKey(e.changeKey)};e.prototype.EntryRecordCommitted=function(e){var t=e.originalRecordKey;if(t in this.newRowChanges)for(var n=this.newRowChanges[t],r=0;r<n.length;r++)this.TryFireChangeKeyCompleteEvent(n[r])};e.prototype.NotifyKeyCreated=function(e){var t=e.changeKey.GetVersionNumber();this.activeChangeKeys[t]=e.changeKey;this.pendingChangeKeys[t]=1};e.prototype.NotifyKeyInitiallyComplete=function(e){this.TryFireChangeKeyCompleteEvent(e.changeKey)};e.prototype.TryFireChangeKeyCompleteEvent=function(e){var t=this,i=e.GetVersionNumber();if(0==--this.pendingChangeKeys[i]){delete this.pendingChangeKeys[i];this.callbackCount++;setTimeout(function(){t.callbackCount--;t._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnInitialChangesForChangeKeyComplete,n.JsGridUtil.EventArgs.PendingChangeKeyInitiallyComplete(e));delete t.activeChangeKeys[i];if(0!==t.completeCallbacks.length&&!t.AnyActiveChanges()){for(var s=0;s<t.completeCallbacks.length;s++)t.completeCallbacks[s]();t.completeCallbacks=[]}},0)}};e.prototype.AnyActiveChanges=function(){var e=!1;for(var t in this.activeChangeKeys)if(this._objBag.controller.IsChangeKeyApplied(this.activeChangeKeys[t])){e=!0;break}return e};e.prototype.IncrementPendingChangeCountForChangeKey=function(e){var t=e.GetVersionNumber();t in this.pendingChangeKeys?this.pendingChangeKeys[t]++:this.pendingChangeKeys[t]=1};e.prototype.WaitForPendingUpdates=function(e){null!=e&&(0!==this.pendingCount?this.pendingCallbacks.push(e):e())};e.prototype.WaitForAllChangeKeysToComplete=function(e){null!=e&&(0!==this.callbackCount||0!==this.pendingCount||this.AnyActiveChanges()?this.completeCallbacks.push(e):e())};e.prototype.IncrementPendingChangeCount=function(e){this.pendingCount++;this.IncrementPendingChangeCountForChangeKey(e)};e.prototype.DecrementPendingChangeCount=function(e){this.pendingCount--;if(0==this.pendingCount&&0!==this.pendingCallbacks.length){for(var t=0;t<this.pendingCallbacks.length;t++)this.pendingCallbacks[t]();this.pendingCallbacks=[]}this.TryFireChangeKeyCompleteEvent(e)};return e})();t.PendingChangesManager=a});
define("AWe",["require","exports","Mv","Gv","kv","le"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addRumOneMarker=function(e){n.default.getRUMOneLogger().mark(e)};t.resetRumOneMarker=function(){var e=n.default.getRUMOneLogger();e.isRunning()||e.resetLogger()};t.writeRumOneData=function(){var e=n.default.getRUMOneLogger();if(e&&e.isRunning()){var t=Number(e.getPerformanceDataPropertyValue("W3cNavigationStart")),a=s.HighResolutionTimingSupported?0:t,f=e.getMarkerTime("quickEditCommand.click"),l=f||a,c=e.getMarkerTime("quickEdit.pltafterlayoutswitch.start"),h=e.getMarkerTime("quickEdit.plt.end");e.addExpectedControl("QuickEdit");f?e.writeScenarioId("QuickEdit"):e.writeScenarioId("SPListQuickEdit",!0);e.writePageTransitionType(f?r.default.none:r.default.fullPageLoad);e.collectW3CPerfTimings();if(c&&h&&l>-1){var p={},d=e.getMarkerTime("quickEdit.layoutManager.start"),v=e.getMarkerTime("quickEdit.layoutManager.end");d&&v&&o(d,v,"QuickEditLayoutManagerDuration",p);v&&c&&o(v,c,"QuickEditItemsViewCacheDuration",p);var m=e.getMarkerTime("quickEdit.loadExternalFiles.start"),g=e.getMarkerTime("quickEdit.loadExternalFiles.end");m&&g&&o(m,g,"QuickEditExternalJsLoadDuration",p);var y=e.getMarkerTime("quickEdit.serialization.start"),b=e.getMarkerTime("quickEdit.serialization.end");y&&b&&o(y,b,"QuickEditGridSerializationDuration",p);var w=e.getMarkerTime("quickEdit.gridrender.start"),E=e.getMarkerTime("quickEdit.gridrender.end");w&&E&&o(w,E,"QuickEditGridRenderDuration",p);o(l,h,"QuickEditPLTRenderDuration",p);o(c,h,"QuickEditPLTAfterLayoutSwitchDuration",p);if(window._spPageContextInfo){e.writeServerCorrelationId(window._spPageContextInfo.CorrelationId);e.collectSPClientFlights(window._spPageContextInfo)}e.writeControlPerformanceData((function(e,t,n){return new i.default(e,t,n,u,function(){return!isNaN(t)&&!isNaN(n)})})("QuickEdit",l,h));e.writeEUPLBreakdown(JSON.stringify(p))}}};function o(e,t,n,r){if(e&&t){var i=t-e;r[n]=i}}function u(e,t){return e&&t?t.endTime-t.startTime:0}});
define("_Qe",["require","exports","Lqe","Dqe","ou","ld","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o){"use strict";var u=o.RowHeaderState_3;o=o.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var a={ODB:1725},f=(function(){function e(e){this._rowHeaderStates={};this._intEventMgr=e}e.prototype.AddRowHeaderState=function(e,t){var i=null;e in this._rowHeaderStates?i=this._rowHeaderStates[e][0]:this._rowHeaderStates[e]=[];var s=this._rowHeaderStates[e],o=n.JsGridUtil.Internal.LowerBoundCompare(s,t.GetPriority(),function(e,t){return t>s[e].GetPriority()});s.splice(o,0,t);null!=i&&s[0].GetId()===i.GetId()||this._intEventMgr.FireEvent(r.JsGridConstants.Internal.EventType.OnRowHeaderStateChanged,n.JsGridUtil.Internal.EventArgs.OnRowHeaderStateChanged(e,s[0]))};e.prototype.RemoveRowHeaderState=function(e,t){if(e in this._rowHeaderStates){var i=this._rowHeaderStates[e][0];this.RemoveLastStateWithId(this._rowHeaderStates[e],t);0==this._rowHeaderStates[e].length&&delete this._rowHeaderStates[e];null!=this._rowHeaderStates[e]&&i.GetId()===this._rowHeaderStates[e][0].GetId()||this._intEventMgr.FireEvent(r.JsGridConstants.Internal.EventType.OnRowHeaderStateChanged,n.JsGridUtil.Internal.EventArgs.OnRowHeaderStateChanged(e,this._rowHeaderStates[e]&&this._rowHeaderStates[e][0]))}};e.prototype.ChangeKeys=function(e,t){if(e in this._rowHeaderStates){this._rowHeaderStates[t]=this._rowHeaderStates[e];delete this._rowHeaderStates[e]}};e.prototype.GetRowHeaderState=function(e){return e in this._rowHeaderStates?this._rowHeaderStates[e][0]:null};e.prototype.RemoveLastStateWithId=function(e,t){for(var n=0;n<e.length;n++)if(e[n].GetId()==t){e.splice(n,1);break}};return e})();t.RowHeaderStateManager=f;var l=(function(){function e(e,t,n,r,i){this.id=e;this.img=t;this.priority=n;this.tooltip=r;this.fnOnClick=i}e.prototype.GetId=function(){return this.id};e.prototype.GetImg=function(){return this.img};e.prototype.GetPriority=function(){return this.priority};e.prototype.GetOnClick=function(){return this.fnOnClick};e.prototype.GetTooltip=function(){return this.tooltip};e.prototype.toString=function(){return this.id};return e})();t.RowHeaderState=l;var c=function(e){this[r.JsGridConstants.RowHeaderStyleId.Transfer]=new l(r.JsGridConstants.RowHeaderStyleId.Transfer,new n.JsGridUtil.ImageWithFabricIcons({spinnerProps:{size:i.SpinnerSize.xSmall,styles:n.JsGridUtil.Internal.IsFeatureEnabled(a)?{circle:{width:14,height:14}}:{}}}),r.JsGridConstants.RowHeaderStatePriorities.Transfer,SP.JsGrid.Res.transferHeaderStateTooltip,null);this[r.JsGridConstants.RowHeaderStyleId.Conflict]=new l(r.JsGridConstants.RowHeaderStyleId.Conflict,new n.JsGridUtil.ImageWithFabricIcons({imgSrc:n.JsGridUtil.Internal.SiteUrl+r.JsGridConstants.ImagesDirectory+"jsgridcluster.png",bIsClustered:!0,optOuterCssNames:"clip16x16",optImgCssNames:"jsgridcluster_conflictheader"}),r.JsGridConstants.RowHeaderStatePriorities.Conflict,e.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.ExpandConflictResolution)?SP.JsGrid.Res.conflictHeaderStateClickTooltip:SP.JsGrid.Res.conflictHeaderStateTooltip,e.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.ExpandConflictResolution)?function(t,n){e.delegateMgr.Apply(r.JsGridConstants.DelegateType.ExpandConflictResolution,t,n)}:null);this[r.JsGridConstants.RowHeaderAutoStyleId.Dirty]=new l(r.JsGridConstants.RowHeaderAutoStyleId.Dirty,new n.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Edit"}}),r.JsGridConstants.RowHeaderStatePriorities.Dirty,SP.JsGrid.Res.editingHeaderStateTooltip,null)};t.RowHeaderStates=c;var h=function(e,t){this.autoRowStates=[[r.JsGridConstants.RowHeaderAutoStyleId.Dirty,function(e){t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnCellEditBegin,function(e){if(0==i){n=e.recordKey;t.jsGridObj.AddRowHeaderState(e.recordKey,s)}i++});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnCellEditCompleted,function(r){r.bCancelled&&i--;0==i&&r.bCancelled&&r.recordKey==n&&t.jsGridObj.RemoveRowHeaderState(n,e)});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,function(r){i>0&&t.jsGridObj.RemoveRowHeaderState(n,e);i=0;n=r.recordKey});var n,i,s=t.rowHeaderStates[r.JsGridConstants.RowHeaderAutoStyleId.Dirty]}],[r.JsGridConstants.RowHeaderAutoStyleId.Error,function(e){var i=document.createElement("span");i.id=e+"mainDiv";i.style.cssText="display:none; font-size:10; position:absolute; background-color:#FFE0E0; border:1px solid #DD3300; padding:5px 10px; color:#333333 !important;";i.style.cssText=i.style.cssText+"z-index: "+s.ZIndexes.ScrollablePane+";";document.body.appendChild(i);var f=null,c=null,h=e+"RowError",p=new l(e,new n.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Error",className:n.JsGridUtil.Internal.IsFeatureEnabled(a)?u.errorIcon:o.spGridErrorIcon}}),r.JsGridConstants.RowHeaderStatePriorities.CellError,SP.JsGrid.Res.errorHeaderStateTooltip,function(e,n){c!==n&&(f=null);f=t.jsGridObj.ScrollToAndExpandNextErrorOnRecord(f,n);c=n}),d=new l(h,new n.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Error",className:n.JsGridUtil.Internal.IsFeatureEnabled(a)?u.errorIcon:o.spGridErrorIcon}}),r.JsGridConstants.RowHeaderStatePriorities.RowError,SP.JsGrid.Res.rowErrorToolTip,function(e,r){if(i.curRecKey!==r){i.curRecKey=r;i.style.display="";n.JsGridUtil.Internal.DomElement.GetInstance().SetText(i,t.jsGridObj.GetRowErrorMessage(r));var s=(function(e){for(;null!=e&&"TD"!==e.tagName.toUpperCase();)e=e.parentNode;return e})(e.target);if(null!=s){var o=n.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(s);i.style.left=o.x+"px";i.style.top=o.y+s.offsetHeight+2+"px"}else{n.JsGridUtil.DebugAssert(!1);i.style.left=e.clientX+5+"px";i.style.top=e.clientY+5+"px"}}else{i.curRecKey=null;i.style.display="none"}});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnCellErrorStateChanged,function(n){n.bAddingError&&!n.bCellHadError?t.jsGridObj.AddRowHeaderState(n.recordKey,p):n.bCellCurrentlyHasError||t.jsGridObj.RemoveRowHeaderState(n.recordKey,e)});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowErrorStateChanged,function(e){e.bAddingError&&!e.bRowHadError?t.jsGridObj.AddRowHeaderState(e.recordKey,d):e.bErrorCurrentlyInRow||t.jsGridObj.RemoveRowHeaderState(e.recordKey,h)});t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,function(e){if(e.newRecordKey!==c){f=null;i.curRecKey=null;i.style.display="none"}});t.intEventMgr.AttachEvent(r.JsGridConstants.Internal.EventType.OnGridDisposing,function(){if(null!=i){i.curRecKey=null;i.innerHTML="";i=null}})}],[r.JsGridConstants.RowHeaderAutoStyleId.NewRow,function(e){var i=null,s=r.JsGridConstants.SUPERTEMPORARY_spcommonThemedData,o=new l(e,new n.JsGridUtil.ImageWithFabricIcons({imgSrc:s,bIsClustered:!0,optOuterCssNames:"clip16x16",optImgCssNames:"ms-addcolumn-icon"}),r.JsGridConstants.RowHeaderStatePriorities.NewRow,"",null);t.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordAdded,function(n){null!=i&&t.jsGridObj.RemoveRowHeaderState(i,e);t.jsGridObj.AddRowHeaderState(n.recordKey,o);i=n.recordKey})}]];var i=n.JsGridUtil.Internal.ConvertTableToMap(this.autoRowStates,0,1);for(var f in i)e.Contains(f)&&(i[f]=new i[f](f));this.autoRowStates=null};t.AutoRowHeaderStates=h});
define("HWe",["require","exports","ww","r","gQe","zqe","Mqe","Lqe","Aqe","Eqe","ou","ODBItemsScopeDeferred_mini_css","zi","$P","DHe","Oqe","Cqe","xqe","Iqe","Zm","k","ga","Ak","q","Dqe","Sqe","wHe","yqe","AWe","mH","pH","vqe","gqe","bqe","hqe","_qe","RWe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B){"use strict";c=c.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var j=w.Killswitch.isActivated("FCBB4612-13ED-47B8-9E17-79F91890AC92","9/26/2019","Translate the title column to linktitle when comparing Grid columns to the additionalColumnSchema"),F=w.Killswitch.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),I=w.Killswitch.isActivated("8DAECEAF-4AEF-45B5-A606-9A3034CC2124","10/18/2019","Use modern taxonomy editor in quick edit."),q=w.Killswitch.isActivated("09F7C55C-78BE-463F-A5CF-BEECB48E874B","11/25/2019","Allow the grid to exist in multiple webparts on a page."),R=w.Killswitch.isActivated("75452fe6-d341-4b80-a203-a947dca04245","10/3/2019","Remove unused strings carried over from classic implementation"),U=w.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),z=w.Killswitch.isActivated("3A4C46AF-0333-42C2-8741-9390170C8DB5","3/2/2020","fix an issue with some strings not loading in the correct language"),W=w.Killswitch.isActivated("734DA0D0-4C39-4582-A547-804B3D63665B","3/4/2020","fix jsgrid on prepsp machines"),X=w.Killswitch.isActivated("9536EDA9-94F6-4F65-BDB6-FAABD3B4565A","4/14/2020","remove extra space around the grid added by default by HTML table elements to allow for sticky header positioned correctly"),V=w.Killswitch.isActivated("C523E9CC-6C6A-4709-BC40-5213BD939FC8","05/05/2020","Unbind all active editors on unmount"),$=w.Killswitch.isActivated("88A27C3C-E6D4-4843-B5E6-453111ABB9E4","07/08/2020","Replace the regular error message caught with the error stack in attempt to get more info on where the error is coming from"),J=w.Killswitch.isActivated("8C3C7769-3285-481A-9808-D802846E1A95","07/13/2020","Remove from Tab order the iframe used for auto-filters setup on column headers"),K=w.Killswitch.isActivated("02C229AA-F1C1-4386-A3C2-A0B6242BA3D1","08/12/2020","Items Scope is perfeclty happy to display duplicate rows, but it blows up quick edit"),Q=w.Killswitch.isActivated("a842d84b-5aab-4456-b273-f2110801d664","8/24/2020","Populate SpRegionalSettings values using props.pageContext"),G={ODB:1746},Y=1725,Z=1553,ee=1757,te=1672,ne=60017,re="https://ajax.aspnetcdn.com/ajax/4.0/1/MicrosoftAjax.js",ie="QuickEdit.InitGrid",se="QuickEdit.InitGanttControl",oe="QuickEdit.UpdateWithRefreshedRows",ue=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._additionColumnSchemaMap={};n.previousPageIds=[];n.currentPageIdx=0;n.didPage=!1;n.gridInitInfo={};n._loadScriptsDependentOnInit=function(){var e=n._pageContextInfo.webAbsoluteUrl+"/",t="1033";n._loadCoreJsScript(function(){if(!R&&n.quickEditPltFlightEnabled){n.LoadClassicStrings();n._loadScriptsDependentOnStrings()}else{z||n._pageContextInfo.currentLanguage&&(t=n._pageContextInfo.currentLanguage.toString());n.LoadExternalJsFile(e+"_layouts/15/"+t+"/sp.res.js");n.LoadExternalJsFile(e+"_layouts/15/"+t+"/strings.js",n._loadScriptsDependentOnStrings);n.LoadExternalJsFile(e+"_layouts/15/"+t+"/sp.jsgrid.res.js")}n.quickEditPltFlightEnabled?_.global_inplview():n.LoadExternalJsFile(e+"_layouts/15/inplview.js");n.quickEditPltFlightEnabled||n.LoadExternalJsFile(e+"_layouts/15/clientrenderer.js");if(I||!n.quickEditPltFlightEnabled){n.LoadExternalJsFile(e+"_layouts/15/sp.runtime.js");n.LoadExternalJsFile(e+"_layouts/15/sp.js");n.LoadExternalJsFile(e+"_layouts/15/sp.init.js");n.LoadExternalJsFile(e+"_layouts/15/mquery.js")}n.LoadExternalJsFile(e+"_layouts/15/sp.ui.dialog.js");n.LoadExternalJsFile(e+"_layouts/15/datepicker.js",function(){n.LoadExternalJsFile(e+"_layouts/15/sp.datetimeutil.js",function(){u.JsGridUtil._gridWaitFullLoadEventKillSwitchIsActive||E.EventGroup.raise(document,S.SPGridEvents.gridGlobalsInitialized)})})})};n._loadCoreJsScript=function(e){var t=n._pageContextInfo.webAbsoluteUrl+"/";if(n.quickEditPltFlightEnabled){D.global_core();e()}else n.LoadExternalJsFile(t+"_layouts/15/core.js",e.bind(n))};n._loadScriptsDependentOnStrings=function(){var e=n._pageContextInfo.webAbsoluteUrl+"/";if(n.quickEditPltFlightEnabled){M.globalClienttemplates();n._loadScriptsDependentOnClientTemplates()}else n.LoadExternalJsFile(e+"_layouts/15/clienttemplates.js",n._loadScriptsDependentOnClientTemplates.bind(n))};n._loadScriptsDependentOnClientTemplates=function(){var e=n._pageContextInfo.webAbsoluteUrl+"/",t="en-US";n.props.pageContext.currentUICultureName&&(t=n.props.pageContext.currentUICultureName.toString());n.LoadExternalJsFile(e+"_layouts/15/ms.rte.js",function(){n.LoadExternalJsFile(e+"_layouts/15/sp.ui.rte.publishing.js",function(){});!I&&n.quickEditPltFlightEnabled||n.LoadExternalJsFile(e+"_layouts/15/sp.taxonomy.js",function(){n.LoadExternalJsFile(e+"_layouts/15/sp.ui.taxonomy.js",function(){n.LoadExternalJsFile(e+"_layouts/15/scriptforwebtaggingui.js",function(){n.LoadExternalJsFile(e+"_layouts/15/ScriptResx.ashx?culture="+t.replace("-","%2D")+"&name=ScriptResources&rev=oRPNQhCzzZsnsjrrXFJTKg%3D%3D:formatted",function(){})})})})})};n._countLoadedJsFiles=function(){n._numLoadedJsFiles++;if(n._numLoadedJsFiles>=n._totalFilesToLoad){F||L.addRumOneMarker("quickEdit.loadExternalFiles.end");n.setState({isLoading:!1})}};n.onScroll=function(){var e=u.JsGridUtil.Internal.GetScrollParent(n.tableRef.current);if(e){n.jsGridControl.objBag.paneMgr.gridPane.UpdatePseudoStickyElementsForScroll(e);var t="StickyColumnShadow";u.JsGridUtil._spClientStickyColumnFixKillSwitchIsActive||(t+=n.jsGridControl.objBag.gridId);var r=document.getElementById(t);if(r)if(0==e.scrollLeft){if("0"!=r.style.opacity){r.style.opacity="0";r.style.visibility="hidden"}}else if("1"!=r.style.opacity){r.style.opacity="1";r.style.visibility=""}}};n.DoPagingBackward=function(e){var t=n.props,r=t.onPaging,i=t.firstRowInGrid;r&&r({firstRowInGrid:i,lastRowInGrid:i?n.rows.length+i-1:n.rows.length,isBackward:!0});return!1};n.DoPaging=function(e){var t=n.props,r=t.onPaging,i=t.firstRowInGrid;r&&r({firstRowInGrid:i,lastRowInGrid:i?n.rows.length+i-1:n.rows.length,isBackward:!1});return!1};n._constructPagingControls=function(){var e=n.props,t=e.firstRowInGrid,i=e.hasNextPage;if(e.onPaging){var s=t>1,o=i||n.rows&&n.props.rows&&n.rows.length<n.props.rows.length;if(s||o){var u=(t||1)+" - "+(t?t+n.rows.length-1:n.rows.length);return r.createElement("div",{className:c.spGridPagingFooter},s&&r.createElement(b.IconButton,{iconProps:{iconName:"ChevronLeft"},onClick:n.DoPagingBackward,title:v.default.previousPageButtonTitle}),r.createElement("span",{className:c.spGridPagingFooterContent},u),o&&r.createElement(b.IconButton,{iconProps:{iconName:"ChevronRight"},onClick:n.DoPaging,title:v.default.nextPageButtonTitle}))}}};n.onUndoRealCmdCountChange=function(e){if(n.props.getEventSource){var t=n.props.getEventSource();E.EventGroup.raise(t,S.SPGridEvents.undoRealCmdCountChangeEventName,{undoRealCmdCount:e})}};n.onRedoRealCmdCountChange=function(e){if(n.props.getEventSource){var t=n.props.getEventSource();E.EventGroup.raise(t,S.SPGridEvents.redoRealCmdCountChangeEventName,{redoRealCmdCount:e})}};n.itemResponse=JSON.parse(n.props.itemResponseJsonString);n.listData=n.itemResponse.ListData;n.listSchema=n.itemResponse.ListSchema;if(K)n.rows=t.rows;else{n.rows=[];n.TranscribeRows(t.rows)}n._additionalColumnSchema=t.additionalColumnSchema;n._customFormatterProps=t.customFormatterProps;n._telemetry=t.telemetry;n._portalManager=t.portalManager;n._baseEngagementData=t.baseEngagementData;n._events=new E.EventGroup(n);n.getColumnWidthsFromLocalStorage=t.getColumnWidthsFromLocalStorage;n.quickEditPltFlightEnabled=t.flightStatus[G.ODB];n._totalFilesToLoad=n._getTotalFilesToLoad();n._numLoadedJsFiles=0;n.tableRef=r.createRef();if(q)u.JsGridUtil.privateWpq="WPQ1";else{var i=document.getElementsByClassName("quickEditParentDiv");u.JsGridUtil.privateWpq="WPQ"+(i.length+1).toString();if(!u.JsGridUtil._uniqueGridIdKillSwitchIsActive){n._gridId="WPQ"+u.JsGridUtil.gridIdCounter;u.JsGridUtil.gridIdCounter++}}n.dragDropMgr=new N.ColumnDragDropManager({telemetry:n._telemetry,baseEngagementData:n._baseEngagementData,events:n._events,onColumnChangeSucceeded:t.onColumnChangeSucceeded});if(n._additionalColumnSchema)for(var s=0,o=n._additionalColumnSchema;s<o.length;s++){var a=o[s];n._additionColumnSchemaMap[a.internalName]=a}n.props.pageContext?n._pageContextInfo=n.props.pageContext:n.itemResponse.PageContextInfo?n._pageContextInfo=JSON.parse(n.itemResponse.PageContextInfo):console.log("WARNING!! No page context!");u.JsGridUtil._gridutilPageContextKillswitchIsActive||(u.JsGridUtil.PageContext=n._pageContextInfo);if(!Q&&n._pageContextInfo){u.JsGridUtil.SpRegionalSettings.localeId=n._pageContextInfo.currentCultureLCID;u.JsGridUtil.SpRegionalSettings.calendarType=n._pageContextInfo.CalendarType;u.JsGridUtil.SpRegionalSettings.firstDayOfWeek=null!=n._pageContextInfo.userFirstDayOfWeek?n._pageContextInfo.userFirstDayOfWeek:n._pageContextInfo.webFirstDayOfWeek;u.JsGridUtil.SpRegionalSettings.time24=null!=n._pageContextInfo.userTime24?n._pageContextInfo.userTime24:n._pageContextInfo.webTime24}if(t.gridInitInfo){n.gridInitInfo.controllerId=t.gridInitInfo.ControllerId;n.gridInitInfo.jsInitObj=JSON.parse(t.gridInitInfo.JsInitObj);n.viewId=n.gridInitInfo.jsInitObj.viewId;n.itemResponse&&n.itemResponse.rootFolder&&(n.gridInitInfo.jsInitObj.viewRootFolder=n.itemResponse.rootFolder);n.gridInitInfo.gridSerializer=t.gridInitInfo.GridSerializer;n.gridInitInfo.jsInitObj.iframeId="spgridIframeId";n.gridInitInfo.jsInitObj.flightStatus=n.props.flightStatus}n.setColumnWidthsToLocalStorage=function(e,r){var i=n.viewId.substring(1,n.viewId.length-1);t.setColumnWidthsToLocalStorage(i,e,r)};n.itemResponse.ListData.Row&&n.itemResponse.ListData.Row[0]&&n._addPageId(n.itemResponse.ListData.Row[0].ID);n.state={isLoading:n._shouldWaitLoadExternalJsFiles()};return n}t.prototype.TranscribeRows=function(e){for(var t=0;t<e.length;t++){for(var n=!1,r=0;r<t;r++)e[t].ID===e[r].ID&&(n=!0);n||this.rows.push(e[t])}};t.prototype._startGridLoadSequence=function(){var e=this,t=this.props.flightStatus,n=this._pageContextInfo.webAbsoluteUrl+"/",r="1033";z?this.props.pageContext.currentLanguage&&(r=this.props.pageContext.currentLanguage.toString()):this._pageContextInfo.currentLanguage&&(r=this._pageContextInfo.currentLanguage.toString());F||L.addRumOneMarker("quickEdit.loadExternalFiles.start");t[Y]&&!U||this.LoadExternalCssFile(n+"_layouts/15/styles/Themable/jsgrid.css","jsgridcss");!I&&this.quickEditPltFlightEnabled||this.LoadExternalCssFile(n+"_layouts/15/"+r+"/styles/WebTaggingUI.css","taxonomycss");this.GetRegionalSettings(this.props.pageContext.webServerRelativeUrl,null);this.LoadExternalJsFile(re,function(){e.LoadExternalJsFile("https://ajax.aspnetcdn.com/ajax/4.0/1/MicrosoftAjaxWebForms.js",function(){if(e.quickEditPltFlightEnabled){P.globalInit();e._loadScriptsDependentOnInit()}else e.LoadExternalJsFile(n+"_layouts/15/init.js",e._loadScriptsDependentOnInit.bind(e))})})};t.prototype.LoadClassicStrings=function(){window.Strings=window.Strings||{STS:y.default};window.Strings.STS=y.default;window.Strings.STS.L_RelativeDateTime_Format_DateTimeFormattingString_Override="";window.SP=window.SP||{};window.SP.Res=window.SP.Res||m.default;window.SP.JsGrid=window.SP.JsGrid||{Res:g.default,Image:{},Utility:{},PropertyType:{}};window.SP.JsGrid.Res=window.SP.JsGrid.Res||g.default};t.prototype._startInitSequence=function(){var e=this;F||L.addRumOneMarker("quickEdit.serialization.start");var t=u.JsGridUtil._uniqueGridIdKillSwitchIsActive?u.JsGridUtil.privateWpq:this._gridId,n=document.getElementById("spgridcontainer_"+t);if(n&&0===n.childElementCount){this._registerGlobals();window.modernJsGrid=this;PageMinimized.minimized=!0;this.gridInitInfo&&this.gridInitInfo.jsInitObj&&this.gridInitInfo.jsInitObj.viewId&&(window.g_SPGridInitInfo[this.gridInitInfo.jsInitObj.viewId]=this.gridInitInfo);u.JsGridUtil.Internal.SiteUrl=this.gridInitInfo.jsInitObj.siteUrl;var r={crsAjaxRefresh:!0,currentCtx:this.itemResponse};r.currentCtx.enteringGridMode=!0;r.currentCtx.wpq=u.JsGridUtil._uniqueGridIdKillSwitchIsActive?u.JsGridUtil.privateWpq:this._gridId;var i={Fields:{}},s=void 0;s=this.quickEditPltFlightEnabled?M.RenderFieldValueDefault:window.RenderFieldValueDefault;for(var o=0;o<this.listSchema.Field.length;o++){var a=this.listSchema.Field[o];if("LinkTitle"===a.Name){a.Name=a.StaticName="Title";a.Type=a.FieldType=a.role="Text"}i.Fields[a.Name]=s}r.currentCtx.Templates=i;var f=window.CLVPFromEventReal(r);this.oldReRenderListView=window.ReRenderListView;window.ReRenderListView=this.CatchContext.bind(this);window.CLVPRefreshPagingEx.bind(f)("?",!0,null,void 0,void 0);this.props.getAuthToken(this._pageContextInfo.webAbsoluteUrl).then(function(t){e._setAuthToken(t)});this.quickEditPltFlightEnabled||(GetThemedImageUrl=u.JsGridUtil.Internal.GetImageUrl);this.InitGrid()}};t.prototype._registerGlobals=function(){if(this.quickEditPltFlightEnabled){window.ReRenderListView=_.ReRenderListView;window.CLVPRefreshPagingEx=_.CLVPRefreshPagingEx;window.CLVPFromEventReal=_.CLVPFromEventReal;window.g_fAnimateListCSR=!1;SP&&SP.UI&&!SP.UI.Notify&&(SP.UI.Notify={addNotification:window.addNotification})}SP&&SP.JsGrid&&(SP.JsGrid.Image=u.JsGridUtil.Image);if(SP&&SP.JsGrid&&!SP.JsGrid.Utility){SP.JsGrid.Utility={};SP.JsGrid.Utility.IsChar=u.JsGridUtil.Utility.IsChar}this.quickEditPltFlightEnabled&&SP&&!SP.ScriptUtility&&(SP.ScriptUtility={isNullOrEmptyString:k.Taxonomy.Utility.isNullOrEmpty,isNullOrUndefined:k.Taxonomy.Utility.isNullOrUndefined,isUndefined:k.Taxonomy.Utility.isUndefined});this.quickEditPltFlightEnabled&&SP&&!SP.Utilities&&(SP.Utilities={});SP&&SP.Utilities&&(SP.Utilities.Range=a.Range);SP&&SP.JsGrid&&(SP.JsGrid.PropertyType={Utils:{RegisterEditControl:f.PropertyType.Utils.RegisterEditControl,RegisterWidgetControl:f.PropertyType.Utils.RegisterWidgetControl},RegisterNewCustomPropType:f.PropertyType.RegisterNewCustomPropType});var e=document.getElementById("__REQUESTDIGEST");if(!e){(e=document.createElement("INPUT")).id="__REQUESTDIGEST";e.name="__REQUESTDIGEST";e.type="hidden";e.value=this.props.pageContext.formDigestValue;document.body.appendChild(e)}!W&&SP&&SP.JsGrid&&(SP.JsGrid.DisplayControl={Type:{Image:"DISP_IMAGE",ImageText:"DISP_IMAGETEXT",Text:"DISP_TEXT",Checkbox:"DISP_CHECKBOX",Hierarchy:"DISP_HIERARCHY",RecordIndicatorCheckbox:"DISP_RECORDINDICATORCHECKBOX",CSR:"DISP_CSR",User:"DISP_USER"}});M.InitListViewFlightSettings()};t.prototype._switchLayout=function(e){if(this.props.flightStatus[Y]&&this.props.flightStatus[Z]){var t=e.viewType;this.gridInitInfo.jsInitObj.spCsrRenderCtx.fixedHeightRowEnabled="GRIDFIXED"===t;this.jsGridControl.RefreshAllRows(0,void 0)}};t.prototype.InitFromRenderContext=function(e){this.setState({isLoading:!0});this.listData=e.ListData;this.rows=e.ListData.Row;this.CatchContext(e);this.listSchema=e.ListSchema;if(this.didPage){this._addPageId(e.CurrentItem.ID);this.didPage=!1}this._startGridLoadSequence()};t.prototype._setAuthToken=function(e){var t=this;if(e){this._authToken="Bearer "+e;var n=this._authToken,r=SP.ClientRuntimeContext.prototype.onExecutingWebRequest;this._oldOnExecuting=SP.ClientRuntimeContext.prototype.onExecutingWebRequest;console.log(this._authToken+this._oldOnExecuting);SP.ClientRuntimeContext.prototype.onExecutingWebRequest=function(e){var i=r.bind(t);e.get_webRequest()._headers.Authorization=n;i(e)}}};t.prototype.CatchContext=function(e){this.renderCtx=e;window.ReRenderListView=this.oldReRenderListView;if(!this.quickEditPltFlightEnabled){g_ctxDict["{"+this.viewId.toUpperCase()+"}"]=e;g_ctxDict["ctx"+e.ctxId]=e}window["ctx"+e.ctxId]=e;currentCtx=e};t.prototype.LoadExternalCssFile=function(e,t){var n=document.getElementsByTagName("head")[0],r=document.createElement("link");r.id=t;r.rel="stylesheet";r.type="text/css";r.href=e;r.media="all";n.appendChild(r)};t.prototype._getTotalFilesToLoad=function(){var e=23;if(this.quickEditPltFlightEnabled){I||(e-=8);R||(e-=3);e-=2;e-=1;e-=1;e-=1}return e};t.prototype.LoadExternalJsFile=function(e,t){u.JsGridUtil.injectJsScript(e,this._countLoadedJsFiles.bind(this),t)};t.prototype.GetRegionalSettings=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState){console.log(n.responseText);if(n.responseText){var e=JSON.parse(n.responseText);if(e.value){var t=JSON.parse(e.value);u.JsGridUtil.SpRegionalSettings.adjustHijriDays=t.HijriAdjustment;u.JsGridUtil.SpRegionalSettings.calendarType=t.CalendarType;u.JsGridUtil.SpRegionalSettings.currentDateInLocalCalendar=new Date;u.JsGridUtil.SpRegionalSettings.firstDayOfWeek=t.FirstDayOfWeek;u.JsGridUtil.SpRegionalSettings.firstWeekOfYear=t.FirstWeekOfYear;u.JsGridUtil.SpRegionalSettings.localeId=t.LocaleId;u.JsGridUtil.SpRegionalSettings.showWeeks=t.ShowWeekNumber;u.JsGridUtil.SpRegionalSettings.time24=t.HoursMode24;u.JsGridUtil.SpRegionalSettings.timeZone=t.TimeZoneDifference;u.JsGridUtil.SpRegionalSettings.timeZoneInHours=parseInt(t.TimeZoneDifference);u.JsGridUtil.SpRegionalSettings.workDays=t.WorkWeek;window._spRegionalSettings=u.JsGridUtil.SpRegionalSettings}}}};var r=(e+"/_api/web/GetRegionalDateTimeSchema").replace(/\/\//g,"/");n.open("POST",r,!0);n.setRequestHeader("Content-Type","application/json;charset=utf-8");n.setRequestHeader("ACCEPT","application/json; odata.metadata=minimal");this._pageContextInfo.formDigestValue&&n.setRequestHeader("x-requestdigest",this._pageContextInfo.formDigestValue);n.setRequestHeader("ODATA-VERSION","4.0");n.send(t?JSON.stringify(t):void 0)};t.prototype.InitGrid=function(){var e,t=this,r=new(this._telemetry(x.Qos))({name:ie}),a=this.gridInitInfo,f=u.JsGridUtil._uniqueGridIdKillSwitchIsActive?u.JsGridUtil.privateWpq:this._gridId,l=document.getElementById("spgridcontainer_"+f);if(l){try{this.gridJson=i.DeserializeFromJson(a.gridSerializer)}catch(e){var c=H.getErrorMessage(e);r.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToDeserializeFromJsonString",error:c});console.log("SPGrid FailToDeserializeFromJsonString: "+c);return}try{if(this._additionalColumnSchema&&this._additionalColumnSchema.length&&this._additionColumnSchemaMap&&this.gridJson.Columns)for(var v=0,m=this.gridJson.Columns;v<m.length;v++){var g=m[v];if(j){if(y=this._additionColumnSchemaMap[g.columnKey]){g.customFormatter=y.customFormatter;g.isFilterable=y.filterable;g.ascendingString=y.ascendingString;g.descendingString=y.descendingString;g.fieldType=y.fieldType;g.internalName=y.internalName;g.isEditable=y.isEditable;g.isCalculated=y.isCalculated}}else{var y,b=u.JsGridUtil.Internal.normalizeColumnKey(g.columnKey);if(y=this._additionColumnSchemaMap[b]){g.customFormatter=y.customFormatter;g.isFilterable=y.filterable;g.ascendingString=y.ascendingString;g.descendingString=y.descendingString;g.fieldType=y.fieldType;g.internalName=y.internalName;g.isEditable=y.isEditable;g.isCalculated=y.isCalculated}}if("LinkTitle"===g.fieldKey){g.fieldKey=g.columnKey=g.internalName="Title";g.fieldKeys=["Title"];g.isEditable=!0;g.fieldType="Text"}}if(this.gridJson&&this.gridJson.Fields)for(var w=0,E=this.gridJson.Fields;w<E.length;w++){var N=E[w];if("LinkTitle"===N.fieldKey){N.fieldKey="Title";N.editMode=T.JsGridConstants.EditMode.ReadWriteDefer;break}}if(this.viewId&&this.gridJson.Columns)for(var k=this.viewId.substring(1,this.viewId.length-1),M=this.viewId&&this.getColumnWidthsFromLocalStorage(k)||{},_=this.viewId&&this.getColumnWidthsFromLocalStorage(k,!0)||{},D=0,P=this.gridJson.Columns;D<P.length;D++){var B=(g=P[D]).name,I=parseInt(_[B],10)||parseInt(M[B],10);I&&(g.width=I+T.JsGridConstants.Internal.ColumnWidthOffset)}if(u.JsGridUtil.Internal.IsStickyColumnFlightEnabled()){this.gridJson.Columns.length&&"DocIcon"===this.gridJson.Columns[0].internalName?u.JsGridUtil.Internal.stickyLastColIdx=1:u.JsGridUtil.Internal.stickyLastColIdx=0;u.JsGridUtil.Internal.GetStickyDataColumnsWidth(this.gridJson.Columns)+u.JsGridUtil.Internal.stickyLeftEdgeOffset>u.JsGridUtil.Internal.GetScrollParent(this.tableRef.current).clientWidth/2?u.JsGridUtil.Internal.noSizeForSticky=!0:u.JsGridUtil.Internal.noSizeForSticky=!1}if(!F){L.addRumOneMarker("quickEdit.serialization.end");L.addRumOneMarker("quickEdit.gridrender.start")}this.callback=function(e){var r,i=t.jsGridControl=new s.JsGridControl(l,a.showLoading,{setColumnWidthsToLocalStorage:t.setColumnWidthsToLocalStorage.bind(t),dragDropMgr:t.dragDropMgr,onSelectionChanged:t.props.onSelectionChanged});a.jsInitObj.spCsrRenderCtx=t.renderCtx;a.jsInitObj.spCsrRenderCtx.queryString="";a.jsInitObj.peoplePickerDataSource=new p.PeoplePickerDataSource({},{pageContext:t._pageContextInfo,getAuthToken:t.props.getAuthToken});a.jsInitObj.locationDataSource=new d.LocationDataSource({pageContext:t._pageContextInfo});a.jsInitObj.taxonomyPickerDataSource=new C.TaxonomyDataSource(t._pageContextInfo);a.jsInitObj.pageContext=t._pageContextInfo;a.jsInitObj.customFormatterProps=t._customFormatterProps;a.jsInitObj.telemetry=t._telemetry;a.jsInitObj.portalManager=t._portalManager;a.jsInitObj.onLaunchFilterPanel=t.props.onLaunchFilterPanel;a.jsInitObj.onSort=t.props.onSort;a.jsInitObj.launchColumnCustomization=t.props.launchColumnCustomization;a.jsInitObj.launchColumnsEditor=t.props.launchColumnsEditor;a.jsInitObj.onLaunchColumnManagementPanel=t.props.onLaunchColumnManagementPanel;a.jsInitObj.baseEngagementData=t._baseEngagementData;a.jsInitObj.onColumnChangeSucceeded=t.props.onColumnChangeSucceeded;a.jsInitObj.onPinToFiltersPane=t.props.onPinToFiltersPane;a.jsInitObj.onUndoRealCmdCountChange=t.onUndoRealCmdCountChange;a.jsInitObj.onRedoRealCmdCountChange=t.onRedoRealCmdCountChange;a.jsInitObj.gridId=t._gridId;t.props.flightStatus[Y]&&t.props.flightStatus[Z]&&"GRIDFIXED"===t.props.gridLayoutType&&(a.jsInitObj.spCsrRenderCtx.fixedHeightRowEnabled=!0);var f=new(t._telemetry(x.Qos))({name:se});try{var c=t.ganttControl=new o.GanttControl(t._telemetry,t._pageContextInfo.aadUserId);window[a.controllerId]=c;window[a.controllerId].Init(i,e,a.jsInitObj,a.pagingInfo);t.dragDropMgr.setGanttControl(c);t.dragDropMgr.setPaneManager(i._GetPaneManager());if(t.props.getEventSource){var v=t.props.getEventSource();t._events.on(v,S.SPGridEvents.startExitingQuickEditEventName,function(){c.TryDispose(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){this.props.completeExitingQuickEditSignal&&this.props.completeExitingQuickEditSignal.resolve();window[a.controllerId]=null;return[2]})})})});t._events.on(v,S.SPGridEvents.switchGridLayout,t._switchLayout);t._events.on(v,S.SPGridEvents.deleteCompletedEventName,function(e){e&&e.itemIds&&e.itemIds.length&&i.DeleteRecords(e.itemIds,null)});t._events.on(v,S.SPGridEvents.undoChangeEventName,function(){i.objBag.eventMgr.FireEvent(S.SPGridEvents.undoChangeEventName)});t._events.on(v,S.SPGridEvents.redoChangeEventName,function(){i.objBag.eventMgr.FireEvent(S.SPGridEvents.redoChangeEventName)});t._events.on(v,O.FiltersPaneEvents.showInFiltersPaneChanged,function(e){var t=e.fieldName,n=e.showInFiltersPane,r="LinkTitle"===t?"Title":t;u.JsGridUtil.Internal.getColumnFromListSchema(i,r).ShowInFiltersPane=A.ShowInFiltersPaneStatus[n]})}f.end({resultType:x.ResultTypeEnum.Success})}catch(e){var m=H.getErrorMessage(e);$||(m=(null===(r=e)||void 0===r?void 0:r.stack)||m);f.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToInitGanttControl",error:m});console.log("SPGrid FailToInitGanttControl: "+m)}window.setTimeout(function(){i.Focus()},0);if(null!=a.selectedRows&&1!=a.selectedRows.length||t._pageContextInfo.listBaseTemplate!==h.default.tasksWithTimelineAndHierarchy){if(null!=a.selectedRows)for(var g=0;g<a.selectedRows.length;g++)i.SelectRowRangeByKey(a.selectedRows[g],a.selectedRows[g],0!==g)}else{var y=null==a.selectedRows?i.GetTopRecordIndex():i.GetViewIndexOfRecord(a.selectedRows[0]),b=i.GetColumns();b.length>1&&"Checkmark"==b[0].columnKey?i.SelectCellRange(y,y,1,1,!1):i.SelectRowRange(y,y,!1)}if(t.props.selectedItemIds)for(g=0;g<t.props.selectedItemIds.length;g++)i.SelectRowRangeByKey(t.props.selectedItemIds[g],t.props.selectedItemIds[g],0!==g);g_fAnimateListCSR=!1;null!=a.fnCallback&&a.fnCallback(window[a.controllerId]);if(u.JsGridUtil.Internal.IsStickyColumnEnabled()){u.JsGridUtil.Internal.GetScrollParent(t.tableRef.current).addEventListener("scroll",t.onScroll)}window.setTimeout(function(){F||L.addRumOneMarker("quickEdit.gridrender.end");t.PostRenderAfterJSGridRender(t.renderCtx);if(!F){L.addRumOneMarker("quickEdit.plt.end");L.writeRumOneData()}},0)};this.TranslateCSRtoJsGrid(this.listData,this.rows,this.gridJson,this.listSchema,this.renderCtx);this.callback(this.gridJson);r.end({resultType:x.ResultTypeEnum.Success})}catch(t){c=H.getErrorMessage(t);$||(c=(null===(e=t)||void 0===e?void 0:e.stack)||c);r.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToInitGrid",error:c});console.log("SPGrid FailToInitGrid: "+c)}}else r.end({resultType:x.ResultTypeEnum.Failure,resultCode:"MissingContainerElement",error:"Cannot init grid due to missing container element."})};t.prototype.PostRenderAfterJSGridRender=function(e){e.enteringGridMode=!1;this.quickEditPltFlightEnabled?M.SPClientRenderer._ExecuteRenderCallbacks(e,"OnPostRender"):window.SPClientRenderer._ExecuteRenderCallbacks(e,"OnPostRender")};t.prototype._shouldWaitLoadExternalJsFiles=function(){return!document.getElementById(re)};t.prototype.componentDidMount=function(){this._shouldWaitLoadExternalJsFiles()?this._startGridLoadSequence():u.JsGridUtil._gridWaitFullLoadEventKillSwitchIsActive||window.g_strDatePickerRangeValidatorID?this._startInitSequence():this._events.on(document,S.SPGridEvents.gridGlobalsInitialized,this._startInitSequence);this.dragDropMgr.subscribe()};t.prototype.shouldComponentUpdate=function(e,t){this.props.flightStatus[te]&&this.handleCustomFormatter(e);return t!==this.state||e.refreshedRows!==this.props.refreshedRows};t.prototype.componentDidUpdate=function(e,t){t.isLoading&&!this.state.isLoading?this._startInitSequence():e.refreshedRows!==this.props.refreshedRows&&this.updateWithRefreshedRows();this.dragDropMgr.subscribe()};t.prototype.componentWillUnmount=function(){if(V){this._events.dispose();this.dragDropMgr.dispose();if(u.JsGridUtil.Internal.IsStickyColumnEnabled()){u.JsGridUtil.Internal.GetScrollParent(this.tableRef.current).removeEventListener("scroll",this.onScroll)}}else try{this.ganttControl&&this.ganttControl._jsGridControl&&this.ganttControl._jsGridControl._GetPaneManager().editMgr.unBindEditors();this._events.dispose();this.dragDropMgr.dispose();if(u.JsGridUtil.Internal.IsStickyColumnEnabled()){u.JsGridUtil.Internal.GetScrollParent(this.tableRef.current).removeEventListener("scroll",this.onScroll)}}catch(e){}};t.prototype.TranslateCSRtoJsGrid=function(e,t,n,r,i){var s,o,a,f,l,c,h,p,d=this,v={},m={},g=r.Field,y=g.length,b={},w=n.Fields,E=w.length,S=null,x=t.length,T=0,N=[],C=0,k=null,L=null,A=null,O=null,_=null,D=null,P=null,H=0,B=null==i;function j(t,r){if("string"==typeof e[r])if("?"==e[r].substring(0,1))n.AdditionalParams[t]=e[r].substring(1);else{var i=e[r].split("?");n.AdditionalParams[t]=i[1]}else n.AdditionalParams[t]=null}j("prevHref","PrevHref");j("nextHref","NextHref");function F(t,r){if("string"==typeof e[r])n.AdditionalParams[t]=Number(e[r]);else if("number"==typeof e[r])n.AdditionalParams[t]=e[r];else{u.JsGridUtil.DebugAssert(null==e[r]);n.AdditionalParams[t]=null}}F("first","FirstRow");F("last","LastRow");if("string"==typeof r.group1){C=1;L=r.group1;_=n.MetaData.GroupingPrefix;P=[];if("string"==typeof r.group2){C=2;A=r.group2}n.MetaData.GroupingLevel=C;O=n.MetaData.GridOperationalConstantsFieldKeyMap[0]=n.Columns[0].fieldKey;delete n.RecordCount;delete n.TopRecord}for(o=0;o<E;o++){"SPUser"!=w[o].propertyTypeId&&"SPUser_MultiValue"!=w[o].propertyTypeId&&"Location"!=w[o].propertyTypeId||(w[o].hasDataValue=!0);b[(a=w[o]).fieldKey]=a}for(o=0;o<y;o++)m[(a=g[o]).RealFieldName]=a;if(x>0){for(o=0,l=null;o<x&&(null==l||Boolean(l["CustomData."]));o++)l=t[o];for(s in l){h=this.TranslateCSRtoJsGridFieldName(s,m[s]);v[s]=h;null!=m[s]&&(v[m[s].Name]=h)}if("string"==typeof e.FilterLink){u.JsGridUtil.DebugAssert("?"==e.FilterLink.substring(0,1));var I=e.FilterLink.substring(1),q=new u.JsGridUtil.Internal.List_QstringStruct(I),R={};for(var U in q.filterParams){var z=q.filterParams[U],W=null,X=null;if(null!=z.FilterField){u.JsGridUtil.DebugAssert(null!=z.FilterValue);W=z.FilterField;X=z.FilterValue}else{u.JsGridUtil.DebugAssert(null!=z.FilterFields);u.JsGridUtil.DebugAssert(null!=z.FilterValues);W=z.FilterFields;X=z.FilterValues}W=v[u.JsGridUtil.Internal.UnescapeProperly(W)];X=u.JsGridUtil.Internal.UnescapeProperly(X);u.JsGridUtil.DebugAssert(null!=W);null!=W&&(R[W]=X)}n.AutoFilterState=R}}if(Boolean(e.SortField)){var V=v[e.SortField];null==V&&(V=e.SortField);n.SortState=[{fieldKey:V,isDescending:"ascending"!=e.SortDir}]}n.LocalizedTable=[];n.UnlocalizedTable=[];for(o=0;o<x;o++){l=t[o];if(Boolean(l["CustomData."]))T++;else{H++;if(C>0){var $=function(e,t,n){return _+l[e+".groupindex"+(2==n?"2":"")]+"_"+t},J=function(e,t){var r;if(B){r=e+": "+String(l[e]);if(1==t)D=_+" "+e+":"+String(l[e]);else{u.JsGridUtil.DebugAssert(2==t);D=_+" "+L+":"+String(l[L])+" "+A+":"+String(l[A])}}else{var s=document.createElement("div");if(1==t)d.quickEditPltFlightEnabled?s.innerHTML=M.RenderGroupEx(i,l,!0):s.innerHTML=window.RenderGroupEx(i,l,!0);else{u.JsGridUtil.DebugAssert(2==t);var o=l[L+".newgroup"];l[L+".newgroup"]="0";d.quickEditPltFlightEnabled?s.innerHTML=M.RenderGroup(i,l):s.innerHTML=window.RenderGroup(i,l);l[L+".newgroup"]=o}r=u.JsGridUtil.Internal.GetInnerText(s);if(1==t)D=$(e,r,1);else{u.JsGridUtil.DebugAssert(2==t);D=$(L,r,1)+" "+$(A,r,2)}}u.JsGridUtil.DebugAssert(-1==P.indexOf(D));f={};p={ID:D,_GRPDESC:Number(l[e+".COUNT.group"+(2==t?"2":"")])};2==C&&(p._GRPLVL=t);if(2==t){u.JsGridUtil.DebugAssert(null!=k);k._GRPDESC++}else k=p;p[O]=f[O]=r;n.LocalizedTable.push(f);n.UnlocalizedTable.push(p);P.push(D);N.push(D)};"1"==l[L+".newgroup"]&&J(L,1);"1"==l[A+".newgroup"]&&J(A,2)}f={};p={};N.push(this.TranslateCSRtoJsGridField("ID",m.ID,l,b.ID).value);for(s in l){var K=m[s],Q=null==K?null:v[K.Name];S=null==Q?null:b[Q];if(null!=(c=this.TranslateCSRtoJsGridField(s,K,l,S))&&null!=(a=b[h=v[s]])){if(a.hasLocalizedValue){u.JsGridUtil.DebugAssert(null!=c.localizedValue);f[h]=c.localizedValue}if(a.hasDataValue||C>0&&"Title"==h){u.JsGridUtil.DebugAssert(null!=c.value);p[h]=c.value}}}B||(p.csrInfo=l);n.LocalizedTable.push(f);n.UnlocalizedTable.push(p)}}if(!B)for(o=0;o<n.Fields.length;o++)(S=n.Fields[o]).csrInfo=m[S.fieldKey];n.ViewInfo=N;C>0?n.ViewDepKeys=P:n.RecordCount=H;n.AdditionalParams.last-=T};t.prototype.handleCustomFormatter=function(e){var t=this,n=!1;if(this.jsGridControl){var r=this.jsGridControl._GetPaneManager(),i=r&&r.gridPane;if(i&&i.tableMgr)for(var s=0,o=i.tableMgr.columns;s<o.length;s++)for(var a=o[s],f=0,l=e.additionalColumnSchema;f<l.length;f++){var c=l[f];if(c.internalName===u.JsGridUtil.Internal.normalizeColumnKey(a.columnKey,!0)&&c.customFormatter!==a.customFormatter){a.customFormatter=c.customFormatter;n=!0;c.customFormatter?a.fnGetDisplayControlName=function(){return B.DisplayControlType.CustomFormatter}:this.jsGridControl.objBag.jsGridParams.bRecordIndicatorCheckboxesEnabled?a.fnGetDisplayControlName=function(){return t.jsGridControl.objBag.gridControls[T.JsGridConstants.RecordIndicatorControlId].Id}:a.fnGetDisplayControlName=void 0;break}}var h=e.customFormatterProps,p=this.props.customFormatterProps;if(p&&h&&p.additionalRowClass!==h.additionalRowClass){this.jsGridControl.objBag.jsGridParams.customFormatterProps.additionalRowClass=e.customFormatterProps.additionalRowClass;n=!0}n&&this.jsGridControl.RefreshAllRows(0,void 0)}};t.prototype.TranslateCSRtoJsGridFieldName=function(e,t){switch(null!=t?t.FieldType:e){case"ContentTypeId":return"_ContentTypeId";case"File_x0020_Type":return"DocIcon";case"PermMask":return"Edit"}return null!=t&&"string"==typeof t.RealFieldName?t.RealFieldName:e};t.prototype.TranslateCSRtoJsGridField=function(e,t,n,r){var i,s=n[e];if(null!=r&&("SPMultilineText"==r.propertyTypeId||"String"==r.propertyTypeId||"SPTextMaxLength"==r.propertyTypeId)){u.JsGridUtil.Internal.IsNullOrUndefined(s)||u.JsGridUtil.DebugAssert("string"==typeof s||s.constructor==String);s=u.JsGridUtil.Internal.Encoding_STSHtmlDecode(s)}var o=null!=t?t.FieldType:e;if(null==s)return null;if(null==o)return null;switch(o){case"Boolean":return null==s||""==s?null:new ae(n[e+".value"],s);case"Computed":if("FileLeafRef"==e){u.JsGridUtil.Internal.EnsureFileLeafRefName(n);return new ae(null,n["FileLeafRef.Name"])}if("Hyperlink"==t.Format)return y(e,s,n);break;case"File_x0020_Type":return""==s?null:new ae(null,s);case"ID":return new ae(Number(s),String(s));case"Lookup":case"LookupMulti":if(""==s)return null;if("string"==typeof s)return new ae(s);var a=s,f=[];s=null;for(i=0;i<a.length;i++){var l=a[i],c=l.lookupId,h=l.lookupValue;if("Lookup"==o)return new ae(c,h);s=null==s?h:s+"; "+h;f.push(c)}return new ae(f,s);case"MultiChoice":return Array.isArray(s)?new ae(s.join("; ")):new ae("");case"PermMask":var p=0|parseInt(s.substring(s.length-8),16);n.Edit=p;return new ae(p);case"URL":return y(e,s,n);case"User":case"UserMulti":var d=n[e];s=[];var v="";for(i=0;i<d.length;i++){var m=d[i];v=""==v?m.title:v+"; "+m.title;s.push(b(m))}return new ae(s,v);case"TaxonomyFieldType":case"TaxonomyFieldTypeMulti":var g=k.Taxonomy.DataConverters.DataValueToInputValue(s,"TaxonomyFieldTypeMulti"==o);return new ae(s,g);case"Location":return new ae(s,s?s.DisplayName:"")}return null==s||""==s?null:new ae(s);function y(e,t,n){if(null==t||""==t)return null;var r=t,i=n[e+".desc"];return new ae({display:i,address:r})}function b(e){if(null==e||""==e)return null;u.JsGridUtil.DebugAssert("email"in e&&"title"in e,"caller did not pass in the right user object");return{display:e.title,email:e.email}}};t.prototype._addPageId=function(e){this.previousPageIds[this.currentPageIdx]=e};t.prototype.render=function(){for(var e=[],t=0;t<this.listSchema.Field.length;t++)e.push(r.createElement("th",{scope:"col",title:"",role:"presentation"},r.createElement("span",null)));this.dragDropMgr.subscribe();var i=this.props.flightStatus[ee]&&!X,s=this.props.flightStatus[ne],o=s?c.gridParentFocusable:"",a=i?c.wrapperTable:"",f=i?c.wrapperTd:"",h={};J||(h.tabIndex=-1);var p=u.JsGridUtil._uniqueGridIdKillSwitchIsActive?u.JsGridUtil.privateWpq:this._gridId;return this.state.isLoading?r.createElement(l.Spinner,{size:l.SpinnerSize.large}):r.createElement("div",{className:c.spGridRoot},r.createElement("iframe",n.__assign({id:"spgridIframeId",title:"","aria-hidden":"true",style:{offsetLeft:"-550px",offsetTop:"-550px",display:"block",width:0,height:0,frameborder:0}},h)," "),r.createElement("table",{className:a,summary:"Custom list",ref:this.tableRef},r.createElement("thead",{role:"presentation",id:"js-listviewthead-"+p,className:c.spGridTableHead},r.createElement("tr",{role:"row",className:"ms-viewheadertr ms-vhltr"},r.createElement("th",{className:"ms-headerCellStyleIcon ms-vh-icon ms-vh-selectAllIcon",scope:"col",role:"columnheader"},r.createElement("span",{className:"ms-selectall-span",id:"cbxSelectAllItems2",title:"Select and deselect all items",role:"checkbox","aria-checked":"false","aria-label":"Press space key to select all items on this list"},r.createElement("span",{className:"ms-selectall-iconouter"},r.createElement("img",{className:"ms-selectall-icon",alt:"",src:"/_layouts/15/images/spcommon.png?rev=44#ThemeKey="})))),r.createElement("th",{scope:"col",role:"columnheader"},r.createElement("div",null,r.createElement("a",{id:"diidSort2LinkTitle",title:"Title, Click to sort by Title"},"Title"),r.createElement("span",{id:"diidSortArrowSpan2LinkTitle"},r.createElement("img",{src:"/_layouts/15/images/spcommon.png?rev=44#ThemeKey=",alt:""})),r.createElement("span",{id:"diidFilterSpan2LinkTitle"},r.createElement("img",{src:"/_layouts/15/images/spcommon.png?rev=44#ThemeKey=",alt:""}))),r.createElement("div",null,r.createElement("div",null,r.createElement("span",null," "),r.createElement("a",{href:"javascript:;",title:"Open Title sort and filter menu","aria-expanded":"false"},r.createElement("img",{src:"/_layouts/15/images/ecbarw.png?rev=44#ThemeKey=",alt:"Open Title sort and filter menu","ms-jsgrid-click-passthrough":"true"})),r.createElement("span",null)))),e)),r.createElement("script",{id:"scriptBody"+p}),r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",{className:f},s&&r.createElement("div",{id:"gridFocusEntryPoint"+p,tabIndex:0,role:"button",className:c.gridFocusEntryPoint},v.default.gridFocusEntryPoint),r.createElement("div",{id:"spgridcontainer_"+p,className:o}))))),this._constructPagingControls())};t.prototype.updateWithRefreshedRows=function(){var e=this.props.refreshedRows;if(e&&e.length&&this.jsGridControl&&this.ganttControl){var t=new(this._telemetry(x.Qos))({name:oe});try{var r={Fields:this.gridJson.Fields,AdditionalParams:n.__assign({},this.gridJson.AdditionalParams)};this.TranslateCSRtoJsGrid({},e,r,this.listSchema);for(var i=0;i<e.length;i++){var s=e[i],o=this.jsGridControl.GetRecord(s.ID),u=this.ganttControl.MakeRecord(r.UnlocalizedTable[i],r.LocalizedTable[i]);u&&!u.fieldRawDataMap&&(u.fieldRawDataMap={});u.fieldRawDataMap.csrInfo=s;if(o){o.properties=u.properties;o.fieldRawDataMap=u.fieldRawDataMap;o.fieldRawLocMap=u.fieldRawLocMap;this.jsGridControl.RefreshRow(o.recordKey)}else{var a=this.jsGridControl.GetRecordKeyByViewIndex(0);this.jsGridControl.InsertRecordBefore(a,u,null);this.rows.unshift(s)}}t.end({resultType:x.ResultTypeEnum.Success})}catch(e){var f=H.getErrorMessage(e);t.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToUpdateWithRefreshedRows",error:f})}}};return t})(r.Component);t.default=ue;var ae=function(e,t){this.value=e;if(null!=t){this.localizedValue=t;this.localizedValueSetExplicitly=!0}else{this.localizedValue=e;this.localizedValueSetExplicitly=!1}}});
define("Ak",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.startExitingQuickEditEventName="startExitingQuickEdit";e.quickEditWriteChangesToListEventName="quickEditWriteChangesToList";e.deleteCompletedEventName="quickEditDeleteCompleted";e.switchGridLayout="switchGridLayout";e.undoChangeEventName="quickEditUndoChange";e.redoChangeEventName="quickEditRedoChange";e.undoRealCmdCountChangeEventName="quickEditUndoRealCmdCountChange";e.redoRealCmdCountChangeEventName="quickEditRedoRealCmdCountChange";e.gridGlobalsInitialized="gridGlobalsInitialized";return e})();t.SPGridEvents=n;t.default=n});
define("Kqe",["require","exports","Lqe","Dqe","Wqe","Eqe","kqe","Aqe","k"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function f(e){this.message=e||"Invalid Change Key Error";this.name="InvalidChangeKeyError"}t.InvalidChangeKeyError=f;f.prototype=new Error;f.prototype.constructor=f;var l=function(e){this.version=e;this.changes=[];this.recordKeys=[]},c=(function(){function e(){this.vChanges=[]}e.prototype.VacateChange=function(e){var t=this.GetVacatedChange(e);n.JsGridUtil.DebugAssert(null==t.item);this.vChanges.splice(t.idx,0,e)};e.prototype.AdvanceBaseline=function(e){var t=this.GetVacatedChange(e);this.vChanges.splice(0,t.idx+(null!=t.item?1:0))};e.prototype.ChangeIsVacated=function(e){return null!=this.GetVacatedChange(e).item};e.prototype.GetVacatedChange=function(e){var t=n.JsGridUtil.Internal.LowerBound(this.vChanges,e,null);return{idx:t,item:null!=this.vChanges[t]&&this.vChanges[t]==e?this.vChanges[t]:null}};return e})(),h=(function(){function e(e,t){this.version=e;this._versionManager=t}e.prototype.Reserve=function(){n.JsGridUtil.DebugAssert(this.version>=this._versionManager.baselineVersion);var e=n.JsGridUtil.Internal.LowerBound(this._versionManager.reservedChanges,this.version,"version");null==this._versionManager.reservedChanges[e]||this._versionManager.reservedChanges[e].version!==this.version?this._versionManager.reservedChanges.splice(e,0,{version:this.version,count:1}):this._versionManager.reservedChanges[e].count++};e.prototype.Release=function(){var e=n.JsGridUtil.Internal.LowerBound(this._versionManager.reservedChanges,this.version,"version");n.JsGridUtil.DebugAssert(this._versionManager.reservedChanges[e].version==this.version);if(1==this._versionManager.reservedChanges[e].count){this._versionManager.reservedChanges.splice(e,1);this._versionManager.UpdateBaselineVersion()}else this._versionManager.reservedChanges[e].count--};e.prototype.GetVersionNumber=function(){return this.version};e.prototype.CompareTo=function(e){return this.version-e.GetVersionNumber()};return e})();t.ChangeKey=h;var p=(function(){function e(e){this._versionManager=e;this.Init()}e.prototype.Clear=function(){this.Init()};e.prototype.AddInsertChange=function(e,t){this.ApplyInsert(e,t,null,null,null)};e.prototype.AddDeleteChange=function(e,t){this.ApplyDelete(e,t,null,null)};e.prototype.ApplyAllRowInsertChanges=function(e){this.DoRowChangeOp(this.ApplyInsert.bind(this),this.rowInserts,e,!1,!1,!0)};e.prototype.ApplyAllRowDeleteChanges=function(e){this.DoRowChangeOp(this.ApplyDelete.bind(this),this.rowDeletes,e,!1,!1,!1)};e.prototype.UndoAllRowInsertChanges=function(e){this.DoRowChangeOp(this.ApplyDelete.bind(this),this.rowInserts,e,!0,!0,!1)};e.prototype.UndoAllRowDeleteChanges=function(e){this.DoRowChangeOp(this.ApplyInsert.bind(this),this.rowDeletes,e,!0,!0,!0)};e.prototype.VacateChange=function(e){var t=n.JsGridUtil.Internal.BinarySearch(this.rowInserts,e,"version");null!=t&&this.rowInserts.splice(t,1);null!=(t=n.JsGridUtil.Internal.BinarySearch(this.rowDeletes,e,"version"))&&this.rowDeletes.splice(t,1)};e.prototype.AdvanceBaseline=function(e){};e.prototype.GetChange=function(e,t,n){var i;null!=t&&(i=new u.Set).AddArray(t);var s=this.GetChanges(this.rowInserts,e,i,n?r.JsGridConstants.ChangeType.Delete:r.JsGridConstants.ChangeType.Insert),o=this.GetChanges(this.rowDeletes,e,i,n?r.JsGridConstants.ChangeType.Insert:r.JsGridConstants.ChangeType.Delete);return n?o.concat(s):s.concat(o)};e.prototype.Init=function(){this.rowInserts=[];this.rowDeletes=[]};e.prototype.GetChanges=function(e,t,r,i){var s=[],o=n.JsGridUtil.Internal.BinarySearch(e,t,"version");if(null!=o)for(var u=0;u<e[o].changes.length;u++){var a=e[o].changes[u];(null==r||r.Contains(a.recordKey))&&s.push({type:i,recordKey:a.recordKey,afterRecordKey:a.afterRecordKey,newOutlineLevel:a.newOutlineLevel})}return s};e.prototype.DoRowChangeOp=function(e,t,r,i,s,o){var u=function(e,t){var n;if(o){n=i?t[t.length-1]:t[0];for(;n.afterRecordKey in e;)n=e[n.afterRecordKey];delete e[n.recordKey];for(var r=0;r<t.length;r++)if(n==t[r]){t.splice(r,1);break}}else n=i?t.pop():t.shift();return n},a=n.JsGridUtil.Internal.BinarySearch(t,r.GetVersionNumber(),"version");if(null!=a){var f=t[a].changes;s||(t[a]=new l(t[a].version));for(var c={},h=[],p=0;p<f.length;p++){c[f[p].recordKey]=f[p];h.push(f[p])}for(;h.length>0;)e(u(c,h),r,!0,s,c)}};e.prototype.ApplyInsert=function(e,t,n,r,i){var s=this,o=t.GetVersionNumber();if(this._versionManager.curVersion>=o||n){var u=this._versionManager.fnDoPhysicalRowInsert(e,t,function(e){return 1==s.GetRecordStatus(e,n&&s._versionManager.curVersion<o?o:s._versionManager.curVersion)},i);null==u||r||this.AddChange(this.rowInserts,o,u)}else r||this.AddChange(this.rowInserts,o,e)};e.prototype.ApplyDelete=function(e,t,n,r){var i=this,s=t.GetVersionNumber();if(this._versionManager.curVersion>=s||n){var o=this._versionManager.fnDoPhysicalRowDelete(e,t,function(e){return-1==i.GetRecordStatus(e,n&&i._versionManager.curVersion<s?s:i._versionManager.curVersion)});if(null!=o){for(var a=new u.Set,f=0;f<o;f++)o[f].isbIsInView&&a.Add(o[f].recordKey);a.IsEmpty()||this.ForEachRowChange(function(t,n){if(t)for(var r in n.recordKeys)a.Contains(r)&&a.Remove(r);if(a.IsEmpty())return!1;for(var i=0;i<n.changes.length;i++)a.Contains(n.changes[i].afterRecordKey)&&(n.changes[i].afterRecordKey=e.afterRecordKey);return!0},s,!1,!0);if(!r)for(f=0;f<o.length;f++)this.AddChange(this.rowDeletes,s,o[f])}}else r||this.AddChange(this.rowDeletes,s,e)};e.prototype.GetRecordStatus=function(e,t){var n=0;this.ForEachRowChange(function(t,r){n=e in r.recordKeys?t?1:-1:n;return!0},t,!0,!1);return n};e.prototype.ForEachRowChange=function(e,t,n,r){for(var i=0;(i<this.rowDeletes.length&&(r||this.rowDeletes[i].version<=t)||i<this.rowInserts.length&&r&&this.rowInserts[i].version<=t)&&(!(i<this.rowInserts.length&&(n||this.rowInserts[i].version>t))||e(!0,this.rowInserts[i]))&&(!(i<this.rowDeletes.length&&(n||this.rowDeletes[i].version>t))||e(!1,this.rowDeletes[i]));i++);};e.prototype.AddChange=function(e,t,r){var i=n.JsGridUtil.Internal.LowerBound(e,t,"version");i!=e.length&&e[i].version===t||e.splice(i,0,new l(t));var s=e[i];s.changes.push(r);s.recordKeys[r.recordKey]=null};return e})(),d=(function(){function e(e){this._versionManager=e;this.Init()}e.prototype.Clear=function(){this.Init()};e.prototype.GetChange=function(e,t,i){var s=[],o=null!=t?t:n.JsGridUtil.Internal.ConvertSetKeysToArray(this.propChanges),u=function(t){if(o.hasOwnProperty(t)){var n=o[t];a.ApplyToItemsInRecord(n,e,function(e,t){if(null!=t.item){var o=i?t.prevItem:t.item;s.push({type:r.JsGridConstants.ChangeType.Prop,recordKey:n,fieldKey:e,propUpdate:o.value,validationState:null==o.validationState?r.JsGridConstants.ValidationState.Valid:o.validationState})}},!0)}},a=this;for(var f in o)u(f);return s};e.prototype.TryReadPropForVersion=function(e,t,n){if(e in this.propChanges&&t in this.propChanges[e]){var r=this.GetChangeFromList(this.propChanges[e][t],n),i=null==r.item?r.prevItem:r.item;return null!=i?i.value:null}return null};e.prototype.ChangeKeys=function(e,t){this.propChanges[t]=this.propChanges[e];delete this.propChanges[e]};e.prototype.GetEarliestChangeKeyForRecord=function(e){var t,n=this.propChanges[e];if(null!=n)for(var r in n)if(n.hasOwnProperty(r)){var i=n[r],s=i[0].version!==this._versionManager.baselineVersion?i[0].version:i[1].version;t=null==t||s<t?s:t}return t};e.prototype.ClearAllPropChangesForRecord=function(e){delete this.propChanges[e]};e.prototype.MarkPropUpdateInvalid=function(e,t,n,i){var s=!1,o=n.GetVersionNumber(),u=this.propChanges[e][t];if(null!=u){var a=this.GetChangeFromList(u,o);if(null!=a.item){if(a.item.validationState!==r.JsGridConstants.ValidationState.Invalid){a.item.validationState=r.JsGridConstants.ValidationState.Invalid;null!=i&&(a.item.optErrorMsg=i);this._versionManager.fnDoPhysicalPropChange(e,t,a.item.value,n,r.JsGridConstants.ValidationState.Invalid,!1,null,i,this.GetOldValue(u,a.idx,!1))}s=!0}}return s};e.prototype.AddPropChange=function(e,t,i,s,o,u){var a=i.GetVersionNumber(),f=null,l=null;if(a==this._versionManager.baselineVersion){if(null!=(c=null!=this.propChanges[e]&&null!=this.propChanges[e][t]?this.GetChangeFromList(this.propChanges[e][t],a):null)){n.JsGridUtil.DebugAssert(0==c.idx);n.JsGridUtil.DebugAssert(null!=c.item);f=c.item;l=c.idx}}else{null==this.propChanges[e]&&(this.propChanges[e]={});var c,h=this.propChanges[e][t];if(null==h){var p=this._versionManager.fnGetRecord(e),d=null;null!=p&&(d=this.GetPropUpdateFromRecord(p,t));h=this.propChanges[e][t]=[{version:this._versionManager.baselineVersion,value:d}]}l=(c=this.GetChangeFromList(h,a)).idx;if(null==c.item){this.MinimizePropUpdate(e,t,s);var v={version:a,value:s};o!==r.JsGridConstants.ValidationState.Valid&&(v.validationState=o);null!=u&&(v.optErrorMsg=u);h.splice(l,0,v)}else f=c.item}if(null!=f){f.value=s;o!==f.validationState&&(null==o||o==r.JsGridConstants.ValidationState.Valid?delete f.validationState:f.validationState=o)}var m=null==l?null:this.propChanges[e][t];this._versionManager.curVersion>=a&&(null==l||l==m.length-1||m[l+1].version>this._versionManager.curVersion)&&this._versionManager.fnDoPhysicalPropChange(e,t,s,i,o,!1,null,u,this.GetOldValue(m,l,!1))};e.prototype.ApplyChangesToRecord=function(e){var t=this;e.key()in this.propChanges&&this.ApplyToItemsInRecord(e.key(),this._versionManager.curVersion,function(i,s){var o=t.propChanges[e.key()][i],u=null==s.item?s.prevItem:s.item;if(null!=u&&null!=e.GetProp(i)){var a=n.JsGridUtil.Internal.LowerBound(t._versionManager.changeMap,s.version,"version");t._versionManager.fnDoPhysicalPropChange(e.key(),i,u.value,t._versionManager.changeMap[a].key,null==u.validationState?r.JsGridConstants.ValidationState.Valid:u.validationState,!0,e,u.optErrorMsg,t.GetOldValue(o,a,!1))}},!0)};e.prototype.VacateChange=function(e){var t=this,r=function(r){i.propChanges.hasOwnProperty(r)&&i.ApplyToItemsInRecord(r,e,function(i,s){var o=t.propChanges[r][i];n.JsGridUtil.DebugAssert(o.length>1);if(2==o.length){n.JsGridUtil.DebugAssert(o[0].version==t._versionManager.baselineVersion);n.JsGridUtil.DebugAssert(o[1].version==e);t.DeleteEntry(r,i)}else o.splice(s.idx,1)},null)},i=this;for(var s in this.propChanges)r(s)};e.prototype.SynchronizeToChange=function(e,t,i){var s=this,o=e.GetVersionNumber(),u=null!=t?t:n.JsGridUtil.Internal.ConvertSetKeysToArray(this.propChanges),a=[],f={},l=[],c=function(t){if(u.hasOwnProperty(t)){var n=u[t];h.ApplyToItemsInRecord(n,o,function(t,i){var o=null==i.item?i.prevItem:i.item;if(null!=o&&o.version>s._versionManager.curVersion){s._versionManager.fnDoPhysicalPropChange(n,t,o.value,e,null==o.validationState?r.JsGridConstants.ValidationState.Valid:o.validationState,!1,null,o.optErrorMsg,s.GetOldValue(s.propChanges[n][t],i.idx,!1));l.push(n);if(!f[t]){a.push(t);f[t]=!0}}},!0)}},h=this;for(var p in u)c(p);i&&this.setFocusForUndoRedoChange(l,a)};e.prototype.RollBackChange=function(e,t){var i=this,s=e.GetVersionNumber(),o=null!=t?t:n.JsGridUtil.Internal.ConvertSetKeysToArray(this.propChanges),u=[],a={},f=[],l=function(e){if(o.hasOwnProperty(e)){var t=o[e];c.ApplyToItemsInRecord(t,s,function(e,s){n.JsGridUtil.DebugAssert(s.idx>0);var o=i.propChanges[t][e][s.idx-1],l=n.JsGridUtil.Internal.LowerBound(i._versionManager.changeMap,o.version,"version"),c=i._versionManager.changeMap[l].key;i._versionManager.fnDoPhysicalPropChange(t,e,o.value,c,null==o.validationState?r.JsGridConstants.ValidationState.Valid:o.validationState,!1,null,o.optErrorMsg,i.GetOldValue(i.propChanges[t][e],s.idx-1,!0));f.push(t);if(!a[e]){u.push(e);a[e]=!0}},null)}},c=this;for(var h in o)l(h);this.setFocusForUndoRedoChange(f,u)};e.prototype.AdvanceBaseline=function(e){for(var t in this.propChanges)if(this.propChanges.hasOwnProperty(t))for(var r in this.propChanges[t])if(this.propChanges[t].hasOwnProperty(r)){for(var i=this.propChanges[t][r],s=n.JsGridUtil.Internal.LowerBound(i,e,"version"),o=1;o<s;o++)i.shift();1==i.length?this.DeleteEntry(t,r):i[0].version=e}};e.prototype.setFocusForUndoRedoChange=function(e,t){if(!(a.Killswitch.isActivated("6FFFEBB6-DDB5-422D-B37F-E9A64586F1E5","09/28/2020","Set focus for undo or redo")||e.length<1||t.length<1)&&this._versionManager._objBag.selectionMgr&&this._versionManager._objBag.paneMgr&&this._versionManager._objBag.paneMgr.gridPane){var n=this._versionManager._objBag.paneMgr.gridPane,r=this._versionManager._objBag.selectionMgr,s=e[0],o=t[0];if(1===e.length&&1===t.length){r.SetFocusByKey(this._versionManager._objBag.paneMgr.gridPane,s,o);return}var u=t[t.length-1],f=e[e.length-1],l=n.GetGridPaneConverter().KeyToIdx(s,o),c=n.GetGridPaneConverter().KeyToIdx(f,u);l&&c&&r.SelectRange(n,l.rowIdx,c.rowIdx,l.colIdx,c.colIdx,i.SelectOp.Set,!0,!1)}};e.prototype.GetOldValue=function(e,t,n){var r,i=n?t+1:t-1;i>=0&&i<e.length&&(r=e[i].value);return r};e.prototype.GetPropUpdateFromRecord=function(e,t){var i=this._versionManager._objBag.controller.GetPropType(e.key(),t),u=i&&s.PropertyType.Internal.Property.GetInstance().GetUpdateTrackingMode(i,this._versionManager._objBag.jsGridParams.tableViewParams.gridFieldMap[t]),a=e.HasDataValue(t)&&u!==r.JsGridConstants.UpdateTrackingMode.PropLocalized?e.GetDataValue(t):n.JsGridUtil.EmptyValue,f=e.HasLocalizedValue(t)&&u!==r.JsGridConstants.UpdateTrackingMode.PropData?e.GetLocalizedValue(t):n.JsGridUtil.EmptyValue;return new o.PropertyUpdate(a,f)};e.prototype.MinimizePropUpdate=function(e,t,i){var s=this._versionManager._objBag.controller.GetPropType(e,t),o=s&&s.GetUpdateTrackingMode&&s.GetUpdateTrackingMode();null!=s&&null!=o&&(o==r.JsGridConstants.UpdateTrackingMode.PropLocalized&&i.data!==n.JsGridUtil.EmptyValue?i.data=n.JsGridUtil.EmptyValue:o==r.JsGridConstants.UpdateTrackingMode.PropData&&i.localized!==n.JsGridUtil.EmptyValue&&(i.localized=n.JsGridUtil.EmptyValue))};e.prototype.Init=function(){this.propChanges={}};e.prototype.DeleteEntry=function(e,t){delete this.propChanges[e][t];n.JsGridUtil.Internal.IsAssocArrayEmpty(this.propChanges[e])&&delete this.propChanges[e]};e.prototype.ApplyToItemsInRecord=function(e,t,n,r){var i=this.propChanges[e];if(null!=i)for(var s in i)if(i.hasOwnProperty(s)){var o=this.GetChangeFromList(i[s],t);(null!=o.item||r)&&n(s,o)}};e.prototype.GetChangeFromList=function(e,t){var r=n.JsGridUtil.Internal.LowerBound(e,t,"version");return{idx:r,item:null!=e[r]&&e[r].version==t?e[r]:null,prevItem:r>0&&r<=e.length?e[r-1]:null}};return e})(),v=(function(){function e(e){this._versionManager=e;this.Init()}e.prototype.Clear=function(){this.Init()};e.prototype.AddLevelChange=function(e,t,n,r){var i=r.GetVersionNumber(),s=this.levelChanges[i];null==s&&(s=this.levelChanges[i]=[]);s.push({recordKey:e,levelDelta:t,adoptedChildrenKeys:n});this._versionManager.curVersion>=i&&this._versionManager.fnDoPhysicalLevelChange(e,t,n,r)};e.prototype.ApplyAllLevelChanges=function(e){this.DoLevelChange(e,!1)};e.prototype.UndoAllLevelChanges=function(e){this.DoLevelChange(e,!0)};e.prototype.GetChange=function(e,t,n){var i;null!=t&&(i=new u.Set).AddArray(t);var s=[],o=this.levelChanges[e];if(null!=o)for(var a=r.JsGridConstants.ChangeType.Level,f=0;f<o.length;f++)if(null==i||i.Contains(o[f].recordKey)){var l=o[f].levelDelta*(n?-1:1);s.push({type:a,recordKey:o[f].recordKey,levelDelta:l,adoptedChildrenKeys:o[f].adoptedChildrenKeys})}return s};e.prototype.VacateChange=function(e){delete this.levelChanges[e]};e.prototype.AdvanceBaseline=function(e){for(var t=this._versionManager.baselineVersion;t<e;t++)this.VacateChange(t)};e.prototype.Init=function(){this.levelChanges={}};e.prototype.DoLevelChange=function(e,t){var n=this.levelChanges[e.GetVersionNumber()];if(null!=n)if(t)for(var r=n.length-1;r>=0;r--)this._versionManager.fnDoPhysicalLevelChange(n[r].recordKey,-n[r].levelDelta,n[r].adoptedChildrenKeys,e);else for(r=0;r<n.length;r++)this._versionManager.fnDoPhysicalLevelChange(n[r].recordKey,n[r].levelDelta,null,e)};return e})(),m=(function(){function e(e,t,n,r,i,s){this.reservedChanges=[];this.curVersion=0;this.baselineVersion=0;this.changeCount=1;this.vacatedChanges=new c;this._objBag=e;this.fnDoPhysicalPropChange=t;this.fnDoPhysicalRowInsert=n;this.fnDoPhysicalRowDelete=r;this.fnDoPhysicalLevelChange=i;this.fnGetRecord=s;this.rowChangeMgr=new p(this);this.changeMap=[{key:new h(0,this),version:0}];this.propChangeMgr=new d(this);this.levelChangeMgr=new v(this)}e.prototype.ChangeKeysOnPropUpdates=function(e,t){this.propChangeMgr.ChangeKeys(e,t)};e.prototype.GetEarliestPropChangeKeyForRecord=function(e){var t=this.propChangeMgr.GetEarliestChangeKeyForRecord(e);null!=t&&(t=this.GetChangeKeyForVersion(t));return t};e.prototype.AddPropChange=function(e,t,n,r,i,s){this.ValidateChangeKey(n,!0)&&this.propChangeMgr.AddPropChange(e,t,n,r,i,s)};e.prototype.MarkPropUpdateInvalid=function(e,t,n,r){var i=!1;this.ValidateChangeKey(n,!0)&&(i=this.propChangeMgr.MarkPropUpdateInvalid(e,t,n,r));return i};e.prototype.ClearAllPropChangesForRecord=function(e){this.propChangeMgr.ClearAllPropChangesForRecord(e)};e.prototype.AddRowInsertChange=function(e,t){this.ValidateChangeKey(t,!0)&&this.rowChangeMgr.AddInsertChange(e,t)};e.prototype.AddRowDeleteChange=function(e,t){this.ValidateChangeKey(t,!0)&&this.rowChangeMgr.AddDeleteChange(e,t)};e.prototype.AddIndentLevelChange=function(e,t,n,r){this.ValidateChangeKey(r,!0)&&this.levelChangeMgr.AddLevelChange(e,t,n,r)};e.prototype.ApplyChangesToRecord=function(e){this.propChangeMgr.ApplyChangesToRecord(e)};e.prototype.ApplyChangeKey=function(e,t){if(!this.ValidateChangeKey(e,!0)){ULS.SendErrorMessageJS(ULSCat.msoulscat_WSS_JsGrid,"Invalid change key: "+e.GetVersionNumber().toString());throw new f("Invalid change key: "+e.GetVersionNumber().toString())}null!=this.OnSynchronizeChange&&this.OnSynchronizeChange(e);this.rowChangeMgr.ApplyAllRowInsertChanges(e);this.levelChangeMgr.ApplyAllLevelChanges(e);this.propChangeMgr.SynchronizeToChange(e,null,t);this.rowChangeMgr.ApplyAllRowDeleteChanges(e);this.curVersion=e.GetVersionNumber()};e.prototype.UndoChangeKey=function(e){if(!this.ValidateChangeKey(e,null)){ULS.SendErrorMessageJS(ULSCat.msoulscat_WSS_JsGrid,"Invalid change key: "+e.GetVersionNumber().toString());throw new f("Invalid change key: "+e.GetVersionNumber().toString())}null!=this.OnRollbackChange&&this.OnRollbackChange(e);var t=this.TryGetPreviousChangeKeyFromVersion(e.GetVersionNumber());this.curVersion=t.GetVersionNumber();this.rowChangeMgr.UndoAllRowDeleteChanges(e);this.levelChangeMgr.UndoAllLevelChanges(e);this.propChangeMgr.RollBackChange(e);this.rowChangeMgr.UndoAllRowInsertChanges(e)};e.prototype.TryReadPropForChangeKey=function(e,t,n){return this.propChangeMgr.TryReadPropForVersion(e,t,n.GetVersionNumber())};e.prototype.GetChange=function(e,t,r){var i=e.GetVersionNumber();n.JsGridUtil.DebugAssert(!r||i!==this.baselineVersion);var s=this.rowChangeMgr.GetChange(i,t,r),o=this.levelChangeMgr.GetChange(i,t,r),u=this.propChangeMgr.GetChange(i,t,r);return s.concat(o,u).sort(function(e,t){return e.type-t.type})};e.prototype.GetCurrentVersion=function(){return this.curVersion};e.prototype.GetCurrentChangeKey=function(){return this.GetChangeKeyFromVersion(this.curVersion)};e.prototype.IsChangeKeyApplied=function(e){return null!=e&&e.GetVersionNumber()<=this.curVersion};e.prototype.GetNextVersionKey=function(){var e=new h(this.changeCount++,this);this.changeMap.push({key:e,version:e.GetVersionNumber()});e.Reserve();return e};e.prototype.ForceReleaseChanges=function(e,t){var n,r=0;this.ForEachChange(e.GetVersionNumber()+1,t.GetVersionNumber(),this.reservedChanges,function(e,t){n=null==n?t:n;r++});this.reservedChanges.splice(n,r);this.UpdateBaselineVersion()};e.prototype.GetChangeKeyForVersion=function(e){var t=this.GetChangeKeyFromVersion(e);return null!=t&&this.ValidateChangeKey(t,!0)?t:null};e.prototype.Clear=function(){this.reservedChanges=[];this.rowChangeMgr.Clear();this.levelChangeMgr.Clear();this.propChangeMgr.Clear()};e.prototype.ReleaseChanges=function(e,t){this.ForEachChange(e.GetVersionNumber()+1,t.GetVersionNumber(),this.changeMap,function(e,t){e.key.Release()});this.UpdateBaselineVersion()};e.prototype.ReserveChanges=function(e,t){this.ForEachChange(e.GetVersionNumber()+1,t.GetVersionNumber(),this.changeMap,function(e,t){e.key.Reserve()})};e.prototype.VacateChange=function(e){var t=e.GetVersionNumber();n.JsGridUtil.DebugAssert(t>this.baselineVersion);n.JsGridUtil.DebugAssert(t>this.curVersion);this._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnVacateChange,n.JsGridUtil.EventArgs.VacateChange(e));null!=this.OnVacateChange&&this.OnVacateChange(e);this.propChangeMgr.VacateChange(t);this.rowChangeMgr.VacateChange(t);this.levelChangeMgr.VacateChange(t);this.vacatedChanges.VacateChange(t);this.CleanUpChangeMap(t,t)};e.prototype.CleanUpChangeMap=function(e,t){var n,r=0;this.ForEachChange(e,t,this.changeMap,function(e,t){n=null==n?t:n;r++});this.changeMap.splice(n,r)};e.prototype.ForEachChange=function(e,t,r,i){for(var s=null==e?0:n.JsGridUtil.Internal.LowerBound(r,e,"version"),o=null==t?r.length-1:n.JsGridUtil.Internal.LowerBound(r,t,"version"),u=s;u<=o;u++)null!=r[u]&&i(r[u],u)};e.prototype.ValidateChangeKey=function(e,t){var r=e.GetVersionNumber();n.JsGridUtil.DebugAssert(r>this.baselineVersion||t&&r==this.baselineVersion);return!this.vacatedChanges.ChangeIsVacated(r)};e.prototype.TryGetPreviousChangeKeyFromVersion=function(e){for(var t=null,n=0;n<this.changeMap.length&&this.changeMap[n].version<e;n++)t=this.changeMap[n];return t&&t.key};e.prototype.GetChangeKeyFromVersion=function(e){var t=n.JsGridUtil.Internal.BinarySearch(this.changeMap,e,"version");return this.changeMap[t].key};e.prototype.UpdateBaselineVersion=function(){var e=this.reservedChanges.length>0?this.reservedChanges[0]-1:this.curVersion-1;if(e>this.baselineVersion){this.propChangeMgr.AdvanceBaseline(e);this.rowChangeMgr.AdvanceBaseline(e);this.levelChangeMgr.AdvanceBaseline(e);this.vacatedChanges.AdvanceBaseline(e);this.CleanUpChangeMap(this.baselineVersion,e-1);this.baselineVersion=e}};return e})();t.VersionManager=m});
define("vqe",["require","exports","Lqe","hqe","H5","F5","k","U5","FS","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";f=f.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var l,c,h,p,d,v,m=o.Killswitch.isActivated("096CBC65-3042-4DE8-9984-92CA9D6AC32B","7/14/2020","Fix HTML string decoding for display control for multi line text fields."),g=o.Killswitch.isActivated("F8981E1F-1867-43CA-9123-178C686F8AE1","2/25/2020","Strip only certain HTML tags from RTE and MultiLine Text Fields to preserve font styles minus fot-size"),y=o.Killswitch.isActivated("82B53297-2CF5-4E0A-8A06-A203E9461B03","8/06/2020","Change function used for getting relative date time string to be the same one thats used in items-view."),b={ODB:1725},w={ODB:1300},E={ODB:1206},S={ODB:1198},x={ODB:60017},T="DateOnly";t.globalClienttemplates=function(){n.JsGridUtil.SPListView||(n.JsGridUtil.SPListView=!1);l="undefined"!=typeof SingleListView;(function(){var e=n.JsGridUtil.SPListView;ListModule.Settings.SupportsCallouts=e;ListModule.Settings.SupportsDragDrop=e;ListModule.Settings.SupportsRibbon=e;ListModule.Settings.SupportsQCB=e;ListModule.Settings.SupportsUpload=e;ListModule.Settings.SupportsInplHash=e;ListModule.Settings.SupportsAnimation=e;ListModule.Settings.SupportsGrouping=e;ListModule.Settings.SupportsNonCSR=e;ListModule.Settings.SupportsInPlaceEdit=e;ListModule.Settings.SupportsItemDelete=e;ListModule.Settings.SupportsCheckout=e;ListModule.Settings.SupportsPopup=e;ListModule.Settings.SupportsErrorDlg=e;ListModule.Settings.SupportsFileAttach=e;ListModule.Settings.SupportsCopies=e;ListModule.Settings.SupportsModeration=e;ListModule.Settings.SupportsMQuery=e;ListModule.Settings.SupportsForms=e;ListModule.Settings.SupportsViewSelectorPivot=e;ListModule.Settings.SupportsWebPageLibraryTemplate=e;ListModule.Settings.SupportsDeveloperAppTemplate=e;ListModule.Settings.SupportsDelayLoading=e;ListModule.Settings.SupportsItemSelection=e;ListModule.Settings.SupportsSharingDialog=e;ListModule.Settings.UseAbsoluteUserDispUrl=!e;ListModule.Settings.SupportsCrossDomainPhotos=e;ListModule.Settings.SupportsTouch=e;ListModule.Settings.SupportsBusinessDataField=e;ListModule.Settings.SupportsUrlTokenReplacement=e;ListModule.Settings.SupportsAsyncDataLoad=e;ListModule.Settings.SupportsBreadCrumb=e;ListModule.Settings.SupportsSubmitFormPost=e;ListModule.Settings.SupportsFacePile=e;ListModule.Settings.SupportsRest=l;ListModule.Settings.SupportsDatapipes=l;ListModule.Settings.SupportsOldDesktopMenus=e;ListModule.Settings.SupportsTaskListEditMode=e})();c=!1;h=!1;(function(){if(Boolean(h))return;void 0===window.ListView&&(window.ListView=new Object);void 0===window.ListView.Strings&&(n.JsGridUtil.SPListView&&void 0!==Strings.STS?window.ListView.Strings=Strings.STS:void 0!==window.ListViewDefaults.Strings&&(window.ListView.Strings=window.ListViewDefaults.Strings));h=!0})();void 0===window.ListView&&(window.ListView=new Object);void 0===window.ListView.ImageBasePath&&(window.ListView.ImageBasePath="");p=[];d=function(e,t){p.push(this);var n=e,r={},i={},s={},o={},u={};this.Matches=function(e){return e==n};this.RegisterHierarchyNode=function(e,t,n,a){r[e]=!0;i[e]=n;s[a]=e;u[e]=a;o[e]=[];null!=t&&o[t].push(e)};this.IsParent=function(e){return e in o&&o[e].length>0};this.ToggleExpandByImg=function(e){if(e.id in s){a(s[e.id],e)}};this.ToggleExpandById=function(e){if(null!=e&&e in u){var t=u[e],n=window.$get(t);null!=n&&a(e,n)}};this.GetToggleStateById=function(e){return null==e?0:e in r?0==o[e].length?0:r[e]?1:2:0};function a(e,n){var s=!r[e];if(s){n.firstChild.className="ms-commentcollapse"+(t?"rtl":"")+"-icon";(function e(t){for(var n=0;n<o[t].length;n++){document.getElementById(i[o[t][n]]).style.display="";r[o[t][n]]&&e(o[t][n])}})(e)}else{n.firstChild.className="ms-commentexpand"+(t?"rtl":"")+"-icon";(function e(t){for(var n=0;n<o[t].length;n++){document.getElementById(i[o[t][n]]).style.display="none";e(o[t][n])}})(e)}r[e]=s}};t.SPClientRenderer={GlobalDebugMode:!1,AddCallStackInfoToErrors:!1,RenderErrors:!0};t.SPClientRenderer.IsDebugMode=function(e){return void 0!==e&&null!=e&&void 0!==e.DebugMode?Boolean(e.DebugMode):Boolean(t.SPClientRenderer.GlobalDebugMode)};t.SPClientRenderer._ExecuteRenderCallbacks=function(e,n){var r={Operation:n};return k(function(){return t.SPClientRenderer._ExecuteRenderCallbacksWorker(e,n,r)},e,null,r)};t.SPClientRenderer._ExecuteRenderCallbacksWorker=function(e,t,n){if(e&&null!=t&&""!=t){var r=e[t];if(null!=r)if("function"==typeof r){n.TemplateFunction=r;r(e)}else if("object"==typeof r){var i=r.length;if(i&&"number"==typeof i)for(var s=0;s<Number(i);s++)if("function"==typeof r[s]){n.TemplateFunction=r[s];r[s](e)}}}};t.SPClientRenderer.CoreRender=L;t.SPClientRenderer.ParseTemplateString=function(e,n){return k(function(){return t.SPClientRenderer.ParseTemplateStringWorker(e,n)},n,null,{TemplateFunction:e,Operation:"ParseTemplateString"})};t.SPClientRenderer.ParseTemplateStringWorker=function(e,t){if(null==e||0==e.length)return null;var n="var p=[]; p.push('"+e.replace(/[\r\t\n]/g," ").replace(/'(?=[^#]*#>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<#=(.+?)#>/g,"',$1,'").split("<#").join("');").split("#>").join("p.push('")+"'); return p.join('');";return new Function("ctx",n)};"function"!=typeof window.ComputedFieldWorker&&(window.ComputedFieldWorker=(function(){function e(e,t,r){if("1"==e["Created_x0020_Date.ifnew"]){var i;i=n.JsGridUtil.Internal.GetImageUrl("spcommon.png");r.push('<span class="ms-newdocument-iconouter"><img class="ms-newdocument-icon" src="');r.push(i);r.push('" alt="');r.push(window.ListView.Strings.L_SPClientNew);r.push('" title="');r.push(window.ListView.Strings.L_SPClientNew);r.push('" /></span>')}}function t(e,t,n,r,s,o,u){var a=[];a.push('<span style="vertical-align:middle">');a.push('<span style="height:16px;width:16px;position:relative;display:inline-block;overflow:hidden;" class="s4-clust"><a href="');a.push(e);i(a,o,u);a.push('" style="height:16px;width:16px;display:inline-block;" ><img src="'+ListView.ImageBasePath+'/_layouts/15/images/fgimg.png?rev=47" alt="');a.push(t);a.push('" style="left:-0px !important;top:');a.push(n);a.push('px !important;position:absolute;" title="');a.push(r);a.push('" class="imglink" longDesc="');a.push(s);a.push('"></a>');a.push("</span>");a.push("</span>");return a.join("")}function i(e,t,n){e.push(t.HttpVDir);e.push("/Lists/Posts/Post.aspx?ID=");e.push(n.ID)}function s(t,i,s){var o=[],u=i.FileRef;if(null!=u&&void 0!==u&&""!=r.TrimSpaces(u))if("1"==i.FSObjType)"1"==s.IsDocLib?K(t,o,i.FileLeafRef,i,s):J(o,i.FileLeafRef,i,s);else if(ListModule.Settings.SupportsAddToOneDrive&&Boolean(r.IsMountPoint(i))){U(i);o.push(r.RenderMountPointLink(t,o,i["FileLeafRef.Name"],i,s))}else if(ListModule.Settings.SupportsShortcutLink&&Boolean(r.IsShortcutLink(i))){U(i);r.RenderShortcutLink(t,o,i["FileLeafRef.Name"],i,s)}else{var a,l=(Boolean(t.RealHttpRoot)?ListModule.Util.getHostUrl(t.HttpRoot):"")+i.FileRef;l=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(54)?Encoding.HtmlEncodeEx(l):Encoding.HtmlEncode(l);var c=n.JsGridUtil.Internal.IsFeatureEnabled(b)?" "+f.listLink:"";o.push("<a class='ms-listlink"+c+"' href=\"");o.push(l);o.push('" onmousedown="return VerifyHref(this,event,\'');o.push(s.DefaultItemOpen);o.push("','");o.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);o.push("','");a=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?Encoding.ScriptEncode(i["serverurl.progid"]):i["serverurl.progid"];if((null==window.OffSwitch||OffSwitch.IsActive("88E16BF7-E8BC-4ABA-ABE7-001818C101E8"))&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(164)&&"ms-word"==i["File_x0020_Type.mapapp"]||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(194)&&"ms-powerpoint"==i["File_x0020_Type.mapapp"]||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(225)&&"ms-visio"==i["File_x0020_Type.mapapp"]||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(181)&&"ms-excel"==i["File_x0020_Type.mapapp"]){a=a.replace("WopiFrame.aspx","doc.aspx");null==window.OffSwitch||OffSwitch.IsActive("8682DDE6-14A4-4290-876C-8D1F5AFD46E0")?a=a.replace("action=default","action=edit"):"ms-visio"!=i["File_x0020_Type.mapapp"]&&"ms-excel"!=i["File_x0020_Type.mapapp"]&&(a=a.replace("action=default","action=edit"))}o.push(a);o.push('\')" onclick="');Le(o,i,"Navigation");if(D()){if(_()&&M(t)){o.push("CoreInvoke('CallSuiteExtensionControlFactory', this, event, '");null==window.OffSwitch||OffSwitch.IsActive("9E9D50DD-3F1B-4186-8AC0-80E9634B2891")?o.push(i.File_x0020_Type):o.push(Encoding.ScriptEncode(i.File_x0020_Type));o.push("','");o.push(t.HttpRoot);o.push("','");o.push(Encoding.ScriptEncode(i.FileRef));o.push("');")}}else{o.push("CoreInvoke('CallSuiteExtensionControlFactory', this, event, '");null==window.OffSwitch||OffSwitch.IsActive("9E9D50DD-3F1B-4186-8AC0-80E9634B2891")?o.push(i.File_x0020_Type):o.push(Encoding.ScriptEncode(i.File_x0020_Type));o.push("','");o.push(t.HttpRoot);o.push("','");o.push(Encoding.ScriptEncode(i.FileRef));o.push("');")}o.push("return DispEx(this,event,'TRUE','FALSE','");o.push(i["File_x0020_Type.url"]);o.push("','");o.push(i["File_x0020_Type.progid"]);o.push("','");o.push(s.DefaultItemOpen);o.push("','");o.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);o.push("','");o.push(i.HTML_x0020_File_x0020_Type);o.push("','");o.push(a);o.push("','");o.push(Boolean(i.CheckoutUser)?i.CheckoutUser[0].id:"");o.push("','");o.push(s.Userid);o.push("','");o.push(s.ForceCheckout);o.push("','");o.push(i.IsCheckedoutToLocal);o.push("','");o.push(i.PermMask);var h=i.FileLeafRef;if(null!=h){var p=h.lastIndexOf(".");h=p>=0?h.substring(0,p):h}if(ListModule.Settings.SupportsDoclibAccessibility){o.push("')\"");var d=h+", "+F(i["File_x0020_Type.mapapp"],i.File_x0020_Type);o.push(" aria-label='");o.push(Encoding.HtmlEncode(d));o.push("'>")}else o.push("')\">");o.push(Encoding.HtmlEncode(h));o.push("</a>");e(i,0,o)}else{o.push("<nobr>");o.push(Encoding.HtmlEncode(i.FileLeafRef));o.push("</nobr>")}return o.join("")}function o(e,t,n,i){var s=[],o=Encoding.HtmlEncode(n.FileLeafRef),u="imgIcon"+n.ID+e.wpq,a=void 0!==n["DocIcon.groupHeader"];if(a){u="imgIcon"+e.ctxId+"-";if(n["DocIcon.groupindex"])u+=n["DocIcon.groupindex"];else if(n["DocIcon.groupindex2"]){var f=i.group1;u+=n[f+".groupindex"]+n["DocIcon.groupindex2"]}}if(ListModule.Settings.SupportsAddToOneDrive&&Boolean(r.IsMountPoint(n))){var l=r.createByListItem(n,e);if(r.SupportAjaxFolderNav(e)){s.push('<a href="#" onclick="');s.push("EnterFolderAjax(event, '");s.push(URI_Encoding.encodeURIComponent(n.FileRef));s.push("', '");s.push(l.getMountPointUrl());s.push("', true);return false;\"");ListModule.Settings.SupportsDoclibAccessibility?s.push(' aria-label="'+Encoding.HtmlEncode(window.ListView.Strings.L_FieldType_SharedFolder)+'">'):s.push(">")}else{s.push('<a href="');s.push(l.getMountPointUrl());ListModule.Settings.SupportsDoclibAccessibility?s.push(' aria-label="'+Encoding.HtmlEncode(window.ListView.Strings.L_FieldType_SharedFolder)+'">'):s.push('">')}s.push('<img border="0" alt="');s.push(o);s.push('" title="');s.push(o);s.push('" src="');s.push(ListView.ImageBasePath+"/_layouts/15/images/SharedFolder16.png?rev=47");s.push('" />');s.push("</a>")}else if(ListModule.Settings.SupportsShortcutLink&&Boolean(r.IsShortcutLink(n))){U(n);r.RenderShortcutLinkIcon(e,s,n["FileLeafRef.Name"],n,i)}else if("1"==n.FSObjType){var c=X()?"&MaintainUserChrome=true":"";if(w())S();else{s.push('<a href="');s.push(i.PagePath);s.push("?RootFolder=");s.push(URI_Encoding.encodeURIComponent(n.FileRef));s.push(i.ShowWebPart);s.push("&FolderCTID=");s.push(n.ContentTypeId);s.push("&View=");s.push(URI_Encoding.encodeURIComponent(i.View));s.push(c);s.push('" onmousedown="VerifyFolderHref(this, event, \'');s.push(n["File_x0020_Type.url"]);s.push("','");s.push(n["File_x0020_Type.progid"]);s.push("','");s.push(i.DefaultItemOpen);s.push("', '");s.push(n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);s.push("', '");s.push(n.HTML_x0020_File_x0020_Type);s.push("', '");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?s.push(Encoding.ScriptEncode(n["serverurl.progid"])):s.push(n["serverurl.progid"]);s.push('\')" onclick="');Le(s,n,"Navigation");s.push("return HandleFolder(this,event,'");s.push(i.PagePath);s.push("?RootFolder=");s.push(URI_Encoding.encodeURIComponent(n.FileRef));s.push(i.ShowWebPart);s.push("&FolderCTID=");s.push(n.ContentTypeId);s.push("&View=");s.push(URI_Encoding.encodeURIComponent(i.View));s.push(c);s.push("','TRUE','FALSE','");s.push(n["File_x0020_Type.url"]);s.push("','");s.push(n["File_x0020_Type.progid"]);s.push("','");s.push(i.DefaultItemOpen);s.push("','");s.push(n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);s.push("','");s.push(n.HTML_x0020_File_x0020_Type);s.push("','");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?s.push(Encoding.ScriptEncode(n["serverurl.progid"])):s.push(n["serverurl.progid"]);s.push("','");s.push(Boolean(n.CheckoutUser)?n.CheckoutUser[0].id:"");s.push("','");s.push(i.Userid);s.push("','");s.push(i.ForceCheckout);s.push("','");s.push(n.IsCheckedoutToLocal);s.push("','");s.push(n.PermMask);ListModule.Settings.SupportsDoclibAccessibility?s.push('\');" tabIndex="-1" IsFolder="TRUE" aria-label="'+Encoding.HtmlEncode(j(n["File_x0020_Type.mapapp"],!1))+'"><img border="0" alt="'):s.push('\');"><img border="0" alt="');s.push(o);s.push('" title="');s.push(o);s.push('" src="');s.push((function(e){return""==e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]?ListView.ImageBasePath+"/_layouts/15/images/folder.gif?rev=47":ListView.ImageBasePath+"/_layouts/15/images/"+e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]})(n));s.push('" />');if(void 0!==n.IconOverlay&&""!=n.IconOverlay){s.push('<img width="16" height="16" src="'+ListView.ImageBasePath+"/_layouts/15/images/");null==window.OffSwitch||OffSwitch.IsActive("B35674E3-5E63-4A44-AF45-127010C82E7D")?s.push(n["IconOverlay.mapoly"]):s.push(Encoding.HtmlEncode(n["IconOverlay.mapoly"]));s.push('" class="ms-vb-icon-overlay" alt="" title="" />')}s.push("</a>")}}else if("1"==i.IsDocLib)if(void 0===n.IconOverlay||""==n.IconOverlay){var h=!1,p=null,d=void 0===n.CheckoutUser||""==n.CheckoutUser,v=void 0!==n._ComplianceFlags&&null!=n._ComplianceFlags&&4==(4&n._ComplianceFlags);if(D()){e.allowedSuiteExtensionFileTypes=["pdf"];_()&&M(e)&&(h=!0)}else{e.allowedSuiteExtensionFileTypes=["bmp","chm","gif","htm","html","jpeg","jpg","pdf","png","psd","tif","txt","wma","wmv","xml","zip"];_()&&void 0!==n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]&&(""==n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]||IE8Support.arrayIndexOf(e.allowedSuiteExtensionFileTypes,n.File_x0020_Type,0)>-1)&&(h=!0)}if(w())S();else if(d){p=ListModule.Settings.SupportsDoclibAccessibility?F(n["File_x0020_Type.mapapp"],n.File_x0020_Type):n.FileLeafRef;var m=Boolean(n["HTML_x0020_File_x0020_Type.File_x0020_Type.isIconDynamic"])?" onclick=\"this.style.display='none';\"":"";v&&(p=b());E(p,n.FileLeafRef,!0,n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"],m)}else E(p=y(),p,!0,n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"],void 0);if(!a&&(!d||v)){var g=ListView.ImageBasePath+"/_layouts/15/images/checkoutoverlay.gif";p=y();if(d&&v){p=b();g=ListView.ImageBasePath+"/_layouts/15/images/lockoverlay.png"}s.push('<img src="'+g+'" class="ms-vb-icon-overlay" alt="');s.push(p);s.push('" title="');s.push(p);s.push('" />')}}else{E(n.FileLeafRef,n.FileLeafRef,!1,n["IconOverlay.mapico"],void 0);s.push('<img width="16" height="16" src="'+ListView.ImageBasePath+"/_layouts/15/images/");null==window.OffSwitch||OffSwitch.IsActive("B35674E3-5E63-4A44-AF45-127010C82E7D")?s.push(n["IconOverlay.mapoly"]):s.push(Encoding.HtmlEncode(n["IconOverlay.mapoly"]));s.push('" class="ms-vb-icon-overlay" alt="" title="" />')}else E(n.FileLeafRef,n.FileLeafRef,!1,n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"],void 0);function y(){return n.FileLeafRef+"&#10;"+window.ListView.Strings.L_SPCheckedoutto+": "+(Boolean(n.CheckoutUser)?Encoding.HtmlEncode(n.CheckoutUser[0].title):"")}function b(){return n.FileLeafRef+"&#10;"+window.ListView.Strings.L_Tag_Callout_BlockDeleteItem}function w(){return ListModule.Settings.SupportsPolicyTips&&void 0!==n._ip_UnifiedCompliancePolicyUIAction&&Number(n._ip_UnifiedCompliancePolicyUIAction)>0&&!a}function E(t,r,i,o,a){s.push('<img width="16" height="16" border="0" alt="');s.push(t);D()?h&&s.push('" class="registerFileIcon'):h&&(""==n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]||IE8Support.arrayIndexOf(e.allowedSuiteExtensionFileTypes,n.File_x0020_Type,0)>-1)&&s.push('" class="registerFileIcon');s.push('" title="');s.push(r);if(void 0!==u){s.push('" id="');s.push(u)}i&&h&&""==o&&(o="icgen.gif");s.push('" src="'+ListView.ImageBasePath+"/_layouts/15/images/"+o);s.push('"');void 0!==a&&s.push(a);s.push("/>")}function S(){var t,r;if(1==Number(n._ip_UnifiedCompliancePolicyUIAction)){t="dlpalert.png";r=window.ListView.Strings.L_DLP_Callout_PolicyTip}else{t="dlpblock.png";r=window.ListView.Strings.L_DLP_Callout_BlockedItem}E(r,r,!0,t,' class="ms-listview-policyTipIcon"');var i=!1;A(e,function(){if(!i){i=!0;var t=document.getElementById(u);Boolean(t)&&DOM.AddEventHandler(t,"onclick",function(t){1!=Number(n._ip_UnifiedCompliancePolicyUIAction)&&3!=Number(n._ip_UnifiedCompliancePolicyUIAction)||"function"==typeof LaunchDlpDialog&&LaunchDlpDialog(n,e,"DocIcon")},!1)}})}return s.join("")}function u(e,t,n,r){return a(e,n,r,n.Title)}function a(t,n,r,i){var s=[];"1"==n.FSObjType?"1"==r.IsDocLib?K(t,s,I(i),n,r):J(s,I(i),n,r):B(s,t,n,r,I(i),void 0);e(n,0,s);return s.join("")}function l(e,t,n,r){var i=[];i.push('<a href="'+z(n.FileRef,void 0)+'">');i.push('<img galleryimg="false" border="0"');i.push(' id="'+n.ID+'webImgShrinked"');"PreviewOnForm"!=t.Name&&i.push(' class="ms-displayBlock"');var s=("PreviewOnForm"==t.Name?"256":"128")+"px";i.push(' style="max-width: '+s+"; max-height: "+s+'; margin:auto; visibility: hidden;"');i.push(' onerror="displayGenericDocumentIcon(event.srcElement ? event.srcElement : event.target, '+n.FSObjType+'); return false;"');i.push(" onload=\"(event.srcElement ? event.srcElement : event.target).style.visibility = 'visible';\"");i.push(' alt="');var o=n._Comments;null!=o&&""!=o?i.push(Encoding.HtmlEncode(o)):i.push(window.ListView.Strings.L_ImgAlt_Text);i.push('" src="'+z((function(e,t,n){var r,i=function(t){return"1"==e[t+".value"]&&ListModule.Util.isDefinedAndNotNullOrEmpty(e["FileLeafRef.Name"])&&ListModule.Util.isDefinedAndNotNullOrEmpty(a)||""==e[t+".value"]&&null!=n&&109==n.ListTemplateType},s=""==e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"];r=void 0===t||16===t?"":s?String(t):32===t?"lg_":String(t)+"_";U(e);(function(e){if(void 0===e["FileLeafRef.Suffix"]){var t=e.FileLeafRef,n=t.lastIndexOf(".");e["FileLeafRef.Suffix"]=n>=0?t.substring(n+1):""}})(e);(function(e){if(void 0===e.FileDirRef){var t=e.FileRef;if(Boolean(t)){var n=t.indexOf("/"),r=t.lastIndexOf("/");e.FileDirRef=r>=0?t.substring(n,r-n):""}}})(e);var o=e.AlternateThumbnailUrl,u=ListModule.Util.isDefinedAndNotNullOrEmpty(o),a=e["FileLeafRef.Suffix"],f=i("PreviewExists"),l=i("ThumbnailExists"),c=ListModule.Util.isDefinedAndNotNullOrEmpty(a)&&("mp3"==a||"wma"==a||"wav"==a||"oga"==a),h="undefined"!=typeof ctx?ctx:n;return""!=r&&(u||f||l)?u?String(o):e.FileDirRef+"/_w/"+e["FileLeafRef.Name"]+"_"+e["FileLeafRef.Suffix"]+".jpg":c?h.imagesPath+"audiopreview.png":s?h.imagesPath+"folder"+r+".gif":h.imagesPath+r+e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]})(n,256,e),void 0)+'"/>');i.push("</a>");return i.join("")}return{URLwMenu:function(e,t,n,r){var i;if("1"==n.FSObjType){var s=[];s.push('<a onfocus="OnLink(this)" href="SubmitFormPost()" onclick="ClearSearchTerm(\'');s.push(r.View);s.push("');ClearSearchTerm('');SubmitFormPost('");s.push(r.PagePath);s.push("?RootFolder=");s.push(URI_Encoding.encodeURIComponent(n.FileRef));s.push(r.ShowWebPart);s.push("&FolderCTID=");s.push(n.ContentTypeId);s.push("');return false;\">");s.push(n.FileLeafRef);s.push("</a>");i=s.join("")}else i=W(n,"URL",r,t,!0);return i},URLNoMenu:function(e,t,n,r){return W(n,"URL",r,t,!0)},mswh_Title:function(e,t,n,r){var i=[];i.push('<a onfocus="OnLink(this)" href="');i.push(n.FileRef);i.push('" onclick="LaunchWebDesigner(');i.push("'");i.push(n.FileRef);i.push("','design'); return false;");i.push('">');i.push(I(n.Title));i.push("</a>");return i.join("")},LinkTitle:u,LinkTitleNoMenu:u,Edit:function(e,t,n,r){if(ListModule.Util.hasEditPermission(n)){var i=(function(e,t){return"4"==e.EventType?e.ID+".1."+e.MasterSeriesItemID:e.ID})(n),s=[];s.push('<a href="');s.push(e.editFormUrl);s.push("&ID=");s.push(i);s.push('" onclick="EditItemWithCheckoutAlert(event, \'');s.push(e.editFormUrl);s.push("&ID=");s.push(i);s.push("', '");s.push((function(e,t){var n=void 0===e.CheckoutUser||""==e.CheckoutUser;return"1"==t.ForceCheckout&&"1"!=e.FSObjType&&n?"1":""})(n,r));s.push("', '");s.push(n.IsCheckedoutToLocal);s.push("', '");s.push(escape(n.FileRef));s.push("', '");s.push(r.HttpVDir);s.push("', '");s.push(n.CheckedOutUserId);s.push("', '");s.push(r.Userid);s.push('\');return false;" target="_self">');s.push('<img border="0" alt="');s.push(window.ListView.Strings.L_SPClientEdit);s.push('" src="'+ListView.ImageBasePath+'/_layouts/15/images/edititem.gif?rev=47"/></a>');return s.join("")}return"&nbsp;"},DocIcon:o,MasterPageIcon:o,LinkFilename:function(e,t,n,r){return s(e,n,r)},LinkFilenameNoMenu:function(e,t,n,r){return s(e,n,r)},NumCommentsWithLink:function(e,n,r,s){var o=[];o.push(t("",window.ListView.Strings.L_SPClientNumComments,"-396",window.ListView.Strings.L_SPClientNumComments,window.ListView.Strings.L_SPClientNumComments,s,r));o.push('<span><a href="');i(o,s,r);o.push('">&nbsp;');o.push(r.NumComments);o.push("&nbsp;");o.push("Comment(s)");o.push("</a></span>");return o.join("")},EmailPostLink:function(e,n,r,i){return t("javascript:navigateMailToLink('",window.ListView.Strings.L_SPEmailPostLink,"-267",window.ListView.Strings.L_SPEmailPostLink,window.ListView.Strings.L_SPEmailPostLink,i,r)},Permalink:function(e,n,r,i){return t("","Permanent Link to Post","-412","Permanent Link to Post","Permanent Link to Post",i,r)},CategoryWithLink:function(e,t,n,r){var i=[];i.push('<a class="static menu-item" href="');i.push(r.HttpVDir);i.push("/");i.push("lists/Categories/Category.aspx?CategoryId=");i.push(n.ID);i.push('" id="blgcat');i.push(n.ID);i.push('"><span class="additional-backgroud"><span class="menu-item-text">');i.push(n.Title);i.push("</span></span></a>");return i.join("")},LinkIssueIDNoMenu:function(e,t,n,r){var i=[];i.push('<a href="');i.push(e.displayFormUrl);i.push("&ID=");i.push(n.ID);i.push('" onclick="');Le(i,n,"Navigation");i.push("EditLink2(this,");i.push(e.ctxId);i.push(');return false;" target="_self">');i.push(n.ID);i.push("</a>");return i.join("")},SelectTitle:function(e,t,n,r){if(r.SelectedID==n.ID||"-1"==r.SelectedID&&1==n.firstRow)return'<img border="0" align="absmiddle" style="cursor: hand" src="'+ListView.ImageBasePath+'/_layouts/15/images/rbsel.gif" alt="'+window.ListView.Strings.L_SPSelected+'" />';var i=[];i.push("<a href=\"javascript:SelectField('");i.push(r.View);i.push("','");i.push(n.ID);i.push("');return false;\" onclick=\"SelectField('");i.push(r.View);i.push("','");i.push(n.ID);i.push('\');return false;" target="_self">');i.push('<img border="0" align="absmiddle" style="cursor: hand" src="'+ListView.ImageBasePath+'/_layouts/15/images/rbunsel.gif"  alt="');i.push(window.ListView.Strings.L_SPGroupBoardTimeCardSettingsNotFlex);i.push('" /></a>');return i.join("")},DisplayResponse:function(e,t,n,r){var i=[];i.push('<a onfocus="OnLink(this)" href="');i.push(e.displayFormUrl);i.push("&ID=");i.push(n.ID);i.push('" onclick="GoToLinkOrDialogNewWindow(this);return false;" target="_self" id="onetidViewResponse">');i.push(window.ListView.Strings.L_SPView_Response);i.push(" #");i.push(n.ID);i.push("</a>");return i.join("")},Completed:function(e,t,n,r){return"1"==n._Level?window.ListView.Strings.L_SPYes:window.ListView.Strings.L_SPNo},RepairDocument:function(e,t,n,r){return'<input id="chkRepair" type="checkbox" title="'+window.ListView.Strings.L_SPRelink+'" docID="'+n.ID+'" />'},Combine:function(e,t,n,r){if("0"==n.FSObjType){var i='<input id="chkCombine" type="checkbox" title="';i+=window.ListView.Strings.L_SPMerge;i+='" href="';i+=("0"==n.FSObjType?String(r.HttpVDir)+String(n.FileRef):n.FileRef)+'" />';i+='<input id="chkUrl" type="hidden" href="';i+=n.TemplateUrl;i+='" />';i+='<input id="chkProgID" type="hidden" href="';i+=n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"];return i+='" />'}return""},HealthReportSeverityIcon:function(e,t,n,r){var i,s=new String(n.HealthReportSeverity),o=s.indexOf(" - ");i="1"==(s=s.substring(0,o))?"hltherr":"2"==s?"hlthwrn":"3"==s?"hlthinfo":"4"==s?"hlthsucc":"hlthfail";return'<img src="'+ListView.ImageBasePath+"/_layouts/15/images/"+i+'.png" alt="'+s+'" />'},FileSizeDisplay:function(e,t,n,r){return"0"==n.FSObjType?String(Math.ceil(n.File_x0020_Size/1024))+" KB":""},NameOrTitle:function(e,t,n,r){return a(e,n,r,n.FileLeafRef)},ImageSize:function(e,t,n,r){var i=[];if("0"==n.FSObjType&&""!=n.ImageWidth&&"0"!=n.ImageWidth){i.push('<span dir="ltr">');i.push(n.ImageWidth+" x "+n.ImageHeight);i.push("</span>")}return i.join("")},ThumbnailOnForm:l,PreviewOnForm:l,Thumbnail:l,FileType:function(e,t,n,r){return n.File_x0020_Type},_IsRecord:function(e,t,n,r){return void 0!==n._ComplianceFlags&&null!=n._ComplianceFlags&&(4==(4&n._ComplianceFlags)||256==(256&n._ComplianceFlags))?window.ListView.Strings.L_SPYes:window.ListView.Strings.L_SPNo}}})());q.prototype={fieldRenderer:null,fldName:null,RenderField:R};v=function(e,t,r,i,s){var o=[],u=e.ListSchema,a=n.JsGridUtil.Internal.IsFeatureEnabled(b)&&e.fixedHeightRowEnabled?" "+f.cellHiddenOverflow:"";o.push('<div class="ms-vb '+(1==s?"":"ms-tableCell ms-list-TitleLink")+a+' ms-vb-menuPadding itx" CTXName="ctx');o.push(e.ctxId);o.push('" id="');o.push(t.ID);o.push('" Field="');o.push(r.Name);o.push('" Perm="');o.push(t.PermMask);o.push('" EventType="');o.push(t.EventType);o.push('">');o.push(i);o.push("</div>");if(1==s){o.push('</td><td class="ms-list-itemLink-td ms-cellstyle');u.Field[u.Field.length-1]==r&&o.push(" ms-vb-lastCell");o.push('">')}if(!PageMinimized()){o.push('<div class="ms-list-itemLink '+(1==s?"":"ms-tableCell ms-alignRight")+'" ');o.push("onclick=\"CoreInvoke('ShowECBMenuForTr', this, event");o.push(", ListView.Strings");o.push('); return false;">');o.push('<a ms-jsgrid-click-passthrough="true" class="ms-lstItmLinkAnchor ms-ellipsis-a" title="');o.push(Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenuECB));o.push('" aria-haspopup="true" ');o.push("onclick=\"CoreInvoke('ShowECBMenuForTr', this.parentNode, event");o.push(", ListView.Strings");o.push('); return false; " href="#" >');o.push('<img class="ms-ellipsis-icon" src="'+n.JsGridUtil.Internal.GetImageUrl("spcommon.png")+'" alt="'+Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenu)+'" /></a>');o.push("</div>")}return o.join("")};Q.prototype={fldName:null,RenderField:G};Y.prototype={fldName:null,RenderField:Z};ee.prototype={fldName:null,RenderField:te};ne.prototype={fldName:null,RenderField:re};ie.prototype={fldName:null,RenderField:se};oe.prototype={fldName:null,RenderField:ue};ae.prototype={fldName:null,RenderField:fe};le.prototype={fldName:null,RenderField:ce};he.prototype={fldName:null,RenderField:pe};de.prototype={fldName:null,RenderField:ve};me.prototype={fldName:null,RenderField:ge};ye.prototype={fldName:null,RenderField:be};null==window.OffSwitch||OffSwitch.IsActive("39A8E192-9EFC-4922-9FD8-343D685E163C")||(we.prototype={fldName:null,RenderField:Ee});Se.prototype={fldName:null,RenderField:xe};Te.prototype={fldName:null,RenderField:Ce};ke.prototype={NewGroup:void 0,RenderField:void 0,RenderFieldByName:void 0};t.spMgr=new ke;"function"==typeof window.RegisterSharedWithFieldRenderer&&window.RegisterSharedWithFieldRenderer()};t.InitListViewFlightSettings=function(){if(!Boolean(c)){ListModule.Settings.SupportsFileExtensionControls=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(439);ListModule.Settings.SupportsFileHandlerForAllNonOfficeFiles=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(754);ListModule.Settings.SupportsFileExtensionDataPipe=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(461);ListModule.Settings.SupportsFileHandlerAddInPicker=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(512);ListModule.Settings.SupportsFileHandlerFileCreation=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(540);ListModule.Settings.SupportsAddToOneDrive=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134);ListModule.Settings.SupportsAddToOneDriveQCB=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(161);ListModule.Settings.SupportsPeopleHoverCard=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(0);ListModule.Settings.SupportsMaintainUserChrome=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(63);ListModule.Settings.SupportsInfiniteScroll=!1;ListModule.Settings.SupportsAddToOneDriveInSync=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(259);ListModule.Settings.SupportsPolicyTips=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(340);ListModule.Settings.SupportsRightClickECB=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(249)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(383)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(104);ListModule.Settings.SupportsShortcutLink=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(563);ListModule.Settings.SupportsDoclibAccessibility=!n.JsGridUtil.SPListView||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(169);ListModule.Settings.SupportsDoclibQCB=!n.JsGridUtil.SPListView||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(60);c=!0}};function N(e){for(var t=0;t<p.length;t++)p[t].ToggleExpandByImg(e.target.parentNode);e.stopPropagation()}function C(e,t){for(var n=0;n<p.length;n++)if(p[n].Matches(e))return p[n];return new d(e,t)}t.GetClientHierarchyManagerForWebpart=C;function k(e,n,r,i){if(t.SPClientRenderer.IsDebugMode(n))return e();try{return e()}catch(e){null==n.Errors&&(n.Errors=[]);try{e.ExecutionContext=i;Boolean(t.SPClientRenderer.AddCallStackInfoToErrors)&&"object"==typeof i&&null!=i&&"function"==typeof window.ULSGetCallstack&&(i.CallStack=window.ULSGetCallstack(k.caller))}catch(e){}n.Errors.push(e);return r}}function L(e,n){return k(function(){return(function(e,n){var r;"string"==typeof e?r=t.SPClientRenderer.ParseTemplateString(e,n):"function"==typeof e&&(r=e);return null==r?"":r(n)})(e,n)},n,"",{TemplateFunction:e,Operation:"CoreRender"})}function A(e,t){(function(e,t,n,r){if(Boolean(e)&&"function"==typeof n&&""!=t){var i=e[t];if(null==i)e[t]=n;else if("function"==typeof i){if(!Boolean(r)||String(i)!=String(n)){var s=[];s.push(i);s.push(n);e[t]=s}}else if("object"==typeof i){var o=!1;if(Boolean(r))for(var u=0;u<i.length;u++)if(i[u]==n){o=!0;break}o||e[t].push(n)}}})(e,"OnPostRender",t,!1)}function O(e,t,n){if(null==e||null==t||null==n)return null;for(var r="",i=-1,s=[],o=0,u=(s=s.concat(t.split("||"))).length;o<u;o++){var a=s[o];if(null!=a&&""!=a){for(var f=[],l=0,c=(f=f.concat(a.split(","))).length;l<c;l++){var h=f[l];if(null!=h&&""!=h)if(isNaN(Number(h))){if(-1!=h.indexOf("-")){var p,d=h.split("-");if(null==d||2!==d.length)continue;if(""===d[0])p=0;else{if(isNaN(Number(d[0])))continue;p=parseInt(d[0])}if(n>=p){if(""===d[1]){i=o;break}if(isNaN(Number(d[1])))continue;if(n<=parseInt(d[1])){i=o;break}}}else if(-1!=h.indexOf("*")){var v=h.trim().replace(/\*/g,"[0-9]*");if(new RegExp("^"+v+"$").test(n.toString())){i=o;break}}}else{if(n===parseInt(h)){i=o;break}}}if(-1!==i)break}}if(-1!==i){var m=e.split("||");null!=m&&null!=m[i]&&""!=m[i]&&(r=m[i])}return r}function M(e){return void 0!==e.allowedSuiteExtensionFileTypes&&IE8Support.arrayIndexOf(e.allowedSuiteExtensionFileTypes,e.CurrentItem.File_x0020_Type,0)>-1||!Boolean(e.CurrentItem["File_x0020_Type.mapapp"])&&!Boolean(e.CurrentItem["serverurl.progid"])}function _(){return!(BrowserDetection.userAgent.ie8down||!ListModule.Settings.SupportsFileExtensionControls)}function D(){return!(BrowserDetection.userAgent.ie8down||!ListModule.Settings.SupportsFileHandlerForAllNonOfficeFiles)}function P(e){return null!=e&&null!=e.ListSchema&&"1"==e.ListSchema.TabularView&&1!=e.inGridMode}function H(e){return null!=e&&null!=e.CurrentFieldValue?e.CurrentFieldValue.toString():""}t.RenderFieldValueDefault=H;function B(e,t,r,i,s,o){var u=n.JsGridUtil.Internal.IsFeatureEnabled(b)?" "+f.listLink:"";e.push('<a class="ms-listlink'+u+'" onfocus="OnLink(this)" href="');e.push(ListModule.Util.createItemPropertiesTitleUrl(t,r));e.push('" onclick="');Le(e,r,"Navigation");e.push("EditLink2(this,");e.push(t.ctxId);e.push(');return false;" target="_self">');e.push(Boolean(i.HasTitle)||Boolean(o)?s:Encoding.HtmlEncode(s));e.push("</a>")}function j(e,t){return null!=e&&-1!=e.toLowerCase().indexOf("onenote")?t?window.ListView.Strings.L_FieldType_File_OneNote:window.ListView.Strings.L_FieldType_Folder_OneNote:window.ListView.Strings.L_FieldType_Folder}function F(e,t){var n=window.ListView.Strings.L_FieldType_File;null!=e&&""!=e?-1!=e.toLowerCase().indexOf("ms-word")?n=window.ListView.Strings.L_FieldType_File_Document:-1!=e.toLowerCase().indexOf("ms-excel")?n=window.ListView.Strings.L_FieldType_File_workbook:-1!=e.toLowerCase().indexOf("ms-powerpoint")?n=window.ListView.Strings.L_FieldType_File_PPT:-1!=e.toLowerCase().indexOf("onenote")&&(n=window.ListView.Strings.L_FieldType_File_OneNote):null!=t&&""!=t&&(n=t+" "+window.ListView.Strings.L_FieldType_File);return n}function I(e){return""==e?window.ListView.Strings.L_SPClientNoTitle:e}function q(e){this.fldName=e;this.fieldRenderer=null}function R(e,t,n,r){null==this.fieldRenderer&&(this.fieldRenderer=window.ComputedFieldWorker[this.fldName]);return null!=this.fieldRenderer?this.fieldRenderer(e,t,n,r):Encoding.HtmlEncode(n[this.fldName])}function U(e){if(void 0===e["FileLeafRef.Name"]){var t=e.FileLeafRef,n=t.lastIndexOf(".");e["FileLeafRef.Name"]=n>=0?t.substring(0,n):t}}function z(e,t){return void 0!==e&&null!=e?t?e.replace(/'/g,"%27"):e.replace(/"/g,"%22"):""}function W(e,t,r,i,s){var o=[],u=e[t],a=e[t+".desc"];if("Image"==i.Format){if(ListModule.Util.isDefinedAndNotNullOrEmpty(u)){o.push("<img ");if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(494)){o.push(" class='ms-listview-image' ");o.push(" onclick='javascript:var imgUrl=\"");o.push(z(u,void 0));o.push("\"; if (_shouldOpenInLightbox(imgUrl)){_openInLightbox(imgUrl);} else{STSNavigate(imgUrl);}'")}s&&o.push('onfocus="OnLink(this)" ');o.push('src="');o.push(z(u,void 0));o.push('" alt="');o.push(a);o.push('"/>')}}else if("Hyperlink"==i.Format)if(ListModule.Util.isDefinedAndNotNullOrEmpty(u)){o.push("<a ");n.JsGridUtil.Internal.IsFeatureEnabled(x)&&o.push('tabindex="-1" ');s&&o.push('onfocus="OnLink(this)" ');o.push('href="');o.push(z(u,void 0));var f=void 0===Nav.ajaxNavigate?window.location.search.match(RegExp("[?&]IsDlg=1")):Nav.ajaxNavigate.get_search().match(RegExp("[?&]IsDlg=1"));Boolean(f)&&o.push('" target="_blank');o.push('">');""==a?o.push(Encoding.HtmlEncode(u)):o.push(Encoding.HtmlEncode(a));o.push("</a>")}else null!=a&&o.push(a);return o.join("")}function X(){var e=new URI(Nav.ajaxNavigate.get_href()).getQueryParameter("MaintainUserChrome");return ListModule.Settings.SupportsMaintainUserChrome&&Boolean(e)&&"true"==e.toLowerCase()}function V(e,t){var n=e.AdditionalQueryString;void 0!==n&&""!=n&&t.push(n)}function $(e,t,n){n.push(t.PagePath);n.push("?RootFolder=");n.push(URI_Encoding.encodeURIComponent(e.FileRef));n.push(t.ShowWebPart);n.push("&FolderCTID=");n.push(e.ContentTypeId);n.push("&View=");n.push(URI_Encoding.encodeURIComponent(t.View));V(e,n)}function J(e,t,n,r){e.push('<a onfocus="OnLink(this)" href="');$(n,r,e);e.push('" onclick="');Le(e,n,"Navigation");e.push("javascript:EnterFolder('");e.push(r.PagePath);e.push("?RootFolder=");e.push(URI_Encoding.encodeURIComponent(n.FileRef));e.push(r.ShowWebPart);e.push("&FolderCTID=");e.push(n.ContentTypeId);e.push("&View=");e.push(URI_Encoding.encodeURIComponent(r.View));V(n,e);if(ListModule.Settings.SupportsDoclibAccessibility){e.push('\');return false;" aria-label="');e.push(Encoding.HtmlEncode(t));e.push(", "+Encoding.HtmlEncode(j(n["File_x0020_Type.mapapp"],!0))+'">')}else e.push("');return false;\">");e.push(Encoding.HtmlEncode(t));e.push("</a>")}function K(e,t,r,i,s){X()&&(function(e,t,n){var r=e.AdditionalQueryString;if(void 0!==r&&""!=r){var i=new URI(e.FileRef+"?"+r);i.setQueryParameter(t,n);e.AdditionalQueryString="&"+i.getQuery()}else e.AdditionalQueryString="&"+t+"="+n})(i,"MaintainUserChrome","true");var o=n.JsGridUtil.Internal.IsFeatureEnabled(b)?" "+f.listLink:"";t.push('<a onfocus="OnLink(this)" class="ms-listlink'+o+'" href="');$(i,s,t);t.push('" onmousedown="');t.push("javascript:VerifyFolderHref(this,event,'");t.push(i["File_x0020_Type.url"]);t.push("','");t.push(i["File_x0020_Type.progid"]);t.push("','");t.push(s.DefaultItemOpen);t.push("','");t.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);t.push("','");t.push(i.HTML_x0020_File_x0020_Type);t.push("','");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?t.push(Encoding.ScriptEncode(i["serverurl.progid"])):t.push(i["serverurl.progid"]);t.push("');");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(226)||t.push("return false;");t.push('" onclick="');Le(t,i,"Navigation");t.push("return HandleFolder(this,event,'");t.push(s.PagePath);t.push("?RootFolder=");t.push(URI_Encoding.encodeURIComponent(i.FileRef));t.push(s.ShowWebPart);t.push("&FolderCTID=");t.push(i.ContentTypeId);t.push("&View=");t.push(URI_Encoding.encodeURIComponent(s.View));V(i,t);var u=ListModule.Util.makeMountedFolderQueryStrParams(!0,!0);Boolean(u)&&t.push(u);t.push("','TRUE','FALSE','");t.push(i["File_x0020_Type.url"]);t.push("','");t.push(i["File_x0020_Type.progid"]);t.push("','");t.push(s.DefaultItemOpen);t.push("','");t.push(i["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"]);t.push("','");t.push(i.HTML_x0020_File_x0020_Type);t.push("','");Flighting.VariantConfiguration.IsExpFeatureClientEnabled(90)?t.push(Encoding.ScriptEncode(i["serverurl.progid"])):t.push(i["serverurl.progid"]);t.push("','");t.push(Boolean(i.CheckoutUser)?i.CheckoutUser[0].id:"");t.push("','");t.push(s.Userid);t.push("','");t.push(s.ForceCheckout);t.push("','");t.push(i.IsCheckedoutToLocal);t.push("','");t.push(i.PermMask);if(ListModule.Settings.SupportsDoclibAccessibility){t.push('\');" aria-label="');t.push(Encoding.HtmlEncode(r));t.push(", "+Encoding.HtmlEncode(j(i["File_x0020_Type.mapapp"],!0))+'">')}else t.push("');\">");t.push(Encoding.HtmlEncode(r));t.push("</a>")}function Q(e){this.fldName=e}function G(e,t,n,r){return Encoding.HtmlEncode(n[this.fldName])}function Y(e){this.fldName=e}function Z(e,t,n,r){return n[this.fldName]}function ee(e){this.fldName=e}function te(e,t,r,i){return"0"!=r[this.fldName]?'<img border="0" width="16" height="16" src="'+n.JsGridUtil.Internal.GetImageUrl("attach16.png")+'"/>':""}function ne(e){this.fldName=e}function re(e,t,n,r){var i=n[this.fldName],s='<img border="0" width="16" height="16" src="';s+=ListView.ImageBasePath;s+="/_layouts/15/images/";if("1"==i){var o=n.EventType;s+="3"==o||"4"==o?"recurEx.gif":"recur.gif"}else s+="blank.gif";s+='" alt="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;s+='" title="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;return s+='"/>'}function ie(e){this.fldName=e}function se(e,t,r,i){if("1"!=r.WorkspaceLink&&"-1"!=r.WorkspaceLink)return'<img border="0" width="16" height="16" src="'+ListView.ImageBasePath+'/_layouts/15/images/blank.gif" />';var s='<a href="';s+=r.Workspace;s+='" target="_self" title="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;s+='"><img border="" src="'+n.JsGridUtil.Internal.GetImageUrl("mtgicon.gif")+'" alt="';s+=window.ListView.Strings.L_SPMeetingWorkSpace;return s+='"/></a>'}function oe(e){this.fldName=e}function ue(e,t,n,r){return n[this.fldName]==window.ListView.Strings.L_SPYes?window.ListView.Strings.L_SPYes:""}function ae(e){this.fldName=e}function fe(e,t,r,i){var s=r[this.fldName];if(n.JsGridUtil.Internal.IsFeatureEnabled(w)&&s){var o=t&&t.Unit||"None",a=t&&t.CustomUnitName||"",l=!t||!t.CustomUnitOnRight||"TRUE"===t.CustomUnitOnRight;s=u.getDisplayStringWithUnit(o,s,a,l)}n.JsGridUtil.Internal.IsFeatureEnabled(S)&&null!=t.CommaSeparator&&(s=u.formatNumberString(s,t.CommaSeparator));null==window.OffSwitch||OffSwitch.IsActive("856528C6-8452-44E4-A756-32C6E13004E3")||"Calculated"!=t.FieldType||(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(68)||Boolean(_spPageContextInfo)&&Boolean(_spPageContextInfo.AllowCustomMarkupInCalculatedField)?s=Encoding.HtmlEncode(s):t.scriptLogged||(t.scriptLogged=!0));return'<div align="right" class="ms-number'+(n.JsGridUtil.Internal.IsFeatureEnabled(b)&&e.fixedHeightRowEnabled?" "+f.cellHiddenOverflow:"")+'">'+s+"</div>"}function le(e){this.fldName=e}function ce(e,t,n,r){var i=e.CurrentFieldSchema,s=n[this.fldName];""==s&&(s=window.ListView.Strings.L_BusinessDataField_Blank);var o='<table cellpadding="0" cellspacing="0" style="display=inline">';o+="<tr>";if(Boolean(i.HasActions)){o+='<td><input type="hidden" name="BusinessDataField_ActionsMenuProxyPageWebUrl" id="BusinessDataField_ActionsMenuProxyPageWebUrl" value="'+e.HttpRoot+'" />';o+='<div style="display=inline">';o+='<table cellspacing="0">';o+="<tr>";o+='<td class="ms-vb" valign="top" nowrap="nowrap">';o+='<span class="ms-SPLink ms-hovercellinactive" onmouseover="this.className=\'ms-SPLink ms-HoverCellActive\';" onmouseout="this.className=\'ms-SPLink ms-HoverCellInactive\';">';var u="",a="",f="";if(Boolean(e.ExternalDataList)){u="showActionMenuInExternalList("+(f="'"+window.ListView.Strings.L_BusinessDataField_ActionMenuLoadingMessage+"',null,true,'"+e.LobSystemInstanceName+"','"+e.EntityNamespace+"','"+e.EntityName+"','"+e.SpecificFinderName+"','"+i.AssociationName+"','"+i.SystemInstanceName+"','"+i.EntityNamespace+"','"+i.EntityName+"','"+n.ID+"', event")+")";a="actionMenuOnKeyDownInExternalList("+f+")"}else if(void 0!==t.RelatedField&&""!=t.RelatedField&&void 0!==n[t.RelatedField]&&""!=n[t.RelatedField]){u="showActionMenu("+(f="'"+window.ListView.Strings.L_BusinessDataField_ActionMenuLoadingMessage+"',null,true,'"+i.SystemInstanceName+"','"+i.EntityNamespace+"','"+i.EntityName+"','"+n[t.RelatedField]+"', event")+")";a="actionMenuOnKeyDown("+f+")"}o+='<a style="cursor:hand;white-space:nowrap;">';o+='<img border="0" align="absmiddle" src='+ListView.ImageBasePath+'/_layouts/15/images/bizdataactionicon.gif?rev=47 tabindex="0" alt="'+window.ListView.Strings.L_BusinessDataField_ActionMenuAltText+'" title="'+window.ListView.Strings.L_BusinessDataField_ActionMenuAltText+'"';o+=' onclick="'+u+'"';o+=' onkeydown="'+a+'" />';o+="</a>";o+="<a>";o+='<img align="absmiddle" src='+ListView.ImageBasePath+'/_layouts/15/images/menudark.gif?rev=47 tabindex="0" alt="'+window.ListView.Strings.L_BusinessDataField_ActionMenuAltText+'"';o+=' onclick="'+u+'"';o+=' onkeydown="'+a+'" />';o+="</a>";o+="</span>";o+="</td>";o+="</tr>";o+="</table>";o+="</div>";o+='<div STYLE="display=inline" />';o+="</td>"}o+='<td class="ms-vb">';""!=i.Profile&&"True"==i.ContainsDefaultAction?o+='<a href="'+e.HttpRoot+i.Profile+n[t.RelatedField]+'" >'+s+"</a>":o+=s;o+="</td>";o+="</tr>";return o+="</table>"}function he(e){this.fldName=e}function pe(e,t,r,o){var u,f,l,c,h=r[this.fldName];null==window.OffSwitch||OffSwitch.IsActive("856528C6-8452-44E4-A756-32C6E13004E3")||"Calculated"!=t.FieldType||(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(68)?h=Encoding.HtmlEncode(h):t.scriptLogged||(t.scriptLogged=!0));if(null==h)return"";var p=r[this.fldName+".FriendlyDisplay"],d=null;null!=p&&""!=p&&(d=y?(function(e){var t=null,n=null,r=e.split("|"),i=Boolean(window.ListView)&&Boolean(window.ListView.Strings)?window.ListView.Strings:Strings.STS;if("0"==r[0])return e.substring(2);var s="1"==r[1],o=r[2],u=r.length>=4?r[3]:null,a=r.length>=5?r[4]:null;switch(o){case"1":t=s?i.L_RelativeDateTime_AFewSecondsFuture:i.L_RelativeDateTime_AFewSeconds;break;case"2":t=s?i.L_RelativeDateTime_AboutAMinuteFuture:i.L_RelativeDateTime_AboutAMinute;break;case"3":n=O(s?i.L_RelativeDateTime_XMinutesFuture:i.L_RelativeDateTime_XMinutes,s?i.L_RelativeDateTime_XMinutesFutureIntervals:i.L_RelativeDateTime_XMinutesIntervals,Number(u));break;case"4":t=s?i.L_RelativeDateTime_AboutAnHourFuture:i.L_RelativeDateTime_AboutAnHour;break;case"5":null==u?t=s?i.L_RelativeDateTime_Tomorrow:i.L_RelativeDateTime_Yesterday:n=s?i.L_RelativeDateTime_TomorrowAndTime:i.L_RelativeDateTime_YesterdayAndTime;break;case"6":n=O(s?i.L_RelativeDateTime_XHoursFuture:i.L_RelativeDateTime_XHours,s?i.L_RelativeDateTime_XHoursFutureIntervals:i.L_RelativeDateTime_XHoursIntervals,Number(u));break;case"7":null==a?t=u:n=i.L_RelativeDateTime_DayAndTime;break;case"8":n=O(s?i.L_RelativeDateTime_XDaysFuture:i.L_RelativeDateTime_XDays,s?i.L_RelativeDateTime_XDaysFutureIntervals:i.L_RelativeDateTime_XDaysIntervals,Number(u));break;case"9":t=i.L_RelativeDateTime_Today}if(null!=n){t=n.replace("{0}",u);null!=a&&(t=t.replace("{1}",a))}return t})(p):a.getRelativeDateTimeStringForLists(p));var v='<span class="ms-noWrap" title="'+h+'">',m=!n.JsGridUtil.SpRegionalSettings.calendarType||1===n.JsGridUtil.SpRegionalSettings.calendarType;if(""!==h&&n.JsGridUtil.Internal.IsFeatureEnabled(E)&&t&&m&&!n.JsGridUtil.Internal.IsIEBrowser()){var g=i.DateFormat[t.DateFormat],b=i.TimeFormat[t.TimeFormat],w=r[this.fldName+"."],S=w?new Date(w):void 0,x=null===(f=null===(u=_spPageContextInfo)||void 0===u?void 0:u.webTimeZoneData)||void 0===f?void 0:f.Bias,N=null===(c=null===(l=_spPageContextInfo)||void 0===l?void 0:l.webTimeZoneData)||void 0===c?void 0:c.DaylightBias,C={includeDate:!0,includeTime:!(t.Format===T),dateFormat:g,timeFormat:b,locale:o.Locale},k=h;if(void 0!==S&&void 0!==x&&void 0!==N){S=s.shiftTimeByTimeZoneAndDST(S,x,N);k=i.formatDateTime(S,h,d,C)}v+=d||k}else v+=null!=d&&""!=d?d:h;return v+="</span>"}function de(e){this.fldName=e}function ve(e,t,n,r){return null!=t.AutoHyperLink?n[this.fldName]:Encoding.HtmlEncode(n[this.fldName])}function me(e){this.fldName=e}function ge(e,t,r,i){var s=r[this.fldName];if(!Boolean(s))return"";if("string"==typeof s)return Encoding.HtmlEncode(s);if(null!=t.RenderAsText)return(function(e){if(!Boolean(e))return"";o=[];for(u=0;u<e.length;u++){u>0&&o.push("; ");o.push(Encoding.HtmlEncode(e[u].lookupValue))}return o.join("")})(s);if(!Boolean(t.DispFormUrl))return"";for(var o=[],u=0;u<s.length;u++){u>0&&o.push("; ");var a=[];null==window.OffSwitch||OffSwitch.IsActive("9A1172B1-4735-4132-B0A3-8CD8CFF199E8")?a.push(Encoding.ScriptEncode(t.DispFormUrl)):a.push(t.DispFormUrl);a.push("&ID=");a.push(s[u].lookupId.toString());a.push("&RootFolder=*");var f=a.join("");o.push("<a ");n.JsGridUtil.Internal.IsFeatureEnabled(x)&&o.push('tabindex="-1" ');o.push("onclick=\"OpenPopUpPage('");null==window.OffSwitch||OffSwitch.IsActive("9A1172B1-4735-4132-B0A3-8CD8CFF199E8")?o.push(f):o.push(Encoding.ScriptEncode(f));o.push("', RefreshPage); return false;\" ");o.push('href="');null==window.OffSwitch||OffSwitch.IsActive("9A1172B1-4735-4132-B0A3-8CD8CFF199E8")?o.push(f):o.push(z(f,void 0));o.push('">');o.push(Encoding.HtmlEncode(s[u].lookupValue));o.push("</a>")}return o.join("")}function ye(e){this.fldName=e}function be(e,t,r,i){var s,o,u,a,l,c=[],h=r[this.fldName];if(n.JsGridUtil.Internal.IsFeatureEnabled(b)&&e.fixedHeightRowEnabled){l=" "+f.cellHiddenOverflow;if(g){var p=document.createElement("div");p.innerHTML=h;a=p.textContent||p.innerText||h}else a="Note"===t.Type&&"FALSE"===t.RichText?null===(s=h)||void 0===s?void 0:s.replace(/\&lt;br\&gt;/g," "):"Note"===t.Type&&"TRUE"===t.RichText?null===(o=h)||void 0===o?void 0:o.replace(/(<\s*\/?\s*(div|br|p|ul|li|blockquote)\s*.*?>)|(font-size\s*.*?pt;)/g," "):h}else{l="";a=h;m||"Note"!==t.Type||"FALSE"!==t.RichText||(a=null===(u=a)||void 0===u?void 0:u.replace(/\&lt;br\&gt;/g,"<br>"))}c.push('<div dir="');c.push(t.Direction);c.push('" class="ms-rtestate-field'+l+'">');c.push(a);c.push("</div>");return c.join("")}function we(e){this.fldName=e}function Ee(e,t,n,r){var i,s=n[this.fldName];s.DisplayName?i=s.DisplayName:s.Address&&s.Address.Street&&(i=s.Address.Street);return Encoding.HtmlEncode(i)}function Se(e){this.fldName=e}function xe(e,t,n,r){return W(n,this.fldName,0,t,!1)}function Te(e){this.fldName=e}function Ne(e,t){void 0!==t.piCD&&""!=t.piCD&&void 0===e.piCD&&(e.piCD=t.piCD);void 0!==t.piPC&&""!=t.piPC&&void 0===e.piPC&&(e.piPC=t.piPC)}function Ce(e,t,n,r){var i=n[this.fldName];if("string"==typeof i&&(""==i||"***"==i))return i;var s=[],o=t.DefaultRender&&t.AllowMultipleValues;if(o&&t.InlineRender){for(var u=[],a=0;a<i.length;a++){var f=i[a];Ne(f,n);u.push(void 0)}if(1===u.length)s.push(u[0]);else if(2===u.length)s.push(StringUtil.BuildParam(Encoding.HtmlEncode(window.ListView.Strings.L_UserFieldInlineTwo),u[0],u[1]));else if(3===u.length)s.push(StringUtil.BuildParam(Encoding.HtmlEncode(window.ListView.Strings.L_UserFieldInlineThree),u[0],u[1],u[2]));else{var l="",c="";if(Boolean(t.InlineRenderMoreAsLink)){l='<a href="#" onclick="return false;" class="ms-imnMoreLink ms-link">';c="</a>"}var h=u.length-3;s.push(StringUtil.BuildParam(Encoding.HtmlEncode(window.ListView.Strings.L_UserFieldInlineMore),u[0],u[1],u[2],l,String(h),c))}}else{o&&s.push("<table style='padding:0px; border-spacing:0px; border:none'><tr><td class='ms-vb'>");var p=!0;for(var d in i){p?p=!1:t.AllowMultipleValues&&(o?s.push("</td></tr><tr><td class='ms-vb'>"):t.WithPicture||t.WithPictureDetail||t.PictureOnly||s.push("; "));var v=i[d];Ne(v,n);s.push(void 0)}o&&s.push("</td></tr></table>")}return s.join("")}function ke(){this.NewGroup=function(e,t){return"1"==e[t]};function e(e,t,n,r){if(void 0===t.FieldRenderer){var i={Computed:new q(t.Name),Attachments:new ee(t.Name),User:new Te(t.Name),UserMulti:new Te(t.Name),URL:new Se(t.Name),Note:new ye(t.Name),Recurrence:new ne(t.Name),CrossProjectLink:new ie(t.Name),AllDayEvent:new oe(t.Name),Number:new ae(t.Name),BusinessData:new le(t.Name),Currency:new ae(t.Name),DateTime:new he(t.Name),Text:new de(t.Name),Lookup:new me(t.Name),LookupMulti:new me(t.Name),WorkflowStatus:new Y(t.Name),Location:void 0};null==window.OffSwitch||OffSwitch.IsActive("39A8E192-9EFC-4922-9FD8-343D685E163C")||(i.Location=new we(t.Name));if("1"==t.XSLRender)t.FieldRenderer=new Y(t.Name);else{t.FieldRenderer=i[t.FieldType];null==t.FieldRenderer&&(t.FieldRenderer=i[t.Type])}null==t.FieldRenderer&&(t.FieldRenderer=new Q(t.Name))}return t.FieldRenderer.RenderField(e,t,n,r)}this.RenderField=function(r,i,s,o){if(void 0===i.fieldRenderer){var u,a,l=r.Templates.Fields,c=i.Name;null!=l[c]&&(u=l[c]);null!=u&&""!=u&&u!=H?"string"==typeof u?a=t.SPClientRenderer.ParseTemplateString(u,r):"function"==typeof u&&(a=u):a=e;i.fieldRenderer=a}r.CurrentFieldSchema=i;var h=i.fieldRenderer(r,i,s,o);r.CurrentFieldSchema=null;if(null!=i.Direction){var p=[];p.push('<span dir="');p.push(i.Direction);p.push('">');p.push(h);p.push("</span>");h=p.join("")}if(null!=i.linkToItem){p=[];"1"==s.FSObjType?"1"==o.IsDocLib?K(0,p,h,s,o):J(p,h,s,o):B(p,r,s,o,I(s[i.Name]),!0);h=p.join("")}o.UseParentHierarchy&&o.ParentHierarchyDisplayField==i.Name&&(h=(function(e,t,r,i,s){if(e.inGridMode)return s;var o=e.ListData.HierarchyHasIndention?22:0,u=e.ListData.HierarchyHasIndention?13:0,a=[],f=e.ctxId+","+r.ID+","+r.FSObjType,l="idExpandCollapse"+f;a.push('<span style="');r.isParent&&a.push("font-weight: bold;");a.push("float: ");a.push(DOM.rightToLeft?"right":"left");a.push("; margin-");a.push(DOM.rightToLeft?"right":"left");a.push(":");var c=parseInt(r.outlineLevel);if(c<=1)h=r.isParent?0:u;else{var h=(c-1)*o;r.isParent||(h+=u)}a.push(h);a.push('px">');a.push("<table><tr>");if(r.isParent){a.push('<td style="vertical-align: top;"><span id="');a.push(l);a.push('" class="ms-commentcollapse'+(DOM.rightToLeft?"rtl":"")+'-iconouter"><img src="');a.push(n.JsGridUtil.Internal.GetImageUrl("spcommon.png"));a.push('" class="ms-commentcollapse'+(DOM.rightToLeft?"rtl":"")+'-icon"/></span></td>')}a.push("<td>");a.push(s);a.push("</td></tr></table></span>");function p(){var t=e.hierarchyMgr;null==t&&(t=e.hierarchyMgr=C(e.wpq,DOM.rightToLeft));if(r.isParent){var i=document.getElementById(l);null!=i&&window.$addHandler(i,"click",N);var s=n.JsGridUtil.Internal.DomElement.GetInstance().GetAncestorByTag(i,"TR");null!=s&&(s.style.fontWeight="bold")}t.RegisterHierarchyNode(parseInt(r.ID),null==r.parentID?null:parseInt(r.parentID),f,l)}A(e,function(){setTimeout(p,0)});return a.join("")})(r,0,s,0,h));var d=s["CustomData."];null!=d&&void 0!==d&&0!=Boolean(d)||(null!=i.CalloutMenu?h=(function(e,t,r,i,s){var o=[],u="ctx"+e.ctxId+"_"+t.ID+"_calloutLaunchPoint",a=e.ListSchema,l=n.JsGridUtil.Internal.IsFeatureEnabled(b)&&e.fixedHeightRowEnabled?" "+f.cellHiddenOverflow:"";o.push('<div class="ms-vb '+(1==s?"":"ms-tableCell ms-list-TitleLink")+l+' itx" CTXName="ctx');o.push(e.ctxId);o.push('" id="');o.push(t.ID);if(!OffSwitch.IsActive("18AE54C9-EB03-45F3-8768-DFB1CC034209")&&t.PermMask){o.push('" Perm="');o.push(t.PermMask)}o.push('" App="');o.push(t["File_x0020_Type.mapapp"]);o.push('">');o.push(i);o.push("</div>");if(1==s){o.push('</td><td class="ms-list-itemLink-td ms-cellstyle');a.Field[a.Field.length-1]==r&&o.push(" ms-vb-lastCell");o.push('" role="gridcell">')}if(!PageMinimized())if(void 0!==t.RenderCalloutWithoutHover&&t.RenderCalloutWithoutHover)o.push(Ae(!1,t,u,!0));else{o.push('<div class="ms-list-itemLink '+(1==s?"":"ms-tableCell ms-alignRight")+' " ');o.push(' onclick="ShowMenuForTrOuter(this,event, true); return false;" >');o.push(Ae(!0,t,u,!1));o.push("</div>")}return o.join("")})(r,s,i,h,P(r)):null!=i.listItemMenu&&(h=v(r,s,i,h,P(r))));return h};this.RenderFieldByName=function(e,t,n,r){var i="",s=!1;for(var o in r.Field){var u=r.Field[o];if(u.Name==t){var a=e.CurrentFieldSchema;e.CurrentFieldSchema=u;i=this.RenderField(e,u,n,r);e.CurrentFieldSchema=a;s=!0;break}}s||(i=Encoding.HtmlEncode(n[t]));return i}}function Le(e,t,n){if(void 0!==t.piCD&&""!=t.piCD){if(void 0!==t.piPC&&""!=t.piPC){e.push("RecordClickForPaging('"+Encoding.HtmlEncode(n)+"','");e.push(Encoding.HtmlEncode(t.piCD));e.push("','");e.push(Encoding.HtmlEncode(t.piPC))}else{e.push("RecordClick('Navigation','");e.push(Encoding.HtmlEncode(t.piCD))}e.push("');")}}function Ae(e,t,r,i){var s=[],o=Boolean(i),u="ms-lstItmLinkAnchor "+(o?"ms-ellipsis-a-tile":"ms-ellipsis-a");s.push('<a ms-jsgrid-click-passthrough="true" class="'+u+'" title="');s.push(Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenuAriaLabel));s.push('" aria-haspopup="true" aria-expanded="false"');s.push('onclick="');i||Le(s,t,"Hover");e?s.push("OpenCalloutAndSelectItem(this, event, this, '"+t.ID+'\'); return false;" href="#" id="'+r+'" >'):s.push("OpenCallout(this, event, this, '"+t.ID+'\'); return false;" href="#" id="'+r+'" >');var a=o?"ms-ellipsis-icon-tile":"ms-ellipsis-icon";s.push('<img class="'+a+'" src="'+n.JsGridUtil.Internal.GetImageUrl("spcommon.png")+'" alt="'+Encoding.HtmlEncode(window.ListView.Strings.L_OpenMenu)+'" /></a>');return s.join("")}t.RenderGroup=function(e,t){return Oe(e,t,!1)};function Oe(e,n,r){var i=e.ListSchema,s=i.group1,o=i.group2,u=null==i.Collapse||"TRUE"!=i.Collapse,a=e.ctxId,f="undefined"!=typeof ctx?ctx:e,l=Boolean(f.ExternalDataList),c="",h=e.Templates.Group;null==h||h==Me||"function"!=typeof h&&"string"!=typeof h?h=_e:"string"==typeof h&&(h=t.SPClientRenderer.ParseTemplateString(h,e));a+="-";a+=n[s+".groupindex"];"1"==n[s+".newgroup"]&&(c+=h(e,s,a,n,i,1,u));if("1"==n[s+".newgroup"]||null!=o&&"1"==n[o+".newgroup"]){null==o||r||(c+=h(e,o,a+=n[o+".groupindex2"],n,i,2,u));c+=(function(e,t,n){var r='<tbody id="tbod';r+=e;r+='_"';!t&&n&&(r+=' style="display: none;"');r+=' isLoaded="';r+=t||n?"true":"false";return r+='"/>'})(a,u,l)}return c}t.RenderGroupEx=Oe;function Me(e){return null!=e&&"function"==typeof e.RenderItems?e.RenderItems(e):""}function _e(e,r,i,s,o,u,a){e.CurrentItem=s;var f='<tbody id="titl';f+=i;f+='" groupString="';f+=s[r+".urlencoded"];f+='"';2!=u||a||(f+=' style="display:none"');f+='><tr><td colspan="100" nowrap="nowrap" class="ms-gb';2==u&&(f+="2");f+='">';2==u&&(f+="<img src="+ListView.ImageBasePath+'"/_layouts/15/images/blank.gif?rev=47" alt="" height="1" width="10">');f+='<a href="javascript:" onclick="javascript:ExpCollGroup(';f+="'";f+=i;f+="', 'img_";f+=i;f+="',event, false);return false;";f+='">';var l=null,c=null;if(DOM.rightToLeft){l=a?"ms-commentcollapsertl-iconouter":"ms-commentexpandrtl-iconouter";c=a?"ms-commentcollapsertl-icon":"ms-commentexpandrtl-icon"}else{l=a?"ms-commentcollapse-iconouter":"ms-commentexpand-iconouter";c=a?"ms-commentcollapse-icon":"ms-commentexpand-icon"}var h=a?window.ListView.Strings.L_SPCollapse:window.ListView.Strings.L_SPExpand;f+='<span class="';f+=l;f+='"><img class="';f+=c;f+='" src="';f+=n.JsGridUtil.Internal.GetImageUrl("spcommon.png");f+='" alt="';f+=h;f+='" id="img_';f+=i;f+='" /></span>';for(var p,d=r,v=0;v<o.Field.length;v++){var m=o.Field[v];if(m.Name==r){d=m.DisplayName;p=m;break}}f+=Encoding.HtmlEncode(d);f+="</a> : ";if(null!=p)if("Number"==p.Type||"Currency"==p.Type)f+=s[m.Name];else if("DateTime"==p.Type&&Boolean(s[m.Name+".groupdisp"]))f+=s[m.Name+".groupdisp"];else if("User"==p.Type||"UserMulti"==p.Type)f+=s[m.Name+".span"];else{e.CurrentItemIdx=v;s[r+".groupHeader"]=!0;f+=t.spMgr.RenderFieldByName(e,r,s,o);delete s[r+".groupHeader"];e.CurrentItemIdx=-1}f+=' <span style="font-weight: lighter; display: inline-block;">(';f+=2==u?s[r+".COUNT.group2"]:s[r+".COUNT.group"];f+=")</span></td></tr></tbody>";var g=o.Aggregate;null==g||e.inGridMode||(f+=De(e,i,s,o,u,a,g));e.CurrentItem=null;return f}function De(e,t,n,r,i,s,o){var u="";if(null==t){u+='<tbody id="aggr';u+=e.wpq;u+='">'}else{u='<tbody id="aggr';u+=t;u+='_"';s||(u+=' style="display:none"');u+=">"}u+='<tr id="agg';u+=e.wpq;u+='"><td/>';var a="";1==i?a=".agg":2==i&&(a=".agg2");var f=r.Field;for(var l in f){var c=f[l];if(null!=c.GroupField)break;u+='<td class="ms-vb2">';var h=o[c.Name];if(null!=h&&""!=h){u+="<nobr><b>";var p,d;if("COUNT"==h){p=window.ListView.Strings.L_SPCount;d=c.Name+".COUNT"+a}if("SUM"==h){p=window.ListView.Strings.L_SPSum;d=c.Name+".SUM"+a}else if("AVG"==h){p=window.ListView.Strings.L_SPAvg;d=c.Name+".AVG"+a}else if("MAX"==h){p=window.ListView.Strings.L_SPMax;d=c.Name+".MAX"+a}else if("MIN"==h){p=window.ListView.Strings.L_SPMin;d=c.Name+".MIN"+a}else if("STDEV"==h){p=window.ListView.Strings.L_SPStdev;d=c.Name+".STDEV"+a}else if("VAR"==h){p=window.ListView.Strings.L_SPVar;d=c.Name+".VAR"+a}else{p=window.ListView.Strings.L_SPCount;d=c.Name+".COUNT"+a}u+=p;u+="=&nbsp;";u+=Boolean(n)?n[d]:"0";u+="</b></nobr>"}u+="</td>";!P(e)||"TRUE"!=c.CalloutMenu&&"TRUE"!=c.listItemMenu||(u+="<td></td>")}return u+="</tr></tbody>"}t.RenderAggregate=De});
define("Gqe",["require","exports","Lqe","Kqe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=100,o=(function(){function e(e){this.lockCount=0;this.undoStack=[];this.redoStack=[];this.undoRealCmdCount=0;this.redoRealCmdCount=0;this.groupStack=[];this._cmdTypeEnum=i.CommandType;this.preExecuteNotifiers=[];this._maxUndoDepth=void 0===e.maxUndoDepth?s:e.maxUndoDepth;this._onUndoRealCmdCountChange=e.onUndoRealCmdCountChange;this._onRedoRealCmdCountChange=e.onRedoRealCmdCountChange}e.prototype.IsUndoEnabled=function(){return this._maxUndoDepth>0};e.prototype.OpenGroup=function(){this.bApplyingOrUndoing?n.JsGridUtil.DebugAssert(!1,"Cannot open a Command Group within an Apply/Undo"):this.groupStack.push([])};e.prototype.CloseGroup=function(e,t,r){if(this.bApplyingOrUndoing)n.JsGridUtil.DebugAssert(!1,"Cannot close a Command Group within an Apply/Undo");else{n.JsGridUtil.DebugAssert(0!==this.groupStack.length);var i=this.groupStack.pop();if(0!=i.length){var s=1==i.length?i[0]:new u(i,r);this.AppendToUndoStack(s,e,t)}}};e.prototype.Execute=function(e,t,r){if(this.bApplyingOrUndoing){n.JsGridUtil.DebugAssert(!1,"Cannot add a command to the undo stack within an Apply/Undo");e.Apply()}else{this.CleanUpRedoStack();this.AppendToUndoStack(e,t,r);this.PreExecuteNotify();this.bExecuting=!0;e.Apply();this.bExecuting=!1}};e.prototype.Undo=function(){var e;try{if(0!==this.lockCount||this.groupStack.length>0||!this.undoRealCmdCount||this.bApplyingOrUndoing||this.bExecuting)return!1;this.PreExecuteNotify();this.bApplyingOrUndoing=!0;do{(e=this.undoStack.pop()).cmd.Undo();this.redoStack.push(e)}while(e.type==this._cmdTypeEnum.Implicit);this.undoRealCmdCount--;this._onUndoRealCmdCountChange&&this._onUndoRealCmdCountChange(this.undoRealCmdCount);this.redoRealCmdCount++;this._onRedoRealCmdCountChange&&this._onRedoRealCmdCountChange(this.redoRealCmdCount)}catch(t){if(t instanceof r.InvalidChangeKeyError){this.ClearUndoStack();throw new a("Failed to Undo command with Name:"+e.name+" and Type:"+e.type+" due to Invalid change key: "+e.cmd.GetChangeKey().GetVersionNumber().toString())}throw t}finally{this.bApplyingOrUndoing=!1}return!0};e.prototype.Redo=function(){var e;try{if(0!==this.lockCount||0!==this.groupStack.length||!this.redoRealCmdCount||this.bApplyingOrUndoing||this.bExecuting)return!1;this.PreExecuteNotify();this.bApplyingOrUndoing=!0;do{(e=this.redoStack.pop()).cmd.Apply();this.undoStack.push(e)}while(e.type==this._cmdTypeEnum.Implicit);this.redoRealCmdCount--;this._onRedoRealCmdCountChange&&this._onRedoRealCmdCountChange(this.redoRealCmdCount);this.undoRealCmdCount++;this._onUndoRealCmdCountChange&&this._onUndoRealCmdCountChange(this.undoRealCmdCount)}catch(t){if(t instanceof r.InvalidChangeKeyError){this.ClearRedoStack();throw new a("Failed to Redo command with Name:"+e.name+" and Type:"+e.type+" due to Invalid change key: "+e.cmd.GetChangeKey().GetVersionNumber().toString())}throw t}finally{this.bApplyingOrUndoing=!1}return!0};e.prototype.CanUndo=function(){return this.undoRealCmdCount>0};e.prototype.CanRedo=function(){return this.redoRealCmdCount>0};e.prototype.GetUndoStack=function(){return this.undoStack};e.prototype.GetRedoStack=function(){return this.redoStack};e.prototype.ClearUndoStack=function(){this.CleanUpUndoStack()};e.prototype.ClearRedoStack=function(){this.CleanUpRedoStack()};e.prototype.Lock=function(){this.lockCount++};e.prototype.Unlock=function(){this.lockCount=Math.max(this.lockCount-1,0)};e.prototype.AddPreExecuteNotifier=function(e){this.preExecuteNotifiers.push(e)};e.prototype.RemovePreExecuteNotifier=function(e){for(var t=!1,n=0;n<this.preExecuteNotifiers.length;n++)if(this.preExecuteNotifiers[n]==e){this.preExecuteNotifiers.splice(n,1);n--;t=!0;break}return t};e.prototype.PreExecuteNotify=function(){for(var e=[].concat(this.preExecuteNotifiers),t=0;t<e.length;t++)e[t]()};e.prototype.CleanUpUndoStack=function(){if(0!==this.undoStack.length){for(var e=0;e<this.undoStack.length;e++)this.DisposeCmd(this.undoStack[e].cmd,i.DisposeState.Applied);this.undoStack=[];this.undoRealCmdCount=0;this._onUndoRealCmdCountChange&&this._onUndoRealCmdCountChange(this.undoRealCmdCount)}};e.prototype.CleanUpRedoStack=function(){if(0!==this.redoStack.length){for(var e=this.redoStack.length-1;e>=0;e--)this.DisposeCmd(this.redoStack[e].cmd,i.DisposeState.Unapplied);this.redoStack=[];this.redoRealCmdCount=0;this._onRedoRealCmdCountChange&&this._onRedoRealCmdCountChange(this.redoRealCmdCount)}};e.prototype.AppendToUndoStack=function(e,t,n){if(0!==this.groupStack.length)this.groupStack[this.groupStack.length-1].push(e);else if(0!==this.undoRealCmdCount||n!==this._cmdTypeEnum.Implicit){this.undoStack.push({cmd:e,name:t,type:n});this.undoRealCmdCount+=n!==this._cmdTypeEnum.Implicit?1:0;if(this.undoStack.length>this._maxUndoDepth){this.undoStack[0].type!==this._cmdTypeEnum.Implicit&&this.undoRealCmdCount--;this.DisposeCmd(this.undoStack.shift().cmd,i.DisposeState.Applied);for(;this.undoStack.length&&this.undoStack[0].type==this._cmdTypeEnum.Implicit;)this.DisposeCmd(this.undoStack.shift().cmd,i.DisposeState.Applied)}this._onUndoRealCmdCountChange&&this._onUndoRealCmdCountChange(this.undoRealCmdCount)}};e.prototype.DisposeCmd=function(e,t){n.JsGridUtil.Internal.IsNullOrUndefined(e.Dispose)||e.Dispose(t)};return e})();t.CommandManager=o;(function(e){e.CommandType={Explicit:0,Implicit:1};e.DisposeState={Applied:0,Unapplied:1}})(i=t.CommandManagerConstants||(t.CommandManagerConstants={}));var u=(function(){function e(e,t){n.JsGridUtil.DebugAssert(!n.JsGridUtil.Internal.IsNullOrUndefined(e)&&0!==e.length);this.cmdArray=e;this.bReverseOnUndo=t}e.prototype.Apply=function(){for(var e=this.cmdArray.length,t=0;t<e;t++)this.cmdArray[t].Apply()};e.prototype.Undo=function(){var e,t=this.cmdArray.length;if(this.bReverseOnUndo)for(e=t-1;e>=0;e--)this.cmdArray[e].Undo();else for(e=0;e<t;e++)this.cmdArray[e].Undo()};e.prototype.Dispose=function(e){for(var t=this.cmdArray.length,r=0;r<t;r++){var i=this.cmdArray[r];n.JsGridUtil.Internal.IsNullOrUndefined(i.Dispose)||i.Dispose(e)}};return e})();t.AggregateCommand=u;var a=function(e){this.message=e||"Command Manager Error";this.name="CommandManagerError"};t.CommandManagerError=a});
define("Dqe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.SPGPermissions={addListItems:2,editListItems:4,deleteListItems:8};e.DeserializationMode={Full:0,TableView:1,RowView:2,Slice:3,AutoFilter:4};e.SelectionTypeFlags={NoRows:0,SingleRow:1,SingleRowRange:3,MultipleRowRanges:7,_RowMask:7,NoCols:0,SingleCol:8,SingleColRange:24,MultipleColRanges:56,_ColMask:56,NoCells:0,SingleCell:64,SingleCellRange:192,MultipleCellRanges:448,_CellMask:448};e.LinkType={FinishFinish:0,FinishStart:1,StartFinish:2,StartStart:3};e.ClickContext={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3,Gantt:4,Other:5};e.SelectionType={None:0,CellRange:1,RowRange:2,ColumnRange:3};e.EventType={OnCellFocusChanged:0,OnRowFocusChanged:1,OnCellEditBegin:2,OnCellEditCompleted:3,OnRightClick:4,OnPropertyChanged:6,OnRecordInserted:7,OnRecordDeleted:8,OnRecordChecked:9,OnCellErrorStateChanged:10,OnEntryRecordAdded:11,OnEntryRecordCommitted:13,OnEntryRecordPropertyChanged:14,OnRowErrorStateChanged:15,OnDoubleClick:16,OnBeforeGridDispose:17,OnSingleCellClick:18,OnInitialChangesForChangeKeyComplete:19,OnVacateChange:20,OnGridErrorStateChanged:21,OnSingleCellKeyDown:22,OnRecordsReordered:23,OnBeforePropertyChanged:24,OnRowEscape:25,OnBeginRenameColumn:26,OnEndRenameColumn:27,OnPasteBegin:28,OnPasteEnd:29,OnBeginRedoDataUpdateChange:30,OnBeginUndoDataUpdateChange:31};e.DelegateType={CreateRecords:0,ExpandColumnMenu:1,AddColumnMenuItems:2,Sort:3,Filter:4,InsertRecord:5,DeleteRecords:6,IndentRecords:7,OutdentRecords:8,IsRecordInsertInView:9,ExpandDelayLoadedHierarchyNode:10,AutoFilter:11,ExpandConflictResolution:12,GetAutoFilterEntries:13,LaunchFilterDialog:14,GetRecordEditMode:16,GetGridRowStyleId:17,CreateEntryRecord:18,TryInsertEntryRecord:19,WillAddColumnMenuItems:20,NextPage:21,AddNewColumn:22,RemoveColumnFromView:23,ReorderColumnPositionInView:24,TryCreateProvisionalRecord:25,CanReorderRecords:26,AddNewColumnMenuItems:27,TryBeginPaste:28,AllowSelectionChange:29,GetFieldEditMode:30,GetFieldReadOnlyActiveState:31,OnBeforeRecordReordered:32,EditColumn:33,MoveColumn:34};(function(e){e.EventType={OnRowHeaderStateChanged:0,OnGridDisposing:1,OnChangeKeyCreated:2,OnChangeKeyInitialUpdateFinished:3,OnBeforeRecordInserted:4,OnBeforeRecordDeleted:5};e.DelegateType={CallAsyncFn:0,GetLocalizedString:1,DoLargeTask:2};e.LoadErrorState={};e.MinColumnWidth=110;e.RowHeaderWidth=25;e.ColumnHeaderHeight=42;e.RowHeaderWidthNewStyles=58;e.SplitterWidth=6;e.IconColumnWidth=30;e.IconColumnNewWidth=40;e.ColumnWidthOffset=20;e.zIndex={editor:20,selectionFrame:25,expandableEditorsZIndex:30,stickyZIndex:1e3,tableHeader:35};e.fixedRowHeight=46})(e.Internal||(e.Internal={}));e.OperationalConstants={HierarchyMain:0,HierarchyOutlineLevel:1,GroupingOutlineLevel:2,HierarchyDescendantCount:3,GroupingDescendantCount:4,GanttDependants:5,GanttBarStyleIds:6,GridRowStyleId:7,RecordEditMode:8};e.csomFiles=["_layouts/15/sp.init.js","_layouts/15/mquery.js","_layouts/15/sp.runtime.js","_layouts/15/sp.js"];e.RecordIndicatorCheckboxColumnKey="JsGridRecordIndicatorCheckboxes";e.NewRowKeyPrefix="NewRowKey";e.ErrorWidgetId="ErrorWidget";e.ReadOnlyWidgetId="ReadOnlyWidget";e.RecordIndicatorControlId="DISP_RECORDINDICATORCHECKBOX";e.HierarchyControlId="DISP_HIERARCHY";e.UserPhotoPath="/_layouts/15/userphoto.aspx?accountname=";e.TextDirection={Default:0,RightToLeft:1,LeftToRight:2};e.PaneId={MainGrid:0,PivotedGrid:1,Gantt:2};e.PaneLayout={GridOnly:0,GridAndGantt:1,GridAndPivotedGrid:2};e.EditMode={ReadOnly:0,ReadWrite:1,ReadOnlyDefer:2,ReadWriteDefer:3,Defer:4};e.GanttDrawBarFlags={LeftLink:1,RightLink:2};e.GanttBarDateType={Start:0,End:1};e.ValidationState={Valid:0,Pending:1,Invalid:2};e.HierarchyMode={None:0,Standard:1,Grouping:2};e.EditActorWriteType={Both:1,LocalizedOnly:2,DataOnly:3,Either:4};e.EditActorReadType={Both:1,LocalizedOnly:2,DataOnly:3};e.EditActorUpdateType={Committed:0,Uncommitted:1};(function(e){e[e.Ascending=1]="Ascending";e[e.Descending=-1]="Descending";e[e.None=0]="None"})(e.SortMode||(e.SortMode={}));e.RowHeaderStyleId={Transfer:"Transfer",Conflict:"Conflict"};e.RowHeaderAutoStyleId={Dirty:"Dirty",Error:"Error",NewRow:"NewRow"};e.RowHeaderStatePriorities={Dirty:10,Transfer:30,CellError:40,Conflict:50,RowError:60,NewRow:90};e.UpdateSerializeMode={Cancel:0,Default:1,PropDataOnly:2,PropLocalizedOnly:3,PropBoth:4};e.UpdateTrackingMode={PropData:2,PropLocalized:3,PropBoth:4};e.ImagesDirectory="/_layouts/15/images/";e.UserAction={UserEdit:"User Edit",DeleteRecord:"Delete Record",InsertRecord:"Insert Record",Indent:"Indent",Outdent:"Outdent",Fill:"Fill",Paste:"Paste",CutPaste:"Cut/Paste"};e.ReadOnlyActiveState={ReadOnlyActive:0,ReadOnlyDisabled:1};e.ChangeType={Insert:0,Level:1,Prop:2,Delete:3};e.UnitTicks=[6e4,36e5,864e5,6048e5,864e6,2628e6,7884e6,15768e6,31536e6];e.NormalizedTouchTypes={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchcancel:"touchcancel"};e.SPCalendarType={none:0,gregorian:1,japan:3,taiwan:4,korea:5,hijri:6,thai:7,hebrew:8,gregorianMEFrench:9,gregorianArabic:10,gregorianXLITEnglish:11,gregorianXLITFrench:12,koreaJapanLunar:14,chineseLunar:15,sakaEra:16,umAlQura:23};e.MouseButton={leftButton:0,middleButton:1,rightButton:2};e.Key={backspace:8,tab:9,enter:13,esc:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:46,shift:16,insert:45,six:54,windows:91,numpad_plus:107,numpad_minus:109,F2:113,F6:117,plus:61,comma:188,minus:109,dot:190,back_slash:220,IMEInput:229};e.DialogResult={invalid:-1,cancel:0,OK:1};e.SUPERTEMPORARY_defaultCultureStringify='{"name":"en-US","numberFormat":{"CurrencyDecimalDigits":2,"CurrencyDecimalSeparator":".","IsReadOnly":false,"CurrencyGroupSizes":[3],"NumberGroupSizes":[3],"PercentGroupSizes":[3],"CurrencyGroupSeparator":",","CurrencySymbol":"$","NaNSymbol":"NaN","CurrencyNegativePattern":0,"NumberNegativePattern":1,"PercentPositivePattern":0,"PercentNegativePattern":0,"NegativeInfinitySymbol":"-Infinity","NegativeSign":"-","NumberDecimalDigits":2,"NumberDecimalSeparator":".","NumberGroupSeparator":",","CurrencyPositivePattern":0,"PositiveInfinitySymbol":"Infinity","PositiveSign":"+","PercentDecimalDigits":2,"PercentDecimalSeparator":".","PercentGroupSeparator":",","PercentSymbol":"%","PerMilleSymbol":"","NativeDigits":["0","1","2","3","4","5","6","7","8","9"],"DigitSubstitution":1},"dateTimeFormat":{"AMDesignator":"AM","Calendar":{"MinSupportedDateTime":"@-62135568000000@","MaxSupportedDateTime":"@253402300799999@","AlgorithmType":1,"CalendarType":1,"Eras":[1],"TwoDigitYearMax":2029,"IsReadOnly":false},"DateSeparator":"/","FirstDayOfWeek":0,"CalendarWeekRule":0,"FullDateTimePattern":"dddd, MMMM dd, yyyy h:mm:ss tt","LongDatePattern":"dddd, MMMM dd, yyyy","LongTimePattern":"h:mm:ss tt","MonthDayPattern":"MMMM dd","PMDesignator":"PM","RFC1123Pattern":"ddd, dd MMM yyyy HH\':\'mm\':\'ss \'GMT\'","ShortDatePattern":"M/d/yyyy","ShortTimePattern":"h:mm tt","SortableDateTimePattern":"yyyy\'-\'MM\'-\'dd\'T\'HH\':\'mm\':\'ss","TimeSeparator":":","UniversalSortableDateTimePattern":"yyyy\'-\'MM\'-\'dd HH\':\'mm\':\'ss\'Z\'","YearMonthPattern":"MMMM, yyyy","AbbreviatedDayNames":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"ShortestDayNames":["Su","Mo","Tu","We","Th","Fr","Sa"],"DayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"AbbreviatedMonthNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"IsReadOnly":false,"NativeCalendarName":"Gregorian Calendar","AbbreviatedMonthGenitiveNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthGenitiveNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"eras":[1,"A.D.",null,0]}}';e.SUPERTEMPORARY_invariantCultureStringify='{"name":"","numberFormat":{"CurrencyDecimalDigits":2,"CurrencyDecimalSeparator":".","IsReadOnly":true,"CurrencyGroupSizes":[3],"NumberGroupSizes":[3],"PercentGroupSizes":[3],"CurrencyGroupSeparator":",","CurrencySymbol":"","NaNSymbol":"NaN","CurrencyNegativePattern":0,"NumberNegativePattern":1,"PercentPositivePattern":0,"PercentNegativePattern":0,"NegativeInfinitySymbol":"-Infinity","NegativeSign":"-","NumberDecimalDigits":2,"NumberDecimalSeparator":".","NumberGroupSeparator":",","CurrencyPositivePattern":0,"PositiveInfinitySymbol":"Infinity","PositiveSign":"+","PercentDecimalDigits":2,"PercentDecimalSeparator":".","PercentGroupSeparator":",","PercentSymbol":"%","PerMilleSymbol":"","NativeDigits":["0","1","2","3","4","5","6","7","8","9"],"DigitSubstitution":1},"dateTimeFormat":{"AMDesignator":"AM","Calendar":{"MinSupportedDateTime":"@-62135568000000@","MaxSupportedDateTime":"@253402300799999@","AlgorithmType":1,"CalendarType":1,"Eras":[1],"TwoDigitYearMax":2029,"IsReadOnly":true},"DateSeparator":"/","FirstDayOfWeek":0,"CalendarWeekRule":0,"FullDateTimePattern":"dddd, dd MMMM yyyy HH:mm:ss","LongDatePattern":"dddd, dd MMMM yyyy","LongTimePattern":"HH:mm:ss","MonthDayPattern":"MMMM dd","PMDesignator":"PM","RFC1123Pattern":"ddd, dd MMM yyyy HH\':\'mm\':\'ss \'GMT\'","ShortDatePattern":"MM/dd/yyyy","ShortTimePattern":"HH:mm","SortableDateTimePattern":"yyyy\'-\'MM\'-\'dd\'T\'HH\':\'mm\':\'ss","TimeSeparator":":","UniversalSortableDateTimePattern":"yyyy\'-\'MM\'-\'dd HH\':\'mm\':\'ss\'Z\'","YearMonthPattern":"yyyy MMMM","AbbreviatedDayNames":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"ShortestDayNames":["Su","Mo","Tu","We","Th","Fr","Sa"],"DayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"AbbreviatedMonthNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"IsReadOnly":true,"NativeCalendarName":"Gregorian Calendar","AbbreviatedMonthGenitiveNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthGenitiveNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"eras":[1,"A.D.",null,0]}}';e.SUPERTEMPORARY_spcommonThemedData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ8AAAEMCAYAAADauzOQAAAgAElEQVR4Xuy9e3xV1Zk//Ky1Ey4FL9ChPztarL46SlI70jDy4tgWBSxBRgQMddQkUMg+yFvHhFTUV4EQ5VXBXBh9gezAAIk6lnARqoRKUKiO/mrNaIcmlMGP7SjMOHXKxVIDSfZ6fp9nnb0P+5zs67mEBPf+R8zZez1rPWvt717ruXwfBuEVaiDUQKiBJDTAkngmfCTUQKiBUAMQgke4CEINhBpISgMheCSltvChUAOhBkLwCNdAqIFQA0lpIASPpNQWPhRqINRACB7hGgg1EGogKQ2E4JGU2sKHQg2EGgjBI1wDoQZCDSSlgRA8klJb+FCogVADIXiEayDUQKiBpDQQgkdSagsfCjUQaiAEj3ANhBoINZCUBkLwSEpt4UOhBkINsNdffx1DNYQaCDUQaiCoBsKdR1CNhfeHGgg1IDUQgke4EEINhBpISgMheCSltvChUAOhBkLwCNdAqIFQA0lpIASPpNQWPhRqINRACB7hGgg1EGogKQ2E4JGU2sKHQg2EGgjBI1wDoQZCDSSlgRA8klJb+FCogVADIXiEayDUQKiBpDQQgkdSagsfCjUQaiAEj3ANhBoINZCUBkLwSEpt4UOhBkINhOARroFQA6EGktJACB5JqS18KNRAqIEQPPrxGvjoo4/wyiuvTP8cTqm4BFC/HRi7HRAuAYDrDDUdAAafAuJOYMpO2FXxaUrqm73hEtDZ7cD47YCYIId9Cih2goI7YeOc1OSk1Mm++fAf9j/+ACKuYBwGMIClI763pLK3e5r+hdfbI/iSyiPg+P3vfw/f/OY3IW0Akv/ICIDsZQCgAoDioVodADSArqXQ/ORngaZhzj+NgG4lmJwsfSls+FEwOQCwcOHC2xGxUAhxk6IoBFCg6/qnnPO3GGON1dXVOwP1vQ/c/On+x68Aph/mwGNzxDi7dsRNiw+lu3uqql5EbWqadjKx7RA80q3tXmjPBI6bb74Z3njjjfQAyJSKyYDiJQCQiwUQdwODV4HDO9DNowsnS1wEAsYBwm3A2GRjqCeB8btgV8VuX0O/d8Nk4MpLgBiVA2w3IL4KCr4DuhKVo+gXgc7GAWO3AWBUDmMnQeh3wfNzfMkpKyuj3dIGABjOGFuPiHsURZHgo+v6CMbYJACYjYgkc05NTc0BP/1fsGDBJbqur0bE6cb9pwBg4/Hjx8ubmpo6/bSR6j3/vW/ZJMbZa9Z2GODU5duOPyynKSvrqWeeeebVVOQUFBQow4YNawCAu412Go8fPz6nqamJPhrRKUlFQPhs72vAChym9JQBZPKSucCgztht7AHGF8Guig9cRzel4npAsQIA6CXUASECuyvXuz5T2DAXAA05uAcUXAQb57jLmb3hetDZCgD5susALAKNRa5yysrKJjPGmoQQGmPssZqamg67fpWVlQ1GxCc45yoiFtTU1HgCUyQS2YuItwBAI2PsLUS8CQAKox9nLeJrRRRuilJ/Nhbbv38ev//3m8umM2Tb4sAD4Z4/X140sa2t7arXX389R9f1Fl3X73/22Wd97dYSdxiqqt4HAKutMhBxTn19/cYQPHzNct+6yQ44UgaQKUsmAUKzARzLobnysUCjzl/yBAA8Kl9sBvmwq3KP7fP3Nk4CJgw5uBwaZweTU7jxCQAWlYM8H54vtJVDOw7G2D7OecEzzzzzup+x/OQnP7lFCNGEiOPddiAFBQUDhg0bdgYAdmualm+2rarqPgDI0TTta37kgQkOdgDi9pvR+B9+UbEBgM+Ok4WwfcT3Fj+l63rVmTNnvr127dpff/LJJ99WFOX+qqqqRqd+Oe0whg0bVgsAP04Aj+r6+vryEDx8zXLfuckNOJIGEGkYFb+NHlVYJTQvW5rUiM8CCB1hru1hSCXDqFB+Gz2qYCU0zk5OjgkgdITh+rV2htTy8vL3hRDra2pqnvMay4IFC4YOGDDgutra2ncWLlx4H2NMraqqGu30nPF1PgEAL2qado8FPF4BgJs0TbvYS2bsdzuQ8AMc+x9/ABjSi93zYuyxr3138XJd12k39WhbW9uvGxoaLuzs7NxeW1sbe+mtDzrtMDjnpxCxKQE8ptXX18dsROGxxfdsn7sb/QBHUgCSv4S2pbQ93QPNlbemNML8JXQGp6PFGmiuXBDXVuEmQw7ugcbZqckp3PiacYRZA43FcXLKysqmc86f/Pjjj3OtZ3O7cVVUVAw4efJkM2PsFkS858iRIz+97LLL/g0A6Jiz3e4ZVVXpyEXGZKfL/9GFWrCChbVFp+OM5Z5jb1WM7Bb8P+hPWVxcPvymio8RcaQQ4kHOeWzHsGvXLn3Pnj2namtrbYFNVdVnnXYYqqqSDeUBQ+wqTdOesnYzBI+U3pjMPxwEOAIByNRHLwVd+UgeVxgf42nj8Bpq1AbynrxN0S+HV5Yflf8u2nQpIETlKGKMp43DS460gfCoHAaXQ0NxVE7Us/ICY+xAVVVV3CK3a5LuNYyBnyHijTU1NR8uXLhwIQDkVVdXx3YV1mdVVbWWKVmp6/pTnPMVjLG55n2apgV7pxIBxAdwLFy4EKurq9lnb1ZKIPuLmxa/KIQ4zDmX3iS6dF2HpqYmOHLkCBw9evSkE3hEIpE77XYYjLFLAeB2Op7R0Wb48OGvIeIWTdPWmDKCDdRrYsPf06qBZIDDN4BMXvwwMPak9Kjsqpxq2/Epi+8GZGRxJ5fgKWlr2F3xluMg8xfvAKDYEHwEdj8efYGLGh4GxCeBsVehocheTvS+mwCRbCJDo4ZRKILG4hdtZRVt2gEIFIfyCDQUxYBi4cKFf2CM5VdVVbW6TcTChQvNr22HYed4l+4vLy/PQ8Tm6upqW9uFFTwYY7fW1dXtiUQiZGylHYm8egs8Vq5cuRwARpDMjo6OIUOGDIkB3hdffAEbN24Exhj86Ec/gocfftgRPOj5xB0GY6wVEU1vzj2IqDAm1wG1WV5XV1ct/53W1R42ljYNpAIcvgBk8uJmw926AJorY1+T2ACmLCkElK5Of8BBD0a9Nuukm3f341GDYmFDs3S3Ii6A52f3lGPVWNEmcgPTonUHkKjXZp108zYWSTnkOWGMfdHV1fU108OwcOHCHyqKsn/lypWxILPy8vKHkcAs+iIUVFVVbTG7cP/994/Izs7+AyJ+xc5Dk7DzOKpp2mWqqv6R3MFJgUeSxxbaeVRVVcV2F7/61a96rLu/+Zu/gYKCAlAUhXTjCB6GzSNuhwEALwshhjHGKBaHvDUE5uau5pCmadeG4JG2Vz29DaUDODwBJH/JEQC4FAQbCz9fJr+8DsBxEhDzYffj73iO8gdLbwCOvwSAo9BceVkUPDZF5TAYCw3F8XLsGiQAAdZsxIGQa3YeNBbF3IPykaJNNwBCVE5jsZSTCB7l5eVyR0ABYdnZ2feQ56WsrOxuxhgdVwg4Hkk83gQED7nLSAAU/zuPJA2m1HcTPDznw7jBCTwikchCRKwybuuxw6AdBwCQO956xTxN4c7D7wz00n3pBA5XAMlfQi7HAZDFL4efVXwcN7z8Jd0+IkyjjzRXnl1Df1cxEroFGfE6oblyoAEeUTmMXQ4NRWflOH11e+pZh8birLg/FzWMBMSonMbiqJzoS/VHOk7QsYWOIN3d3a8YUaU6xXwAwFzO+QAhxJra2tp4o27AY4vTcvB1bEnRVZsu8FBVlTxt1xhj6bHDyMrKGtPd3f2m8TtFr35IAWirV6+mwLjw2NJLmOBLTCaAwxFA3MHDf/3izINHz2AqZ/CIM5iWlZVdBQCvMcauMPUghNh59OjRGXbeGB8G0x6eCevEMsYq6+rqvN3QKQaJpRE8yMZkRgonrtG4WBa7BRzuPHy91r1zExUdp5DzTF0UiXrLLbdE59zt2DJ58WxgbJ2x++gA5Le6GkrNDqfl2CINp2T3GGxElPo6tlAXyFULAE8cOXLk2yY4PPjgg5cIIZoR8XoAeNcwkPaIOCWPgperNlPzErRdAo8gzwghbG0eFOfS3d1N7lgCWXMH0mOH4SQrBI8gs3A+3Xs2LsPeYJoMgJgGU2vciBmX4ctg6gM4aA5iBtOecSMUJIaIWnV1dcw4awSDPavr+iKncG0/QWLn0/SnYywheKRDi/2xDV+u2oAel7S6atkcaCyyD6t2cNUau4/rEPHNrKysGekOT++P05zJPofgkUnt9uW244LEcDTsetxXVqnjkKYsvg6QvS9/dwoSE2I0vDAnNTn3bLgOOI/KSQgSM/v2k5/85DbKVSHDqM/EuPuMXJiUMlH78nRnom8heGRCq/2lTTM83RqXkWzfz8aNuISnn43LSFZMLG6EwuATwtOtbZK3BQDIbkOZs42Uki+EIB4Pilm4lFLyGWOUDUv2j3legWVJ9/c8frD/g0fB5sEwuOM26Bj8KjTNsk29Po/nL7WhpS0xbukyAFwCAJlOjFsGwJZIbg+HxLhEhRAZEPF2AMD3LcFcxwBgP/Fw9AUyoEgkQjlBQBGrqU1o7z7dv8GjcBMRlVC04EgAoBiCRxxDmntXr/1HWpQEiLJCKSAoxZR8PtWRFIhIgBg35KSaki+m+iUFysREqKpKdpUljLFxMgAO4CgiUhAdrUO6FtXX1xM4eV5GSrzM1Tl+/PgYr4Q+zwZTvCEx6M2uOTOWpX+CRzTCkHzuN9gM7l1gcL+vaMYUFX3ePN6DDAjLPW0g+RU5AIJSw5MnAxJY7mkDuef5HODdtUHIgDI1Lwafx4MAQLss2iXsR8QPGWPk6qSPmEkL+KmmaV/304+SkpJCM7EOEdfX19c7cm/4aS/Ve85f8IgGB9EkmdRobrp60Uicio+eTFW75+vz0R0I8TdQXgkZI1+VRMccWoFH6ftA6CNAQJ5BjHyboYpTwHhBIBpCxi1y2KuS6JjkII/KYcKQI4mRz8pBUXCOdxxERkQh3fPq6+vj0vZVVY2G4UcvmffitVQopP7Pf/7zYSFEEd3LOW8YMmTI1U7MZ3btlZaWXs85f9uIi4lOkxCdiqJMqKqqck5idOicCR7m7oL+3/pveqx/7TwKNg+FQV88DMAoZZqCh/xeHQBYDae/8hQ0zZIhteHlooGoDYS+qj4JkNl6YGxpYBZ1yZrOg8lR9KV9gUWdYkbM8GyrJiORyGREpERCypuZU1dX50lpaGSzTtY0bTw9Z1Ac7knkzfBasxQcx9hZWsLEhD+n5912GecHeEQDgojqLsZV4KVMm98/BWCPeXFfJtHu+fmIdOPy6QbRMaV9k+eCrlZA/EzuShSxPcbZkawWiOtDwHSD6DheDrDPJDEyh+1Wzo6gotLBnl5SUkLGVjNBzNOeoarqTYyxO+vq6krN/hrZq9cbR5yLEJGOOhcJISasW7dO0iXOmzfvFs75XjI8M8Y+pP/SsQgAPrDyaCTqIBPg4abnvr/zKGz4PiDWAgMKK07PhfABMFYKjUW+jFnpERq2ci40kE72dFVV/8vy8fK0Zxh2jCetRxcCIMYY5ZKsEkJsycrK+nTt2rUxIiOrjoihvbOz81LO+Z3E5IWI+W4GWIqOTSArXmCNsPXaeSQeS7zmq++Cx72NVwGIFcDApLb3Gkvw3xG2A/BF8HwhoXp4nWcacGJPLy0tHacoimLaAvyypwe1Zxg7iGZN02IZv6TiSCQyDhHJ47TS62hiHGkeZIxNraurc6RDMAifqU3T02PWpZlWU1PjSoFgZ98wl0L/OractWuQNXtAL6znTkBYBWcGV4b2kARt91IlN6MGChVlup0xdgkiysp0RCWIiJ8yxnYqirJz9erVvivGObGnG4BCX35AxBlWnlIv9nTDnkGlDug44WnPsNt5WI4vNEbK9N197NixSGKtF/LoDB8+vA5R1qu5VdM014jc0tLSNznnVP4h8TpQXV39bbf36PyweaTHrpEs3oT2EFNzvVTJbc6cOcTYFahiXFdX19INGzZ41iBxYk83AILsCXRNSwwO80qMU1WV0v0H19XVzfBaaCUlJU2MsU4rw7r1mUgkkoOIbQBwuaZpcd5AVVVpB/ERY+zbdXV17V6yzN9LS0urOOfkUFhfXV09z89zftyydu30jWNLJuwafrRmd8+X3R7SS5XcjK/42cp0AOSVeFUI8Y5RvY12HhdxzikAi9y0scp0jLG73LwYXuzpdGxhjA2oqanpYfPySsknIygAEDHOVE3THHNgVFWlPtMx4ruaptm6Sg3S4Qc0Tfuu3VJUVfVNxthzdXV1P/W7nE2WNHIj19TUuBffMhp1O7a4yT234NEbdg2/Wk+878toD+mlSm6RSGSuQRasUK6JEYnpWjGupKSEDObEUC6D0Rhjkbq6OtuXw409nVysgwcPlvFBF1xwwcaKiooepSF9kAER0THZ4uZYAcTqjTGIh7a7VY9TVZXAkzwoT82fP/9SRKSARwLN+8mIatg7rtc07S6/y/iBBx64RlGU3zLGxvjN0+lf4FFQdxEMHLQEmKxE1Rt2Db+6T7yP7CHPwZnTldAU6VHgN9lG++RzvVTJjfI3iJncDIPXNC1QxThVVWOV6Ygh3S4PxI09/YEHHhipKIqsc5KdnX3x008/3WNevdjTjQhTik8hAp1XjYjQnQnemFPHjx//qlPdWiMw7I9U7oHybYhkmNoxwIPAlZjI9jPG3h4yZMhX/QaM0c7pG9/4xn998sknX/cb4t4/ji0FmxUY+IUKjNECiDFN98mXKb5TxwDxMTjzFQ2aZsUK/PaDfvvrYi9VciPDaHd3t6xM55uqz2YEFgA5mZWVda3VkGrHnm5twg94eBEgm+0Zu6FHGWNDqa5JEG+MeawxyhucYowtMG0bhi1kNbWLiBRb43pE8jfJznf1ffCQCVGsCoDlpDrYc/c8tgNi+bkMjc7I2HupkpuqqrJiHB1V6uvrU6oYV1JSQp4KWZlO07QYiXFvgkfiXASJLjV0QUefck3TbOvSqKpKxytiNafjTw+i5oyshSQazXxinH+W7CS638uP+Kjm1cs9Sl5cL1VyozO9EEJWjEPEMfX19a42Dq8B0VefMSazUDnnl1sDrazs6Ynt+Nl5eB1bvPrm53fahVEBLbsQd+vzZKOhPKMgbmo/8tN5TwgeQbR5XoGHj0puUcqDsxXjGMuHhiLnZCsbekDD+EfJjK9qmuZYMc7wZsRVjHP5Mu+gUohEwWANtnIzmPoBDy+DaZCl8mW4NwSPILN8PoGHVyW3woZCAJnoFa0Y5wUcpEebSm6qqpr0/gvc8jPocSMCM65inB2AGF4bYgmLKw9gx55uTq8XeHi5aoMsky/LvSF4BJnp8wo8XCq5WYGDWLsA86Gh2LtinE0lN9OYyDkfu3btWs+KcQaAEOBcRK5ZI/09rmLc/PnzbxBCyIpxianvduzpNMVe4OEUJKaqKvGlJpNfRa7Y0UGWV2/em6yxlPrYe3Ee55PNIzq7h4DBIUC2HQZ07oT184jSrv9dhZvsK7nJHcQm/xXjrIBqU4xJVdWonIRoygCLV9c0La5inBGFKSvGJeaPUHi6HXu6G3i4hadb+SyCTHKyz/mRcWTRZSrqYgVwTgDreQkE8uosGrnyk1g5imT7Z30u3Hl4qt7lBvoqI6yE04Oq+x1/qjt4+C8qlHnw6FH/1Q08aLbSyZ6ejpfM7xIzYkAohJ4Y8u53OuZ9Uv6XJ/wChymbAOTyZ45cYP5/kHGRPcqMlg3Bw+9sAvwUGPwUsrv2x3YYlP+hK8TvQFXkyWgHQKHtnE2Lq8XqX8a5udOtAHVhw+xoFXpp7+gAxm51NZSaI0jDscUwnMYqxgU9tphdSRd7epCXzDqRQZ8j4Dhx4sTQ7OxsGjsdk05qmnax3eL45MHLJLhftuIT+XPXp7+FM7/7FXS8vx3O/P5XjuvpGyuPxDYLfvtnZAiTe3wn5fWE4OH9ur4LQpkDL9zrnpg0e8P1IJQGiGaDfgqMjc0EgFiCo5abkZl+/+Y4VK9KbskAiE0lN0tchqfB1A9w0HhMg6mfuJFU2dP9vmSJeg7ynBG5ug0RO7q7uxcYAHLIKTzdBI+v/T8vAygDIGv4N4B/JYozpw/tg+NbHwb9RE+qkKDgYQT3kc2H3MtEI7AoBA838EDYAmcGF/k+hkSpBLZJgl7GDkDHoBvTneKvquqfDG7RU5qmya2n3785DrXIj6s2oMclja5aRJzjRAasqqqtq9b7mxD8jiAgkMzOg7w8F1988UvEPCY3sYhbhBCRzz///KRTmLkJHlZ5g64ZDxffXgFZI/4v0P/0GfxxQzF0HonP5g8CHtSv4cOHv4aIt1C4/PHjxydQf0LwcF5D78LpweN9A4fZDuXsDB78prEDeQoaix8Jvkydn1BVleIkKJ/iKU3TZNt+/+YMHpsuBQQZvAUZrORmDRIDgNFe/BReeqOyBwAgK8YlBol5PZvM717gYZRO+CG9ZJxzRQjx+okTJ14MkF9CcTRUfEpejLGNx44dm+f2vAkeX539T3KH0XXk36DjN7sB9S648AeL4ILvlYB+8lP4w3N/J/9rXk7gEYlEiNR5vaZpsXwfy872aFdX12iTDiEED/tVpLu+RKbXyMldWySLNFPK9ilQxNV9gazX82WJhadntpKbGZ6eGJfh2T+bGyxxI3Hh6cm05ecZN/CYO3fucM55M2MsrgQIIr7b3d09NTs7+w+mW9NOlqqqlKVLZNPyMhLtPLk4Em0e9CyBxPEtD8pjC+1Aht40Fzra98AfN/7IFTxKSkqo/gxxq+wfMmRIPiXiGeH2RCtAWczjrUxmIXjYr5qfQmOxcwq0F3hQm0UNr8hSAQj3w/PFz/lZnOf0nvQlxrlWcktXYlwkEqEMVFmZLjExLlN6dAOPSCRCdgrKU3mOMSbdoIhIfKKUNU6cH7c5gUdJSUkVY7IagHlpbmn81vFZjy10TBmcMwkuvLUcWPYg+J/6u6XR9H8t3ANZX/0m/OEfp8SOL3Y7D2NnSDEzVDZiJ3l5AIDC/0cgYml9ff0qq+wQPOxWGoMZ0FAcV4sj7jY/4BEN534BAN6CxmJbopdMLfKk2+2lSm6Wr5msTJdiSj7xenqWNiCdpMqebhckRoZaRVEeMwLVeuyAIpFILSI+QPLtwMMwkJLdxiQ6ek7TNHppfV12No/s/3U1jLhvG2DXafjvmkkw8Jt/A3SsOfXWejixs0K263RsMY6CtGumuBE6utB/X7RjQutb4CEjGCVk+wp48aXdZG4a0PVV14AvX+DRcAUAkh3hFDQWx3zqyXSnV59JJAPKUCW3RDIgxhhllrpydFKauhCi1g8ZkFVn6WRPDzIXicFvieBBRx1FUV7RNO1G4wh2gLwYQWSY4HHR1CXSvvH53mfh85+vkP+mv51sfgr+tH8t/GXFAXmc+e8qsnk6gwf9ZpI2GwF9B4YMGTLWjkukr4DHWcKdCxUFOrOJ68NPsaEgevZ7bwc0Fn/Fdqfh1YLVBlKweQAM6qCISoDTg78S2PDqJSuTv0d3IBmv5GbsQM7KAXiVYgh0XW/lPFoxTggxQlGUPCJGNqgI6c8UJVngZ8fhxJ6eqD6/7Ol2avcCCaepstoYsrKypnpl19q1Y4LHpU/8FtiAISD+/Ef4z2XXS5ftJQ+/LY2nf2woga/9wy6gHcnRR6/2BA+6waACWK0oytg1a9Ycchr3uQ1Pt1L9kauTLqroJuuSiioAyRzdm1cmwGMgNM3qQXXXm4MKLKuXKrkZNpAAFeNgfVZW1lI/6elO7OluuvBiT3cDD9o91dXVVVvvMTOJGWO5iSTGBDpEiNTd3b1q/fr1SaU2mOBx4cRSaRg99aYmdx/AFbjsqd/DmY/+N3y2tgBGzG+CAd+43jd4GAAyMpGUOWFssfKTvR2e/i4AWxQrunSWNZ2cVGcrup0LAqEs/Wuw4UfO7Nx+ji3EzcrEYRkw1ljsq9Bx4Be8Nx7ohUpuNAzDWEcGx9sYY2Sgk5XpDJYtmotXOefbnYoj2akikT2ddhfEXldTUxMXNfXggw8Su9lJc2vugz2dCJApy/gq+vIaINCKiNcg4lSzKJNZpoEx9k5dXd2ETEzXf/zksj9xZtQU9ikglfD0cw0eRC//CDQWR5mTnFjTrQzmvU9deE+sf3YT4gs8Nt4HjBFr1n5oLJb1R8Or9zSQyJ5uAMcrjLGRiDjeBJCysrJLGWP7EPHjM2fOTKOjg1dKvqqqZMu6gkZjAY9cRCRPBe2eKRqZjMHXAMAxIcSYdevW/S4To/9k0WUPAoplANxX3WZBLldkS0c+88lysz8BEhN7DKEXjy0Nj8YSx/yypscda3qJNJlkPl/sXJPDD3gUbqKkplv6jas2Eyv7HLaZSAZUUVEx4MSJE02ccyos1d7d3S0BPSsrax9jjAyxOy+++OICk0k9GTKgefPmXUFF6BCRSkUQz+1bnPPyILulc6iylERn/thC3UuONT2ewdwv8KSiDkWMho1z7GnyvMCDdlOA+/pVkJiDrtra2i6hF04IQQbLSxhjspIbIpJn5FPO+U568XJzc31XcrMTtXnz5ksURZFyOOeUPyHlAMABIYSUo+v6zlmzZvmSY8eebgDIK5zzSYwxObeIeL0QYs/FF1881VqCoTdoCFNZnn3t2cyCR3qOHvEM5pksFBXNTRkb2Esyd91w6Mym7StVPk97eHpvLZrDhw+P6OrqokAslTFGW3DHCxEp+lDLzs5eevXVV3tWcrM2tHnzZvKmBKoYp+v60lmzZjnKcSNANrwqr5llGYUQbzHGbk10RfplT++t+ejrcjIHHmk3eiYwmGesRCXugdNfmeE7uS0KHBTwc1OmEuN6YxG1tbWRh4sStGS8DdVSNaIk39F1XcbiKIpCv8lKbkYtVfqK02935ebm+gra2rZt22REjFWME0LsZoy9qijKO11dXVJOdnb2RbquU1Ho2zjncRXjZsyYYSvHCzyMCvVEpUDXfqo8H4LH2ZU1YcIEMgaPZ4xd3N3dfcW+fftOTIVG86UAACAASURBVJo0iXZoD1Bp0N27d/8+cR2mHzwy7m5lu0HwcpkuLzNaOyjjNM0XtgNjc6Ch2J02L3pUId4L2nF8BsDGQmNRRoxkaR5gXHPt7e2ykhvtNsxKbrm5ua4s521tbbFKbsYuJJKTk+Na5nDr1q1zAYDyOSiBbE9WVtai6dOnu8rZvn379d3d3Svo2GHYFCIzZ850qhj3R9pRWCum0bHl888/N6M5zYA0Oh7tvvDCC6eFx5boUpg4ceIbBB7GwngZACgsnSKuKdf/BGU57927l/4eu9IPHkEo7JJ/I3RoLI5S02WU5lB+fX8Kiv5BzBZSvDEPBOQBsB9K42j0M02LcmomuDxMFSEi2QRiFeWFENI+wDmPVZSn3ATGmC/7gNlue3u7rORmHFOW5+TkBKrk1t7eLiu5GQCSn5OTQ2Uke1zbtm2LVYxjjC2fMWNGIDnbtm17AhEfNZK18mfMmNFDTqLB1KiiRgFp5A7+sKuri6q00c7mbQPwt1944YV3pWIwTX4J2zxZUDYYTl0QYxKD5soYbWAQOX4ZySZOnFjKGDuhKMq+rq6uNxhj33SSk5WVdUXi7iMT4OGfwi6IRhLvNSM7Mwoenh08BcBMGsJTnncncQMijhCC3HKgUsq3WxNCCLL2a5zzpYwxTzsEGUYBgOqbXoSIlbm5uVTqMPBlARA6dlybaEg1DKOxinEzZsxISo4FQE7qun5toiE1kT2dap8MHDhwB2PsKirvmOCqfRsRP/TrqrVTykMPPSTX+tNPP536eySBY9BQgLNMYtBcacsk5jZBfhnJ6EiCiJLawOai3WCM9BkRf6/r+mg6yljvTX3QiZJ762U+d+BxCBj7EFDshAHdWzJJgGzYFWL2AUSU9gEAICZzk3tB2iHIPsAYi9kHyA5h2C0c11p7e3uskltubm5Kldza2tpildxycnLiqpxt3bpVyqGjSkFBQUpympqayPApK8bNnDmzRzW1RPZ0OrYcP378klWrVlGsUewiQuRhw4Z9atl13McYU6uqqnwznqcNPAoqBsCfxTZA7ADoXmAAyCForvRd6JoGFoSRbOLEiTUAUJqwOJZ1d3fXEkiMHz/+4qysLPrdBHoCDgKzl1taWmgnByF4BPnO9mLpBUScK4Soo90G2SGI/dp0NTp1mVyQiCgrytMuhHMeYYzZ2gcOHTp0qa7rHyEi7WbGeNk4vNRk2EBkJbesrKzLr7nmGhnRuXnz5ksVRZGkQ5zzMV42Di85ZAMRQkg5uq5fPmvWrLjIUSf2dLd2kwlPp/bSAh4FBQqcuvYlgCiTGABuAaFE4MK2k9DU5Ls+cjKMZFYAQcSNe/funWOABtmZPiAQIUMqY2y2RX8nWlpahoXg4bVSE3/vJfBARHr5mw1mquWU/h2kq7quP8E5f9QAkHzGWA/7wMGDBx9GxCcR8dXc3FzbSm4HDx68WwjRYNhDTpGHIjc317Fi3MGDB3dQMhtj7JFRo0Y9RX3esmXLw4yxJ4UQrxYUFNjK2bp1a1xlOsYY2TQc5TQ1Ne0wAr8eufPOO6Uc65VO9nQ3vacFPCYvaQB2lkkMGNsIQ9rnBQEO6qOqqoEZySZMmHAHY8ykobi5paVl38SJE2WdGjqq7N2794qJEyeSEZWMqea1r6Wl5eYQPIK8kXRvL4CHYRiV9gEhRKWiKEnZB0wAMY431yYaUg8ePNhsHIsW5OTk9DDMtbe3FyIifXVkxTgv4CD1kNcGANbRcWnUqFH59LempiYCQXLPLrjzzjt7yNm6dStR8MUq03kBB7VpeG3WkZu3oKBAykm80sWebm3XBAuvZePbBpK/tA4AY0xiwGA97Kr0ZBJLlJ8MI1mCd4WajAMPAPigpaVltBU8iPjI6nEJjy1eK8H6ey+Ah67rqznnsqI85zwl+4AQQtohhBBrFEWJsw+0tbUdYYxREeqx3/rWt+Jc0lbgoDgOznn+qFGjPCvG/eY3v7mBc/5LRDyam5t7mfGiHyGWKqoYN3369Dg5CcBx0gAOTznbt2+PVYybOXOmlON0pcqenjHwmLy0ChhamMSYBs3LIkGWI92bLCPZxIkTjxs2DCnS57GltqWlpczsYwge/marFZA/As8X2roh/TXhfRcixirKk33Ay8bh1aIRhh2rKM8Yi9kH2tvbZSU3RLw8Nzc3zpjY1tbW7RVhasrOycmJraG2traRjDFZyS0nJ2egAR5SjmGfiJOzdetW35XpZs6cGZOzefPmkYqiSDkzZ86Ucs7FlfSxhQykf9J3QMzAzZ6D5mW+mcTMsabCSDZx4kQ6rtxBxxOLi7a2u7t7mYPB1BQbA5AQPNxXHZWWfAwairf0xuJERGJIl3YIzrmtfQARpR3CsIecol0BY8zRPiCEIFelrCjPGIvZB9zAo7293be7PUXw8C3nvAGPH1QMBy5egebKG2Hy4mbg7ADsqgzEJEZrMR2MZNTO5MmTv9nd3U12jphbOAFQ4pY+Y2z0nj17ZGBfCB72qHAUgC2F04M2QtMs3xbvVAGGjKSGu3WBSahrbRMRC4UQG/wCh7EdlXYIcvMS0JjtuR1bDh48OFsIQbYL8vR0AMCtboZSs80kji1kxY9VpqPoUDdDqSknyLEl1Tlxez6pnUf+4iUAUbZy6OBTYV9FUvFB6WAks4CHW1T0vqysrDm6rsvo0z179sSKjofgEb86jgFCJZwZrAVOjkvDKtV1/QjnnFisxzLG4uwDVuAwjKC04/C0DyAilQX4pRDiqKIoMfuAJS7D1mCaDICYBlOy15hxI2ZchovBNDCAWAymKceNpDJtyYHHEgRglSDYKvh5RVJMYtTndDCSUTuGx4UM1rEwdMYYkTdLsDBtIXZ6CsEjqpVTAFgNp89UQ1MkVvgmlYWVzLO6rp/hnMuK8oyxOPuAruvdXhGmpkzGWGxeEXEkAPyHEKJTUZSYfcCPqzaoxyUFV20gj4uTq3bixIlIXqG9e/f6StIz9TVhwoTJlDjX0tKS/vchmYXQy8/Q0aWrq2sp53wVHUlMD4txfNnU0tISpV9PuNKvrP4VYdoJDDTI7lqayUhRv2vBDTzorfDbjh/wsAaJcc5Hjxo1ypXF3Ev2wYMHrxNCyHBnpyAxRVFG33HHHSnJefnll6/TdV3KSQwSmzhxIlEFvkkA4gcMTLAxMm6/29LS4mg78hr/l/H3LzF44HpgvDKTyWxBF5THsUXaIQx7Rwe5cd0MpaZsp2ML/W6Gp1vjMoL22bzfEjeyxiU83TEuw69cM27EKTzdBBBqz2snQeBhyA2Bw+8EWO778oEH0Q2i8phM6e9jlxmXAQBOBtPAAEJh7obBtEfcSLoS49ra2pYxxpYY3B6ZTIyLVYyzS4yj6bQAQhDw8Ly3jy2VPtGdLxN4vA4MHvHk6DiH0+LTVRvI4+LkqjWHaZAAEUmwrOSWSko+0RI4kQIZJEBU/1RJQ0r+VCdSoMTps4KJ9TevXck5XAb9RnQGwGPjEwDSWhutx5L+K2rcbJwdDdv2trH0SoBXOoaZECQ2mkV5QpK+EDFmh6CK8tYgMWujiWRARODrZQNpa2vLAQBZyS1ZMqDs7OxyLxvI5s2bcxhjtX7IgOwUReCRCBR2f7M+m5eXJ/M7klD8B62trb6zcpNoP/rI5MeuAVBUYEjMaGY/PwBk+wF0DXY/YVuwKVFeJBLZQKzy5Gnp7Oy8YuPGjSdKSkqu55w/QMWv165d24M9zNpG+sGDWp/zTyNAV5YAygpw5D1Ix0XGzTWQ3VUZM27O3nA96NyJk6BXA7zSMUBqwxKeHheXkUz7ZtyIXXh6Ynu0A2GMxSq5GYFqVPi4VQghuUE45yMAII8IixljtxltUN5LQUAawpgcSpgjomPOeWtXV5eUk52dTRwmUg7nPCaHKsb53XGY40sSPLC1tTXwu5GXl5fUc4HmdsrihYDsCWBwAAR7C7holc8LngccbwKE64DhY7Dr8bhCVHYySkpKiAAoxh5G3hYhRIw9jN5kTdPi2MMyDx6mhEKq3SooKMaa0htIV9GbbYybRZseBIQnjVoZ1jbPSYBXEoOyfSSNiXHLOOeyojwR9PhhGCMbiGG78EWADACU7r80KIu6QQ4UqGKcQYAciCWNFNznwaNg82AY1BFlD0O8H56fbc8edjakfRwwXAC7Ho/WQEq8piy+G5CtBsR34AJlGjRVxFUtVFW1FBEle5gQgrJlHdnDOOdXuO0+AqNrUi8J8Zoq+pOAQGHS/i834yYpfWCHCgxoEQ6nQjvnMsDL/6C876RsVyEElQsgrs9UU/KnepECJfaI3LhCCFnJjerGMsZkJTdENOvJykpuJmeH94js7yCuD875dIPoWO5qjDvlboeIj+hLmMjZEURenwYPWsNDTw2FLuU1YHA9UNH3hiJ79rD8JbUA8EPI4mPhZxVxMUA99PF3FSOhW/wSkL0Iu5eVm7/TkYQx5os9DAB+39nZOZqOMk767h3wMKUXbboBEKok07j7tR8YLPJl3KSaMIMG3w6nO3aeywCvIAvaz702ZEDlXjYQRMxBRGmH8CID8tOH8+GeZAymyR4/Aj1HRdEHn94GAjsgW19gAMghaCzuyR42ZfF1gOx9YJAPuyrjkzPzKWIVAJor49/lKUsmAUIzAP82NFdIz6KqqrbsYZ2dnbUEErNnz754wIABtuxhmqZJ9jDr1bvgYUq+t3ESgFgh0Tb+6jfGzd54sYwdCFU8k8ZnskNQRXmyQ0TZ2uUlv9gGCY+0DwghKGGuIOiOozfGlGkZ6XDVBgIBy4B8PyfrGXW8BAyi7GEIW2BgVwQ+v/CkbS5VdNdxg0ymS7ycwIPuy1/yNiB7x7r7sAIIY2xjXV3dHAKNQYMGXX/69OkPCEQMQ2oce5imaZI97NyDh9mDok0/BARKEqIUvaXQUPzTTC+u/tY+2UCEILuRbwLk9QYBcmD7QH/TjV1/0xEk5gUCRPn30Ucfmez55Hp+/YorrnixyS9tYOGmONYvANwIp78yzzEJM3/JbwHwOWh+/LlA4DFlyQPSadFcmWs+p6rqHUZJBTKA37x27dp9qqqa3qXfa5p2xfz588cb9pAotiHuq6+vl+xhfQc8qCeEwnT1YvZqf3xJyI1LJQQMouM4+wAiSvsALQond2x/HHPQPqcrPN0NPMaNGze8s7OzWe4E4q93hRBTOed/cPXUFDbEs4eRM6Bxtjt7WP6SMyBgBvy8kuaYdhTuqQrmEeYHS24DDi+YLOwJ3hU78PhA07TRCeAx3cnjcm6OLUFXRXh/qAEfGkhXYpwbeOTl5W0zQPw5RJSeEcYYMa//2Kiwd5sjeNy7qQoYxLOHNRZ5s4elBh4vQXPlBdRPVVXj2MN8HltqNU2LsYf1rZ2Hj0UR3hJqoDc14BAkRgz2jyEi1SRe09raGkfrmJeXR3YJCo4EW/AgA+mg0zsAMFoeg8Fz0FDsjz0sf8lhAFyV6rFFVVXJHkaeFIuLtrazs3OZg8HUVLstgIQ7j95clZmQNaXiEkD9diC2MIS4SvPA4FNA3AlM2Qm7KtJjA6HiRH+6aBIwnWQBoPIpXHByDzTVEGkQAJHdND9emYmh9tU2aadi7VsP8IjWM34FGotvhMKGZkA8AM8X+2cPy1/6LABeD82V3+2hA3eD6ZvSuN5cGVefZf78+d80MqCtbmEroMSJQcTR9fX1PcqChuDRV1ekV7/yHxkBkB2o0jxA11JoftKzkpytaFlfZBTRJD5IzO4J95yUKQNDf7scTo3qBsCl5yOAeIKE05wVNiwBwCh72OnBU30XUTfbM121wG+F5orX48Q4gUd+xS0A4jVgOBp2PR6X5mCAhyN7GBlIFUWJsYfV19fH2MPCY4vXi9nXf59SMRlQxCrJAeJuYPAqcHgHunmUzChLXAQCxgHCbWeJduEkMH4X7KoIRJYD0RqqVCyaKrW5XPg6AIvW702MO/CjUzNPKZGl3unvHm2mmruR2LwFPMpbW1vjwr/z8vIk/6wQIvf999+Pz9iW/cdKGNC9KmnemOjuYzpk8Rt9BolRPd4tibsOGpPhcYmxh1EYOiJSPosMVTdtIV5TFu48vDTU136fvGQusGileaKUBMYXwa4K10rzMKXiekCxwnj5dUCIwO5K14r2ccOOL0z0GTB8CkAxvoDi+4ByN0LeoLNXKuBBrdiVEw1Y+iLV3I28vDwKZqSX7Co6ihjgQTE21xBB9a9+9av91NXvfOc7lBdEhtR3WltbJ2RkyaQpPN3sG+0+EHGpEGIVHUksHhY6vmzSNM2WPSzceWRkdnuh0VjUoASO5dBcGaiSHOQvkRXtKf/ONlrRbgiTF48DxugrRtcBEHx8D+7N8RVDYbCgdHvK8oxeyYAHPeeUJe0TONKZu5GXl0dlMq+gbpngQTsLqk1jZI3TDoPm4hpKj1AUZcy7777rRiac+iJJTIxjGOW6RXZD0MS4VDsT7jxS1WBvPS8No0JWkpMEus3LkqokZwEQOsJc62lIPbvr0IHxMXG7nPylywCQAth6XsmChx2A+ASOdOduOE3tDTfccIWu65RmMY6AmBjdurq6yn/961/H1c3N2NI4m5JPR0RrSv7rQVLyU+1fCB6parC3ns9fIivNy6NKc2VKleQgf8lrxhFmDTRX9qg0Hzek/CX/BSC9OG/ZW/sdAOQcgEe6czd6a2r7q5wQPPrDzE199FLQo5Xme3z9k+l/1AYiK8mBol8OryzvnS+mn76mfmyJJX/5DIKiXp2wy93w093z5Z633377qo8//vjwXXfd5RsTfN94viipX45j8uKHgbEnpUdlV6VtJTk5rskVNwETFDpNiXQ6MCxy5H3IX7wDgGJD8BHY/XiPSvMxPdmGQju4YvOXUFwBGRmPQnOlaw1Z23mwAkeSBtN05m70xlqJlD54uq525aBAstLEJGbK/MUvfpHzn//5n230/yF4BJqJfnAzlSWM1jVdAM2V9mQx5jCiBk46lrgDSNRrs066eXc/bltpXjbpmEeRACC3Lc4DwaK7GYRG2F1ZFFizKbpq0527Ebj/AR/4h/KHOoBzCRz/uPJJfx/yNDKJkdx/+Zd/+VZ7e/uBefPmwT//8z/D3Xff7a8fGSk3GVCB4e0+NJC/RFaaB8HGws+XxVWSs306CiC0A6FgLh0Q58Hux+MDfX6wlKzz5DVw3yXEg8cBgK4JPQLNoscq8shQgSnw3U8fQw9yS7pzN4LIDnrvTx6toGC6aFKocT2zfJnzi5tmVy2JfOutt3Lfe++93zzwgIyqD8Ej6CT2i/spMYq4YLP45XEBQl7ZlWcHp0NzZVbcWKNsU7LSPDRXOlea7ynjGCCuBAZGqUtGx5SzUacM1sOuSvcs0QwpPd25G9RNkx/EiW3d63e7of6/FU84ZsX+fxWP2QNIGpjErH15/fXXJ7z55pstS5acdZaFO48MLcxz2mzq4NEz7iIoeJC9haJV3S66Zwifkcib2du6S1fuhhU86N92LOzm2JIp5bDsyRUxEFn6yCLnXUeamMQS52H//v1z9+3bt84EkBA8enul9oa8wMcWaTglu8fg1I8thiuWXK9RchmTM9Y68mPAoBJ2Va7qDXV4yUhX7oYpx46dLAhj2dM1q3rsNBaV/gN/qvofhSnjkfIHmPW+h8oeOAsmaWQSS9TdW2+9Vbp3794aApAQPLxWVn/8/Wxchg+DqQ/gIB2YBlM/cSMUDGYGpVGC3J9H3QKIMvISGPsdDDn4Ovhl0eoF/acrd8Pa1WS4UM3nCRTiwMD4ofrZNVFQQfhw4T/cd7Xj/WlkErNT/y9+8YuSN954Q7v66qtDg2kvrM/eFZG0qxbmwK7KRtvO+nXV9u5I0yYtHbkbiZ1JBBC/RxU78Pj/6/6pTID+Y874lQxg6wJ1bpTPFAB63J8aGVCMScxNuXv27Lnt7bfffmXp0qX9z9ti1PK43Sj0E8dLIYT4lAoD6bq+c9asWSnxUlBtEs65lEORk4yx6yT4E8cCgJQjhNgZtBZJ4sQY9VduN4iJiYdUyuGcH0DETw0i451+6qlAXJBYzxTrwG9cLMW7DwaJBR5M7z2QLvDQNjU+wEDcLnS8mXM4WjJ79jeso0gzeMSYxNKtKd8ok27BZnubN28eoShKIF4KowBQIF6Kw4cPj+jq6qJCyb4KGjHGtOzs7KVXX311IDmISNXO5Hio7oqb3qg8AgBoBmGxuxwzPN0rLsPPRJ2NG/EOT/fT3pfgnnQdWzY2vvSZAHEhKPCZgvyXxffcNbOhoWFIUVHRn112HmlhEkv3NJ1T8DCKH8d4KYQQu4nIV1GUd7q6uiQvRXZ29kW6ro8zCgNFKdwATjLG7vJbetAo5vwSY0yS2BglCYhM9h1d16UcRVHoN0p0uo1KHhi7EfrtLr+lFI3nYuNBRDkekmNUbqNmpRyDyDg2HpLjWiohbYlxsVwUf4lx6V5x/bC9dBhM7WweTqroufNIL5NYuqbgnIHH1q1b5wJEeSmEEHuysrIWTZ8+3ZWXYvv27dd3d3evCFL0OLGIMwAsys3NdZXT1tZGmYorghRxtinStIgx5ioHEa9HRCnHV5GmKAmQrDSfeko+nxqYFChdq64ftePmVfHrcXEymPoGjzQziaVL/b7Bo6ysbPCpU6cmcc4ldyXZIYYOHbqnpibKXVlSUrKkvr7eF3fltm3bqLI6RUBSzYvlM2bMCMRLsW3bticQUfJSMMbyZ8yYEV9Fy9BOe3u7lMMYky9bTk5OIDnt7e2S/8KoAp+fk5NjKwcR6eVvTlN5yHzGmK0cOaweZEBYnkgz12Nx5FfkAAgi6CUmsOBkQOlabf2wHa8gMK/facgpgwc1kkYmMXMa3iA/j3HdTJTMAS/PB6jAzbBhwxy5KxGx+sSJE8uHDRvWTcxEXgBiGEYlLwVjrHLGjBlJ8VJYAOSkruvXJhpSyTAKAL+lowoiVubm5iYlxwIgsmB0oiE1jYWpn+CcEyB6F6aO7kBileZlwhwRHXNoBa5EbSdCHwEC8gxi5FileWC8INxxBHxLUrw9LeCRgfB0Ag8CDfO/QYfpCh7GbmMHbavdGqaKWYgouSs1TXNtc+vWrZKXgo4qBQUFKfFSNDU1vWYcYdbMnDkzjpeivb1dykHEPbm5uSnJaWtre83QwZqcnJw4Obqur+acSzmc85TkCCGkHCHEGkVR3Hk2ojaQAJXm2XpgbKkn+U/iRFNcx59GETv7nQBIjFlnyWeAHQLELXDBwZ19Kc4j6EuQ6fvtgsS8ZDraSNLIJJZR8FBV1VoWj6qSPSWEMNmbv88Y68Fd6QYeVBVdUaK8FJzzMV42Di8Fkw1EiCgvha7rl5vV1KnKu67rHyHKxKMxXjYOLzmGDUTKycrKutysDk9V3IQQsfF42Ti85JANxBwP5/xyX9XfpBuXTzeIjuMqyQHiZ3JXoojtSXF2UOo35w2AsjraZwDyOHXKGMdQAKSPyghg8C4IUQS7nzjkNcbw9zRoIE1MYhkDj0gkQh6BGHelruvj169ff8w69AULFgzt7u6O4650A48tW7Y8zBgjhulXCwoKHHkptm3bdpNhE4mmlQMUzZw580U7tTc1Ne2guA1EfOTOO++UvBQHDx58GBGfpMLQubm5jnLa2tpuYtHs06Fk1+CcF40aNcpWzsGDB3cYMRuPjBo1SspBRMmYTXKIENdpWSDiTYZNZKhhGC1ijNnKEULQTo9iUB4hsE7DUkuuCfMLB0BzXg7NlfZ1hPOX0o6E7CnDgeFjsOvxOFbx5ISn9tRDDz0kz/JPP/103C7Y6e+pSeu/T2cMPCy7Dh0Rx1iLvkQiEYqXsOWudAOPpqYmMipORsQFd955pysvxbZt2wi8zvJSOACI4bVZR27egoICyUtx8ODBZsNtuiAnJ8dVzsGDB2Ny3ACEvDYAsI7cqaNGjZJyCBCYwbPBGHOVg4jj6FhCFe/dAIS8NiSH3Lycc2eejUyu2SlLVkQZ0dmL0HV6AbQ8HS3n4HRNfOgiyB60GgDvBgYrYVel/4JGGRiHCRJWALH7WwZE96smMwkeMe5KTdN6VKpyAhA38Ni6davkpeCcj50+fbonL4UBIGd5KQDmzZw5M46XYvv27TcIISQvxcyZMyV7VVtb2xHGGB0pxn7rW9/ylEMAYgABGVdpBzJv1KhRcXJ+85vf3ECs2Yh4NDc3V8rRdf0I55xKDoxljHnKIQAhXnEyFhsAMo+o8qwrDhHpiPBLIcRRRVGCs3Glunzzl1D195cA2HPQvMxfOURTZtQjQDVb73Lcqdj0b9KkSd9HRKrhmmf83MoYq96zZ48sbZDMZQUL6/OJu5Fk2j7nz9zbeA2AUIFJtnoLATLsB+AaPF/o6/iYMfDIhIK2bt0qeSkM+8THpoytW7e6V/0+2xl95syZcbwUmzdvHqkoiuSlmDlzpuSlaG9vl3IQ8fLc3NyYnPb2dl9yCEByc3Pj5LS1tY1kjEk5OTk5Uo6u62c45wMAgOwTMTmI6EsOAYiiKHFyEJEIdf5DCNGpKIozz0YmJogs+qekDeczGHpwjK0R1K28YbSqHNmGhsJQnusnNX/ixIny6OcwnEdaWlqSProlAsh5ARxFmxYCAoUQHACEt4AB1ZEhp2seMEkBeR0weAwaij2Pjxlz1aqq2uMFcHLFqqoa467UNM3xa5kG8ICZM2fGnWMzAR40Fzk5OXFyMgEeJIcxFifnnILHlMV3A7IXQMBU+HklRcb2vNzAg+7+wZLbgMMrwPAeR/5Uo1Vjx7GXcJhsVogo7Sqc89kAMvWfDN7jW1pa3koGK/sFeESr8ZEOaMd5vyPNpFkom1EVQFwAjcW2NjMo3HQ3MLYaEN6B04OmQdOszmR05+cZR7eqHXhIgEuI5Zg3b14e5zzKXQnQqGmaI3dlEscWMpye5aXI0LGFDKcAQG7SwRk+tpDhlOweg/vksSV/6QuyivvQg19zdL16gUd0NIo4gwAAIABJREFU9/Ff0jPTvOwet0U4ceJE86PTY4dh2ZHsb2lpkWUQg1z94tgigWPQUIBsWuN0/DgJzZXW4tNnh1y0qRYQfgiMjYWGotgu11YnRQ0jAfGXgPAiPF9c7qS3N0DuYCi2aPnNAIECKOWHz6nhBPA40NXVNWHDhg1xyVvz588nu0KMu5JsGWvXrnU8+5txGT4Npp7AQX23GExjcSOWuAxPg6kf4CA5psHUGjdixmUQMbEPg6kncBjgbBpMfceNlJSUkNs8zmZAwXv19fXBbAaSN4K1ur70XuBBgyAQYjgOdlVe6QEeJ8j+093d/fV9+/bFZUvn5+dTIuMf6IVqaWmxf6EcGs+kwZRIluvr628OAmS299IR8c9iGyB2AHQvMADkEDRX3tXj/ns2XAecvw/I8+H5wvjoYyfS6HsbJ0kmfaF8G164N752riHgDYA/3QxwgfnfoGPyCx7ULrnsViKi5K5kLJ67EhHX19fXu3JXpuCqnTNz5kxbXop0umoZY3NycnJs5aTZVTuHMWYrJ6irVlVVV5uBpmn+bQb5S04AsvWwe9nZr5VfnlRrkafJS6uA4Y9duVGj/KB+wONUS0vLBUEWdqZctQQcZj9SAhC5O7uWjNIGhwduAaFE4MK2k7Y7vuiu4wZoLL6xhx7cioAXbnpbHl8cdh9vRG1NtH6euhngkSA69rvzoLOvO3clwKvHjx+f0dTU5Hq+sgaJKYoy+o477iAOjaSvl19++Tpd19+nBpyCxDjno0eNGpWSnIMHD14nhJByXILERjPGUpKDiDE5foLEjB2HtBkwxiguRNoMhBBxNgNN0/zZDNILHio0V7q+9JZjy6KWlpaV1oUwceJECkCk4txJHVuSXlQOD1qBI2UAiS8cTl/ijTCkfZ7jUbFw028B4Tl4vvi5QOBx76YHgKEKjbNz060PV/AwXbHkei0pKXmAMWbLXUl5I/X19b65Ky3h6bG4jGQHZsaNAIBjeLo1LiNZOZa4Ebfw9JTjMsy4EV/h6UQYctZQ/UjiDsOyI9mvaZo/m0E6jy2AedBcea2bzidNmkTBfTvIg8UYW9TV1SXBT1GUuymYMFWDabLznfhc4o4jpR1I/tI6AFRjMvywzRduOgOIM+D52VEjtlNVPbNRs2DWvRtvA85fgIaiQMc+v3pzzUMhAKmrq5MJZZQgN3z4cMpfiXJXAvzu2LFjrzcF5K5MY2KcGaiW0cS4tra2ZQSciJjpxLhlnHMCaO/EOGMCVFWV2/6srKyvr169Os5mMGfOnBHZ2dnSZqBpmr/FEzWYToKhB7+eaYPpD37wg+G6rpOh0IztsFuzKblq/b4EXveZYGE9qtj9zasdiB7nyDZlXEyD5mURz+dSAQ/GXoLG4kDHPs/+mL33e2M67zNIgCQvRRpS8qc6kQIZJECvpCMlHwCmOpECUTSrEOKVNKXkT3UlBbJMhE/wOKVpmr/FY7pqGc93zLz1MphGM36b3Vy1CcBxCBEfY4wVGu5KGuG7qQaJpXO9pqWts1mxBgFUgCC8wk2HAWFVvzm2pEVhLo0kkgFlZ2eXe9lANm/enMMYq02FDIhzXu5lA2lra8sBgNoUyYDKvWwgiJiDiFKOLzKgBH1aji2LNE2LsxmoqhqzGfg+tkSDxKhm6amUgsQYXARD+LV2QWKJwNHd3T0+0dOS6bXX6+3/oGI4cPEKNFfeCEQBydmBQCH8RZueBYTrobG4R6R37AhjHlWsgyvc9KYMImsoLs3EmD35PDIh1GzT2IHEeCkoYY4IiDnnrV1dXdItnJ2dTZygeQYxcoyXgjFWEISGkDEWk2Mksu0EgFYhhJTDOZcZqSSHMRaTg4gFQWgIhRBNlL9CbZIcg+iYogBNN7eUYyTZSTlCiFOc8wK/Ow5TfyUlJdRXaTNAxEXZ2dnSZqDr+t2UGGjaDHwbTOnhDIanjxs3bvCQIUMotoOOKoe+FMAhdbp4CQAjXtv90MGnwr4KMzPZ3+tlumqB3QqNRWZWe/RZx/q+DbcA4GsgxGh4YY6nIf+qq64azzkf/+///u8V/jqVBHuQ34b93mfYQALwUsB6gwA5EIs6kQMZtgtfBMgAsB4AlgZlUSdyICGiPBs+CZDXGwTIgcYzd+7c4VlZWa8hoqvNIJCr1py02NmcPQdD20s9uTqk6zGnVua1IKuOc/UmLIQJEyaQDemHXxrgiAIyArBKEGwV/LwiLjPd73sC0d3HdGDsRp9BYm8Dgy1+dh0EHIwRJxDA4cOHfW8ofN/oe5BJ3khuXM75dIPoOI6XgnYHRCQshNhucnYkKQaI60MIMZ3cz0KIEYwx+fIhYivnnHYHtPvZbnJ2JCuHuD4AQI6HMRY3HkSU4wGA7b44OxI6kQAchxhjjyFinM0gqSAxU040SpT8/wSC7SDgMcdw9Wg4OkUq0lGvEoYefMoLbMaPHz903759wb6+yU7E+fJchsLTTeAYM2YMvPfee/0TPM6XOc70OBKBIysra3yipyVtfYgnA/oUEPYAM8iAEIYCk5yol0gyIORzoLnCNpIxbf0JGwJITIzjEI3oFnBD0MQ4K3BQEyF4nMcLjGghv/jiizeNo8qhjAJH3C4kZzoAUjTkVda0eQD8HQD/KQxt3+612ziPp6X3h2am5APcAsxIyUcgpv7X/abkJwJHCB4+pnHBggWX6Loeq+RGUZ30GHlGzEpuiqLszNjX3Ecf3W4xgvd+2CvAkWJfw8f7rgb+6q/+qoKSXK09ZIwt61cG095SrxE0FagyXVdX19LEZMDe6q+bHKJ/XL16dWgz6AuT8SXuQ58xmGZyDiKRCFEfxiq5AcBuMowKId4xIkdp53ER51xWjKPqKEZ/ZGW6uro6uj/pyyQHSuTuSLrB8MFQA31AA+c9eEQikbmIKCvTUTo9VYyz8rHazUFJSUmsYpyRdBapq6sj123gK5FVLASQwCo8pw9QLA3n/AGztEjCNv91IcSq+vp6ihn60l3+waNg82AY+MUkYCArxgHCp3DmK3ugaZasGAeFDUugschXxTg3LW/evHnwwIEDJzHGpByyQ5w5c2bPrFlROS+//PKSO+64w5ecSCQSq0xHhCeapgUiPFFV1SRLkZXp6urqnCu52QzKiY4wBJAMv2eOgVOboux4dtGYNl0iThvimNV1vXHdunXxwVkAMG/evFsURSlExNle9YqcRkxG8Ozs7L2MMckk9vTTT7sSaWdYc4Ga9waPgs0KDDr9MDB4EBBloejYxdhJQKiG04OWw6CObgC2NFkA2bx5szJgwAAqzUBh1fFyAE5S3EJnZ+fygQMHysp0XgBChtHu7u5YZTozwS+QdqKZqyaAnMzKyrrWryHVi8c0BJCgMxHgfmvWqQkUdn9zadKolNhNR1whxEon8OCc03qdnAx4EHAMGjSI2PRjTGJPP/20vyTGAOrI1K3u4EG7jUFf7ABwrxgXdRGBrBjnF9WtAzJ2GxRm7VqZzipn2rRprn1XVTVWMa6+vj6lSm4lJSWxinGaprlXcovuluL4X02gCHqEcaKC9LMYklnMftrtN/c4pa373HXQOFVV/S/G2FIhxFxjZxA3fESkBD46stytaVogzoyKiooBHR0d2wCgg3O+gAAEEQ+tWLGiJ5NYH1W6O3gUboqrGAcMngJuVIzr5t+XuxEAiqQ8ewWYHPOhl19+ucHIqqQ/UZRnrDId55zo5XvIcQMPgx5RVnJLrDmTzDyQDYQxJnlaiaRn7dq1R53a8QIIr9+t7RJ4JAMCyT6XjG769DOJABJwbUYikfcQcY6maY65IXQ0Jjauurq6CX51QbuaK6+8kgz4BpMYbOns7IwcOXLkZFCKC78yM3GfM3gUbRoHCNGKccSQld05HtbPi4/LL9g8FAZ1xFWMC7rz+NnPfkY1U2KV6c6cOTN+1qxZcXI2b948dODAgXFy3MDDQoTzqqZptpXcVFW9GwAIHImhm9ye+W4JZKqq0s5IVnJzyhfxCwx+7wsCAqqq3mT2P8hztovKKe3eKx3fa4Vmql0nuSmCh6qqROewys3WVVJSMpuyojVNcyV7tnbx4YcfbjDSCcw/b/zoo4/m9SfgkLDgON9ndx06KGIMbJxDEWzRq3DjMgDJLNbzCojull2HLoSIq1+7c+dOx8p0HuBBhZXI3bpA07QeBqiSkpJCxtgGv8BBgzS8NuvoDKxpWo9Kbn4BwVSYn/v9ggAZ7jjndLTaWVdXN8Pvc45zb+UtNblJ7f7mBRaJv2eqXbt+pOHYUlJSQvP9Vn19vSzMNXfu3Ks452SXW2XuRoj6gJIh6+vrHVnKrd1btGhRHWPsLJMYwPqnn37alfs3qJr93E9BYkKIfR9++OE+P/fb3eMGHrGKcfY8Ag4AEhA8duzYEZMzbdq0HnwFTgDiAR6xynSJbO4JwEFxHORFkaTObtf8+fNjlekSa9P4AQK7tr2e8wMChmGY+FXJO7VS07RFfp7zGm80E9TmshIdezZic0Om2rWKSoPB1Phg0Merg3aaRpDh24i4kzE2nXP+XTq+lpSUVHHOj9bV1XkWWXrooYeqACDGJIaI2ooVK7yZxJLRs8czV199tZxfRLw5WQDx9rZkoOOZblJVVVkxjiq5aZoWV+NCVVWyoNNRxfOy2htUVZWV3Ig7Q9O0uEpuXiDgJMjrOS8QMKghydBGxur9x48fn0BbX7Li19TURF3oqVyJL3qqwGH2JVPtmu2nz1V7H2Psmrq6utJIJLJXCLGT+HrpyEulLo4dOzZ22LBhdPSl47F9ESajT2Qg/eKLL6iIuQxAZIw999RTTwUr55nKXCY8S+BhZtImCyBuOw+bL4+DK5YYi0CWujsKjcWB6qvu2LHDtjKdnSt2x44dMTnTpk1zlOMBHr5KQZKu/YKHgeC2HpZkgYOes4JHJBJZSOUtNE2LFZ22uJGPdnV1jT516tSxYcOG0XGMFve36+rqUstyzdRLnql20/hyUVMlJSVE3XB3fX19gRGlTMdheSHijPr6+u0EKrquL7dz5Zr3lpWVDc/Ozn5lxYoVNy5atIjaOLBixYqki4Hn5eWZJRPsRky76Vvfe+8919rJJnhQA5RNmwyABAQPiZnxsRzFG/NARD0R5KiFxmLHinF2I7UDD2Ny4mI5tm/fHqtMh4iNd9xxh6McVVXdji1k4KKzLO0+6Ot8qx+mLbdji2VB+QIQrx2H2Z4JHiUlJUsoaYl2F0OGDMmnXYWxmMmITAFs4+noRen6iqJQKQZZfcw38bHdxGTqeJGpdtMMHNScMedVdoXeLXNEsUQFbh6Zhx56iOyDRIK0f9CgQVMrKgIyidmMzQFAfAEHNWcFj2QBxB94kLdF6Z4AG34UVzEOijZdanhkaEtP5tex0FDsWS3eqosE8DiQnZ09YcqUKXFyfvazn8VVphNCjJ0+fbqjHEtchpPBNDCAmAZTCnF3ixvxAgav3626McHDcD3/0nCLU1wBbXcJsEcgYqmxlV6NiCO6u7sXZGfL8oXtQTwAceszU4bNTLWbAeCgJo2j6l5N0652EkEk1F1dXVe7JVAaRagqOzs7V9XU1CTHJOYNIL6Bg5rKbFZtT2v1MWBspaxAFb1uio86xfXQODuw1Thx58EYO0YRfZxzKUcIcVNC1On6adOmucrx46oN6nHx46r12oEEAQ5j8cbiPFRVJeoAOrZR9C0dXei/LxJARCKRWkR8wNixbRFCRD7//PPkYwYy5VLNVLsZAo+CgoIBw4YN+xMAlAoh3h0wYMAhymamrObOzs5rOOcUUr46mVicdHXZ2IGQbcbzqJIumWY73jsPostDdK8YR/d0DJqRTEVuC3j4qkx35syZGbNmuVf+tgaJAcBoty2lH4UaL66sGOcVJOYEIIly/ISnJxpMDZcsnZnJGHxgyJAhY0+dOvWEUafWFPFcVlbWcr9h9H7G/2W+x0+U77kED5qbv/7rv77017/+tWPgYqbmzwU8DFcsuV5l2TrJZzk8oSPHAKESni/2XTEucSCmK5Zcrzt27JCV6RAxTg7tRqgy3bRp03zLMcPTneIygihUVVUzbmSNn/B0LwDxAxyJOw+zTSO4bbWiKGN1XaeyksQ1al5PaZr2iKqqH2ma5lpkOsj4v8z3RiKRcRTQReHpiHgNABAz/inGGNWbofD0Rj+u/vNRhx7h6RuXQePsKNsQJcgNPHMLMD1aMQ6V38GZga9D0yw9VcUQgNx+++1SDiXIDRw48BbGmJSDiL87c+bM67NmBZOTrsQ4s+wmHRWCJMY5AYhf4HACD+PvI7Oyso51d3dTOQmTe+QxTdOWuz2X6jyFz4casGrgvIzzMAdo8UiQZyXVlPypyZICJUsG5BTncd99911DBb6PHz9+wbBhw8jjQnEGsSLIXvEh4SsQaiAdGjivwYMUlEgGxBgr97KBRCKRHCGErOSWKhlQKpNkd96m87VlNyRLSRpbawKR2HHvXJ/DUxl3X3t28mM7ruEMVAT2fQQkNzgwYB8wwP0CQdv9xLRDfa3Pdv2ZOHGi7xgner6lpcUVH8578DAAhGgIYxXj6EtNeSC6rpu1WsirM0JRFFnJzaAipEfpbFuQ7I4jUwvKCIJbmpWVtTE0jDprmQzdiEgxMkQvSdnfRxHxHcZYpdcHxGx1yuIdCwXAExxgsJ0kQSn1AI/tenyaZ3h6ptaD33ZD8PCrqYT7DBtIoMp0WVlZS8OXM0mFn8PHDBcr0TjMpoBCxtjdxDbf3d29DxFfNOgfNh4/fvwpp0zWgorNA/6kD9jBIRpObl5c4Z30b6EL8njFLgG4+wKlc1pThbsnsIdaJGdOBwX23QCI98PzszPGJGZU67NPaE3oGDko9u7dG8euntj3L8XOwzpow40rK8ZRJTezXCNjrJUquZkV49w4O87hexGK9qEBVVWfJeBgjM0TQtxA3joyJquq+ih58iiGCBEpjH+jpmm2+SVTluyoBQQZO2Ne37n6q/9Wcff/LflrKl7830f/9fAfv53Qnepdj0/zlV0rnyPgGHpqKHQpr8n6K8TM11CUUSYxPwDiBzio+1868PCx9tJ+i59YASehoe0i2HQQrwkAvAAAZECmhEH6fzKY07GDPIMdxtGF2O/uA4B7EtMTpix++ToB7H2ekED5+D1j93/nmv9F5FTwr4f+e//iF34p/21eglIFFPx2c8Ud3jlFVD5y8OltILADsvUFBoAcgsbijDOJuQGIX+AIwSPYukz67mS9H4nPGYS8RCEQqBSEmdRlAlFeXl6c4ay1tdX1I+J0fyIoegGd3/spgnPgwIELOedkq6IoTspCfVcIsfvMmTPVbjVrVFUl4HjH9D6pqkq5J5S/9LERbr7PjIFRVfXHADAuMYzfbtdBffirSy8+/My8v5VG6Z+s+5dj/370hF3YuvfuQ4Y9dLwEzGASQ9gCA7si8PmFJ9MR+uBnodoBSBDgOK/BI22FkWiiB3fcDignmoKEpLUdQJb3OyQrkXcM3uk26WkED/qKvkkcJIjY7OdlNe8FgO+aX1gCAy/AcFqA1meTHRe17fRsWVkZfc03MMYGUAo851zmMNHxg3NOlf7I5jCnpqZmv10fKSmScz7WPHaqqvoHygOjbGRVVSmk/wh5qOhZM2cokZ9lyuIdBDg018lc7bsen+bOZxpP70nRTBvh9Ffm9RZwmINKNKB6eVcSlXFeHlvKysokJ6oQYk1tba0nYbHjCqGaoEwQXwN9/cgesgeAGZXakCINyZU7AkAWei6C5wttXXbJvmR2zxnbcspxiaMMcHiRzB1GDDjovr4KHmVlZdMZY9uIJOfMmTPliTsMY0dSRUxclBJfU1OzPXHcyRwRE0F48qM7znAuUwDirtzLh8OKuYTfAIvWvwVt/2Gb43Zy1+PTnO0WhQ11AGhhEvOXE/ad73yH0hDIZrP8X//1X2UJEb9/c1rfIXgkaKasrIy4LChGYwEiruacz3nmmWcobybYdbYa+TFgUA4NxT+1baBo052AUCtjLBg8Bg3FPVx2aQaP2JHDz87D7LP1Xit4JB5JnJRk7lScdh5+X1qzH4k6Ic4Lxth/kDekpqYmxq5VVlZGngioqamJEQyXlZURld/diHh5Ypaqzc6DEtsuC7LzSAU8mIBTry6fJnc2Pa57N1UBO8skBsA0aCzyxSSWl5dH45Ch8a2trbJ9v38LwcPHq09sTZ9//vlhYl+vrq5es3DhQjKILbzwwgtzKyoqpIvN13XvphUGM/yLcPr0AmiKxAh4bJ8vqLsIBg2iUg93A8JKeL44juglneDh90vrBSxmO352IX7u8TNGt3tKS0uf4JwXnj59Ote641i4cKEk4Kmuro7xxtIOZNCgQW1CiMba2tq4Ql6GzeMtk7uW8nwAYLyDzYPWBxFHx5EX3/bo9sPI+VWJuva587A/tpCBdNDpHQAYdf0yeA4ain0ziVn4O55qbW19xAAPkxTI9W8hePh468vLyylJbPbHH3+cS/57oum77LLL/o1ccjU1NSt9NAFQtOmHgEDGrECTK9su2vQsIPwYGNxl3an4ebHs+ubnOYejje+SDX6Awc89yfbVHHd5efn7ZBCtqamRL4bXVVZW9iQZVKuqqkZb7zWOdXTUXIOIVHmQAsToi21edOxsjR5BYS7NWqK35bZHtz+LnJMxNe7yBR4MVu2qnFYa9+DcdcOhM/sVaCy+EQobmgHxQOIHxmu8ffH388bmUVZWdilj7Lec87usx5Sf/OQntwkhiOr+ak8iFvl16PgIED6DM4PH2BqwnPgxaXajVvT3gMFQOD0416Qo8PNifdnBo7S09IyiKPdUVVVtsepi4cKF8phWXV0dt1bLy8vv1HV9XW1tbQ/7gqqqVJuYjjXENkd8MJ8RiTHxvBBhEjGiM8YIYIgPpcexwclV6wUe5KrlgKN3PX5HfJ0XKsUKKJng4PTgqdA0y7Cb9UVI8N8nV/AwDSqJVlinv/sVa56PE7fWTn/30+7ChQtfEEKMrK2t/e6CBQuIFJi+OntWr159a2lpKTFrfehpPC3cRLVcXgDEqfD8bHs7iRt4UEfv3XgbMEZ5JvdAY7EkxQ3BIzqDHseWE4qizAsCHhToVV1d3cO+YESYUiTlDxljLyLiD80IU8bYTxGR5vmnx48fr2xqarI9ztrtPrzAA+x2HTRwuWawEgZ0r+pR+8jP4u6j9/gCD+q7CSBWC21Q146pA6txzWpAM3/3e1437y8tLb2ec/4+Y2xMVVVV6/z588nVR6HJG9euXTuHfgcAovEbW1tbe7b+TOKkFG6iGIHJcHrw1xzdZl7gIWv7dlA5iT3QWCzP0iF4eIOH07HFaedBNhJFUW5LPLZYp5Qq/QHAo4wxcpFQaYpPEfEtyrCur693Xge0ibQJT3cDj6TD088xMLz00ks4cuTIq2+88cYPg3bF89jilEyTLHDYAYi100GBg54tLS19k3P+cXV1tXxZ58+fH3NrrV27VhrUSktLN3DOL7Ea3nooq3AT+fdbzZfeVple4BH90hAIjYPGYknIk2nwsOunXz36sWf4ucfPGJM0mPY4trgZTIO+AF73n0+JcXZjJfCgv//lX/5l7ve+9z3vyFhLI57gQfem6g92miC/EYduE0yuWdq+ElHPM8888zsDPIjTkQiBF6xdu1YmGjnZROLaLmo4AQLXw/PFZ/MTnCqPJXbKWuwq6pL7MTQWy/oufl4suzE6GUP97tDsdnj0bF901d5///0jsrOzPzI8KLHYHLudR2lpKbngC7u6uq589tln40m5vdAgid/NlHwd4RaFclAozh3hA4XB6/0pJd9u6C+++CL+/d//Paxbtw5ycnKu+9u//dvf+FVRvwYP4wv0WzrXVlVVxdyj8+fPN4ONZqxduzYWSFReXk4VwO52dN2mFzxUaCyW5/E0g4eMMqV2vXYXFvDoF0FiZAQl6gQ/QWJElZBoH/G76MP7zmrABA/6y6pVq2DMmDHfuummm9r86MgTPPrysYVcs4hItULjPCn33XdfnlGaYMyaNWvILScvC9isrKqq6smHmt5jSx40Fl+bTvAwo0vP5/D08vLySUIICgJzC09fUFNTEyi/x8/L8GW8xwoeNP7Kykr47ne/O/GWW26RwXluV781mJrHEABYWl1dHRfVSdb2v/iLv7juf/7nfw4kWtPLysrmMsZW2Lpuo7aKSXB68NfTbTD1mgin3xOq1qFRWzfQi9MfE+MGDx5MHwUKqJKJcZQCwBjb3dHRsdItMS5ZPZ+r58aMGUMpDlS1jeJOev2yggcBx/jx4+d9//vfX++nI77Aoy+6ask1SwvL7ghy33333UY7Es75c6tXr46LG6DAsZEjR76n6/o7PVy3MVetyIfn59i/oF4G03s3TAbGKSoy5qr1MxHhPV8+DdBa/Oijj2S1xSuvvHKMEzFRJjVjggcBx4QJE8puuukmSrXwdXkeW3y10ss3lZaWjuOcU8Xye2pqanoUGL7vvvvILUtfrNY1a9aMSexeWVnZZMbYK4g4uqam5mxATzRIrA0QTqUYJHYRnB58bTJ1bHpZlV9acePGjRvc1dW110j5v7+1tTVjDF5OSh4zZgwlb1KUK9UDWv/ee+819vaEEHgcPnwYbr75ZvV73/tefRD5/RU8XlMUZWhVVdWNdoOlnYcQgnIlVq5Zs8a2enlZWRkFcnXU1NQUxLWRgfD0IBMS3pt5DRBwnD59eijnnIIHZV3f1tZWVwYvrwBGr98TR0V96OzsPGxEwRJfScOAAQOufuedd6h+cq9dy5YtwxtvvHHqpEmTAieP9kvwWLhwYTdjbHlVVZUrx6LbDJSXlxciYl11dfVXetxnZj9SfkvH4FJPnoUo5wfR1v0YEKrjXL29tgzSIIgoCECo8H/a+xbwKMo03e//u9PpIB4uijprZuaQQUCzXqAbOebsjBgiI8sl3tB5UHB5CJ2RA4PISGDBEAMsCcy4/Q7wAAAgAElEQVSgjByYBHgcQFkHUAwOE5ebMrqwQjqwcsJN0N3RPeuAunhE0p1013eer7qrU11dl786HUig/ufhAar/+ur/v6p667t/DKimRlvdEoR9ALzWrOSA2dUZYwUijZGsMnwlSSo4fPiw0u40rQ3n5+d7vF7vm/ThkCRpKgEINXBqaGgwreBl5PamRZj9ZrRIn89Hxv4HGhsbh9Ecn89HBspdwWCwKq2NXYaTuip4UI3Kx+O1NNJl2zlEXKebiCVHiYbmAGA5IBwDwPmG4eoUjg5sETC4DYBVQshbZQk26a64I89rK0FwFBA+ACYnjwEg+IDJpfxuT6fkQPzFoliMh7UJaNrtmAWjxYFFphMMBilK1PaI2xheB4hX8ALY6vF4SnNzc4X6+qYbGe3z+Sju6C5EpExdKkgk/42IwxsbG6kcItXmoEZnBCCUwU3RntS4+jQiHrkcKpUIc7skeIhsLCNzkosBfRHPxFSSmpRiQBT2fBAk1yR47UlbEXoZWaMAkfvvv59iJ0736tVrfopRTkkVZ3APIE5V8nFSyJIxmbFVcqPzkLdYbc8xi2Oh3yRJGs45p5fWFECswINeNsaYTCcdABk8eLBcJEq1t9/l5eWV2DFUagMbFVpmMTdDhgy5V5IkMqKvQMSt0Wj0C6PeskOGDLkpGo1SkidVrpvBOR956NAh3appAre+Q6c44GHF3phK8lC8DCF9MSiGhEYQED4FDr+H5pxt6Ugb9yyHnPC3MDaMsK2pAlp8lfBRsBzkitz+hfBo1jWw48Cz0C4duKioiFoQLI2veeXu3buTa0hMXE/q1uPA2FDYMPHPpuyYuOEHgPghIGxSq2ZW4KGmafaSWYGHmo7dMop+v78GUV3BC9YFg8ESq9uv93s6kdGDBg0iIz/Z2ZZZqSak0gDAc5IkjdaqaQMGDFiEiJSvs/jkyZNy6oXosXT2anaOAx6Z5qgNev4XYAIy2MAA3mmWoNjLIRwsB+ZbCGsBYTJDmNiwANK2wBcVFZG6QaIwldRr4ZwX7Ny5MxE0B0+8cjtwfhiQj4RXJyTHGRi5pJ/ceD8wqR4k1x2KpKWAhyqblRpwk4S2Ud0bxSrSVgEPsktkZ2dTsyaZDjWT7tu3b6LHikiujfo2+Hy+X1NRKOUYY6y2oaFBqIJXpsCD6Ph8vtsBgIy074RCodKmpqakjN64PYbKCVB8y4hgMJic2k/6Tr9+33LOu0uSdOH06dNyBLPoMWUvCIjBhrbHwOyR9flJa2W6OOGAh42XPdNT8yvA4+Vym4BHGcABpGS6WJEaChzamjcQfrblMbldgO0xcuTIPq2trRRD8AM6GRFL9uzZkxz8E5M67paL1GiHWTzLhPX7ZfUlngOkgEIgEFAqWyWoMcZW1NTUyMVxRMFDVTVLvaoVwWBQpmMHPOiFzMnJqYsHnBEfVjY2NgpX8NKyJR21RU1j0KBBt3HOKfz7h8FgMEnS8/l8dK8ov+eOw4cP66rA/fv3T1QPO3XqlFw4SfSYso6Ghgb0+WICNCJBCVKB6fifKEgS/T8KnDM4fvwkhayLg8eJcf4BUQkDwPFekKSY1Z3zIyCxfS7OagduaegSvTltv3GX4QQZQBjsAQ5bg8/DisEvwEMMYE7erVCQLnDQNoqKikjHlkveMcbW7dq1K1VEp3B8hJXw6lOJJtkJFpiBx5PrZwDDAGz8O7lKuAo8qFI5FduxzLvRY7UCCj6fL0HHrnqipnvPPff0bm1t/UNDQ0OB3+8nfhxtaGhIKhFp55anazBVX8Pv91P+zoxgMPhjAx68Hwc4/Zq5dhZsMFcBjzbAkCAaJdCI/d2jRw/25ZdfosvF4cyZT8TB4/i4Qc9KEi5inOv25kRJauaczb91y+FO35szA3zuUBK+Svh3RTIISZBNdg/5y1oJn8d7qx5VbCDahQwfPpwK3TyXlZU1sr6+PimztKioaB4ALIqfE+zVq1eBbtGbCevDgPhwwpNklUGsZA6Th4nz15TuZkbgYfSV1u5F3U+GwEILHlYuXIWeFmh8Ph8VBKJkyH3hcHh0U1NT2hW8MuWq9fv9r8c9KFV33nnnzW63mzyHEIlEppMRlewd5Jmxch2358Ek8Bg8eBBEo8mgQcDRs2dPGTgISLKyXHDmzKfW4NE0Lt/DMbsOWexrZTUYwjsSCxfnb0nW26zOc35P5YCvEvYwgG0N5bDSvxDGIkJ5SIICBUy0Z4wYMaJQkiQ5cYmaISHiiN27d8tFmuN2jvfiXdK+5pz7d+7cKZcqSBntAQ/yemiyhtVqCwFCO8Ajof7EwUSou7sOeNB5lR6PZ8WBAwd0+ySIPo9WQWBWv9N14oFhX5HtSZIkiqWh0oSKKkmRpgs45/skSdrv8Xiu66iAMQKPO++8U5YylD+K1EF/kxpDw+PJgtOnz1iDx7FHBr8EPNabk7mzWtg1Pc9L35y7Qc1c3qPPWfzufE+MtMo9LVBiy/PfCIr35hS9U11wXrzYMlUwoxJ306l6u8g2fJVAPVP/DgH2MYC7kRLAAO5VjKh6AFJUVESxApSWTwY4utl7e/fuPfLChQs9WltbqeAzuY+jiDh6z549xkl0E9Z/DAgrMqW2kMG0Z8+eS4gHtbW139MDDz1Q0UoeccMhAcj4YDD4PT3JQw9U2qPiiNyr9s7x+XyjAIA8LtQX+QLVm1FsG2QLoRo0jDEKASCDxOhgMGg76lNkjQQet99+O7S2tiZUFbUKwxijcHkZPE6d+tgcPI6P890uSdHDjHMXerKb+/9mWxO7ttd1n0wd9d8i33x9HS3I3aP3V3mrdvw//Pa/vjr1i4fyWUs4B2WrCrsjf4u+cUdkI1fKHOo7wjmnXIm7JEn6Rq8wr3av5I5FhC2KcfSTExDJGwjuT06AHMjEEEoaFiS+TEmnFxYW3sw5pxweufEyIm4jKzzVbo1LJAt27dpVacrfWLX3u2DjU6n6t7nB9H05iGzDU6aGUC14UDPxmpoaf2lpaYPSYJzWpwUP7Zp1wCMYDAb9Pp+PDMKK6xy6AHhQew5qsj4rGAzqpk34fD76+JB3aFswGEy/YZnJjSfwyM+/DVpaWhP2DUXiUIDj+uuvZ999dwGPHz9hDh5aqaPfyrqP3L1v9Edamj/+9OlR19M6+q7e8aXbk3NL5Ou/NJyeVnyHI3203R2qbMUY6xOJRKZ6PB4qvnxMKYlo9vIqcR4/uhW2knGUbCDBcvjhuM3gOnMcHs2+FrabxXkUFRWR5EHqi2ykVI0du3fvHm0JzIqrFtgI2DhRjnRMDCPwmLChEAB3giQNgtcmya5EIy+K+jgBhgIcWgARAQ9V06kGBTi0ANLZwYMCwC5evHjByvaSn5/fvVu3bt0PHTpEgYkZHwQeAwcOgO7dr03YN0hVIWlD+eNyuSAryw1NTcfMwaPpkcEnGG/rzUnSx8DVfzzFr+15pxS6KFcV4t5u+dK35//1xNN/25+kjsSOJDh22xuN5r05M779zkNw5syZ1J1OVvcoehAASj///HOhcOdM7KKwsJB6uJKNQ7knFNrsV2wglteISR8PAWMFgkFi++X+vHGpwwo84lJQksShSCDac41csCrJQytxyP8nOnbct5Y8ucInEHj0798PwuHWhH1DkTgINAhAFPD46KOjlpJHGDS9OWUAqak/w6/p8dfES+m7b/7Px1NH9pWaw9eoeYsgfZO/5UhbRuKYxWTlJ2v/Ynh7Xqybl+gxFWFETNBhjMl0RI9dqnv/zDPP/Jpzngg+AoCVy5cvTzuGIN1133///dQAmpK9yFszdPfu3SnBRYa0MxSerqWvtW2YGVDVkoeWjta2YWZA7eySR7r3N9PnEXj06/cjCIdbyOAugwWpKefPn0cCDQVA3G43HDlyJD3w6P/y28fdva4bTIuP/NdXjaemj7k1SeqQUQUu3PZGY1vvjFGLvwUO3ek47JgXOy56LBk8Er05GWMyHUQUOpZpZuvRo45ljDEKI5YHIlaJdjvriPUVFRVR8lXzrl27fpcWfW1iHAe5Oz1IcLdVYpzR9ex6W4zo2HXVouIuSIsRsgfrig6eJPAYMKAfRCKSDBy0XQUwGCOpg46RCsOgsfGwJXh8DFzO9JMHeVv++8t1/+q97sYh0daWM4hRiewdoa/+cujfphffqdg74g9XstoyZtESAHqpsArenh9rHSh6LBk8EpF0jDGZDiIKHUvzmRE+LV4LlQydilt7/vLlyxcLE+isE5WUfIBCiFcJBwTqb7LXLCW/s4LH2++nxjJGIhHZy9Da0gI9uwGMKlSqHLbt4koHj4yGpzc9MvhlxkHuzYkcov1+s73Bc8PNQ6Otrf9+euoYWZfut+rtZldW1g9bzv7Hh58888igBIBIsOK2NxqTe3N20pdDBT56K6Q4iREUN2G2/BkzZgxwuVyHP/vss2u///3vUzWyHS+++GJqhGYn5cHVsCxF8iDwGPPjAbpbXrd1H9S+8iqUP1sCo4YPTZqTDnhEo9F/oI49lM/jcrn+Xu+iInO60v2RxTO1q5bnZH93y8tvn8JuPW48M20Mj359lmIGwNX7hi9+tPJtiV385i8fTx/Tn2wf5Krl3DXo1i2pCTydlQkGACIEHLSnePsGily8oNfqsLPu+2palwIeb713DB4cdpvu1le9thNu6XszzF/8EsyfORnGFP2PxLw0weOzuc+X5y5ZWPm5y+X6vgF4WM7pSvcpoduppQ9SW9w9r/+y9cv//Cv1ZrKu/97/jZz/8vquKHWo96EBEGHgIBrxhswUCfi7ZcuWdYgrrSs9QJ1xrQp4bN39ETxaJFc4SBkrN74DG19/I3H8wx1t5TuvNvB4NxZwSBnYp+8DuEX0nraBx1UWnh4HkKdFVBVRZjrzOgcHFPB4vT4IPxuZiCFLWlwkKsFvN1F2PMggkgnweG7u3+cuW/IPppKH1ZzLwcF3AZQkyqP3QayejMhIsSpfTYlxiEgVm/5DhFGdfU5paSlFtxaq18kY21tTUzPc1tonrKegsyQ6ssF041P26Ix8fg8A09DBvVC/0Baduro63fUUFxcb0lHA49W3P4QnxyTbM4gX5IxpDkfgwsVW2LzjT7DhH7fCwT+ubbfaMvO52bkvLltqCh5Wc2zdqwxNfg+gDgHGAsAH9wHoZvvqXUrXJaWk5DN6iDjGUvIldgQB9jop+Rm6Y3Eymzdvdnk8HsqQLUREF+d8bygU2vTYY48J1/EoKSkppNB4g5U9UVtbqxsKnTI/Fj1qSMewRKGW0MiKQoBY4l7KYPgE/HGh0Hq2b99OPNGlQ203HnzwQV06Cni8su0DmPQQSePJo6U1Ct81t8K3F1tg+679wuBhZvCMRqOfPfPL53Jf+tUyU/AwmiNsTH1m1yLgbB5IuBheuj8WRyV6zOABeQ/gNQSgsPhd9wGMEH3Cr2h/tigTLte8zZs39/Z6vfXx3iHqL99Bt9s9urW19WxxcXHKPdKTMkT3kCSN6EsZoqTapBFdKUOUTJs0YiBliBLaq0gjCnis2fwuTHnsvqTzoxLCxVCrLHVcuNgC/7TvQyHwUF7uZ2b9MvelX/8qBSAIPKZO/0Xuqpd/YwoeRnNk8InTNvPYwLM7vwXg3QGkC7B8RCyOSvSYMXjUIECAAWwfBlAsynAHPEQ51QHz6urqKCqUEqVWIqKchcsYIzsMuc0po3KUHnio6mdoU9VPkuuYMUZSC8WgyFm32pGoI0r5K1SjI7WOx0lA+fqU+PgAIOrSkc+lMbIcob6SyX8nj5OAbAdwjAIar0c+FwDq6uqQ9kt/p9CJ8cN0XwqvFPBYvWkXPD1ezhNMjBCpK80x4CAAee9AgyV4KMDx9PTpuRQ8teo3K6jeSsqYNGVK7itr1piChzJH7/ypv5iRiyjB6pdfJvr6Lt+Ze5YAwzmArApeHB6LoxI9ZvAMvwtANUWmMYBNw6jToeBwwEOQUZmetm3bNspJoazY1cXFxUnZk3V1ddTyT86XMQIPnfUQ+MxFRNJdCYS2x9MEqABy0kgCj1RCqyEUmgveHJkOhJq3Q7Z3HjBIoZMEHnp0WsNzwZMdo9MS3g6e7HmAOnRU4KG3r3A4PNfr9cp0QqHQ9uzsbEp/SFmPFjzIozJtQlt5GjKSKurKdxdjasu/BI+IgMdnT02enAtAodyManoCveSxTFQqTRH/NwBs2rjBFDzGT5iYSy+dHNkpR3fG/804IFD5P8JNhPXr1hnSyfSz+C6AHHyJAKsLAYQzeR3wyPSdaCc97VdXEDyORqPRYS6XixLkFCmBamAWICI1NUoKozQED8aOQlbLMGj1vNcmbeAxCIULwOsl10RyOKZa8kje91GQ+DDgUvJ6WsMF4MneKddNVQ9j8DgaDoeHZWdnJ9EJh8MFXq+XspeT6JiBh9pISqChgMfho0dFwEMOAHv40XG5wADe3LJFV/KIb0kkSEz3KXl43LhcQIA3t8r0Dem08xFLOX0vQDkDeIEBLB8GIFyfxwGPTN8JQXoiIGFESidnZDFj7FNEbHMZxKSPEkTsrWq9IJM0ljxwMQD/FCCZDgArAYa9ARMtHGJLMwaPxXJbCgZJ6wEEqqPaG5iGjgF4UHsBABDelxl4qI2kir2D1JdjJ45ZggdtVVFdRhc/mPuHurcyLhWQzUOhfSmBg/b2LsBNCHAzAnwxHEDY+5gKHoreGr+hKQ+w1e/xE5SXQ+/LSVOsftdelyp19erV63FyR3LOXZIk7T1//vwmOw17ZJpyN7jmxwFkt6YLgO+FkHeT7b4r48a54LuBj8fckcwFgHvhmuObYMsWIS+JCjxmFRcXJ9WDfeutt6iO5RJEzH/wwQdTqmjrgQc1dWKMUVWyxEDESVRnxCZ4nAbAJDoAbBIw7GMPPPA0aNYDiJMAWB+b4EFd05LWwxibhIgp+zICD1JfzIaoq1bYIyL4AVFP60jaIsvZDXBbEVB3RPFhDB5EQwsgaoOYEbhowIP+qwUQ9VfXCFzUW5g8eTJV6arXit+IeDASiYzOyso6a9ZMKEFr8tre0JJFATHabKiD4I6OhojrbOJrasbDn1b0BpdUnyJ+MzgI2DoaIOtsCu809IgHVNcCEQcwxkaPHTtW7gpWV1dHSjoZUg8YxTLogMdRt9tdEIlEyIaixGOfdLvd/kgkQvtN8leaqi3N3gLwXvwQgCXoQCjHD97mFDomksdRaOYFkCMlrQeauR9y5M5pyf5Tc7WlIDs7O4lOOBz2Z2dnp9DRAw8CBpHR3jgPkWt01jnvAsgV2RjAn88C5D0WM0xbDn21RQ8kbACHclU9kLALHESrtLT0TUSUvRKMMdkrgYhJXgkh8Hhy/ZvAqPANrISoK1Zj1BV9Wm5QzdgOQBwlBB4jy+NeErYSILYeAFoPTgMGOwBhlAh4kGTBGKMXg+pWEuq7qAEYY4yK9frHjh2rW7hYL9UdEZczxirjfIKsrKytkUiESgaQcTFpmBpMqVF3OFQJ3hziN0DIuxW8F+cAsBQ6pgZTZMshEqoEtydOx7UVciTd9ai9LTpP7PJwOFzp9XplOqFQaKvX66Um0Snr0YKH5dNvMCGd8PR0r9UZztsLsIoBjEeA7YUAE0XXZGzzSHW7xWhaSBzaC+u43eQpIhIHzfv5z39+tyTJX7DVtbW1SZbg0tLSl6gHBs2zBI+J6+8GBJkObHwq2aIca34k07EEj58uuBs4xujUVybTGVme8JKI8mn79u19EZFqVlLDpyhj7APG2KwxY8YY6p4mdTIofZ6aRikuTaXTvTh4yDgop+HvAgYxF6uSnq+9ucY2D2XmEWC0HhYFRJKodNdjAR5ES14PuaDjzZt06Yg+U6IvhzPPnAPmBlMtgNgEDuXS7TEOGi0/nX6hurS0MQ7KC2H3yckQr0QuGwgEEg2dROZr5rxTW1s7Uj42YUM9gPxSpzHYO7BxYozOA8/XA2Pp0UF8B95ZKNOpq6tr176Ki4tj63HGJeFApwePqxkkLskT4FzkqudAu7NqUzjYSdQWBTxIlK+pqUnySgQCAdKhqRxgfk1NjbmlWJEwGMyCDU8ld7ubuGEOUJUyyZWvNG82fKIUvjCcBX9cmEzngefnAGNLAHg+1FfYslxf9U+ww4DLxoGMZdXKO+hEBlMCD8UrQU2M1qxZI3slSktLH6Civ4yxA0KZozHwoNbgAwDYaNg4UaYDT77yADAuezeEMkdjvInTwdFQvzBG528rHgCU3gTAA3YzRy/bU+Nc2OEAAGQuq9bMq2LD42LmVbHjcYmDRz6ibKRM8koAwNeSJPnXrl2r305R/WgQeJBkwaNxOngsFp8ht5z4GoD5YeNEazoyD3g+gGzETVkPRCU/7FxkTcd5bB0OdBAH+vfvj6dOnRIOAM1cVq1VEJjV73GGWAWBWf2u5WtJSUlfl8v1a0SUvRJUe4BzPuu3v/2tcEScTHPChr5A3g0W824QHYipMvbojJjfF1w84SWR6biis+APi+3R6aAHyCGbygG7z5wRD0X60trhf1FRkZwIuHv3buEX3og+AQf9ZhM8nKxaOzess8z1+XyUi0I1UQnMqHUkgc8BAPgBrZFzPvvQoUMx1cgZ7eKAHYnX7EJqI75liIDFihXgyAR4KMBhFzycrNp2PVaX/mRq5pyTk/McIhJw7EJEAgjq9taPQtPjAWO0sC+o2fOlX+GVd8VMhQxkygOoBo72gocaONIADyertis97n6/fx4iPouIJY2NjdvUa/f5fJRVKTewJkkkGAzmiuzNrq4rQvNKmqMXsJhOYJlekJ5dCUQLHO0BDy1w2AUPJ6u2Cz7l1NBYr+nx4MGDH1CS3Ci5rbGx0TyzK773dPRdEfHc7ouhpdleW0OmbAKO5KF/tzOXVdsFX8KutOQhQ4bcK0nSUlqziD3D5/NREtmjwWDQsrFWujqvHv8ypddnws6QKbtAJtZCvMoUb4hWpvZGtNpz/zOTVduV3kQba509eza5ZKmj/b2UhEbNs6uqqoS+6DYuYznV5/P9JwDIjbRE7Bl+v38CtYkQUV3ao/eqF54pnT5TX/pM2QbaKwEpPLrSvC2Zzaq1fAXsTfhiX+XtnLMZkoQrbrq33LKDe1lZmbaGZeKCjLFSRKzRW0F1dbWuq2vmzJm9PR7PCQCgGhDKIDftsOrq6g/s7aZ9s+3aMwYPHlzIGKsPBoPZVldur+6r/aoq10tHbcmUfUH7dVbWlAm3phU/u+rvdm1fmc+qzRDnsKnCc+4r3kReBPIm9LlOymf5FS1m5Ak8jIDA6jeqPFVdXZ2npj979uzJjLHkqlaxCeuqq6uputUlG3F7BkW0fiNiz3Akj2TRnm6UAxyX7HE1vVC7g1KstnF2X+UcYHKBVXkgsNk3/uT5ZR0IHqAFntmzZ09jjFGF6KTBGNtYVVUlXL/Aaq+iv/t8vtcAICcYDD5sdY7P59tC5YODwaBlVev26LzadWRKr8+EnSGTdgErfju/i3OgQ8Hjm/0VvUMt/GPGgepoxsBDgq+9HumWHgUVVPBGdyjShVZ9IVCw+g0A/lxdXf1DNeF58+bdHIlESPrpoT7OGBteVVW1V5xdmZkZN4JSf9DRwWCQWgroDp/PNwoA/gAAPw4Gg5bqleNtycz9caiIcaBDwePcn15YhSD3IYHA8kZ5RbXPDqbC9av7/GSBYYl3K9XESKUx2/KcOXOo+xipLn1JZaA2BdXV1fEqYGLMUmZNmTLlXfr3mjVrEh2F9I6ZUfX7/TXxql+T1ACi9sbQWhlj2xoaGkpFVmhX1xWh6cy5OjiAVEUPYAgAHGJUVU9gdBh4nP3nirukKDRw4JR8lgQeEkhR7gL/Df+zgipEpQwr6UKRQNQnqo7p2TyotF85IlYyxr7IyclpDoVCWyRJWrl06VKqvGVrKEChAIj2/yLEKMI0Ozu7nDFGJfV2cM7XNTQ0bNd4Yy6EQqHrmpqaTG1EItdz5jgcMOKAAhxPlpYteLWm+gXGWIUItxLgEQgEFsXrXS6ura2Ve2CKHtO70Nk/vfA+AEsUulVLHrH5+MENP1mg21Q3XclDUXPUksns2bPvZoxR348cANhaXV09TmMDmaqWQMrKyv4GEad169atpKKi4oIRE9WAocxRSyIizKc5Q4YMuUuSpHmMse4NDQ0j7XpjRK/jzHM4oMcBBTjGT5m9gBpapQse38ZTzC/U1tbKPTADgYDQMe2izu2rHI8MyCiYGItfI08pwLwnBiaOMYQn+txbntKsuJ2SR5LNo6ys7LC6diZj7GeISMbTk/FK490557lLliw5N3fu3D6SJNF8jyRJdyxbtuwLs0cuHYnD6hFON7rUiq7zu8MBLQcU4Cie+MwCb5YbstyutMFDTo4BgKra2lq5B2YgEBA6pl5UzDWLJwBcZFtIjOVbP5Zb6f3ysf6qo9FP+1zHBmpdt+lKHnqPR1lZ2cW41KH+eUF1dXXlzJkzczweTx3nfMHp06cP5uXlUQ3NQkmShi9btkwok5UAJB2Jw3mUHQ5cbg4gYsXwR59e4PW4wZudBdluN2xas9S+2pKpjWhds5Z0EebecG95lXpeOyWPJJtHWVkZSUDj1fRzcnKuvXjx4lrOea3X6z3Y1NTUnJeXR6X8XwCAWdXV1cnlBS034UxwOND1OKBIHj99/H8tIPAg6eP36351ecDjy/2LbpYiEuknVGEraSzZdBKo0fC8JwcCp+6+beMCd/OB1xfMTxTRSVfy0LN5UKe5vLy8GYyxsYjoi6+NXLnU6MZDblBEvImiOAFgG9lEut5j4KzY4UB6HFAAZNT46TKAvPHK8ssDHuf+tHADAk7Q20aqwbRtFgO2sc9Pnk8Ea7UTPFLiPAzUGSrCQ7EWZBQlEDmXk5Mz1MxImt7taTtr//79hmH3BQUFMqJ2940ynHMhuEOeoxe+n477ur37cc6/Mjigtn3UbXjp8oDHX96rDDMuv4i2BkrQcuOw8kTuhlluC3ew6A4AAAN/SURBVABQdik1V0oZdl+geOwHSRzNiDh06dKlZETtsCECHkYAogCHsjg1j+zuu8M26BDushy47HEe596vDCDAoyi1RZRacZNx+JoBbO3z4/Jaq7kd8XtZWdl4xlhzVVVVUkGejriWKHhoAUQLHGoAcYCjI+6UQ1OEAx0WJCZy8attjh3wUADECDiuNt45++18HHDA4xLeE7vgcQmX5lzK4YBtDjjgYZtl6Z/ggEf6vHPO7HwcyAh4UMq0VY0FkTmdjz2xFVF6ulIQR/1vu+tNBzwyWSjX7nqd+Q4HzDiQAh52ra6itRbSAY9AIEC5MdPcbnfJqlWrDPNMlA0i4t9IkjSNc17CGLOcL/poZAo8RK+nnSfK43TpO+c5HEiHA3rgUaFk11ml59r5KtoFj0mTJvXJysqS80zcbvcdq1atMs0zQcREXgrn/A7Knk2HIXrnXG7woDXZ5V+m9u7QcThgxAFD8KA8FIpzNwMQ5YHW/q13MTsPP0WF9uzZs54xRjU4hivNrY02gYguRKxHxELO+XDGmFBeiuhjkQ54+Hw+w2CvYDAo812v/4eypnTqhorux5nncCATHDAEj9ZIFEKtEaCIMxEJpD02j0Ag8LokSbVr166Vq3pNmTKF6lxQpNusmpqalDyTaDT6OuWlMMbk+fGua3JeCmPMMC8FEW9mjNnuJZsOeNC69ABEAQ7l5mWigVAmHgSHhsMBuxzQBQ/K7Q9HIhAKt0KoJQJ7tq42DVkVkSrM5gQCgbNKnglj7Ka4FLFtzZo1unkm0Wj0LOdczkuhNgaSJJGUso1zbpiXQu0LAICqmo1gjB20w6h0wUMLIFrg0AMQR+Kwc2ecuZeTA7rg8fjkXy4gqYPA459+/7/bJXmIqDaBQCAlz8Ttdg81MpIiojxfkqREXgrnfKiRkTQOHFRugAaVILQFIO0BDwVAjIBDDSAOcFzOV8G5tl0O6ILHI5OeXUDAsWPTy5bAQRc0kypEjaolJSVkr5DzTFwu19DVq1eb5pmQfYMkDs55MwAQcOjO1wCHwp8UADGzP9BJaletGZMdALD7CDrzuyoHdMGDKguJ2DqUTVupLaKuxkAgMB4Rm9esWSOUZ4KIVKejmVSWrnoDnHU7HOiqHGh3nIeV5CEKMF2Vgc66HQ5crRzISITp1co8Z98OB65mDjjgcTXffWfvDgfawYH/D7MfvdieNp4hAAAAAElFTkSuQmCC";e.AddFieldOptions={defaultValue:0,addToDefaultContentType:1,addToNoContentType:2,addToAllContentTypes:4,addFieldInternalNameHint:8,addFieldToDefaultView:16,addFieldCheckDisplayName:32};e.ClientErrorCodes={GenericError:-1,AccessDenied:-2147024891,DocAlreadyExists:-2130575257,VersionConflict:-2130575339,ListItemDeleted:-2130575338,InvalidFieldValue:-2130575155,NotSupported:-2147024846,Redirect:-2130575152,NotSupportedRequestVersion:-2130575151,FieldValueFailedValidation:-2130575163,ItemValueFailedValidation:-2130575162};e.Priority={Low:3,Medium:2,High:1,SuperHigh:0};e.FieldTypeToJsGridType={DateTime:"SPDateTime",Choice:"Lookup",MultiChoice:"Lookup",Attachments:"SPAttachmentsFlag",User:"SPUser",UserMulti:"SPUser",URL:"Hyperlink",Computed:"SPTextMaxLength",Lookup:"SPTextMaxLength",Boolean:"DropdownBoolean",Note:"SPMultilineText",Edit:"SPEdit",TaxonomyFieldType:"TaxonomyField",TaxonomyFieldTypeMulti:"TaxonomyField",Text:"SPTextMaxLength",Number:"SPTextMaxLength",Currency:"SPTextMaxLength",WorkflowStatus:"SPTextMaxLength",Location:"Location",Geolocation:"SPTextMaxLength"};e.TextFieldIdInModernChoiceEditor="TextFieldInWell";e.IdOfCalloutInWellOfModernChoiceEditor="ModernChoiceEditorWellCallout";e.IdOfCalloutInFlyoutOfCommonEditorCallout="CommonEditorCalloutId";e.IdOfPeoplePickerInPeopldEditor="PeoplePickerInPeopldEditor"})(t.JsGridConstants||(t.JsGridConstants={}))});
define("RWe",["require","exports","ww","o","r","Dqe","Lqe","Eqe","we","pqe","uqe","lqe","iqe","tqe","$We","JWe","YWe","VFe","aV","k","qWe","q5","tre","GWe","yqe","vqe","Ne","R5","H5","khe","T5","Nc","wRe","je","W","Pc","ld","jWe","Oqe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I){"use strict";var q=I.tablemgr_9,R=I.control_2;I=I.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var U=b.Killswitch.isActivated("46DFBEC2-2AE8-4FB3-A262-8250A3A2B12A","9/20/2019","Properly render thumbnails when we encounter them.  Fixes VSO 770299"),z=b.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),W=b.Killswitch.isActivated("E9D6989B-CA84-4451-BE8E-EB906AA2699E","12/13/2019","Use the same image rendering for all of the various types of possible image types."),X=b.Killswitch.isActivated("EA014738-A23C-45F3-B132-ED5DE252CBB3","12/30/2019","Dont let hyperlink widgets expand out past the left edge of the grid."),V=b.Killswitch.isActivated("E018B29A-CDB6-4371-ADC3-D48973674A2F","12/31/2019",'Update the return type for empty single choice from {} to "" so that it doesnt break .'),$=b.Killswitch.isActivated("4A9E7B15-9A73-4C10-9DED-B95112FFAE9E","2/25/2020","Fix a data format issue with custom formatters."),J=b.Killswitch.isActivated("59BAC612-E381-438A-893A-E1EC5719BB4C","1/30/2020",'Fix the positioning of the datepicker after the iframe loads to override the classic date picker"s incorrect positioning in some scenarios.'),K=b.Killswitch.isActivated("56576B97-4ED4-42AC-B0EA-FE5940B1F66B","1/31/2020","Fix an issue where some pickers do not cleanup container divs after dispose."),Q=b.Killswitch.isActivated("F02E7AFA-FCD5-4ECF-A4C1-677F72C39097","4/1/2020","Fix an issue where single choice with fill-in columns with a custom formatter don't render fill-in values."),G=b.Killswitch.isActivated("6E0F9B18-4BCC-4034-980F-F477BA89DFB5","04/24/2020","Attempt to rationalize the way we determine the value for custom formatters."),Y=b.Killswitch.isActivated("0345ADFA-E6FE-43BA-8465-DB405A2881E2","04/27/2020","Set the resolve principal source for quick edit people pickers."),Z=b.Killswitch.isActivated("44C0BFD4-D9A5-4591-AFD2-CC6381FDB46C","06/03/2020","Use photos for the people pills"),ee=b.Killswitch.isActivated("a1cf5d24-0923-4100-9a30-e6e82f0b4deb","6/03/2020","Provide bounds to Callout so as to not render under sticky header"),te=b.Killswitch.isActivated("94BC9995-D876-4540-AB3C-DF0CCE333DEE","06/05/2020","Do some post-processing on the IssueID field"),ne=b.Killswitch.isActivated("1DBB5F75-EA94-443B-8126-2EBC868FB96A","06/29/2020","Handle custom formatters for lookup fields"),re=b.Killswitch.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN"),ie=b.Killswitch.isActivated("B4412CBF-54F1-484D-A505-5C5C983C0FE6","8/05/2020","Add aria attributes to the error message so screen readers can announce it."),se=b.Killswitch.isActivated("4C2B1882-9E1C-44E5-BBC9-324E837A3019","8/05/2020","Swap error widget inline styles with css classname."),oe=b.Killswitch.isActivated("026D94A4-9F7C-458F-A079-A0016F93398A","8/05/2020","Fix horizontal position of the error message widget."),ue=b.Killswitch.isActivated("57190993-8AB2-4641-86C8-2C131A4B0D5A","08/21/2020","Handle custom formatters for boolean field in quick edit mode"),ae=b.Killswitch.isActivated("21404468-6FF9-49CC-8E33-080AA60517EF","09/14/2020","Render modern choice editor from source files in jsgrid project in quick edit mode"),fe=b.Killswitch.isActivated("47688D63-C459-4F16-8FB9-93EBD1962C68","9/28/2020","Fix some editing logic by moving some code around and establish a pattern."),le=b.Killswitch.isActivated("72BC029F-B3A8-4106-8DB2-CB07CAECFB89","9/28/2020","Fix some editing logic by moving some code around and establish a pattern."),ce=b.Killswitch.isActivated("019C97A0-434D-4E85-8647-293DFF9F9E43","9/28/2020","Fix some editing logic by moving some code around and establish a pattern."),he=b.Killswitch.isActivated("84AECCC1-AFDE-4E8D-BFB1-E1AB180AAF61","9/28/2020","Fix some editing logic by moving some code around and establish a pattern."),pe=b.Killswitch.isActivated("0B7042DE-D96C-4BB6-AE68-AD7D67004365","9/29/2020","Fix some editing logic by moving some code around and establish a pattern."),de=b.Killswitch.isActivated("93824270-2246-4437-A9AD-FE5C6857F386","9/29/2020","Fix some editing logic by moving some code around and establish a pattern."),ve=b.Killswitch.isActivated("26DA7C25-456D-4177-8D8E-C02A069D5968","9/29/2020","The pickers for boolean and lookup fields are using the ComboBox. We want Escape key to dismiss the menu when open."),me=b.Killswitch.isActivated("A97E0D7E-FA35-48B1-8C9B-1F7AF9E0B94F","09/28/2020","Render grid cell with transparent background when the Well and Flyout open"),ge=b.Killswitch.isActivated("3abf1a18-bdf0-4200-9117-f8da85102b5c","10/22/2020","If activated, shows Cancel icon for false in Boolean field, else shows nothing"),ye=b.Killswitch.isActivated("CDE49EA3-6531-4E44-8A15-5CB51EBC56AB","11/04/2020","When the error widget is attached to a sticky column cell it needs special treatment."),be=b.Killswitch.isActivated("BDBE6E18-5931-4DD5-A58B-50158BA4F3F5","11/04/2020","Respect the RenderAsText value on secondary lookup columns"),we=b.Killswitch.isActivated("F3EF4E23-04B8-4943-B4A1-BA41F8DCC5AA","11/18/2020","Make sure that the async render of the ComboBox editor in case of Lookup fields is not opened wrong cells."),Ee=B.getIcon("CheckMark"),Se=B.getIcon("Cancel"),xe=23,Te=4,Ne=44,Ce={ODB:1746},ke={ODB:1725},Le={ODB:1206},Ae={ODB:1740},Oe={ODB:60017},Me={ODB:1948},_e="SPDateTime",De="Invalid Date";function Pe(e){return"Title"===e.key||"FileLeafRef"===e.key}(function(e){function t(e,t){return"function"!=typeof e.LocalizedValueToCSRValue||null==t||null==t.localized}e.PropTypeNeedsCSRItemToRender=t;function n(e,t,n,r,i,s,a,f,l){var c=r.GetSpCsrRenderCtx(),h=c.ListSchema,p=o.JsGridUtil.Internal.IsFeatureEnabled(ke);o.JsGridUtil.DebugAssert(!o.JsGridUtil.Internal.IsNullOrUndefined(n));null==i&&(i={});if(t.hasLocalizedValue&&"function"==typeof f.LocalizedValueToCSRValue){var d=t._propType.LocalizedValueToCSRValue(a.localized);i[n.RealFieldName]=i[n.Name]=d}c.CurrentItem=i;c.CurrentFieldSchema=n;var v=s.parentNode;o.JsGridUtil.DebugAssert("tr"==v.tagName.toLowerCase());null==v.getAttribute("iid")&&v.setAttribute("iid",o.JsGridUtil.Internal.GenerateIID(c));if("TRUE"==n.listItemMenu){var m=s;o.JsGridUtil.DebugAssert("td"==m.tagName.toLowerCase());m.setAttribute("IsECB","TRUE")}var g,y=document.createElement("span"),b={DocIcon:"File_x0020_Type",ThumbnailOnForm:"FileRef",PreviewOnForm:"FileRef"},w=n.RealFieldName in b?b[n.RealFieldName]:n.RealFieldName;te||"IssueID"!==w||w in i||"ID"in i&&(w="ID");if(W){if(!U&&"Thumbnail"===w){(E=document.createElement("img")).src=i.FileRef;l.width&&(p&&c.fixedHeightRowEnabled?E.style.maxHeight=Ne-2*Te+"px":E.style.maxWidth=l.width-xe+"px");return E}}else if("Thumbnail"===w||"Image"===n.Format||"Thumbnail"===n.FieldType){var E=document.createElement("img"),S="";if("Thumbnail"===w)S=i.FileRef;else if("Image"===n.Format)a&&a.data&&(S=a.data.address);else if("Thumbnail"===n.FieldType&&a&&a.localized)try{S=JSON.parse(a.localized).serverRelativeUrl}catch(e){console.log("Error parsing JSON for image: "+e.toString())}p&&c.fixedHeightRowEnabled&&s.classList.add(q.imageTypeCell);E.src=S;l.width&&(p&&c.fixedHeightRowEnabled?E.style.maxHeight=Ne-2*Te+"px":E.style.maxWidth=l.width-xe+"px");return E}if(!(w in i))return y;g=n.FieldType&&-1!==n.FieldType.indexOf("Taxonomy")?T.Taxonomy.TaxonomyFieldTemplate.renderViewControl(c,n,i,h):o.JsGridUtil.Internal.IsFeatureEnabled(Ce)?N.spMgr.RenderField(c,n,i,h):window.spMgr.RenderField(c,n,i,h);if(!o.JsGridUtil.Internal.IsNullOrUndefined(g)){o.JsGridUtil.DebugAssert(g.constructor==String);y.innerHTML=g}for(var x=y.getElementsByTagName("a"),C=0;C<x.length;C++){var k=x[C];if(!o.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(k,"ms-jsgrid-click-passthrough","true")){k.onclick=null;k.addEventListener("click",L)}}o.JsGridUtil.Internal.IsNullOrUndefined(l.fnGetDisplayControlName)||u.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(f,l.fnGetDisplayControlName(e,t.key));p&&n.FieldType&&(c.fixedHeightRowEnabled?y.classList.add(I.cellHiddenOverflow):y.classList.add(I.cellBreakWordOverflow));return y;function L(e){e.preventDefault();if(!o.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(e.target,"ms-jsgrid-click-passthrough","true")){e.stopPropagation();o.JsGridUtil.Internal.IsNullOrUndefined(e.ctrlKey&&e.target.href)||window.open(e.target.href,"JsGridAnchorWindow")}}}e.RenderWithCSR=n;function a(e,t,n,r,i){if(null==e)return null;var s=new o.JsGridUtil.ImageWithFabricIcons({imgSrc:e,bIsClustered:!1}).Render(t,n,null);r&&(s.className=r);s.style.border="0px";return i?s:{elem:s,fnDispose:function(){if(!o.JsGridUtil.Internal.IsNullOrUndefined(s)&&!o.JsGridUtil.Internal.IsNullOrUndefined(s.Dispose)){s.Dispose();s=null}}}}e.RenderImage=a;function f(e,t,n,r,i){if(""==e||null==e||e==o.JsGridUtil.EmptyValue||e==o.JsGridUtil.InvalidValue)return null;var u,a=document.createElement("span");if(o.JsGridUtil.Internal.IsNullOrUndefined(t.fnClick))u=a;else{(u=document.createElement("a")).style.cssText=i;a.appendChild(u);u.href="javascript:";u.addEventListener("click",function(e){t.fnClick(e)});u.addEventListener("keydown",function(e){if(e.keyCode==s.JsGridConstants.Key.enter){t.fnClick(e);o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)}});u.tabIndex=-1}o.JsGridUtil.Internal.DomElement.GetInstance().SetTextNoBR(u,e);o.JsGridUtil.Internal.IsNullOrUndefined(t.toolTip)||(u.title=t.toolTip);r&&(a.className=r);n.textDirection!==s.JsGridConstants.TextDirection.Default&&(a.dir=n.textDirection==s.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");var f=a;o.JsGridUtil.Internal.IsNullOrUndefined(t.fnClick)||(f={elem:a,fnDispose:function(){o.JsGridUtil.ClearEventListeners(u);u=a=f=null}});return f}e.RenderText=f;function c(e,t,n){var r=document.createElement("div");r.style.cssText="text-align:center";var i=document.createElement("input");i.type="checkbox";i.tabIndex=-1;r.appendChild(i);i.disabled=e;i.checked=t;if(!o.JsGridUtil.Internal.IsNullOrUndefined(n)){i.addEventListener("mousedown",function(e){o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)});i.addEventListener("click",n)}(r={elem:r}).fnDispose=function(){r=null;o.JsGridUtil.ClearEventListeners(i);i=null};return r}e.RenderCheckbox=c;function h(e,t,n,r,i,s){if(!o.JsGridUtil.Internal.IsNullOrUndefined(r)&&r.bHyperlink)return function(){window.open(r.GetAddress(s))};var u=!o.JsGridUtil.Internal.IsNullOrUndefined(t.fnShouldLinkSingleValue)&&t.fnShouldLinkSingleValue(e,n.key,s,i)&&t.fnSingleValueClicked;return u?function(){u(e,n.key,s)}:null}e.GetSingleValueClick=h;function p(e,t,n,r,i){var s=null==t.fnGetSingleValueTooltip?null:t.fnGetSingleValueTooltip(e,n.key,i,r);return null==s?r:s}e.GetSingleValueToolTip=p;function d(e,t,n,r,i,s){return{toolTip:p(e,t,n,i,s),fnClick:h(e,t,n,r,i,s)}}e.GetSingleValueRenderInfo=d;function v(e,t,n,r,i,s,o,u,f){var l=d(e,t,n,r,i,s),c=a(o,l.toolTip,l.fnClick,u,null);return null==c?[]:[c]}e.RenderImageForSingleValue=v;function m(e,t,n,r,i,s,o,u,a){var l=f(i,d(e,t,n,r,i,s),n,u,a);return null==l?[]:[l]}e.RenderTextForSingleValue=m;function w(e,t,n,r,i,s,u,l,c){var h=d(e,t,n,r,i,s),p=a(u,h.toolTip,h.fnClick,l,null),v=f(i,h,n,l,c),m=[];o.JsGridUtil.Internal.IsNullOrUndefined(p)||m.push(p);o.JsGridUtil.Internal.IsNullOrUndefined(v)||m.push(v);return m}e.RenderImageAndTextForSingleValue=w;function S(e,t,n,r,i,s,u,a,f,l,c){var h,p=[],d=!o.JsGridUtil.Internal.IsNullOrUndefined(i)&&i.GetImageSource?i.GetImageSource(t,e.data):null,v=c.GetSpCsrRenderCtx();h=o.JsGridUtil.Internal.IsFeatureEnabled(ke)?v.fixedHeightRowEnabled?I.cellHiddenOverflow:I.cellBreakWordOverflow:f.bEnabled?"jsgrid-control-text-rtl":"jsgrid-control-text";Pe(r)&&(h=h+" "+(o.JsGridUtil.Internal.IsFeatureEnabled(ke)?I.isTitleOrNameFieldVisualRefresh:I.isTitleOrNameField));if(o.JsGridUtil.Internal.IsNullOrUndefined(i)||!i.bMultiValue||o.JsGridUtil.Internal.IsFeatureEnabled(ke)){var m=!o.JsGridUtil.SpRegionalSettings.calendarType||1===o.JsGridUtil.SpRegionalSettings.calendarType;if(i.ID===_e&&e.localized&&c.paneMgr.editMgr._updatedValue.data&&r.csrInfo&&m&&o.JsGridUtil.Internal.IsFeatureEnabled(Le)&&!o.JsGridUtil.Internal.IsIEBrowser()){var g=L.DateFormat[r.csrInfo.DateFormat],y=L.TimeFormat[r.csrInfo.TimeFormat],b={includeDate:!0,includeTime:!r.dateOnly,dateFormat:g,timeFormat:y,locale:v.ListSchema.Locale},w=c.paneMgr.editMgr._updatedValue.data,E=e.localized;w.toString()!==De&&(E=L.formatDateTime(w,e.localized,"",b));p=u(t,n,r,i,E,e.data,d,h,l)}else p=u(t,n,r,i,e.localized,e.data,d,h,l)}else for(var S=i.LocStrToLocStrArray(e.localized),x=0;x<S.length;x++){var T=x<S.length-1&&a?S[x]+i.separator:S[x];p=p.concat(u(t,n,r,i.singleValuePropType,T,e.data?e.data[x]:null,d?d[x]:null,h,l))}return 1==p.length?p[0]:0==p.length?null:{multipleChildren:p}}e.RenderImageAndOrText=S;var x=(function(){function e(){this.Id="DISP_IMAGE"}e.prototype.Render=function(e,t,n,r,i,s,o,u,a){return S(e,t,n,r,i,0,v,!1,u,null,o)};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,i,u,a){if(u.bMultiValue)return!1;if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==s.JsGridConstants.Key.enter){var f=h(n,r,i,u,t.localized,t.data);if(null!=f){f(e);o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1};return e})();e.ImageDisplayControl=x;var A=(function(){function e(){this.Id="DISP_IMAGETEXT";this._styleForLinks=null}e.prototype.Render=function(e,t,n,r,i,s,o,u,a){return S(e,t,n,r,i,0,w,!0,u,this._styleForLinks,o)};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,i,u,a){if(u.bMultiValue)return!1;if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==s.JsGridConstants.Key.enter){var f=h(n,r,i,u,t.localized,t.data);if(null!=f){f(e);o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1};return e})();e.ImageTextDisplayControl=A;var M=(function(){function e(){this.Id="DISP_TEXT";this._styleForLinks=null}e.prototype.Render=function(e,t,n,r,i,s,o,u,a){return S(e,t,n,r,i,0,m,!0,u,this._styleForLinks,o)};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,i,u,a){if(u.bMultiValue)return!1;if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==s.JsGridConstants.Key.enter){var f=h(n,r,i,u,t.localized,t.data);if(null!=f){f(e);o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1};return e})();e.TextDisplayControl=M;var _=(function(){function e(){this.Id="DISP_CHECKBOX"}e.prototype.Render=function(e,t,n,r,i,s,u,a,f){o.JsGridUtil.DebugAssert(!i.bMultiValue);return u.IsGroupingRecordKey(t.key())?null:c(!1,i.GetBool(e.data),null)};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};return e})();e.CheckboxDisplayControl=_;var B=(function(){function e(e,t,n,r,i){this.Id=e+s.JsGridConstants.RecordIndicatorControlId;this._fnUpdateCheckStatus=t;this._fnIsHidden=n;this._fnIsDisabled=r;this._fnIsChecked=i}e.prototype.Render=function(e,t,n,r,i,s,o,u){var a=this,f=t.key();return this._fnIsHidden(f)?null:c(this._fnIsDisabled(f),this._fnIsChecked(f),function(){a._fnUpdateCheckStatus(f)})};e.prototype.OnKeyDown=function(e,t,n,r,i,u){if(e.keyCode==s.JsGridConstants.Key.space||e.charCode==s.JsGridConstants.Key.space){this._fnUpdateCheckStatus(n.key());o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}return!1};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};return e})();e.RecordIndicatorCheckboxControl=B;var j=(function(){function e(){}e.prototype.Render=function(e,r,i,s,u,a,f,l,c){var h=r.fieldRawDataMap.csrInfo,p=s.csrInfo,d=null!=h&&null!=h.stale&&h.stale[s.key],v=!0;v=r.HasDataValue(s.key)?r.GetDataValue(s.key)==e.data:null==e.data||e.data==o.JsGridUtil.EmptyValue;v=r.HasLocalizedValue(s.key)?r.GetLocalizedValue(s.key)==e.localized:null==e.localized||e.localized==o.JsGridUtil.EmptyValue;var g=f.IsGroupingRecordKey(r.recordKey),y=f.IsGroupingColumnKey(i.columnKey),b=r.bIsNewRow&&"SPEdit"==s.GetPropType().ID,w="DropdownBoolean"==s.GetPropType().ID&&null==e.data;if(g&&!y||b||w)return null;u=s.GetPropType();var x=null==h&&t(u,e);if(("SPUser"==u.ID||"SPUser_MultiValue"==u.ID)&&(null==e.localized||e.localized==o.JsGridUtil.EmptyValue)&&v){(T=document.createElement("div")).style.width="180px";return T}if("CheckBoxBoolean"!==u.ID||!o.JsGridUtil.Internal.IsFeatureEnabled(Ae)){h&&h[s.key]&&p&&"Geolocation"===p.FieldType&&0===h[s.key].indexOf("Point")&&(h[s.key]=E.formatGeolocationString(h[s.key]));if(!v||null==p||d||x||"JSGrid_NewColumn"==s.key||Pe(s)){if(!Boolean(e)&&x&&null!=p&&"Title"==p.RealFieldName&&("TRUE"==p.listItemMenu||"TRUE"==p.CalloutMenu)){var T;return T=document.createElement("div")}return S(e,r,i,s,u,0,m,!1,l,null,f)}o.JsGridUtil.DebugAssert(!t(u,e)||null!=h);return n(r,s,p,f,h,c,e,u,i)}if(void 0!==e.data){var N=document.createElement("div");N.classList.add(I.boolIconDiv);var C=document.createElement("label");C.classList.add(I.srOnly);"0"===e.localized?C.innerText=SP.JsGrid.Res.booleanNo:"1"===e.localized?C.innerText=SP.JsGrid.Res.booleanYes:C.innerText=e.localized;N.appendChild(C);var k=document.createElement("i");(ge||"0"!==e.data&&!1!==e.data)&&k.classList.add("1"===e.data||!0===e.data?Ee.subset.className:Se.subset.className);k.classList.add(I.boolIcon);k.setAttribute("aria-hidden","true");k.innerHTML="1"===e.data||!0===e.data?Ee.code:ge?Se.code:"";N.appendChild(k);return N}};return e})();e.CSRDisplayControl=j;var F=(function(){function e(){}e.prototype.Render=function(e,t,n,r,i,s,u,a,f){var l=document.createElement("div"),c=u.GetSpCsrRenderCtx();if(o.JsGridUtil.Internal.IsFeatureEnabled(ke)){l.classList.add(I.customFormatField);c.fixedHeightRowEnabled&&f.classList.add(q.customFormatterCell)}l.classList.add(I.spGridCustomFormatField);var h,p=u&&u.objBag&&u.objBag.jsGridParams&&u.objBag.jsGridParams.customFormatterProps,d=p&&p.customFormatterSchema;if(G)if($){h=t&&t.fieldRawDataMap&&t.fieldRawDataMap.csrInfo;p&&p.getItemData&&(h=p.getItemData(h,d));if(b.Killswitch.isActivated("EC4AE4F1-A4D6-4A7D-B010-0F14A2EFA541","10/15/2019","Fix several problematic custom formatter bugs.")){if(!b.Killswitch.isActivated("A2742A0E-92AA-4A9A-8692-EF584A6C6B37","8/15/2019","Let custom formatters use the updated, user-entered value rather than the stored (old) value when rendering.")&&h){v=r.hasLocalizedValue?e.localized:e.data;h[r.key]!==v&&(h[r.key]=v)}}else{var v=t.HasDataValue(r.key)?e.data:e.localized;h?h[r.key]=v:(h={})[r.key]=v;V||"Choice"===r.csrInfo.FieldType&&h[r.key]===o.JsGridUtil.EmptyValue&&(h[r.key]="")}}else{h=D.deepCopy(t&&t.fieldRawDataMap&&t.fieldRawDataMap.csrInfo);var v=D.deepCopy(t.HasDataValue(r.key)?e.data:e.localized);Q||(r&&r.csrInfo&&"MultiChoice"==r.csrInfo.FieldType?e&&e.localized&&(v=e.localized.split("; ")):!e.data&&e.localized?v=D.deepCopy(e.localized):e.data&&!e.localized&&(v=D.deepCopy(e.data)));h?h[r.key]=v:(h={})[r.key]=v;if(v&&t.fieldRawDataMap.csrInfo&&t.fieldRawDataMap.csrInfo[r.key]&&p.customFormatterSchema&&p.customFormatterSchema[r.key]&&"User"===p.customFormatterSchema[r.key])if((v=v).length&&t.fieldRawDataMap.csrInfo[r.key]&&t.fieldRawDataMap.csrInfo[r.key].length){for(var m=0;m<v.length;m++)for(var g=0;g<t.fieldRawDataMap.csrInfo[r.key].length;g++)if(v[m].display==t.fieldRawDataMap.csrInfo[r.key][g].title){h[r.key][m]=t.fieldRawDataMap.csrInfo[r.key][g];break}}else v&&t.fieldRawDataMap.csrInfo[r.key]&&t.fieldRawDataMap.csrInfo[r.key].length?(v=v).display==t.fieldRawDataMap.csrInfo[r.key][0].title&&(h[r.key]=t.fieldRawDataMap.csrInfo[r.key]):v&&t.fieldRawDataMap.csrInfo[r.key]&&(v=v).display==t.fieldRawDataMap.csrInfo[r.key].title&&(h[r.key]=t.fieldRawDataMap.csrInfo[r.key]);p&&p.getItemData&&(h=p.getItemData(h,d))}else h=this._getValueForCustomFormatter(t,r,e,p,d);var w=new P.default({name:"CFParseColumn"}),E=null;try{E=JSON.parse(n.customFormatter);w.end({resultType:P.ResultTypeEnum.Success})}catch(e){w.end(H.getQosEndSchemaFromError(e))}var S=new y.CustomFormatter({rowIndex:t?t.rowIndex:-1,fieldRendererFormat:E,row:h,currentFieldName:n.columnKey,rowSchema:d,errorStrings:null,pageContextInfo:u.objBag.jsGridParams.pageContext});l.innerHTML=S.evaluate();return l};e.prototype._getValueForCustomFormatter=function(e,t,n,r,i){var s=D.deepCopy(e&&e.fieldRawDataMap&&e.fieldRawDataMap.csrInfo),o=D.deepCopy(e.HasDataValue(t.key)?n.data:n.localized);if(t&&t.csrInfo&&t.csrInfo.FieldType)switch(t.csrInfo.FieldType){case"MultiChoice":n&&n.localized&&(o=n.localized.split("; "));break;case"Choice":n&&n.localized&&(o=n.localized);break;case"Boolean":!ue&&n&&n.localized&&(o=n.localized);break;case"User":case"UserMulti":if((o=o)&&o.length&&e.fieldRawDataMap.csrInfo[t.key]&&e.fieldRawDataMap.csrInfo[t.key].length){for(var u=0;u<o.length;u++)for(var a=0;a<e.fieldRawDataMap.csrInfo[t.key].length;a++)if(o[u].display==e.fieldRawDataMap.csrInfo[t.key][a].title){o[u]=e.fieldRawDataMap.csrInfo[t.key][a];break}}else o&&e.fieldRawDataMap.csrInfo[t.key]&&e.fieldRawDataMap.csrInfo[t.key].length?(o=o).display==e.fieldRawDataMap.csrInfo[t.key][0].title&&(o=e.fieldRawDataMap.csrInfo[t.key]):o&&e.fieldRawDataMap.csrInfo[t.key]&&(o=o).display==e.fieldRawDataMap.csrInfo[t.key].title&&(o=e.fieldRawDataMap.csrInfo[t.key]);break;case"Lookup":if(!be&&t.csrInfo.RenderAsText)break;ne||n.data&&n.data&&n.localized&&(o=[{lookupId:n.data,lookupValue:n.localized}]);break;case"LookupMulti":if(!ne&&n.data&&n.data.length&&n.localized){o=[];var f=n.localized.split(";");for(u=0;u<n.data.length;u++)o[u]={lookupId:n.data[u],lookupValue:f[u]}}}s?s[t.key]=o:(s={})[t.key]=o;r&&r.getItemData&&(s=r.getItemData(s,i));return s};return e})();e.CustomFormatterDisplayControl=F;var R=(function(){function e(){}e.prototype.Render=function(e,t,n,u,a,f,c,h){var p,d,v=e&&e.localized;if(!v||v==o.JsGridUtil.EmptyValue||v==o.JsGridUtil.InvalidValue)return null;var m=a.bMultiValue?a.LocStrToLocStrArray(e.localized):[e.localized];if("NamePhoto"===O.getUserDisplayOptions(null===(d=null===(p=u)||void 0===p?void 0:p.csrInfo)||void 0===d?void 0:d.UserDisplayOptions)){for(var y=document.createElement("div"),b=[],w=re?o.JsGridUtil.Internal.SiteUrl+s.JsGridConstants.UserPhotoPath:C.getUserPhotoUrl(),E=0;E<m.length;E++){(x=Array.isArray(e.data)?e.data[E]:e.data)&&(Z?b.push(l.GetPersonDisplay({text:m[E]||x.display})):b.push(l.GetPersonDisplay({text:m[E]||x.display,imageUrl:x.email?w+x.email:""})))}o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&(c.GetSpCsrRenderCtx().fixedHeightRowEnabled?y.classList.add(I.cellHiddenOverflow,I.personaPillOverflowContainer):y.classList.add(I.cellBreakWordOverflow,I.personaPillOverflowContainer));var S=b.join("");y.innerHTML=S;return y}for(S=[],E=0;E<m.length;E++){var x;(x=Array.isArray(e.data)?e.data[E]:e.data)&&S.push({title:m[E]||x.display,email:x.email,picture:"",sip:""})}y=document.createElement("span");if(o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&c.GetSpCsrRenderCtx().fixedHeightRowEnabled){y.classList.add(I.cellHiddenOverflow);var T=S.map(function(e){return e.title}).join(", ");y.textContent=T}else r.render(i.createElement(g.UserField,{users:S}),y);return y};e.prototype.FocusNext=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!0)};e.prototype.FocusPrevious=function(e,t){return o.JsGridUtil.Utility.FocusElementInDOMCollection(e,t,!1)};e.prototype.OnKeyDown=function(e,t,n,r,i,u,a){return!u.bMultiValue&&(function(){if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==s.JsGridConstants.Key.enter){if(null!=h(n,r,i,u,t.localized,t.data)){this._fnClick(e);o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}}return!1})()};return e})();e.UserDisplayControl=R;var z=(function(){function e(){}e.prototype.Render=function(e,t,n,r,i,s,u,a,f){var l=e&&e.localized;if(!l||l==o.JsGridUtil.EmptyValue||l==o.JsGridUtil.InvalidValue)return null;var c,h=u.GetSpCsrRenderCtx(),p=o.JsGridUtil.Internal.IsFeatureEnabled(ke);try{c=JSON.parse(e.localized)}catch(e){o.JsGridUtil.DebugAssert(!1,"Error parsing json for image data. "+e.toString())}if(c&&c.serverRelativeUrl){var d=c.serverRelativeUrl,v=d=(c.serverUrl||"")+d;if(c.thumbnailRenderer&&c.thumbnailRenderer.spItemUrl&&c.thumbnailRenderer.sponsorToken){var m=k.parseItemUrl(c.thumbnailRenderer.spItemUrl);d=k.buildThumbnailUrl(m,48,48,c.thumbnailRenderer.fileVersion,c.thumbnailRenderer.sponsorToken);v=k.buildThumbnailUrl(m,3e3,2e3,c.thumbnailRenderer.fileVersion,c.thumbnailRenderer.sponsorToken)}var g=document.createElement("img");g.src=d;g.title=c.fileName||"";g.onclick=function(e){Boolean(e)&&Boolean(e.target)&&window.open(v,"_blank")};p&&h.fixedHeightRowEnabled&&f.classList.add(q.imageTypeCell);n.width&&(p&&h.fixedHeightRowEnabled?g.style.maxHeight=Ne-2*Te+"px":g.style.maxWidth=n.width-xe+"px");return g}return null};return e})();e.ImageThumbnailDisplayControl=z})(t.DisplayControl||(t.DisplayControl={}));t.DisplayControlType={Image:"DISP_IMAGE",ImageText:"DISP_IMAGETEXT",Text:"DISP_TEXT",Checkbox:"DISP_CHECKBOX",Hierarchy:"DISP_HIERARCHY",RecordIndicatorCheckbox:"DISP_RECORDINDICATORCHECKBOX",CSR:"DISP_CSR",User:"DISP_USER",CustomFormatter:"DISP_CUSTOMFORMATTER",ImageThumbnail:"DISP_IMAGE_THUMBNAIL"};(function(t){var u=(function(){function e(t,n){this.id="jsgrid_editbox";this._bInEdit=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;null!=t.parentNode&&(this.id+=t.parentNode.id);this._parentNode=t.parentNode;this._bUsingGridTextInputElement=null!=n;this._tbGrid=n;this._gridContext=t;this.iid="EditBoxEditControl_"+e._controlNum;console.log("IID: "+this.iid);e._controlNum++;this.Init()}e.prototype.Init=function(){o.JsGridUtil.DebugAssert(null==this._tbGrid||o.JsGridUtil.Internal.DomElement.GetInstance().ElementAttachedToDom(this._tbGrid));this._tbOwn=document.createElement("input");this._tbOwn.id=this.id;this._parentNode.appendChild(this._tbOwn);this.UpdateTextBoxProperty(["type"],"text");var e=this._gridContext.jsGridObj.GetSpCsrRenderCtx(),t=o.JsGridUtil.Internal.IsFeatureEnabled(ke)?I.spGridControlEditbox+" "+(e.fixedHeightRowEnabled?"":I.spGridControlEditboxDynamicHeight):"jsgrid-control-editbox";t+=" ms-grid-editbox "+R.msGridEditControlEditBox;this.UpdateTextBoxProperty(["className"],t);this.UpdateTextBoxProperty(["tabIndex"],-1);this.UpdateTextBoxProperty(["style","direction"],this._gridContext.RTL.ltr)};e.prototype.GetCellContext=function(){return this._cellContext};e.prototype.GetOriginalValue=function(){return this._cellContext.originalValue.localized};e.prototype.SetValue=function(e){this._cellContext.SetCurrentValue({localized:e})};e.prototype.Dispose=function(){o.JsGridUtil.ClearEventListeners(this._tbOwn)};e.prototype.GetInputElement=function(){return this._tbGrid||this._tbOwn};e.prototype.Focus=function(e){var t=this,n=function(){var e=t.GetOriginalValue();r.value=null==e||e==o.JsGridUtil.EmptyValue?"":e;o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&(r.scrollLeft=t._gridContext.RTL.bEnabled?-9999:9999)};try{var r=this.GetCurrentTextBoxInputControl();if(null==e){r.focus();r.value=r.value}else if(this._bUsingGridTextInputElement){this._gridContext.OnActivateActor();("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==s.JsGridConstants.Key.F2||"keydown"==e.type&&o.JsGridUtil.Internal.IsFeatureEnabled(Oe)&&e.keyCode==s.JsGridConstants.Key.enter)&&n()}else{r.focus();if("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==s.JsGridConstants.Key.F2||"keydown"==e.type&&o.JsGridUtil.Internal.IsFeatureEnabled(Oe)&&e.keyCode==s.JsGridConstants.Key.enter)n();else if(o.JsGridUtil.Utility.IsChar(e)){var i=String.fromCharCode(e.charCode);r.value=i;this.SetValue(i)}}}catch(e){o.JsGridUtil.DebugAssert(!1,"Incorrectly trying to focus the EditBoxEditControl while hidden?")}};e.prototype.BindToCell=function(e){this._cellContext=e;this.SizeToCell();this._cellContext.field.textDirection!==s.JsGridConstants.TextDirection.Default&&this.UpdateTextBoxProperty(["style","direction"],this._cellContext.field.textDirection==s.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");if(o.JsGridUtil.Internal.IsFeatureEnabled(ke)){var t=this.GetCurrentTextBoxInputControl();t.classList.remove(I.inputIsNumber);t.classList.remove(I.inputIsTitle);"Number"!==this._cellContext.field.csrInfo.FieldType||this._cellContext.field.csrInfo.CustomFormatter||t.classList.add(I.inputIsNumber);"Title"!==this._cellContext.fieldKey&&"FileLeafRef"!==this._cellContext.fieldKey||t.classList.add(I.inputIsTitle);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?t.classList.add(I.stickyEditor):t.classList.remove(I.stickyEditor))}this.UpdateTextBoxValue(this._cellContext.originalValue.data)};e.prototype.OnBeginEdit=function(e){var t=this;this._bUsingGridTextInputElement=null!=this._tbGrid&&"keypress"==e.type;var n=this.GetCurrentTextBoxInputControl();this._cellContext.Show(n);this._bInEdit=!0;this.SetupHandlers(!0);"mousedown"!=e.type||this._bUsingGridTextInputElement?this.Focus(e):setTimeout(function(){t.Focus(e)},0)};e.prototype.Unbind=function(){this.UpdateTextBoxValue("")};e.prototype.OnEndEdit=function(){var e=this.GetOriginalValue(),t=this.GetCurrentTextBoxInputControl();e=null==e||e==o.JsGridUtil.EmptyValue?"":e;t.value!==e&&this.SetValue(t.value);this.SetupHandlers(!1);this._cellContext.Hide(t);this._bInEdit=!1};e.prototype.OnCellMove=function(){this.SizeToCell();this._bInEdit&&this._cellContext.Show(this.GetCurrentTextBoxInputControl())};e.prototype.OnValueChanged=function(e){this.UpdateTextBoxValue(null==e.localized||e.localized==o.JsGridUtil.EmptyValue?"":e.localized)};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return this._bUsingGridTextInputElement};e.prototype.SetupHandlers=function(e){var t=this.GetCurrentTextBoxInputControl();if(e){t.addEventListener("focus",this._gridContext.OnActivateActor);t.addEventListener("blur",this._gridContext.OnDeactivateActor);this._bUsingGridTextInputElement||t.addEventListener("keydown",this._gridContext.OnKeyDown);t.addEventListener("keyup",this.OnKeyUp.bind(this));t.addEventListener("mousedown",this.OnMouseDown.bind(this))}else{t.addEventListener("focus",this._gridContext.OnActivateActor);t.addEventListener("blur",this._gridContext.OnDeactivateActor);this._bUsingGridTextInputElement||t.removeEventListener("keydown",this._gridContext.OnKeyDown);t.removeEventListener("keyup",this.OnKeyUp.bind(this));t.removeEventListener("mousedown",this.OnMouseDown.bind(this))}};e.prototype.OnKeyUp=function(){this.SetValue(this.GetCurrentTextBoxInputControl().value)};e.prototype.SizeToCell=function(){o.JsGridUtil.Internal.IsFeatureEnabled(ke)?this.SetSize(this._cellContext.cellWidth-3,this._cellContext.cellHeight-5):this.SetSize(this._cellContext.cellWidth-10,this._cellContext.cellHeight-6)};e.prototype.SetSize=function(e,t){this.UpdateTextBoxProperty(["style","width"],e+"px");this.UpdateTextBoxProperty(["style","height"],t+"px")};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.GetCurrentTextBoxInputControl=function(){return this._bUsingGridTextInputElement?this._tbGrid:this._tbOwn};e.prototype.UpdateTextBoxValue=function(e){var t="";null!=e&&void 0!==e&&"string"==typeof e&&(t=e);this._tbOwn.value=t;this._bUsingGridTextInputElement&&(this._tbGrid.value=t)};e.prototype.SetProp=function(e,t,n){for(var r=0;r<t.length-1;r++)e=e[t[r]];e[t[t.length-1]]=n};e.prototype.UpdateTextBoxProperty=function(e,t){this.SetProp(this._tbOwn,e,t);this._bUsingGridTextInputElement&&this.SetProp(this._tbGrid,e,t)};e._controlNum=0;return e})();t.EditBoxEditControl=u;var a=(function(){function e(e){var t=this;this.id="jsgrid_combobox";this._isDirty=!1;this._disposeFns=[];this._isBound=!1;this._shouldBind=!1;this._menuExpanded=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus();t._menuExpanded=!1};this.OnMenuOpen=function(){t._menuExpanded=!0};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this.RegisterForKeyEvents=function(e){t._activeChoiceEditor=e};this.Expand=function(){t._activeChoiceEditor.Expand()};this.OnKeyDown=function(e){if(e.keyCode==s.JsGridConstants.Key.esc){t._processingEsc=!0;setTimeout(function(){ve?t._gridContext.OnKeyDown(e):t._menuExpanded&&t._activeChoiceEditor.Dismiss();t._processingEsc=!1},0)}else e.keyCode==s.JsGridConstants.Key.tab?t._gridContext.OnKeyDown(e):e.keyCode==s.JsGridConstants.Key.space?t._activeChoiceEditor.OnRegisteredKeyEvent(e):e.keyCode===s.JsGridConstants.Key.enter&&o.JsGridUtil.Internal.IsFeatureEnabled(Oe)&&!t._menuExpanded&&t.Expand()};this.OnValueChangedInternal=function(e){if(t._isBound){if(t._processingEsc)return;if(e){null==e.data&&e.localized===F.default.emptyChoice&&(e.localized=null);t._cellContext.SetCurrentValue(e);t._isDirty=!0}}};this.GetListData=function(e){t._cellContext.propType.GetItems(function(n){if(null==n)e(null,null,!1,!0);else{for(var r=[],i=0;i<n.length;i++){var s=t.GetCellValue(n[i],t._cellContext.fieldKey);(s.data||s.localized)&&r.push({key:s.data,text:s.localized})}n.length>0&&"DropdownBoolean"!==n[0].propType.ID&&r.push({key:null,text:F.default.emptyChoice});e(r)}})};this._gridContext=e;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.style.cssText="position:absolute;visibility:hidden;border:0px;top:0px;background-color:"+this._gridContext.styleManager.gridPaneStyle.verticalBorderColor+";overflow-x:visible;";this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){var t=this;this._shouldBind=!0;this._isBound=!1;this._isMultiSelect=e.propType.bMultiValue;this._gridPane.useCustomSelFrames=!0;if(this._shouldBind){this._isBound=!0;this._cellContext=e;var n=this._cellContext.fieldKey;this.GetListData(function(e){t.RenderData(e,t._cellContext.originalValue,n)})}};e.prototype.RenderData=function(e,t,n){var s;if(we||n===this._cellContext.fieldKey&&n===(null===(s=this._gridContext.editMgr._curField)||void 0===s?void 0:s.key)){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);var u={options:[],gridOptions:e,multiSelect:this._isMultiSelect,gridValue:t,gridOnChange:this.OnValueChangedInternal.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,registerForKeyEvents:this.RegisterForKeyEvents,shouldRestoreFocus:!1,onMenuDismissed:this.OnMenuDismissed,onMenuOpen:this.OnMenuOpen,setSelectionFrame:this.SetSelectionFrame};if(this._cellContext.propType.GetIsLimitedToList)u.allowFreeform=!this._cellContext.propType.GetIsLimitedToList();else if(this._cellContext.propType.singleValuePropType&&this._cellContext.propType.singleValuePropType.GetIsLimitedToList){u.allowFreeform=!this._cellContext.propType.singleValuePropType.GetIsLimitedToList();if(u.allowFreeform&&t.localized&&t.data)for(var a=t.localized.split(";"),f=0;f<t.data.length;f++)if("object"==typeof t.data[f]){t.data[f]=a[f];e.push({key:a[f],text:a[f]})}}o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&this._gridPane.tableDiv.classList.remove(q.tableHasMouseDown);this._gridContext.portalManager?this._gridContext.portalManager.render(i.createElement(c.ChoiceEditor,u),this._container):r.render(i.createElement(c.ChoiceEditor,u),this._container);this.LayoutPickerControl();o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(I.stickyEditor):this._container.classList.remove(I.stickyEditor));this._container.addEventListener("keydown",this.OnKeyDown);this._container.focus()}};e.prototype.Unbind=function(){this._shouldBind=!1;if(this._isBound){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):r.unmountComponentAtNode(this._container);this.OnEndEdit();this._container.removeEventListener("keydown",this.OnKeyDown.bind(this));this._cellContext.Hide(this._container);this._isDirty=!1;for(;this._disposeFns.length>0;)this._disposeFns.shift()()}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){};e.prototype.OnCellMove=function(e){};e.prototype.OnEndEdit=function(){this._isBound&&this._isDirty&&this._cellContext.NotifyEditComplete()};e.prototype.SetSize=function(e,t){if(this._isBound){this._container.style.minWidth=e+"px";this._container.style.width=e+"px";this._container.style.height=t-1+"px";this._container.style.top=(parseInt(this._container.style.top)+Math.max(0,t/2-10)).toString()+"px"}};e.prototype.LayoutPickerControl=function(){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);o.JsGridUtil.Internal.IsFeatureEnabled(ke)?this._cellContext.Show(this._container,!0):this._cellContext.Show(this._container)};e.prototype.OnValueChanged=function(e){var t=this;if(null==e)return this.OnValueChangedInternal(e);this._isBound&&this.GetListData(function(n){t.RenderData(n,e)})};e.prototype.GetCellValue=function(e,t){var n={};e.HasDataValue(t)&&(n.data=e.GetData(t));e.HasLocalizedValue(t)&&(n.localized=e.GetLocalized(t));null!=e.propType&&null!=e.propType.GetDisplayValue&&(n.localized=e.propType.GetDisplayValue(this._cellContext.record,n.data,n.localized));return n};return e})();t.ComboBoxEditControl=a;var l=(function(){function t(e){var t=this;this.id="jsgrid_combobox";this._isDirty=!1;this._disposeFns=[];this._isBound=!1;this._shouldBind=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus()};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.OnOK=function(e){t._cellContext.NotifyEditComplete();if(!he&&e.keyCode&&e.keyCode===s.JsGridConstants.Key.enter){e.preventDefault();e.stopPropagation()}he&&t._cellContext.NotifyEditComplete()};this.OnCancel=function(e){t._cellContext.NotifyEditComplete(!0);if(!he&&e.keyCode&&e.keyCode===s.JsGridConstants.Key.enter){e.preventDefault();e.stopPropagation()}he&&t._cellContext.NotifyEditComplete(!0)};this.OnValueChangedInternal=function(e){if(t._isBound){if(t._processingEsc)return;if(e){null==e.data&&e.localized===F.default.emptyChoice&&(e.localized=null);t._cellContext.SetCurrentValue(e);t._isDirty=!0}}};this.GetListData=function(e){t._cellContext.propType.GetItems(function(n){if(null==n)e(null,null,!1,!0);else{for(var r=[],i=0;i<n.length;i++){var s=t.GetCellValue(n[i],t._cellContext.fieldKey);(s.data||s.localized)&&r.push({key:s.data,text:s.localized})}e(r)}})};this._gridContext=e;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}t.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.style.cssText="position:absolute;visibility:hidden;border:0px;top:0px;background-color:"+(me?this._gridContext.styleManager.gridPaneStyle.verticalBorderColor:"transparent")+";overflow-x:visible;"+(o.JsGridUtil.Internal.IsFeatureEnabled(ke)?"z-index:"+s.JsGridConstants.Internal.zIndex.editor:"margin-left:-1px");this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};t.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};t.prototype.BindToCell=function(e){this._shouldBind=!0;this._isBound=!1;this._isMultiSelect=e.propType.bMultiValue;this._gridPane.useCustomSelFrames=!0;if(this._shouldBind){this._isBound=!0;this._cellContext=e}};t.prototype.RenderData=function(t,s){var u=this;this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);var a={rowData:this._cellContext.record.fieldRawDataMap.csrInfo,rowSchema:[this._cellContext.column],currentFieldName:this._cellContext.column.columnKey,options:[],allOptions:t,multiSelect:this._isMultiSelect,currentValueOfEditor:s,gridOnChange:this.OnValueChangedInternal.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,onMenuDismissed:this.OnMenuDismissed,cellHeight:this._cellContext.cellHeight,cellWidth:this._cellContext.cellWidth,fieldType:this._cellContext.column.fieldType,goBackToDisplayMode:this.GoBackToSelectMode.bind(this),onSave:this.OnOK,onCancel:this.OnCancel,parentNode:this._parentNode,scrollParent:o.JsGridUtil.Internal.GetScrollParent(this._parentNode)};if(this._cellContext.propType.GetIsLimitedToList)a.allowFreeform=!this._cellContext.propType.GetIsLimitedToList();else if(this._cellContext.propType.singleValuePropType&&this._cellContext.propType.singleValuePropType.GetIsLimitedToList){a.allowFreeform=!this._cellContext.propType.singleValuePropType.GetIsLimitedToList();if(a.allowFreeform&&s.localized&&s.data)for(var f=s.localized.split(";"),l=0;l<s.data.length;l++)if("object"==typeof s.data[l]){s.data[l]=f[l];t.push({key:f[l],text:f[l]})}}o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&this._gridPane.tableDiv.classList.remove(q.tableHasMouseDown);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(I.stickyEditor):this._container.classList.remove(I.stickyEditor));var c=function(e,t){u._gridContext.portalManager?u._gridContext.portalManager.render(i.createElement(e,t),u._container):r.render(i.createElement(e,t),u._container)};if(ae)c(h.ModernChoiceEditor,a);else{var p=n.__assign({},a);o.JsGridUtil._uniqueGridIdKillSwitchIsActive?p.gridContainerId=o.JsGridUtil.privateWpq:p.gridContainerId=this._gridContext.gridId;n.__awaiter(u,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["XHe"],t,n)})];case 1:return[2,t.sent().ModernChoiceEditor]}})}).then(function(e){c(e,p)})}this.LayoutPickerControl()};t.prototype.Unbind=function(){this._shouldBind=!1;if(this._isBound){if(he){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):r.unmountComponentAtNode(this._container);this.OnEndEdit();this._cellContext.Hide(this._container);this._isDirty=!1}else;for(;this._disposeFns.length>0;)this._disposeFns.shift()()}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};t.prototype.GoBackToSelectMode=function(){if(he){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):r.unmountComponentAtNode(this._container);this.OnEndEdit();this._cellContext.Hide(this._container);this._isDirty=!1}else this._cellContext.NotifyEditComplete()};t.prototype.OnBeginEdit=function(e){var t=this;this.GetListData(function(e){t.RenderData(e,t._cellContext.originalValue)})};t.prototype.OnCellMove=function(e){};t.prototype.OnEndEdit=function(){if(he)this._isBound&&this._isDirty&&this._cellContext.NotifyEditComplete();else{this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):r.unmountComponentAtNode(this._container);this._cellContext.Hide(this._container);this._isDirty=!1}};t.prototype.SetSize=function(e,t){if(this._isBound){this._container.style.minWidth=e+"px";this._container.style.width=e+"px";this._container.style.height=t-1+"px";this._container.style.top=(parseInt(this._container.style.top)+Math.max(0,t/2-10)).toString()+"px"}};t.prototype.LayoutPickerControl=function(){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);o.JsGridUtil.Internal.IsFeatureEnabled(ke)?this._cellContext.Show(this._container,!0):this._cellContext.Show(this._container)};t.prototype.OnValueChanged=function(e){var t=this;if(null==e)return this.OnValueChangedInternal(e);this._isBound&&he&&this.GetListData(function(n){t.RenderData(n,e)})};t.prototype.GetCellValue=function(e,t){var n={};e.HasDataValue(t)&&(n.data=e.GetData(t));e.HasLocalizedValue(t)&&(n.localized=e.GetLocalized(t));null!=e.propType&&null!=e.propType.GetDisplayValue&&(n.localized=e.propType.GetDisplayValue(this._cellContext.record,n.data,n.localized));return n};return t})();t.ModernComboBoxEditControl=l;var g=(function(){function e(e){var t=this;this.id="jsgrid_boolean";this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.DataOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.DataOnly;this._isDirty=!1;this._isBound=!1;this.OnKeyDown=function(e){e.keyCode==s.JsGridConstants.Key.esc&&t.Unbind(!0);if(t.IsSpecialNavKeys(e)){t._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;t._gridContext.OnKeyDown(e)}};this.OnValueChangedInternal=function(e){if(e){t._cellContext.SetCurrentValue({data:e,localized:e});t._isDirty=!0;t._value=e}};this._parentNode=e.parentNode;this._gridContext=e;this.Init()}e.prototype.Init=function(){this.mainDiv=document.createElement("div");this.mainDiv.id=this.id;this.mainDiv.classList.add(R.msGridEditControlContainer);this._gridContext.RTL.bEnabled?this.mainDiv.style.right="0px":this.mainDiv.style.left="0px";this.mainDiv.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this.mainDiv);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this.mainDiv)};e.prototype.BindToCell=function(e){this._isBound=!0;this._cellContext=e;this._value=this.GetOriginalValue();o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this.mainDiv.classList.add(I.stickyEditor):this.mainDiv.classList.remove(I.stickyEditor))};e.prototype.Unbind=function(e){if(this._isBound){this.OnEndEdit(e);this._cellContext.Hide(this.mainDiv);this._isDirty=!1;this._gridContext.portalManager?this._gridContext.portalManager.unmount(this.mainDiv):r.unmountComponentAtNode(this.mainDiv)}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){this._cellContext.Show(this.mainDiv);this.RenderData(this._value)};e.prototype.OnCellMove=function(e){this.RenderData(this._value)};e.prototype.OnEndEdit=function(e){if(this._isBound&&this._isDirty){this._isDirty=!1;this._cellContext.NotifyEditComplete(e)}this._value=""};e.prototype.RenderData=function(e){var t=this._cellContext.cellWidth,n=this._cellContext.cellHeight;n=o.JsGridUtil.Internal.IsFeatureEnabled(ke)?this._cellContext.cellHeight-5:this._cellContext.cellHeight-6;var s={onEditorKeyDown:this.OnKeyDown,onValueChange:this.OnValueChangedInternal,height:n,width:t,value:e};this._gridContext.portalManager?this._gridContext.portalManager.render(i.createElement(j.CheckboxEditor,s),this.mainDiv):r.render(i.createElement(j.CheckboxEditor,s),this.mainDiv)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==s.JsGridConstants.Key.tab||t==s.JsGridConstants.Key.esc||t==s.JsGridConstants.Key.enter||t==s.JsGridConstants.Key.windows||t>=s.JsGridConstants.Key.left&&t<=s.JsGridConstants.Key.down};e.prototype.GetOriginalValue=function(){if(void 0!==this._cellContext.originalValue.data)return this._cellContext.originalValue.data.toString()};return e})();t.CheckboxEditControl=g;var y=(function(){function e(e){var t=this;this.idPrefix="peoplePickerDiv";this._isDirty=!1;this._inEdit=!1;this._isBound=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnEditorKeyDown=function(e){t._inEdit&&!t.IsSpecialNavKeys(e)||t.OnKeyDownInternal(e)};this.OnKeyUp=function(e){e.keyCode===s.JsGridConstants.Key.esc&&t.OnKeyDownInternal(e)};this.OnUserResolvedCallback=function(e){t._isDirty=!0;var n;if(Boolean(t._cellContext.field._multiValue)&&e.length>0){for(var r=[],i=[],s=0;s<e.length;s++){var u=t.OnSingleUserValue(e[s]);r.push(u.data);i.push(u.localized)}n={data:r,localized:o.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(i,o.JsGridUtil.multiValSeparator,!1)}}else n=e.length>0?t.OnSingleUserValue(e[0]):{data:null,localized:""};void 0!==n&&null!=n&&t._cellContext.SetCurrentValue(n)};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.EnsurePeoplePicker=function(e,t){var n=this._cellContext.propType.bMultiValue?this._cellContext.propType.singleValuePropType:this._cellContext.propType,u=n.GetPeoplePickerSettings.bind(n)(this._cellContext.fieldKey),a=null==u||""==u?[]:u.split(";#");o.JsGridUtil.DebugAssert(3==a.length,"SPUser settings to initialize PeoplePicker has 3 values.");var l,c,h={principalType:m.createSPPrincipalType(a[0]),allowMultipleEntities:this._cellContext.field._multiValue,groupID:a[1],maximumEntitySuggestions:3,required:"True"===a[2]};Y||(h.principalSource=15);!le&&o.JsGridUtil.Internal.IsFeatureEnabled(Me)&&(l=this.OnKeyUp);c=o.JsGridUtil.Internal.IsFeatureEnabled(Oe)?this.OnEditorKeyDown:this.OnKeyDown.bind(this);var p,d={dataSource:this._gridContext.peoplePickerDataSource,context:this._gridContext.pageContext,selectedItems:e,peoplePickerQueryParams:h,onSelectedPersonasChange:this.OnUserResolvedCallback,inputProps:{onBlur:this.OnPickerInputBlur.bind(this),onFocus:this._gridContext.OnActivateActor},onEditorMouseDown:this.OnMouseDown.bind(this),onEditorKeyDown:c,onEditorKeyUp:l,positionGridSelectionFrame:this.PositionGridSelectionFrame,setSelectionFrame:this.SetSelectionFrame,cellHeight:this._cellContext.cellHeight,cellWidth:this._cellContext.cellWidth,parentNode:this._parentNode,goBackToSelectMode:this.GoBackToSelectMode.bind(this),calloutId:s.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout};this._gridContext.portalManager?this._gridContext.portalManager.render(i.createElement(f.PeopleEditor,d),this._pickerContainer):r.render(i.createElement(f.PeopleEditor,d),this._pickerContainer);if(o.JsGridUtil.Internal.IsFeatureEnabled(Me)){p=document.getElementById(s.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout).getElementsByTagName("input")}else p=this._pickerContainer.getElementsByTagName("input");p&&p.length&&(this._pickerInputElement=p[0]);this._inEdit&&this.SetupHandlers(!0);if(null!=t&&null!=this._pickerInputElement&&("keydown"==t.type||"keypress"==t.type)&&o.JsGridUtil.Utility.IsChar(t)){var v=String.fromCharCode(t.charCode);this._pickerInputElement.value=v}};e.prototype.Init=function(){this._gridContext.RTL.bEnabled?this._direction=this._gridContext.RTL.rtl:this._direction=this._gridContext.RTL.ltr;this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane;le||this.CreatePickerDiv(this.idPrefix)};e.prototype.CreatePickerDiv=function(e){this._pickerContainer=document.createElement("div");this._pickerContainer.id=e;this._pickerContainer.style.direction=this._direction;this._direction==this._gridContext.RTL.rtl?this._pickerContainer.style.right="-1px":this._pickerContainer.style.left="-1px";this._pickerContainer.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;border-width:0px";this._pickerContainer.className=o.JsGridUtil.Internal.IsFeatureEnabled(ke)?I.msGrid:"ms-grid";le&&o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickerContainer.classList.add(I.stickyEditor):this._pickerContainer.classList.remove(I.stickyEditor));this._parentNode.appendChild(this._pickerContainer);le&&this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.Dispose=function(){};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return!1};e.prototype.BindToCell=function(e){this._cellContext=e;this._isBound=!0;this._gridPane.useCustomSelFrames=!1;if(le)this.CreatePickerDiv(this.idPrefix);else{this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickerContainer.classList.add(I.stickyEditor):this._pickerContainer.classList.remove(I.stickyEditor))}};e.prototype.Unbind=function(){this._isBound=!1;this._gridPane.useCustomSelFrames=!1;if(le){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._pickerContainer):r.unmountComponentAtNode(this._pickerContainer);this._cellContext.Hide(this._pickerContainer)}!K&&le&&this._parentNode.removeChild(this._pickerContainer)};e.prototype.GoBackToSelectMode=function(){this._cellContext.NotifyEditComplete();le&&this._cellContext.NotifyEditComplete()};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._pickerContainer,!0);this.EnsurePeoplePicker(t,e)};e.prototype.OnEndEdit=function(){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;if(!le){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._pickerContainer):r.unmountComponentAtNode(this._pickerContainer);this._cellContext.Hide(this._pickerContainer)}};e.prototype.SetupHandlers=function(e){null!=this._pickerContainer&&(e?this._pickerContainer.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._pickerContainer.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.OnPickerInputBlur=function(e){this._inEdit||this._gridContext.OnDeactivateActor(e)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==s.JsGridConstants.Key.tab||t==s.JsGridConstants.Key.esc||t==s.JsGridConstants.Key.enter||t==s.JsGridConstants.Key.windows||t>=s.JsGridConstants.Key.left&&t<=s.JsGridConstants.Key.down};e.prototype.OnKeyDown=function(e){o.JsGridUtil.Internal.IsFeatureEnabled(Oe)||this._inEdit&&!this.IsSpecialNavKeys(e)||this.OnKeyDownInternal(e)};e.prototype.OnKeyDownInternal=function(e){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.OnValueChanged=function(e){if(this._isDirty){this.UpdateElementValue(this._pickerInputElement,e);this._isDirty=!1}};e.prototype.SetSize=function(e,t){this._pickerContainer.style.minWidth=String(e-2)+"px";o.JsGridUtil.Internal.IsFeatureEnabled(ke)||(this._pickerContainer.style.minHeight=String(t-2)+"px");o.JsGridUtil.Internal.IsFeatureEnabled(Me)&&(this._pickerContainer.style.height=t-1+"px")};e.prototype.OnCellMove=function(){this._isBound&&this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.GetOriginalValue=function(){return null!=this._cellContext.originalValue.data?this.GetOriginalDataValue():this.GetOriginalLocValue()};e.prototype.GetOriginalDataValue=function(){for(var e=[],t=this._cellContext.originalValue.data,n=0;n<t.length;n++)"email"in t[n]?e.push(this.BuildUnresolvedEntity(t[n].email,t[n].display)):e.push(this.BuildUnresolvedEntity(t[n].get_email(),t[n].get_lookupValue()));return e};e.prototype.GetOriginalLocValue=function(){var e=[],t=this._cellContext.originalValue.localized;if(null!=t&&""!==t)for(var n=t.split(o.JsGridUtil.multiValSeparator),r=0;r<n.length;r++)""!==n[r]&&e.push(this.BuildUnresolvedEntity(o.JsGridUtil.Internal.Encoding_STSHtmlEncode(n[r]),n[r]));return e};e.prototype.BuildUnresolvedEntity=function(e,t){return{userId:e,name:t,email:e}};e.prototype.OnSingleUserValue=function(e){var t={data:null,localized:""};e&&(t={data:{email:e.email,display:e.name,title:e.name},localized:e.name});return t};e.prototype.UpdateElementValue=function(e,t){o.JsGridUtil.DebugAssert(null!=e);e.value=t};return e})();t.PeoplePickerEditControl=y;var b=(function(){function e(e){var t=this;this._idPrefix="locationPickerDiv";this._isDirty=!1;this._inEdit=!1;this._isBound=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnEditorKeyDown=function(e){t._inEdit&&!t.IsSpecialNavKeys(e)||t.OnKeyDownInternal(e)};this.OnLocationResolvedCallback=function(e){t._isDirty=!0;var n;void 0!==(n=e?t.OnSingleLocationValue(e):{data:null,localized:""})&&null!=n&&t._cellContext.SetCurrentValue(n)};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.EnsureLocationPicker=function(e,t){var n;n=o.JsGridUtil.Internal.IsFeatureEnabled(Oe)?this.OnEditorKeyDown:this.OnKeyDown.bind(this);var s={dataSource:this._gridContext.locationDataSource,pageContext:this._gridContext.pageContext,defaultLocation:e,onChange:this.OnLocationResolvedCallback,onBlur:this.OnPickerInputBlur.bind(this),onEditorMouseDown:this.OnMouseDown.bind(this),onEditorKeyDown:n,positionGridSelectionFrame:this.PositionGridSelectionFrame,setSelectionFrame:this.SetSelectionFrame};this._gridContext.portalManager?this._gridContext.portalManager.render(i.createElement(w.LocationEditor,s),this._pickerContainer):r.render(i.createElement(w.LocationEditor,s),this._pickerContainer);var u=this._pickerContainer.getElementsByTagName("input");u&&u.length&&(this._editorElement=u[0]);this._inEdit&&this.SetupHandlers(!0);if(null!=t&&null!=this._editorElement&&("keydown"==t.type||"keypress"==t.type)&&o.JsGridUtil.Utility.IsChar(t)){var a=String.fromCharCode(t.charCode);this._editorElement.value=a}};e.prototype.Init=function(){this._gridContext.RTL.bEnabled?this._direction=this._gridContext.RTL.rtl:this._direction=this._gridContext.RTL.ltr;this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane;pe||this.CreatePickerDiv(this._idPrefix)};e.prototype.CreatePickerDiv=function(e){this._pickerContainer=document.createElement("div");this._pickerContainer.id=e;this._pickerContainer.style.direction=this._direction;this._direction==this._gridContext.RTL.rtl?this._pickerContainer.style.right="-1px":this._pickerContainer.style.left="-1px";this._pickerContainer.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;border-width:0px";this._pickerContainer.className=o.JsGridUtil.Internal.IsFeatureEnabled(ke)?I.msGrid:"ms-grid";this._parentNode.appendChild(this._pickerContainer);if(pe){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickerContainer.classList.add(I.stickyEditor):this._pickerContainer.classList.remove(I.stickyEditor))}else;};e.prototype.Dispose=function(){};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return!1};e.prototype.BindToCell=function(e){this._cellContext=e;this._isBound=!0;this._gridPane.useCustomSelFrames=!1;if(pe)this.CreatePickerDiv(this._idPrefix);else{this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickerContainer.classList.add(I.stickyEditor):this._pickerContainer.classList.remove(I.stickyEditor))}};e.prototype.Unbind=function(){this._isBound=!1;this._gridPane.useCustomSelFrames=!1;if(pe){this._cellContext.Hide(this._pickerContainer);this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._pickerContainer):r.unmountComponentAtNode(this._pickerContainer)}else;};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._pickerContainer,!0);this.EnsureLocationPicker(t,e)};e.prototype.OnEndEdit=function(){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;if(!pe){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._pickerContainer):r.unmountComponentAtNode(this._pickerContainer);this._cellContext.Hide(this._pickerContainer)}};e.prototype.SetupHandlers=function(e){null!=this._pickerContainer&&(e?this._pickerContainer.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._pickerContainer.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.OnPickerInputBlur=function(e){this._inEdit||this._gridContext.OnDeactivateActor(e)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==s.JsGridConstants.Key.tab||t==s.JsGridConstants.Key.esc||t==s.JsGridConstants.Key.enter||t==s.JsGridConstants.Key.windows||t>=s.JsGridConstants.Key.left&&t<=s.JsGridConstants.Key.down};e.prototype.OnKeyDown=function(e){o.JsGridUtil.Internal.IsFeatureEnabled(Oe)||this._inEdit&&!this.IsSpecialNavKeys(e)||this.OnKeyDownInternal(e)};e.prototype.OnKeyDownInternal=function(e){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.OnValueChanged=function(e){if(this._isDirty){this.UpdateElementValue(this._editorElement,e);this._isDirty=!1}};e.prototype.SetSize=function(e,t){this._pickerContainer.style.minWidth=String(e-2)+"px";o.JsGridUtil.Internal.IsFeatureEnabled(Ce)||(this._pickerContainer.style.minHeight=String(t-2)+"px")};e.prototype.OnCellMove=function(){this._isBound&&this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.GetOriginalValue=function(){return null!=this._cellContext.originalValue.data?this.GetOriginalDataValue():this.GetOriginalLocValue()};e.prototype.GetOriginalDataValue=function(){var e=this._cellContext.originalValue.data;return this.BuildUnresolvedEntity(e.Address,e.DisplayName,e.Coordinates,e.LocationUri,e.EntityType)};e.prototype.GetOriginalLocValue=function(){var e=this._cellContext.originalValue.localized;return this.BuildUnresolvedEntity(null,e,null,null,null)};e.prototype.BuildUnresolvedEntity=function(e,t,n,r,i){return e||t||n||r||i?{Address:e,DisplayName:t,Coordinates:n,LocationUri:r,EntityType:i}:null};e.prototype.OnSingleLocationValue=function(e){var t={data:null,localized:""};e&&(t={data:{Address:e.Address,DisplayName:e.DisplayName,Coordinates:e.Coordinates,LocationUri:e.LocationUri,EntityType:e.EntityType},localized:e.DisplayName});return t};e.prototype.UpdateElementValue=function(e,t){o.JsGridUtil.DebugAssert(null!=e);e.value=t};return e})();t.LocationPickerEditControl=b;var E=(function(){function e(e,t){var n=this;this._idPrefix="taxonomyPickerDiv";this._isDirty=!1;this._inEdit=!1;this._isBound=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnEditorKeyDown=function(e){n._inEdit&&!n.IsSpecialNavKeys(e)||n.OnKeyDownInternal(e)};this.OnTermResolvedCallback=function(e){n._isDirty=!0;var t;if(Boolean(n._cellContext.field._multiValue)&&e.length>0){for(var r=[],i=[],s=0;s<e.length;s++){var u=n.OnSingleTermValue(e[s]);r.push(u.data);i.push(u.localized)}t={data:r,localized:o.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(i,S.TERM_DELIMITER,!1)}}else t=e.length>0?n.OnSingleTermValue(e[0]):{data:null,localized:""};void 0!==t&&null!=t&&n._cellContext.SetCurrentValue(t)};this.PositionGridSelectionFrame=function(e){n._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,n._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){n._gridPane.SetSelectionFrameOnNonTdElement(e,n._cellContext.GetCurrentRect())};this._gridContext=e;this._customFieldInfo=t;this._parentNode=e.parentNode;this.Init()}e.prototype.EnsureTaxonomyPicker=function(e,t){var n={onEditorKeyDown:o.JsGridUtil.Internal.IsFeatureEnabled(Oe)?this.OnEditorKeyDown:this.OnKeyDown.bind(this),onEditorMouseDown:this.OnMouseDown.bind(this),positionGridSelectionFrame:this.PositionGridSelectionFrame,dataSource:this._gridContext.taxonomyPickerDataSource,pageContext:this._gridContext.pageContext,selectedTerms:e,onItemsChange:this.OnTermResolvedCallback,onBlur:this.OnPickerInputBlur.bind(this),schema:this._customFieldInfo[this._cellContext.fieldKey],setSelectionFrame:this.SetSelectionFrame};this._gridContext.portalManager?this._gridContext.portalManager.render(i.createElement(x.TaxonomyEditor,n),this._pickerContainer):r.render(i.createElement(x.TaxonomyEditor,n),this._pickerContainer);var s=this._pickerContainer.getElementsByTagName("input");s&&s.length&&(this._editorElement=s[0]);this._inEdit&&this.SetupHandlers(!0);if(null!=t&&null!=this._editorElement&&("keydown"==t.type||"keypress"==t.type)&&o.JsGridUtil.Utility.IsChar(t)){var u=String.fromCharCode(t.charCode);this._editorElement.value=u}};e.prototype.Init=function(){this._gridContext.RTL.bEnabled?this._direction=this._gridContext.RTL.rtl:this._direction=this._gridContext.RTL.ltr;this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane;de||this.CreatePickerDiv(this._idPrefix)};e.prototype.CreatePickerDiv=function(e){this._pickerContainer=document.createElement("div");this._pickerContainer.id=e;this._pickerContainer.style.direction=this._direction;this._direction==this._gridContext.RTL.rtl?this._pickerContainer.style.right="-1px":this._pickerContainer.style.left="-1px";this._pickerContainer.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;border-width:0px";this._pickerContainer.className=o.JsGridUtil.Internal.IsFeatureEnabled(ke)?I.msGrid:"ms-grid";if(de){this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickerContainer.classList.add(I.stickyEditor):this._pickerContainer.classList.remove(I.stickyEditor))}else;this._parentNode.appendChild(this._pickerContainer)};e.prototype.Dispose=function(){};e.prototype.IsCurrentlyUsingGridTextInputElement=function(){return!1};e.prototype.BindToCell=function(e){this._cellContext=e;this._isBound=!0;this._gridPane.useCustomSelFrames=!1;if(le)this.CreatePickerDiv(this._idPrefix);else{this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._pickerContainer.classList.add(I.stickyEditor):this._pickerContainer.classList.remove(I.stickyEditor))}};e.prototype.Unbind=function(){this._isBound=!1;this._gridPane.useCustomSelFrames=!1;if(de){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._pickerContainer):r.unmountComponentAtNode(this._pickerContainer);this._cellContext.Hide(this._pickerContainer)}!K&&de&&this._parentNode.removeChild(this._pickerContainer)};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._pickerContainer,!0);this.EnsureTaxonomyPicker(t,e)};e.prototype.OnEndEdit=function(){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;if(!le){this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._pickerContainer):r.unmountComponentAtNode(this._pickerContainer);this._cellContext.Hide(this._pickerContainer)}};e.prototype.SetupHandlers=function(e){null!=this._pickerContainer&&(e?this._pickerContainer.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._pickerContainer.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.OnPickerInputBlur=function(e){this._inEdit||this._gridContext.OnDeactivateActor(e)};e.prototype.IsSpecialNavKeys=function(e){var t=e.keyCode;return t==s.JsGridConstants.Key.tab||t==s.JsGridConstants.Key.esc||t==s.JsGridConstants.Key.enter||t==s.JsGridConstants.Key.windows||t>=s.JsGridConstants.Key.left&&t<=s.JsGridConstants.Key.down};e.prototype.OnKeyDown=function(e){o.JsGridUtil.Internal.IsFeatureEnabled(Oe)||this._inEdit&&!this.IsSpecialNavKeys(e)||this.OnKeyDownInternal(e)};e.prototype.OnKeyDownInternal=function(e){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.OnValueChanged=function(e){if(this._isDirty){this.UpdateElementValue(this._editorElement,e);this._isDirty=!1}};e.prototype.SetSize=function(e,t){this._pickerContainer.style.minWidth=String(e-2)+"px";o.JsGridUtil.Internal.IsFeatureEnabled(Ce)||(this._pickerContainer.style.minHeight=String(t-2)+"px")};e.prototype.OnCellMove=function(){this._isBound&&this.SetSize(this._cellContext.cellWidth,this._cellContext.cellHeight)};e.prototype.GetOriginalValue=function(){return null!=this._cellContext.originalValue.data?this.GetOriginalDataValue():this.GetOriginalLocValue()};e.prototype.GetOriginalDataValue=function(){var e=[],t=this._cellContext.originalValue.data;if(""!==t)if(Array.isArray(t))for(var n=0;n<t.length;n++)e.push(this.BuildUnresolvedEntity(t[n].TermID,t[n].Label));else e.push(this.BuildUnresolvedEntity(t.TermID,t.Label));return e};e.prototype.GetOriginalLocValue=function(){var e=[],t=this._cellContext.originalValue.localized;if(null!=t&&""!==t)for(var n=t.split(S.TERM_DELIMITER),r=0;r<n.length;r++)if(""!==n[r]){var i=n[r].split(S.LABEL_ID_DELIMITER);e.push(this.BuildUnresolvedEntity(i[1],i[0]))}return e};e.prototype.BuildUnresolvedEntity=function(e,t){var n=e!==S.INVALID_TERM_ID;return{term:{termId:e,label:t,isValid:n},isSynonym:!1,completions:[],start:"",state:n?1:2}};e.prototype.OnSingleTermValue=function(e){var t={data:null,localized:""};e&&(t={data:{Label:e.term.label,TermID:e.term.termId},localized:e.term.label+S.LABEL_ID_DELIMITER+e.term.termId});return t};e.prototype.UpdateElementValue=function(e,t){o.JsGridUtil.DebugAssert(null!=e);e.value=t};return e})();t.TaxonomyPickerEditControl=E;t.GetHyperlinkEditControl=function(e,n){var r=new t.EditBoxEditControl(e,n);r.SetValue=function(e){var t=r.GetInputElement(),n=r.GetCellContext(),i=null!=n.originalValue.data?n.originalValue.data.display:null,s=null!=n.originalValue.data?n.originalValue.data.address:null,o=null==i||""==i||i==s?t.value:i,u={address:t.value,display:o};n.SetCurrentValue({data:u})};r.GetOriginalValue=function(){var e=r.GetCellContext();return null!=e.originalValue.data?e.originalValue.data.address:null};r.OnValueChanged=function(e){r.GetInputElement().value=null==e.data||null==e.data.address||e.data==o.JsGridUtil.EmptyValue||e.data.address==o.JsGridUtil.EmptyValue?"":e.data.address};return r};var T=(function(){function e(e){var t=this;this.id="jsgrid_hyperlink";this._isDirty=!1;this._isBound=!1;this._inEdit=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus()};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.SetSelectionFrame=function(e){t._gridPane.SetSelectionFrameOnNonTdElement(e,t._cellContext.GetCurrentRect())};this.OnValueChanged=function(e){if(t._isDirty){t.UpdateElementValue(t._editorelm,e);t._isDirty=!1}};this.OnOK=function(e){t._cellContext.NotifyEditComplete();ce&&t._cellContext.NotifyEditComplete()};this.OnCancel=function(){t._cellContext.NotifyEditComplete(!0);ce&&t._cellContext.NotifyEditComplete(!0)};this.OnKeyDownInternal=function(e){if(e.keyCode==s.JsGridConstants.Key.enter||e.keyCode==s.JsGridConstants.Key.esc){t._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;t._gridContext.OnKeyDown(e)}};this.OnValueChangedInternal=function(e){if(e){var n=t.GetOriginalValue(),r=n.display,i=n.address,s=e.display,o=e.address;s!=r||null!=r&&""!=r&&r!=i||(s=o);t._cellContext.SetCurrentValue({data:{address:o,display:s}});t._isDirty=!0}};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.classList.add(R.msGridEditControlContainer);this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){this._isBound=!0;this._cellContext=e};e.prototype.Unbind=function(){if(this._isBound){this._cellContext.Hide(this._container);this._isDirty=!1;if(ce){this.OnEndEdit();this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):r.unmountComponentAtNode(this._container)}else;}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){var t=this.GetOriginalValue();this._inEdit=!0;this._cellContext.Show(this._container);ce||"keydown"!=e.type&&"keypress"!=e.type||e.keyCode===s.JsGridConstants.Key.F2||!o.JsGridUtil.Utility.IsChar(e)||(t.address=String.fromCharCode(e.charCode));this.RenderData(t)};e.prototype.OnCellMove=function(e){};e.prototype.OnEndEdit=function(){if(ce){if(this._isBound&&this._isDirty){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;this._cellContext.NotifyEditComplete()}}else{this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;this._cellContext.Hide(this._container);this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):r.unmountComponentAtNode(this._container)}};e.prototype.RenderData=function(e){var t=!ee&&o.JsGridUtil.Internal.getCalloutBoundsBelowStickyHeader(this._parentNode.id),n=o.JsGridUtil._uniqueGridIdKillSwitchIsActive?o.JsGridUtil.privateWpq:this._gridContext.gridId,u={target:this._cellContext.GetCurrentTd(),onSave:this.OnOK,onCancel:this.OnCancel,styles:{container:{zIndex:s.JsGridConstants.Internal.zIndex.expandableEditorsZIndex}},bounds:t,lightDismissElementsFilter:["spgridcontainer_"+n,s.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout],calloutId:s.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout},a={onEditorMouseDown:this.OnMouseDown.bind(this),onEditorKeyDown:ce?this.OnKeyDown.bind(this):this.OnKeyDownInternal,onValueChange:this.OnValueChangedInternal,currentUrlValue:e.address,currentDisplayValue:e.display,calloutProps:u};o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(I.stickyEditor):this._container.classList.remove(I.stickyEditor));this._gridContext.portalManager?this._gridContext.portalManager.render(i.createElement(p.HyperlinkEditor,a),this._container):r.render(i.createElement(p.HyperlinkEditor,a),this._container);this._inEdit&&this.SetupHandlers(!0);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(I.stickyEditor):this._container.classList.remove(I.stickyEditor));this._container.focus()};e.prototype.OnKeyDown=function(e){if(ce){if(e.keyCode==s.JsGridConstants.Key.enter||e.keyCode==s.JsGridConstants.Key.esc){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)}}else;};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.UpdateElementValue=function(e,t){o.JsGridUtil.DebugAssert(null!=e);e.value=t};e.prototype.SetupHandlers=function(e){null!=this._container&&(e?this._container.addEventListener("mousedown",this.OnMouseDown.bind(this)):this._container.removeEventListener("mousedown",this.OnMouseDown.bind(this)))};e.prototype.GetOriginalValue=function(){var e,t,n=this._cellContext.originalValue.data;if(null!=n){e=n.address;t=n.display}return{address:e,display:t}};return e})();t.HyperlinkEditControlV2=T;var N=(function(){function e(e){var t=this;this.id="jsgrid_number";this._inEdit=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnSave=function(e){t._cellContext.NotifyEditComplete()};this.OnKeyDownInternal=function(e){e.keyCode!=s.JsGridConstants.Key.enter&&e.keyCode!=s.JsGridConstants.Key.esc&&e.keyCode!=s.JsGridConstants.Key.tab||t._gridContext.OnKeyDown(e)};this.OnMouseDown=function(e){e.stopPropagation()};this.OnValueChangedInternal=function(e){if(e){t._cellContext.SetCurrentValue({localized:e});t._value=e}};this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.classList.add(R.msGridEditControlContainer);this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){this._cellContext=e;o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(I.stickyEditor):this._container.classList.remove(I.stickyEditor))};e.prototype.Unbind=function(e){this._gridPane.useCustomSelFrames=!1};e.prototype.OnBeginEdit=function(e){this._value=this.GetOriginalValue()||"";this._value=this._value.replace(/%/g,"");this._inEdit=!0;this._cellContext.Show(this._container);e&&o.JsGridUtil.Utility.IsChar(e)&&this.OnValueChangedInternal(String.fromCharCode(e.charCode));this.RenderData(this._value)};e.prototype.OnCellMove=function(e){this._inEdit&&this.RenderData(this._value)};e.prototype.OnEndEdit=function(e){this._inEdit=!1;this.SetupHandlers(!1);this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):r.unmountComponentAtNode(this._container);this._cellContext.Hide(this._container);this._value=""};e.prototype.RenderData=function(e){var t=0,n=0;if(o.JsGridUtil.Internal.IsFeatureEnabled(ke)){n=this._cellContext.cellWidth-3;t=this._cellContext.cellHeight-5}else{n=this._cellContext.cellWidth-10;t=this._cellContext.cellHeight-6}var s=this._gridContext.jsGridObj.GetSpCsrRenderCtx(),u=o.JsGridUtil.Internal.IsFeatureEnabled(ke)?I.spGridControlEditbox+" "+(s.fixedHeightRowEnabled?"":I.spGridControlEditboxDynamicHeight):"jsgrid-control-editbox";this._cellContext.field.csrInfo.CustomFormatter||(u+=" "+I.inputIsNumber);var a=this._cellContext.field&&this._cellContext.field.csrInfo,f=a&&a.Unit||"None",l=a&&a.CustomUnitName||"",c=!a||!a.CustomUnitOnRight||"TRUE"===a.CustomUnitOnRight,h={onValueChange:this.OnValueChangedInternal,onSave:this.OnSave,currentValue:e,unit:f,customUnitName:l,customUnitOnRight:c,width:n,height:t,className:u};this._gridContext.portalManager?this._gridContext.portalManager.render(i.createElement(d.NumberEditor,h),this._container):r.render(i.createElement(d.NumberEditor,h),this._container);this._inEdit&&this.SetupHandlers(!0)};e.prototype.SetupHandlers=function(e){if(null!=this._container)if(e){this._container.addEventListener("keydown",this.OnKeyDownInternal);this._container.addEventListener("mousedown",this.OnMouseDown)}else{this._container.removeEventListener("keydown",this.OnKeyDownInternal);this._container.removeEventListener("mousedown",this.OnMouseDown)}};e.prototype.GetOriginalValue=function(){return this._cellContext.originalValue.localized};return e})();t.NumberEditControl=N;var C=(function(){function e(e){var t=this;this.id="jsgrid_date";this._isDirty=!1;this._isBound=!1;this._inEdit=!1;this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this.OnMenuDismissed=function(){t._gridPane._objBag.focusMgr.Focus()};this.PositionGridSelectionFrame=function(e){t._gridPane.PositionGridSelectionFrameAroundNonstandardElement(e,t._cellContext.GetCurrentRect())};this.OnValueChanged=function(e){if(t._isDirty){t.UpdateElementValue(t._editorelm,e);t._isDirty=!1}};this.OnCatchCalendarKeyUp=function(e){e.keyCode===s.JsGridConstants.Key.esc&&t.OnKeyDownInternal(e)};this.OnValueChangedInternal=function(e){var n;t._isDirty=!0;var r=null===(n=t._pageContext)||void 0===n?void 0:n.currentCultureName;if(e){var i=o.JsGridUtil._gridutilPageContextKillswitchIsActive?_spPageContextInfo.currentCultureName:r;if(t._cellContext.field.dateOnly){var s=A.formatDateString(i,e);t._cellContext.SetCurrentValue({data:e,localized:s});t._cellContext.NotifyEditComplete();if(fe){t._cellContext.NotifyEditComplete();t._cellContext.Hide(t._container)}else;}else{s=A.formatDateString(i,e);var u=e.toLocaleTimeString(i,{hour:"2-digit",minute:"2-digit",hour12:!!o.JsGridUtil._specify24HourFormatInDateTimeKillswitchIsActive&&void 0});o.JsGridUtil._specify24HourFormatInDateTimeKillswitchIsActive||"24:00"===u&&(u="00:00");o.JsGridUtil._fixTimeFormatsKillswitchIsActive||(u=u.split(".").join(":"));var a=s+" "+u;t._cellContext.SetCurrentValue({data:e,localized:a})}}};this.OnInputValueChangedInternal=function(e){t._isDirty=!0;null!=e&&t._cellContext.SetCurrentValue({localized:e})};this.OnOK=function(e){M.Engagement.logData({name:"QuickEdit.CalendarType.Gregorian"});t._cellContext.NotifyEditComplete();if(fe){t._cellContext.NotifyEditComplete();t._cellContext.Hide(t._container)}else;};this.OnCancel=function(){t._cellContext.NotifyEditComplete(!0);if(fe){t._cellContext.NotifyEditComplete(!0);t._cellContext.Hide(t._container)}else;};this._gridContext=e;o.JsGridUtil._usePerInstancePageContextKillSwitchIsActive?this._pageContext=o.JsGridUtil.PageContext:this._pageContext=this._gridContext.pageContext;this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._container=document.createElement("div");this._container.id=this.id;this._container.classList.add(R.msGridEditControlContainer);this._gridContext.RTL.bEnabled?this._container.style.right="0px":this._container.style.left="0px";this._container.style.direction=this._gridContext.RTL.ltr;this._parentNode.appendChild(this._container);this._gridPane=this._gridContext.jsGridObj.objBag.paneMgr.gridPane};e.prototype.Dispose=function(){this._parentNode.removeChild(this._container)};e.prototype.BindToCell=function(e){this._isBound=!0;this._cellContext=e};e.prototype.Unbind=function(){if(this._isBound){this._cellContext.Hide(this._container);this._isDirty=!1;if(fe){this.OnEndEdit();this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):r.unmountComponentAtNode(this._container)}else;}this._gridPane.useCustomSelFrames=!1;this._isBound=!1};e.prototype.OnBeginEdit=function(e){var t=this.GetDateValue(),n="";this._inEdit=!0;this._cellContext.Show(this._container);"keydown"!=e.type&&"keypress"!=e.type||e.keyCode===s.JsGridConstants.Key.F2||!o.JsGridUtil.Utility.IsChar(e)||(n=String.fromCharCode(e.charCode));this.RenderData(t,n)};e.prototype.OnCellMove=function(e){};e.prototype.GetOriginalValue=function(){return this._cellContext.originalValue.localized};e.prototype.OnEndEdit=function(){if(fe){if(this._isBound&&this._isDirty){this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;this._cellContext.NotifyEditComplete()}}else{this._inEdit=!1;this.SetupHandlers(!1);this._isDirty=!1;this._cellContext.Hide(this._container);this._gridContext.portalManager?this._gridContext.portalManager.unmount(this._container):r.unmountComponentAtNode(this._container)}};e.prototype.RenderData=function(e,t){var n,u,a,f,l=this._cellContext.field.dateOnly,c=!ee&&o.JsGridUtil.Internal.getCalloutBoundsBelowStickyHeader(this._parentNode.id),h=o.JsGridUtil._uniqueGridIdKillSwitchIsActive?o.JsGridUtil.privateWpq:this._gridContext.gridId,p={target:this._cellContext.GetCurrentTd(),onSave:this.OnOK,styles:{container:{zIndex:s.JsGridConstants.Internal.zIndex.expandableEditorsZIndex}},bounds:c,lightDismissElementsFilter:["spgridcontainer_"+h,s.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout],calloutId:s.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout};l||(p.onCancel=this.OnCancel);var d,m=null===(u=null===(n=this._pageContext)||void 0===n?void 0:n.webTimeZoneData)||void 0===u?void 0:u.Id,g=o.JsGridUtil._gridutilPageContextKillswitchIsActive?null===(a=_spPageContextInfo.webTimeZoneData)||void 0===a?void 0:a.Id:m,y=e?new Date(e):void 0;if(y&&!isNaN(g)){var b=_.getIANATzNameFromSPTzID(g);y=_.maskServerTimeAsLocalTime(y,b)}if(y&&!l){var w=y.getHours(),E=y.getMinutes();d=this.formatTime(w)+":"+this.formatTime(E)}var S=null===(f=this._pageContext)||void 0===f?void 0:f.currentCultureName,x=o.JsGridUtil._gridutilPageContextKillswitchIsActive?_spPageContextInfo.currentCultureName:S,T={onInputKeyDown:this.OnInputKeyDown.bind(this),onValueChange:this.OnValueChangedInternal,onInputValueChange:this.OnInputValueChangedInternal,onCalendarKeyUp:!fe&&this.OnCatchCalendarKeyUp,date:y,time:l?void 0:d,dateTime:t||this.GetOriginalValue(),inputProps:{height:this._cellContext.cellHeight,width:this._cellContext.cellWidth},currentCultureName:x,dateOnly:this._cellContext.field.dateOnly,is24HourFormat:!!o.JsGridUtil.SpRegionalSettings.time24,calloutProps:p};o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(I.stickyEditor):this._container.classList.remove(I.stickyEditor));this._gridContext.portalManager?this._gridContext.portalManager.render(i.createElement(v.DateEditor,T),this._container):r.render(i.createElement(v.DateEditor,T),this._container);this._inEdit&&this.SetupHandlers(!0);o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._container.classList.add(I.stickyEditor):this._container.classList.remove(I.stickyEditor));this._container.focus()};e.prototype.OnKeyDownInternal=function(e){this._gridContext.bLightFocus=!0;e.StopInfiniteKeyDownLoop=!0;this._gridContext.OnKeyDown(e)};e.prototype.OnKeyDown=function(e){e.keyCode==s.JsGridConstants.Key.esc&&this.OnKeyDownInternal(e)};e.prototype.OnInputKeyDown=function(e){e.keyCode!==s.JsGridConstants.Key.enter&&e.keyCode!==s.JsGridConstants.Key.esc||this.OnKeyDownInternal(e);e.stopPropagation()};e.prototype.OnMouseDown=function(e){e.stopPropagation()};e.prototype.UpdateElementValue=function(e,t){o.JsGridUtil.DebugAssert(null!=e);e.value=t};e.prototype.SetupHandlers=function(e){if(null!=this._container)if(e){this._container.addEventListener("mousedown",this.OnMouseDown.bind(this));fe&&this._container.addEventListener("keydown",this.OnKeyDown.bind(this))}else{this._container.removeEventListener("mousedown",this.OnMouseDown.bind(this));fe&&this._container.removeEventListener("keydown",this.OnKeyDown.bind(this))}};e.prototype.GetDateValue=function(){var e=this._cellContext.fieldKey;if(this._cellContext.record&&this._cellContext.record.fieldRawDataMap&&this._cellContext.record.fieldRawDataMap.csrInfo)return this._cellContext.record.fieldRawDataMap.csrInfo[e+"."]};e.prototype.formatTime=function(e){return e<10?"0"+e.toString():e.toString()};return e})();t.DateEditControl=C})(t.EditControl||(t.EditControl={}));t.EditControlType={EditBox:"EDIT_EDITBOX",ComboBox:"EDIT_COMBOBOX",Checkbox:"EDIT_CHECKBOX",Hyperlink:"EDIT_HYPERLINK",PeoplePicker:"EDIT_PEOPLEPICKER",LocationPicker:"EDIT_LOCATIONPICKER",DatePicker:"EDIT_DATEPICKER",BooleanComboBox:"EDIT_BOOLEANCOMBOBOX",NumberBox:"EDIT_NUMBERBOX"};(function(e){var t=(function(){function e(e,t){this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.Either;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.Both;this.id=s.JsGridConstants.ErrorWidgetId;this._gridContext=e;this._errorMgr=t;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){this._gridContext.bLightFocus=!0;var e=o.JsGridUtil.Internal.IsFeatureEnabled(ke),t=e?s.JsGridConstants.Internal.zIndex.editor:1;o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(t+=s.JsGridConstants.Internal.zIndex.stickyZIndex);var n=this.id+"_mainDiv",r=this.id+"_focuselem",i=this.id+"_errorSpan";this.mainDiv=document.createElement("div");this.mainDiv.id=n;e&&!se?this.mainDiv.classList.add(R.errorWidgetContainer):this.mainDiv.style.cssText=["z-index:"+t+";","visibility: hidden;","font-size: 10;","position: absolute;","top: 0px;","left: 0px;","background-color: #FFE0E0;","border: 1px solid #DD3300;","padding: 5px 10px;","color: #333333!important;"].join("");this._parentNode.appendChild(this.mainDiv);this.focusElement=document.createElement("input");this.focusElement.id=r;this.focusElement.style.cssText="position:fixed;top:0px;left:-10px;height:0px;width:0px;display:none";this.focusElement.setAttribute("role","presentation");this.mainDiv.appendChild(this.focusElement);this.errorSpan=document.createElement("span");this.errorSpan.id=i;this.mainDiv.appendChild(this.errorSpan)};e.prototype.Dispose=function(){o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&!ye?this._parentNode=this.mainDiv=this._currentTd=this.focusElement=this.errorSpan=null:this._parentNode.removeChild(this.mainDiv)};e.prototype.BindToCell=function(e){this._cellContext=e;this.mainDiv.addEventListener("keydown",this._gridContext.OnKeyDown)};e.prototype.Unbind=function(){o.JsGridUtil.ClearEventListeners(this.mainDiv)};e.prototype.GetIcon=function(){return new o.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Error",className:I.spGridErrorIcon}}).Render(SP.JsGrid.Res.openErrorWidget)};e.prototype.Collapse=function(){ie||this.errorSpan.removeAttribute("role");o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&!se?this.mainDiv.classList.remove(R.widgetExpanded):this.mainDiv.style.visibility="hidden";o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&!o.JsGridUtil._errorWidgetInstantOpenKillSwitchIsActive||this._cellContext.NotifyCollapseWidget();o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&!ye&&this._currentTd&&(this._currentTd.style.zIndex="")};e.prototype.Expand=function(){var e,t,n;o.JsGridUtil.Internal.DomElement.GetInstance().SetText(this.errorSpan,this._errorMgr.GetMessageForCell(this._cellContext.record.key(),this._cellContext.fieldKey));if(o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&!ye){this._currentTd=this._cellContext.GetCurrentTd();if(n=-1!==(null===(t=null===(e=this._currentTd)||void 0===e?void 0:e.className)||void 0===t?void 0:t.indexOf("gridSticky"))){this.mainDiv.classList.add(R.stickyZIndex);this._currentTd.style.zIndex=(s.JsGridConstants.Internal.zIndex.stickyZIndex+s.JsGridConstants.Internal.zIndex.editor).toString();this._currentTd.appendChild(this.mainDiv);this._isStickyError=!0}else{this.mainDiv.classList.remove(R.stickyZIndex);if(this._isStickyError){this._parentNode.appendChild(this.mainDiv);this._isStickyError=!1}}}this._widgetHeight=this.mainDiv.offsetHeight;var r=this.mainDiv.offsetWidth,i=this._cellContext.cellRect,u=this._cellContext.cellExpandSpace;u.bottom>this._widgetHeight||u.top<this._widgetHeight?this.mainDiv.style.top=n&&!ye?i.height+4+"px":i.y+i.height+4+"px":this.mainDiv.style.top=n&&!ye?-(this._widgetHeight+4)+"px":i.y-this._widgetHeight-4+"px";var a=this._gridContext.RTL.bEnabled;if(oe)this.mainDiv.style.left=i.x-(a?r-i.width:2)+"px";else if(a){if(n&&!ye){this.mainDiv.style.left="";this.mainDiv.style.right="0px"}else this.mainDiv.style.left=i.x-(r-i.width)+"px";if(this.mainDiv.getBoundingClientRect().left<0)if(n){this.mainDiv.style.left="0px";this.mainDiv.style.right=""}else this.mainDiv.style.left=i.x+"px"}else{this.mainDiv.style.left=n?"0px":i.x+"px";if(this.mainDiv.getBoundingClientRect().right>(window.innerWidth||document.documentElement.clientWidth))if(n){this.mainDiv.style.left="";this.mainDiv.style.right="0px"}else this.mainDiv.style.left=i.x-(r-i.width)+"px"}this._cellContext.NotifyExpandWidget();o.JsGridUtil.Internal.IsFeatureEnabled(ke)&&!se?this.mainDiv.classList.add(R.widgetExpanded):this.mainDiv.style.visibility="";ie||this.errorSpan.setAttribute("role","alert");this.focusElement.focus()};e.prototype.OnValueChanged=function(e){};return e})();e.ErrorWidget=t;var n=(function(){function e(e,t){this._id=s.JsGridConstants.ReadOnlyWidgetId;if(null!=e){this._id+=e.id;this._parentNode=e}this._isRTL=t;this.Init()}e.prototype.Init=function(){var e=this._id+"_mainDiv",t=this._id+"_readOnlySpan";this._mainDiv=document.createElement("div");this._mainDiv.id=e;this._mainDiv.classList.add(R.readOnlyWidgetContainer);this._parentNode.appendChild(this._mainDiv);this._readOnlySpan=document.createElement("span");this._readOnlySpan.id=t;this._mainDiv.appendChild(this._readOnlySpan);o.JsGridUtil.Internal.DomElement.GetInstance().SetText(this._readOnlySpan,F.default.readOnlyWidget)};e.prototype.Dispose=function(){this._parentNode=this._mainDiv=this._currentTd=this._readOnlySpan=null};e.prototype.Collapse=function(){this._mainDiv.classList.remove(R.widgetExpanded);this._currentTd&&(this._currentTd.style.zIndex="")};e.prototype.Expand=function(e){var t,n;if(!this._widgetHeight||!this._widgetWidth){this._widgetHeight=this._mainDiv.offsetHeight;this._widgetWidth=this._mainDiv.offsetWidth}var r=e.cellRect,i=e.cellExpandSpace,o=e.cellTd;this._currentTd=o;var u=-1!==(null===(n=null===(t=this._currentTd)||void 0===t?void 0:t.className)||void 0===n?void 0:n.indexOf("gridSticky"));if(u){this._mainDiv.classList.add(R.stickyZIndex);this._currentTd.style.zIndex=(s.JsGridConstants.Internal.zIndex.stickyZIndex+s.JsGridConstants.Internal.zIndex.editor).toString();this._currentTd.appendChild(this._mainDiv);this._isStickyReadOnly=!0}else{this._mainDiv.classList.remove(R.stickyZIndex);if(this._isStickyReadOnly){this._parentNode.appendChild(this._mainDiv);this._isStickyReadOnly=!1}}i.bottom>this._widgetHeight||i.top<this._widgetHeight?this._mainDiv.style.top=u?r.height+2+"px":r.y+r.height+2+"px":this._mainDiv.style.top=u?-(this._widgetHeight+2)+"px":r.y-this._widgetHeight-2+"px";if(this._isRTL){if(u){this._mainDiv.style.left="";this._mainDiv.style.right="0px"}else this._mainDiv.style.left=r.x-(this._widgetWidth-r.width)+"px";if(this._mainDiv.getBoundingClientRect().left<0)if(u){this._mainDiv.style.left="0px";this._mainDiv.style.right=""}else this._mainDiv.style.left=r.x+"px"}else{this._mainDiv.style.left=u?"0px":r.x+"px";if(this._mainDiv.getBoundingClientRect().right>(window.innerWidth||document.documentElement.clientWidth))if(u){this._mainDiv.style.left="";this._mainDiv.style.right="0px"}else this._mainDiv.style.left=r.x-(this._widgetWidth-r.width)+"px"}this._mainDiv.classList.add(R.widgetExpanded)};return e})();e.ReadOnlyWidget=n;var r=(function(){function e(e){this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.LocalizedOnly;this._widgetHeight=200;this.strDatePickerImageID="DatePickerImage";this.strDatePickerFrameID="DatePickerFrame";this._gridContext=e;this._parentNode=e.parentNode;this.Init()}e.prototype.ClickDatePickerFn=function(e,t,n,r){clickDatePicker(e,t,n);r()};e.prototype.Init=function(){var e=o.JsGridUtil.Internal.IsFeatureEnabled(ke);this._box=document.createElement("input");this._box.id="datewidgetinput-"+this._parentNode.id;this._box.style.cssText="display:none;position:absolute;top:0px;left:0px";this._box.onvaluesetfrompicker=this.OnValueSetHandler.bind(this);this._box.tabIndex=-1;this._parentNode.appendChild(this._box);this._anchor=document.createElement("div");this._anchor.id=this._box.id+this.strDatePickerImageID;this._anchor.style.cssText="position:absolute;background:transparent;visibility:hidden;height:0px;z-index:-1";this._parentNode.appendChild(this._anchor);this._iframe=document.createElement("iframe");this._iframe.id=this._box.id+this.strDatePickerFrameID;this._iframe.src=o.JsGridUtil.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+"blank.gif";this._iframe.frameBorder="0";this._iframe.scrolling="no";this._iframe.title=SP.JsGrid.Res.calendarTitle;var t=s.JsGridConstants.Internal.zIndex.editor;o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(t+=s.JsGridConstants.Internal.zIndex.stickyZIndex);this._iframe.style.cssText="display: none; position: absolute; width: 220px; z-index: "+(e?t:1)+" ";this._iframe.tabIndex=-1;this._parentNode.appendChild(this._iframe);null==window.g_strDateTimeControlIDs&&(window.g_strDateTimeControlIDs=[]);window.g_strDateTimeControlIDs.JsGridDatePicker=this._box.id};e.prototype.Dispose=function(){this._box.onvaluesetfrompicker=null;this._parentNode.removeChild(this._box);this._parentNode.removeChild(this._anchor);this._parentNode.removeChild(this._iframe)};e.prototype.BindToCell=function(e){this._cellContext=e;this._curValue=this._cellContext.originalValue.localized==o.JsGridUtil.EmptyValue?"":this._cellContext.originalValue.localized};e.prototype.Unbind=function(){this._curValue=null};e.prototype.Expand=function(){var e=this,t=this._cellContext.cellRect;M.Engagement.logData({name:"QuickEdit.CalendarType."+(1===o.JsGridUtil.SpRegionalSettings.calendarType?"Gregorian":"NonGregorian")});o.JsGridUtil.DebugAssert(null!=t);if(null!=t){this._anchor.style.width=t.width+"px";this._anchor.style.top=(this._cellContext.cellExpandSpace.bottom>this._widgetHeight||this._cellContext.cellExpandSpace.top<this._widgetHeight?t.y+t.height+3:t.y-this._widgetHeight-3)+"px";this._anchor.style.left=t.x-(this._gridContext.RTL.bEnabled?this._anchor.offsetWidth-t.width:2)+"px";this._anchor.style.visibility="";this._box.value=null!=this._curValue?this._curValue:"";o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._anchor.classList.add(I.stickyEditor):this._anchor.classList.remove(I.stickyEditor));this._cellContext.NotifyExpandWidget();this.ClickDatePickerFn(this._box.id,this.GetDatePickerQueryString(),this._box.value,function(){var n=e._iframe.resultfunc;e._iframe.resultfunc=function(t){null==t&&e._cellContext.NotifyEditComplete(!0);e.Collapse();n(t)};J||(e._iframe.onloadcallback=function(){o.JsGridUtil.Internal.positionWidget(e._iframe,t,e._gridContext.RTL.bEnabled)})})}};e.prototype.GetIcon=function(){return new o.JsGridUtil.ImageWithFabricIcons({iconProps:{iconName:"Calendar"}}).Render(SP.JsGrid.Res.openCalendar)};e.prototype.Collapse=function(){var e=this;o.JsGridUtil.Internal.GetVisible(this._iframe)?this.ClickDatePickerFn(this._box.id,this.GetDatePickerQueryString(),this._box.value,function(){e._cellContext.NotifyCollapseWidget()}):this._cellContext.NotifyCollapseWidget()};e.prototype.OnValueChanged=function(e){this._curValue=e.localized};e.prototype.OnValueSetHandler=function(){this._cellContext.SetCurrentValue({localized:this._box.value});this._cellContext.NotifyEditComplete()};e.prototype.GetDatePickerQueryString=function(){var e,t=o.JsGridUtil.PageContext.currentLanguage;o.JsGridUtil._usePerInstancePageContextKillSwitchIsActive||(t=null===(e=this._gridContext.pageContext)||void 0===e?void 0:e.currentLanguage);var n=o.JsGridUtil._gridutilPageContextKillswitchIsActive?_spPageContextInfo.currentLanguage:t;return[o.JsGridUtil.Internal.SiteUrl+"/_layouts/iframe.aspx?","&cal=",o.JsGridUtil.SpRegionalSettings.calendarType,"&lcid=",o.JsGridUtil.SpRegionalSettings.localeId,"&langid=",n,"&tz=",o.JsGridUtil.SpRegionalSettings.timeZone,"&time24=",o.JsGridUtil.SpRegionalSettings.time24?"true":"false","&ww=",o.JsGridUtil.SpRegionalSettings.workDays,"&fdow=",o.JsGridUtil.SpRegionalSettings.firstDayOfWeek,"&fwoy=",o.JsGridUtil.SpRegionalSettings.firstWeekOfYear,"&hj=",o.JsGridUtil.SpRegionalSettings.adjustHijriDays,"&swn=",o.JsGridUtil.SpRegionalSettings.showWeeks?"true":"false","&minjday=109207","&maxjday=2666269","&dateonly=",this._cellContext.field.dateOnly?"true":"false","&date="].join("")};return e})();e.DateWidget=r;var i=(function(){function e(e){this.SupportedWriteMode=s.JsGridConstants.EditActorWriteType.Either;this.SupportedReadMode=s.JsGridConstants.EditActorReadType.Both;this.id="HyperlinkWidgetControl";this._gridContext=e;null!=e.parentNode&&(this.id+=e.parentNode.id);this._parentNode=e.parentNode;this.Init()}e.prototype.Init=function(){var e=o.JsGridUtil.Internal.IsFeatureEnabled(ke);this._mainDiv=document.createElement("div");this._mainDiv.id="mainDiv";this._mainDiv.className=z?"jsgrid-widget-hyperlink":"jsgrid-widget-hyperlink-quickedit";var t=s.JsGridConstants.Internal.zIndex.editor;o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(t+=s.JsGridConstants.Internal.zIndex.stickyZIndex);this._mainDiv.style.cssText="z-index: "+(e?t:1)+"; visibility: hidden; position: absolute; top: 0px; left: 0px; width: 290px; direction: "+this._gridContext.RTL.ltr+";";this._parentNode.appendChild(this._mainDiv);this._addressInputId=a.format("{0}_{1}",this.id,"addressInput");this._verifyButtonId=a.format("{0}_{1}",this.id,"verifyButton");this._displayInputId=a.format("{0}_{1}",this.id,"displayInput");this._okButtonId=a.format("{0}_{1}",this.id,"okButton");this._cancelButtonId=a.format("{0}_{1}",this.id,"cancelButton");var n,r=a.format('<DIV style="margin:3px 10px 0px 10px; text-align:{0};"><img src="{1}" alt="{2}" title="{2}" id="{3}" tabIndex="-1" style="cursor:pointer;"/></DIV>',this._gridContext.RTL.Right,o.JsGridUtil.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+"closexon.png",SP.JsGrid.Res.close,this._cancelButtonId),i=a.format('<a href="javascript:;" id="{0}" title="{1}" style="float:{2};">{1}</a>',this._verifyButtonId,SP.JsGrid.Res.testHyperlink,this._gridContext.RTL.Right),u='<DIV style="margin:3px 10px 9px 10px;"><LABEL for={0}>{1}</LABEL>{3}<DIV style="margin-top:3px;"><INPUT id={0} style="width:268px; padding:0px;" maxLength="1024" type="text"></DIV><DIV style="margin-top:3px;">{2}</DIV></DIV>',f=a.format(u,this._addressInputId,SP.JsGrid.Res.hyperlinkAddress,SP.JsGrid.Res.hyperlinkAddressExample,i),l=a.format(u,this._displayInputId,SP.JsGrid.Res.hyperlinkDisplay,SP.JsGrid.Res.hyperlinkDisplayExample,"");n=z?a.format('<DIV style="padding:3px 10px 3px 10px; text-align:{0}" class="jsgrid-widget-hyperlink-buttonarea"><a href="javascript:;" title="{1}" id="{2}" class="jsgrid-widget-hyperlink-okbutton">{1}</a></DIV>',this._gridContext.RTL.Right,SP.JsGrid.Res.ok,this._okButtonId):a.format('<DIV style="padding:3px 10px 3px 10px; text-align:{0}" class="jsgrid-widget-hyperlink-buttonarea-quickedit"><a href="javascript:;" title="{1}" id="{2}">{1}</a></DIV>',this._gridContext.RTL.Right,SP.JsGrid.Res.ok,this._okButtonId);this._mainDiv.innerHTML=[r,f,l,n].join("");this._widgetHeight=this._mainDiv.offsetHeight;this._addressInput=document.getElementById(this._addressInputId);this._verifyButton=document.getElementById(this._verifyButtonId);this._displayInput=document.getElementById(this._displayInputId);this._okButton=document.getElementById(this._okButtonId);this._cancelButton=document.getElementById(this._cancelButtonId);this._displayInput.addEventListener("keyup",this.OnDisplayValueUpdated.bind(this));this._okButton.addEventListener("click",this.OnOK.bind(this));this._cancelButton.addEventListener("click",this.OnCancel.bind(this));this._verifyButton.addEventListener("click",this.OnVerify.bind(this));this._mainDiv.addEventListener("keydown",this.OnKeyDown.bind(this));this._mainDiv.addEventListener("mousedown",this.OnMouseDown.bind(this))};e.prototype.Dispose=function(){o.JsGridUtil.ClearEventListeners(this._displayInput);o.JsGridUtil.ClearEventListeners(this._okButton);o.JsGridUtil.ClearEventListeners(this._cancelButton);o.JsGridUtil.ClearEventListeners(this._verifyButton);o.JsGridUtil.ClearEventListeners(this._mainDiv);this._parentNode.removeChild(this._mainDiv)};e.prototype.BindToCell=function(e){this._cellContext=e;this._currentDisplayValue=this._cellContext.originalValue.localized!==o.JsGridUtil.EmptyValue?this._cellContext.originalValue.localized:this._cellContext.propType.GetAddress(this._cellContext.originalValue.data);this._currentDisplayValue||(this._currentDisplayValue="");this._currentAddress=this._cellContext.originalValue.data!==o.JsGridUtil.EmptyValue?this._cellContext.propType.GetAddress(this._cellContext.originalValue.data):this._cellContext.originalValue.localized};e.prototype.Unbind=function(){};e.prototype.GetIcon=function(){return new o.JsGridUtil.ImageWithFabricIcons({imgSrc:o.JsGridUtil.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+"link.gif"}).Render(SP.JsGrid.Res.editHyperlink)};e.prototype.Collapse=function(){this._mainDiv.style.visibility="hidden";this._cellContext.NotifyCollapseWidget()};e.prototype.Expand=function(){var e=this._cellContext.cellRect;this._mainDiv.style.top=(this._cellContext.cellExpandSpace.bottom>this._widgetHeight||this._cellContext.cellExpandSpace.top<this._widgetHeight?e.y+e.height+3:e.y-this._widgetHeight-3)+"px";X?this._mainDiv.style.left=(this._gridContext.RTL.bEnabled?e.x:e.x+e.width-this._mainDiv.offsetWidth)+"px":o.JsGridUtil.Internal.positionWidget(this._mainDiv,e,this._gridContext.RTL.bEnabled);this._currentDisplayValue=this._cellContext.originalValue.localized!==o.JsGridUtil.EmptyValue?this._cellContext.originalValue.localized:this._cellContext.propType.GetAddress(this._cellContext.originalValue.data);this._currentDisplayValue||(this._currentDisplayValue="");this._currentAddress=this._cellContext.originalValue.data!==o.JsGridUtil.EmptyValue?this._cellContext.propType.GetAddress(this._cellContext.originalValue.data):this._cellContext.originalValue.localized;this._displayInput.value=this._currentDisplayValue;this._addressInput.value=this._currentAddress;this._cellContext.NotifyExpandWidget();this._mainDiv.style.visibility="";o.JsGridUtil.Internal.IsStickyColumnEnabled()&&(this._cellContext.column.isSticky?this._mainDiv.classList.add(I.stickyEditor):this._mainDiv.classList.remove(I.stickyEditor));this._addressInput.focus();this._addressInput.value=this._addressInput.value};e.prototype.OnValueChanged=function(e){this._currentDisplayValue=null==e.localized||e.localized==o.JsGridUtil.EmptyValue?"":e.localized;this._currentAddress=null==e.data||e.data==o.JsGridUtil.EmptyValue?this._currentDisplayValue:this._cellContext.propType.GetAddress(e.data)};e.prototype.OnDisplayValueUpdated=function(){this.SetCurrentValue()};e.prototype.OnOK=function(e){this.SetCurrentValue();this._cellContext.NotifyEditComplete();this.Collapse();null!=e&&null!=e.preventDefault&&e.preventDefault();return!1};e.prototype.OnCancel=function(){this._cellContext.NotifyEditComplete(!0)};e.prototype.OnVerify=function(){window.open(this._addressInput.value)};e.prototype.SetCurrentValue=function(){this._cellContext.SetCurrentValue({localized:this._displayInput.value,data:{address:this._addressInput.value,display:this._displayInput.value}})};e.prototype.OnKeyDown=function(e){var t=this,n=!e.ctrlKey&&!e.altKey&&!e.shiftKey;!(function(){switch(e.keyCode){case s.JsGridConstants.Key.esc:t.OnCancel();return!0;case s.JsGridConstants.Key.enter:e.target==t._cancelButton?t.OnCancel():e.target==t._verifyButton?t.OnVerify():t.OnOK();return!0;case s.JsGridConstants.Key.tab:if(n){if(e.target==t._okButton){t._cancelButton.focus();return!0}}else if(e.shiftKey){if(e.target==t._cancelButton){t._okButton.focus();return!0}if(e.target==t._verifyButton){t._cancelButton.focus();return!0}}}return!1})()?e.stopPropagation():o.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)};e.prototype.OnMouseDown=function(e){e.stopPropagation()};return e})();e.HyperlinkWidget=i})(t.WidgetControl||(t.WidgetControl={}));t.WidgetControlType={Demo:"WIDGET_DEMO",Date:"WIDGET_DATE",Hyperlink:"WIDGET_HYPERLINK"}});
define("lQe",["require","exports","Kqe","kqe","Lqe","Dqe","Eqe","uQe","Gqe","RWe","Aqe","we"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(){function e(e,t){var s=this;this.processingNewRow=!1;this.actionsAssociatedWithUndo={};this._objBag=e;this._fnGetLocStr=t;this.versionMgr=e.versionMgr=new n.VersionManager(e,this.DoPhysicalPropChange.bind(this),this.DoPhysicalRowInsert.bind(this),this.DoPhysicalRowDelete.bind(this),function(){i.JsGridUtil.DebugAssert(!1,"Oh no!  We've removed hierarchy support.")},this.GetRecord.bind(this));this.checkSelMgr=new v(e);this.pendingChangeMgr=e.pendingChangeMgr=new r.PendingChangesManager(e);this.propUpdateMgr=new r.PropertyUpdateManager(e);e.tableCache.fnApplyUpdatesToNewRecord=function(e){s.versionMgr.ApplyChangesToRecord(e)};this.editUtil=e.editUtil=new p(this);this.eventSinks={OnPropertiesChanged:function(e,t,n,r){s.UpdateProperties(e,t,n,r)},OnNodeExpanded:function(e){i.JsGridUtil.DebugAssert(!1,"Oh no!  We've removed hierarchy support.")},OnNodeCollapsed:function(e){i.JsGridUtil.DebugAssert(!1,"Oh no!  We've removed hierarchy support.")},OnFocusedCellChanged:function(e){s.OnCellFocusedChanged(e)}}}e.prototype.GetCurrentDataValue=function(e,t){var n=this.versionMgr.GetCurrentValue(e,t);if(n==i.JsGridUtil.EmptyValue){var r=this._objBag.tableCache.GetCachedRecord(e);n=null!=r?r.GetDataValue(t):null}else n=n.GetData();return n};e.prototype.GetEarliestChangeKeyForRecord=function(e){return this.versionMgr.GetEarliestPropChangeKeyForRecord(e)};e.prototype.GetCurrentLocalizedValue=function(e,t){var n=this.versionMgr.GetCurrentValue(e,t);if(n==i.JsGridUtil.EmptyValue){var r=this._objBag.tableCache.GetCachedRecord(e);n=null!=r?r.GetLocalizedValue(t):null}else n=n.GetLocalized();return n};e.prototype.GetPropType=function(e,t){var n=this._objBag.tableCache.GetCachedRecord(e),r=null;null!=n&&null!=n.GetProp(t)?r=n.GetProp(t).propType:this._objBag.entryRecordMgr.IsEntryRecordKey(e)&&null!=this._objBag.jsGridParams.tableViewParams.gridFieldMap[t]?r=this._objBag.jsGridParams.tableViewParams.gridFieldMap[t].GetPropType():t==s.JsGridConstants.RecordIndicatorCheckboxColumnKey&&(r=o.PropertyType.Internal.Property.GetInstance().GetPropType("RecordIndicatorCheckBoxBoolean"));null==r&&(r=o.PropertyType.Internal.Property.GetInstance().GetPropType("String"));return r};e.prototype.ClearAllPropChangesForRecord=function(e){this.versionMgr.ClearAllPropChangesForRecord(e)};e.prototype.NotifyDataAvailable=function(){this._objBag.paneMgr.RefreshAllRows(0)};e.prototype.ClearChanges=function(){this._objBag.commandMgr.ClearUndoStack();null!=this.versionMgr&&this.versionMgr.Clear()};e.prototype.GetViewEventSinks=function(){return this.eventSinks};e.prototype.ClearTableView=function(){this._objBag.entryRecordMgr.NotifyTableViewCleared();this._objBag.paneMgr.ClearView()};e.prototype.TryReadPropForChangeKey=function(e,t,n){return this.versionMgr.TryReadPropForChangeKey(e,t,n)};e.prototype.SetTableView=function(e,t,n,r,i,s,o,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){this.posConverter=a;this.operationalUtil=f;this.columns=t;this.defaultEditMode=r;this.gridFieldMap=n;this.bNewRowEnabled=i;this.bEditingEnabled=s;this.SetRowViewInternal(e,!1);this.checkSelMgr.SetTableView(S,x,T);null!=this._objBag.columnMenuMgr&&this._objBag.columnMenuMgr.Dispose();this._objBag.columnMenuMgr=new u.default(this._objBag,e.autoFilterState,e.autoFilterEntries,this.gridFieldMap,this._fnGetLocStr,e.sortState);this._objBag.paneMgr.SetView(this.posConverter,this.columns,this.gridFieldMap,e.topViewIdx,this.operationalUtil,o,l,c,h,p,d,v,m,g,y,b,w,E,e.sortState);this.UpdateFilterAndSortState(e.sortState,e.filterState,e.autoFilterState)};e.prototype.SetRowView=function(e){this.SetRowViewInternal(e,!0);this._objBag.columnMenuMgr.SetAutoFilterState(e.autoFilterState);this._objBag.columnMenuMgr.SeedAutoFilterEntryCache(e.autoFilterEntries)};e.prototype.ChangeKeys=function(e,t){this._objBag.paneMgr.ChangeKeys(e,t);this.versionMgr.ChangeKeysOnPropUpdates(e,t);i.JsGridUtil.AsynchronousCellUpdater.GetInstance().ChangeRecordKeys(e,t);this._objBag.rowHeaderStateMgr.ChangeKeys(e,t);this._objBag.errorMgr.ChangeKeys(e,t);this._objBag.entryRecordMgr.IsEntryRecordKey(e)||this._objBag.tableCache.ChangeKeys(e,t)};e.prototype.UpdateFilterAndSortState=function(e,t,n){this._objBag.paneMgr.SetSortState(e);var r=new l.Set(n);null!=t&&(r=r.Union(t));this._objBag.paneMgr.SetFilterState(r.ToArray())};e.prototype.SetRowViewInternal=function(e,t){this._objBag.tableCache.SetView(e.view,e.minimalInfo&&e.minimalInfo.recordCount);if(t){this._objBag.paneMgr.NotifyNewRowStateChanged(!0);this._objBag.paneMgr.RefreshAllRows(e.topViewIdx);this.UpdateFilterAndSortState(e.sortState,e.filterState,e.autoFilterState)}};e.prototype.UpdateProperties=function(e,t,n,r){i.JsGridUtil.DebugAssert(e.length>0);var s;if(null==n){this._objBag.commandMgr.OpenGroup();n=(s=this.CreateDataUpdateCmd(null)).GetChangeKey()}null!=r&&r(n);this.propUpdateMgr.ApplyPropUpdates(e,n);if(null!=s){this._objBag.commandMgr.Execute(s,t,a.CommandManagerConstants.CommandType.Explicit);this._objBag.commandMgr.CloseGroup(t,a.CommandManagerConstants.CommandType.Explicit,!0)}return n};e.prototype.InsertHiddenRecord=function(e,t,n){if(null!=n&&this._objBag.entryRecordMgr.IsEntryRecordKey(n)){alert(this._fnGetLocStr("NoInsertAfterEntryRow"));return null}return this.InsertRecordAfterCore(this.GenerateRowUpdateForInsert(e,!1,n,!1,!1,null,null),t)};e.prototype.InsertRecordAfter=function(e,t,n,r,i,s,o){if(this._objBag.entryRecordMgr.IsEntryRecordKey(e)){alert(this._fnGetLocStr("NoInsertAfterEntryRow"));return null}this._objBag.tableCache.SeedInsertedRecord(t);return this.InsertRecordAfterCore(this.GenerateRowUpdateForInsert(t.key(),!0,e,r,i,s,o),n)};e.prototype.InsertRecordAfterCore=function(e,t){var n;null==t&&(t=(n=this.CreateDataUpdateCmd(null)).GetChangeKey());this.versionMgr.AddRowInsertChange(e,t);null!=n&&this._objBag.commandMgr.Execute(n,s.JsGridConstants.UserAction.InsertRecord,a.CommandManagerConstants.CommandType.Explicit);return t};e.prototype.InsertRecordBefore=function(e,t,n,r){var s,o;if(null==e)s=this.posConverter.RecordIdxToRecordKey(this._objBag.tableCache.GetRecordCount()-1);else{var u=this.posConverter.RecordKeyToRecordIdx(e);s=o=0==u?null:this.posConverter.RecordIdxToRecordKey(u-1);i.JsGridUtil.DebugAssert(null!=s,"Cannot determine afterRecordKey from beforeRecordKey")}return this.InsertRecordAfter(s,t,n,r,!1,o,s!==o)};e.prototype.DeleteRecords=function(e,t){var n,r=this;if(null!=i.JsGridUtil.Internal.FindInArray(e,function(e){return r._objBag.entryRecordMgr.IsEntryRecordKey(e)})){alert(this._fnGetLocStr("OpNotSupportedOnEntryRow"));return null}null==t&&(t=(n=this.CreateDataUpdateCmd(null)).GetChangeKey());for(var o=0;o<e.length;o++)this.versionMgr.AddRowDeleteChange(this.GenerateRowUpdateForDelete(e[o]),t);null!=n&&this._objBag.commandMgr.Execute(n,s.JsGridConstants.UserAction.DeleteRecord,a.CommandManagerConstants.CommandType.Explicit);return t};e.prototype.EnableEditing=function(){if(!this.bEditingEnabled){this.bEditingEnabled=!0;this._objBag.entryRecordMgr.EnsureLastEntryRowExists();this._objBag.paneMgr.NotifyNewRowStateChanged();this._objBag.paneMgr.NotifyCanEditUpdated();this._objBag.ariaMgr.EnableGridEditing(!0)}};e.prototype.DisableEditing=function(){var e=this;if(this.bEditingEnabled){this._objBag.paneMgr.StopEditing(!0);this._objBag.paneMgr.UnbindEditing(function(){e._objBag.entryRecordMgr.ClearUncommittedEntryRecords();e._objBag.paneMgr.NotifyNewRowStateChanged();e._objBag.paneMgr.NotifyCanEditUpdated();e._objBag.ariaMgr.EnableGridEditing(!1);e.bEditingEnabled=!1})}};e.prototype.TryBeginEdit=function(){var e=this._objBag.selectionMgr.GetFocusedPane();return null!=e&&e.TryBeginEdit({type:"gridapi"})};e.prototype.FinalizeEditing=function(e,t){var n=this;i.JsGridUtil.DebugAssert(null!=e&&null!=t);if(this.bEditingEnabled){this._objBag.paneMgr.StopEditing(!1);this.pendingChangeMgr.WaitForPendingUpdates(function(){n._objBag.errorMgr.AnyErrors()?t():n._objBag.entryRecordMgr.TryCommitFirstEntryRecords(function(){n._objBag.entryRecordMgr.AnyUncomittedEntryRecords()?t():n.pendingChangeMgr.WaitForAllChangeKeysToComplete(e)},!1)})}else e()};e.prototype.NotifyHide=function(){this.FinalizeEditing(function(){},function(){})};e.prototype.MarkPropUpdateInvalid=function(e,t,n,r){return this.versionMgr.MarkPropUpdateInvalid(e,t,n,r)};e.prototype.GetCurrentChangeKey=function(){return this.versionMgr.GetCurrentChangeKey()};e.prototype.IsChangeKeyApplied=function(e){return this.versionMgr.IsChangeKeyApplied(e)};e.prototype.GetChangeKeyForVersion=function(e){return this.versionMgr.GetChangeKeyForVersion(e)};e.prototype.GetCheckSelectionManager=function(){return null!=this.checkSelMgr?this.checkSelMgr.ExternalAPI:null};e.prototype.OnCellFocusedChanged=function(e){var t=e.oldRecordKey;e.newRecordKey!==t&&this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRowFocusChanged,i.JsGridUtil.EventArgs.RowFocusChanged(e.newRecordKey,e.oldRecordKey));this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnCellFocusChanged,e)};e.prototype.AttachUndoActionToChangeKey=function(e,t){var n=e.GetVersionNumber();null==this.actionsAssociatedWithUndo[n]&&(this.actionsAssociatedWithUndo[n]=[]);this.actionsAssociatedWithUndo[n].push(t)};e.prototype.CreateDataUpdateCmd=function(e){var t=this,n=!1,r=this.versionMgr.GetNextVersionKey();this._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnChangeKeyCreated,i.JsGridUtil.Internal.EventArgs.ChangeKeyStageUpdated(r));r.Reserve();return{Apply:function(){n&&t._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeginRedoDataUpdateChange,i.JsGridUtil.EventArgs.OnBeginRedoDataUpdateChange(r));t._objBag.paneMgr.ClearAllChangeIndications();t.versionMgr.ApplyChangeKey(r,n);n||e||t._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnChangeKeyInitialUpdateFinished,i.JsGridUtil.Internal.EventArgs.ChangeKeyStageUpdated(r));n=!0},Undo:function(){t._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeginUndoDataUpdateChange,i.JsGridUtil.EventArgs.OnBeginUndoDataUpdateChange(r));t._objBag.paneMgr.ClearAllChangeIndications();t.versionMgr.UndoChangeKey(r);var e=t.actionsAssociatedWithUndo[r.GetVersionNumber()];if(null!=e)for(var n=e.length-1;n>=0;n--)e[n]();t.actionsAssociatedWithUndo[r.GetVersionNumber()]=null},Dispose:function(e){e==a.CommandManagerConstants.DisposeState.Unapplied&&t.versionMgr.VacateChange(r);r.Release()},GetChangeKey:function(){return r},NotifyInitialUpdateComplete:function(){i.JsGridUtil.DebugAssert(e);t._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnChangeKeyInitialUpdateFinished,i.JsGridUtil.Internal.EventArgs.ChangeKeyStageUpdated(r))}}};e.prototype.DoPhysicalPropChange=function(e,t,n,o,u,a,f,l,h){this._objBag.cutcopypasteMgr.CancelMode();var p=null,d=null!=f?f:this._objBag.entryRecordMgr.IsEntryRecordKey(e)?this._objBag.entryRecordMgr.GetEntryRecord(e):this._objBag.tableCache.GetCachedRecord(e);null==n&&(n=new r.PropertyUpdate(null,""));var v=new r.PropertyUpdate(i.JsGridUtil.EmptyValue,i.JsGridUtil.EmptyValue);if(null!=d){var m=!0;if(null!=(p=d.GetProp(t))){v.localized=p.HasLocalizedValue()?p.GetLocalized():i.JsGridUtil.EmptyValue;v.data=p.HasDataValue()?p.GetData():i.JsGridUtil.EmptyValue;v.data!==n.data||v.localized!==n.localized?(v.localized!==n.localized||"SPUser"!==p.propType.ID&&"SPUser_MultiValue"!==p.propType.ID)&&p.Update(n.data,n.localized):m=!1}if(m){a||this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeforePropertyChanged,i.JsGridUtil.EventArgs.PropertyChanged(e,t,null==h?v:h,n,p&&p.propType,o,u));this._objBag.paneMgr.NotifyUpdateProperty(e,t,!0,n,u,o)}}this._objBag.errorMgr.ClearAllErrorsOnCell(e,t);if(u==s.JsGridConstants.ValidationState.Invalid){var g=null!=l?l:n.localized!==i.JsGridUtil.EmptyValue?c.format(this._fnGetLocStr("LocalizedConversionError"),n.localized):this._fnGetLocStr("GeneralConversionError");this._objBag.errorMgr.SetCellError(e,t,g)}if(!a){i.JsGridUtil.DebugAssert(null!=u);this._objBag.entryRecordMgr.IsEntryRecordKey(e)?this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnEntryRecordPropertyChanged,i.JsGridUtil.EventArgs.PropertyChanged(e,t,null==h?v:h,n,p&&p.propType,o,u)):this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnPropertyChanged,i.JsGridUtil.EventArgs.PropertyChanged(e,t,null==h?v:h,n,p&&p.propType,o,u))}};e.prototype.GetInsertIdxForRowUpdate=function(e,t,n){var r=!1,i=null;if("visualAfterRecordKey"in e){r=!0;i=e.visualAfterRecordKey;for(;null!=i&&null!=t&&null!=t[i];)n(i=t[i].visualAfterRecordKey)&&(i=null)}return this.GetRecordIdxForInsert(e.afterRecordKey,i,r)};e.prototype.DoPhysicalRowInsert=function(e,t,n,r){var o=function(){};this._objBag.cutcopypasteMgr.CancelMode();if(n(e.recordKey))return null;var u=null;this._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnBeforeRecordInserted,i.JsGridUtil.EventArgs.RecordInserted(e.recordKey,null,null,null));if(e.bIsInView){u=this.GetInsertIdxForRowUpdate(e,r,n);this._objBag.tableCache.InsertRecord(u,e.recordKey);e.bDoNotUpdatePaneOnFirstInsert?delete e.bDoNotUpdatePaneOnFirstInsert:this._objBag.paneMgr.NotifyInsertRows(this.posConverter.RecordIdxToViewIdx(u),1,e.bUpdateFocusPos,o)}this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordInserted,i.JsGridUtil.EventArgs.RecordInserted(e.recordKey,u,e.afterRecordKey,t));return e};e.prototype.DoPhysicalRowDelete=function(e,t,n){this._objBag.cutcopypasteMgr.CancelMode();var r=[],o=[e.recordKey];if(n(e.recordKey))return null;for(var u=0;u<o.length;u++){var a=o[u],f=a==e.recordKey?e:this.GenerateRowUpdateForDelete(a),l=null;this._objBag.intEventMgr.FireEvent(s.JsGridConstants.Internal.EventType.OnBeforeRecordDeleted,i.JsGridUtil.Internal.EventArgs.RecordDeleted(a));if(f.bIsInView){l=this.posConverter.RecordKeyToRecordIdx(a);var c=this.posConverter.RecordIdxToViewIdx(l);this._objBag.tableCache.IsKeyInView(a)&&this._objBag.tableCache.DeleteRecord(l);null!=c&&this._objBag.paneMgr.NotifyDeleteRows(c,1);0}this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordDeleted,i.JsGridUtil.EventArgs.RecordDeleted(a,l,t));r.push(f)}return r};e.prototype.GenerateRowUpdateForDelete=function(e){var t=this._objBag.tableCache.IsKeyInView(e),n=t?this.posConverter.RecordKeyToRecordIdx(e):null,r=null;t&&(r=0==n?null:this.posConverter.RecordIdxToRecordKey(n-1));return new d(e,r,0,t,!0,!1,void 0,void 0)};e.prototype.GenerateRowUpdateForInsert=function(e,t,n,r,i,s,o){return new d(e,n,0,t,r,i,s,o)};e.prototype.GetRecord=function(e){return this._objBag.tableCache.GetCachedRecord(e)};e.prototype.GetRecordIdxForInsert=function(e,t,n){var r=n?t:e,i=null==r?null:this.posConverter.RecordKeyToRecordIdx(r);n&&null!=r&&null==i&&(i=null==e?null:this.posConverter.RecordKeyToRecordIdx(e));return null==i?0:i+1};return e})();t.MVCController=h;var p=(function(){function e(e){this._controller=e}e.prototype.ValidateAndExpandKeyList=function(e){return!1};e.prototype.IsEditingEnabled=function(){return this._controller.bEditingEnabled};e.prototype.IsNewRowEnabled=function(){return this._controller.bNewRowEnabled&&this._controller.bEditingEnabled};e.prototype.GetFieldValueForCopy=function(e,t){i.JsGridUtil.lastCopiedValueType_SPUser=!1;var n,r=e.HasLocalizedValue(t)?e.GetLocalizedValue(t):null;if(t!==s.JsGridConstants.RecordIndicatorCheckboxColumnKey){var u=e.GetProp(t);n=u&&u.propType}else n=o.PropertyType.Internal.Property.GetInstance().GetPropType("RecordIndicatorCheckBoxBoolean");if(null!=n&&(null!=n.GetDisplayValue||null!=n.GetCopyValue)){var a=e.HasDataValue(t)?e.GetDataValue(t):null;null!=n.GetDisplayValue?r=n.GetDisplayValue(e,a,r):null!=n.GetCopyValue&&(r=n.GetCopyValue(e,a,r))}return null!=r?r:""};e.prototype.CanBindToField=function(e,t,n){return this.CanEditField(e,t,n)&&!(null!=n&&n==s.JsGridConstants.RecordIndicatorCheckboxColumnKey)};e.prototype.CanEditField=function(e,t,n){if(!this._controller.bEditingEnabled||null==e)return!1;if(!e.bIsNewRow&&null!=this._controller.operationalUtil.GetValue(e,s.JsGridConstants.OperationalConstants.GroupingOutlineLevel))return!1;if(null!=n&&n==s.JsGridConstants.RecordIndicatorCheckboxColumnKey)return!0;var r=null!=t&&null!=t.fnGetCellEditMode?t.fnGetCellEditMode(e,n):null;r=null==r?s.JsGridConstants.EditMode.Defer:r;var i=e.bIsNewRow?s.JsGridConstants.EditMode.ReadWriteDefer:this._controller._objBag.delegateMgr.DelegatePresent(s.JsGridConstants.DelegateType.GetRecordEditMode)?this._controller._objBag.delegateMgr.Apply(s.JsGridConstants.DelegateType.GetRecordEditMode,e):null;i=null==(i=null==i?this._controller.operationalUtil.GetValue(e,s.JsGridConstants.OperationalConstants.RecordEditMode):i)?s.JsGridConstants.EditMode.Defer:i;var o=null;null!=n&&(o=null==(o=this._controller._objBag.delegateMgr.DelegatePresent(s.JsGridConstants.DelegateType.GetFieldEditMode)?this._controller._objBag.delegateMgr.Apply(s.JsGridConstants.DelegateType.GetFieldEditMode,n):o)?this._controller.gridFieldMap[n].GetEditMode():o);null==o&&(o=s.JsGridConstants.EditMode.Defer);var u=Math.min(Math.min(Math.min(i,o),r),this._controller.defaultEditMode);return u==s.JsGridConstants.EditMode.ReadWrite||u==s.JsGridConstants.EditMode.ReadWriteDefer||u==s.JsGridConstants.EditMode.Defer};return e})(),d=function(e,t,n,r,i,s,o,u){this.recordKey=e;this.afterRecordKey=t;this.newOutlineLevel=n;r&&(this.bIsInView=r);i&&(this.bUpdateFocusPos=i);s&&(this.bDoNotUpdatePaneOnFirstInsert=s);u&&(this.visualAfterRecordKey=o)},v=(function(){function e(e){var t=this;this._checkedRecordKeys=new l.Set;this._checkboxDisabledRecordKeys=new l.Set;this._checkboxHiddenRecordKeys=new l.Set;this.ExternalAPI={CheckAllRecords:function(){for(var e=t._objBag.tableCache.GetView(),n=new l.Set,r=0;r<e.length;r++){var i=e[r];t._checkedRecordKeys.Contains(i)||t.IsRecordIndicatorCheckboxHidden(i)||t.IsRecordIndicatorCheckboxDisabled(i)||n.Add(i)}t.ChangeMultipleCheckboxStates(n,!0)},ClearCheckedRecords:function(){var e=t._checkedRecordKeys.Clone();t.ChangeMultipleCheckboxStates(e,!1)},EnableRecordCheckbox:function(e){if(t._checkboxDisabledRecordKeys.Contains(e)){t._checkboxDisabledRecordKeys.Remove(e);t.RefreshRecordIndicatorCell(e)}},DisableRecordCheckbox:function(e){if(!t._checkboxDisabledRecordKeys.Contains(e)){t._checkboxDisabledRecordKeys.Add(e);t.RefreshRecordIndicatorCell(e)}},ShowRecordCheckbox:function(e){if(t._checkboxHiddenRecordKeys.Contains(e)){t._checkboxHiddenRecordKeys.Remove(e);t.RefreshRecordIndicatorCell(e)}},HideRecordCheckbox:function(e){if(!t._checkboxHiddenRecordKeys.Contains(e)){t._checkboxHiddenRecordKeys.Add(e);t.RefreshRecordIndicatorCell(e)}},CheckRecord:this.CheckRecord,UncheckRecord:this.UncheckRecord,AnyRecordsChecked:function(){return!t._checkedRecordKeys.IsEmpty()},GetCheckedRecordKeys:function(){return t._checkedRecordKeys.GetCollection()},GetCheckedRecordCount:function(){return t._checkedRecordCount},GetHiddenCheckboxRecordKeys:function(){return t._checkboxHiddenRecordKeys.GetCollection()},GetDisabledCheckboxRecordKeys:function(){return t._checkboxDisabledRecordKeys.GetCollection()}};this._objBag=e;e.checkSelMgr=this;this.Init()}e.prototype.Init=function(){this._checkedRecordCount=0;var e=this._objBag.gridControls[s.JsGridConstants.RecordIndicatorControlId]=new f.DisplayControl.RecordIndicatorCheckboxControl(this._objBag.gridId,this.OnCheckboxClicked,this.IsRecordIndicatorCheckboxHidden,this.IsRecordIndicatorCheckboxDisabled,this.IsRecordIndicatorCheckboxChecked);o.PropertyType.Utils.RegisterDisplayControl(e.Id,e,[])};e.prototype.IsRecordIndicatorCheckboxHidden=function(e){return!!this._checkboxHiddenRecordKeys.Contains(e)};e.prototype.IsRecordIndicatorCheckboxDisabled=function(e){return this._checkboxDisabledRecordKeys.Contains(e)};e.prototype.CheckRecord=function(e){this._checkedRecordKeys.Contains(e)||this.ChangeSingleCheckboxState(e)};e.prototype.UncheckRecord=function(e){this._checkedRecordKeys.Contains(e)&&this.ChangeSingleCheckboxState(e)};e.prototype.ChangeMultipleCheckboxStates=function(e,t){var n=this,r=function(t){if(t){for(var r in e.GetCollection())if(!n._checkedRecordKeys.Contains(r)){n._checkedRecordKeys.Add(r);++n._checkedRecordCount}}else for(var r in e.GetCollection())if(n._checkedRecordKeys.Contains(r)){n._checkedRecordKeys.Remove(r);--n._checkedRecordCount}n.RefreshRecordIndicatorCell(null);n._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordChecked,i.JsGridUtil.EventArgs.RecordChecked(e,t))};this._objBag.commandMgr.Execute({Apply:function(){r(t)},Undo:function(){r(!t)}},"ChangeIndicatorCheckBox",a.CommandManagerConstants.CommandType.Explicit)};e.prototype.ChangeSingleCheckboxState=function(e){var t=this,n=function(){if(!t.IsRecordIndicatorCheckboxHidden(e)&&!t.IsRecordIndicatorCheckboxDisabled(e)){var n=!t.IsRecordIndicatorCheckboxChecked(e);if(n){t._checkedRecordKeys.Add(e);++t._checkedRecordCount}else{t._checkedRecordKeys.Remove(e);--t._checkedRecordCount}t.RefreshRecordIndicatorCell(e);t._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnRecordChecked,i.JsGridUtil.EventArgs.RecordChecked((new l.Set).AddArray([e]),n))}};this._objBag.commandMgr.Execute({Apply:n,Undo:n,Dispose:function(){n=null}},"ChangeIndicatorCheckBox",a.CommandManagerConstants.CommandType.Explicit)};e.prototype.OnCheckboxClicked=function(e){this.ChangeSingleCheckboxState(e);if(this.IsRecordIndicatorCheckboxChecked(e)){var t=this.GetRecordKeysWhereColumnIsSelected(s.JsGridConstants.RecordIndicatorCheckboxColumnKey);if(t.Contains(e)){for(var n in t)(this._checkedRecordKeys.Contains(n)||this.IsRecordIndicatorCheckboxHidden(n)||this.IsRecordIndicatorCheckboxDisabled(n))&&t.Remove(n);this.ChangeMultipleCheckboxStates(t,!0)}}};e.prototype.GetRecordKeysWhereColumnIsSelected=function(e){for(var t=this._objBag.jsGridObj.GetSelectedRowRanges(),n=this._objBag.jsGridObj.GetSelectedColumnRanges(),r=this._objBag.jsGridObj.GetSelectedCellRanges(),s=new l.Set,o=0;o<n.length;o++)if(null!=i.JsGridUtil.Internal.FindInArray(n[o].keys,function(t){return t==e})){s.AddArray(this._objBag.tableCache.GetView());break}if(s.IsEmpty()){for(o=0;o<t.length;o++)s.AddArray(t[o].keys);for(o=0;o<r.length;o++)null!=i.JsGridUtil.Internal.FindInArray(r[o].colRange.keys,function(t){return t==e})&&s.AddArray(r[o].rowRange.keys)}return s};e.prototype.RefreshRecordIndicatorCell=function(e){this._objBag.paneMgr.NotifyUpdateProperty(e,s.JsGridConstants.RecordIndicatorCheckboxColumnKey,!1,null)};e.prototype.IsRecordIndicatorCheckboxChecked=function(e){return this._checkedRecordKeys.Contains(e)};e.prototype.SetTableView=function(e,t,n){this._checkboxHiddenRecordKeys=new l.Set;this._checkboxHiddenRecordKeys.AddArray(e);this._checkboxDisabledRecordKeys=new l.Set;this._checkboxDisabledRecordKeys.AddArray(t);this._checkedRecordKeys=new l.Set;this._checkedRecordKeys.AddArray(n);this._checkedRecordCount=n.length};return e})()});
define("rQe",["require","exports","Dqe","Gqe","Lqe","kqe","Wqe","Aqe","k"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=a.Killswitch.isActivated("FAFFB0A4-381F-4ADF-A597-87E8C524145C","9/27/2019","Enable copy in non-IE browsers"),l={ODB:1725},c=(function(){function e(e,t){this.SelectionType=n.JsGridConstants.SelectionType;this.hasClipBoardData=function(){return!!this._clipboardMgr.GetData()};this._objBag=e;this._fnGetLocStr=t;this._clipboardMgr=new h(e)}e.prototype.GetLastOperation=function(){return this.copyOp&&{gridPane:this.copyOp.gridPane,rowRange:this.copyOp.rowRange,colRange:this.copyOp.colRange,selType:this.copyOp.selType,opType:this.copyOp.opType}};e.prototype.CheckClipboard=function(){null==this.copyOp||this.IsClipboardDataFromLastCopyOperation()||this.CancelMode()};e.prototype.IsSelectionCopyable=function(e){return this._objBag.selectionMgr.GetRowRanges(e).length+this._objBag.selectionMgr.GetColumnRanges(e).length+this._objBag.selectionMgr.GetCellRanges(e).length==1};e.prototype.CancelMode=function(){var e=this.copyOp&&this.copyOp.gridPane;this.copyOp=null;null!=e&&e.NotifyCopyOperationUpdated()};e.prototype.OnCopy=function(e){var t,r=this,s=this._objBag.selectionMgr.GetLastSelectionRangeNormalized();if(null!=s){i.JsGridUtil.Internal.IsFeatureEnabled(l)&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===(null===(t=s.colRange)||void 0===t?void 0:t.begin)&&(s.colRange.begin=0);var o,u=s.rowRange,a=s.colRange,f=e.GetGridPaneConverter();this._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return o=f.GetRecordsInvolved(u.begin,u.Size(),function(t){o=t;e()})},function(){r.BaseCopy(e,o,u,a,"copy",!1)})}};e.prototype.OnCut=function(e){var t,r=this;if(this._objBag.editUtil.IsEditingEnabled()){var s=this._objBag.selectionMgr.GetLastSelectionRangeNormalized();if(null!=s){i.JsGridUtil.Internal.IsFeatureEnabled(l)&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===(null===(t=s.colRange)||void 0===t?void 0:t.begin)&&(s.colRange.begin=0);var o,u=s.rowRange,a=s.colRange,f=e.GetGridPaneConverter(),c=this._objBag.editUtil.IsNewRowEnabled()&&u.end==f.GetVirtualRowCount()-this._objBag.entryRecordMgr.GetEntryRecords().length,h=f.GetRecordKeysInvolved(u.begin,u.Size());if(c)alert(this._fnGetLocStr("OpNotSupportedOnEntryRow"));else{var p=this._objBag.selectionMgr.GetLastSelectionType()==this.SelectionType.RowRange&&this._objBag.delegateMgr.DelegatePresent(n.JsGridConstants.DelegateType.DeleteRecords);if(p){if(e.Id!==n.JsGridConstants.PaneId.MainGrid){alert(this._fnGetLocStr("NoCuttingRowsInPane"));return}var d=this._objBag.editUtil.ValidateAndExpandKeyList(h);if(null!=d){if(!d.bAllChildKeysInView){alert(this._fnGetLocStr("NoDeletingParentWithMissingChildren"));return}if(d.expandedKeys.length!==h.length){alert(this._fnGetLocStr("NoCuttingParentWithoutChildren"));return}}}this._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return o=f.GetRecordsInvolved(u.begin,u.Size(),function(t){o=t;e()})},function(){if(p){if(r.ContainsReadOnlyRows(o)){alert(r._fnGetLocStr("NoCuttingReadOnlyRows"));return}}else if(r.ContainsReadOnlyCells(e,o,u,a)){alert(r._fnGetLocStr("NoCuttingReadOnlyCells"));return}r.BaseCopy(e,o,u,a,"cut",p)})}}}else alert(this._fnGetLocStr("GridNotEditable"))};e.prototype.OnPaste=function(e,t){var s=this,a=function(e){g?e():s._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return T=w.GetRecordsInvolved(O.begin,O.Size(),function(t){T=t;e()})},e)},f=function(e){s._objBag.delegateMgr.DelegatePresent(n.JsGridConstants.DelegateType.TryBeginPaste)?s._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.TryBeginPaste,O.end-O.begin+1,l,e):l(e)},l=function(t){s._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnPasteBegin);if(!i.JsGridUtil._fixPasteNewRowPerfKillSwitchIsActive)if(i.JsGridUtil._updatedPasteReflowKillSwitchIsActive){s._objBag.jsGridObj.paneMgr.gridPane.dontReflow=!0;s._objBag.jsGridObj.paneMgr.gridPane.afterReflowScrollGoal=O.begin}else if(1!=h.height){s._objBag.jsGridObj.paneMgr.gridPane.dontReflow=!0;s._objBag.jsGridObj.paneMgr.gridPane.afterReflowRowScrollGoal=O.begin;s._objBag.jsGridObj.paneMgr.gridPane.afterReflowColScrollGoal=M.begin}s.CancelMode();if(null!=d)if(d.causesRowDelete){s._objBag.jsGridObj.DeleteRecords(i.JsGridUtil.Internal.ConvertSetKeysToArray(x));O.begin-=v;O.end-=v}else s._objBag.jsGridObj.UpdateProperties(s.BuildPropertyUpdatesForCut(d.gridPane,x,d.rowRange,d.colRange),n.JsGridConstants.UserAction.Paste);e.PutData(h,T,n.JsGridConstants.UserAction.Paste,"TL",O,M,t,g)},c=function(t){i.JsGridUtil.hasPasteStarted=!1;s._objBag.selectionMgr.SelectRange(e,O.begin,O.begin+Math.min(t,O.end-O.begin),M.begin,M.end,o.SelectOp.Set,!0,!1);s._objBag.commandMgr.CloseGroup(null!=d?"SP.JsGrid.UserAction.CutPaste":n.JsGridConstants.UserAction.Paste,r.CommandManagerConstants.CommandType.Explicit,!0);s._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnPasteEnd)};if(this._objBag.editUtil.IsEditingEnabled()){if(!this.IsSelectionCopyable(e)){alert(this._fnGetLocStr("MultipleSelections"));return!1}var h=this.GetParsedClipboardData(t);if(null!=h){var p=this._objBag.selectionMgr.GetLastSelectionRangeNormalized();if(null!=p){i.JsGridUtil.hasPasteStarted=!0;var d,v=0,m=0;if(null!=this.copyOp&&"cut"==this.copyOp.opType&&this.IsClipboardDataFromLastCopyOperation()&&(d={gridPane:this.copyOp.gridPane,rowRange:this.copyOp.rowRange,colRange:this.copyOp.colRange,causesRowDelete:this.copyOp.bCutCausesRowDelete}).causesRowDelete){v=d.gridPane==e&&d.rowRange.begin<p.rowRange.begin?d.rowRange.Size():0;m=d.rowRange.Size();if(e.Id!==n.JsGridConstants.PaneId.MainGrid){alert(this._fnGetLocStr("NoPastingRowsInPane"));return}if(new u.Range(p.rowRange.begin,p.rowRange.begin+d.rowRange.Size()-1).Overlaps(d.rowRange)){alert(this._fnGetLocStr("CutPasteRowOverlap"));return}}var g,y=p.colRange.Size(),b=p.rowRange.Size(),w=e.GetGridPaneConverter(),E=w.GetVirtualRowCount();if(this._objBag.editUtil.IsNewRowEnabled()){var S=this._objBag.entryRecordMgr.GetEntryRecords().length;g=p.rowRange.begin>=E-S;E-=S}if(p.colRange.begin+h.width>w.GetVirtualColumnCount()||!g&&p.rowRange.begin-v+h.height>E-m)alert(this._fnGetLocStr("NoRoomToPaste"));else{var x,T,N,C=y%h.width==0,k=b%h.height==0,L=null==d&&C&&(k||b<h.height)?y:h.width,A=null==d&&k&&(C||y<h.width)?b:h.height,O=new u.Range(p.rowRange.begin,p.rowRange.begin+A-1),M=new u.Range(p.colRange.begin,p.colRange.begin+L-1);this._objBag.commandMgr.OpenGroup();null!=d?(N=function(){a(function(){f(c)})},s._objBag.intDelegateMgr.Apply(n.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return x=d.gridPane.GetGridPaneConverter().GetRecordsInvolved(d.rowRange.begin,d.rowRange.Size(),function(t){x=t;e()})},N)):a(function(){f(c)})}}}}else alert(this._fnGetLocStr("GridNotEditable"))};e.prototype.BaseCopy=function(e,t,n,r,i,s){if(!this.IsSelectionCopyable(e)){alert(this._fnGetLocStr("MultipleSelections"));return!1}for(var o=e.GetData(t,n,r,!1),u=new Array(n.Size()),a=0;a<u.length;a++){u[a]=o.matrix[a].join("\t");u[a]=this.NormalizeCRLF(u[a]);u[a]=u[a].replace(/\n/g,"<br>")}this.CancelMode();var f=u.join("\r\n");if(this._clipboardMgr.SetData(f)){this.copyOp={clipboardText:f,rowRange:n,colRange:r,selType:this._objBag.selectionMgr.GetLastSelectionType(),gridPane:e,opType:i,bCutCausesRowDelete:s};e.NotifyCopyOperationUpdated();return!0}return!1};e.prototype.GetParsedClipboardData=function(e){var t=e||this._clipboardMgr.GetData();if(null==t||""==t)return null;var n=t.replace(/(\\r)(?!\\n)/g,"\n").split("\r\n");1===n.length&&(n=this.NormalizeCRLF(t).split("\n"));n.length>1&&""==n[n.length-1]&&n.pop();for(var r,s=n.length,o=0;o<s;o++){n[o]=n[o].split("\t");if(null==r)r=n[o].length;else if(r!==n[o].length){if(o==s-1&&1==n[o].length&&""==n[o][0]){s--;break}break}for(var u=0;u<n[o].length;u++){var a=n[o][u];if(a.indexOf("\n")>=0){a=(a=a.replace(/^\"+|\"+$/gm,"")).replace(/\"\"/gm,'"');a=(a=i.JsGridUtil.Internal.Encoding_STSHtmlEncode(a)).replace(/\n/g,"<br>");n[o][u]=a}}}if(o!==s){alert(this._fnGetLocStr("ClipboardDataNotSquare"));return null}return{matrix:n,width:r,height:s}};e.prototype.ContainsReadOnlyCells=function(e,t,n,r){for(var i=e.GetGridPaneConverter(),s=n.begin;s<=n.end;s++)for(var o=r.begin;o<=r.end;o++){var u=i.IdxToKey(s,o);if(!this._objBag.editUtil.CanEditField(t[u.recordKey],i.GetColumnByIdx(o),u.fieldKey))return!0}return!1};e.prototype.ContainsReadOnlyRows=function(e){for(var t in e)if(!this._objBag.editUtil.CanEditField(e[t],null,null))return!0;return!1};e.prototype.BuildPropertyUpdatesForCut=function(e,t,n,r){for(var i=e.GetGridPaneConverter(),o=new Array(n.Size()*r.Size()),u=0,a=n.begin;a<=n.end;a++)for(var f=r.begin;f<=r.end;f++){var l=i.IdxToKey(a,f);o[u++]=s.CreateUnvalidatedPropertyUpdate(l.recordKey,l.fieldKey,"",!0)}return o};e.prototype.NormalizeCRLF=function(e){return e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")};e.prototype.IsClipboardDataFromLastCopyOperation=function(){var e=this._clipboardMgr.GetData();return null==this.copyOp.clipboardText?null==e:(e&&this.NormalizeCRLF(e))==this.NormalizeCRLF(this.copyOp.clipboardText)};return e})();t.CutCopyPasteManager=c;var h=function(e){var t=this;this.GetMimeType=function(){return null!=window.clipboardData&&null!=window.clipboardData.getData?"text":Sys.Browser.agent==Sys.Browser.Safari||Sys.Browser.agent==Sys.Browser.AppleWebKit?"text/plain":Sys.Browser.agent==Sys.Browser.Firefox?"text/unicode":"text"};this._mimeType=this.GetMimeType();this.SetData=function(e){var n,r;if(window.clipboardData&&window.clipboardData.setData)window.clipboardData.setData(t._mimeType,e);else{t._clipboardContext={};t._clipboardContext[t._mimeType]=e;if(!f){var s=null===(r=null===(n=t._objBag)||void 0===n?void 0:n.jsGridParams)||void 0===r?void 0:r.gridId;i.JsGridUtil.Internal.GetFocusElement(s).addEventListener("copy",t.EventBasedCopy,!1);document.execCommand("copy")}}return!0};this.EventBasedCopy=function(e){e.stopImmediatePropagation();e.stopPropagation();e.preventDefault();e.clipboardData&&e.clipboardData.setData&&e.clipboardData.setData(t._mimeType,t._clipboardContext[t._mimeType])};this.GetData=function(){return null!=window.clipboardData&&null!=window.clipboardData.getData?window.clipboardData.getData(t._mimeType):t._clipboardContext&&t._clipboardContext[t._mimeType]};this._objBag=e};t.ClipboardManager=h});
define("Pqe",["require","exports","o"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultPortalManger={unmount:n.unmountComponentAtNode,render:n.render}});
define("gQe",["require","exports","Dqe","Lqe","Rqe","Eqe","RWe","Nqe","zqe","vQe"],function(require,exports,constants_1,gridutil_1,ColumnInfo_1,property_1,control_1,styles_1,jsgridobj_1,JSONParse_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var NumberUnitFlight={ODB:1300},BooleanVisualRefreshFlight={ODB:1740},Deserializer=(function(){function e(e,t,n){this.keyColumnName=n;this._serializedJsGridData=e;this._initType=t;this.Init()}e.prototype.InitJsGridParams=function(e){var t=null!=e?e:new jsgridobj_1.JsGridControlParameters({});t.tableViewParams=this.InitJsGridTableViewParams(t.tableViewParams);return t};e.prototype.InitJsGridTableViewParams=function(e){var t=null!=e?e:new jsgridobj_1.TableViewParameters;t.operationalConstantsFieldKeyMap=this.operationalConstantsFieldKeyMap;t.gridFieldMap=this.gridFieldMap;t.paneLayout=this.paneLayout;t.keyFieldName=this.keyColumnName;t.bAutoFilterableColumns=this.bAutoFilterableColumns;null!=this.columns&&(t.columns=new ColumnInfo_1.ColumnInfoCollection(this.columns));this.isGanttEnabled&&(t.ganttParams=this.InitJsGridGanttParams(t.ganttParams));t.rowViewParams=this.InitJsGridRowViewParams(t.rowViewParams);return t};e.prototype.InitJsGridRowViewParams=function(e){var t=null!=e?e:new jsgridobj_1.RowViewParameters;t.minimalInfo=this.minimalInfo;t.hierarchyMode=!1;t.groupingLevel=this.groupingLevel;t.groupingRecordKeyPrefix=this.groupingPrefix;t.view=this.view;t.autoFilterState=this.autoFilterState;t.sortState=this.sortState;t.autoFilterEntries=this.autoFilterEntries;return t};e.prototype.InitJsGridGanttParams=function(e){var t=null!=e?e:new jsgridobj_1.GanttParameters;t.dateRange=[this.ganttInfo.StartDate,this.ganttInfo.FinishDate];t.ganttBarStyles=this.ganttInfo.Styles.barStyles;t.fieldKeyRedrawFilter=this.ganttInfo.Styles.fieldKeyRedrawFilter;return t};e.prototype.InitCellStyles=function(e){if(null!=this.cellStyles)for(var t in this.cellStyles)e.RegisterCellStyle(t,styles_1.StyleUtil.CreateStyle(styles_1.StyleType.Cell,this.cellStyles[t]));if(null!=this.groupingGridRowStyleIds){for(var n=[],r=0;r<this.groupingGridRowStyleIds.length;r++)n.push(e.GetCellStyle(this.groupingGridRowStyleIds[r]));e.groupingStyles=n}};e.prototype.Init=function(){this._initType==constants_1.JsGridConstants.DeserializationMode.Full?this.PopulateFull():this._initType==constants_1.JsGridConstants.DeserializationMode.TableView?this.PopulateTableView():this._initType==constants_1.JsGridConstants.DeserializationMode.RowView?this.PopulateRowView():this._initType==constants_1.JsGridConstants.DeserializationMode.Slice?this.PopulateIncremental():this._initType==constants_1.JsGridConstants.DeserializationMode.AutoFilter&&this.PopulateAutoFilter()};e.prototype.PopulateFull=function(){this.PopulateTableView(this._serializedJsGridData)};e.prototype.PopulateTableView=function(e){var t=this,n=this._serializedJsGridData.MultiValueSeparator;null!=e.LookupTableInfo&&(function(e){for(var t=0;t<e.length;t++)property_1.PropertyType.RegisterNewLookupPropType(e[t].id,e[t].lookup,e[t].showImage&&e[t].showText?control_1.DisplayControlType.ImageText:e[t].showImage?control_1.DisplayControlType.Image:control_1.DisplayControlType.Text,e[t].limitToList)})(e.LookupTableInfo);(function(e){t.gridFieldMap={};for(var r=gridutil_1.JsGridUtil.Internal.IsFeatureEnabled(NumberUnitFlight),i=gridutil_1.JsGridUtil.Internal.IsFeatureEnabled(BooleanVisualRefreshFlight),s=0;s<e.length;s++){"SPUser"!=e[s].propertyTypeId&&"SPUser_Multi"!=e[s].propertyTypeId&&"Location"!=e[s].propertyTypeId||(e[s].hasDataValue=!0);var o=e[s],u=new ColumnInfo_1.GridField(o.fieldKey,o.hasDataValue,o.hasLocalizedValue,o.textDirection,o.defaultCellStyleId,o.editMode,o.dateOnly,o.csrInfo);o.multiValue&&u.SetIsMultiValue(n);var a=null;if(r&&o.csrInfo&&"Number"===o.csrInfo.Type)a=property_1.PropertyType.Internal.Property.GetInstance().GetPropType("Number");else if(i&&o.csrInfo&&"Boolean"===o.csrInfo.Type)a=property_1.PropertyType.Internal.Property.GetInstance().GetPropType("CheckBoxBoolean");else{"DropdownBoolean"===o.propertyTypeId&&gridutil_1.JsGridUtil.Internal.IsFeatureEnabled(BooleanVisualRefreshFlight)&&(o.propertyTypeId="CheckBoxBoolean");a=null!=o.propertyTypeId?property_1.PropertyType.Internal.Property.GetInstance().GetPropType(o.propertyTypeId):null}u.SetSingleValuePropType(a);t.gridFieldMap[u.key]=u}})(e.Fields);(function(e){t.columns=[];for(var n=0;n<e.length;n++){var r=e[n],i=new ColumnInfo_1.ColumnInfo(r.name,r.imgSrc,r.columnKey,r.width);i.isVisible=r.isVisible;i.isHidable=r.isHidable;i.isResizable=r.isResizable;i.isSortable=r.isSortable;i.isAutoFilterable=r.isAutoFilterable;i.imgRawSrc=r.imgRawSrc;i.customFormatter=r.customFormatter;i.ascendingString=r.ascendingString;i.descendingString=r.descendingString;i.isFilterable=r.isFilterable;i.fieldType=r.fieldType;i.internalName=r.internalName;i.isEditable=r.isEditable;i.isCalculated=r.isCalculated;i.customFormatter&&(i.fnGetDisplayControlName=function(){return control_1.DisplayControlType.CustomFormatter});t.columns.push(i)}})(e.Columns);null!=e.PivotedColumns&&gridutil_1.JsGridUtil.DebugAssert(!1,"Uh oh!  We removed pivoted columns...");this.paneLayout=e.PaneLayout;this.ganttInfo=e.GanttInfo;this.bAutoFilterableColumns=e.AutoFilterableColumns;this.PopulateRowView()};e.prototype.PopulateRowView=function(){this.view=this._serializedJsGridData.ViewInfo;this.autoFilterState=this._serializedJsGridData.AutoFilterState;this.sortState=this._serializedJsGridData.SortState;this.cellStyles=this._serializedJsGridData.CellStyles;this.groupingGridRowStyleIds=this._serializedJsGridData.GroupingGridRowStyleIds;this.autoFilterEntries=this.DecompressAutoFilterEntries(this._serializedJsGridData.AutoFilterEntries);this.PopulateIncremental()};e.prototype.PopulateIncremental=function(){null!=this._serializedJsGridData.MetaData&&this.PopulateMetaData(this._serializedJsGridData.MetaData);if(null!=this._serializedJsGridData.LocalizedTable&&null!=this._serializedJsGridData.UnlocalizedTable){var e=this._serializedJsGridData.LocalizedTable,t=this._serializedJsGridData.UnlocalizedTable;this.viewDependentKeys=this._serializedJsGridData.ViewDepKeys;gridutil_1.JsGridUtil.DebugAssert(e.length==t.length);this.data={};for(var n=0;n<t.length;n++)this.data[t[n][this.keyColumnName]]={data:t[n],localized:e[n]}}this.additionalParams=this._serializedJsGridData.AdditionalParams;null!=this._serializedJsGridData.RecordCount&&null!=this._serializedJsGridData.TopRecord&&(this.minimalInfo={topRecord:this._serializedJsGridData.TopRecord,recordCount:this._serializedJsGridData.RecordCount})};e.prototype.PopulateAutoFilter=function(){this.PopulateMetaData(this._serializedJsGridData.MetaData);this.autoFilterEntries=this.DecompressAutoFilterEntries(this._serializedJsGridData.AutoFilterEntries)};e.prototype.PopulateMetaData=function(e){switch(this._initType){case constants_1.JsGridConstants.DeserializationMode.Full:case constants_1.JsGridConstants.DeserializationMode.TableView:this.isGanttEnabled=e.IsGanttEnabled;this.operationalConstantsFieldKeyMap=e.GridOperationalConstantsFieldKeyMap;this.keyColumnName=e.KeyColumnName;case constants_1.JsGridConstants.DeserializationMode.RowView:this.groupingLevel=e.GroupingLevel;this.groupingPrefix=e.GroupingPrefix;this.isGrouped=0!==this.groupingLevel;this.isSorted=e.IsSorted;default:this.recordKeyHash=e.RecordKeyHash;this.recordKeyOrderChanged=e.RecordKeyOrderChanged}};e.prototype.DecompressAutoFilterEntries=function(e){if(null!=e)for(var t in e)for(var n=e[t],r=0;r<n.length;r++)1===n[r].displayString&&(n[r].displayString=n[r].dataValue);return e};return e})();exports.Deserializer=Deserializer;function DeserializeFromJson(e,t){t||(t={});"guid"in t||(t.guid=function(e){return'"'+gridutil_1.JsGridUtil.GuidManager.prototype.GetIndexForGuid(e)+'"'});for(var n in t)e=EvalFunctionCallsInJson(e,n,t[n]);gridutil_1.JsGridUtil.DebugAssert(null!=e&&""!==e,"Null or empty parameter to deserialize");try{return JSONParse_1.JSONParse(e)}catch(e){throw e}}exports.DeserializeFromJson=DeserializeFromJson;function EvalFunctionCallsInJson(jsonText,prefix,fn){var unescapedQuoteRegEx='([^\\\\])\\"',regEx=unescapedQuoteRegEx+Escape(prefix)+"<;>(.+?)"+unescapedQuoteRegEx;return jsonText.replace(eval("/"+regEx+"/g"),function(e,t,n,r){var i=fn.apply(null,DeserializeEncodedArray(n+r));return t+(null==i?"":i)});function DeserializeEncodedArray(e){for(var t=e.split("<;>"),n=0;n<t.length-1;n++)t[n]=Unescape(t[n]);return t}function Unescape(e){return e.replace(/;;/g,";")}function Escape(e){return e.replace(/;/g,";;")}}exports.EvalFunctionCallsInJson=EvalFunctionCallsInJson});
define("uqe",["require","exports","KH","pc","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i){"use strict";i=i.PersonDisplay_7;Object.defineProperty(t,"__esModule",{value:!0});t.GetPersonDisplay=function(e){var t;if(e.imageUrl)t="<div class='"+i.personDisplayCoin+" ms-PersonDisplay-personDisplayCoin'><img class="+i.personDisplayPhoto+" src="+e.imageUrl+"></img></div>";else{var s=n.getPersonaInitialsColor(e),o=r.getInitials(e.text,!1);t="<div class='"+i.personDisplayCoin+" ms-PersonDisplay-personDisplayCoin' style='background:"+s+"'>"+o+"</div>"}var u="<span class='"+i.personDisplayName+" ms-PersonDisplay-personDisplayName'>"+e.text+"</span>";return"<div class='"+i.personDisplayPill+" ms-PersonDisplay-personDisplayPill'>"+t+u+"</div>"}});
define("oQe",["require","exports","ww","Lqe","Dqe","sQe","kqe","k","bv","So","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c=l.panemgr_9;l=l.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:60017},p={Inited:1,Bound:2,Editing:3},d={ODB:1725},v={ODB:1892},m={ODB:1507},g=u.Killswitch.isActivated("7735945e-c4b7-4456-bc23-590e84ff2ae8","4/09/2020","fix escape to actually close editors"),y=u.Killswitch.isActivated("8a1e846d-3209-4f04-b6f5-2b40e35f5724","4/09/2020","fix escape to close hyperlink editor"),b=u.Killswitch.isActivated("7e38e73e-5d98-4a58-859f-384c19175e94","4/09/2020","fix escape to close multiperson editor"),w=u.Killswitch.isActivated("D531FB8A-1ACE-4536-98E3-F16684254E65","9/18/2020","Do not call the StopEditing function twice to make sure the editors collapse."),E=u.Killswitch.isActivated("8CA80EAA-8FA6-4B15-B455-AAB2B5F9C495","9/30/2020","Do not call the Unbind on editors twice to make sure the editors collapse."),S=(function(){function e(e,t,n){this._curState=p.Inited;this._widgetIcons={};this._stateTransitionManager=new T(this);this._objBag=e;this._fnUpdateProperties=t;this._fnGetCellValue=n;this._telemetry=e&&e.jsGridParams&&e.jsGridParams.telemetry;this._baseEngagementData=e&&e.jsGridParams&&e.jsGridParams.baseEngagementData;this.errorMgr=e.errorMgr;this.actorsParentNode=e.parentNode;this._widgetDock=this.CreateWidgetDock();this._actorRegistrationManager=new s.EditActorsRegistrationManager(e,this.actorsParentNode,this.GetEditControlManagerAPI.bind(this),this.GetWidgetControlManagerAPI.bind(this),this.OnRegisterWidgetControl.bind(this));e.eventMgr.AttachEvent(i.JsGridConstants.EventType.OnCellErrorStateChanged,this.RecalculateWidgets.bind(this))}e.prototype.unBindEditors=function(){if(null!==this._curActorsAPI&&void 0!==this._curActorsAPI)for(var e=0;e<this._curActorsAPI.length;e++)this._curActorsAPI[e].actor.Unbind()};e.prototype.logEngagement=function(e){this._telemetry&&this._telemetry(a.default).logData(n.__assign(n.__assign({},this._baseEngagementData),{name:e,extraData:f.graft(this._baseEngagementData.extraData,{fieldType:this._curField.csrInfo.FieldType})}))};e.prototype.WidgetControlGridContext=function(e){return new N(e,this._objBag,this)};e.prototype.WidgetControlCellContext=function(e){var t=this,n=new C(e,this);n.NotifyExpandWidget=function(){t.NotifyExpandWidget(e)};n.NotifyCollapseWidget=function(){t.NotifyCollapseWidget(e)};n.NotifyEditComplete=function(n){n?t.NotifyWidgetEditCancel(e):t.NotifyEditCompleteInternal(n)};n.GetCurrentTd=function(){return t._curTd};return n};e.prototype.GetWidgetControlManagerAPI=function(e,t){var n=this;return new k(e,t,function(){return n.WidgetControlGridContext(e)},function(){return n.WidgetControlCellContext(e)},this)};e.prototype.EditControlGridContext=function(e){var t=this,n=new N(e,this._objBag,this);n.OnActivateActor=function(){t.OnActivateActorInternal(e)};n.OnDeactivateActor=function(){t.OnDeactivateActorInternal(e)};return n};e.prototype.EditControlCellContext=function(e){var t=this,n=new C(e,this);n.NotifyExpandControl=function(){t.NotifyExpandControl(e)};n.NotifyEditComplete=function(e){t.NotifyEditCompleteInternal(e)};n.Show=function(e,n){r.JsGridUtil.DebugAssert(null!=t._curGridPane&&null!=t._curTd,"Show edit html element only after actor has been bound to a cell.");e.style.position="absolute";r.JsGridUtil.DebugAssert(e.offsetParent==t.actorsParentNode,"Edit control element needs to be added to the parentNode sent through OnGridAttach, and positioned relative to it.");if(t._curTdRect){t._objBag.RTL.bEnabled&&(e.style.right=e.offsetParent.offsetWidth-(t._curTdRect.x+t._curTdRect.width)+1+"px");if(r.JsGridUtil.Internal.IsFeatureEnabled(d)){var i=n?0:2;e.style.left=t._curTdRect.x+i+"px";e.style.top=t._curTdRect.y+i+"px"}else{e.style.left=t._curTdRect.x+1+"px";e.style.top=t._curTdRect.y+1+"px"}e.style.visibility="inherit"}};n.Hide=function(e){t._objBag.focusMgr.ChangeTextInputElementToFocusElement()||(e.style.visibility="hidden")};n.GetCurrentRect=function(){return t._curTdRect};n.GetCurrentTd=function(){return t._curTd};return n};e.prototype.GetEditControlManagerAPI=function(e,t){var n=this;return new k(e,t,function(){return n.EditControlGridContext(e)},function(){return n.EditControlCellContext(e)},this)};e.prototype.NotifyEditCompleteInternal=function(e){if(this.IsEditing()||this._stateTransitionManager.GetCurrentEndingState()==p.Editing){this._curGridPane.useCustomSelFrames=!1;this._stateTransitionManager.HandleStateTransition(p.Bound,!0,null,[e])}else if(this.IsBound()){this.CollapseAll(null);if(!e){this.logEngagement("QuickEdit.OnCellEditBegin");this._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditBegin,r.JsGridUtil.EventArgs.CellEditBegin(this._curRecord.key(),this._curField.key));var t=this.ApplyUserUpdatedValue();this.logEngagement("QuickEdit.onCellEditCompleted");this._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditCompleted,r.JsGridUtil.EventArgs.CellEditCompleted(this._curRecord.key(),this._curField.key,t,e))}var n=r.JsGridUtil.Internal.IsFeatureEnabled(v),s=r.JsGridUtil.Internal.IsFeatureEnabled(m);if(E){if("SPUser"===this._curPropType.ID||s&&"SPDateTime"===this._curPropType.ID||"DropdownBoolean"===this._curPropType.ID||this._curPropType.ID.endsWith("_Choice")||n&&this._curPropType.ID.endsWith("_Choice_MultiValue")||this._curPropType.ID.endsWith("_Lookup")||"Hyperlink"===this._curPropType.ID&&!y||"SPUser_MultiValue"===this._curPropType.ID&&!b){this._curGridPane.useCustomSelFrames=!1;this._curGridPane.HideSelectionFrames();this.Unbind(null);this._objBag.focusMgr.Focus()}}else;}this._curActiveActorName=null};e.prototype.SetCellInfo=function(e,t){e.propType=this._curPropType;e.originalValue=this._originalValue;e.record=this._curRecord;e.column=this._curColumn;e.field=this._curField;e.fieldKey=this._curField.key;e.cellExpandSpace=this._curExpandSpace;if(t)e.cellRect=this._curTdRect;else{e.cellWidth=this._curTdRect.width-2;e.cellHeight=this._curTdRect.height-2;e.cellStyle=this._curStyle}};e.prototype.OnRegisterWidgetControl=function(e,t){var n=document.createElement("div");n.className=r.JsGridUtil.Internal.IsFeatureEnabled(d)?l.msGridWidgetCell:"jsgrid-widget-cell";n.appendChild(t.GetIcon());this._widgetIcons[e]=n;this._widgetDock.appendChild(n)};e.prototype.GetCurrentTdRect=function(){var e=null!=this._curTd.parentNode?this._curGridPane.GetTdCoordsRelativeToParentNode(this._curTd):null;return null!=e?{x:e.left,y:e.top,width:e.width,height:e.height}:null};e.prototype.GetCurrentViewportCoord=function(){return this._curGridPane.GetTableViewportRelativeToParentNode()};e.prototype.GetExpandSpace=function(e,t){return{top:e.y-t.top,right:t.right-e.x-e.width,bottom:t.bottom-e.y-e.height,left:e.x-t.left}};e.prototype.ApplyUserUpdatedValue=function(){var e,t=this,n=this.HaveNewLocalizedValue(),r=this.HaveNewDataValue();if(n||r){var i;i=n&&r?o.CreateValidatedPropertyUpdate(this._curRecord.key(),this._curField.key,this._userUpdatedValue.data,this._userUpdatedValue.localized):o.CreateUnvalidatedPropertyUpdate(this._curRecord.key(),this._curField.key,n?this._userUpdatedValue.localized:this._userUpdatedValue.data,n);this._userUpdatedValue={};e=this._fnUpdateProperties([i],"User Edit",null,function(e){t._lastChangeKey=e});this.RecalculateWidgets();this.UpdateOriginalValue(this.GetValueFromRecord())}else this._userUpdatedValue={};return e};e.prototype.HaveNewLocalizedValue=function(){var e=!1;if(this._originalValue.localized!==r.JsGridUtil.EmptyValue&&"localized"in this._userUpdatedValue){e=(null!=this._originalValue.localized?this._originalValue.localized:"")!==this._userUpdatedValue.localized}return e};e.prototype.HaveNewDataValue=function(){var e=!1;this._originalValue.data!==r.JsGridUtil.EmptyValue&&"data"in this._userUpdatedValue&&(e=!this._curField.CompareSingleDataEqual(this._userUpdatedValue.data,this._originalValue.data));return e};e.prototype.RecalculateWidgets=function(){if(this._curState>=p.Bound){var e=this._curWidgetControlsAPI.length>0&&this._curWidgetControlsAPI[0].name==i.JsGridConstants.ErrorWidgetId;if(e&&!this.errorMgr.CellHasError(this._curRecord.key(),this._curField.key)){(t=this._curWidgetControlsAPI[0]).name==this._expandedWidgetName&&this.CollapseWidget(t.name);t.actor.Unbind();this._curWidgetControlsAPI.splice(0,1);this.LayoutWidgets()&&(this._widgetIcons[t.name].style.visibility="hidden")}else if(!e&&this.TryAddErrorWidget(this._curRecord.key(),this._curField.key)){var t;(t=this._actorRegistrationManager.GetWidgetControlAPI(i.JsGridConstants.ErrorWidgetId)).SetCellInfo();t.actor.BindToCell(t.GetCellContext());this.LayoutWidgets()}}};e.prototype.UpdateOriginalValue=function(e){this._originalValue=e;this._curEditControlAPI.UpdateOriginalValue(e);for(var t in this._curWidgetControlsAPI)this._curWidgetControlsAPI[t].UpdateOriginalValue(e)};e.prototype.CreateWidgetDock=function(){var e=document.createElement("div");e.className=r.JsGridUtil.Internal.IsFeatureEnabled(d)?l.msGridWidgetDock:"jsgrid-widget-dock";e.style.display="none";this.actorsParentNode.appendChild(e);this._fnDisposeWidgetDockHandlers=r.JsGridUtil.Internal.DomElement.GetInstance().SetMouseHover(e,this.HighlightBorder.bind(this),this.ClearHighlightedWidgets.bind(this),this.HighlightWidgets.bind(this));e.addEventListener("click",this.OnClickWidgetDock.bind(this));e.addEventListener("mousedown",this.OnMouseDownWidgetDock.bind(this));return e};e.prototype.OnClickWidgetDock=function(e){if(e.button==i.JsGridConstants.MouseButton.leftButton)for(var t=r.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=0;n<this._curWidgetControlsAPI.length;n++){var s=this._widgetIcons[this._curWidgetControlsAPI[n].name];if(r.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(t.x,t.y,s,null)){r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);this._expandedWidgetName!==this._curWidgetControlsAPI[n].name?this.ExpandWidgetInternal(this._curWidgetControlsAPI[n].actor):this.CollapseWidget(this._expandedWidgetName);break}}};e.prototype.OnCellSelectExpandWidget=function(){for(var e=0;e<this._curWidgetControlsAPI.length;e++)this._expandedWidgetName!==this._curWidgetControlsAPI[e].name?this.ExpandWidgetInternal(this._curWidgetControlsAPI[e].actor):this.CollapseWidget(this._expandedWidgetName)};e.prototype.OnMouseDownWidgetDock=function(e){e.stopPropagation()};e.prototype.HighlightBorder=function(){this._widgetDock.style.borderColor=null!=this._objBag.styleMgr.widgetDockHoverStyle.borderColor?this._objBag.styleMgr.widgetDockHoverStyle.borderColor:"#768290"};e.prototype.ClearHighlightedWidgets=function(){null==this._expandedWidgetName&&(this._widgetDock.style.borderColor=null!=this._objBag.styleMgr.widgetDockStyle.borderColor?this._objBag.styleMgr.widgetDockStyle.borderColor:"");for(var e=0;e<this._curWidgetControlsAPI.length;e++)this._curWidgetControlsAPI[e].name!==this._expandedWidgetName&&(this._widgetIcons[this._curWidgetControlsAPI[e].name].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockStyle.backgroundColor?this._objBag.styleMgr.widgetDockStyle.backgroundColor:"");this._highlightedWidgetName=null};e.prototype.HighlightWidgets=function(e){for(var t=r.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=0;n<this._curWidgetControlsAPI.length;n++){var i=this._widgetIcons[this._curWidgetControlsAPI[n].name];if(r.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(t.x,t.y,i,null)){if(this._highlightedWidgetName!==this._curWidgetControlsAPI[n].name){null!=this._highlightedWidgetName&&this._highlightedWidgetName!==this._expandedWidgetName&&(this._widgetIcons[this._highlightedWidgetName].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockStyle.backgroundColor?this._objBag.styleMgr.widgetDockStyle.backgroundColor:"");this._highlightedWidgetName=this._curWidgetControlsAPI[n].name;this._curWidgetControlsAPI[n].name!==this._expandedWidgetName&&(i.style.backgroundColor=null!=this._objBag.styleMgr.widgetDockHoverStyle.backgroundColor?this._objBag.styleMgr.widgetDockHoverStyle.backgroundColor:"#C4C9CF")}break}}};e.prototype.LayoutWidgets=function(){if(null!=this._curTdRect&&null!=this._curPaneRect){var e=this._curTdRect,t=this._curPaneRect;if(this._curWidgetControlsAPI.length>0)if(r.JsGridUtil.Internal.IsFeatureEnabled(d)&&!r.JsGridUtil._errorWidgetInstantOpenKillSwitchIsActive&&this._curWidgetControlsAPI[0].name===i.JsGridConstants.ErrorWidgetId)this.OnCellSelectExpandWidget();else{for(var n=20*this._curWidgetControlsAPI.length,s=this._objBag.RTL.bEnabled?e.x-(n+2)>=t.left:e.x+e.width+5+(n+2)>t.right,o=e.y+Math.floor((e.height-22)/2),u=s?e.x-(n+2+5):e.x+5+e.width,a=0;a<this._curWidgetControlsAPI.length;a++){var f=this._widgetIcons[this._curWidgetControlsAPI[a].name];f.style.left=20*a+"px";f.style.visibility=""}this._widgetDock.style.top=o+"px";this._widgetDock.style.left=u+"px";this._widgetDock.style.width=n+"px";this._widgetDock.style.display="block"}else this._widgetDock.style.display="none";return!0}return!1};e.prototype.GetValueFromRecord=function(){return this._curField&&this._fnGetCellValue(this._curRecord,this._curField.key,this._curPropType)};e.prototype.TryAddErrorWidget=function(e,t){var n=!1;if(this.errorMgr.CellHasError(e,t)){this._curWidgetControlsAPI.unshift(this._actorRegistrationManager.RegisterWidgetControl(i.JsGridConstants.ErrorWidgetId));n=!0}return n};e.prototype.ExpandActor=function(e){return this._actorRegistrationManager.IsActorWidget(e.name)?this.ExpandWidgetInternal(e.actor):this.ExpandControlInternal(e.actor)};e.prototype.PrepareForExpandWidget=function(e){this._valueBeforeWidgetEdit=this._updatedValue;this.CollapseAll(e);null!=this._expandedWidgetName&&this._expandedWidgetName!==e&&(this._widgetIcons[this._expandedWidgetName].style.backgroundColor="");this._widgetIcons[e].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockPressedStyle.backgroundColor?this._objBag.styleMgr.widgetDockPressedStyle.backgroundColor:"#8C8F93";null!=this._objBag.styleMgr.widgetDockPressedStyle.borderColor&&(this._widgetIcons[e].style.borderColor=this._objBag.styleMgr.widgetDockPressedStyle.borderColor);this._expandedWidgetName=this._lastExpandedActorName=e};e.prototype.CollapseWidget=function(e){this.ClearExpandedWidget(e);this._actorRegistrationManager.GetWidgetControlAPI(e).actor.Collapse()};e.prototype.ClearExpandedWidget=function(e){if(e==this._expandedWidgetName){this._widgetIcons[e].style.backgroundColor=null!=this._objBag.styleMgr.widgetDockStyle.backgroundColor?this._objBag.styleMgr.widgetDockStyle.backgroundColor:"";null!=this._objBag.styleMgr.widgetDockStyle.borderColor&&(this._widgetIcons[e].style.borderColor=this._objBag.styleMgr.widgetDockStyle.borderColor);this._expandedWidgetName=null}};e.prototype.ExpandWidgetInternal=function(e){if(null!=e.Expand){e.Expand();return!0}return!1};e.prototype.PrepareForExpandControl=function(e){this.CollapseAll(e);this._lastExpandedActorName=e};e.prototype.ExpandControlInternal=function(e){if(null!=e.Expand){e.Expand();return!0}return!1};e.prototype.CollapseAll=function(e){for(var t=0;t<this._curWidgetControlsAPI.length;t++)this._curWidgetControlsAPI[t].name!==e&&this.CollapseWidget(this._curWidgetControlsAPI[t].name);null!=this._curEditControlAPI.actor.Collapse&&this._curEditControlAPI.name!==e&&this._curEditControlAPI.actor.Collapse()};e.prototype.SetCurrentValueInternal=function(e,t,n){this._userUpdatedValue={};if("localized"in e&&e.localized!==r.JsGridUtil.EmptyValue){this._updatedValue.localized=e.localized;t==i.JsGridConstants.EditActorUpdateType.Uncommitted&&(this._userUpdatedValue.localized=e.localized)}if("data"in e&&e.data!==r.JsGridUtil.EmptyValue){this._updatedValue.data=e.data;t==i.JsGridConstants.EditActorUpdateType.Uncommitted&&(this._userUpdatedValue.data=e.data)}if(null!=this._curActorsAPI)for(var s=0;s<this._curActorsAPI.length;s++)n!==this._curActorsAPI[s].name&&this._curActorsAPI[s].actor.OnValueChanged&&this._curActorsAPI[s].actor.OnValueChanged(this._updatedValue,t)};e.prototype.OnActivateActorInternal=function(e){this.TrackActiveActor(!0,e)};e.prototype.OnDeactivateActorInternal=function(e){var t=this;setTimeout(function(){t.TrackActiveActor(!1,e)},0)};e.prototype.TrackActiveActor=function(e,t){e||null==this._curActiveActorName||t!=this._curActiveActorName?e&&(this._curActiveActorName=t):this.StopEditing(!1)};e.prototype.Unbind=function(e){this._stateTransitionManager.HandleStateTransition(p.Inited,!0,e,null)};e.prototype.StopEditing=function(e){var t=this._actorRegistrationManager.GetActorAPI(this._curActiveActorName)||this._curEditControlAPI;if(null!=t){t.NotifyEditComplete(e);r.JsGridUtil.Internal.IsFeatureEnabled(d)&&this._curGridPane&&this._curGridPane.selectionDragHandle.classList.remove(c.editorIsActive)}};e.prototype.BindToCell=function(e,t,n,r,i,s,o,u){this._stateTransitionManager.HandleStateTransition(p.Bound,!1,u,[e,t,n,r,i,s,o])};e.prototype.BeginEdit=function(e,t){this._isInQuickEditMode="keypress"==e.type;this._stateTransitionManager.HandleStateTransition(p.Editing,!1,t,[e]);r.JsGridUtil.Internal.IsFeatureEnabled(d)&&this._curGridPane.selectionDragHandle.classList.add(c.editorIsActive)};e.prototype.IsBoundToCell=function(e,t,n){return this._curState>=p.Bound&&this._curGridPane==e&&this._curRecord.key()==t&&this._curField.key==n};e.prototype.IsBound=function(){return this._curState>=p.Bound};e.prototype.IsEditing=function(){return this._curState>=p.Editing};e.prototype.NotifyMove=function(e){if(!this._objBag.jsGridObj.paneMgr.gridPane.dontReflow&&(null==e||e===this._curGridPane)&&this._curState>=p.Bound){var t=this._curGridPane.GetFocusedCell(),n=t&&t.GetTd();if(null!=n&&null!=this._curTd&&this._curRecord.key()==t.GetRecordKey()&&this._curField.key==t.GetFieldKey()){this._curTd=n;this._curTdRect=this.GetCurrentTdRect();if(null!=this._curTdRect){this._curPaneRect=this.GetCurrentViewportCoord();this._curExpandSpace=this.GetExpandSpace(this._curTdRect,this._curPaneRect);this._curEditControlAPI.SetCellInfo();this._curEditControlAPI.actor.OnCellMove();for(var r=0;r<this._curWidgetControlsAPI.length;r++){this.CollapseWidget(this._curWidgetControlsAPI[r].name);this._curWidgetControlsAPI[r].SetCellInfo()}this.LayoutWidgets()}}else null==n&&null!=this._curTd&&this.Unbind(null)}};e.prototype.NotifyUpdateProperty=function(e,t,n,r,s){if(this.IsBoundToCell(e,t,n)){var o={};r.HasDataValue()&&(o.data=r.data);r.HasLocalizedValue()&&(o.localized=r.localized);this.UpdateOriginalValue(o);(null==this._lastChangeKey||null!=s&&0!==s.CompareTo(this._lastChangeKey))&&this.SetCurrentValueInternal(o,i.JsGridConstants.EditActorUpdateType.Committed,null)}};e.prototype.ExpandWidget=function(e){var t=r.JsGridUtil.Internal.FindInArray(this._curWidgetControlsAPI,function(t){return t.name==e});null!=t&&this.ExpandWidgetInternal(this._curWidgetControlsAPI[t].actor)};e.prototype.ExpandNextActor=function(){var e=this;if(this._curState>=p.Bound&&(null!=this._curEditControlAPI.actor.Expand||this._curWidgetControlsAPI.length)){var t=(function(t){if(0==e._curActorsAPI.length||null==e._curActorsAPI[0].actor.Expand&&1==e._curActorsAPI.length)return null;var n,r=null!=e._curActorsAPI[0].actor.Expand?0:1;if(null==e._lastExpandedActorName)n=e._curActorsAPI[r];else for(var i=r;i<e._curActorsAPI.length;i++)if(e._curActorsAPI[i].name==e._lastExpandedActorName){n=t?i==e._curActorsAPI.length-1?e._curActorsAPI[r]:e._curActorsAPI[i+1]:i==r?e._curActorsAPI[e._curActorsAPI.length-1]:e._curActorsAPI[i-1];break}return n})(!0);r.JsGridUtil.DebugAssert(null!=t&&null!=t.actor.Expand);return this.ExpandActor(t)}return!1};e.prototype.NotifyExpandWidget=function(e){this.OnActivateActorInternal(e);this.PrepareForExpandWidget(e)};e.prototype.NotifyCollapseWidget=function(e){this.OnDeactivateActorInternal(e);this.ClearExpandedWidget(e)};e.prototype.NotifyWidgetEditCancel=function(e){this._updatedValue=this._valueBeforeWidgetEdit;this._curActiveActorName=null;this.CollapseWidget(e);this.IsEditing()?this._curEditControlAPI.actor.Focus():this._objBag.focusMgr.Focus()};e.prototype.NotifyExpandControl=function(e){this.PrepareForExpandControl(e)};e.prototype.SetCurrentValue=function(e,t){this.SetCurrentValueInternal(t,i.JsGridConstants.EditActorUpdateType.Uncommitted,e)};e.prototype.OnActorKeyDown=function(e,t){var n=this;r.JsGridUtil.DebugAssert(this._curState>=p.Bound);if((function(){var t=!1;if(e.keyCode==i.JsGridConstants.Key.tab||e.keyCode==i.JsGridConstants.Key.enter){n.StopEditing(!1);(!r.JsGridUtil.Internal.IsFeatureEnabled(h)&&e.keyCode==i.JsGridConstants.Key.enter||r.JsGridUtil.Internal.IsFeatureEnabled(h)&&e.keyCode==i.JsGridConstants.Key.enter&&n._curRecord.bIsNewRow||e.keyCode==i.JsGridConstants.Key.tab)&&n._objBag.focusMgr.HandleKeyDown(e,!1,!0);t=!0}else if(e.keyCode==i.JsGridConstants.Key.esc){n.StopEditing(!0);g||w&&n.StopEditing(!0);t=!0}return t})())r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);else if(this._curState==p.Bound&&t==this._curEditControlAPI.name)this.BeginEdit(e,null);else{var s=!1,o=t==this._curEditControlAPI.name?this._curEditControlAPI:this._actorRegistrationManager.GetWidgetControlAPI(t);null!=o&&null!=o.actor&&null!=o.actor.OnKeyDown&&(e.StopInfiniteKeyDownLoop||(s=o.actor.OnKeyDown(e)));var u=this._isInQuickEditMode||null==o||o.IsLightFocus();!s&&u&&this._objBag.focusMgr.HandleKeyDown(e,!0)&&null!=this._curActiveActorName&&this._curActiveActorName==t&&this.StopEditing(!1)}};e.prototype.GetCurrentEditControlName=function(){return this._curEditControlAPI.name};e.prototype.IsCurrentEditControlUsingGridTextInputElement=function(){return this._curEditControlAPI.actor.IsCurrentlyUsingGridTextInputElement()};e.prototype.Dispose=function(){var e=this;this.Unbind(function(){e._actorRegistrationManager.Dispose();null!=e._fnDisposeWidgetDockHandlers&&e._fnDisposeWidgetDockHandlers();r.JsGridUtil.ClearEventListeners(e._widgetDock);e._widgetDock.innerHTML="";e._widgetDock=null})};return e})();t.EditManager=S;var x=function(e,t){this.fn=e;this.bArgsRequired=t},T=(function(){function e(e){this.rawStateMap=[[p.Inited,{promote:new x(this.ProcessBind.bind(this),!0)}],[p.Bound,{demote:new x(this.ProcessUnbind.bind(this),!1),promote:new x(this.ProcessBeginEdit.bind(this),!0)}],[p.Editing,{demote:new x(this.ProcessStopEdit.bind(this),!1)}]];this.stateMap=r.JsGridUtil.Internal.ConvertTableToMap(this.rawStateMap,"0","1");this._stateQueue=[];this.emptyArgs=[];this._editMgr=e}e.prototype.ProcessUnbind=function(){for(var e=0;e<this._editMgr._curWidgetControlsAPI.length;e++)this._editMgr.CollapseWidget(this._editMgr._curWidgetControlsAPI[e].name);this._editMgr._widgetDock.style.display="none";for(e=0;e<this._editMgr._widgetDock.childNodes.length;e++)this._editMgr._widgetDock.childNodes[e].style.visibility="hidden";this._editMgr._lastExpandedActorName=null;for(e=0;e<this._editMgr._curActorsAPI.length;e++)this._editMgr._curActorsAPI[e].actor.Unbind();this._editMgr._curRecord=null;this._editMgr._curColumn=null;this._editMgr._curField=null;this._editMgr._curGridPane=null;this._editMgr._curActorsAPI=null;this._editMgr._curEditControlAPI=null;this._editMgr._curWidgetControlsAPI=null;this._editMgr._curPropType=null;this._editMgr._curTd=null;this._editMgr._curTdRect=null;this._editMgr._curExpandSpace=null;this._editMgr._curPaneRect=null;this._editMgr._curStyle=null;this._editMgr._curActiveActorName=null;this._editMgr._updatedValue={};this._editMgr._userUpdatedValue={};this._editMgr._originalValue=null;this._editMgr._lastExpandedActorName=null};e.prototype.ProcessStopEdit=function(e){var t;this._editMgr._curEditControlAPI.actor.OnEndEdit();this._editMgr.CollapseAll();e||(t=this._editMgr.ApplyUserUpdatedValue());this._editMgr._isInQuickEditMode=!1;this._editMgr._updatedValue={};this._editMgr._userUpdatedValue={};this._editMgr._objBag.focusMgr.Focus();this._editMgr.logEngagement("QuickEdit.onCellEditCompleted");this._editMgr._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditCompleted,r.JsGridUtil.EventArgs.CellEditCompleted(this._editMgr._curRecord.key(),this._editMgr._curField.key,t,e))};e.prototype.ProcessBind=function(e,t,n,r,i,s,o,u){this._editMgr._curRecord=t;this._editMgr._curColumn=n;this._editMgr._curField=i[r];this._editMgr._curGridPane=e;this._editMgr._curPropType=null!=t.GetProp(r)?t.GetProp(r).propType:i[r].GetPropType();this._editMgr._originalValue=this._editMgr.GetValueFromRecord();this._editMgr._curActorsAPI=this._editMgr._actorRegistrationManager.GetEditAndWidgetControlsAPI(this._editMgr._curRecord,this._editMgr._curColumn,this._editMgr._curField.key,this._editMgr._curPropType);this._editMgr._curEditControlAPI=this._editMgr._curActorsAPI.editControlAPI;this._editMgr._curWidgetControlsAPI=this._editMgr._curActorsAPI.widgetControlsAPI;this._editMgr.TryAddErrorWidget(t.key(),r);this._editMgr._curActorsAPI=[this._editMgr._curEditControlAPI].concat(this._editMgr._curWidgetControlsAPI);this._editMgr._updatedValue={};this._editMgr._userUpdatedValue={};null!=s&&(this._editMgr._curTd=s.GetTd());null!=o&&(this._editMgr._curStyle=o);this._editMgr._curTdRect=this._editMgr.GetCurrentTdRect();this._editMgr._curPaneRect=this._editMgr.GetCurrentViewportCoord();this._editMgr._curExpandSpace=this._editMgr.GetExpandSpace(this._editMgr._curTdRect,this._editMgr._curPaneRect);this._editMgr._curEditControlAPI.SetCellInfo();this._editMgr._curEditControlAPI.actor.BindToCell(this._editMgr._curEditControlAPI.GetCellContext());for(var a in this._editMgr._curWidgetControlsAPI){this._editMgr._curWidgetControlsAPI[a].SetCellInfo();this._editMgr._curWidgetControlsAPI[a].actor.BindToCell(this._editMgr._curWidgetControlsAPI[a].GetCellContext())}this._editMgr.LayoutWidgets()};e.prototype.ProcessBeginEdit=function(e){this._editMgr._curActiveActorName=r.JsGridUtil.EmptyValue;this._editMgr.UpdateOriginalValue(this._editMgr.GetValueFromRecord());this._editMgr.logEngagement("QuickEdit.OnCellEditBegin");this._editMgr._objBag.eventMgr.FireEvent(i.JsGridConstants.EventType.OnCellEditBegin,r.JsGridUtil.EventArgs.CellEditBegin(this._editMgr._curRecord.key(),this._editMgr._curField.key));this._editMgr._curEditControlAPI.actor.OnBeginEdit(e);null==this._editMgr._curEditControlAPI.actor.OnKeyDown||"keypress"!=e.type&&"keydown"!=e.type||this._editMgr._curEditControlAPI.actor.OnKeyDown(e)};e.prototype.HandleStateTransition=function(e,t,n,i){var s=this,o=this.GetCurrentEndingState();if(t&&o<=e||!t&&o>=e)(function(e,t,n){for(var i=0;i<s._stateQueue.length;i++)if(s._stateQueue[i]==e){null!=t&&s._stateQueue[i].callbacks.push(t);r.JsGridUtil.DebugAssert(!s.stateMap[e].bArgsRequired||null==n);null!=n&&(s._stateQueue[i].args=n);return}null!=t&&t()})(e,n,i);else{for(var u=Math.abs(o-e),a=1;a<=u;a++){var f=o+a*(t?-1:1),l=1==a&&null!=i?i:this.emptyArgs,c=null!=n&&u==a?[n]:this.emptyArgs;r.JsGridUtil.DebugAssert(!this.stateMap[f].bArgsRequired||l==this.emptyArgs);this._stateQueue.unshift({newState:f,args:l,callbacks:c})}this._stateQueue.length==u&&(function(){for(;s._stateQueue.length>0;){var e=s._stateQueue[s._stateQueue.length-1];(s._editMgr._curState<e.newState?s.stateMap[s._editMgr._curState].promote.fn:s.stateMap[s._editMgr._curState].demote.fn).apply(null,e.args);s._editMgr._curState=e.newState;s._stateQueue.pop();for(var t=0;t<e.callbacks.length;t++)e.callbacks[t]()}})()}};e.prototype.GetCurrentEndingState=function(){return this._stateQueue.length>0?this._stateQueue[0].newState:this._editMgr._curState};return e})(),N=function(e,t,n){this.jsGridObj=t.jsGridObj;this.gridId=t.jsGridParams.gridId;this.parentNode=n.actorsParentNode;this.styleManager=t.styleMgr;this.RTL=t.RTL;this.emptyValue=r.JsGridUtil.EmptyValue;this.bLightFocus=!1;this.peoplePickerDataSource=t.jsGridParams.peoplePickerDataSource;this.portalManager=t.jsGridParams.portalManager;this.locationDataSource=t.jsGridParams.locationDataSource;this.taxonomyPickerDataSource=t.jsGridParams.taxonomyDataSource;this.pageContext=t.jsGridParams.pageContext;this.editMgr=n;this.OnKeyDown=function(t){n.OnActorKeyDown(t,e)}};t.EditActorGridContext=N;var C=(function(){function e(e,t){this._name=e;this._editMgr=t}e.prototype.SetCurrentValue=function(e){this._editMgr.SetCurrentValue(this._name,e)};return e})(),k=function(e,t,n,r,i){var s=this;this._gridContext=n();this._cellContext=r();this.name=e;this.actor=t;this.SetCellInfo=function(){i.SetCellInfo(s._cellContext,i._actorRegistrationManager.IsActorWidget(s.name))};this.UpdateOriginalValue=function(e){s._cellContext.originalValue=e};this.IsLightFocus=function(){return s._gridContext.bLightFocus};this.NotifyEditComplete=function(e){s._cellContext.NotifyEditComplete(e)};this.GetGridContext=function(){return s._gridContext};this.GetCellContext=function(){return s._cellContext}};t.EditActorManagerAPI=k});
define("jWe",["require","exports","ww","r","jR","ODBItemsScopeDeferred_mini_css","VWe"],function(e,t,n,r,i,s,o){"use strict";s=s.CheckboxEditor_0;Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onChange=function(e,t){n.props.onValueChange(t?"1":"0");n.setState({value:t})};n.state={value:"1"===t.value||"Yes"===t.value||"true"===t.value};n._inputRef=r.createRef();return n}t.prototype.componentDidMount=function(){this._inputRef&&this._inputRef.current.focus()};t.prototype.render=function(){return r.createElement("div",{style:{height:this.props.height,width:this.props.width}},r.createElement(i.Checkbox,{checked:this.state.value,inputProps:{onKeyDown:this.props.onEditorKeyDown},onChange:this._onChange,className:s.checkBox,ariaLabel:this.state.value?o.default.onAriaLabel:o.default.offAriaLabel,componentRef:this._inputRef}))};return t})(r.PureComponent);t.CheckboxEditor=u});
define("lqe",["require","exports","ww","r","Dqe","Mhe","ld","k","q3","Lqe"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=u.Killswitch.isActivated("DC101D81-F3CE-4E97-8A0D-BA3985B448FC","12/03/2019","Fix an issue with multiple-choice lookup fields."),c=o.getTheme(),h=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s._isActive=!0;s.OnPendingValueUpdated=function(e,t,n){n&&s.setState({pendingValue:{data:n,localized:n}})};s.OnValueChanged=function(e,t,r,i){if(s._isActive){var o={data:[],localized:""};if(s.props.multiSelect){var u=[];if(s.props.allowFreeform&&i){o={data:n.__spreadArrays(s.state.value.data,[i]),localized:s.state.value.localized+";"+i};u.push({key:i,text:i})}else{if(t.selected){if(null!==t.key)if(s.state.value.data||l){for(var a=0;a<s.state.value.data.length;a++)o.data.push(s.state.value.data[a]);o.data.push(t.key)}else o.data.push(t.key)}else for(a=0;a<s.state.value.data.length;a++)s.state.value.data[a]!==t.key&&o.data.push(s.state.value.data[a]);for(a=0;a<o.data.length;a++)if(l)o.localized+=o.data[a]+";";else for(var f=0;f<s.state.options.length;f++)s.state.options[f].key==o.data[a]&&(o.localized+=s.state.options[f].text+";");o.localized=o.localized.substr(0,o.localized.length-1)}s.props.gridOnChange(o);s.setState({value:o,pendingValue:o,options:n.__spreadArrays(s.state.options,u)})}else{s.props.allowFreeform?i?o={data:i,localized:i}:t&&(o={data:t.key,localized:t.text}):o={data:t.key,localized:t.text};if(o){s.props.gridOnChange(o);s.setState({value:o,pendingValue:o})}}}};s.OnRegisteredKeyEvent=function(e){e.keyCode==i.JsGridConstants.Key.space&&s.Expand()};s.Expand=function(){s._comboxBoxRef.current&&s._comboxBoxRef.current.focus(!0,!0)};s.Dismiss=function(){s._comboxBoxRef.current&&s._comboxBoxRef.current.dismissMenu()};s._fixedEditorPadding=56;s._editorLetterSize=6.5;s.state={options:s.props.gridOptions,value:s.props.gridValue,pendingValue:s.props.gridValue};s._containerRef=r.createRef();s._comboxBoxRef=r.createRef();s.props.registerForKeyEvents&&s.props.registerForKeyEvents(s);return s}t.prototype.componentWillUnmount=function(){this.state.pendingValue!==this.state.value&&this.props.gridOnChange(this.state.pendingValue);this._isActive=!1};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({value:e.gridValue,pendingValue:e.gridValue})};t.prototype.componentDidMount=function(){this._fixEditorWidth()};t.prototype.componentDidUpdate=function(){this._fixEditorWidth()};t.prototype.render=function(){var e=this.state.value.data,t={root:{borderWidth:0,marginBottom:0},divider:{borderWidth:0,borderBottomWidth:1,borderColor:c.palette.neutralTertiary}};a.default.isFeatureEnabled({ODB:1725})&&(t.root.zIndex=i.JsGridConstants.Internal.zIndex.editor);return r.createElement("div",{ref:this._containerRef},r.createElement(s.ComboBox,n.__assign({},this.props,{options:this.state.options,styles:t,componentRef:this._comboxBoxRef,text:this.state.value.localized,onChange:this.OnValueChanged,onPendingValueChanged:this.OnPendingValueUpdated,selectedKey:e})))};t.prototype._fixEditorWidth=function(){if(this._isActive){if(this.state&&this.state.value&&this.state.value.localized&&this._containerRef&&this._containerRef.current){var e=this._containerRef.current.clientWidth,t=this._fixedEditorPadding+this._editorLetterSize*this.state.value.localized.length,n=0;this.state.pendingValue&&this.state.pendingValue.localized&&(n=this._fixedEditorPadding+this._editorLetterSize*this.state.pendingValue.localized.length);this._containerRef.current.style.width=Math.max(e,Math.max(n,t)).toString()+"px"}if(f.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this._containerRef&&this._containerRef.current&&this._containerRef.current.children&&this._containerRef.current.children.length>0&&this._containerRef.current.children[0]&&this._containerRef.current.children[0].children&&this._containerRef.current.children[0].children.length>0&&this.props.setSelectionFrame(this._containerRef.current.children[0].children[0]);else if(this.props.positionGridSelectionFrame){var r=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(r)}}};return t})(r.PureComponent);t.ChoiceEditor=h});
define("sqe",["require","exports","ww","r","qHe","aRe","nRe","mH","od","Dqe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";l=l.ChoicePill_6;Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.onKeyUpFired=function(e){e.which===f.JsGridConstants.Key.backspace&&t.props.onClick(e,t.props.option)};t.computeTabIndex=function(){return"Well-"+t.props.currentWellIndex===t.props.pillDivId?0:-1};t.onKeyDownEventFired=function(e){var n,r=t.props.allowFillInText;switch(e.which){case f.JsGridConstants.Key.left:t.props.updateWellIndex(f.JsGridConstants.Key.left,!0);break;case f.JsGridConstants.Key.right:t.props.updateWellIndex(f.JsGridConstants.Key.right,!0);break;case f.JsGridConstants.Key.enter:t.props.onClick(e,t.props.option);break;case f.JsGridConstants.Key.del:e.preventDefault();t.props.onClick(e,t.props.option);break;case f.JsGridConstants.Key.down:(n=document.getElementById(f.JsGridConstants.TextFieldIdInModernChoiceEditor)).focus();t.props.updateFlyoutIndexToANumber(t.props.fillInTextFromWell.length>0&&r?-1:0);t.props.updateWellIndexToANumber(t.props.selectedOptions.length);break;case f.JsGridConstants.Key.tab:e.preventDefault();(n=document.getElementById(f.JsGridConstants.TextFieldIdInModernChoiceEditor)).focus();var i=t.props.fillInTextFromWell?t.props.fillInTextFromWell.length:0;t.props.fillInTextFromWell&&i>0&&n.setSelectionRange(i,i);t.props.updateFlyoutIndexToANumber(t.props.fillInTextFromWell.length>0&&r?-1:0);t.props.updateWellIndexToANumber(t.props.selectedOptions.length);break;case f.JsGridConstants.Key.esc:t.props.onCancelHandlerOfCommonCalloutEditor(e)}};t.onClickChoice=function(e){t.props.onClick(e,t.props.option)};return t}t.prototype.render=function(){var e=this.props,t=e.currentFieldName,n=e.fieldType,u=e.valueToDisplay,f=e.rowSchema,c=e.rowData,h=e.customClassName,p=e.pillDivId,d=e.ariaRole,v="MultiChoice"===n?[u]:u,m=this.changeFieldTypeForMultiChoice(f),g=this.props.showDeleteButton&&s.overridePillFormatterForDeleteButton(o.getCustomFormatterProps(m,this.props.currentFieldName)),y=void 0===m||m.length>0&&void 0===m[0].customFormatter;return r.createElement("div",{onKeyUp:this.onKeyUpFired,onKeyDown:this.onKeyDownEventFired,id:p,tabIndex:this.computeTabIndex(),className:h,onClick:this.onClickChoice,role:d||"button"},y?r.createElement("div",{className:l.innerPillPlainText},this.props.option.key,this.props.showDeleteButton&&r.createElement(a.FontIcon,{iconName:"Cancel",className:l.iconClass})):r.createElement(i.CustomFieldRenderer,{rowSchema:m,rowData:c,currentFieldName:t,currentValueOverride:v,formatterOverride:g}))};t.prototype.changeFieldTypeForMultiChoice=function(e){var t=JSON.parse(JSON.stringify(e));if(t&&t.length>0)for(var n=0;n<t.length;n++)"MultiChoice"!==t[n].fieldType&&"Choice"!==t[n].fieldType||(t[n].fieldType=u.ColumnFieldType.Choice);return t};return t})(r.Component);t.ChoicePill=c});
define("cqe",["require","exports","ww","r","Wf","sqe","ODBItemsScopeDeferred_mini_css","Che","pc","MA","dqe","Dqe","Lqe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";o=o.ChoicePill_6;Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.handleClick=function(e,n){n.selected=!0;t.props.saveSelectedOptions(n,!0);t.props.onValueChanged(e,n);t.props.clearTextFieldValue();"Choice"===t.props.fieldType&&t.props.goBackToSelectMode()};t.onSaveHandler=function(e){t.props.onSave(e)};t.onCancelHandler=function(e){t.props.setIsXButtonClickedValue();t.props.onCancel(e)};t.isFocusOnTextFieldOrGridOrFlyoutCallout=function(){var e=document.getElementById(c.JsGridConstants.TextFieldIdInModernChoiceEditor),t=document.activeElement;return!!(e&&t===e||-1!==t.id.indexOf("spgridcontainer")||-1!==t.id.indexOf(c.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout))};t.onClickFillInDiv=function(e){var n=t.props.fillInTextFromWell,r={key:n,text:n};t.handleClick(e,r)};t.isOptionPresentInCallout=function(e,t){for(var n=0;n<t.length;n++){if(t[n].key===e)return!0}return!1};return t}t.prototype.render=function(){var e=this,t=this.props,a=t.rowData,p=t.rowSchema,d=t.currentFieldName,v=t.fieldType,m=t.options,g=t.targetElement,y=t.theme,b=t.cellWidth,w=t.fillInTextFromWell,E=t.allowFillInText,S=t.currentFlyoutIndex,x=t.currentWellIndex,T=t.updateWellIndex,N=t.currentTabCount,C=t.onCancelHandlerOfCommonCalloutEditor,k=[c.JsGridConstants.IdOfCalloutInWellOfModernChoiceEditor,"spgridcontainer_"+h.JsGridUtil.privateWpq,c.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout],L={onSave:this.onSaveHandler,onCancel:"MultiChoice"===v?this.onCancelHandler:void 0,styles:{root:{width:b},calloutMain:{padding:"0 8px 8px 8px"}},gapSpace:4,target:g,isBeakVisible:!1,directionalHint:i.DirectionalHint.bottomLeftEdge,theme:y,doNotLayer:!1,buttonsContainerClassName:o.flyOutButtonsContainer,lightDismissElementsFilter:k,calloutId:c.JsGridConstants.IdOfCalloutInFlyoutOfCommonEditorCallout},A=void 0,O=S;if(void 0!==w&&0!==w.length)if(E){if(this.isOptionPresentInCallout(w,this.props.selectedOptions)){A=r.createElement(f.Label,{className:o.fillInLabel},l.default.OptionAlreadyAdded);-1===S&&(O=0)}else{this.isOptionPresentInCallout(w,this.props.options)?-1===S&&(O=0):A=r.createElement("div",{onClick:this.onClickFillInDiv,className:-1===S?o.fillInWrapperDivWithBackground:o.fillInWrapperDiv},r.createElement(f.Label,{className:o.fillInLabel},l.default.AddFillInTextPrefix),r.createElement("div",{className:o.fillInPillDiv},w))}}else 0===m.length&&(A=r.createElement(f.Label,{className:o.fillInLabel},l.default.NoMatchingResults));return r.createElement(u.CommonEditorCallout,n.__assign({},L),r.createElement("div",{role:"listbox"},A,m.map(function(t,n){return r.createElement(s.ChoicePill,{option:t,onClick:e.handleClick,valueToDisplay:t.key,rowData:a,rowSchema:p,currentFieldName:d,customClassName:N%3==0&&n===O&&e.isFocusOnTextFieldOrGridOrFlyoutCallout()?o.pillWithHoverByDefault:o.pill,fieldType:v,pillDivId:"Flyout-"+n,updateWellIndex:T,updateFlyoutIndexToANumber:e.props.updateFlyoutIndexToANumber,updateWellIndexToANumber:e.props.updateWellIndexToANumber,selectedOptions:e.props.selectedOptions,fillInTextFromWell:e.props.fillInTextFromWell,currentWellIndex:x,allowFillInText:E,onCancelHandlerOfCommonCalloutEditor:C,ariaRole:"option"})})))};return t})(r.Component);t.Flyout=a.styled(p,function(){return{}})});
define("iqe",["require","exports","ww","r","Dqe","k","cqe","oqe","Lqe","ODBItemsScopeDeferred_mini_css","Ohe"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";f=f.ChoicePill_6;Object.defineProperty(t,"__esModule",{value:!0});var c=s.Killswitch.isActivated("DC101D81-F3CE-4E97-8A0D-BA3985B448FC","12/03/2019","Fix an issue with multiple-choice lookup fields."),h=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s.handleScroll=function(e){if(!s.scrollEventTriggered){s.scrollEventTriggered=!0;s.onSaveHandlerOfCommonCalloutEditor(e)}};s.onSaveHandlerOfCommonCalloutEditor=function(e){s.props.onSave(e)};s.onCancelHandlerOfCommonCalloutEditor=function(e){s._setIsXButtonClickedValue();s.props.onCancel(e)};s.resetCurrentTabCount=function(){s.setState({currentTabCount:0},function(){var e=document.getElementById(l.IdOfAcceptButtonInCommonEditorCallout);e&&e.classList.remove(f.buttonBorderFocused);var t=document.getElementById(l.IdOfCancelButtonInCommonEditorCallout);t&&t.classList.remove(f.buttonBorderFocused)})};s.incrementCurrentTabCount=function(){var e=document.getElementById(l.IdOfAcceptButtonInCommonEditorCallout),t=document.getElementById(l.IdOfCancelButtonInCommonEditorCallout);s.setState(function(e,t){return{currentTabCount:e.currentTabCount+1}},function(){switch(s.state.currentTabCount%3){case 0:t&&t.classList.remove(f.buttonBorderFocused);break;case 1:e&&e.classList.add(f.buttonBorderFocused);break;case 2:t&&t.classList.add(f.buttonBorderFocused);e&&e.classList.remove(f.buttonBorderFocused)}})};s.updateWellIndex=function(e,t){switch(e){case i.JsGridConstants.Key.left:s.setState(function(t,n){return{currentWellIndex:s.computeNewWellIndex(e,t.currentWellIndex,t.selectedOptions)}},function(){if(t){var e=document.getElementById("Well-"+s.state.currentWellIndex);e&&e.focus()}});break;case i.JsGridConstants.Key.right:s.setState(function(t,n){return{currentWellIndex:s.computeNewWellIndex(e,t.currentWellIndex,t.selectedOptions)}},function(){if(s.state.currentWellIndex===s.state.selectedOptions.length)s.setState({currentFlyoutIndex:s.state.inputPrefix.length&&s.props.allowFreeform?-1:0},function(){event.preventDefault();document.getElementById(i.JsGridConstants.TextFieldIdInModernChoiceEditor).focus()});else{document.getElementById("Well-"+s.state.currentWellIndex).focus()}})}};s.computeNewWellIndex=function(e,t,n){switch(e){case i.JsGridConstants.Key.left:return Math.max(0,t-1);case i.JsGridConstants.Key.right:return Math.min(t+1,n.length)}};s.updateFlyoutIndexToANumber=function(e){s.setState({currentFlyoutIndex:e})};s.updateWellIndexToANumber=function(e){s.setState({currentWellIndex:e})};s.updateFlyoutIndex=function(e){switch(e){case i.JsGridConstants.Key.up:case i.JsGridConstants.Key.down:s.setState(function(t,n){return{currentFlyoutIndex:s.computeNewFlyoutIndex(e,t.currentFlyoutIndex,t.notYetSelectedOptions)}})}};s.computeNewFlyoutIndex=function(e,t,n){var r=s.state,o=r.inputPrefix,u=r.notYetSelectedOptionsBasedOnInput;switch(e){case i.JsGridConstants.Key.up:return 0===t?o.length>0?-1:n.length-1:-1===t?n.length-1:t-1;case i.JsGridConstants.Key.down:return o.length>0?t===u.length-1?s.props.allowFreeform?-1:0:t+1:t===n.length-1?0:t+1}};s.isFreeformTextRepeated=function(){var e=s.state,t=e.inputPrefix,n=e.pendingValue;return s.countOccurrences(n.localized,t)>1};s.getPendingValueWithoutFreeFormOption=function(){var e=s.state.pendingValue.localized.split(";"),t=e.slice(0,e.length-1).join("; ");return{data:t,localized:t}};s.countOccurrences=function(e,t){return e.split(";").reduce(function(e,n){return n.trim()===t?e+1:e},0)};s.trySaveNewSelectedOptions=function(e,t){if(!s.isOptionAlreadySelected(t)){s._saveOptions(t,!0);s.OnValueChanged(e,t)}};s.isOptionAlreadySelected=function(e){return s.state.selectedOptions.filter(function(t){return t.key===e.key}).length>0};s.OnValueChanged=function(e,t){var r={},i=String(t.key);if(s.props.multiSelect){var o=s.state.value.data,u=s.state.value.localized,a=u&&u.split(";");r.data=[];r.localized="";if(a)for(var f=0;f<o.length;f++)""===o[f]&&Array.isArray(o)&&(o[f]=a[f].trim());if(t.selected){if(null!==t.key)if(o||c){for(f=0;f<o.length;f++)r.data.push(o[f]);r.data.push(i)}else r.data.push(i)}else for(f=0;f<o.length;f++)o[f]!==t.key&&r.data.push(o[f]);for(f=0;f<r.data.length;f++)if(c)r.localized+=r.data[f]+"; ";else{for(var l=!1,h=0;h<s.state.options.length;h++)if(s.state.options[h].key==r.data[f]){r.localized+=s.state.options[h].text+"; ";l=!0;break}l||(r.localized+=r.data[f]+"; ")}var p=r.localized.lastIndexOf(";");r.localized=r.localized.substring(0,p);s.props.gridOnChange(r);s.setState({value:r,pendingValue:r,options:n.__spreadArrays(s.state.options,[])})}else{s.props.allowFreeform?t&&(r=t.selected?{data:String(t.key),localized:t.text}:{data:[],localized:""}):r=t.selected?{data:String(t.key),localized:t.text}:{data:[],localized:""};if(r){s.props.gridOnChange(r);s.setState({value:r,pendingValue:r})}}};s._setIsXButtonClickedValue=function(){s.isXButtonClicked=!0};s._onInputChanged=function(e){var t,n=s.props.allowFreeform;t=s.props.multiSelect&&s.state.value.localized&&s.state.value.localized.length>0?{data:s.state.value.localized+"; "+e,localized:s.state.value.localized+"; "+e}:{data:e,localized:e};s.setState({inputPrefix:e,pendingValue:t,currentFlyoutIndex:e.length>0&&n?-1:0});var r=[],i=s.state.notYetSelectedOptions;if(e){i.forEach(function(t){0===t.text.toLowerCase().lastIndexOf(e.toLowerCase(),0)&&r.push(t)});s.setState({notYetSelectedOptionsBasedOnInput:r})}};s.clearTextFieldValue=function(){s.setState({inputPrefix:"",currentFlyoutIndex:0})};s._saveOptions=function(e,t){var r=s.state,o=r.selectedOptions,u=r.notYetSelectedOptions,a=r.notYetSelectedOptionsBasedOnInput,f=n.__spreadArrays(o),l=n.__spreadArrays(u),c=n.__spreadArrays(a);if(t){var h=s.state.options;0==h.filter(function(t){return t.key==e.key}).length&&h.push({key:e.key,text:e.text});s.setState({options:h,currentFlyoutIndex:s.state.currentFlyoutIndex===u.length-1?Math.max(0,s.state.currentFlyoutIndex-1):s.state.currentFlyoutIndex});if(s.props.multiSelect){f.push(e);l=l.filter(function(t){return t.key!==e.key});c=c.filter(function(t){return t.key!==e.key})}else{f=[e];l=s.state.options.filter(function(t){return t.key!==e.key});c=s.state.options.filter(function(t){return t.key!==e.key})}}else{var p=document.getElementById(i.JsGridConstants.TextFieldIdInModernChoiceEditor);p.focus();var d=s.state.inputPrefix?s.state.inputPrefix.length:0;s.state.inputPrefix&&d>0&&p.setSelectionRange(d,d);s.setState({currentFlyoutIndex:s.state.inputPrefix.length>0&&s.props.allowFreeform?-1:0});l.push(e);0===e.text.toLowerCase().lastIndexOf(s.state.inputPrefix.toLowerCase(),0)&&c.push(e);f=s.props.multiSelect?f.filter(function(t){return t.key!==e.key}):[]}s.setState({currentWellIndex:f.length,selectedOptions:f,notYetSelectedOptions:l,notYetSelectedOptionsBasedOnInput:c})};s.currentlySelectedOptions=[];s.currentNotYetSelectedOptions=s.props.allOptions;s.isXButtonClicked=!1;s.scrollParent=a.JsGridUtil.Internal.GetScrollParent(s.props.parentNode);s.scrollEventTriggered=!1;s._initializeWellAndFlyoutOptions();s.state={options:s.props.allOptions,value:s.props.currentValueOfEditor,pendingValue:s.props.currentValueOfEditor,selectedOptions:s.currentlySelectedOptions,notYetSelectedOptions:s.currentNotYetSelectedOptions,notYetSelectedOptionsBasedOnInput:s.currentNotYetSelectedOptions,inputPrefix:"",currentFlyoutIndex:0,currentWellIndex:s.currentlySelectedOptions.length,currentTabCount:0};s._containerRef=r.createRef();return s}t.prototype.componentWillUnmount=function(){var e=this.state,t=e.pendingValue,n=e.value,r=e.inputPrefix,i=e.selectedOptions,s=this.props,o=s.allowFreeform,u=s.fieldType,a=s.gridOnChange;if(t!==n&&!this.isXButtonClicked)if(o){if(r.length>0)if("MultiChoice"===u)if(this.isFreeformTextRepeated()){a(this.getPendingValueWithoutFreeFormOption())}else a(t);else"Choice"===u&&0===i.length&&a(t)}else if(0===r.length)a(this.state.pendingValue);else if("MultiChoice"===u){a(this.getPendingValueWithoutFreeFormOption())}this.scrollParent.removeEventListener("scroll",this.handleScroll)};t.prototype.componentDidMount=function(){this._fixEditorWidth();this.scrollParent.addEventListener("scroll",this.handleScroll)};t.prototype.componentDidUpdate=function(){this._fixEditorWidth()};t.prototype.render=function(){var e=this.props,t=e.rowSchema,n=e.rowData,i=e.currentFieldName,s=e.cellHeight,a=e.cellWidth,f=e.fieldType,l=e.allowFreeform,c=e.goBackToDisplayMode,h=e.onSave,p=e.onCancel,d=this.state,v=d.selectedOptions,m=d.inputPrefix,g=d.notYetSelectedOptionsBasedOnInput,y=d.notYetSelectedOptions,b=d.currentFlyoutIndex,w=d.currentWellIndex,E=d.currentTabCount;return r.createElement("div",{ref:this._containerRef,style:{height:"100%",width:"100%"}},r.createElement(u.Well,{targetElement:this._containerRef,saveSelectedOptions:this._saveOptions,optionsInWell:v,onValueChanged:this.OnValueChanged,onInputChanged:this._onInputChanged,rowSchema:t,rowData:n,currentFieldName:i,cellHeight:s,cellWidth:a,fieldType:f,allowFillInText:l,trySaveNewSelectedOptions:this.trySaveNewSelectedOptions,currentTextFieldValue:m,updateFlyoutIndex:this.updateFlyoutIndex,optionsInFlyout:m.length>0?g:y,currentFlyoutIndex:b,updateWellIndex:this.updateWellIndex,updateFlyoutIndexToANumber:this.updateFlyoutIndexToANumber,updateWellIndexToANumber:this.updateWellIndexToANumber,clearTextFieldValue:this.clearTextFieldValue,currentWellIndex:w,incrementCurrentTabCount:this.incrementCurrentTabCount,currentTabCount:E,onSaveHandlerOfCommonCalloutEditor:this.onSaveHandlerOfCommonCalloutEditor,onCancelHandlerOfCommonCalloutEditor:this.onCancelHandlerOfCommonCalloutEditor,resetCurrentTabCount:this.resetCurrentTabCount,goBackToSelectMode:c}),r.createElement(o.Flyout,{targetElement:this._containerRef,saveSelectedOptions:this._saveOptions,options:m.length>0?g:y,onValueChanged:this.OnValueChanged,rowSchema:t,rowData:n,currentFieldName:i,fieldType:f,cellWidth:a,goBackToSelectMode:c,onSave:h,onCancel:p,setIsXButtonClickedValue:this._setIsXButtonClickedValue,fillInTextFromWell:m,selectedOptions:v,allowFillInText:l,currentFlyoutIndex:b,updateWellIndex:this.updateWellIndex,updateFlyoutIndexToANumber:this.updateFlyoutIndexToANumber,updateWellIndexToANumber:this.updateWellIndexToANumber,currentWellIndex:w,currentTabCount:E,onCancelHandlerOfCommonCalloutEditor:this.onCancelHandlerOfCommonCalloutEditor,clearTextFieldValue:this.clearTextFieldValue}))};t.prototype._initializeWellAndFlyoutOptions=function(){var e=this;if(this.props.currentValueOfEditor&&this.props.currentValueOfEditor.localized){var t=this.props.currentValueOfEditor.localized.split(";");(t=t.map(function(e){return e.trim()})).map(function(t,n){return e.currentlySelectedOptions.push(void 0===e.props.allOptions.filter(function(e){return e.key===t})[0]?{key:t,text:t}:e.props.allOptions.filter(function(e){return e.key===t})[0])});this.currentNotYetSelectedOptions=this.props.allOptions.filter(function(e){return-1===t.indexOf(e.key)})}};t.prototype._fixEditorWidth=function(){if(this.state&&this.state.value&&this.state.value.localized&&this._containerRef&&this._containerRef.current){var e=this._containerRef.current.clientWidth;this._containerRef.current.style.width=e.toString()+"px"}if(this.props.positionGridSelectionFrame){var t=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(t)}};return t})(r.PureComponent);t.ModernChoiceEditor=h});
define("oqe",["require","exports","ww","r","Wf","oL","sqe","ODBItemsScopeDeferred_mini_css","Dqe","pc","Ohe"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";u=u.ChoicePill_6;Object.defineProperty(t,"__esModule",{value:!0});var c={fieldGroup:{maxHeight:a.JsGridConstants.Internal.fixedRowHeight-2-2-1,minHeight:a.JsGridConstants.Internal.fixedRowHeight-2-2-1,border:"none"},root:{maxHeight:a.JsGridConstants.Internal.fixedRowHeight-2-2,minHeight:a.JsGridConstants.Internal.fixedRowHeight-2-2}},h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.handleClick=function(e,t){t.selected=!1;n.props.saveSelectedOptions(t,!1);n.props.onValueChanged(e,t);"Choice"===n.props.fieldType&&n.props.goBackToSelectMode()};n.handleInputChange=function(e,t){n.props.onInputChanged(t)};n.handleTextFieldKeyDownEvent=function(e){var t=n.props,r=t.allowFillInText,i=t.optionsInFlyout,s=t.currentFlyoutIndex,o=t.currentTabCount,u=t.optionsInWell,f=t.currentWellIndex,l=n.state._textfield.value;switch(e.which){case a.JsGridConstants.Key.enter:if(o%3==0){var c=void 0;if(-1===s&&r){c={key:l,text:l,selected:!0};n.props.trySaveNewSelectedOptions(e,c);n.props.clearTextFieldValue();"Choice"===n.props.fieldType&&n.props.onSaveHandlerOfCommonCalloutEditor(e)}else if(i&&i.length>0){c={key:i[s].key,text:i[s].text,selected:!0};n.props.trySaveNewSelectedOptions(e,c);n.props.clearTextFieldValue();"Choice"===n.props.fieldType&&n.props.onSaveHandlerOfCommonCalloutEditor(e)}}else o%3==1?n.props.onSaveHandlerOfCommonCalloutEditor(e):o%3==2&&n.props.onCancelHandlerOfCommonCalloutEditor(e);break;case a.JsGridConstants.Key.backspace:if((void 0===l||0===l.length)&&u&&u.length>0){var h=Math.max(0,f-1);n.props.updateWellIndex(a.JsGridConstants.Key.left,!1);n.props.updateFlyoutIndexToANumber(-2);var p={key:u[h].key,text:u[h].text,selected:!1};n.handleClick(e,p)}break;case a.JsGridConstants.Key.left:var d=document.getElementById(a.JsGridConstants.TextFieldIdInModernChoiceEditor),v=void 0;d&&(v=d.selectionStart);if(0===v){n.props.resetCurrentTabCount();if(u&&u.length>0){n.props.updateWellIndex(a.JsGridConstants.Key.left,!0);n.props.updateFlyoutIndexToANumber(-2)}}break;case a.JsGridConstants.Key.up:n.props.updateFlyoutIndex(a.JsGridConstants.Key.up);break;case a.JsGridConstants.Key.down:n.props.updateFlyoutIndex(a.JsGridConstants.Key.down);n.props.resetCurrentTabCount();break;case a.JsGridConstants.Key.tab:e.preventDefault();"MultiChoice"===n.props.fieldType&&n.props.incrementCurrentTabCount();break;case a.JsGridConstants.Key.esc:n.props.onCancelHandlerOfCommonCalloutEditor(e)}};n.getAriaActiveDescendantValue=function(){switch(n.props.currentTabCount%3){case 0:return"Flyout-"+n.props.currentFlyoutIndex;case 1:return l.IdOfAcceptButtonInCommonEditorCallout;case 2:return l.IdOfCancelButtonInCommonEditorCallout}};n.onMouseDownHandler=function(e){n.props.updateWellIndexToANumber(n.props.optionsInWell.length)};n._getRef=function(e){n.setState({_textfield:e})};n.getCalloutStyles=f.memoizeFunction(function(e){var t=e.theme.palette;return{root:{width:n.props.cellWidth,border:"2px solid "+t.themePrimary,minHeight:n.props.cellHeight,backgroundColor:t.white}}});n.state={_textfield:void 0};return n}t.prototype.componentDidUpdate=function(){if(this.state._textfield){this.state._textfield.focus();document.getElementById(a.JsGridConstants.TextFieldIdInModernChoiceEditor).scrollIntoView()}};t.prototype.render=function(){var e=this,t=this.props,n=t.targetElement,f=t.rowData,l=t.rowSchema,h=t.currentFieldName,p=t.fieldType,d=t.optionsInWell,v=t.allowFillInText,m=t.currentTextFieldValue,g=t.updateWellIndex,y=t.currentWellIndex;return r.createElement(i.Callout,{styles:this.getCalloutStyles,target:n,directionalHint:i.DirectionalHint.leftBottomEdge,coverTarget:!0,isBeakVisible:!1,calloutMaxHeight:Math.max(this.props.cellHeight,200),id:a.JsGridConstants.IdOfCalloutInWellOfModernChoiceEditor,"aria-live":"assertive"},this.props.optionsInWell.map(function(t,n){return r.createElement(o.ChoicePill,{option:t,onClick:e.handleClick,valueToDisplay:t.key,rowData:f,rowSchema:l,currentFieldName:h,customClassName:u.pillNoHoverStyle,fieldType:p,showDeleteButton:!0,pillDivId:"Well-"+n,updateWellIndex:g,updateFlyoutIndexToANumber:e.props.updateFlyoutIndexToANumber,updateWellIndexToANumber:e.props.updateWellIndexToANumber,selectedOptions:d,fillInTextFromWell:m,currentWellIndex:y,allowFillInText:v,onCancelHandlerOfCommonCalloutEditor:e.props.onCancelHandlerOfCommonCalloutEditor})}),r.createElement(s.TextField,{id:a.JsGridConstants.TextFieldIdInModernChoiceEditor,onChange:this.handleInputChange,onKeyDown:this.handleTextFieldKeyDownEvent,componentRef:this._getRef,borderless:!0,styles:c,autoComplete:"off",value:m,placeholder:!1===v||"Choice"===p&&d&&d.length>0?"Type to filter":"Type to filter or add new choice",onMouseDown:this.onMouseDownHandler,"aria-activedescendant":this.getAriaActiveDescendantValue()}))};return t})(r.Component);t.Well=h});
define("JWe",["require","exports","ww","r","Che","Tue","Yf","Lqe","ZWe","ODBItemsScopeDeferred_mini_css","Nc","khe"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";f=f.DateEditor_5;Object.defineProperty(t,"__esModule",{value:!0});t.DayPickerStrings={months:[a.default.January,a.default.February,a.default.March,a.default.April,a.default.May,a.default.June,a.default.July,a.default.August,a.default.September,a.default.October,a.default.November,a.default.December],shortMonths:[a.default.ShortJanuary,a.default.ShortFebruary,a.default.ShortMarch,a.default.ShortApril,a.default.ShortMay,a.default.ShortJune,a.default.ShortJuly,a.default.ShortAugust,a.default.ShortSeptember,a.default.ShortOctober,a.default.ShortNovember,a.default.ShortDecember],days:[a.default.Sunday,a.default.Monday,a.default.Tuesday,a.default.Wednesday,a.default.Thursday,a.default.Friday,a.default.Saturday],shortDays:[a.default.ShortSunday,a.default.ShortMonday,a.default.ShortTuesday,a.default.ShortWednesday,a.default.ShortThursday,a.default.ShortFriday,a.default.ShortSaturday],goToToday:a.default.GoToToday,prevMonthAriaLabel:a.default.PrevMonth,nextMonthAriaLabel:a.default.NextMonth};var h=(function(e){n.__extends(h,e);function h(t){var n=e.call(this,t)||this;n._onSelectDate=function(e){var t=n.props,r=t.onValueChange,i=t.dateOnly,s=t.currentCultureName,o=n.state.time;if(r)if(i){r(e);l.Engagement.logData({name:"QuickEdit.CalendarType.Gregorian"});var u=c.formatDateString(s,e);n.setState({dateTime:u})}else{r(e=n._setTime(o,e));var a=n._getDateTimeString(e);n.setState({dateTime:a})}n.setState({date:e})};n._onTimeChange=function(e){var t=n.props.onValueChange,r=n.state.date,i=e.target.value;if(t){var s=r;s||(s=new Date);t(s=n._setTime(i,s));var o=n._getDateTimeString(s);n.setState({date:s,dateTime:o})}n.setState({time:i})};n._onTextInputChange=function(e){var t=n.props.onInputValueChange,r=e.target.value;t&&t(r);n.setState({dateTime:r})};n._inputRef=r.createRef();n.state={date:n.props.date,time:n.props.time||"00:00",dateTime:n.props.dateTime};return n}h.prototype.render=function(){var e=this.props,l=e.onInputKeyDown,c=e.calloutProps,h=e.dateOnly,p=e.inputProps,d=e.onCalendarKeyUp,v=this.state,m=v.date,g=v.time,y=v.dateTime;return r.createElement(o.FocusTrapZone,{isClickableOutsideFocusTrap:!0},r.createElement("input",{type:"text",value:y,ref:this._inputRef,className:f.quickEditDateTimeEditorInput,style:{height:p.height-8,width:p.width-16},onChange:this._onTextInputChange,"aria-label":h?a.default.Date:a.default.DateTime,onKeyDown:l}),r.createElement(i.CommonEditorCallout,n.__assign({},c,{target:this._inputRef,onKeyUp:d}),r.createElement(s.Calendar,{strings:t.DayPickerStrings,firstDayOfWeek:u.JsGridUtil.SpRegionalSettings.firstDayOfWeek,firstWeekOfYear:u.JsGridUtil.SpRegionalSettings.firstWeekOfYear,showGoToToday:!1,isDayPickerVisible:!0,isMonthPickerVisible:!1,placeholder:a.default.datePlaceHolder,onSelectDate:this._onSelectDate,value:m,id:"quickEditDateTimeEditor",className:f.quickEditDateTimeEditor}),!h&&r.createElement("input",{type:"time",onChange:this._onTimeChange,value:g,className:f.quickEditDateTimeEditorTimeInput})))};h.prototype._setTime=function(e,t){var n=e.split(":");if(n.length>1){var r=n[0],i=n[1];r&&t.setHours(Number(r));i&&t.setMinutes(Number(i))}return t};h.prototype._getDateTimeString=function(e){var t=this.props,n=t.currentCultureName,r=t.is24HourFormat,i=c.formatDateString(n,e),s=e.toLocaleTimeString(n,{hour:"2-digit",minute:"2-digit",hour12:u.JsGridUtil._specify24HourFormatInDateTimeKillswitchIsActive?void 0:!r});u.JsGridUtil._specify24HourFormatInDateTimeKillswitchIsActive||"24:00"===s&&(s="00:00");u.JsGridUtil._fixTimeFormatsKillswitchIsActive||(s=s.split(".").join(":"));return i+" "+s};return h})(r.PureComponent);t.DateEditor=h});
define("tqe",["require","exports","ww","r","nqe","Che","Yf"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isActive=!0;n.OnDisplayValueChanged=function(e,t){var r=n.props.onValueChange;if(n._isActive&&r){r({address:n.state.address,display:t});n.setState({display:t})}};n.OnUrlValueChanged=function(e,t){var r=n.props.onValueChange;if(n._isActive&&r){r({address:t,display:n.state.display});n.setState({address:t})}};n.state={address:t.currentUrlValue,display:t.currentDisplayValue};return n}t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.render=function(){var e=this.props,t=e.onEditorKeyDown,u=e.onEditorMouseDown,a=e.calloutProps,f=this.state,l=f.address,c=f.display;return r.createElement(o.FocusTrapZone,{isClickableOutsideFocusTrap:!0},r.createElement(s.CommonEditorCallout,n.__assign({},a,{setInitialFocus:!0}),r.createElement(i.HyperlinkControl,n.__assign({},this.props,{linkText:l,displayText:c,onLinkTextChange:this.OnUrlValueChanged,onDisplayTextChange:this.OnDisplayValueChanged,onKeyDown:t,onMouseDown:u,style:{width:"288px"}}))))};return t})(r.PureComponent);t.HyperlinkEditor=u});
define("qWe",["require","exports","ww","r","r","yHe","uHe","sHe","q","ODBItemsScopeDeferred_mini_css","Lqe","k"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";f=f.LocationEditor_1;Object.defineProperty(t,"__esModule",{value:!0});var h=c.Killswitch.isActivated("3B01777A-671E-4CEE-9534-CA4AE2EBF286","9/29/2020","Adjust styles."),p=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._picker=i.createRef();r._containerRef=i.createRef();r._isActive=!0;r._resolveItem=function(e){return e&&e.LocationUri?r._dataSource.resolveLocationFromBingUri(e.LocationUri).then(function(t){if(t){var r=n.__assign(n.__assign({},e.Address),t.Address);if(e.Address){for(var i in r)!r[i]&&e.Address[i]&&(r[i]=e.Address[i]);t.Address=r}return t}return e}):Promise.resolve(e)};r._resolveSuggestions=function(e){return r._dataSource.search(e).then(function(t){return r._hasFillIn()?t.concat([{DisplayName:e,EntityType:"Custom"}]):t}).catch(function(e){e&&"Canceled"!==e.name&&r.setState({error:e});return[]})};r._onItemsChange=function(e){if(r._isActive){var t,n=r.props.onChange;r.setState({selectedLocation:e});if(r.state.selectedLocation){var i=r.state.selectedLocation;t="Custom"===i.EntityType?new a.Qos({name:"QuickEditSaveUnresolvedLocation"}):i.Address&&i.Address.Street&&i.Address.City&&i.Address.State&&i.Address.CountryOrRegion&&i.Address.PostalCode&&i.Coordinates?new a.Qos({name:"QuickEditSaveFullLocation"}):new a.Qos({name:"QuickEditSaveSparseLocation"})}else t=new a.Qos({name:"QuickEditSaveRemoveLocation"});try{n&&n(e);t.end({resultType:a.ResultTypeEnum.Success})}catch(e){t.end({resultType:a.ResultTypeEnum.Failure,error:e})}}};r._dataSource=r._getDataSource(t);r.state={selectedLocation:t.defaultLocation};return r}t.prototype._updateGridSelectionFrame=function(){if(l.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._containerRef.current);else{var e=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}};t.prototype.componentDidMount=function(){this._picker.current&&this._picker.current.focus();this._updateGridSelectionFrame()};t.prototype.componentDidUpdate=function(){this._updateGridSelectionFrame()};t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.render=function(){var e=this,t=this.props,i=t.onEditorKeyDown,s=t.onEditorMouseDown,a=this.state.selectedLocation,l=f.locationEditor;h||(l+=" "+f.styleFix);!h&&a&&(l+=" "+f.hasLocationPill);return r.createElement("span",{onKeyDown:i,onMouseDown:s,ref:this._containerRef},r.createElement(o.LocationPicker,n.__assign({},this.props,{defaultLocation:a,onChange:this._onItemsChange,className:l,resolveLocations:this._resolveSuggestions,placeHolder:u.default.locationEditorPlaceHolder,onItemSelected:this._resolveItem,strings:{useCustomLocation:u.default.useLocationCustomValueTag},componentRef:this._picker,allowCustomLocations:this._hasFillIn(),onFocus:function(){return e._updateGridSelectionFrame()}})))};t.prototype.getData=function(){var e=this.state.selectedLocation;return e?JSON.stringify(e):""};t.prototype._shouldSaveDataOnEnter=function(){return!1};t.prototype._getAriaLabelDataString=function(){if(this.state.selectedLocation)return this.state.selectedLocation.DisplayName};t.prototype._hasFillIn=function(){return!0};t.prototype._getPlaceHolderString=function(){return u.default.locationEditorPlaceHolder};t.prototype._getDataSource=function(e){return e&&e.dataSource?e.dataSource:new s.LocationDataSource({pageContext:e.pageContext})};return t})(r.PureComponent);t.LocationEditor=p});
define("$We",["require","exports","ww","r","oL","ODBItemsScopeDeferred_mini_css","U5","Dqe"],function(e,t,n,r,i,s,o,u){"use strict";s=s.NumberEditor_5;Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isActive=!0;n._onBlur=function(e){n.props.onSave&&n._isActive&&n.props.onSave(e)};n._renderPrefix=function(e){return r.createElement("span",{className:s.numberEditorUnit},e.prefix)};n._renderSuffix=function(e){return r.createElement("span",{className:s.numberEditorUnit},e.suffix)};n.OnDisplayValueChanged=function(e,t){var r=n.props.onValueChange;if(n._isActive&&r){r(t);n.setState({value:t})}};n.state={value:t.currentValue};n._inputRef=r.createRef();return n}t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.componentDidMount=function(){this._inputRef&&this._inputRef.current.focus()};t.prototype.render=function(){var e=this.state.value,t=this.props,s=t.unit,a=t.customUnitName,f=t.customUnitOnRight,l=t.height,c=t.width,h=t.className,p=o.isUnitSuffix(s,f),d=!p&&"None"!==s,v=o.getUnitString(s,a),m={suffix:p?v:void 0,onRenderSuffix:p?this._renderSuffix:void 0,prefix:d?v:void 0,onRenderPrefix:d?this._renderPrefix:void 0},g={padding:0,maxWidth:"40%"},y={fieldGroup:{height:l,width:c,zIndex:u.JsGridConstants.Internal.zIndex.editor},field:{textOverflow:"clip"},suffix:[p&&g],prefix:[d&&g]};return r.createElement(i.TextField,n.__assign({},m,{inputClassName:h,value:e,borderless:!0,validateOnLoad:!1,onChange:this.OnDisplayValueChanged,onBlur:this._onBlur,componentRef:this._inputRef,styles:y}))};return t})(r.PureComponent);t.NumberEditor=a});
define("pqe",["require","exports","ww","r","Dqe","HR","PR","ER","kR","q3","Wf","ld","Che","pc","jH","Lqe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";m=m.PeopleEditor_7;Object.defineProperty(t,"__esModule",{value:!0});var g={ODB:1948},y=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isActive=!0;n._useNewEditor=!1;n.handleScroll=function(e){if(!n._scrollEventTriggered){n._scrollEventTriggered=!0;n.props.goBackToSelectMode()}};n._onSelectedPersonasChange=function(e){if(n._isActive){var t=n.props,r=t.peoplePickerQueryParams,i=t.onSelectedPersonasChange,s=t.goBackToSelectMode,o=n.state.currentSelectedPeople;o=r.allowMultipleEntities||e.length<=1?e:[e[e.length-1]];n.setState({currentSelectedPeople:o});i&&i(o);r.allowMultipleEntities||s()}};n._onSuggestionSelected=function(e){if(n._isActive){var t=n.props.peoplePickerQueryParams;if(e&&(!1===e.isExternal||e.isExternal&&e.providerName))return e;if(e&&e.principalType===s.PrincipalType.distributionList){t.isGraphDistributionList=!0;t.useGraph=!0;t.useSubstrate=!0}return n._peoplePickerProvider.resolve(e.userId,t).then(function(e){e&&!e.email&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);e&&!e.name&&e.rawData.EntityData&&(e.name=e.rawData.EntityData.OtherMails);return e})}};n._setFocus=function(){n._peoplePicker&&n._peoplePicker.focusInput()};n.pickerStyleOverrides=function(e){var t=d.getStyles(e),r={text:{minHeight:n.props.cellHeight-12}};return c.concatStyleSets(t,r)};n._containerRef=r.createRef();n._scrollParent=v.JsGridUtil.Internal.GetScrollParent(n.props.parentNode);n._scrollEventTriggered=!1;n._useNewEditor=f.default.isFeatureEnabled(g);n._peoplePickerProvider=new o.PeoplePickerProvider({pageContext:t.context,peoplePickerDataSource:t.dataSource});n.state={currentSelectedPeople:t.selectedItems};return n}t.prototype.componentDidMount=function(){this._peoplePicker&&this._peoplePicker.focusInput();if(v.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._containerRef.current);else{var e=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}this._useNewEditor&&this._scrollParent.addEventListener("scroll",this.handleScroll)};t.prototype.componentDidUpdate=function(){if(v.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._containerRef.current);else{var e=this._containerRef.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}if(this._useNewEditor){this._setFocus();var t=document.getElementsByClassName("ms-BasePicker-input")[0];t&&t.scrollIntoView()}};t.prototype.componentWillUnmount=function(){this._isActive=!1;this._useNewEditor&&this._scrollParent.removeEventListener("scroll",this.handleScroll)};t.prototype.render=function(){var e=this,t=this.props,s=t.peoplePickerQueryParams,o=t.onEditorKeyDown,c=t.onEditorMouseDown,p=t.theme,d=t.calloutId,g=t.onEditorKeyUp,y=this.state.currentSelectedPeople,b=f.default.isFeatureEnabled({ODB:1725})?" "+m.increaseZIndex:"",w=v.JsGridUtil.Internal.IsStickyColumnEnabled()?" "+m.inStickyMode:"";if(this._useNewEditor){var E=m.peopleEditor+b+w+(this._useNewEditor?" "+m.styleUpdates:""),S={container:{zIndex:i.JsGridConstants.Internal.zIndex.expandableEditorsZIndex},root:{minWidth:this.props.cellWidth-2,minHeight:this.props.cellHeight-2,backgroundColor:p.palette.white,border:"2px solid "+p.palette.themePrimary},calloutMain:{padding:0,margin:4}};return r.createElement("div",{ref:this._containerRef,style:{height:"100%",width:"100%"}},r.createElement(h.CommonEditorCallout,{target:this._containerRef,directionalHint:l.DirectionalHint.leftBottomEdge,coverTarget:!0,isBeakVisible:!1,styles:S,gapSpace:0,doNotLayer:!1,onKeyDown:o,onMouseDown:c,onKeyUp:g,preventDismissOnScroll:!1,onLayerMounted:this._setFocus,calloutMaxHeight:Math.max(this.props.cellHeight,200)-12,onSave:this.props.goBackToSelectMode,lightDismissElementsFilter:[i.JsGridConstants.IdOfPeoplePickerInPeopldEditor,"spgridcontainer_"+v.JsGridUtil.privateWpq,d],calloutId:d},r.createElement(u.PeoplePicker,n.__assign({},this.props,{className:E,onSelectedPersonasChange:this._onSelectedPersonasChange,selectedItems:y,onSuggestionSelected:this._onSuggestionSelected,"aria-required":s&&s.required,componentRef:function(t){return e._peoplePicker=t},onRenderItem:a.SelectedItemWithPills,pickerOverrideStyles:this.pickerStyleOverrides,theme:p,pickerCalloutProps:{id:i.JsGridConstants.IdOfPeoplePickerInPeopldEditor}}))))}return r.createElement("span",{onKeyDown:o,onMouseDown:c,ref:this._containerRef},r.createElement(u.PeoplePicker,n.__assign({},this.props,{className:m.peopleEditor+b+w,onSelectedPersonasChange:this._onSelectedPersonasChange,selectedItems:y,onSuggestionSelected:this._onSuggestionSelected,"aria-required":s&&s.required,componentRef:function(t){return e._peoplePicker=t}})))};return t})(r.PureComponent);t.PeopleEditor=p.styled(y,function(){return{}})});
define("GWe",["require","exports","ww","r","WWe","r","Zm","UHe","Rre","tre","LHe","wHe","OHe","pc","q3","bv","k","Lqe","ODBItemsScopeDeferred_mini_css","Oe","Hf"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";y=y.TaxonomyEditor_2;Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._taxonomyPicker=s.createRef();n._root=s.createRef();n._isActive=!0;n.showClassicTaggingTree=function(){n.setState({forceClassicTree:!0,taxonomyTreeOpen:!0})};n._resolveSuggestions=function(e){return n._dataManager.resolveSuggestions(e,n.state.queryParams).then(function(e){return h.TaxonomyEditorDataManager.filterTaggedTerms(e,n.state.selectedTerms)}).catch(function(e){return[]})};n._onPickerItemsChange=function(e){for(var t=T(n.state.selectedTerms,e),r=1;r<=t;r++)S("TaxonomyPickerInQuickEditUpdated");n._onItemsChange(e)};n._onItemsChange=function(e){if(n._isActive){n.setState({selectedTerms:e},function(){0===e.length&&n._focus();n._validateTerms(e)});n.props.onItemsChange&&n.props.onItemsChange(e);n._updateGridSelectionFrame()}};n._launchTree=function(e){if(!n.state.taxonomyTreeOpen){v.Engagement.logData({name:"QuickEditLaunchTaxonomyTree",isIntentional:!0});n.setState({taxonomyTreeOpen:!0})}};n._dismissTree=function(){n.state.taxonomyTreeOpen&&n.setState({taxonomyTreeOpen:!1},n._focus)};n.handleTreeDialogResults=function(e){if(e){var t=e.value;try{var r=t.split(f.TERM_DELIMITER).map(function(e){var t=e.split(f.LABEL_ID_DELIMITER),n=t[1]!==f.INVALID_TERM_ID;return{term:{label:t[0],termId:t[1],isValid:n},isSynonym:!1,completions:[],start:"",state:n?1:2}});if(0===r.filter(function(e){return!e.term.isValid}).length){n.setState({selectedTerms:r,taxonomyTreeOpen:!1},n._focus);n.props.onItemsChange&&n.props.onItemsChange(r);n._updateGridSelectionFrame()}}catch(e){}}else n.setState({taxonomyTreeOpen:!1},n._focus)};n._getAriaLabelPrefix=function(){var e=n.props.schema&&n.props.schema.Title;return n._isRequiredField()&&e?b.format(i.default.RequiredFieldAriaLabel,n.props.schema.Title):n.props.schema.Title};n._isTitleToBeAnnounced=function(){return!m.Killswitch.isActivated("8cfc50e2-a8b2-4530-884f-d537360df887","11/07/2020","Adds prefix to aria label")};n._dataSource=t.dataSource||new c.TaxonomyDataSource(t.pageContext);n._dataProvider=new c.TaxonomyProvider({},{dataSource:n._dataSource});n._dataManager=new h.TaxonomyEditorDataManager({dataProvider:n._dataProvider,dataSource:n._dataSource});n._async=new p.Async;var r=t.schema,o={lcid:r.Lcid||1033,sspList:r.SspId,termSetList:r.TermSetId,anchorId:r.AnchorId||f.INVALID_TERM_ID,excludedTermset:f.INVALID_TERM_ID,isSpanTermStores:r.IsSpanTermStores||!1,isSpanTermSets:r.IsSpanTermSets||!1,isIncludeUnavailable:!1,isIncludeDeprecated:!1,isAddTerms:r.IsAddTerms||!1,isIncludePathData:!1,excludeKeyword:!r.Name&&"TaxKeyword"!==r.Name,isUseCommaAsDelimiter:"boolean"!=typeof r.IsUseCommaAsDelimiter||r.IsUseCommaAsDelimiter,isIncludeTermSetName:!1,webServiceUrl:r.WebServiceUrl,allowFillIn:"boolean"!=typeof r.AllowFillIn||r.AllowFillIn};n.state={queryParams:o,selectedTerms:t.selectedTerms,taxonomyTreeOpen:!1,serverTerms:t.selectedTerms};return n}t.prototype._updateGridSelectionFrame=function(){if(g.JsGridUtil.Internal.IsStickyColumnEnabled())this.props.setSelectionFrame&&this.props.setSelectionFrame(this._root.current);else{var e=this._root.current.getBoundingClientRect();this.props.positionGridSelectionFrame(e)}};t.prototype.componentDidMount=function(){this._taxonomyPicker.current&&this._taxonomyPicker.current.focus();this._updateGridSelectionFrame()};t.prototype.componentDidUpdate=function(){this._updateGridSelectionFrame()};t.prototype.componentWillUnmount=function(){this._isActive=!1};t.prototype.render=function(){var e=this.props,t=e.onEditorKeyDown,n=e.onEditorMouseDown,s=e.schema,f=e.onBlur,c=s.AllowMultipleValues?void 0:1,h=this.state.queryParams&&!this.state.queryParams.isSpanTermSets,p=this._isQuickEditVisualRefreshFlightEnabled?" "+y.increaseZIndex:"";return r.createElement("span",{onKeyDown:t,onMouseDown:n,ref:this._root,className:y.taxonomyEditorSpan+p},r.createElement(a.TaxonomyPicker,{selectedTerms:this.state.selectedTerms,onItemsChange:this._isTelemetryEnabledForChangesInPicker?this._onPickerItemsChange:this._onItemsChange,className:"taxonomyEditor-Picker",containerClassName:"taxonomyEditor-TaxonomyPicker",resolveSuggestions:this._resolveSuggestions,termLimit:c,ref:this._taxonomyPicker,"aria-required":this._isRequiredField(),onBlur:f,ariaLabelPrefix:this._isTitleToBeAnnounced?this._getAriaLabelPrefix():void 0}),h&&this._isTooltipForAddTagEnabled&&r.createElement(w.TooltipHost,{content:i.default.ToolTipForAddTagIcon,calloutProps:{gapSpace:0}},r.createElement(o.ActionButton,{"aria-hidden":this._isNarrationForTagIconEnabled?void 0:"true","aria-label":this._isNarrationForTagIconEnabled?i.default.AriaLabelForTagIcon:void 0,iconProps:{iconName:"tag"},onClick:this._launchTree})),h&&!this._isTooltipForAddTagEnabled&&r.createElement(o.ActionButton,{"aria-hidden":this._isNarrationForTagIconEnabled?void 0:"true","aria-label":this._isNarrationForTagIconEnabled?i.default.AriaLabelForTagIcon:void 0,iconProps:{iconName:"tag"},onClick:this._launchTree}),h&&this._isModernTaggingToBeDisplayed&&r.createElement(l.TaxonomyTaggingPanel,{onDismiss:this._dismissTree,title:s.Title,onItemsChange:this._onItemsChange,selectedTerms:this.state.selectedTerms,queryParams:this.state.queryParams,pageContext:this.props.pageContext,dataSource:this._dataSource,termLimit:c,isRequiredField:this._isRequiredField(),isPanelOpen:this.state.taxonomyTreeOpen,getOAuthToken:this.props.getOAuthToken,showClassicTaggingTree:this.showClassicTaggingTree}),h&&this.state.taxonomyTreeOpen&&!this._isModernTaggingToBeDisplayed&&r.createElement(u.TaxonomyTreePicker,{taxonomyTreeUrl:this.getTaxonomyTreeUrl(),resultHander:this.handleTreeDialogResults,onDismiss:this._dismissTree,title:s.Title}))};t.prototype._focus=function(){this._taxonomyPicker.current&&this._taxonomyPicker.current.focus()};t.prototype._isRequiredField=function(){return this.props.schema&&this.props.schema.Required};t.prototype._validateTerms=function(e){var t=this;this._timeout&&this._async.clearTimeout(this._timeout);this._timeout=this._async.setTimeout(function(){t._getValidatedTerms(e).then(function(e){t.setState({selectedTerms:e})})},300)};t.prototype._getValidatedTerms=function(e){return e.some(function(e){return 1!==e.state})?this._dataManager.validateTerms(this.state.queryParams,e):Promise.resolve(e)};t.prototype.getTaxonomyTreeUrl=function(){return this._dataSource.getTaxonomyTreeUrl(this.convertToTermsRawString(this.state.selectedTerms),{name:this.props.schema.Name,id:this.props.schema.Id,isMulti:this.props.schema.AllowMultipleValues},this.state.queryParams)};t.prototype.convertToTermsRawString=function(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(1===r.state){t+=r.term.label+f.LABEL_ID_DELIMITER+r.term.termId;n<e.length-1&&(t+=f.TERM_DELIMITER)}}return t};t.prototype._getTermsAsServerString=function(){return this.state.selectedTerms.reduce(function(e,t){return e+t.term.label+f.LABEL_ID_DELIMITER+t.term.termId+f.TERM_DELIMITER},"")};t.prototype.getData=function(){return this._getTermsAsServerString()};t.prototype._shouldSaveDataOnEnter=function(){return!1};Object.defineProperty(t.prototype,"_isModernTaggingToBeDisplayed",{get:function(){return this._isClassicTreeToBeShownForcefullyAllowed?!this.state.forceClassicTree&&(this._isModernTaggingIgniteFlightEnabled||this._isModernTaggingQuickEditGAFlightEnabled)&&this._isOauthCallbackDefined:(this._isModernTaggingIgniteFlightEnabled||this._isModernTaggingQuickEditGAFlightEnabled)&&this._isOauthCallbackDefined},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isOauthCallbackDefined",{get:function(){return x(this.props.getOAuthToken)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isClassicTreeToBeShownForcefullyAllowed",{get:function(){return d.default.isFeatureEnabled({ODB:1910})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isModernTaggingIgniteFlightEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:1659})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isModernTaggingQuickEditGAFlightEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:1842})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isQuickEditVisualRefreshFlightEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:1725})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isNarrationForTagIconEnabled",{get:function(){return d.default.isFeatureEnabled({ODB:307})},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isTelemetryEnabledForChangesInPicker",{get:function(){return!m.Killswitch.isActivated("3635202a-20b2-4274-ad59-079e4c6e33c5","06/17/2020","Adding Telemetry whenever taxonomy picker is updated by user")},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isTooltipForAddTagEnabled",{get:function(){return!m.Killswitch.isActivated("8ba4c8a4-be7c-4051-ab51-413c2d86e988","11/08/2020","Tooltip for add tag icon")},enumerable:!0,configurable:!0});return t})(r.PureComponent);t.TaxonomyEditor=E;function S(e){v.Engagement.logData({name:e,isIntentional:!0})}function x(e){if(m.Killswitch.isActivated("9d964d2e-efe9-4b47-9bf4-d9c9e2b93b03","06/08/2020","Show classic tree when oauth token is not passed")){S("ModernTaggingTreeOpenAttemptedWithoutCheckingOAuthCallback");return!0}var t=void 0!==e,n="ModernTaggingTreeOpenAttemptedWithOAuthCallback";t||(n="ModernTaggingTreeOpenAttemptedWithoutOAuthCallback");S(n);return t}t.isOauthCallbackDefined=x;function T(e,t){if(!t&&!e)return 0;if(!t)return e.length;if(!e)return t.length;if(e.length>t.length)return T(t,e);for(var n={},r=0,i=e;r<i.length;r++){n[(a=i[r]).term.termId]=a}for(var s=0,o=0,u=t;o<u.length;o++){var a;n[(a=u[o]).term.termId]||s++}return s}t.getCountOfUpdatedTerms=T});
define("bQe",["require","exports","Dqe","Lqe","Aqe","k","we","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u){"use strict";u=u.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var a=s.Killswitch.isActivated("0557E1F5-5D22-4E62-BF9E-E4457A269D68","8/05/2020","Add/remove filedKey map of fields that have records with errors in that field"),f={ODB:1725};t.ErrorType={Row:1,Cell:2};var l=(function(){function e(e){this._rowErrs=new p;this._cellErrs={};this._key=e}e.prototype.AddRowError=function(e,t){this._rowErrs.AddError(e,t)};e.prototype.AddCellError=function(e,t,n){e in this._cellErrs||(this._cellErrs[e]=new p);this._cellErrs[e].AddError(t,n)};e.prototype.ClearRowError=function(e){return this._rowErrs.RemoveError(e)};e.prototype.ClearCellError=function(e,t){if(e in this._cellErrs&&this._cellErrs[e].RemoveError(t)){this._cellErrs[e].AnyErrors()||delete this._cellErrs[e];return!0}return!1};e.prototype.ClearAllErrorsOnCell=function(e){e in this._cellErrs&&delete this._cellErrs[e]};e.prototype.ClearAllErrorsOnRow=function(){this._rowErrs=new p};e.prototype.AnyErrors=function(){return this._rowErrs.AnyErrors()||!r.JsGridUtil.Internal.IsAssocArrayEmpty(this._cellErrs)};e.prototype.AnyErrorsOnCell=function(e){return e in this._cellErrs&&this._cellErrs[e].AnyErrors()};e.prototype.AnyErrorsOnRow=function(){return this._rowErrs.AnyErrors()};e.prototype.GetMessageForCell=function(e){return e in this._cellErrs?this._cellErrs[e].GetTopMessage(e):null};e.prototype.GetMessageForRow=function(){return this._rowErrs.GetTopMessage()};e.prototype.GetIdForCell=function(e){return e in this._cellErrs?this._cellErrs[e].GetTopId():null};e.prototype.GetIdForRow=function(){return this._rowErrs.GetTopId()};e.prototype.GetMinError=function(e){var n=this,r=this._rowErrs.GetMinError(null!=e?function(t){return e(n._key,null,t)}:null);null!=r&&(r.type=t.ErrorType.Row);for(var i in this._cellErrs){var s=this._cellErrs[i].GetMinError(null!=e?function(t){return e(n._key,i,t)}:null);if(null!=s&&(null==r||s.id<r.id)){(r=s).fieldKey=i;r.type=t.ErrorType.Cell}}return r};return e})();t.RecordErrorCollection=l;var c=(function(){function e(e){this._curId=0;this._errors={};this._fieldsWithErrors={};this._currentlyDeletedRecords=new i.Set;e.intEventMgr.AttachEvent(n.JsGridConstants.Internal.EventType.OnBeforeRecordInserted,this.OnRecordInserted.bind(this));e.intEventMgr.AttachEvent(n.JsGridConstants.Internal.EventType.OnBeforeRecordDeleted,this.OnRecordDeleted.bind(this));this._objBag=e}e.prototype.SetRowError=function(e,t){var i=this.AnyErrors();null==this._errors[e]&&(this._errors[e]=new l(e));var s=this._curId++;t=null!=t?t:SP.JsGrid.Res.defaultRowMessage;var o=i&&this._errors[e].AnyErrorsOnRow();this._errors[e].AddRowError(s,t);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowErrorStateChanged,r.JsGridUtil.EventArgs.OnRowErrorStateChanged(e,!0,!0,o,s,t));i||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!0));return s};e.prototype.ClearRowError=function(e,t){if(null!=this._errors[e]&&this._errors[e].ClearRowError(t)){this.TryCleanUpRecord(e);var i=e in this._errors&&this._errors[e].AnyErrorsOnRow();this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowErrorStateChanged,r.JsGridUtil.EventArgs.OnRowErrorStateChanged(e,!1,i,!0,t,null));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1));return!0}return!1};e.prototype.SetCellError=function(e,t,i){var s=this.AnyErrors();null==this._errors[e]&&(this._errors[e]=new l(e));var o=this._errors[e].AnyErrorsOnCell(t),u=this._curId++;this._errors[e].AddCellError(t,u,i);a||this.UpdateFieldKeysErrors(t,e,!0);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnCellErrorStateChanged,r.JsGridUtil.EventArgs.OnCellErrorStateChanged(e,t,!0,!0,o,u));s||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!0));return u};e.prototype.ClearCellError=function(e,t,i){if(null!=this._errors[e]&&this._errors[e].ClearCellError(t,i)){this.TryCleanUpRecord(e);var s=e in this._errors&&this._errors[e].AnyErrorsOnCell(t);a||this.UpdateFieldKeysErrors(t,e,!1);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnCellErrorStateChanged,r.JsGridUtil.EventArgs.OnCellErrorStateChanged(e,t,!1,s,!0,i));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1));return!0}return!1};e.prototype.ClearAllErrorsOnRow=function(e){var t=!1;if(e in this._errors){t=!0;this._errors[e].ClearAllErrorsOnRow();this.TryCleanUpRecord(e);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowErrorStateChanged,r.JsGridUtil.EventArgs.OnRowErrorStateChanged(e,!1,!1,-1,null,null));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1))}return t};e.prototype.ClearAllErrorsOnCell=function(e,t){var i=!1;if(e in this._errors&&this._errors[e].AnyErrorsOnCell(t)){i=!0;var s=this._errors[e].GetIdForCell(t);this._errors[e].ClearAllErrorsOnCell(t);this.TryCleanUpRecord(e);a||this.UpdateFieldKeysErrors(t,e,!1);this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnCellErrorStateChanged,r.JsGridUtil.EventArgs.OnCellErrorStateChanged(e,t,!1,!1,s,null));this.AnyErrors()||this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1))}return i};e.prototype.CellHasError=function(e,t){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)&&this._errors[e].AnyErrorsOnCell(t)};e.prototype.GetMessageForCell=function(e,t){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)?this._errors[e].GetMessageForCell(t):null};e.prototype.GetMessageForRow=function(e){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)?this._errors[e].GetMessageForRow():null};e.prototype.AnyErrors=function(){var e=!1;for(var t in this._errors)if(!this._currentlyDeletedRecords.Contains(t)){e=!0;break}return e};e.prototype.AnyErrorsInRow=function(e){return e in this._errors&&!this._currentlyDeletedRecords.Contains(e)&&this._errors[e].AnyErrors()};e.prototype.AnyErrorsInField=function(e){return this._fieldsWithErrors[e]&&this._fieldsWithErrors[e].length>0};e.prototype.GetNextError=function(e,t){var n=null;if(this.AnyErrors()){null!=e&&e<this._curId&&(n=this.GetMinError(function(n,r,i){return i>e&&(null==t||t(n,r,i))}));null==n&&(n=this.GetMinError(t))}return n};e.prototype.GetNextErrorForRecord=function(e,t,n){var r=null;if(t in this._errors&&!this._currentlyDeletedRecords.Contains(t)){null!=e&&e<this._curId&&(r=this._errors[t].GetMinError(function(t,r,i){return i>e&&(null==n||n(t,r,i))}));null==r&&(r=this._errors[t].GetMinError(n));null!=r&&(r.recordKey=t)}return r};e.prototype.ChangeKeys=function(e,t){if(this._currentlyDeletedRecords.Contains(e)){this._currentlyDeletedRecords.Remove(e);this._currentlyDeletedRecords.Add(t)}if(e in this._errors){this._errors[t]=this._errors[e];delete this._errors[e]}};e.prototype.GetMinError=function(e){var t=null;for(var n in this._errors){var r=this._errors[n].GetMinError(e);null!=r&&(null==t||r.id<t.id)&&((t=r).recordKey=n)}return t};e.prototype.OnRecordInserted=function(e){var t=this.AnyErrors();this._currentlyDeletedRecords.Remove(e.recordKey);!t&&this.AnyErrors()&&this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!0))};e.prototype.OnRecordDeleted=function(e){var t=this.AnyErrors();this._currentlyDeletedRecords.Add(e.recordKey);t&&!this.AnyErrors()&&this._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,r.JsGridUtil.EventArgs.GridErrorStateChanged(!1))};e.prototype.TryCleanUpRecord=function(e){this._errors[e].AnyErrors()||delete this._errors[e]};e.prototype.UpdateFieldKeysErrors=function(e,t,n){var r;n?void 0!==this._fieldsWithErrors[e]?this._fieldsWithErrors[e].push(t):this._fieldsWithErrors[e]=[t]:this._fieldsWithErrors[e]=(null===(r=this._fieldsWithErrors[e])||void 0===r?void 0:r.filter(function(e){return e!==t}))||[]};return e})();t.ErrorManager=c;var h=(function(){function e(){this._notificationId=null;this._lastExpandedId=null}Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0});e.prototype.Init=function(e,t){var r=this;this._objBag=t;this._objBag.eventMgr.AttachEvent(n.JsGridConstants.EventType.OnGridErrorStateChanged,this.NotifyError);this._id=e;window[this._id+"_onclick"]=function(){r._lastExpandedId=r._objBag.jsGridObj.ScrollToAndExpandNextError(r._lastExpandedId)}};e.prototype.NotifyError=function(e){if(e.bAnyErrors&&null==this._notificationId)this._notificationId=addNotification((r.JsGridUtil.Internal.IsFeatureEnabled(f),u.spGridErrorNotification),!0);else if(!e.bAnyErrors&&null!=this._notificationId){removeNotification(this._notificationId);this._notificationId=null}};return e})();t.ErrorNotificationManager=h;var p=(function(){function e(){this._errors=[]}e.prototype.AddError=function(e,t){this._errors.unshift({id:e,msg:t})};e.prototype.RemoveError=function(e){var t=r.JsGridUtil.Internal.FindInArray(this._errors,function(t){return e==t.id});if(null!=t){this._errors.splice(t,1);return!0}return!1};e.prototype.AnyErrors=function(){return 0!==this._errors.length};e.prototype.GetTopMessage=function(){return this._errors.length>0?this._errors[0].msg:null};e.prototype.GetTopId=function(){return this._errors.length>0?this._errors[0].id:null};e.prototype.GetMinError=function(e){for(var t=null,n=this._errors.length-1;n>=0;n--){var r=this._errors[n];(null==e||e(r.id))&&(t={message:r.msg,id:r.id})}return t};e.prototype.ContainsError=function(e){return null!=r.JsGridUtil.Internal.FindInArray(this._errors,function(t){return e==t.id},null)};return e})()});
define("iQe",["require","exports","Lqe","Dqe","Wqe","Nqe","Aqe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u){"use strict";var a=u.panemgr_9;u=u.tablemgr_9;Object.defineProperty(t,"__esModule",{value:!0});var f={ODB:1725},l=(function(){function e(e,t){this._cellsWithBorder=[];this._intDelegateMgr=e;this._styles=t;this._quickEditVisualRefreshFlightEnabled=n.JsGridUtil.Internal.IsFeatureEnabled(f)}e.prototype.OnMouseDown=function(e,t,r,i,o,f){e.preventDefault();this._tableMgr=o;this._selectionMgr=f;this._gridPane=t;this._parentNode=r;this._selDragHandle=i;this._selectionFrames=t.selectionFrames;this._mouseDownPos=n.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e);this._selDragHandlePos=n.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(i);this._finalRange=null;this._fillFrame=document.createElement("div");this._fillFrame.style.cssText="position:absolute;visibility:hidden;overflow:hidden;top:0px;left:0px";if(this._quickEditVisualRefreshFlightEnabled){this._gridPane.tableDiv.classList.add(u.tableHasMouseDown);this._fillFrame.classList.add(a.dragToFillFrame)}else this._fillFrame.style.border=s.StyleUtil.MakeBorderString(2,"solid",this._styles.gridPaneStyle.fillRectBorderColor);this._parentNode.appendChild(this._fillFrame);n.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(i,this.OnMouseMove.bind(this),this.OnMouseUp.bind(this));this.OnMouseMove(e)};e.prototype.OnMouseMove=function(e){var t=this._selectionMgr.GetLastSelectionRangeNormalized(),i=this._selectionMgr.GetLastSelectionType(),s=this._tableMgr.GetRowIdxColIdxFromCoord(e);this._quickEditVisualRefreshFlightEnabled&&i===r.JsGridConstants.SelectionType.RowRange&&(s.colIdx=0);if(null!=s.rowIdx&&null!=s.colIdx){var a=n.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e);if(!(a.x>=this._selDragHandlePos.x&&a.x<=this._selDragHandlePos.x+this._selDragHandle.offsetWidth&&a.y>=this._selDragHandlePos.y&&a.y<=this._selDragHandlePos.y+this._selDragHandle.offsetHeight)){this._bFillHorizVsVert=Math.abs(a.x-this._mouseDownPos.x)>Math.abs(a.y-this._mouseDownPos.y);var f;if(this._bFillHorizVsVert){this._finalRange=new o.Range(Math.min(t.colRange.begin,s.colIdx),Math.max(t.colRange.end,s.colIdx));this._quickEditVisualRefreshFlightEnabled&&i===r.JsGridConstants.SelectionType.RowRange&&(n.JsGridUtil._lastColumnVisibilityKillSwitchIsActive?this._finalRange.end=this._finalRange.end-1:this._gridPane._objBag.showAddColumnMenu&&this._gridPane._objBag.canUserAddColumn&&(this._finalRange.end=this._finalRange.end-1));f=this._gridPane.GetCellRangeBorderDrawingInfo(t.rowRange,this._finalRange,i)}else{this._finalRange=new o.Range(Math.min(t.rowRange.begin,s.rowIdx),Math.max(t.rowRange.end,s.rowIdx));this._quickEditVisualRefreshFlightEnabled&&i===r.JsGridConstants.SelectionType.RowRange&&(n.JsGridUtil._lastColumnVisibilityKillSwitchIsActive?t.colRange.end=t.colRange.end-1:this._gridPane._objBag.showAddColumnMenu&&this._gridPane._objBag.canUserAddColumn&&(t.colRange.end=t.colRange.end-1));f=this._gridPane.GetCellRangeBorderDrawingInfo(this._finalRange,t.colRange,i)}if(null!=f){if(this._quickEditVisualRefreshFlightEnabled){this._fillFrame.style.left=f.left+"px";this._fillFrame.style.top=f.top+"px";this._fillFrame.style.width=f.width-4+"px";this._fillFrame.style.height=f.height-6+"px";n.JsGridUtil.Internal.IsStickyColumnEnabled()&&this._gridPane.ClearPseudoElementFrame(this._cellsWithBorder,u.cellHasSelectionBorder);if(i===r.JsGridConstants.SelectionType.CellRange)if(n.JsGridUtil.Internal.IsStickyColumnEnabled()){var l=void 0;l=this._bFillHorizVsVert?{rowRange:t.rowRange,colRange:this._finalRange}:{rowRange:this._finalRange,colRange:t.colRange};this._gridPane.ApplyPseudoElementFrame(l,this._cellsWithBorder,u.cellHasFillDownBorder,i===r.JsGridConstants.SelectionType.RowRange);var c=f.top+f.height-6,h=void 0;h=this._gridPane._objBag.RTL.bEnabled?f.left-2:f.right-3;if(l.colRange.end<=n.JsGridUtil.Internal.stickyLastColIdx){c+=6;h+=30}this._selDragHandle.children[0].style.top=c+"px";this._selDragHandle.style.left=h+"px"}else{this._selDragHandle.style.top=f.top+f.height-6+"px";this._gridPane._objBag.RTL.bEnabled?this._selDragHandle.style.left=f.left-2+"px":this._selDragHandle.style.left=f.right-5+"px"}else if(i===r.JsGridConstants.SelectionType.RowRange)if(n.JsGridUtil.Internal.IsStickyColumnEnabled()){this._gridPane.ApplyPseudoElementFrame({rowRange:this._finalRange,colRange:t.colRange},this._cellsWithBorder,u.cellHasFillDownBorder,i===r.JsGridConstants.SelectionType.RowRange);this._selDragHandle.children[0].style.top=f.top+f.height+"px";this._gridPane._objBag.RTL.bEnabled?this._selDragHandle.style.left=f.right-7+"px":this._selDragHandle.style.left=f.left+"px"}else{this._selDragHandle.style.top=f.top+f.height-8+"px";this._gridPane._objBag.RTL.bEnabled?this._selDragHandle.style.left=f.right-7+"px":this._selDragHandle.style.left=f.left+"px"}for(var p in this._selectionFrames){this._selectionFrames[p].style.visibility="hidden"}}else{this._fillFrame.style.left=f.left-1+"px";this._fillFrame.style.top=f.top-1+"px";this._fillFrame.style.width=f.width-2+"px";this._fillFrame.style.height=f.height-2+"px"}n.JsGridUtil.Internal.IsStickyColumnEnabled()||(this._fillFrame.style.visibility="")}else this._fillFrame.style.visibility="hidden"}}};e.prototype.OnMouseUp=function(e){var t=this;if(null!=this._finalRange){this._quickEditVisualRefreshFlightEnabled&&this._gridPane.tableDiv.classList.remove(u.tableHasMouseDown);var i=this.ComputeFillParameters(),s=function(){t.Fill(i.repeatOrigin,i.srcRowRange,i.srcColRange,i.destRowRange,i.destColRange,i.trimmedDestRowRange,i.trimmedDestColRange)};if(n.JsGridUtil._lookupFieldCopyPasteKillSwitchIsActive)s();else{var o=[n.JsGridUtil.taxonomyLoadCallback],a=n.JsGridUtil.Internal.SiteUrl+"/",f=r.JsGridConstants.csomFiles.map(function(e){return a+e});n.JsGridUtil.csomJsFilesLoader._ensureExternalJsFilesLoaded(f,s,o)}this._parentNode.removeChild(this._fillFrame);this._fillFrame=null}};e.prototype.ComputeFillParameters=function(){var e,t,r,i,s,u,a,f,l=this._selectionMgr.GetLastSelectionRangeNormalized();this._quickEditVisualRefreshFlightEnabled&&!n.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===(null===(e=l.colRange)||void 0===e?void 0:e.begin)&&(l.colRange.begin=0);if(this._bFillHorizVsVert){r=s=a=l.rowRange;u=this._finalRange;var c=l.colRange.begin!==u.begin;t=c?"TR":"TL";var h=l.colRange.Size();i=c?new o.Range(u.end-h+1,u.end):new o.Range(u.begin,u.begin+h-1);f=c?new o.Range(u.begin,u.end-h):new o.Range(u.begin+h,u.end)}else{i=u=f=l.colRange;s=this._finalRange;var p=l.rowRange.begin!==s.begin;t=p?"BL":"TL";var d=l.rowRange.Size();r=p?new o.Range(s.end-d+1,s.end):new o.Range(s.begin,s.begin+d-1);a=p?new o.Range(s.begin,s.end-d):new o.Range(s.begin+d,s.end)}return{repeatOrigin:t,srcRowRange:r,srcColRange:i,destRowRange:s,destColRange:u,trimmedDestRowRange:a,trimmedDestColRange:f}};e.prototype.Fill=function(e,t,s,o,a,f,l){var c,h=this;if(t.Size()!=o.Size()||s.Size()!=a.Size()){var p=this._selectionMgr.GetLastSelectionRangeNormalized();n.JsGridUtil.Internal.IsStickyColumnEnabled()&&this._quickEditVisualRefreshFlightEnabled&&!n.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===(null===(c=p)||void 0===c?void 0:c.colRange.begin)&&this._gridPane.ClearPseudoElementFrame(this._cellsWithBorder,u.cellHasFillDownBorder);var d,v=this._gridPane.GetGridPaneConverter();this._intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return d=v.GetRecordsInvolved(o.begin,o.Size(),function(t){d=t;e()})},function(){var n=h._gridPane.GetData(d,t,s,!1);h._gridPane.PutData(n,d,r.JsGridConstants.UserAction.Fill,e,f,l,function(){h._selectionMgr.SelectRange(h._gridPane,o.begin,o.end,a.begin,a.end,i.SelectOp.Set,!0,!1)})})}else if(this._quickEditVisualRefreshFlightEnabled)for(var m in this._selectionFrames){this._selectionFrames[m].style.visibility=""}};return e})();t.FillDownManager=l});
define("aQe",["require","exports","Dqe","Lqe","RWe","Eqe","kqe","Wqe","Ak","tQe","we","k","Oqe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d=p.tablemgr_9;p=p.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var v=c.Killswitch.isActivated("CAF8B57F-023A-49B5-B7B6-A92006D95286","10/11/2019","Fix several issues with items positioned far off to the left causing RTL bugs."),m=c.Killswitch.isActivated("412EE39D-F6D7-4C5A-ABE0-499D90CC520E","12/09/2019","Fix flashing input on cell click by using hide css styles."),g=c.Killswitch.isActivated("9340DEC3-CF41-4D00-BDD8-2AA84E33D2C2","2/05/2020","Make headers accessible with keyboard only."),y=c.Killswitch.isActivated("E2B8D098-22B3-4FF6-973C-1CA708C3F688","03/06/2020","When changing focus from cell to cell clear contenteditable attribute to fix cursor styles."),b=c.Killswitch.isActivated("4EBDFA82-3637-4E42-9416-99D77B1E1CF0","07/02/2020","Append hidden focus input after grid container, rather than before, to support tabbing out of grid."),w=c.Killswitch.isActivated("94D1C283-66A1-43E6-A223-FA801BFD0A7E","07/13/2020","Remove from DOM skip grid anchor elements as they are not needed with changing Tab keyboard behavior in the grid"),E=c.Killswitch.isActivated("CF0631CE-5CB5-4AD4-B272-B737F7CDB26A","07/15/2020","Remove contenteditable attribute on focusing a cell because it is causing screen reader to announce the content twice"),S=c.Killswitch.isActivated("F1E7EE96-302E-45B3-AAE3-C1693C9BD07B","09/10/2020","Fix an issue with the classic javascript believing its loaded before its loaded."),x={ODB:1725},T={ODB:1024},N={ODB:60017},C=(function(){function e(e,t,i,s,o,u,a,l,c,h,p){var d=this;this.FocusElementType={anchor:0,input:1,parentNode:2};this._focusElementType=this.FocusElementType.input;this._bUseInputFocusElementForTextInput=!0;this._supportChromePaste=!0;this.OnBlur=function(e){};this.OnFocusEntryPointKeyDown=function(e){if(e.keyCode===n.JsGridConstants.Key.enter){e.preventDefault();e.stopPropagation();var t=d._gridPane.tableMgr.GetColumnHeaderTr(),r=f.extraSpacerColumnsKillswitchIsActive?0:2;if(t)for(var i=0;i<t.children.length-r;i++)t.children[i].setAttribute("tabindex","0");var s=d._selectionMgr.GetFocusForPane(d._gridPane);d._gridPane.ScrollCellIntoView(s.rowIdx,s.colIdx);d._focusElement.removeAttribute("tabindex");d.Focus()}};this.OnFocusEntryPointFocus=function(e){var t=d._gridPane.tableMgr.GetColumnHeaderTr(),n=f.extraSpacerColumnsKillswitchIsActive?0:2;if(t)for(var r=0;r<t.children.length-n;r++)t.children[r].setAttribute("tabindex","-1");d._focusElement.setAttribute("tabindex","-1")};this._jsGridElementId=e;this._objBag=t;this._fnGetLocStr=s;this._fnIsGridEnabled=o;this._fnIsGridVisible=u;this._selectionMgr=a;this._editMgr=l;this._fnGetCellValue=c;this._fnRetryErrorRows=h;this._fnScrollIntoViewVertically=p;this._parentNode=i;r.JsGridUtil._uniqueGridIdKillSwitchIsActive?this._gridFocusEntryPoint=document.getElementById("gridFocusEntryPoint"+r.JsGridUtil.privateWpq):this._gridFocusEntryPoint=document.getElementById("gridFocusEntryPoint"+t.jsGridParams.gridId);this._outerGridParentNode=i.parentNode;this.Init()}e.prototype.SetView=function(e,t,n,r){this._paneLayout=e;this._gridPane=t;this._pivotedGridPane=n;this._gridFieldMap=r;this._ariaMgr.NotifyViewChange()};e.prototype.Dispose=function(){r.JsGridUtil.ClearEventListeners(this._skippedGridContentElement);this._focusElement.removeEventListener("focus",this.OnFocus);this._focusElement.removeEventListener("paste",this.onPaste);this._focusElement.removeEventListener("keydown",this.OnKeyDown);this._focusElement.removeEventListener("keypress",this.OnKeyPress);this._focusElement.removeEventListener("keyup",this.OnKeyUp);r.JsGridUtil.Internal.IsFeatureEnabled(N)&&this._focusElement.removeEventListener("blur",this.OnBlur);this._focusElement=this._skippedGridContentElement=null;if(r.JsGridUtil.Internal.IsFeatureEnabled(N)){this._gridFocusEntryPoint.removeEventListener("keydown",this.OnFocusEntryPointKeyDown);this._gridFocusEntryPoint.removeEventListener("focus",this.OnFocusEntryPointFocus);this._gridFocusEntryPoint=null}};e.prototype.Focus=function(){try{this._editMgr.IsEditing()&&this._editMgr.StopEditing(!1);this.SetStyleForFocusElementInput(!0)}catch(e){r.JsGridUtil.DebugAssert(!1,"The grid cannot be focused because it is hidden. Possible scenario: if the grid was editable, it might have been in edit; call grid.NotifyHide() or hide the grid using the fnContinue of grid.FinalizeEditing(fnContinue, fnError).")}};e.prototype.GetFocusElementForTextInput=function(e){return!this._bUseInputFocusElementForTextInput||this._focusElementType!=this.FocusElementType.input||e!=i.EditControlType.EditBox&&e!=i.EditControlType.PeoplePicker&&e!=i.EditControlType.LocationPicker?null:this._focusElement};e.prototype.ChangeTextInputElementToFocusElement=function(){if(this.FocusElementIsBeingUsedForTextInput()){this._focusElement.blur();this.SetStyleForFocusElementInput();return!0}return!1};e.prototype.HandleKeyDown=function(e,t,i){var f=this,l=r.JsGridUtil.Internal.IsFeatureEnabled(x),c=l?-1:0;!l||r.JsGridUtil._lastColumnVisibilityKillSwitchIsActive||this._objBag.showAddColumnMenu||this._objBag.canUserAddColumn||(c=0);var h=e.ctrlKey&&!e.altKey&&!e.shiftKey,p=!e.ctrlKey&&e.altKey&&!e.shiftKey,v=!e.ctrlKey&&!e.altKey&&e.shiftKey,m=!e.ctrlKey&&e.altKey&&e.shiftKey,y=e.ctrlKey&&!e.altKey&&e.shiftKey,b=!e.ctrlKey&&!e.altKey&&!e.shiftKey,w=this._selectionMgr.GetFocus();if(!this._fnIsGridEnabled()||null==w)return!1;var E=w.gridPane,S=E.GetGridPaneConverter();if((function(){if(null==f._curFocusedDisplayControlInfo)return!1;if(e.target==f._curFocusedDisplayControlInfo.DOMElement&&(e.keyCode==n.JsGridConstants.Key.tab||e.keyCode==n.JsGridConstants.Key.shift)){if(e.keyCode==n.JsGridConstants.Key.tab){b?f._curFocusedDisplayControlInfo.DOMElement=f._curFocusedDisplayControlInfo.displayControl.FocusNext(f._curFocusedDisplayControlInfo.displayControlContent,f._curFocusedDisplayControlInfo.DOMElement):v&&(f._curFocusedDisplayControlInfo.DOMElement=f._curFocusedDisplayControlInfo.displayControl.FocusPrevious(f._curFocusedDisplayControlInfo.displayControlContent,f._curFocusedDisplayControlInfo.DOMElement));null==f._curFocusedDisplayControlInfo.DOMElement&&f.Focus()}return!0}f.Focus();return!1})()){r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}if(e.keyCode==n.JsGridConstants.Key.IMEInput&&E.TryBeginEdit(e))return!0;var C=(function(){if(e.keyCode==n.JsGridConstants.Key.esc){f._objBag.cutcopypasteMgr.CancelMode();f._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnRowEscape,r.JsGridUtil.EventArgs.OnRowEscape(w.recordKey));if(r.JsGridUtil.Internal.IsFeatureEnabled(N)){E.UpdateRowClassesOnSingleCellSelection(w.rowIdx,-1);E.HideFocusStyles();E.ScrollCellIntoView(0,0);f._gridFocusEntryPoint.focus()}return!0}return!1})()||(function(){var t=function(e){var t=f._objBag.jsGridObj.GetContiguousRowSelectionWithoutEntryRecords(),n=null!=t?t.keys:[];if(n.length>0)if(e){if(f._objBag.jsGridObj.CanMoveRecordsDownByOne(n)){f._objBag.jsGridObj.MoveRecordsDownByOne(n);return!0}}else if(f._objBag.jsGridObj.CanMoveRecordsUpByOne(n)){f._objBag.jsGridObj.MoveRecordsUpByOne(n);return!0}},d=function(){if(l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&b){if(-1===w.colIdx){f._selectionMgr.SelectRange(E,w.rowIdx,w.rowIdx,w.colIdx,S.GetVirtualColumnCount()-1+c,u.SelectOp.Set,!1,!1);return!0}if(f._selectionMgr.GetLastSelectionType()===u.SelectionType.RowRange){f._selectionMgr.SetFocusByPos(E,w.rowIdx,-1);return!0}}return!1};if(r.JsGridUtil.Internal.IsFeatureEnabled(T)&&f._objBag&&f._objBag.eventMgr){var v=String.fromCharCode(e.keyCode).toUpperCase(),g=e.metaKey&&!e.ctrlKey&&!e.shiftKey,x=e.metaKey&&!e.ctrlKey&&e.shiftKey;if((h||g)&&"Z"===v){f._objBag.eventMgr.FireEvent(a.default.undoChangeEventName);return!0}if(h&&"Y"===v||(y||x)&&"Z"===v){f._objBag.eventMgr.FireEvent(a.default.redoChangeEventName);return!0}}switch(e.keyCode){case n.JsGridConstants.Key.del:if(b||h){if(f._objBag.editUtil.IsEditingEnabled()){var C=f._objBag.jsGridObj.GetSelectedRowRanges();b&&0==C.length?(function(){var e=f._objBag.tableCache.GetCachedRecord(w.recordKey);null==e&&(e=f._objBag.jsGridObj.GetRecord(w.recordKey));if(null!=e&&f._objBag.editUtil.CanEditField(e,S.GetColumnByIdx(w.colIdx),w.fieldKey)){var t=o.CreateUnvalidatedPropertyUpdate(w.recordKey,w.fieldKey,null,!0);f._objBag.jsGridObj.UpdateProperties([t],n.JsGridConstants.UserAction.UserEdit)}})():f._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.DeleteRecords)}else alert(f._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.insert:if(b){f._objBag.editUtil.IsEditingEnabled()?f._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.InsertRecord):alert(f._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.down:if(p){E.ScrollCellIntoView(w.rowIdx,w.colIdx);var k=E.GetCellByIdx(w.rowIdx,w.colIdx);null!=k&&null!=k.GetRecord()&&f._editMgr.IsBound()&&f._editMgr.ExpandNextActor();return!0}if(m)return t(!0);break;case n.JsGridConstants.Key.up:if(p){(function(){E.ScrollCellIntoView(w.rowIdx,w.colIdx);var e=E.GetCellByIdx(w.rowIdx,w.colIdx);if(null!=e){var t=(function(e){var t=e.GetColumn(),n=e.GetRecord(),r=e.GetFieldKey();if(null!=n){var i=n.GetProp(r),o=null==i?f._gridFieldMap[r].GetPropType():i.propType;return s.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(o,t.fnGetDisplayControlName&&t.fnGetDisplayControlName(n,r))}return null})(e),n=e.GetTd().childNodes;if(n&&t&&t.FocusNext&&t.FocusPrevious){var r=t.FocusNext(n,null);if(null!=r){f._curFocusedDisplayControlInfo={};f._curFocusedDisplayControlInfo.displayControl=t;f._curFocusedDisplayControlInfo.displayControlContent=n;f._curFocusedDisplayControlInfo.DOMElement=r;f._focusElementType==f.FocusElementType.input&&f._parentNode.addEventListener("keydown",f.OnKeyDown.bind(f))}}}})();return!0}if(m)return t(!1);break;case n.JsGridConstants.Key.right:if(m){f._objBag.editUtil.IsEditingEnabled()?f._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.IndentRecords):alert(f._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.left:if(m){f._objBag.editUtil.IsEditingEnabled()?f._objBag.delegateMgr.Apply(n.JsGridConstants.DelegateType.OutdentRecords):alert(f._fnGetLocStr("GridNotEditable"));return!0}break;case n.JsGridConstants.Key.comma:if(y)return E.TryShiftColumnSelectionGroup(w.rowIdx,w.colIdx,-1);break;case n.JsGridConstants.Key.dot:if(y)return E.TryShiftColumnSelectionGroup(w.rowIdx,w.colIdx,1);break;case n.JsGridConstants.Key.back_slash:if(p)return E.ExpandColumnMenu(w.colIdx);if(y){f._fnRetryErrorRows();return!0}break;case n.JsGridConstants.Key.F2:if(b)return E.TryBeginEdit(e);break;case n.JsGridConstants.Key.enter:var L=d();return L||!r.JsGridUtil.Internal.IsFeatureEnabled(N)||f._editMgr.IsEditing()||!b||i?L:E.TryBeginEdit(e);case n.JsGridConstants.Key.space:return d()}return!1})()||(function(){var t=function(t,i){var s;switch(e.keyCode){case n.JsGridConstants.Key.enter:if(l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===i)break;if(r.JsGridUtil.Internal.IsFeatureEnabled(N)&&!(null===(s=f._editMgr._curRecord)||void 0===s?void 0:s.bIsNewRow))break;if(b)null!=t&&t++;else{if(!v)return null;null!=t&&--t}break;case n.JsGridConstants.Key.down:if(!(b||v||h||y))return null;e.ctrlKey?t=S.GetVirtualRowCount()-1:null!=t&&t++;l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&f._selectionMgr.GetLastSelectionType()===u.SelectionType.RowRange&&(i=-1);break;case n.JsGridConstants.Key.up:if(!(b||v||h||y))return null;e.ctrlKey?t=0:null!=t&&t--;l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&f._selectionMgr.GetLastSelectionType()===u.SelectionType.RowRange&&(i=-1);break;case n.JsGridConstants.Key.pageDown:if(!b&&!v)return null;if(null!=t){o=(o=S.RowIdxToRelRowIdx(t))!==(a=S.GetWholeRowDisplayCapacity()-1)?a:2*a;t=S.RelRowIdxToRowIdx(o)}break;case n.JsGridConstants.Key.pageUp:if(!b&&!v)return null;if(null!=t){var o=S.RowIdxToRelRowIdx(t),a=S.GetWholeRowDisplayCapacity()-1;o=0!==o?0:-a;t=S.RelRowIdxToRowIdx(o)}break;case n.JsGridConstants.Key.home:if(!(b||v||h||y))return null;i=0;e.ctrlKey&&(t=0);l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&(i=-1);break;case n.JsGridConstants.Key.end:if(!(b||v||h||y))return null;i=S.GetVirtualColumnCount()-1+c;e.ctrlKey&&(t=S.GetVirtualRowCount()-1+c);break;case n.JsGridConstants.Key.right:if(!b&&!v)return null;if(null!=i){i+=f._objBag.RTL.bEnabled?-1:1;i=S.GetVirtualColumnCount()-1!==i||f._objBag.RTL.bEnabled?i:i+c;l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&f._selectionMgr.GetLastSelectionType()===u.SelectionType.RowRange&&(i=0)}break;case n.JsGridConstants.Key.left:if(!b&&!v)return null;if(null!=i){i-=f._objBag.RTL.bEnabled?-1:1;i=S.GetVirtualColumnCount()-1===i&&f._objBag.RTL.bEnabled?i+c:i}break;case n.JsGridConstants.Key.six:if(!y)return null;i=0;t=S.GetVirtualRowCount()-1;break;default:return null}if(null!=t){g||-1!==Math.min(S.GetVirtualRowCount()-1,t)||e.shiftKey||f._gridPane.SetFocusToHeader(i+1);t=l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?Math.max(-1,Math.min(S.GetVirtualRowCount()-1,t)):Math.max(0,Math.min(S.GetVirtualRowCount()-1,t))}null!=i&&(i=l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?Math.max(-1,Math.min(S.GetVirtualColumnCount()-1,i)):Math.max(0,Math.min(S.GetVirtualColumnCount()-1,i)));return{rowIdx:t,colIdx:i}};if(h||p||v||m||b||y)if(e.keyCode==n.JsGridConstants.Key.tab){if(null!=(i=(function(t,n){var i=n,s=t;if(e.shiftKey){if(--n==(l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?-1:0)-1){n=S.GetVirtualColumnCount()-1+c;if(-1==--t){if(!l||r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive)return null;f._gridPane.SetFocusToHeader(S.GetVirtualColumnCount())}}}else if(++n==S.GetVirtualColumnCount()+c){n=l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?-1:0;if(++t==S.GetVirtualRowCount()){if(!r.JsGridUtil.Internal.IsFeatureEnabled(N))return null;n=i;t=s}}return{rowIdx:t,colIdx:n}})(w.rowIdx,w.colIdx))){if(l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){E.UpdateRowClassesOnSingleCellSelection(w.rowIdx,i.rowIdx);E._selectAllCell.GetTd().classList.remove(d.allRowsSelected)}-1===i.rowIdx?E.HideFocusStyles():f._selectionMgr.SetFocusByPos(E,i.rowIdx,i.colIdx);return!0}}else if(!e.shiftKey||v&&e.keyCode==n.JsGridConstants.Key.enter){if(null!=(i=t(w.rowIdx,w.colIdx))){if(l&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){E.UpdateRowClassesOnSingleCellSelection(w.rowIdx,i.rowIdx);E._selectAllCell.GetTd().classList.remove(d.allRowsSelected)}-1===i.rowIdx?E.HideFocusStyles():f._selectionMgr.SetFocusByPos(E,i.rowIdx,i.colIdx);return!0}}else{var i,s=f._selectionMgr.GetLastSelectionEndpoints();if(null!=(i=t(s.rowIdx2,s.colIdx2))){if(-1===i.colIdx&&-1===s.colIdx1&&-1===s.colIdx2||-1===i.rowIdx)return!0;null!=i.rowIdx&&null!=i.colIdx?E.ScrollCellIntoView(i.rowIdx,i.colIdx):null!=i.rowIdx?f._fnScrollIntoViewVertically(i.rowIdx):null!=i.colIdx&&E.ScrollColumnIntoViewHorizontally(i.colIdx);f._selectionMgr.SelectRange(E,s.rowIdx1,i.rowIdx,s.colIdx1,i.colIdx,u.SelectOp.Set,!1,!1);return!0}}return!1})()||(function(){var t=f._gridPane.GetGridPaneConverter();if(e.keyCode==n.JsGridConstants.Key.tab){if(f._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid)if(b){if(E.Id==n.JsGridConstants.PaneId.MainGrid){f._selectionMgr.SetFocusByPos(f._pivotedGridPane,0,0);return!0}}else if(v&&E.Id==n.JsGridConstants.PaneId.PivotedGrid){var r=t.GetVirtualRowCount()-1,i=t.GetVirtualColumnCount()-1;f._selectionMgr.SetFocusByPos(f._gridPane,r,i);return!0}f._selectionMgr.Clear()}else if(e.keyCode==n.JsGridConstants.Key.F6&&!e.ctrlKey&&f._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid){if(E.Id==n.JsGridConstants.PaneId.MainGrid){f._selectionMgr.SetFocusByPos(f._pivotedGridPane,f._pivotedGridPane.GetGridPaneConverter().GetTopRowIdxForKey(w.recordKey),0);return!0}if(E.Id==n.JsGridConstants.PaneId.PivotedGrid){f._selectionMgr.SetFocusByPos(f._gridPane,t.GetTopRowIdxForKey(w.recordKey),0);return!0}}return!1})();C||t||(C=(function(){var t=f._objBag.cutcopypasteMgr;if((e.ctrlKey||e.rawEvent&&e.rawEvent.metaKey)&&!e.altKey&&!e.shiftKey)switch(String.fromCharCode(e.keyCode).toUpperCase()){case"X":t.OnCut(E);return!0;case"C":t.OnCopy(E);return!0;case"V":t.OnPaste(E);return!f._supportChromePaste||t.hasClipBoardData()}return!1})()||(function(){var t=E.GetCellByIdx(w.rowIdx,w.colIdx);if(null!=t){var n=t.GetRecord();if(null!=n){var r=t.GetColumn(),i=t.GetFieldKey(),o=f._gridFieldMap[i],u=n.GetProp(i),a=null==u?o.GetPropType():u.propType,l=s.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(a,r.fnGetDisplayControlName&&r.fnGetDisplayControlName(n,i));if(null!=l.OnKeyDown)return l.OnKeyDown(e,f._fnGetCellValue(n,i,a),n,r,o,a,f._objBag.jsGridObj)}}return!1})());C||(C=(function(t){if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&"Y"==String.fromCharCode(e.keyCode).toUpperCase()){var r=E.IsRowHeadersEnabled()?1:0;if(f._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid&&E.Id==n.JsGridConstants.PaneId.PivotedGrid){var i=E.GetVisibleColumns().length;f._pivotedGridPane.SetFocusToHeader(i+t+r)}else f._gridPane.SetFocusToHeader(t+r);return!0}return!1})(w.colIdx-E.BeginColIdx()));if(C){r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);return!0}!f._editMgr.IsEditing()&&f._selectionMgr.IsOneCellSelected(f._selectionMgr.GetLastSelectionRangeNormalized())&&f._objBag.eventMgr.FireEvent(n.JsGridConstants.EventType.OnSingleCellKeyDown,r.JsGridUtil.EventArgs.SingleCellKeyDown(e,w.recordKey,w.fieldKey));return!1};e.prototype.FocusElementIsBeingUsedForTextInput=function(){return this._editMgr.IsEditing()&&null!=this.GetFocusElementForTextInput(this._editMgr.GetCurrentEditControlName())&&this._editMgr.IsCurrentEditControlUsingGridTextInputElement()};e.prototype.OnFocus=function(){if(!this.FocusElementIsBeingUsedForTextInput()&&this._fnIsGridVisible()){var e=this._selectionMgr.GetFocus();if(null==e){if(null==this._gridPane)return;var t=this._gridPane.GetGridPaneConverter();if(0==t.GetVirtualRowCount())return;this._selectionMgr.SetFocusByPos(this._gridPane,t.GetTopRowIdx(),this._gridPane.GetLeftMostColumnIdx())}else e.gridPane.ShowFocus(!0);if(null!=this._curFocusedDisplayControlInfo){this._curFocusedDisplayControlInfo=null;this._focusElementType==this.FocusElementType.input&&this._parentNode.removeEventListener("keydown",this.OnKeyDown)}}};e.prototype.OnKeyDown=function(e){var t=this;if(this.FocusElementIsBeingUsedForTextInput())this._editMgr.OnActorKeyDown(e,this._editMgr.GetCurrentEditControlName());else if(this._editMgr.IsEditing()){if(this._focusElementType!=this.FocusElementType.input)return;this._editMgr.StopEditing();this.HandleKeyDown(e)}else{var i=e.ctrlKey||e.rawEvent&&e.rawEvent.metaKey;if(r.JsGridUtil._lookupFieldCopyPasteKillSwitchIsActive||!i||e.altKey||e.shiftKey||"V"!==String.fromCharCode(e.keyCode).toUpperCase())this.HandleKeyDown(e);else{var s=[r.JsGridUtil.taxonomyLoadCallback],o=r.JsGridUtil.Internal.SiteUrl+"/",u=n.JsGridConstants.csomFiles.map(function(e){return o+e});r.JsGridUtil.csomJsFilesLoader._ensureExternalJsFilesLoaded(u,function(){return t.HandleKeyDown(e)},s)}}};e.prototype.OnKeyPress=function(e){var t=this;if(!this._editMgr.IsEditing()){var n=this._selectionMgr.GetFocus();if(this._fnIsGridEnabled()&&null!=n){var i=n.gridPane;if(!r.JsGridUtil.Internal.IsFeatureEnabled(x)||r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive||-1!==n.colIdx&&this._selectionMgr.GetLastSelectionType()!==u.SelectionType.RowRange){!r.JsGridUtil.Utility.IsChar(e)||e.altKey||e.ctrlKey||i.TryBeginEdit(e)&&!t.FocusElementIsBeingUsedForTextInput()&&r.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)}}}};e.prototype.OnKeyUp=function(e){this._editMgr.IsEditing()||this._focusElementType===this.FocusElementType.input&&(this._focusElement.value="")};e.prototype.CreateFocusElement=function(){switch(this._focusElementType){case this.FocusElementType.anchor:this._focusElement=this.CreateFocusElementAnchor();this.CreateSkipGridHtmlElements(this._focusElement,this._focusElement);break;case this.FocusElementType.input:this._focusElement=this.CreateFocusElementInput();this.SetStyleForFocusElementInput();w&&this.CreateSkipGridHtmlElements(this._parentNode,this._parentNode);break;case this.FocusElementType.parentNode:this._focusElement=this.CreateFocusElementParentNode();this.CreateSkipGridHtmlElements(this._parentNode,this._parentNode);break;default:r.JsGridUtil.DebugAssert(!1,"Invalid focus element type")}r.JsGridUtil._removeExtraPasteListenerKillSwitchIsActive&&this._focusElement.addEventListener("paste",this.onPaste.bind(this))};e.prototype.onPaste=function(e){var t=this;if(!this._supportChromePaste)return!0;e.rawEvent&&(e=e.rawEvent);if(e&&e.clipboardData&&e.clipboardData.types&&e.clipboardData.getData){var n=this._selectionMgr.GetFocus(),r=e.clipboardData.getData("text/plain");if(S)this._objBag.cutcopypasteMgr.OnPaste(n.gridPane,r);else{var i=function(){SP&&SP.ClientContext?t._objBag.cutcopypasteMgr.OnPaste(n.gridPane,r):setTimeout(i,500)};i()}return!1}return!0};e.prototype.CreateFocusElementAnchor=function(){var e=document.createElement("a");e.id=this._jsGridElementId+"_focusElement";e.href="#";this._outerGridParentNode.insertBefore(e,this._parentNode);e.appendChild(this._parentNode);return e};e.prototype.CreateFocusElementInput=function(){var e=document.createElement("input");e.id=this._jsGridElementId+"_focusElement";var t=r.JsGridUtil.Internal.IsFeatureEnabled(x)?p.spGridControlFocusElement:"jsgrid-control-editbox jsgrid-control-focuselement";e.className=t;!b&&this._parentNode.parentNode?this._parentNode.parentNode.appendChild(e):this._parentNode.insertBefore(e,this._parentNode.firstChild);return e};e.prototype.SetStyleForFocusElementInput=function(e){var t=this,n=this._focusElement.style;if(!m){n.background="transparent";n.borderColor="transparent";n.color="transparent";n.outlineColor="transparent";n.borderWidth="0px";n.outlineWidth="0px";n.outline="none"}n.position="fixed";n.top="0px";n[this._objBag.RTL.left]="-10000px";n[this._objBag.RTL.right]="";this._focusElement.value="";if(e){var i=r.JsGridUtil.Internal.GetScrollParent(this._focusElement),s={x:i.scrollLeft+document.body.clientWidth/3,y:i.scrollTop+document.body.clientHeight/3};if(null!=s){n.top=String(s.y)+"px";v?n.left=String(s.x)+"px":n[this._objBag.RTL.left]=String(s.x)+"px"}var o=0,u=void 0;r.JsGridUtil.Internal.isSpClient(i)&&(o=(u=r.JsGridUtil.Internal.GetScrollParent(i.parentElement)).scrollTop);this._focusElement.focus();r.JsGridUtil.Internal.isSpClient(i)&&u&&(u.scrollTop=o);null!=s&&window.setTimeout(function(){n.top="0px";v?n.left="-10000px":n[t._objBag.RTL.left]="-10000px"},0)}};e.prototype.CreateFocusElementParentNode=function(){this._parentNode.tabIndex=0;return this._parentNode};e.prototype.CreateSkipGridHtmlElements=function(e,t){var i=this;this._skipGridContentElement=document.createElement("a");this._skipGridContentElement.id=this._jsGridElementId+"_skipGridContent";this._skipGridContentElement.href="javascript:;";this._skipGridContentElement.className=v?"ms-accessible ms-acc-button":"ms-accessible-quickedit ms-acc-button";r.JsGridUtil.Internal.IsFeatureEnabled(x)&&(this._skipGridContentElement.className=p.skipGridContentButton);this._skipGridContentElement.onclick=function(){document.getElementById(i._jsGridElementId+"_skippedGridContent").focus()};r.JsGridUtil.Internal.DomElement.GetInstance().SetText(this._skipGridContentElement,SP.JsGrid.Res.skipGridContent);this._outerGridParentNode.insertBefore(this._skipGridContentElement,e);this._skippedGridContentElement=document.createElement("a");this._skippedGridContentElement.id=this._jsGridElementId+"_skippedGridContent";this._skippedGridContentElement.href="javascript:;";this._skippedGridContentElement.className=v?"ms-accessible ms-acc-button":"ms-accessible-quickedit ms-acc-button";r.JsGridUtil.Internal.IsFeatureEnabled(x)&&(this._skippedGridContentElement.className=p.skipGridContentButton);this._skippedGridContentElement.onclick=function(){document.getElementById(i._jsGridElementId+"_skipGridContent").focus()};r.JsGridUtil.Internal.DomElement.GetInstance().SetText(this._skippedGridContentElement,SP.JsGrid.Res.backToTopOfGridContent);this._outerGridParentNode.insertBefore(this._skippedGridContentElement,t.nextSibling);this._skippedGridContentElement.addEventListener("keydown",function(e){if(e.shiftKey&&e.keyCode==n.JsGridConstants.Key.tab){if(null==i._selectionMgr.GetFocus()){var t=i._paneLayout==n.JsGridConstants.PaneLayout.GridAndPivotedGrid?i._pivotedGridPane:i._gridPane,r=t.GetGridPaneConverter(),s=r.GetVirtualRowCount()-1,o=r.GetVirtualColumnCount()-1;i._selectionMgr.SetFocusByPos(t,s,o)}}})};e.prototype.Init=function(){r.JsGridUtil.DebugAssert(this._focusElementType==this.FocusElementType.input,"Focus element needs to be an input (see xbrowser+IME support req). This may change only if code branches to use the parentNode or the TDs for More Access. Mode.");this.CreateFocusElement();this._ariaMgr=this._objBag.ariaMgr=new k(this);this._focusElement.addEventListener("focus",this.OnFocus.bind(this));this._focusElement.addEventListener("keydown",this.OnKeyDown.bind(this));this._focusElement.addEventListener("keypress",this.OnKeyPress.bind(this));this._focusElement.addEventListener("keyup",this.OnKeyUp.bind(this));if(r.JsGridUtil.Internal.IsFeatureEnabled(N)){this._gridFocusEntryPoint.addEventListener("keydown",this.OnFocusEntryPointKeyDown);this._gridFocusEntryPoint.addEventListener("focus",this.OnFocusEntryPointFocus);this._focusElement.addEventListener("blur",this.OnBlur)}this._focusElement.addEventListener("paste",this.onPaste.bind(this))};return e})();t.FocusManager=C;var k=(function(){function e(e){this._focusMgr=e;this.Init()}e.prototype.Init=function(){this._focusMgr._focusElement.setAttribute("role","grid");var e=document.createElement("label");e.id=this._focusMgr._focusElement.id+"_labelFor";e.setAttribute("for",this._focusMgr._focusElement.id);e.appendChild(document.createTextNode(this._focusMgr._objBag.jsGridObj.name));e.style.cssText="display:none;";this._focusMgr._parentNode.appendChild(e);this._focusMgr._focusElement.setAttribute("aria-label",this._focusMgr._objBag.jsGridObj.name);this._focusMgr._focusElement.setAttribute("aria-labelledby",this._focusMgr._focusElement.id+"_labelFor");this._focusMgr._focusElement.setAttribute("aria-multiselectable","true");this._focusMgr._focusElementType==this._focusMgr.FocusElementType.input&&this._focusMgr._focusElement.setAttribute("aria-owns",this._focusMgr._jsGridElementId)};e.prototype.NotifyViewChange=function(){this.EnableGrid(this._focusMgr._fnIsGridEnabled());this.EnableGridEditing(this._focusMgr._objBag.editUtil.IsEditingEnabled())};e.prototype.EnableGrid=function(e){this._focusMgr._focusElement.setAttribute("aria-disabled",(!e).toString())};e.prototype.EnableGridEditing=function(e){this._focusMgr._focusElement.setAttribute("aria-readonly",(!e).toString())};e.prototype.OnFocusCell=function(e,t,n,r,i){var s,o;if(null!=t){(u=t.GetTd()).removeAttribute("id");u.removeAttribute("aria-describedby");y||u.removeAttribute("contenteditable");this.SetSelected(u,!1);if(null!=n){(h=n.GetTd()).removeAttribute("id")}}if(null!=r){var u=r.GetTd(),a=l.format("{0}_{1}_{2}_{3}",this._focusMgr._jsGridElementId,e,r.GetRowIdx(),null!=(s=r.GetColIdx())?s:"selectionCell");u.setAttribute("id",a);this._focusMgr._focusElement.setAttribute("aria-activedescendant",a);this.SetSelected(u,!0);var f=r.GetRecord(),c=null!=f&&this._focusMgr._objBag.editUtil.CanEditField(f,r.GetColumn(),r.GetFieldKey());u.setAttribute("aria-readonly",(!c).toString());E&&u.setAttribute("contenteditable",c.toString());if(null!=i){var h=i.GetTd(),p=l.format("{0}_{1}_{2}",this._focusMgr._jsGridElementId,e,null!=(o=i.GetColIdx())?o:"selectionCell");h.setAttribute("id",p);u.setAttribute("aria-describedby",p)}}else this._focusMgr._focusElement.removeAttribute("aria-activedescendant")};e.prototype.OnInsertTableRow=function(e,t,r){e.setAttribute("role","row");if(null!=t||-1!=r){null!=t&&t!==n.JsGridConstants.Internal.LoadErrorState||e.setAttribute("aria-busy",null==t?"true":"error");var i=this._focusMgr._selectionMgr.GetFocusedPane(),s=this._focusMgr._selectionMgr.IsRowSelected(i,r);this.SetSelected(e,s)}else e.setAttribute("aria-label",h.default.columnHeaderOperationAriaLabel)};e.prototype.OnInsertRowHeaderCell=function(e){e.setAttribute("role","presentation")};e.prototype.OnInsertColHeaderCell=function(e){e.setAttribute("scope","col");e.setAttribute("role","columnheader");e.setAttribute("tabindex","0")};e.prototype.OnInsertGridCell=function(e){e.setAttribute("role","gridcell")};e.prototype.SetSelected=function(e,t){e.setAttribute("aria-selected",t.toString())};return e})();t.ARIAManager=k});
define("Zqe",["require","exports","ww","Dqe","Lqe","Wqe","Nqe","Aqe","Gqe","kqe","tQe","$qe","dQe","Eqe","RWe","bv","k","q","je","Oqe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";var E=w.tablemgr_9,S=w.panemgr_9;w=w.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var x=m.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),T=m.Killswitch.isActivated("DF3D86D3-26B1-480B-A71B-8E0F3C310A1A","3/12/2020","update columns after a resize so that pictures fix their size"),N=m.Killswitch.isActivated("FD94E2D1-B4A1-486C-A34E-AF51AEF22FA2","4/13/2020","Prevent unnecessary updates when just clicking on the resize bar without moving"),C=m.Killswitch.isActivated("50078F9D-8871-4D6D-94D7-0069D13DF879","6/1/2020","Do not show custom formatters on the New Row row."),k=m.Killswitch.isActivated("131A6565-43B4-49D3-9638-D5B15B41D592","8/05/2020","Do not add a highlight class to the cells that were just recently edited."),L=m.Killswitch.isActivated("02A08EFA-638C-4A27-9079-1B4472CE9560","8/3/2020","Fix vertical scrolling issue in sp-client."),A=m.Killswitch.isActivated("C449D68D-440C-40B3-97E5-19B92696735C","8/05/2020","Hide the drag handle on cells that have errors to prevent copying of errors."),O={ODB:1725},M={ODB:1439},_={ODB:60017},D=r.JsGridConstants.Internal.zIndex.selectionFrame,P={ChangeHighlight:"jsgrid-changehighlight"},H=(function(){function e(e,t,n,s,o,a,f,l,c,h,p,v,m,g,y,b){this.const_BlurBorderColor="#B0B5BA";this.gridPane=this;this.bIsDisposed=!1;this.focusedColHeaderIndex=0;this.lastClientSize={width:-1,height:-1};this.reorderableRows=new u.Set;this.disposeMap={};this.dontReflow=!1;this.afterReflowScrollGoal=0;this.afterReflowRowScrollGoal=0;this.afterReflowColScrollGoal=0;this.Id=r.JsGridConstants.PaneId.MainGrid;this.ExecuteTouchAction=null;this.ShouldUpdateTouchStartPosition=null;this._lastSelectionRangeNormalized=null;this._parentNode=e;this._objBag=t;this.ScrollVerticallyByTouch=s;this._fnNotifyScrollBarVisibilityChange=o;this._commandMgr=a;this._selectionMgr=f;this._changeHighlightMgr=l;this._editMgr=c;this._cutcopypasteMgr=h;this._fillDownMgr=p;this._paneSize=v;this._fnGetCellValue=m;this._fnGetLocStr=g;this._fnRetryErrorRows=y;this.styles=t.styleMgr;this.jsGridObj=t.jsGridObj;this.delegateMgr=t.delegateMgr;this.ariaMgr=t.ariaMgr;this.selectionDragHandle=b.selectionDragHandle;this.selectionFrames=b.selectionFrames;this.focusFrames=b.focusFrames;this.copyFrames=b.copyFrames;this.quickEditVisualRefreshFlightEnabled=i.JsGridUtil.Internal.IsFeatureEnabled(O);i.JsGridUtil._readOnlyWidgetKillSwitchIsActive||(this._readOnlyWidget=new d.WidgetControl.ReadOnlyWidget(this._objBag.parentNode,this._objBag.RTL.bEnabled));this._cellsWithBorder=[];this._cellsWithCopyBorder=[];this._cellsWithFocusBorder=[];this.Init()}e.prototype.GetDelegateMgr=function(){return this.delegateMgr};e.prototype.SetEventSinks=function(e){};e.prototype.GetLeftMostColumnIdx=function(){return this.horizScrollBar.GetTopItemIdx()};e.prototype.GetLeftMostColHeaderIdx=function(){return-1};e.prototype.Dispose=function(){this.bIsDisposed=!0;null!=this.disposeRenderedObjectsJobKey&&i.JsGridUtil.AsynchronousCellUpdater.GetInstance().FlushJob(this.disposeRenderedObjectsJobKey);this.gridPane.ClearView();i.JsGridUtil.ClearEventListeners(this._parentNode);i.JsGridUtil.ClearEventListeners(this.tableDiv);this.mouseHandlers.Dispose();this.headerMgr.Dispose();this.tableMgr.Dispose();this.horizScrollBar.Dispose();this._paneSize.Dispose();this.tableDiv=this.selectionDragHandle=this.selectionFrames=this.focusFrames=this.copyFrames=this.ghostHeader=this.ghostHeader.textDiv=this.columnDropIndic=this.ghostCells=this.rowDropIndic=this._parentNode=null};e.prototype.ClearView=function(){var e;this.UpdatePositionedElements();this.mouseHandlers.ClearHeaderEvents();this.tableMgr.ClearTable();i.JsGridUtil._readOnlyWidgetKillSwitchIsActive||null===(e=this.gridPane._readOnlyWidget)||void 0===e||e.Dispose()};e.prototype.SetView=function(e,t,n,r,i,s,o,u,a,f,l,c){var h=Math.max(0,this._paneSize.GetHeight()-this.GetEffectiveHorizontalScrollBarHeight());this.operationalUtil=t;this.fnGetGridRowStyleId=i;this.bMovableColumns=s;this.bResizableColumns=o;this.bHidableColumns=u;this.bSortableColumns=a;this.bAutoFilterableColumns=f;this.bRowHeadersEnabled=l;this.gridFieldMap=r;this.tableMgr.SetPosConverterObj(e);this._selectAllCell=this.tableMgr.InitTable(this.bRowHeadersEnabled);this.InitColumns(n,!0);var p=this._paneSize.GetWidth();this.horizScrollBar.Update({physicalViewportSize:p-this.tableMgr.GetRowHeaderWidth(),scrollbarSize:p,topItemIdx:0,bScrollNotifiy:!1});this.RecomputeTableViewportRelativeToParentNode(h);this.mouseHandlers.SetupHeaderEvents()};e.prototype.GetGridPaneConverter=function(){return this.paneConverter};e.prototype.ShowFocus=function(e){this.UpdateSelectionFrames(!e)};e.prototype.OnResize=function(){var e={width:this._paneSize.GetWidth(),height:this._paneSize.GetHeight()};if(e.width!==this.lastClientSize.width||e.height!==this.lastClientSize.height){this.tableMgr.OptimizeTableColumns();var t=this._paneSize.GetWidth();this.horizScrollBar.Update({physicalViewportSize:t-this.tableMgr.GetRowHeaderWidth(),scrollbarSize:t});this.UpdatePositionedElements();this._editMgr.NotifyMove(this.gridPane);this.lastClientSize=e}};e.prototype.SetRowHeight=function(e){this.rowHeight=e;this.tableMgr.SetRowHeight(this.rowHeight)};e.prototype.GetMinRowHeight=function(){return 30};e.prototype.SpliceRows=function(e,t,n,r,i){this.tableMgr.SpliceRows(e,t,n,r);null!=this.activeRowIdx&&this.activeRowIdx>=e&&this.activeRowIdx<=e+t-1&&(this.activeRowIdx=null);i?this.ResetSelection():this.UpdatePositionedElements(!0)};e.prototype.SetSortState=function(e){this.headerMgr.SetSortState(e)};e.prototype.SetFilterState=function(e){this.headerMgr.SetFilterState(e)};e.prototype.NotifyCanEditUpdated=function(){this.BindEditControl();this.UpdateSelectionFrames(!1)};e.prototype.NotifyCopyOperationUpdated=function(){this.UpdateCopyFrames(!0);this.HideSelectionFrames()};e.prototype.UpdateFocusAfterInsertOrDeleteRows=function(e,t,n){var r=this._selectionMgr.GetFocusForPane(this.gridPane);null!=r&&(n?r.rowIdx>=e&&this._selectionMgr.SetFocusByPos(this.gridPane,r.rowIdx+t,r.colIdx):r.rowIdx>=e&&r.rowIdx<e+t?this._selectionMgr.SetFocusByPos(this.gridPane,Math.max(e-1,0),r.colIdx):r.rowIdx>=e+t&&this._selectionMgr.SetFocusByPos(this.gridPane,r.rowIdx-t,r.colIdx))};e.prototype.ChangeKeys=function(e,t){this.tableMgr.ChangeKeys(e,t)};e.prototype.RenderRows=function(e){this.bIsDisposed||this.tableMgr.RenderRows(e)};e.prototype.NotifyChangeIndicatorsClearing=function(){for(var e=this.tableMgr.GetAllDataCells(),t=0;t<e.length;t++){var n=e[t];null!=n.GetRecord()&&this._changeHighlightMgr.IsCellIn(n.GetRecordKey(),n.GetFieldKey())&&this.RefreshCellStyle(n,!0,!1)}};e.prototype.Select=function(e,t,n,r,i){this._selectionMgr.SelectRange(this.gridPane,e,t,n,r,i?s.SelectOp.Append:s.SelectOp.Set,!0,!1)};e.prototype.SelectByKey=function(e,t,n,r,i){var s,o,u,a;if(null!=e&&null!=t){s=null!=n?this.paneConverter.KeyToIdx(e,n).rowIdx:this.paneConverter.GetTopRowIdxForKey(e);o=null!=r?this.paneConverter.KeyToIdx(t,r).rowIdx:this.paneConverter.GetTopRowIdxForKey(t)}if(null!=n&&null!=r){u=this.paneConverter.FieldKeyToColIdx(n);a=this.paneConverter.FieldKeyToColIdx(r)}this.Select(s,o,u,a,i)};e.prototype.NotifySelectionUpdating=function(){var e;e=this.quickEditVisualRefreshFlightEnabled&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?-1:this.tableMgr.BeginColIdx();var t={rowRange:new u.Range(this.tableMgr.BeginRowIdx(),this.tableMgr.EndRowIdx()-1),colRange:new u.Range(e,this.tableMgr.EndColIdx()-1)};return{visibleRanges:t,clearedCells:this._selectionMgr.GetComponentsWithin(this.gridPane,t.rowRange,t.colRange),oldFocus:this._selectionMgr.GetFocusForPane(this.gridPane)}};e.prototype.ScrollCellIntoView=function(e,t){if(!this.dontReflow){var n=this.gridPane.GetCellByIdx(e,t);if(n){var r=n.GetTd();if(r){var s=r.offsetTop,o=r.offsetLeft,u=r.offsetHeight,a=r.offsetWidth,f=document.getElementById("s4-workspace"),l=i.JsGridUtil.Internal.GetScrollParent(r);if(l){if(f){s-=i.JsGridUtil.Internal.DOM_AbsTop(f);o-=i.JsGridUtil.Internal.DOM_AbsLeft(f);l=f}s<l.scrollTop?l.scrollTop=s-45:s+u>l.scrollTop+l.clientHeight-10&&(l.scrollTop=s+u+45-l.clientHeight);if(!L&&l.clientHeight==l.scrollHeight&&l.clientHeight>document.body.clientHeight&&l.parentElement){var c=i.JsGridUtil.Internal.GetScrollParent(l.parentElement);if(c){var h=c,p=i.JsGridUtil.Internal.DOM_AbsTop(r)-l.scrollTop-i.JsGridUtil.Internal.DOM_AbsTop(h);p<h.scrollTop?h.scrollTop=p-45:p+u>h.scrollTop+h.clientHeight-10&&(h.scrollTop=p+u+45-h.clientHeight)}}if(this._objBag.RTL.bEnabled){if(this._objBag.RTL.bEnabled)if(i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIE)o<0&&(0==l.scrollLeft||l.scrollLeft>0&&Math.abs(o)>l.scrollLeft)?l.scrollLeft=Math.abs(o+45):l.clientWidth-o-a<l.scrollLeft&&(l.scrollLeft=l.clientWidth-o-a-45);else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){var d=i.JsGridUtil.Internal.GetStickyDataColumnsWidth(this.allColumns.GetColumnArray());o<l.scrollLeft?l.scrollLeft=o-45:o+a>l.scrollLeft+l.clientWidth+i.JsGridUtil.Internal.DOM_AbsLeft(this.tableDiv)+d&&(l.scrollLeft=o+a+45-(l.clientWidth+i.JsGridUtil.Internal.DOM_AbsLeft(this.tableDiv)+45+d))}else o<l.scrollLeft?l.scrollLeft=o-45:o+a>l.scrollLeft+l.clientWidth+i.JsGridUtil.Internal.DOM_AbsLeft(this.tableDiv)&&(l.scrollLeft=o+a+45-(l.clientWidth+i.JsGridUtil.Internal.DOM_AbsLeft(this.tableDiv)))}else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){var v=this.allColumns.GetColumnArray()[0].width;t<=1||o<l.scrollLeft+v?l.scrollLeft=Math.max(0,o-90-v):o+a>l.scrollLeft+l.clientWidth&&(l.scrollLeft=o+a+45-l.clientWidth)}else o<l.scrollLeft?l.scrollLeft=o-45:o+a>l.scrollLeft+l.clientWidth&&(l.scrollLeft=o+a+45-l.clientWidth)}}}return!1}};e.prototype.GetCellByIdx=function(e,t){return this.tableMgr.GetCellByIdx(e,t)};e.prototype.NotifySelectionUpdated=function(e,t){var n=this,r=this._selectionMgr.GetFocusForPane(this.gridPane),s=this._selectionMgr.GetComponentsWithin(this.gridPane,e.visibleRanges.rowRange,e.visibleRanges.colRange),u=function(e,t){if(n._objBag.editUtil.IsEditingEnabled()&&n._objBag.editUtil.CanEditField(e.GetRecord(),e.GetColumn(),e.GetFieldKey())){var r=e.GetTd(),s=n.quickEditVisualRefreshFlightEnabled?w.msGridCellSelectedEditable:"ms-jsgrid-cell-selected-editable";t?i.JsGridUtil.Internal.AddCssClass(r,s):i.JsGridUtil.Internal.RemoveCssClass(r,s)}};(function(e,t,r,s){var o=e.SymmetricDifference(t),u=function(e){var t=n.tableMgr.GetCellByIdx(e.rowIdx,e.colIdx);null!=t?n.RefreshCellStyle(t,!1,!0):n.ApplyGridComputedCellStyle(e.recordKey,e.fieldKey,null,!1)};if(null!=r){o.Remove(i.JsGridUtil.Internal.MakeCellKey(r.rowIdx,r.colIdx));u(r)}if(null!=s){o.Remove(i.JsGridUtil.Internal.MakeCellKey(s.rowIdx,s.colIdx));u(s)}for(var a in o.GetCollection()){var f=i.JsGridUtil.Internal.CrackCellKey(a),l=n.tableMgr.GetCellByIdx(f.rowIdx,f.colIdx);null!=l&&n.RefreshCellStyle(l,!1,!0)}})(e.clearedCells,s,e.oldFocus,r);(function(){var e;e=n.tableMgr.GetColumnHeaders();if(n.quickEditVisualRefreshFlightEnabled)for(var t=0;t<e.length-1;t++)n.headerMgr.ApplyHeaderClassnames(e[t]);else for(t=0;t<e.length;t++)n.headerMgr.ApplyHeaderStyle(e[t].GetTd(),n.GetHeaderStyle(e[t].GetColIdx(),!1),e[t].GetColIdx()==n.activeColIdx);e=n.tableMgr.GetRowHeaders();for(t=0;t<e.length;t++){var r=e[t].GetTd();n.quickEditVisualRefreshFlightEnabled||o.StyleUtil.ApplyRowHeaderStyle(r,n.GetHeaderStyle(e[t].GetRowIdx(),!0),n.GetRowHeaderSibling);var i=n._selectionMgr.IsRowSelected(n.gridPane,e[t].GetRowIdx());if(n.quickEditVisualRefreshFlightEnabled&&i){r.classList.add(E.cellIsSelected);r.parentNode.classList.add(E.rowIsSelected,"is-selected")}else{r.classList.remove(E.cellIsSelected);r.parentNode.classList.remove(E.rowIsSelected,"is-selected")}n.ariaMgr.SetSelected(r.parentNode,i)}})();var a,f,l,c,h=!1;r&&t&&(h=this.gridPane.ScrollCellIntoView(r.rowIdx,r.colIdx));h||this.UpdatePositionedElements();this.BindEditControl();if(this.quickEditVisualRefreshFlightEnabled)for(var p in this.copyFrames)for(var d in this.copyFrames[p])"Fore"===p&&this.copyFrames[p][d].classList.add(S.dashedBorderUnfocused);if(null!=e.oldFocus){if(this.quickEditVisualRefreshFlightEnabled&&-1===e.oldFocus.colIdx){a=this.tableMgr.GetRowHeader(e.oldFocus.rowIdx);f=this.tableMgr.GetSelectAllSquare()}else{a=this.tableMgr.GetCellByIdx(e.oldFocus.rowIdx,e.oldFocus.colIdx);f=this.tableMgr.GetColumnHeader(e.oldFocus.colIdx)}null!=a&&u(a,!1)}if(null!=r){if(this.quickEditVisualRefreshFlightEnabled&&-1===r.colIdx){l=this.tableMgr.GetRowHeader(r.rowIdx);c=this.tableMgr.GetSelectAllSquare()}else{l=this.tableMgr.GetCellByIdx(r.rowIdx,r.colIdx);c=this.tableMgr.GetColumnHeader(r.colIdx)}null!=l&&u(l,!0)}this.ariaMgr.OnFocusCell(this.Id,a,f,l,c)};e.prototype.GetMinHeaderHeight=function(){return 31};e.prototype.SetHeaderHeight=function(e){this.tableMgr.SetHeaderHeight(e)};e.prototype.ScrollColumnIntoViewHorizontally=function(e){if(e<=this.tableMgr.BeginColIdx())return this.horizScrollBar.Update({topItemIdx:e});var t=this.tableMgr.GetColumnHeader(e),n=t&&t.GetTd(),r=n&&(this._objBag.RTL.bEnabled?this.tableMgr.GetTdCoords(n).left<0:this.tableMgr.GetTdCoords(n).right>this._paneSize.GetWidth());if(!n||r){for(var i=this.tableMgr.GetSelectAllSquare()?this.tableMgr.GetSelectAllSquare().GetTd().offsetWidth:0,s=this._paneSize.GetWidth()-i-this.paneConverter.GetColumnByIdx(e).width;e>0&&(s-=this.paneConverter.GetColumnByIdx(e-1).width)>=0;e--);return this.horizScrollBar.Update({topItemIdx:e})}return!1};e.prototype.NotifyUpdateProperty=function(e,t,n,i,s,o){n&&this._changeHighlightMgr.AddCell(e,t);var u=this.tableMgr.GetCellByKey(e,t);if(null!=u){null!=i&&s==r.JsGridConstants.ValidationState.Valid&&this._editMgr.NotifyUpdateProperty(this,e,t,i,o);this.tableMgr.RefreshCell(u);this.UpdatePositionedElements();this._editMgr.NotifyMove(this.gridPane)}};e.prototype.BeginRowIdx=function(){return this.tableMgr.BeginRowIdx()};e.prototype.BeginColIdx=function(){return this.tableMgr.BeginColIdx()};e.prototype.ShowColumn=function(e,t){null==this.paneConverter.GetColumnByKey(e)&&this.ShowColumnInternal(this.allColumns.GetColumnByKey(e),t)};e.prototype.HideColumn=function(e){var t=this.paneConverter.GetColumnByKey(e);null!=t&&this.HideColumnInternal(t)};e.prototype.RenameColumn=function(e,t){this._editMgr.Unbind();this.headerMgr.RenameColumn(e,t)};e.prototype.DeleteColumn=function(e){var t=this.paneConverter.GetColumnByKey(e);if(null!=t){this.HideColumn(t);this.allColumns.RemoveColumn(e)}};e.prototype.UpdateColumns=function(e){this.InitColumns(e,!1)};e.prototype.GetVisibleColumns=function(){for(var e=[],t=this.GetAllColumns().GetColumnArray(),n=0;n<t.length;n++)t[n].isVisible&&e.push({columnKey:t[n].columnKey,width:t[n].width});return e};e.prototype.GetAllColumns=function(){return this.allColumns};e.prototype.GetColumns=function(){for(var e=[],t=this.allColumns.GetColumnArray(),n=0;n<t.length;n++)e.push(t[n]);return e};e.prototype.GetFocusedCell=function(){var e=this._selectionMgr.GetFocusForPane(this.gridPane),t=e&&this.tableMgr.GetCellByIdx(e.rowIdx,e.colIdx);return null!=t&&t.GetCellType()==this.tableMgr.CellType.Cell?t:null};e.prototype.GetData=function(e,t,n,r){for(var i=new Array(t.Size()),s=t.begin;s<=t.end;s++){for(var o=new Array(n.Size()),u=n.begin;u<=n.end;u++){var a;null!=(a=r?this.paneConverter.FullDataIdxToKey(s,u):this.paneConverter.IdxToKey(s,u)).recordKey&&(o[u-n.begin]=this._objBag.editUtil.GetFieldValueForCopy(e[a.recordKey],a.fieldKey))}i[s-t.begin]=o}return{matrix:i,height:t.Size(),width:n.Size()}};e.prototype.PutData=function(e,t,n,s,o,u,l,c){var h=this,p=new Array(o.Size()*u.Size()),d=e.height,v=e.width,m=-o.begin+("TL"==s||"TR"==s?0:d-o.Size()%d),g=-u.begin+("TL"==s||"BL"==s?0:v-u.Size()%v),y=this._objBag.controller.CreateDataUpdateCmd(!0),b=y.GetChangeKey();this._objBag.commandMgr.Execute(y,n,a.CommandManagerConstants.CommandType.Explicit);var w=o.begin,E=o.begin,S=o.Size()*u.Size(),x=0;this._objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.DoLargeTask,S,100,function(n,r){for(var s;E<=o.end;){s=!1;for(var a=u.begin;a<=u.end;a++){var l=h.paneConverter.IdxToKey(w,a);if(h._objBag.editUtil.CanEditField(c?h._objBag.entryRecordMgr.GetEntryRecord(l.recordKey):t[l.recordKey],h.paneConverter.GetColumnByIdx(a),l.fieldKey)){var y=i.JsGridUtil._locationFilldownKillswitchIsActive||!h._objBag.controller.GetPropType(l.recordKey,l.fieldKey).ForceDataCopy;p[x++]=f.CreateUnvalidatedPropertyUpdate(l.recordKey,l.fieldKey,e.matrix[(E+m)%d][(a+g)%v],y);!s&&c&&l.recordKey==h._objBag.entryRecordMgr.GetLastEntryKey()&&h._objBag.entryRecordMgr.CreateEntryRows(1,E!==o.end,b);s=!0}}c&&!s||w++;E++;if((n+=u.Size())>=r)break}return n},function(){x>0&&h._objBag.controller.UpdateProperties(p.slice(0,x),n,b);y.NotifyInitialUpdateComplete();l(w-o.begin)},r.JsGridConstants.Priority.SuperHigh)};e.prototype.FieldKeyToColumnKey=function(e){for(var t=this.allColumns.GetColumnArray(),n=0;n<t.length;n++)if(null!=i.JsGridUtil.Internal.FindInArray(t[n].fieldKeys,function(t){return t==e},null))return t[n].columnKey;return null};e.prototype.EnsurePaneWidth=function(){var e=this.tableMgr.GetTableWidth()+40;e>this.gridPane._paneSize.GetWidth()&&this.gridPane._paneSize.SetValues(e,this.gridPane._paneSize.GetLeftOffset())};e.prototype.ScrollHorizontallyByTouch=function(e){e?this.horizScrollBar.ScrollUpByOne():this.horizScrollBar.ScrollDownByOne()};e.prototype.SetFocusToHeader=function(e){var t=this._objBag.parentNode.id;document.getElementById(t).getElementsByTagName("th")[e+1].focus()};e.prototype.IsRowHeadersEnabled=function(){return this.bRowHeadersEnabled};e.prototype.SelectAllRows=function(){var e=this._objBag.paneMgr,t=this.jsGridObj,n=this._selectionMgr.GetLastSelectionType(),i=e.RecordKeyToViewIdx(e.GetLastRecordKey());if(void 0!==i){var s=t.GetSelectedRecordKeys();if(null==s||0===i&&n!==r.JsGridConstants.SelectionType.RowRange||s.length!==i-0+1){t.SelectRowRange(0,i,!1);this._selectAllCell.GetTd().classList.add(E.allRowsSelected)}else{t.SelectCellRange(0,0,0,0,!1);this._selectAllCell.GetTd().classList.remove(E.allRowsSelected)}}};e.prototype.UpdateRowClassesOnSingleCellSelection=function(e,t){var n=this.GetCellByIdx(e,0),r=this.GetCellByIdx(t,0),i=n&&n.GetTr(),s=r&&r.GetTr();e!==t&&i&&i.classList.remove(E.rowHasOnlyOneCellSelected);s&&s.classList.add(E.rowHasOnlyOneCellSelected)};e.prototype.HideFocusStyles=function(){var e;this.HideSelectionFrames();this.ClearPseudoElementFrame(this._cellsWithBorder,E.cellHasSelectionBorder,E.cellIsFocusedAndSelected);i.JsGridUtil._readOnlyWidgetKillSwitchIsActive||null===(e=this._readOnlyWidget)||void 0===e||e.Collapse()};e.prototype.Init=function(){var e,t=this;this.headerMgr=new c.HeaderManager(this._objBag,this.styles,this._fnGetLocStr,this.UpdatePositionedElements.bind(this));var n=function(n){null!=e&&clearTimeout(e);e=setTimeout(function(){if(!t.bIsDisposed){t.tableMgr.UpdateCoordCache();t.UpdatePositionedElements()}},75)};this.computeGridCellStyleJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.ApplyGridComputedCellStyle.bind(this));this.computeGridROStyleJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.ApplyReadOnlyStyle.bind(this));this.disposeRenderedObjectsJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.DisposeContents.bind(this));this.CreateTopLevelHtmlElements();this.CreateColumnConfigurationHtmlElements();this.tableMgr=new l.TableManager(this.tableDiv,this._parentNode.id,this._paneSize,this._fnGetLocStr,this._objBag,this.OnInsertedRow.bind(this),this.OnInsertedColumns.bind(this),function(){null==t.curColUpdateTimeOut&&(t.curColUpdateTimeOut=setTimeout(t.UpdateFirstDisplayColumn.bind(t),0))}.bind(this),function(e){t.headerMgr.DisposeHeader(e)}.bind(this),function(){},this.BuildCellContent.bind(this),this._fnRetryErrorRows,this.TryDisposeRow.bind(this));this.paneConverter=this.tableMgr.GetGridPaneConverter();this.mouseHandlers=new B(this.gridPane);window.addEventListener("resize",n);this.onResizeHandler=n};e.prototype.CreateTopLevelHtmlElements=function(){this._parentNode.style.verticalAlign="top";this.tableDiv=document.createElement("div");this.tableDiv.style.cssText="position:relative;text-align:"+this._objBag.RTL.left;this.tableDiv.name="tableDiv";this._parentNode.appendChild(this.tableDiv);this.horizScrollBarContainer=document.createElement("div");this.horizScrollBarContainer.style.height=h.GetSystemScrollBarThickness()+"px";this.horizScrollBarContainer.style.display="none";this._parentNode.appendChild(this.horizScrollBarContainer);this.horizScrollBar=new h.ScrollBar(h.ScrollBarType.Horizontal,this.horizScrollBarContainer,!1,{itemSize:100},this.styles.scrollBarStyle,this._objBag.RTL.bEnabled,this._objBag);null!=this._fnNotifyScrollBarVisibilityChange&&this.horizScrollBar.SetOnVisibilityChanged(this.OnHorizontalScrollbarVisibilityChanged.bind(this),!0)};e.prototype.GetEffectiveHorizontalScrollBarHeight=function(){return"none"==this.horizScrollBarContainer.style.display?0:h.GetSystemScrollBarThickness()};e.prototype.OnHorizontalScrollbarVisibilityChanged=function(e){this.horizScrollBarContainer.style.display=e?"":"none";this._fnNotifyScrollBarVisibilityChange(e)};e.prototype.InitColumns=function(e,t){var n=this._selectionMgr.GetFocusForPane(this.gridPane);this.allColumns=e;var r=this.allColumns.GetColumnArray();this.itemSizes=[];for(var i=[],s=0;s<r.length;s++){var o=r[s];this.headerMgr.AdjustColumnWidth(o);this.itemSizes.push(o.width);i.push(o)}this.horizScrollBar.Update({itemCount:i.length,itemSizes:this.itemSizes});this.tableMgr.SetColumns(i,t);if(!t){this.TryRestoreFocusAfterInsertOrDeleteColumns(n);this.UpdatePositionedElements();this._editMgr.NotifyMove(this.gridPane)}};e.prototype.ActivateRow=function(e){null!=this.activeRowIdx&&this.DeactivateRow();this.activeRowIdx=e};e.prototype.DeactivateRow=function(){null!=this.activeRowIdx&&(this.activeRowIdx=null)};e.prototype.ActivateColumn=function(e){if(this.activeColIdx!==e){this.DeactivateColumn();this.activeColIdx=e;this.headerMgr.ApplyHeaderStyle(this.tableMgr.GetColumnHeader(e).GetTd(),this.GetHeaderStyle(e,!1),!0)}var t=this.tableMgr.GetColumnHeader(e),n=t.GetColumn(),r=t.GetTd(),s=n.columnKey,o=this.headerMgr.GetChildObjects(s);PositionCtxImg&&PositionCtxImg(o.menu,r);var u=this.getWidthFromPxString(o.menu.style.height);o.menuImg.style.top=(u-6)/2+"px";var a=this.getWidthFromPxString(i.JsGridUtil.Internal.GetCurrentStyle(o.menu,"width","width"));o.menuImg.style.left=(a-9)/2+"px";i.JsGridUtil.Internal.AddCssClass(o.menu,"s4-ctx-show");if(!n.bOpenMenuOnContentClick){o.menu.style.visibility="visible";o.menuImg.style.visibility="visible"}};e.prototype.getWidthFromPxString=function(e){if("string"!=typeof e)return 0;var t=e.trim(),n=Number(t.substring(0,t.length-2).trim());return isNaN(n)?0:n};e.prototype.DeactivateColumn=function(){if(null!=this.activeColIdx&&(null==this.lockedColIdx||this.activeColIdx!==this.lockedColIdx)){var e=this.activeColIdx;this.activeColIdx=null;var t=this.tableMgr.GetColumnHeader(e);null!=t&&this.headerMgr.ApplyHeaderStyle(t.GetTd(),this.GetHeaderStyle(e,!1));var n=this.tableMgr.GetColumnHeader(e).GetColumn().columnKey,r=this.headerMgr.GetChildObjects(n);if(r.menu&&r.menuImg){i.JsGridUtil.Internal.RemoveCssClass(r.menu,"s4-ctx-show");r.menuImg.style.visibility="hidden";r.menu.style.visibility="hidden"}}};e.prototype.CreateColumnConfigurationHtmlElements=function(){this.ghostHeader=document.createElement("table");this.ghostHeader.style.cssText="position:absolute; visibility:hidden; table-layout:fixed;z-index:1;padding-"+this._objBag.RTL.left+":7px;";this.tableDiv.appendChild(this.ghostHeader);this.ghostHeader.cellPadding=this.ghostHeader.cellSpacing=0;var e=this.ghostHeader.insertRow(-1).appendChild(document.createElement("th"));this.ghostHeader.textDiv=e.appendChild(document.createElement("div"));this.ghostHeader.textDiv.style.cssText="text-overflow:none; width:100%; margin-"+this._objBag.RTL.left+":-1px;";this.columnDropIndic=document.createElement("div");this.columnDropIndic.style.cssText="visibility:hidden; width:3px; position:absolute";this.tableDiv.appendChild(this.columnDropIndic);this.rowDropIndic=document.createElement("div");this.rowDropIndic.style.cssText="visibility:hidden; height:3px; background-color:"+this.styles.gridPaneStyle.rowDropIndicatorColor+"; position:absolute";this.tableDiv.appendChild(this.rowDropIndic)};e.prototype.DisposeContents=function(e,t,n){if(n)for(var r=0;r<n.length;r++)n[r]()};e.prototype.ApplyReadOnlyStyle=function(e,t,n){var s=this.tableMgr.GetCellByKey(e,t);if(null!=s&&this._objBag.editUtil.IsEditingEnabled()&&!this._objBag.editUtil.CanEditField(s.GetRecord(),s.GetColumn(),t)&&(null==this.focusedReadOnlyCell||this.focusedReadOnlyCell.rk!==e||this.focusedReadOnlyCell.fk!==t)){if(this._objBag.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState)&&this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,t)==r.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive)return;var u=o.StyleUtil.MergeCellStyles(n,this.styles.readOnlyCellStyle);if(null!=u.backgroundColor){var a=s.GetTd(),f=i.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(a,"backgroundColor","background-color"),l=a.computedBackgroundColor;a.computedBackgroundColor=u.backgroundColor;this.quickEditVisualRefreshFlightEnabled&&delete u.textColor;if(l!==f){this.ApplyGridComputedCellStyle(e,t,s);delete u.backgroundColor}o.StyleUtil.ApplyCellStyle(s.GetTd(),u)}else o.StyleUtil.ApplyCellStyle(s.GetTd(),u)}};e.prototype.RemoveComputedCellStyles=function(e){for(var t=Object.keys(P),n=0;n<t.length;n++)e.classList.remove(P[t[n]])};e.prototype.ApplyGridComputedCellStyle=function(e,t,n,s){var u,a,f,l=null==n?this.tableMgr.GetCellByKey(e,t):n;if(null!=l){u=l.GetTd();!x&&k&&this.RemoveComputedCellStyles(u)}if(null!=this.focusedReadOnlyCell&&this.focusedReadOnlyCell.rk==e&&this.focusedReadOnlyCell.fk==t){f=this.focusedReadOnlyCell;this.focusedReadOnlyCell=null}if(null!=u&&null!=l){var c=this.tableMgr.GetRowHeader(l.GetRowIdx()),h=i.JsGridUtil.Internal.DomElement.GetInstance().GetPrevElement(u),p=l.GetRecord();a=l.GetTr();if(this.quickEditVisualRefreshFlightEnabled){u.classList.remove(E.cellIsSelected);u.classList.remove(E.cellIsFocusedAndSelected,"is-focusedAndSelected");c&&c.GetTd()===h&&h.classList.remove(E.cellIsFocusedAndSelected,"is-focusedAndSelected");a&&p.bIsNewRow&&a.classList.remove(E.rowIsActive)}var d=this._changeHighlightMgr.IsCellIn(e,t),v=this.paneConverter.KeyToIdx(e,t),m=this._selectionMgr.GetFocusForPane(this.gridPane),g=null!=v&&this._selectionMgr.IsCellSelected(this.gridPane,v.rowIdx,v.colIdx),y=null!=v&&null!=m&&v.rowIdx==m.rowIdx&&v.colIdx==m.colIdx,b=g&&!y,w=null;if(this.quickEditVisualRefreshFlightEnabled&&g&&y){c&&c.GetTd()===h&&h.classList.add(E.cellIsFocusedAndSelected,"is-focusedAndSelected");u.classList.add(E.cellIsFocusedAndSelected,"is-focusedAndSelected")}if(this.quickEditVisualRefreshFlightEnabled&&a&&p.bIsNewRow){var S=null!=v&&this._selectionMgr.isRowContainsSelectedCell(this.gridPane,v.rowIdx),T=null!=v&&null!=m&&v.rowIdx==m.rowIdx;S&&T&&a.classList.add(E.rowIsActive)}if(null==u.computedBackgroundColor&&y&&this._objBag.editUtil.IsEditingEnabled()&&!this._objBag.editUtil.CanEditField(l.GetRecord(),l.GetColumn(),l.GetFieldKey())){this.focusedReadOnlyCell={rk:e,fk:t,textColor:null!=f?f.textColor:u.style.color,backgroundColor:null!=f?f.backgroudColor:u.style.backgroundColor};if(!this._objBag.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState)||this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,t)!==r.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive){if(i.JsGridUtil._readOnlyWidgetKillSwitchIsActive){u.style.backgroundColor=this.styles.readOnlyFocusedCellStyle.backgroundColor;u.style.color=this.styles.readOnlyFocusedCellStyle.textColor}else;w=!0}}else if(null!=f){u.style.color=f.textColor;u.style.backgroundColor=f.backgroundColor}if(!w&&(d||b)){var N=u.computedBackgroundColor,C=i.JsGridUtil.Internal.Color.HexStringToColor("transparent"==N||null==N?null!=this.styles.defaultCellStyle.backgroundColor?this.styles.defaultCellStyle.backgroundColor:o.StyleUtil.GetCellStyleDefaultBackgroundColor():N);if(d&&!s){null!=(L=this.styles.gridPaneStyle.changeHighlightCellBgColor)&&(C=L);if(!x){C=null;k&&u.classList.add(P.ChangeHighlight)}}if(b){var L;null!=(L=this.styles.gridPaneStyle.selectedCellBgColor)&&(C=L)}null!=C&&(this.quickEditVisualRefreshFlightEnabled?u.classList.add(E.cellIsSelected):u.style.backgroundColor=i.JsGridUtil.Internal.Color.ColorToHexString(i.JsGridUtil.Internal.Color.RemoveAlphaChannel(C)))}this.ariaMgr.SetSelected(u,g)}};e.prototype.GetCurrentCellStyle=function(e,t,n,i){var s={};i&&(s=o.StyleUtil.MergeCellStyles(this.styles.defaultCellStyle,s));var u,a=null==e;if(a)u=this.gridFieldMap[n].GetPropType();else{var f=e.GetProp(n);u=null!=f?f.propType:null}if(null!=u&&null!=u.GetStyleId){null!=(d=u.GetStyleId(a?null:e.GetDataValue(n)))&&(s=o.StyleUtil.MergeCellStyles(this.styles.GetCellStyle(d),s))}if(!a){var l=this.fnGetGridRowStyleId&&this.fnGetGridRowStyleId(e);if(null!=(l=null!=l?l:this.operationalUtil.GetValue(e,r.JsGridConstants.OperationalConstants.GridRowStyleId))){var c=this.styles.GetCellStyle(l);null!=c&&(s=o.StyleUtil.MergeCellStyles(c,s))}}var h=this.gridFieldMap[n].GetDefaultCellStyleId();null!=h&&(s=o.StyleUtil.MergeCellStyles(this.styles.GetCellStyle(h),s));if(null!=t.fnGetCellStyleId&&!a){var p=t.fnGetCellStyleId(e,n,e.HasDataValue(n)?e.GetDataValue(n):null);if(null!=p){var d;null!=(d=this.styles.GetCellStyle(p))&&(s=o.StyleUtil.MergeCellStyles(d,s))}}return s};e.prototype.RefreshCellStyle=function(e,t,n){var r=e.GetRecord(),s=e.GetColumn(),u=e.GetFieldKey(),a=e.GetTd(),f=null!=r?r.recordKey:e.GetRecordKey();""!==a.style.backgroundColor&&(a.style.backgroundColor="");var l=this.GetCurrentCellStyle(r,s,u,!1);if(!i.JsGridUtil.Internal.IsAssocArrayEmpty(l)){o.StyleUtil.ApplyCellStyle(a,l);if(null!=this.focusedReadOnlyCell&&this.focusedReadOnlyCell.rk==f&&this.focusedReadOnlyCell.fk==u){this.focusedReadOnlyCell.textColor=null!=l.textColor?l.textColor:null!=this.styles.defaultCellStyle.textColor?this.styles.defaultCellStyle.textColor:"";this.focusedReadOnlyCell.backgroundColor=null!=l.backgroundColor?l.backgroundColor:null!=this.styles.defaultCellStyle.backgroundColor?this.styles.defaultCellStyle.backgroundColor:""}}a.computedBackgroundColor=l.backgroundColor;n?this.ApplyGridComputedCellStyle(f,u,e,t):i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.computeGridCellStyleJobKey,f,u);this._objBag.editUtil.IsEditingEnabled()&&i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.computeGridROStyleJobKey,f,u);return l};e.prototype.ResetSelection=function(){var e=this._selectionMgr.GetFocusForPane(this.gridPane);this._objBag.bUpdateCoordCache=!0;null!=e&&this._selectionMgr.SelectRange(this.gridPane,e.rowIdx,e.rowIdx,e.colIdx,e.colIdx,s.SelectOp.Set,!1,!1)};e.prototype.BindEditControl=function(){var e=this,t=this._selectionMgr.GetFocusForPane(this.gridPane),n=function(t,n,r,i){if(!e._editMgr.IsBound()&&null!=n&&e._objBag.editUtil.CanBindToField(n,r,i)){e.useCustomSelFrames=!1;e._editMgr.BindToCell(e.gridPane,n,r,i,e.gridFieldMap,t,e.RefreshCellStyle(t,!1,!0))}};if(null!=t){var r=this.tableMgr.GetCellByIdx(t.rowIdx,t.colIdx);if(null!=r&&r.GetCellType()==this.tableMgr.CellType.Cell){var i=r.GetRecord(),s=r.GetColumn(),o=r.GetFieldKey();if(!this._editMgr.IsBound()||null!=i&&this._editMgr.IsBoundToCell(this.gridPane,i.key(),o))n(r,i,s,o);else{this.useCustomSelFrames=!1;this._editMgr.Unbind(function(){n(r,i,s,o)})}}}};e.prototype.TryShiftColumnSelectionGroup=function(e,t,n){var s=!1;if(this.bMovableColumns){i.JsGridUtil.DebugAssert(0!==n);var o=this._selectionMgr.GetRowRanges(this.gridPane),u=this._selectionMgr.GetColumnRanges(this.gridPane),f=this._selectionMgr.GetCellRanges(this.gridPane),l=null==o||0==o.length,c=null==u||0==u.length,h=null==f||0==f.length;if(l&&(c||h)&&(c||1==u.length)&&(h||1==f.length)){var p=c?f[0].colRange:u[0],d=n>0?p.end+1:p.begin-1;if(d>=0&&d<this.paneConverter.GetVirtualColumnCount()){for(var v=c?r.JsGridConstants.SelectionType.CellRange:r.JsGridConstants.SelectionType.ColumnRange,m=[this.CreateSingleSelectionCmd(e,t,c?f[0]:u[0],v,!0,!1)],g=p.begin;g<=p.end;g++){var y=d+(n>0?-1:1);m.push(this.CreateMoveColumnCommand(d,y));d=y}var b=n>0?1:-1;p.begin+=b;p.end+=b;t+=b;m.push(this.CreateSingleSelectionCmd(e,t,c?f[0]:u[0],v,!1,!0));this._commandMgr.Execute(new a.AggregateCommand(m,!0),"Column Reorder",a.CommandManagerConstants.CommandType.Explicit);s=!0}}}return s};e.prototype.CreateSingleSelectionCmd=function(e,t,n,i,o,u){var a,f,l,c,h=this;if(i==r.JsGridConstants.SelectionType.ColumnRange){l=n.begin;c=n.end}if(i==r.JsGridConstants.SelectionType.CellRange){l=n.colRange.begin;c=n.colRange.end;a=n.rowRange.begin;f=n.rowRange.end}var p=function(){h._selectionMgr.SetFocusByPos(h.gridPane,e,t);h._selectionMgr.SelectRange(h.gridPane,a,f,l,c,s.SelectOp.Set,!0)};return{Apply:o?function(){}:p,Undo:u?function(){}:p}};e.prototype.RecomputeTableViewportRelativeToParentNode=function(e){this.tableViewportRelativeToParentNode={left:1+this._paneSize.GetLeftOffset(),top:1+this.tableMgr.GetHeaderHeight(),right:1+this._paneSize.GetLeftOffset()+this._paneSize.GetWidth(),bottom:1+e};var t=this.tableMgr.GetRowHeaderWidth()?this.tableMgr.GetRowHeaderWidth():0;this._objBag.RTL.bEnabled?this.tableViewportRelativeToParentNode.right-=t:this.tableViewportRelativeToParentNode.left+=t};e.prototype.GetTdCoordsRelativeToParentNode=function(e){var t;if(null!=e.parentNode){(t=this.tableMgr.GetTdCoords(e)).left+=1+this._paneSize.GetLeftOffset();t.right+=1+this._paneSize.GetLeftOffset();t.top+=1;t.bottom+=1}return t};e.prototype.GetTableViewportRelativeToParentNode=function(){if(this.dontReflow)return this.tableViewportRelativeToParentNode;var e=Math.max(this.tableDiv.offsetHeight,400);this.RecomputeTableViewportRelativeToParentNode(e);return this.tableViewportRelativeToParentNode};e.prototype.GetCellRangeBorderDrawingInfo=function(e,t,n){var s=!1,o=0;if(this.quickEditVisualRefreshFlightEnabled&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&n===r.JsGridConstants.SelectionType.CellRange&&e.begin===e.end&&t.begin===t.end&&-1===t.begin){s=!0;o=-1}var u,a,f=this.tableMgr.BeginRowIdx(),l=this.tableMgr.EndRowIdx()-1,c=this.tableMgr.BeginColIdx()+o,h=this.tableMgr.EndColIdx()-1,p=e.begin<f,d=t.begin<c,v=e.begin>l,m=t.begin>h,g=e.end<f,y=e.end>l,b=t.end<c;if(v||m||g||b)return null;u=this.quickEditVisualRefreshFlightEnabled&&n===r.JsGridConstants.SelectionType.RowRange?this._objBag.RTL.bEnabled?this.tableMgr.GetCellByIdx(Math.max(f,e.begin),Math.min(h,t.end)):this.tableMgr.GetRowHeader(e.begin):s?this.tableMgr.GetRowHeader(e.begin):this.tableMgr.GetCellByIdx(Math.max(f,e.begin),this._objBag.RTL.bEnabled?Math.min(h,t.end):Math.max(c,t.begin));a=this.quickEditVisualRefreshFlightEnabled&&n===r.JsGridConstants.SelectionType.RowRange?this._objBag.RTL.bEnabled?this.tableMgr.GetRowHeader(e.end):this.tableMgr.GetCellByIdx(Math.min(l,e.end),Math.min(h,t.end)):s?this.tableMgr.GetRowHeader(e.end):this.tableMgr.GetCellByIdx(Math.min(l,e.end),this._objBag.RTL.bEnabled?Math.max(c,t.begin):Math.min(h,t.end));var w=this.GetTdCoordsRelativeToParentNode(u.GetTd()),E=this.GetTdCoordsRelativeToParentNode(a.GetTd()),S=this.quickEditVisualRefreshFlightEnabled&&this._objBag.RTL.bEnabled?1:0,x=w.left-S,T=w.top,N=E.right-S,C=y?T+this._paneSize.GetHeight()+1:E.bottom;return{left:x,top:T,right:N,bottom:C,width:N-x-(this.quickEditVisualRefreshFlightEnabled?1:2),height:C-T-(this.quickEditVisualRefreshFlightEnabled?1:2),bBeginsBeforeColumnHeader:p,bBeginsBeforeRowHeader:d,isSelectionCellSelected:s}};e.prototype.UpdatePositionedElements=function(e){e&&(this._objBag.bUpdateCoordCache=!0);this.UpdateSelectionFrames(!1);this.UpdateFocusFrames();this.UpdateCopyFrames();this.tableMgr.UpdateErrorFrames()};e.prototype.SetSelectionFrameOnNonTdElement=function(e,t){if(t){this.useCustomSelFrames=!0;this.ClearPseudoElementFrame(this._cellsWithBorder,E.cellHasSelectionBorder);this._cellsWithBorder.push(e);e.classList.add(E.selectedEditor);var n=e.getBoundingClientRect();this.PositionGridSelectionDragHandle(t.y+n.height-5,t.x+(n.width-3),"")}};e.prototype.PositionGridSelectionFrameAroundNonstandardElement=function(e,t){var n=this.quickEditVisualRefreshFlightEnabled,r={Top:{top:t.y,left:t.x,width:e.width-(n?0:1),zIndex:n?"":D},Bottom:{top:t.y+e.height-1,left:t.x,width:e.width-(n?0:4),zIndex:n?"":D},Right:{top:t.y,left:t.x+e.width-(n?2:1),height:e.height-(n?-1:4),zIndex:n?"":D},Left:{top:t.y,left:t.x,height:e.height-(n?-1:1),zIndex:n?"":D}};this.useCustomSelFrames=!0;this.PositionGridSelectionFrame(r);n?this.PositionGridSelectionDragHandle(t.y+e.height-5,t.x+(e.width-3),""):this.PositionGridSelectionDragHandle(t.y+e.height-1-1,t.x+e.width-1-1,(D+1).toString());this.UnhideSelectionFrames()};e.prototype.PositionGridSelectionFrame=function(e,t){for(var n in this.selectionFrames){this.selectionFrames[n].style.visibility=e[n].visibility;delete e[n].visibility;for(var r in e[n])"zIndex"!==r&&e[n][r]?this.selectionFrames[n].style[r]=e[n][r]+"px":this.selectionFrames[n].style[r]=e[n][r];this.quickEditVisualRefreshFlightEnabled?t?this.selectionFrames[n].classList.add(S.readonlySelectionRect):this.selectionFrames[n].classList.remove(S.readonlySelectionRect):this.selectionFrames[n].style["border"+n]=o.StyleUtil.MakeBorderString(2,"solid",t?this.styles.gridPaneStyle.readonlySelectionRectBorderColor:this.styles.gridPaneStyle.selectionRectBorderColor)}};e.prototype.PositionGridSelectionDragHandle=function(e,t,n){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){this.selectionDragHandle.style.top=null;this.selectionDragHandle.style.bottom=null;this.selectionDragHandle.children[0].style.left=null;this.selectionDragHandle.children[0].style.right=null;this.selectionDragHandle.children[0].style.top=e+"px";if(this._lastSelectionRangeNormalized.colRange.begin<=i.JsGridUtil.Internal.stickyLastColIdx&&this._lastSelectionRangeNormalized.colRange.end<=i.JsGridUtil.Internal.stickyLastColIdx){this.selectionDragHandle.classList.add(S.stickyHandle);this.selectionDragHandle.style.position="sticky";t+=i.JsGridUtil.Internal.stickyLeftEdgeOffset-2}}else{this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=e+"px"}this.selectionDragHandle.style.left=t+"px";n&&(this.selectionDragHandle.style.zIndex=n)};e.prototype.HideSelectionFrames=function(e){if(this.selectionDragHandle&&this.selectionFrames){e||(this.selectionDragHandle.style.visibility="hidden");for(var t in this.selectionFrames)this.selectionFrames[t].style.visibility="hidden"}};e.prototype.UnhideSelectionFrames=function(){this.selectionDragHandle.style.visibility="";for(var e in this.selectionFrames)this.selectionFrames[e].style.visibility=""};e.prototype.UpdatePseudoStickyElementsForScroll=function(e){var t=0,n=0;if(this.selectionDragHandle&&this._cellsWithBorder&&this._cellsWithBorder.length&&this._lastSelectionRangeNormalized&&this._lastSelectionRangeNormalized.colRange&&this._lastSelectionRangeNormalized.rowRange&&this._lastSelectionRangeNormalized.colRange.begin==this._lastSelectionRangeNormalized.colRange.end&&this._lastSelectionRangeNormalized.rowRange.begin==this._lastSelectionRangeNormalized.rowRange.end){t=this._cellsWithBorder[0].offsetLeft;n=this._cellsWithBorder[0].clientWidth}for(var r=document.getElementsByClassName(w.stickyEditor),s=0;s<r.length;s++)this.jsGridObj.objBag.RTL.bEnabled?r[s].style.right=(e.scrollWidth-(t+n)-(i.JsGridUtil.Internal.stickyLeftEdgeOffset-2)).toString()+"px":r[s].style.left=(t+2).toString()+"px"};e.prototype.ClearPseudoElementFrame=function(e,t,n){for(;e.length>0;){e[0].classList.remove(E.readOnlySelectionFrame);e[0].classList.remove(t);n&&e[0].classList.remove(n);e[0].classList.remove(E.cellTopBorder);e[0].classList.remove(E.cellBottomBorder);e[0].classList.remove(E.cellLeftBorder);e[0].classList.remove(E.cellRightBorder);e.splice(0,1)}};e.prototype.ApplyPseudoElementFrame=function(e,t,n,r){var i=y.deepCopy(e.colRange);r&&(i.begin=-1);for(var s=i.begin;s<=i.end;s++){var o=void 0;if(-1!=s)o=this.GetCellByIdx(e.rowRange.begin,s).GetTd();else{o=this.GetCellByIdx(e.rowRange.begin,0).GetTd().previousElementSibling}o.classList.add(E.cellTopBorder);o.classList.add(n);t.push(o);if(-1!=s)o=this.GetCellByIdx(e.rowRange.end,s).GetTd();else{o=this.GetCellByIdx(e.rowRange.end,0).GetTd().previousElementSibling}o.classList.add(E.cellBottomBorder);o.classList.add(n);t.push(o)}for(s=e.rowRange.begin;s<=e.rowRange.end;s++){o=void 0;if(-1!=i.begin)o=this.GetCellByIdx(s,i.begin).GetTd();else{o=this.GetCellByIdx(s,0).GetTd().previousElementSibling}this._objBag.RTL.bEnabled?o.classList.add(E.cellRightBorder):o.classList.add(E.cellLeftBorder);o.classList.add(n);t.push(o);if(-1!=i.end)o=this.GetCellByIdx(s,i.end).GetTd();else{o=this.GetCellByIdx(s,0).GetTd().previousElementSibling}this._objBag.RTL.bEnabled?o.classList.add(E.cellLeftBorder):o.classList.add(E.cellRightBorder);o.classList.add(n);t.push(o)}};e.prototype.UpdateSelectionFrames=function(e){var t,n=this;if(!this.dontReflow){i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.ClearPseudoElementFrame(this._cellsWithBorder,E.cellHasSelectionBorder);if(e)(function(){n.selectionDragHandle.style.backgroundColor=n.const_BlurBorderColor;for(var e in n.selectionFrames)n.selectionFrames[e].style.borderColor=n.const_BlurBorderColor})();else if(null!=this._selectionMgr.GetFocusForPane(this.gridPane)&&this.paneConverter.GetVirtualRowCount()&&this.paneConverter.GetVirtualColumnCount()&&this._cutcopypasteMgr.IsSelectionCopyable(this.gridPane)){var s=this._selectionMgr.GetLastSelectionRangeNormalized();if(null!=s){var o=!1;i.JsGridUtil._readOnlyWidgetKillSwitchIsActive||this._readOnlyWidget.Collapse();if(this._objBag.editUtil.IsEditingEnabled()&&this._selectionMgr.IsOneCellSelected(s)){var u=this.tableMgr.GetCellByIdx(s.rowRange.begin,s.colRange.begin),a=r.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,f=r.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive;if(!i.JsGridUtil._readOnlyWidgetKillSwitchIsActive&&u){var l=u.GetRecord(),c=u.GetColumn(),h=u.GetFieldKey(),p=u.GetTd();if(!(this._objBag.editUtil.CanEditField(l,c,h)||this._objBag.delegateMgr.DelegatePresent(a)&&this._objBag.delegateMgr.Apply(a,h)===f)){var d=this.GetTdCoordsRelativeToParentNode(u.GetTd()),v={x:d.left,y:d.top,width:d.width,height:d.height},m=this.GetTableViewportRelativeToParentNode(),g=this._editMgr.GetExpandSpace(v,m),y=p.textContent||p.innerText||"",w=y?y+", "+b.default.readOnlyWidget.toLowerCase():b.default.readOnlyWidget;p.setAttribute("aria-label",w);this._readOnlyWidget.Expand({cellRect:v,cellExpandSpace:g,cellTd:p})}}else null==u||this._objBag.editUtil.CanEditField(u.GetRecord(),u.GetColumn(),u.GetFieldKey())||this._objBag.delegateMgr.DelegatePresent(a)&&this._objBag.delegateMgr.Apply(a,u.GetFieldKey())===f||(o=!0)}var x=this._selectionMgr.GetLastSelectionType();this.quickEditVisualRefreshFlightEnabled&&x===r.JsGridConstants.SelectionType.RowRange&&(i.JsGridUtil._lastColumnVisibilityKillSwitchIsActive?s.colRange.end=s.colRange.end-1:this._objBag.showAddColumnMenu&&this._objBag.canUserAddColumn&&(s.colRange.end=s.colRange.end-1));var T=this.gridPane.GetCellRangeBorderDrawingInfo(s.rowRange,s.colRange,x);if(null!=T){var N=this.quickEditVisualRefreshFlightEnabled?T.width:T.width+2+2,C=this.quickEditVisualRefreshFlightEnabled?T.height:T.height+2+2,k=this.quickEditVisualRefreshFlightEnabled?{Top:{left:T.left,top:T.top,width:N,visibility:""},Right:{left:T.right-3,top:T.top,height:C-2,visibility:""},Bottom:{left:T.left,top:T.bottom-5,width:N,visibility:""},Left:{left:T.left,top:T.top,height:C-2,visibility:""}}:{Top:{left:T.left-1,top:T.top-1,width:N-2,visibility:""},Right:{left:T.right-3,top:T.top-1,height:C-2,visibility:""},Bottom:{left:T.left-1,top:T.bottom-3,width:N-2,visibility:""},Left:{left:T.left-1,top:T.top-1,height:C-2,visibility:""}};T.bBeginsBeforeRowHeader&&(k[this._objBag.RTL.Left].visibility="hidden");T.bBeginsBeforeColumnHeader&&(k.Top.visibility="hidden");if(!this.useCustomSelFrames||!this._lastSelectionRangeNormalized||this._lastSelectionRangeNormalized.rowRange&&this._lastSelectionRangeNormalized.colRange&&(this._lastSelectionRangeNormalized.rowRange.IsDifferent(s.rowRange)||this._lastSelectionRangeNormalized.colRange.IsDifferent(s.colRange))){this.selectionDragHandle.style.visibility="hidden";if(this._objBag.editUtil.IsEditingEnabled()&&this._objBag.jsGridParams.tableViewParams.bFillControlEnabled){if(this.quickEditVisualRefreshFlightEnabled){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&s){this.ApplyPseudoElementFrame(s,this._cellsWithBorder,E.cellHasSelectionBorder,x===r.JsGridConstants.SelectionType.RowRange);o&&s.colRange.begin===s.colRange.end&&s.rowRange.begin===s.rowRange.end&&this._cellsWithBorder[0].classList.add(E.readOnlySelectionFrame)}o?i.JsGridUtil.Internal.IsStickyColumnEnabled()?this.selectionDragHandle.children[0].classList.add(S.readonlySelectionRect):this.selectionDragHandle.classList.add(S.readonlySelectionRect):i.JsGridUtil.Internal.IsStickyColumnEnabled()?this.selectionDragHandle.children[0].classList.remove(S.readonlySelectionRect):this.selectionDragHandle.classList.remove(S.readonlySelectionRect);if(x===r.JsGridConstants.SelectionType.RowRange){this.selectionDragHandle.classList.add(S.rowSelectionHandle);this.selectionDragHandle.style.visibility="";i.JsGridUtil.Internal.IsStickyColumnEnabled()||(this.selectionDragHandle.style.top=T.bottom-9+"px");this._objBag.RTL.bEnabled?this.selectionDragHandle.style.left=T.right-7+"px":this.selectionDragHandle.style.left=T.left+"px";if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){this.selectionDragHandle.style.top=null;this.selectionDragHandle.style.bottom=null;this.selectionDragHandle.children[0].style.left=null;this.selectionDragHandle.children[0].style.right=null;this.selectionDragHandle.classList.add(S.stickyHandle);this.selectionDragHandle.style.position="sticky";if(this._objBag.RTL.bEnabled){this.selectionDragHandle.style.left=null;this.selectionDragHandle.style.right=i.JsGridUtil.Internal.stickyLeftEdgeOffset.toString()+"px"}else{this.selectionDragHandle.style.right=null;this.selectionDragHandle.style.left=i.JsGridUtil.Internal.stickyLeftEdgeOffset.toString()+"px"}this.selectionDragHandle.children[0].style.top=T.bottom-9+"px"}}else if(x===r.JsGridConstants.SelectionType.CellRange){this.selectionDragHandle.classList.remove(S.rowSelectionHandle);this.selectionDragHandle.style.visibility=T.isSelectionCellSelected?"hidden":"";if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){this.selectionDragHandle.style.top=null;this.selectionDragHandle.style.bottom=null;this.selectionDragHandle.children[0].style.left=null;this.selectionDragHandle.children[0].style.right=null;this.selectionDragHandle.children[0].style.top=T.bottom-7+"px";var L=0;L=this._objBag.RTL.bEnabled?T.left-35:T.right-3;if(s.colRange.begin<=i.JsGridUtil.Internal.stickyLastColIdx&&s.colRange.end<=i.JsGridUtil.Internal.stickyLastColIdx){this.selectionDragHandle.classList.add(S.stickyHandle);this.selectionDragHandle.style.position="sticky";L+=i.JsGridUtil.Internal.stickyLeftEdgeOffset-2;if(this._objBag.RTL.bEnabled){this.selectionDragHandle.style.left=null;this.selectionDragHandle.style.right=T.width+86+"px"}else this.selectionDragHandle.style.left=L+"px"}else{this.selectionDragHandle.classList.remove(S.stickyHandle);this.selectionDragHandle.style.position="absolute";this.selectionDragHandle.style.left=L+"px";this.selectionDragHandle.style.right=null}}else{this.selectionDragHandle.style.top=T.bottom-7+"px";this._objBag.RTL.bEnabled?this.selectionDragHandle.style.left=T.left-2+"px":this.selectionDragHandle.style.left=T.right-5+"px"}if(this._objBag.editUtil.IsEditingEnabled()&&this._selectionMgr.IsOneCellSelected(s)){var O=this._objBag.errorMgr;if(u=this.tableMgr.GetCellByIdx(s.rowRange.begin,s.colRange.begin)){l=u.GetRecord(),c=u.GetColumn(),h=u.GetFieldKey();var M=!A&&(null===(t=O)||void 0===t?void 0:t.CellHasError(u.GetRecordKey(),u.GetFieldKey())),_=!i.JsGridUtil._readOnlyWidgetKillSwitchIsActive&&!this._objBag.editUtil.CanEditField(l,c,h);(M||_)&&(this.selectionDragHandle.style.visibility="hidden")}}}}else{this.selectionDragHandle.style.backgroundColor=o?this.styles.gridPaneStyle.readonlySelectionRectBorderColor:this.styles.gridPaneStyle.selectionRectBorderColor;if(x==r.JsGridConstants.SelectionType.RowRange){this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=T.bottom-3+"px";k[this._objBag.RTL.Left].height-=5;k.Bottom.width-=9;if(this._objBag.RTL.bEnabled)this.selectionDragHandle.style.left=T.right-7+"px";else{this.selectionDragHandle.style.left=T.left+2+"px";k.Bottom.left+=9}}else if(x==r.JsGridConstants.SelectionType.ColumnRange);else{this.selectionDragHandle.style.visibility="";this.selectionDragHandle.style.top=T.bottom-4+"px";k[this._objBag.RTL.Right].height-=5;k.Bottom.width-=5;if(this._objBag.RTL.bEnabled){this.selectionDragHandle.style.left=T.left-2+"px";k.Bottom.left+=5}else this.selectionDragHandle.style.left=T.right-4+"px"}}this.PositionGridSelectionFrame(k,o)}}this._lastSelectionRangeNormalized=s;i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.HideSelectionFrames(!0)}else this.HideSelectionFrames()}else this.HideSelectionFrames()}else this.HideSelectionFrames()}};e.prototype.UpdateCopyFrames=function(e){var t=this,n=function(){for(var e in t.copyFrames)for(var n in t.copyFrames[e]){t.copyFrames[e][n].style.visibility="hidden";t.quickEditVisualRefreshFlightEnabled&&"Fore"===e&&t.copyFrames[e][n].classList.remove(S.dashedBorderUnfocused)}};i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.ClearPseudoElementFrame(this._cellsWithCopyBorder,E.cellHasCopyBorder);var s=this._cutcopypasteMgr.GetLastOperation(),o=this._selectionMgr.GetLastSelectionType();this.quickEditVisualRefreshFlightEnabled&&o===r.JsGridConstants.SelectionType.RowRange&&s&&e&&(i.JsGridUtil._lastColumnVisibilityKillSwitchIsActive?s.colRange.end=s.colRange.end-1:this._objBag.showAddColumnMenu&&this._objBag.canUserAddColumn&&(s.colRange.end=s.colRange.end-1));var u=null!=s&&s.gridPane==this.gridPane?this.gridPane.GetCellRangeBorderDrawingInfo(s.rowRange,s.colRange,s.selType):null;if(null!=u){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){var a=s;o===r.JsGridConstants.SelectionType.RowRange&&(a.colRange.begin=-1);this.ApplyPseudoElementFrame(s,this._cellsWithCopyBorder,E.cellHasCopyBorder)}var f=u.width+2,l=u.height+2,c=this.quickEditVisualRefreshFlightEnabled?{Top:{left:u.left,top:u.top,width:f-2,visibility:""},Right:{left:u.right-3,top:u.top,height:l-4,visibility:""},Bottom:{left:u.left,top:u.bottom-5,width:f-2,visibility:""},Left:{left:u.left,top:u.top,height:l-4,visibility:""}}:{Top:{left:u.left,top:u.top,width:f,visibility:""},Right:{left:u.right-2,top:u.top,height:l,visibility:""},Bottom:{left:u.left,top:u.bottom-2,width:f,visibility:""},Left:{left:u.left,top:u.top,height:l,visibility:""}};u.bBeginsBeforeRowHeader&&(c[this._objBag.RTL.Left].visibility="hidden");u.bBeginsBeforeColumnHeader&&(c.Top.visibility="hidden");for(var h in this.copyFrames)for(var p in this.copyFrames[h])for(var d in c[p]){this.copyFrames[h][p].style[d]="visibility"==d?c[p][d]:c[p][d]+"px";this.quickEditVisualRefreshFlightEnabled&&"Fore"===h&&this.copyFrames[h][p].classList.remove(S.dashedBorderUnfocused)}i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n()}else n()};e.prototype.UpdateFocusFrames=function(){var e=this,t=function(){for(var t in e.focusFrames)e.focusFrames[t].style.visibility="hidden"};i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this.ClearPseudoElementFrame(this._cellsWithFocusBorder,E.cellHasSelectionBorder);var n=this._selectionMgr.GetFocusForPane(this.gridPane);if(null==n||this._cutcopypasteMgr.IsSelectionCopyable(this.gridPane))t();else{var r,o=new u.Range(n.rowIdx,n.rowIdx).Normalize(),a=new u.Range(n.colIdx,n.colIdx).Normalize(),f=this._selectionMgr.GetLastSelectionType();if(null!=(r=this.quickEditVisualRefreshFlightEnabled&&i.JsGridUtil.Internal.IsFeatureEnabled(M)?this.gridPane.GetCellRangeBorderDrawingInfo(o,a,f):this.gridPane.GetCellRangeBorderDrawingInfo(o,a))){var l=r.width,c=r.height,h=this.quickEditVisualRefreshFlightEnabled?{Top:{left:r.left,top:r.top,width:l},Right:{left:r.right-3,top:r.top,height:c-2},Bottom:{left:r.left,top:r.bottom-5,width:l},Left:{left:r.left,top:r.top,height:c-2}}:{Top:{left:r.left+1,top:r.top+1,width:l},Right:{left:r.right-2,top:r.top+1,height:c},Bottom:{left:r.left+1,top:r.bottom-2,width:l},Left:{left:r.left+1,top:r.top+1,height:c}};for(var p in this.focusFrames){for(var d in h[p])this.focusFrames[p].style[d]=h[p][d]+"px";this.focusFrames[p].style.visibility=""}if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n){var v={rowRange:o,colRange:a};f===s.SelectionType.RowRange&&(v.colRange.begin=-1);this.ApplyPseudoElementFrame({rowRange:o,colRange:a},this._cellsWithFocusBorder,E.cellHasSelectionBorder,!1);t()}}else t()}};e.prototype.CreateHideShowColumnCommand=function(e,t,n){var r=this;n=null!=n?n:this.paneConverter.ColKeyToColIdx(t.columnKey);var i=function(){var e=r._selectionMgr.GetFocusForPane(r.gridPane);r.HideImpl(t,n);r.TryRestoreFocusAfterInsertOrDeleteColumns(e);r.UpdatePositionedElements();r._editMgr.NotifyMove(r.gridPane)},s=function(){var e=r._selectionMgr.GetFocusForPane(r.gridPane);r.ShowImpl(t,n);r.TryRestoreFocusAfterInsertOrDeleteColumns(e);r.gridPane.ScrollColumnIntoViewHorizontally(n);r.UpdatePositionedElements();r._editMgr.NotifyMove(r.gridPane)};return"hide"==e?{Apply:i,Undo:s}:{Apply:s,Undo:i}};e.prototype.TryRestoreFocusAfterInsertOrDeleteColumns=function(e){if(null!=e)if(null!=this.paneConverter.KeyToIdx(e.recordKey,e.fieldKey))this._selectionMgr.SetFocusByKey(this.gridPane,e.recordKey,e.fieldKey);else{var t=e.colIdx>=this.paneConverter.GetVirtualColumnCount()?this.paneConverter.GetVirtualColumnCount()-1:e.colIdx;this._selectionMgr.Clear();this._selectionMgr.SetFocusByPos(this.gridPane,e.rowIdx,t)}};e.prototype.HideImpl=function(e,t){this.ResetSelection();this.tableMgr.RemoveColumns(t,1);this.itemSizes.splice(t,1);this.horizScrollBar.Update({itemCount:this.itemSizes.length,itemSizes:this.itemSizes});e.isVisible=!1};e.prototype.ShowImpl=function(e,t){t<this.paneConverter.GetVirtualColumnCount()&&this.gridPane.ScrollColumnIntoViewHorizontally(t);this.ResetSelection();this.headerMgr.AdjustColumnWidth(e);this.tableMgr.InsertColumns(t,[e]);this.itemSizes.splice(t,0,e.width);this.horizScrollBar.Update({itemCount:this.itemSizes.length,itemSizes:this.itemSizes});e.isVisible=!0};e.prototype.HandleUpdateInAllColumns=function(e,t){for(var n=this.allColumns.GetColumnArray(),r=0;r<n.length&&!(r>e&&r>t);r++)if(!n[r].isVisible){r<=e&&e++;r<=t&&t++}i.JsGridUtil.Internal.MoveItemInArray(n,e,t)};e.prototype.CreateMoveColumnCommand=function(e,t){var n=this,r=function(e,t){if(e!==t){var r=n._selectionMgr.GetFocusForPane(n.gridPane),i=n.horizScrollBar.GetTopItemIdx(),s=n.paneConverter.GetColumnByIdx(e);n.HideImpl(s,e);n.ShowImpl(s,t);null!=r&&n._selectionMgr.SetFocusByKey(n.gridPane,r.recordKey,r.fieldKey);n.UpdatePositionedElements();n.horizScrollBar.Update({topItemIdx:i});n.HandleUpdateInAllColumns(e,t);n._editMgr.NotifyMove(n.gridPane)}};return{Apply:function(){r(e,t)},Undo:function(){r(t,e)}}};e.prototype.ShowColumnInternal=function(e,t){if(null==t)for(var n=0,r=this.allColumns.GetColumnArray(),s=0;s<r.length;s++){if(r[s]==e){t=s-n;break}r[s].isVisible||n++}i.JsGridUtil.DebugAssert(null!=t);this._commandMgr.Execute(this.CreateHideShowColumnCommand("show",e,t),"Show Column",a.CommandManagerConstants.CommandType.Implicit)};e.prototype.HideColumnInternal=function(e){1!==this.paneConverter.GetVirtualColumnCount()&&this._commandMgr.Execute(this.CreateHideShowColumnCommand("hide",e,null),"Hide Column",a.CommandManagerConstants.CommandType.Implicit)};e.prototype.MoveColumn=function(e,t){var n=e<t?t-1:t;this._commandMgr.Execute(this.CreateMoveColumnCommand(e,n),"Move Column",a.CommandManagerConstants.CommandType.Explicit)};e.prototype.ExpandColumnMenuInternal=function(e){var t=this,n=function(){t.lockedColIdx=null;t.headerMgr.SetColumnMenuCollapsed(e);t.DeactivateColumn();t._objBag.focusMgr.Focus()};if(null==this.lockedColIdx){var i=this.paneConverter.GetColumnByKey(e);if(null==i)return!1;var s;if(null==(s=this.headerMgr.GetColumnHeaderPosition(e)))return!1;this.lockedColIdx=this.paneConverter.ColKeyToColIdx(e);var o=this.headerMgr.GetColumnHeaderElement(e);if(this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.ExpandColumnMenu)){this.delegateMgr.Apply(r.JsGridConstants.DelegateType.ExpandColumnMenu,e,s,n);this.headerMgr.SetColumnMenuExpanded(e)}else this._objBag.columnMenuMgr.ExpandMenu(i,s,n,this.bHidableColumns,this.bSortableColumns,this.bAutoFilterableColumns,o)&&this.headerMgr.SetColumnMenuExpanded(e);return!0}return!1};e.prototype.OnColumnMenuClick=function(e,t){this.ExpandColumnMenuInternal(t)&&i.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)};e.prototype.ExpandColumnMenu=function(e){if(this._objBag.columnMenuMgr.CanExpandMenu(this.paneConverter.GetColumnByIdx(e),this.bHidableColumns,this.bSortableColumns,this.bAutoFilterableColumns,this.bResizableColumns)){this.gridPane.ScrollColumnIntoViewHorizontally(e);this.ActivateColumn(e);return this.ExpandColumnMenuInternal(this.paneConverter.ColIdxToColKey(e))}return!1};e.prototype.OnInsertedRow=function(e,t){null!=e&&this.reorderableRows.Contains(e.GetRecordKey())&&(e.GetTd().style.cursor="move")};e.prototype.OnInsertedColumns=function(e,t,n){for(var r=0;r<e.length;r++){var i=this._objBag.columnMenuMgr.CanExpandMenu(e[r].GetColumn(),this.bHidableColumns,this.bSortableColumns,this.bAutoFilterableColumns,this.bResizableColumns),s=e[r].GetTd();this.headerMgr.CreateTableHeaderCell(e[r].GetColumn(),s,n,this.bMovableColumns,this.bResizableColumns,this.bSortableColumns,!0,i?this.OnColumnMenuClick.bind(this):null,this.GetColumnHeaderSibling.bind(this),e[r].GetColIdx());this.headerMgr.ShowMenuOnColumn(this.tableMgr.GetColumnHeader(e[r].GetColIdx()).GetTd());this.headerMgr.ApplyHeaderStyle(s,this.GetHeaderStyle(e[r].GetColIdx(),!1))}null==this.curColUpdateTimeOut&&(this.curColUpdateTimeOut=setTimeout(this.UpdateFirstDisplayColumn.bind(this),0))};e.prototype.UpdateFirstDisplayColumn=function(){if(!this.bIsDisposed){var e=this.tableMgr.GetColumnHeader(this.tableMgr.BeginColIdx());null!=e&&this.headerMgr.NotifyColumnHeaderOrderSet(e.GetTd())}this.curColUpdateTimeOut=null};e.prototype.GetDisplayControlAndContentForCell=function(e,t,n,r,i){var s=t.GetProp(n);if(s){var o=null==s?this.gridFieldMap[n].GetPropType():s.propType;if(o){var u=p.PropertyType.Internal.Property.GetInstance().GetDisplayControlForProperty(o,!C&&t.bIsNewRow?null:i);return{content:u.Render(this._fnGetCellValue(t,n,o),t,e,this.gridFieldMap[n],o,r,this.jsGridObj,this._objBag.RTL,this.tableMgr.GetCellByKey(t.key(),n).GetTd()),displayControl:u}}}return{content:null,displayControl:null}};e.prototype.GetContentForCell=function(e,t,n,r,i){return this.GetDisplayControlAndContentForCell(e,t,n,r,i).content};e.prototype.BuildCellContent=function(e){var t,n,r,s,o,u=this,a=e.GetRecord(),f=function(e){if(null!=e.fnDispose){null==u.disposeMap[r]&&(u.disposeMap[r]={});null==u.disposeMap[r][s]&&(u.disposeMap[r][s]=[]);u.disposeMap[r][s].push(e.fnDispose);e=e.elem}n.appendChild(e)};if(null!=a){o=e.GetColumn();s=e.GetFieldKey();var l=o.fnGetDisplayControlName&&o.fnGetDisplayControlName(a,s);t=this.GetDisplayControlAndContentForCell(o,a,s,this.RefreshCellStyle(e),l).content}if(null!=t){n=e.GetTd();r=a.key();if(null!=t.multipleChildren)for(var c=0;c<t.multipleChildren.length;c++)f(t.multipleChildren[c]);else f(t);return!0}if(this.quickEditVisualRefreshFlightEnabled&&a.bIsNewRow&&e&&e.tableColIdx<=2&&"DocIcon"!==e.fieldKey){n=e.GetTd();if(2===e.tableColIdx){if(i.JsGridUtil.Internal.DomElement.GetInstance().GetPrevElement(n).firstChild)return!1}var h=document.createElement("span");h.classList.add(E.inlineNewItemPlaceHolder);h.textContent=b.default.addNewItemPlaceHolder;n.appendChild(h);return!0}return!1};e.prototype.TryDisposeRow=function(e){if(e in this.disposeMap){for(var t in this.disposeMap[e])i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.disposeRenderedObjectsJobKey,e,t);delete this.disposeMap[e]}};e.prototype.TryBeginEdit=function(e){i.JsGridUtil.DebugAssert("keypress"==e.type||"mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&(e.keyCode==r.JsGridConstants.Key.F2||e.keyCode==r.JsGridConstants.Key.IMEInput||i.JsGridUtil.Internal.IsFeatureEnabled(_)&&e.keyCode===r.JsGridConstants.Key.enter));var t=this._selectionMgr.GetFocusForPane(this.gridPane);if(null==t)return!1;this.gridPane.ScrollCellIntoView(t.rowIdx,t.colIdx);if(this._editMgr.IsBound()){this._cutcopypasteMgr.CancelMode();this._editMgr.BeginEdit(e);return!0}return!1};e.prototype.GetColumnHeaderSibling=function(e,t){if(l.extraSpacerColumnsKillswitchIsActive)return t?e.previousSibling:e.nextSibling;var n=e.previousSibling;t||(n=e.nextSibling);n&&"presentation"===n.getAttribute("role")&&(n=void 0);return n};e.prototype.GetRowHeaderSibling=function(e,t){var n=t?e.parentNode.previousSibling:e.parentNode.nextSibling;return n&&n.firstChild};e.prototype.GetHeaderStyle=function(e,t,n){var r=t?this.styles.rowHeaderStyleCollection:this.styles.columnHeaderStyleCollection;if(n)return r.normal;for(var i=e==(t?this.activeRowIdx:this.activeColIdx),s=t?[this._selectionMgr.GetRowRanges(this.gridPane),this._selectionMgr.GetColumnRanges(this.gridPane)]:[this._selectionMgr.GetColumnRanges(this.gridPane),this._selectionMgr.GetRowRanges(this.gridPane)],o=0;o<s[0].length;o++)if(s[0][o].Contains(e))return i?r.allSelectedHover:r.allSelected;if(0!==s[1].length)return i?r.partSelectedHover:r.partSelected;var u=this._selectionMgr.GetCellRanges(this.gridPane);for(o=0;o<u.length;o++)if((t?u[o].rowRange:u[o].colRange).Contains(e))return i?r.partSelectedHover:r.partSelected;return i?r.normalHover:r.normal};return e})();t.GridPane=H;var B=(function(){function e(e){this.resizingColIdx=null;this.movingColIdx=null;this.startMovingColIdx=null;this.bColumnSelection=!1;this.bRowReordering=!1;this.bHeaderEventHandlersSetup=!1;this.bScrollTimerActive=!1;this.cachedMouseMoveEventInfo=null;this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};this._lastResize=Date.now();this._resizeDeltaOnMouseMove=0;this._gridPane=e;this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};this._gridPane.tableDiv.addEventListener("mousedown",this.OnTableMouseDown.bind(this));this._gridPane.tableDiv.addEventListener("mousemove",this.OnTableMouseMove.bind(this));this._gridPane.tableDiv.addEventListener("mouseup",this.OnTableMouseUp.bind(this));this._gridPane.tableDiv.addEventListener("dblclick",this.OnTableDoubleClick.bind(this));this._gridPane.selectionDragHandle.addEventListener("mousedown",this.OnFillHandleMouseDown.bind(this));this._gridPane.tableDiv.addEventListener("contextmenu",this.onContextMenu.bind(this))}e.prototype.SetupHeaderEvents=function(){if(!this.bHeaderEventHandlersSetup){this.topTr=this._gridPane.tableMgr.GetColumnHeaderTr();this.topTr.addEventListener("mousedown",this.OnColumnHeaderMouseDown.bind(this));this.topTr.addEventListener("mousemove",this.OnColumnHeaderMouseMove.bind(this));this.topTr.addEventListener("mouseout",this.OnColumnHeaderMouseOut.bind(this));this.topTr.addEventListener("keydown",this.OnColumnHeaderKeyDown.bind(this))}this.bHeaderEventHandlersSetup=!0};e.prototype.ClearHeaderEvents=function(){this.bHeaderEventHandlersSetup&&i.JsGridUtil.ClearEventListeners(this.topTr);this.bHeaderEventHandlersSetup=!1};e.prototype.Dispose=function(){window.removeEventListener("resize",this._gridPane.onResizeHandler);this.ClearHeaderEvents();i.JsGridUtil.ClearEventListeners(this._gridPane.tableDiv);i.JsGridUtil.ClearEventListeners(this._gridPane.selectionDragHandle);this.topTr=null};e.prototype.ShiftSelect=function(e,t){var n=t.GetCellType(),r=e.ctrlKey?s.SelectOp.ReplaceLast:s.SelectOp.Set,i=this._gridPane._selectionMgr.GetFocusForPane(this._gridPane);null!=i&&(this.cachedMouseDownCellInfo.cellType!=this._gridPane.tableMgr.CellType.RowHeader||n!=this._gridPane.tableMgr.CellType.RowHeader&&n!=this._gridPane.tableMgr.CellType.Cell?this.cachedMouseDownCellInfo.cellType!=this._gridPane.tableMgr.CellType.ColumnHeader||n!=this._gridPane.tableMgr.CellType.ColumnHeader&&n!=this._gridPane.tableMgr.CellType.Cell?this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.Cell&&n==this._gridPane.tableMgr.CellType.Cell&&this._gridPane._selectionMgr.SelectRange(this._gridPane,i.rowIdx,t.GetRowIdx(),i.colIdx,t.GetColIdx(),r,!1,!0):this._gridPane._selectionMgr.SelectRange(this._gridPane,null,null,i.colIdx,t.GetColIdx(),r,!1,!0):this._gridPane._selectionMgr.SelectRange(this._gridPane,i.rowIdx,t.GetRowIdx(),null,null,r,!1,!0))};e.prototype.OnFillHandleMouseDown=function(e){if(i.JsGridUtil.Internal.IsFeatureEnabled(O)&&this._gridPane._editMgr.IsEditing()){e.preventDefault();e.stopPropagation()}else e.button==r.JsGridConstants.MouseButton.leftButton&&this._gridPane._selectionMgr.GetFocusedPane()==this._gridPane&&this._gridPane._fillDownMgr.OnMouseDown(e,this._gridPane,this._gridPane._objBag.parentNode,this._gridPane.selectionDragHandle,this._gridPane.tableMgr,this._gridPane._selectionMgr)};e.prototype.OnTableDoubleClick=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);(t&&t.GetCellType())==this._gridPane.tableMgr.CellType.ColumnHeader&&this.AutoResizeActiveColumn();this.FireClickEvent(e,t,r.JsGridConstants.EventType.OnDoubleClick)};e.prototype.OnTableMouseDown=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};if(!i.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(e.target,"ms-jsgrid-click-passthrough","true")&&e.button==r.JsGridConstants.MouseButton.leftButton){if(t&&null==t.GetRowIdx()&&!this.bColumnSelection)return;if(i.JsGridUtil.Internal.IsFeatureEnabled(O)){this._gridPane.tableDiv.classList.add(E.tableParentDiv);this._gridPane.tableDiv.classList.add(E.tableHasMouseDown)}this.bColumnSelection=!1;this.HandleTableLeftClick(t,e)}};e.prototype.onContextMenu=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);this.cachedMouseDownCellInfo={cellType:null,recordKey:null,fieldKey:null,bPendingClick:!1,bPendingDoubleClick:!1};if(!i.JsGridUtil.Internal.DomElement.GetInstance().AttributeOnElementOrAncestor(e.target,"ms-jsgrid-click-passthrough","true")){this.FireClickEvent(e,t,r.JsGridConstants.EventType.OnRightClick);return!1}};e.prototype.HandleTableLeftClick=function(e,t){var n,r,o,u,a=this;if(null!=e){this.cachedMouseDownCellInfo.cellType=e.GetCellType();this.cachedMouseDownCellInfo.recordKey=e.GetRecordKey();this.cachedMouseDownCellInfo.fieldKey=e.GetFieldKey();i.JsGridUtil.Internal.IsFeatureEnabled(O)&&i.JsGridUtil.Internal.IsFeatureEnabled(M)&&this._gridPane._selectAllCell.GetTd().classList.remove(E.allRowsSelected);if(this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.RowHeader&&this._gridPane.reorderableRows.Contains(this.cachedMouseDownCellInfo.recordKey)){this.StartRowReorder(t);return}var f=this._gridPane._selectionMgr.GetFocusForPane(this._gridPane);if(i.JsGridUtil.Internal.IsFeatureEnabled(O)&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&f){var l=null===(n=this._gridPane.GetCellByIdx(f.rowIdx,0))||void 0===n?void 0:n.GetTr(),c=null===(r=this._gridPane.GetCellByIdx(e.GetRowIdx(),0))||void 0===r?void 0:r.GetTr();null===(o=l)||void 0===o||o.classList.remove(E.rowHasOnlyOneCellSelected);null===(u=c)||void 0===u||u.classList.add(E.rowHasOnlyOneCellSelected)}if(this.cachedMouseDownCellInfo.cellType!==this._gridPane.tableMgr.CellType.SelectAllSquare){t.preventDefault();this.lastMouseMoveCell=e;i.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(this._gridPane.tableDiv,this.OnTableMouseMoveForSelect.bind(this),function(){setTimeout(a.UpdateRowHeadersForReorder.bind(a),0)})}if(t.shiftKey)this.ShiftSelect(t,e);else{var h=e.GetRowIdx(),p=e.GetColIdx(),d=t.ctrlKey?s.SelectOp.Append:s.SelectOp.Set;this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.RowHeader?i.JsGridUtil.Internal.IsFeatureEnabled(O)&&i.JsGridUtil.Internal.IsFeatureEnabled(M)?this.FilterRowHeaderSelection(h,e):this._gridPane._selectionMgr.SelectRange(this._gridPane,h,h,null,null,d,!0,!1):this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.ColumnHeader?this._gridPane._selectionMgr.SelectRange(this._gridPane,null,null,p,p,d,!0,!1):this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.Cell&&this._gridPane._selectionMgr.SelectRange(this._gridPane,h,h,p,p,d,!0,!1);i.JsGridUtil.Internal.IsFeatureEnabled(O)&&i.JsGridUtil.Internal.IsFeatureEnabled(M)&&this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.RowHeader?this.lastMouseMoveCell=e=this._gridPane.tableMgr.GetRowHeaderByKey(this.cachedMouseDownCellInfo.recordKey):this.lastMouseMoveCell=e=this._gridPane.tableMgr.GetCellByKey(this.cachedMouseDownCellInfo.recordKey,this.cachedMouseDownCellInfo.fieldKey);this.cachedMouseDownCellInfo.bPendingClick=this.cachedMouseDownCellInfo.bPendingDoubleClick=!0}if(this.cachedMouseDownCellInfo.cellType==this._gridPane.tableMgr.CellType.Cell&&null!=f&&f.recordKey==this.cachedMouseDownCellInfo.recordKey&&f.fieldKey==this.cachedMouseDownCellInfo.fieldKey&&this._gridPane.TryBeginEdit(t)){i.JsGridUtil.Internal.IsFeatureEnabled(O)&&this._gridPane.tableDiv.classList.remove(E.tableHasMouseDown);t.stopPropagation()}}};e.prototype.FilterRowHeaderSelection=function(e,t){var n=t.GetRecord();if(n&&n.bIsNewRow){var r=t.GetTr();if(r&&r.classList&&!r.classList.contains(E.rowIsActive))return}var i=this._gridPane._selectionMgr,o=i.GetRowRanges(this._gridPane),u=i.IsRowSelected(this._gridPane,e),a=u?s.RowSelectOp.Unselect:s.RowSelectOp.Select,f=a!==s.RowSelectOp.Unselect;1===o.length&&o[0].begin===o[0].end&&u?i.SelectRange(this._gridPane,e,e,0,0,s.SelectOp.Set,!0,!1):i.SelectRange(this._gridPane,e,e,null,null,a,f,!1)};e.prototype.OnTableMouseUp=function(e){if(this.cachedMouseDownCellInfo.bPendingClick){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);null!=t&&!this._gridPane._editMgr.IsEditing()&&this._gridPane._selectionMgr.IsOneCellSelected(this._gridPane._selectionMgr.GetLastSelectionRangeNormalized())&&t.GetCellType()==this._gridPane.tableMgr.CellType.Cell&&this.cachedMouseDownCellInfo.recordKey==t.GetRecordKey()&&this.cachedMouseDownCellInfo.fieldKey==t.GetFieldKey()&&this._gridPane._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnSingleCellClick,i.JsGridUtil.EventArgs.SingleCellClick(e,this.cachedMouseDownCellInfo.recordKey,this.cachedMouseDownCellInfo.fieldKey));this.cachedMouseDownCellInfo.bPendingClick=!1}i.JsGridUtil.Internal.IsFeatureEnabled(O)&&this._gridPane.tableDiv.classList.remove(E.tableHasMouseDown)};e.prototype.FireClickEvent=function(e,t,n){var s=t&&t.GetCellType(),o=t&&t.GetRecord(),u=o&&o.key(),a=t&&t.GetFieldKey(),f=s==this._gridPane.tableMgr.CellType.SelectAllSquare?r.JsGridConstants.ClickContext.SelectAllSquare:s==this._gridPane.tableMgr.CellType.RowHeader?r.JsGridConstants.ClickContext.RowHeader:s==this._gridPane.tableMgr.CellType.ColumnHeader?r.JsGridConstants.ClickContext.ColumnHeader:s==this._gridPane.tableMgr.CellType.Cell?r.JsGridConstants.ClickContext.Cell:r.JsGridConstants.ClickContext.Other;if(n==r.JsGridConstants.EventType.OnRightClick||f!==r.JsGridConstants.ClickContext.Cell||this.cachedMouseDownCellInfo.bPendingDoubleClick&&this.cachedMouseDownCellInfo.cellType==s&&this.cachedMouseDownCellInfo.recordKey==u&&this.cachedMouseDownCellInfo.fieldKey==a){this._gridPane._objBag.eventMgr.FireEvent(n,i.JsGridUtil.EventArgs.Click(e,f,u,a));this.cachedMouseDownCellInfo.bPendingDoubleClick=!1}i.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e)};e.prototype.OnTableMouseMoveForSelect=function(e){var t,n,r=this._gridPane.tableMgr.GetCellByChildElement(e.target);if(null!=r&&(null==this.lastMouseMoveCell||!this.lastMouseMoveCell.Equals(r))){if(i.JsGridUtil.Internal.IsFeatureEnabled(O)&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){var s=this.lastMouseMoveCell;null===(n=null===(t=this._gridPane.GetCellByIdx(s.GetRowIdx(),0))||void 0===t?void 0:t.GetTr())||void 0===n||n.classList.remove(E.rowHasOnlyOneCellSelected)}this.ShiftSelect(e,r);this.lastMouseMoveCell=r}};e.prototype.OnTableMouseMove=function(e){var t=this._gridPane.tableMgr.GetCellByChildElement(e.target);t&&t.GetCellType()==this._gridPane.tableMgr.CellType.RowHeader&&!this.bRowReordering?this._gridPane.ActivateRow(t.GetRowIdx()):this._gridPane.DeactivateRow()};e.prototype.GetActiveReorderableRecordKeys=function(e){var t=this._gridPane.jsGridObj.GetSelectedRowRanges();if(1==t.length){var n,i,s=t[0].keys;null==i&&(i={bAllChildKeysInView:!0,bGroupingRowFound:!1,bLevelZeroFound:!1,expandedKeys:s});if(i.bGroupingRowFound||i.bLevelZeroFound)return[];for(var o=0;o<i.expandedKeys.length;o++)if(this._gridPane.jsGridObj.IsEntryRecordKey(i.expandedKeys[o])||this._gridPane.jsGridObj.IsProvisionalRecordKey(i.expandedKeys[o]))return[];n=i.expandedKeys;if(this._gridPane.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CanReorderRecords)&&this._gridPane.delegateMgr.Apply(r.JsGridConstants.DelegateType.CanReorderRecords,n))return e?i.expandedKeys:s}return[]};e.prototype.UpdateRowHeadersForReorder=function(){if(!this._gridPane.bIsDisposed){for(var e=this._gridPane.tableMgr.GetRowHeaders(),t=0;t<e.length;t++)e[t].GetTd().style.cursor="";var n=this.GetActiveReorderableRecordKeys(!1);for(t=0;t<n.length;t++)this._gridPane.tableMgr.GetRowHeaderByKey(n[t]).GetTd().style.cursor="move";this._gridPane.reorderableRows.Clear();this._gridPane.reorderableRows.AddArray(n)}};e.prototype.StartRowReorder=function(e){if(this.ExpandSelectionForReorder()){this.bRowReordering=!0;this.mouseDownY=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e).y;var t=e.target,n=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(t),r=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv);this.origGhostY=n.y-r.y;this._gridPane.rowDropIndic.style.top=this.origGhostY+"px";this._gridPane.rowDropIndic.style.width=t.offsetWidth+"px";this._gridPane.rowDropIndic.style.visibility="";this._gridPane.tableDiv.style.cursor="move";i.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(t,this.OnRowReorderMouseMove.bind(this),this.OnRowReorderMouseUp.bind(this));this.OnRowReorderMouseMove(e)}};e.prototype.PositionReorderElements=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv),n=this.RowHeaderHitTest(e);if(n.insertRowIdx!==this._gridPane.tableMgr.EndRowIdx()&&null!=n.insertRowIdx){var r=this._gridPane.tableMgr.GetRowHeader(n.insertRowIdx).GetTd(),s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(r).y;this._gridPane.rowDropIndic.style.top=s-t.y-2+"px";this._gridPane.rowDropIndic.style.visibility=""}};e.prototype.OnRowReorderMouseMove=function(e){this.cachedMouseMoveEventInfo=e;this.PositionReorderElements(e);var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv);t.y>=n.y+this._gridPane.tableDiv.offsetHeight-50?this.StartTimerScroll(!1):t.y<=n.y+50?this.StartTimerScroll(!0):this.StopTimerScroll()};e.prototype.TimerScroll=function(e){var t=this;e?this._gridPane._objBag.paneMgr.ScrollUpByOne():this._gridPane._objBag.paneMgr.ScrollDownByOne();this.PositionReorderElements(this.cachedMouseMoveEventInfo);this.bScrollTimerActive&&(this.timer=setTimeout(function(){t.TimerScroll(e)},100))};e.prototype.StartTimerScroll=function(e){var t=this;if(!this.bScrollTimerActive){this.bScrollTimerActive=!0;this.timer=setTimeout(function(){t.TimerScroll(e)},0)}};e.prototype.StopTimerScroll=function(){clearTimeout(this.timer);this.bScrollTimerActive=!1};e.prototype.OnRowReorderMouseUp=function(e){this.StopTimerScroll();this._gridPane.rowDropIndic.style.visibility="hidden";this.bRowReordering=!1;this._gridPane.tableDiv.style.cursor="";var t=this.RowHeaderHitTest(e);if(t.insertRowIdx!==this._gridPane.tableMgr.EndRowIdx()&&null!=t.insertRowIdx){var n=this._gridPane.tableMgr.GetRowHeader(t.insertRowIdx).GetRecordKey();if(this._gridPane.reorderableRows.Contains(n))return;this._gridPane.jsGridObj.IsEntryRecordKey(n)&&(n=null);var s=this.GetSelectionRange();i.JsGridUtil.DebugAssert(!s.bInvalid);this._gridPane.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.OnBeforeRecordReordered)&&!this._gridPane.delegateMgr.Apply(r.JsGridConstants.DelegateType.OnBeforeRecordReordered,s.selectedKeys)||this._gridPane.jsGridObj.ReorderRecords(s.topRecordKey,s.bottomRecordKey,n,!0)}};e.prototype.RowHeaderHitTest=function(e){for(var t,n=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e).y,r=this._gridPane.tableMgr.GetRowHeaders(),s=0;s<r.length;s++){var o=r[s].GetTd(),u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(o);if(0==s&&n<u.y||n>=u.y&&n<u.y+o.offsetHeight){if(this._gridPane.reorderableRows.Contains(r[s].GetRecordKey())||s>0&&this._gridPane.reorderableRows.Contains(r[s-1].GetRecordKey())){var a=this._gridPane.tableMgr.GetRowHeaderByKey(this._gridPane.jsGridObj.GetSelectedRowRanges()[0].keys[0]);t=null!=a?a.GetRowIdx():r[s].GetRowIdx()}else t=r[s].GetRowIdx();break}}null==t&&(t=this._gridPane.tableMgr.EndRowIdx());return{insertRowIdx:t}};e.prototype.GetSelectionRange=function(){var e=this.GetActiveReorderableRecordKeys(!0);if(null==e||0==e.length)return{bInvalid:!0};for(var t=[],n=0;n<e.length;n++)this._gridPane.paneConverter.IsRecordOnScreen(e[n])&&t.push(e[n]);var r=this._gridPane.paneConverter.GetTopRowIdxForKey(t[0]),i=r,s=r,o=t[0],u=t[0];for(n=1;n<t.length;n++)if((r=this._gridPane.paneConverter.GetTopRowIdxForKey(t[n]))<i){i=r;o=t[n]}else if(r>s){s=r;u=t[n]}return{topIdx:i,bottomIdx:s,topRecordKey:o,bottomRecordKey:u,selectedKeys:e}};e.prototype.ExpandSelectionForReorder=function(){var e=this.GetSelectionRange();if(e.bInvalid)return!1;this._gridPane.jsGridObj.SelectRowRange(e.topIdx,e.bottomIdx,!1);this._gridPane.reorderableRows.Clear();this._gridPane.reorderableRows.AddArray(e.selectedKeys);return!0};e.prototype.DetermineHeaderElementInfo=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colAction",null),n=null;null!=t&&(n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(t.elem,"thColumnKey",null));return{colAction:null!=t?i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(t.elem,"colAction"):null,thElem:null!=n?n.elem:null}};e.prototype.OnColumnHeaderMouseDown=function(e){if(e.button===r.JsGridConstants.MouseButton.leftButton){this._gridPane._editMgr.StopEditing(!1);this._gridPane._editMgr.StopEditing(!1);this._gridPane.headerMgr.HeaderMouseDown(e);var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e);this.mouseDownX=t.x;var n=this.DetermineHeaderElementInfo(e),s=this._gridPane.headerMgr.InColumnHeaderEditMode()&&"sort"!==n.colAction;if(null==this._gridPane.lockedColIdx&&!s)if("sort"==n.colAction){var o=this.HeaderHitTest(e,!0);if(null!=o.colIdx){var u=this._gridPane.tableMgr.GetColumnHeader(o.colIdx).GetColumn();this._gridPane.headerMgr.OnSort(e,u.columnKey)}}else if("resize"==n.colAction||"resize-current"==n.colAction){e.preventDefault();var a=this._gridPane._objBag.jsGridParams.telemetry;a&&(this._qos=new(a(g.Qos))({name:"QuickEditColumnResize"}));var f="resize"==n.colAction?this._gridPane.GetColumnHeaderSibling(n.thElem,!0):n.thElem;if(null!=f&&null!=f.thColumnKey){i.JsGridUtil.Internal.DomElement.GetInstance().SetCapture(this.topTr,this.OnColumnHeaderMouseMoveForColumnResize.bind(this),this.OnColumnHeaderMouseUpForColumnResize.bind(this));this.resizingColIdx=this._gridPane.paneConverter.ColKeyToColIdx(f.thColumnKey);this.origWidth=parseInt(this._gridPane.paneConverter.GetColumnByKey(f.thColumnKey).width,10);this._gridPane.headerMgr.SetColumnResizing(f.thColumnKey)}}else if("select"==n.colAction)this.bColumnSelection=!0;else if(i.JsGridUtil.Internal.IsFeatureEnabled(O)&&i.JsGridUtil.Internal.IsFeatureEnabled(M)){var l=this._gridPane.tableMgr.GetCellByChildElement(e.target);(l&&l.GetCellType())===this._gridPane.tableMgr.CellType.SelectAllSquare&&this._gridPane.SelectAllRows()}}};e.prototype.OnColumnHeaderKeyDown=function(e){if(!i.JsGridUtil.Internal.IsFeatureEnabled(O)||i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){if(!e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==r.JsGridConstants.Key.tab){e.preventDefault();e.stopPropagation();this._gridPane._objBag.focusMgr.Focus()}}e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.keyCode==r.JsGridConstants.Key.space&&this._gridPane.ExpandColumnMenu(this._gridPane.focusedColHeaderIndex-1)};e.prototype.OnColumnHeaderMouseMoveForColumnResize=function(e){try{var t,n=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane._parentNode).x,s=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),o=Math.max(n,s.x);this._resizeDeltaOnMouseMove=(o-this.mouseDownX)*(this._gridPane._objBag.RTL.bEnabled?-1:1);t="Title"===this._gridPane.tableMgr.columns[this.resizingColIdx].columnKey?Math.max(this.origWidth+this._resizeDeltaOnMouseMove,200):Math.max(this.origWidth+this._resizeDeltaOnMouseMove,r.JsGridConstants.Internal.MinColumnWidth);var u=this._gridPane.tableMgr.GetColumnHeader(this.resizingColIdx).GetTd();this._gridPane.paneConverter.GetColumnByKey(u.thColumnKey).width=t;this._gridPane.headerMgr.ResizeColumn(u,t);this._gridPane.itemSizes[this.resizingColIdx]=t;this._gridPane.tableMgr.columns[this.resizingColIdx].width=t;u.style.width=t+"px";this._gridPane.tableMgr.ResizeColCoordCache(u.cellIndex,t);this._gridPane.UpdatePositionedElements();this._gridPane._editMgr.NotifyMove(this._gridPane)}catch(e){if(this._qos){this._qos.end({resultType:g.ResultTypeEnum.Failure,resultCode:"FailToMoveElementForColumnResize",error:e.message});this._qos=void 0}}};e.prototype.OnColumnHeaderMouseUpForColumnResize=function(e){var t=this;try{if(null!=this.resizingColIdx){var i=this._gridPane.tableMgr.GetColumnHeader(this.resizingColIdx).GetTd();this._gridPane.headerMgr.SetColumnResized(i.thColumnKey);this._gridPane.tableMgr.OptimizeTableColumns();this._gridPane.horizScrollBar.Update({itemSizes:this._gridPane.itemSizes});if(this._gridPane._objBag.setColumnWidthsToLocalStorage){var s=this._gridPane.GetAllColumns().GetColumnByKey(i.thColumnKey);this._gridPane._objBag.setColumnWidthsToLocalStorage(s.name,s.width-r.JsGridConstants.Internal.ColumnWidthOffset)}var o=this._gridPane._objBag.jsGridParams,u=o.telemetry,a=o.baseEngagementData;u&&a&&u(v.Engagement).logData(n.__assign(n.__assign({},a),{component:"SPGrid",name:"ColumnResize",isIntentional:!0}));if(this._qos){this._qos.end({resultType:g.ResultTypeEnum.Success});this._qos=void 0}this.resizingColIdx=null;if(!N&&!this._resizeDeltaOnMouseMove)return;if(!T){this._lastResize=Date.now();window.setTimeout(function(){if(Date.now()-t._lastResize>450){t._gridPane.UpdateColumns(t._gridPane.allColumns);t._gridPane.jsGridObj.EnsurePaneWidth();t._gridPane.jsGridObj.NotifyDataAvailable()}},500)}}}catch(e){if(this._qos){this._qos.end({resultType:g.ResultTypeEnum.Failure,resultCode:"FailToDropElementForColumnResize",error:e.message});this._qos=void 0}}};e.prototype.AutoResizeActiveColumn=function(){if(null!=this._gridPane.activeColIdx&&this._gridPane.activeColIdx!==this._gridPane.lockedColIdx){var e=this._gridPane.paneConverter.GetColumnByIdx(this._gridPane.activeColIdx);if(e.isResizable){this._gridPane.headerMgr.SetColumnResizing(e.columnKey);var t=this._gridPane.tableMgr.GetColumnHeader(this._gridPane.activeColIdx).GetTd(),n=Math.max(this._gridPane.headerMgr.GetColumnHeaderAutoResizeWidth(t),this._gridPane.tableMgr.GetColumnAutoResizeWidth(this._gridPane.activeColIdx));if(n!==e.width){e.width=n;this._gridPane.headerMgr.ResizeColumn(t,n);this._gridPane.itemSizes[this._gridPane.activeColIdx]=n;this._gridPane.UpdatePositionedElements();this._gridPane._editMgr.NotifyMove(this._gridPane);this._gridPane.tableMgr.OptimizeTableColumns();this._gridPane.horizScrollBar.Update({itemSizes:this._gridPane.itemSizes})}this._gridPane.headerMgr.SetColumnResized(t.thColumnKey)}}};e.prototype.OnCellsMouseMoveForCopy=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n=t.x-this.mouseDownX,r=t.y-this.mouseDownY;this._gridPane.ghostCells.style.top=this.origGhostY+r+"px";this._gridPane.ghostCells.style.left=this.origGhostX+n+"px"};e.prototype.OnColumnHeaderMouseUpForColumnMove=function(e){this._gridPane.ghostHeader.style.visibility=this._gridPane.columnDropIndic.style.visibility="hidden";var t=this._gridPane.tableMgr.GetColumnHeader(this.movingColIdx).GetTd().thColumnKey;this._gridPane.headerMgr.SetColumnMoved(t);if(this.startMovingColIdx!==this.movingColIdx){var n=this.startMovingColIdx<this.movingColIdx?this.movingColIdx+1:this.movingColIdx;this._gridPane.delegateMgr.Apply(r.JsGridConstants.DelegateType.ReorderColumnPositionInView,t,n)}this.movingColIdx=this.startMovingColIdx=null};e.prototype.OnCellsMouseUpForCopy=function(e){this._gridPane._cutcopypasteMgr.OnCopy(this._gridPane);this.hitTest=this.RowHitTest(e);this._gridPane._selectionMgr.SetFocusByPos(this._gridPane,this.hitTest.row,this.hitTest.col);this._gridPane._cutcopypasteMgr.OnPaste(this._gridPane);if(null!=this._gridPane.ghostCells){this._gridPane.ghostCells.parentNode.removeChild(this._gridPane.ghostCells);this._gridPane.ghostCells=null}this._gridPane.UpdatePositionedElements()};e.prototype.OnColumnHeaderMouseMove=function(e){if(null==this.resizingColIdx&&null==this.movingColIdx){var t=this.HeaderHitTest(e,!0);if(null!=t.colIdx){var n=this._gridPane.tableMgr.GetColumnHeader(t.colIdx).GetColumn().columnKey;if(this._gridPane.headerMgr.ColumnCurrentlyEditing(n))return}null!=t.colIdx&&t.bInVertical&&null==this._gridPane.lockedColIdx&&this._gridPane.headerMgr.HeaderMouseMove(e)}};e.prototype.OnColumnHeaderMouseOut=function(e){var t=this.HeaderHitTest(e,!0);if(null!=t.colIdx){var n=this._gridPane.tableMgr.GetColumnHeader(t.colIdx).GetColumn().columnKey;if(this._gridPane.headerMgr.ColumnCurrentlyEditing(n)||t.bInVertical&&t.colIdx==this._gridPane.activeColIdx)return}this._gridPane.headerMgr.HeaderMouseOut(e)};e.prototype.RowHitTest=function(e){for(var t,n,r,s,o=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane._parentNode),u=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),a=u.x,f=u.y,l=t=0,c=n=0,h=this._gridPane.tableMgr.GetRowHeaders(),p=0;p<h.length;p++){var d=h[p].GetTd(),v=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(d);if(d.offsetHeight+v.y>f){t=p;n=v.y-o.y;break}}var m=this._gridPane.tableMgr.GetColumnHeaders();for(p=0;p<m.length;p++){r=m[p].GetTd();if((s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(r)).x+r.offsetWidth>a){l=p;c=s.x-o.x;break}}return{row:t,col:l,x:c,y:n}};e.prototype.HeaderHitTest=function(e,t){var n,r,s,o,u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._gridPane.tableDiv),a=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),f=a.x,l=a.y,c=this._gridPane.tableMgr.GetColumnHeaders(),h=c.length>0&&l>=u.y+c[0].GetTd().offsetTop&&l<=u.y+c[0].GetTd().offsetHeight,p=h&&l-u.y<this._gridPane.headerMgr.constEyeBrowHeight?0:(this._gridPane.headerMgr.constResizeWidth+2)*(this._gridPane._objBag.RTL.bEnabled?-1:1);if(!t||h&&i.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(f,l,this._gridPane._parentNode,null)){for(var d=0;d<c.length;d++){r=c[d].GetTd();if(f>=(s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(r)).x+(0!==d?p:0)&&f<s.x+r.offsetWidth+(d!==c.length?p:0)){n=c[d].GetColIdx();break}}var v=0;if(null!=r){var m=f-s.x;v=s.x+r.offsetWidth-f<m?this._gridPane._objBag.RTL.bEnabled?0:1:this._gridPane._objBag.RTL.bEnabled?1:0}var g=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(c[0].GetTd());o=null!=n?n+v:(this._gridPane._objBag.RTL.bEnabled?f>g.x+r.offsetWidth:f<g.x)?this._gridPane.tableMgr.BeginColIdx():this._gridPane.tableMgr.EndColIdx()}return{colIdx:n,insertColIdx:o,bInVertical:h}};return e})()});
define("nQe",["require","exports","Lqe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._objBag=e}e.prototype.SetPosConverterObj=function(e){this._posConverter=e};e.prototype.SetView=function(e){this.UpdateColumns(e,!0)};e.prototype.NotifyColumnsChanged=function(e){this.UpdateColumns(e,!1)};e.prototype.FullDataIdxToKey=function(e,t){return{recordKey:this._posConverter.RecordIdxToRecordKey(Math.floor(e/this._rowMultiple)),fieldKey:this.IdxToFieldKey(e,t),columnKey:this._columns[t].columnKey}};e.prototype.IdxToKey=function(e,t){return{recordKey:this._posConverter.ViewIdxToRecordKey(Math.floor(e/this._rowMultiple)),fieldKey:this.IdxToFieldKey(e,t),columnKey:this._columns[t].columnKey}};e.prototype.IdxToFieldKey=function(e,t){return this._columns[t].fieldKeys[e%this._rowMultiple]};e.prototype.KeyToIdx=function(e,t){var n=this._fieldKeyToRowOffset[t];if(null!=n){var r=this._posConverter.RecordKeyToViewIdx(e)*this._rowMultiple+n,i=this._fieldKeyToColIdx[t];if(null!=i)return{rowIdx:r,colIdx:i}}return null};e.prototype.GetTopRowIdxForKey=function(e){return this._posConverter.RecordKeyToViewIdx(e)*this._rowMultiple};e.prototype.GetTopRowIdx=function(){return this._posConverter.GetTopViewIdx()*this._rowMultiple};e.prototype.RowIdxToViewIdx=function(e){return Math.floor(e/this._rowMultiple)};e.prototype.RowIdxToRelRowIdx=function(e){return e-this._posConverter.GetTopViewIdx()*this._rowMultiple};e.prototype.RowIdxToRecordKey=function(e){return this._posConverter.ViewIdxToRecordKey(this.RowIdxToViewIdx(e))};e.prototype.RelRowIdxToRowIdx=function(e){return e+this._posConverter.GetTopViewIdx()*this._rowMultiple};e.prototype.ColKeyToColIdx=function(e){return this._colKeyToColIdx[e]};e.prototype.ColIdxToColKey=function(e){return this._columns[e].columnKey};e.prototype.ColKeyToFieldKeys=function(e){return this._columns[this._colKeyToColIdx[e]].fieldKeys};e.prototype.FieldKeyToColIdx=function(e){return this._fieldKeyToColIdx[e]};e.prototype.GetWholeRowDisplayCapacity=function(){return this._posConverter.GetWholeRowDisplayCapacity()*this._rowMultiple};e.prototype.GetRowMultiple=function(){return this._rowMultiple};e.prototype.GetRecordsInvolved=function(e,t,n){var r=this,i=(e-e%this._rowMultiple)/this._rowMultiple,s=Math.ceil((t+e%this._rowMultiple)/this._rowMultiple),o=this._posConverter.GetViewRecords(i,s,function(){var i=r.GetRecordsInvolved(e,t,n);null!=i&&n(i)});return o.recordSetComplete?(function(e){for(var t={},n=0;n<e.length;n++)t[e[n].key()]=e[n];return t})(o.records):null};e.prototype.IsRecordOnScreen=function(e){return this._posConverter.IsRecordOnScreen(e)};e.prototype.GetRecordKeysInvolved=function(e,t){for(var n=(e-e%this._rowMultiple)/this._rowMultiple,r=Math.ceil((t+e%this._rowMultiple)/this._rowMultiple),i=new Array(r),s=0;s<r;s++)i[s]=this._posConverter.ViewIdxToRecordKey(n+s);return i};e.prototype.GetVirtualRowCount=function(){return(this._posConverter.GetViewRecordCount()+this._objBag.entryRecordMgr.GetEntryRecords().length)*this._rowMultiple};e.prototype.GetVirtualColumnCount=function(){return this._columns.length};e.prototype.GetColumnByIdx=function(e){return this._columns[e]};e.prototype.GetColumnByKey=function(e){var t=this._colKeyToColIdx[e];return null==t?null:this._columns[t]};e.prototype.UpdateColumns=function(e,t){this._columns=e;this._fieldKeyToColIdx={};this._fieldKeyToRowOffset={};this._colKeyToColIdx={};for(var r=0;r<e.length;r++){this._colKeyToColIdx[e[r].columnKey]=r;var i=e[r].fieldKeys;t&&(this._rowMultiple=i.length);n.JsGridUtil.DebugAssert(i.length==this._rowMultiple);for(var s=0;s<this._rowMultiple;s++){this._fieldKeyToColIdx[i[s]]=r;this._fieldKeyToRowOffset[i[s]]=s}this._objBag.columnKeys&&("JSGrid_NewColumn"!=e[r].columnKey&&"Title"!=e[r].columnKey?this._objBag.columnKeys[r]='{"spField_216":["'+e[r].columnKey+'"]}':"Title"==e[r].columnKey&&(this._objBag.columnKeys[r]='{"spField_216":["LinkTitle"]}'))}};return e})();t.GridPaneConverter=r});
define("Lqe",["require","exports","ww","o","r","Dqe","Aqe","kqe","od","ou","k","Gp"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:1725},p={ODB:420};(function(t){t._locationFilldownKillswitchIsActive=l.Killswitch.isActivated("C63C13A2-4C8D-4AF9-AAF4-2F0193EB3C98","11/21/2019","fix filldown for location fields");t._gridutilPageContextKillswitchIsActive=l.Killswitch.isActivated("E4BE6FE2-3F8A-48C3-8C74-C713788B7F7B","06/12/2020","Load pagecontet from gridutil");t._keyboardToRowHeaderKillswitchIsActive=l.Killswitch.isActivated("D4E32E0E-C895-4A23-A9F7-0D3767BDA337","06/18/2020","Enable keyboard navigation to row header cells");t._headerScreenreaderKillSwitchIsActive=l.Killswitch.isActivated("255A5419-E993-4024-8A42-90860782D58E","7/18/2020","Piping the screen reader necessary attributes to read out the correct info.");t._errorWidgetInstantOpenKillSwitchIsActive=l.Killswitch.isActivated("4A87CEC1-6C39-491F-A325-BBACAC2D6DF5","8/05/2020","Make the error widget expand immediately on cell selection and do not show the error icon next to cell.");t._fixPasteNewRowPerfKillSwitchIsActive=l.Killswitch.isActivated("D2068B8A-DDB0-4C82-B490-CD5F73CD8842","8/1/2020","When pasting new rows into the grid, perf is awful due to too many reflows.");t._columnHeaderErrorIndicatorKillSwitchIsActive=l.Killswitch.isActivated("73A0879A-B0F3-499E-B934-66D6A4ACB9A0","8/06/2020","Marking column headers with an error asterisk when at least one error in that field.");t._gridWaitFullLoadEventKillSwitchIsActive=l.Killswitch.isActivated("1F1EBE99-332B-46B1-9151-F14385FA33BB","8/19/2020","Adding an event that upon firing will continue the init sequence of the subscribed SPGrid controls in the case of multiple list webparts.");t._lastColumnVisibilityKillSwitchIsActive=l.Killswitch.isActivated("8AC39057-883F-4539-8333-2349ABD458ED","8/21/2020","When an user has no permission to add a new column to the list we should not hide the visibility of the cells.");t._lookupFieldCopyPasteKillSwitchIsActive=l.Killswitch.isActivated("1CF3A488-FA44-4BEE-AB1C-E203225ABA0B","8/29/2020","Fetch the CSOM files when copy/pasting multiple cells of a Lookup field type.");t._removeExtraPasteListenerKillSwitchIsActive=l.Killswitch.isActivated("5149B584-0BD2-47E3-8A1C-7ACCA0C44DDC","9/09/2020","Remove 2 paste event listeners in favor of the Keydown handling the paste scenario.");t._usePerInstancePageContextKillSwitchIsActive=l.Killswitch.isActivated("A54E950D-BC94-46AF-A3C7-8FE667E0F11A","10/16/2020","Pipe through the pageContext object to anyone consuming it so that it is unique per instance of the grid.");t._uniqueGridIdKillSwitchIsActive=l.Killswitch.isActivated("858B5100-8CDE-48E4-BA7C-CE4D1EBB37DC","10/07/2020","Give each grid a unique grid Id for the case of multiple grids on the same page loading at the same time.");t._spRegionalSettingsDefaultsKillSwitchIsActive=l.Killswitch.isActivated("ecf6a853-5507-4a32-bf68-aed317baf8ab","10/07/2020","Change the SpRegionalSettings default to more common - and valid - values.");t._updatedPasteReflowKillSwitchIsActive=l.Killswitch.isActivated("D13A31BF-3183-4047-A7B3-4FA6585ADF9C","10/04/2020","Fix reflow after pasting in a couple of different scenarios");t._readOnlyWidgetKillSwitchIsActive=l.Killswitch.isActivated("D893F5E7-2239-49E0-9250-8D092E77E314","10/27/2020","Change readonly styles for a readOnly widget message.");t._spClientFocusFixKillSwitchIsActive=l.Killswitch.isActivated("49A7D072-B644-4022-ACAC-6C1EE83E3914","10/10/2020","Another attempt to fix scrolling in sp-client.");t._spClientStickyColumnFixKillSwitchIsActive=l.Killswitch.isActivated("3FC81CBE-336F-4E75-A315-80AF02877982","10/28/2020","Fix sticky column shadow and title in sp-client.");t._specify24HourFormatInDateTimeKillswitchIsActive=l.Killswitch.isActivated("324218f3-70db-46f6-9720-5cb62adb905d","10/29/2020","Specifies 24hr format in datetime fields");t._fixTimeFormatsKillswitchIsActive=l.Killswitch.isActivated("d47e3ac0-c9cd-4f5f-b6ed-403d9ee8a624","11/17/2020","Converts . in times to :");t.EmptyValue={};t.InvalidValue={};t.gridIdCounter=1;t.serializedFieldSeparator=",#";t.SPUserValueOnPasteFixup=function(e){if(Boolean(t.lastCopiedValueType_SPUser)&&Boolean(t.hasPasteStarted)){for(var n=e.split(t.multiValSeparator),r=[],i=0;i<n.length;i++){var s=n[i].indexOf(t.serializedFieldSeparator);-1!==s?r.push(n[i].substring(0,s)):r.push(n[i])}return g.URI_ConvertMultiColumnValueToString(r,t.multiValSeparator,!1)}return e};function d(e){}t.ClearEventListeners=d;var v=(function(){function e(){this._map=[];this._idxMap=[]}e.prototype.GetIndexForGuid=function(e){var t,n=g.LowerBound(this._map,e,"guid");if(null!=this._map[n]&&this._map[n].guid==e)t=this._map[n].idx;else{t=this._idxMap.length;this._idxMap.push({guid:e,idx:t});this._map.splice(n,0,this._idxMap[t])}return t};e.prototype.LookupIndexForGuid=function(e){var t=g.LowerBound(this._map,e,"guid"),n=null;null!=this._map[t]&&this._map[t].guid==e&&(n=this._map[t].idx);return n};e.prototype.LookupGuidForIndex=function(e){return null!=this._idxMap[e]?this._idxMap[e].guid:null};return e})();t.GuidManager=v;var m=(function(){function e(){this._delay=[10,75,150,500];this._tasks={};this._stopCount=0}e.GetInstance=function(){this._instance||(this._instance=new e);return this._instance};e.prototype.RegisterTask=function(e,t,n){var r=this,i=null==t?s.JsGridConstants.Priority.High:t,o=n,u=setInterval(function(){o in r._tasks&&!e(o)&&r.ClearTask(o)},this._delay[i]);o=null!=o?o:u;this._tasks[o]={intervalId:u,priority:i,fn:e};return o};e.prototype.SetTaskPriority=function(e,t){var n=this._tasks[e];this.ClearTask(e);this.RegisterTask(n.fn,t,e)};e.prototype.GetTaskPriority=function(e){return this._tasks[e]&&this._tasks[e].priority};e.prototype.TaskRegistered=function(e){return e in this._tasks};e.prototype.ClearTask=function(e){var t=this._tasks[e];if(null!=t){clearInterval(t.intervalId);delete this._tasks[e]}};e.prototype.Stop=function(){for(var e in this._tasks)clearInterval(this._tasks[e].intervalId);this._stopCount++};e.prototype.Resume=function(){if(1==this._stopCount){var e={};for(var t in this._tasks)e[t]=this._tasks[t];this._tasks={};for(var t in e)this.RegisterTask(e[t].fn,e[t].priority,t)}this._stopCount=Math.min(this._stopCount-1,0)};return e})();t.AsynchronousTaskManager=m;var g,y=(function(){function e(){this._jobs={};this._maxNumToProcess=10;this._curJobKey=0;this._upShiftThreshold=5;this._downShiftThreshold=20;this._asyncMgr=m.GetInstance()}e.GetInstance=function(){this._instance||(this._instance=new e);return this._instance};e.prototype.TryAdjustThreadPriority=function(e){var t=e.cells.length-e.lastCellCount,n=this._asyncMgr.GetTaskPriority(e.token)==s.JsGridConstants.Priority.SuperHigh;if(!n&&t<this._upShiftThreshold){this._asyncMgr.SetTaskPriority(e.token,s.JsGridConstants.Priority.SuperHigh);n=!0}else if(n&&t>this._downShiftThreshold){this._asyncMgr.SetTaskPriority(e.token,s.JsGridConstants.Priority.Medium);n=!1}return n};e.prototype.ProcessTasks=function(e,t){var n,r=this._jobs[e];if(t)n=r.cells.length;else{var i=this.TryAdjustThreadPriority(r);n=Math.min(i?7*this._maxNumToProcess:this._maxNumToProcess,r.cells.length)}for(var s=0;s<n;s++)try{r.fn.apply(null,r.cells[s])}catch(e){console.log("Exception running job: "+e.toString())}r.cells.splice(0,n);r.lastCellCount=r.cells.length;return 0!==r.cells.length};e.prototype.RegisterCell=function(e,t,n){var r=this._jobs[e];null!=r.token&&this._asyncMgr.TaskRegistered(r.token)||(r.token=this._asyncMgr.RegisterTask(r.fnProcess,s.JsGridConstants.Priority.Medium));r.cells[r.cells.length]=Array.prototype.slice.apply(arguments,[1,arguments.length])};e.prototype.ChangeRecordKeys=function(e,t){for(var n in this._jobs)for(var r=this._jobs[n].cells,i=0;i<r.length;i++)r[i][0]==e&&(r[i][0]=t)};e.prototype.RegisterJob=function(e){var t=this,n=this._curJobKey++;this._jobs[n]={fn:e,cells:[],fnProcess:function(){return t.ProcessTasks(n)},lastCellCount:0};return n};e.prototype.FlushJob=function(e){e in this._jobs&&this.ProcessTasks(e,!0)};return e})();t.AsynchronousCellUpdater=y;t.DebugAssert=function(e,t){0};(function(e){(function(e){e._hex2pos={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15};e._pos2hex="0123456789ABCDEF";function t(e,t,r){return n(1,e,t,r)}e.MakeColor=t;function n(e,t,n,r){return{a:e,r:t*e,g:n*e,b:r*e}}e.MakeAlphaColor=n;e.RemoveAlphaChannel=function(e){return e.a<1?t(e.r/e.a,e.g/e.a,e.b/e.a):e};e.HexStringToColor=function(r){function i(t){var n=t.charAt(0),r=1==t.length?n:t.charAt(1);return(16*e._hex2pos[n]+e._hex2pos[r])/255}var s,o;if("#"==r.charAt(0)){var u=r.toUpperCase();s=4==u.length?t(i(u.substr(1,1)),i(u.substr(2,1)),i(u.substr(3,1))):t(i(u.substr(1,2)),i(u.substr(3,2)),i(u.substr(5,2)))}else 0==r.indexOf("rgb(")||0==r.indexOf("RGB(")?s=t((o=r.substr(4,r.length-5).split(","))[0]/255,o[1]/255,o[2]/255):0!=r.indexOf("rgba(")&&0!=r.indexOf("RGBA(")||(s=n((o=r.substr(5,r.length-6).split(","))[3],o[0]/255,o[1]/255,o[2]/255));return s};e.ColorToHexString=function(t){function n(t){t=Math.floor(255*t);return e._pos2hex.charAt(Math.floor(t/16))+e._pos2hex.charAt(t%16)}return"#"+n(t.r)+n(t.g)+n(t.b)};e.AlphaBlend=function(e,t){var r=1-e.a;return n(e.a+t.a*r,e.r+r*t.r,e.g+r*t.g,e.b+r*t.b)}})(e.Color||(e.Color={}));e.object=function(e){function t(){}t.prototype=e;return new t};e.getCalloutBoundsBelowStickyHeader=function(e){var t,n,r=null===(n=null===(t=document.getElementById(e))||void 0===t?void 0:t.getElementsByTagName("th")[1])||void 0===n?void 0:n.getBoundingClientRect();return r&&{left:0,top:r.bottom,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight-r.bottom}};e.ConvertTableToMap=function(e,t,n){for(var r={},i=0;i<e.length;i++)r[e[i][t]]=null!=n?e[i][n]:e[i];return r};e.ConvertTableColumnToArray=function(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r][t]);return n};e.ConvertSetKeysToArray=function(e){var t=[];for(var n in e)t.push(n);return t};e.ConvertSetDataToArray=function(e){var t=[];for(var n in e)t.push(e[n]);return t};e.ConvertArrayToSet=function(e,t){for(var n={},r=0;r<e.length;r++)n[e[r][t]]=e[r];return n};e.EncodeString=function(e){return'"'+e+'"'};e.MoveItemInArray=function(e,t,n){var r=e.splice(t,1);e.splice(n,0,r[0])};e.GetFirstElement=function(e){for(var t in e)return e[t]};e.IsAssocArrayEmpty=function(e){for(var t in e)return!1;return!0};e.GetAssocArraySize=function(e){var t=0;for(var n in e)t++;return t};e.CloneObj=function e(t,n){var r;if(null==t)return null;if(null!=t.clone&&n)return t.clone();if(null!=t.Clone&&n)return t.Clone();if(t instanceof Array){r=[];for(var i=0;i<t.length;i++)r.push(n?e(t[i],!0):t[i]);return r}if(t instanceof Date)return r=new Date(t.getTime());if(t instanceof Function)return t;if(t instanceof Object){var s=!0;for(var o in t)s=s&&!(t[o]instanceof Function);if(s){r={};for(var o in t)o in r||(r[o]=n?e(t[o],!0):t[o])}return r}return t};e.BinarySearch=function(t,n,r){var i=e.LowerBound(t,n,r);return i===t.length||(r?t[i][r]:t[i])!==n?null:i};e.LowerBound=function(t,n,r){return e.LowerBoundCompare(t,n,function(e,n){var i=r?t[e][r]:t[e];return n>i?1:i>n?-1:0})};e.LowerBoundCompare=function(e,t,n){for(var r,i=-1,s=e.length;s-i>1;)n(r=i+s>>>1,t)>0?i=r:s=r;return s};e.UpperBound=function(e,t,n){for(var r,i=-1,s=e.length;s-i>1;){r=i+s>>>1;t>=(n?e[r][n]:e[r])?i=r:s=r}return s};e.Compose=function(e,t){return function(n){var r=t?t(n):n;return e?e(r):r}};e.FindInArray=function(e,t,n){for(var r,i=0;i<e.length;i++)if(t(e[i])){r=i;if(!n)break}return r};e.Find=function(e,t,r){var i=n(e,t,r);return null==i?null:e[i]};function n(e,t,n){var r=void 0;for(var i in e)if(t(e[i])){r=i;if(!n)break}return r}e.FindKey=n;e.RoundTo=function(e,t){var n=Math.pow(10,t);return 0==e?e:Math.round(e*n)/n};e.shutUpKeys=null;e.CoalesceFunctionCalls=function(e,t,n){null==this._shutUpKeys&&(this._shutUpKeys=new o.Set);var r=this._shutUpKeys;if(!r.Contains(e)){r.Add(e);setTimeout(function(){r.Remove(e);t()},null==n?0:n)}};e.Flatten2LevelArray=function(e){var t=[];for(var n in e)for(var r in e[n])t.push(e[n][r]);return t};e.TokenizeString=function(e,n){var r=[];if(null!=e&&e!==t.EmptyValue)for(var i=e.split(n),s=0;s<i.length;s++){var o=i[s].replace(/^\s+|\s+$/g,"");""!==o&&r.push(o)}return r};e.JoinStrings=function(e,t){if(null==e)return null;for(var n=[],r=0;r<e.length;r++)""!==e[r]&&null!=e[r]&&n.push(e[r]);return n.join(t)};e.ProfilerMark=function(e){window.msWriteProfilerMark&&window.msWriteProfilerMark(e)};(function(e){e.OnRowHeaderStateChanged=function(e,t){return{recordKey:e,rowHeaderState:t}};e.ChangeKeyStageUpdated=function(e){return{changeKey:e}};e.RecordInserted=function(e){return{recordKey:e}};e.RecordDeleted=function(e){return{recordKey:e}}})(e.EventArgs||(e.EventArgs={}));e.EmptyFunction=function(){};e.CrackCellKey=function(e){var t=e.split(",");return{rowIdx:t[0],colIdx:t[1]}};e.MakeCellKey=function(e,t){return[e,t].join()};e.IsNoOpChange=function(e,t){var n=e.fieldKey;return!(t.HasLocalizedValue(n)&&e.oldProp.localized!=e.newProp.localized||t.HasDataValue(n)&&e.oldProp.data!=e.newProp.data)};var r=(function(){function n(){var e=this;this._zoomFactor=1;this.OnMouseMove=function(t){null!=e._fnUserOnMouseMove&&e._fnUserOnMouseMove(t)};this.OnMouseUp=function(t){null!=e._fnUserOnMouseUp&&e._fnUserOnMouseUp(t);e.ReleaseCapture()};this.StopEvent=function(e){e.stopPropagation();e.preventDefault()};this.CacheIEZoomFactor=function(){if(e.BrowserIsIE){var t,n;if(null==(t=document.getElementById("__iezoomtest1"))||null==(n=document.getElementById("__iezoomtest2"))){t=document.createElement("div");n=document.createElement("div");t.style.cssText="position:absolute;top:0px;left:0px";n.style.cssText="position:absolute;top:0px;left:200px";t.appendChild(n);t.id="__iezoomtest1";n.id="__iezoomtest2";document.body.appendChild(t)}var r=t.getBoundingClientRect(),i=n.getBoundingClientRect(),s={x:r.left,y:r.top},o={x:i.left,y:i.top};e._zoomFactor=(o.x-s.x)/200;0==e._zoomFactor&&(e._zoomFactor=1)}};this.BrowserIsIE=!1;this.BrowserIsIEAndRenderingModeIs7=!1;this.BrowserCanRenderVml=!1;this.functionsRequiringInit=[{name:"SetText",selector:function(){return null!=document.body.innerText?function(e,t){e.innerText=t}:function(e,t){e.textContent=t}}},{name:"GetScreenOffsets",selector:function(){return"pageYOffset"in window?function(){return{top:window.pageYOffset,left:window.pageXOffset}}:function(){return{top:document.documentElement.scrollTop,left:document.documentElement.scrollLeft}}}},{name:"GetXmlHttpObj",selector:function(){return window.XMLHttpRequest?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")}}},{name:"GetComputedStyle",selector:function(){return null!=document.defaultView&&null!=document.defaultView.getComputedStyle?function(e,t,n){var r=document.defaultView.getComputedStyle(e,null);return r?r.getPropertyValue(n):""}:function(e,t,n){return"width"==t?String(e.offsetWidth)+"px":e.currentStyle[t]}}},{name:"AdjustCoordsForIEZoom",selector:function(){if(e.BrowserIsIE){e.CacheIEZoomFactor();window.addEventListener("resize",e.CacheIEZoomFactor)}return function(t){return{x:Math.round(t.x/e._zoomFactor),y:Math.round(t.y/e._zoomFactor)}}}},{name:"GetOuterHTML",selector:function(){return null!=document.body.outerHTML?function(e){return e.outerHTML}:function(e){var t=e.ownerDocument,n=e.cloneNode(!0),r=t.createElement("div");t.documentElement.appendChild(r);r.appendChild(n);var i=r.innerHTML;t.documentElement.removeChild(r);return i}}}];for(var t=function(t){var n=e;n[t.name]=function(){n[t.name]=t.selector();return n[t.name].apply(n,arguments)}},n=0;n<this.functionsRequiringInit.length;n++)t(this.functionsRequiringInit[n])}n.GetInstance=function(){n._instance||(n._instance=new n);return n._instance};n.prototype.SetCapture=function(t,n,r){this._bUsingIE=!1;this._captureElem=t;this._fnUserOnMouseMove=n;this._fnUserOnMouseUp=r;this._origBodyCursor=document.body.style.cursor;document.body.style.cursor=e.DomElement.GetInstance().GetComputedStyle(this._captureElem,"cursor","cursor");document.addEventListener("mousemove",this.OnMouseMove,!0);document.addEventListener("mouseup",this.OnMouseUp,!0);document.addEventListener("mouseover",this.StopEvent,!0);document.addEventListener("mouseenter",this.StopEvent,!0);document.addEventListener("mouseleave",this.StopEvent,!0)};n.prototype.ReleaseCapture=function(){if(null!=this._captureElem){if(this._bUsingIE){this._captureElem.releaseCapture();document.removeEventListener("mousemove",this.OnMouseMove);document.removeEventListener("mouseup",this.OnMouseUp)}else{document.body.style.cursor=this._origBodyCursor;document.removeEventListener("mousemove",this.OnMouseMove,!0);document.removeEventListener("mouseup",this.OnMouseUp,!0);document.removeEventListener("mouseover",this.StopEvent,!0);document.removeEventListener("mouseenter",this.StopEvent,!0);document.removeEventListener("mouseleave",this.StopEvent,!0)}this._captureElem=null;this._fnUserOnMouseMove=null;this._fnUserOnMouseUp=null;this._origBodyCursor=null}};n.prototype.OnMouseWheel=function(e,t){var n=e.rawEvent;e.wheelDelta=Math.round(null!=n.wheelDelta?n.wheelDelta/-40:n.detail);t(e)};n.prototype.AttributeOnElementOrAncestor=function(e,t,n){for(;null!=e&&null!=e.getAttribute;){if(e.getAttribute(t)==n)return!0;e=e.parentNode}return!1};n.prototype.PointInDomElem=function(e,n,r,i){var s=null==i?t.Internal.DomElement.GetInstance().GetLocation(r):i;return s.x<=e&&s.x+r.offsetWidth>=e&&s.y<=n&&s.y+r.offsetHeight>=n};n.prototype.ElementAttachedToDom=function(e){if(null!=document.body.contains)return document.body.contains(e);t.DebugAssert(null!=document.body.compareDocumentPosition);return document.body.compareDocumentPosition(e)>=16};n.prototype.ForceIEZoomFactorRecomputation=function(){this.CacheIEZoomFactor()};n.prototype.GetLocation=function(t){var n=t.getBoundingClientRect();return e.DomElement.GetInstance().AdjustCoordsForIEZoom({x:n.left,y:n.top})};n.prototype.GetEventLocation=function(t){var n=e.DomElement.GetInstance().GetScreenOffsets();return e.DomElement.GetInstance().AdjustCoordsForIEZoom({x:t.clientX+n.left,y:t.clientY+n.top})};n.prototype.GetNextElement=function(e){do{var t=e.nextSibling}while(t&&1!==t.nodeType);return t};n.prototype.GetPrevElement=function(e){do{var t=e.previousSibling}while(t&&1!==t.nodeType);return t};n.prototype.GetFirstChildElement=function(e){for(var t=e.firstChild;t&&1!==t.nodeType;)t=e.nextSibling;return t};n.prototype.AddMouseWheelHandler=function(e,t){var n=this,r=function(e){n.OnMouseWheel(e,t)};null==e._mouseWheelFnInfo&&(e._mouseWheelFnInfo=[]);e._mouseWheelFnInfo.push({usrFn:t,wheelFn:r});e.addEventListener("mousewheel",r);e.addEventListener("DOMMouseScroll",r)};n.prototype.RemoveMouseWheelHandler=function(e,n){var r=t.Internal.FindInArray(e._mouseWheelFnInfo,function(e){return e.usrFn==n});if(null!=r){e.removeEventListener("mousewheel",e._mouseWheelFnInfo[r].wheelFn);e.removeEventListener("DOMMouseScroll",e._mouseWheelFnInfo[r].wheelFn);1==e._mouseWheelFnInfo.length?e._mouseWheelFnInfo=null:e._mouseWheelFnInfo.splice(r,1)}};n.prototype.GetCustomAttribute=function(e,t){var n=null!=e.getAttribute?e.getAttribute(t):null;return null==n||""==n?e[t]:n};n.prototype.GetParentElement=function(e){var t=e.parentNode;return t&&1!==t.nodeType?null:t};n.prototype.GetAncestorByTag=function(e,t){if(null===e)return null;for(var n=e.parentNode;null!==n&&n.tagName!==t;)n=n.parentNode;return n};n.prototype.SetOpacity=function(e,t){e.style.opacity=t;e.style["-moz-opacity"]=t;e.style.filter="alpha(opacity="+100*t+")"};n.prototype.RemoveOpacity=function(e){e.style.opacity="";e.style["-moz-opacity"]=1;e.style.filter=""};n.prototype.ForEachElementChild=function(e,t,n){n||t(e);for(var r=0;r<e.childNodes.length;r++)this.ForEachElementChild(e.childNodes[r],t,!1)};n.prototype.FindAncestorWithProperty=function(e,t,n){return null==e?null:void 0!==this.GetCustomAttribute(e,t)?{elem:e,child:n}:this.FindAncestorWithProperty(e.parentNode,t,e)};n.prototype.FindFirstAncestorWithAnyPropertyValue=function(e,t,n,r){return null==e?null:this.GetCustomAttribute(e,t)in n?{elem:e,child:r}:this.FindFirstAncestorWithAnyPropertyValue(e.parentNode,t,n,e)};n.prototype.GetChildrenWithCustomAttribute=function(e,t){var n=this,r={};this.ForEachElementChild(e,function(e){var i=n.GetCustomAttribute(e,t);null!=i&&(r[i]=e)},null);return r};n.prototype.FindChildrenWithProperty=function(e,t){var n=[];(function e(r,i){for(var s=0;s<r.childNodes.length;s++){var o=r.childNodes[s];null!=this.GetCustomAttribute(o,t)&&n.push(o);e(o,t)}})(e);return n};n.prototype.ComputeMaximumSizeForWebPart=function(e,n){var r={},i=document.getElementById("MSO_ContentTable");t.DebugAssert(null!=i,"The function 'ComputeMaximumSizeForWebPart' may only be called on a sharepoint web part page");var s=this.GetLocation(e),o=this.GetLocation(i);n||(e.style.display="none");var u=s.y-o.y;r.height=i.offsetHeight-u;u=s.x-o.x;r.width=i.offsetWidth-u;n||(e.style.display="block");return r};n.prototype.SetMouseHover=function(e,t,n,r){e.addEventListener("mousemove",u);e.addEventListener("mouseout",o);var i=!0,s=!1;function o(){s=!0;setTimeout(a,0)}function u(e){i&&null!=t&&t();null!=r&&r(e);i=s=!1}function a(){if(!i&&s){null!=n&&n();i=!0;s=!1}}return function(){e.addEventListener("mouseout",o);e.addEventListener("mousemove",u);o=null;u=null;a=null;e=null}};n.prototype.DashNameFromCamelName=function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})};n.prototype.CamelNameFromDashName=function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})};n.prototype.GetXmlDomObj=function(e){var t;if(document.implementation&&document.implementation.createDocument)t=document.implementation.createDocument("","",null);else try{var n=document.createElement("xml");document.body.appendChild(n);t=n.XMLDocument;document.body.removeChild(n)}catch(e){(t=new ActiveXObject("Microsoft.XMLDOM")).setProperty("ProhibitDTD",!0)}if(null!=e)if("loadXML"in t){t.async=!1;t.loadXML(e)}else t=(new DOMParser).parseFromString(e,"text/xml");return t};n.prototype.SetTextNoBR=function(e,t){e.innerHTML="";e.appendChild(document.createTextNode(t))};return n})();e.DomElement=r;var i=(function(){function e(){this.Reset()}e.prototype.ElapsedMs=function(){return(new Date).getTime()-this.start};e.prototype.Reset=function(){this.start=(new Date).getTime()};e.prototype.toString=function(e){var t=this.ElapsedMs(),n=new Date(t),r=Math.floor(t/36e5),i=n.getUTCMinutes(),s=n.getUTCSeconds()+n.getUTCMilliseconds()/1e3;if("M"==e){i+=60*r;r=0}else if("S"==e){s+=60*(60*r+i);r=i=0}var o=[];r&&o.push(r);r+i&&o.push((i<10?"0":"")+i);o.push((s<10?"0":"")+s.toFixed(3));return o.join(":")};return e})();e.Timer=i;e.CallAsyncFn=function(e,t,n,r){e(function(){null!=t&&t();null!=r&&r()})?t():null!=n&&n()};function u(e,t){for(var n=e[t],r=e.offsetParent;null!=r&&"BODY"!==r.tagName;){n+=r[t];r=r.offsetParent}null!=r&&(n+=r[t]);return n}e.DOM_Abs=u;e.DOM_AbsLeft=function(e){return u(e,"offsetLeft")};e.DOM_AbsTop=function(e){return u(e,"offsetTop")};function a(e,t,n){if(void 0!==document.defaultView&&void 0!==document.defaultView.getComputedStyle){var r=document.defaultView.getComputedStyle(e,null);return n?r.getPropertyValue(n):r}return"width"==t?String(e.offsetWidth)+"px":e.currentStyle[t]}e.GetCurrentStyle=a;e.GetVisible=function(e){var t=a(e,"");return"hidden"!==t.visibility&&"none"!==t.display};e.GenerateIID=function(e){return f(e,e.CurrentItem)};function f(e,t){return e.ctxId+","+t.ID+","+t.FSObjType}e.GenerateIIDForListItem=f;e.IsElementRtl=function(e){for(;null!=e&&null!=e.tagName;){var t=e.getAttribute("dir");null!=t&&""!=t||null==e.style||(t=e.style.direction);if("rtl"==t)return!0;if("ltr"==t)return!1;e=e.parentNode}return!1};e.AddCssClass=function(e,t){e.className+=" "+t};e.RemoveCssClass=function(e,t){e.classList.remove(t)};e.URI_ConvertMultiColumnValueToString=function(e,t,n){null==t&&(t=";#");null==n&&(n=!0);for(var r=t.charAt(0),i=r+r,s=new RegExp(t.charAt(0),"g"),o=!1,u="",a=0;a<e.length;a++){var f=e[a];null!=f&&f.length>0&&(f=f.replace(s,i));null!=f&&f.length>0&&(o=!0);(n||0!==a)&&(u+=t);u+=f}if(o){n&&(u+=t);return u}return""};e.GetEventSrcElement=function(e){return null!=e.target?e.target:null};e.GenerateXMLArray=function(e,t){var n=[];if(null!=e){var r="<"+t+">",i="</"+t+">";for(var s in e){n.push(r);n.push(e[s]);n.push(i)}}return n.join("")};e.EscapeProperly=function(t,n,r,i){var s="",o=0;if(void 0===t)return"";for(o=0;o<t.length;o++){var u=t.charCodeAt(o),a=t.charAt(o);if(n&&("#"==a||"?"==a)){s+=t.substr(o);break}if(r&&"&"==a)s+=a;else if(u<=127)i?s+=a:u>=97&&u<=122||u>=65&&u<=90||u>=48&&u<=57||n&&u>=32&&u<=95&&" \"%<>'&".indexOf(a)<0?s+=a:u<=15?s+="%0"+u.toString(16).toUpperCase():u<=127&&(s+="%"+u.toString(16).toUpperCase());else if(u<=2047){s+="%"+(e.Utf8Variables.UTF8_1ST_OF_2|u>>6).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|63&u).toString(16).toUpperCase()}else if((u&e.Utf8Variables.SURROGATE_6_BIT)!=e.Utf8Variables.HIGH_SURROGATE_BITS){s+="%"+(e.Utf8Variables.UTF8_1ST_OF_3|u>>12).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|(4032&u)>>6).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|63&u).toString(16).toUpperCase()}else if(o<t.length-1){u=(1023&u)<<10;o++;u|=1023&t.charCodeAt(o);u+=e.Utf8Variables.SURROGATE_OFFSET;s+="%"+(e.Utf8Variables.UTF8_1ST_OF_4|u>>18).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|(258048&u)>>12).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|(4032&u)>>6).toString(16).toUpperCase();s+="%"+(e.Utf8Variables.UTF8_TRAIL|63&u).toString(16).toUpperCase()}}return s};e.Utf8Variables={UTF8_1ST_OF_2:192,UTF8_1ST_OF_3:224,UTF8_1ST_OF_4:240,UTF8_TRAIL:128,HIGH_SURROGATE_BITS:55296,LOW_SURROGATE_BITS:56320,SURROGATE_6_BIT:64512,SURROGATE_ID_BITS:63488,SURROGATE_OFFSET:65536};e.IsXhrAborted=function(e){try{if(4==e.readyState&&(void 0===e.status||0==e.status))return!0}catch(e){return!0}return!1};e.IsStrNullOrEmpty=function(e){return null==e||""==e};e.IsNullOrUndefined=function(e){return null==e||null==e};var d=(function(){function e(e){this.nonFilterParams={};this.filterParams={};null==e&&(e="");0==e.indexOf("?")&&(e=e.substring(1));this.nonFilterParams={};this.filterParams={};var t,n=e.split("&");for(t=0;t<n.length;t++){var r=n[t].split("=");if(2==r.length)if(-1!=r[0].search("^Filter")){var i,s=r[0].match(new RegExp("[0-9]*$"));if(void 0!==this.filterParams[s])i=this.filterParams[s];else{i=new Object;this.filterParams[s]=i}i[r[0].match(new RegExp("^Filter[^0-9]*"))]=r[1]}else this.nonFilterParams[r[0]]=r[1]}}e.prototype.toArray=function(){var e,t,n=[],r=1;for(e in this.filterParams){var i=this.filterParams[e];for(e in i){(t=[]).push(e);t.push(r);t.push("=");t.push(i[e]);n.push(t.join(""))}r++}for(e in this.nonFilterParams){(t=[]).push(e);t.push("=");t.push(this.nonFilterParams[e]);n.push(t.join(""))}return n};return e})();e.List_QstringStruct=d;e.List_ReconcileQstringFilters=function(e,t){var n=[];n.push(new d(e));n.push(new d(t));var r,i,s,o,u=[];for(r=0;r<n.length;r++)for(s in n[r].nonFilterParams)if(0==r||void 0===n[0].nonFilterParams[s]&&1==r){(o=[]).push(s);o.push("=");o.push(n[r].nonFilterParams[s]);u.push(o.join(""))}var a=1,f=new Object;for(r=0;r<n.length;r++)for(i in n[r].filterParams){var l=n[r].filterParams[i],c="string"==typeof l.FilterField?l.FilterField:null;null==c&&(c="string"==typeof l.FilterFields?l.FilterFields:null);if(null!=c&&void 0===f[c]){for(s in l){(o=[]).push(s);o.push(a);o.push("=");o.push(l[s]);u.push(o.join(""))}a++;f[l.FilterField]=l}}return u.join("&")};e.UnescapeProperly=function(e){var t=null;if("undefined"!=typeof decodeURIComponent){t=decodeURIComponent(e);var n=v(e);t!=n&&alert("unescapeProperly error\noriginal string = "+e+"\ndecodeURIComponent string = "+t+"\nunescapeProperlyInternal string = "+n)}else t=v(e);return t};function v(e){if(null==e)return"null";for(var t,n,r=0,i=0,s="",o=new Array,u=0;r<e.length;)if("%"==e.charAt(r))if("u"==e.charAt(++r)){t="";for(i=0;i<4&&r<e.length;++i)t+=e.charAt(++r);for(;t.length<4;)t+="0";n=parseInt(t,16);isNaN(n)?s+="?":s+=String.fromCharCode(n)}else{t="";for(i=0;i<2&&r<e.length;++i)t+=e.charAt(r++);for(;t.length<2;)t+="0";n=parseInt(t,16);if(isNaN(n)){if(u){s+=S(o);u=0;o.length=u}s+="?"}else o[u++]=n}else{if(u){s+=S(o);u=0;o.length=u}s+=e.charAt(r++)}if(u){s+=S(o);u=0;o.length=u}return s}var m,g="?",y=55296,b=65536,w=56320,E=[0,128,2048,65536,2097152,67108864,2147483648];function S(e){for(var t,n,r,i,s=0,o="";s<e.length;)if(e[s]<=127)o+=String.fromCharCode(e[s++]);else{n=e[s++];i=r=Boolean(32&n)?Boolean(x(n))?3:2:1;t=n&255>>>2+r;for(;Boolean(r)&&s<e.length;){--r;if(0==(n=e[s++]))return o;if(128!=(192&n)){o+=g;break}t=t<<6|63&n}if(Boolean(r)){o+=g;break}if(t<E[i]){o+=g;break}if(t<=65535)o+=String.fromCharCode(t);else if(t<=1114111){t-=b;o+=String.fromCharCode(y|t>>>10);o+=String.fromCharCode(w|T(t))}else o+=g}return o}function x(e){return 16&e}function T(e){return 1023&e}e.GetInnerText=function(e){return void 0!==e.textContent&&null!=e.textContent?e.textContent:void 0!==e.innerText?e.innerText:void 0};e.EnsureFileLeafRefName=function(e){if(void 0===e["FileLeafRef.Name"]){var t=e.FileLeafRef,n=t.lastIndexOf(".");n>=0&&l.Killswitch.isActivated("48F7CF05-25D8-41E7-9508-D739EC3005C3","10/30/2019","Do not truncate the file name in Quick Edit editors")?e["FileLeafRef.Name"]=t.substring(0,n):e["FileLeafRef.Name"]=t}};e.Encoding_STSHtmlDecode=function(e){if(null==e)return"";var t=[/\&lt;/g,/\&gt;/g,/\&quot;/g,/\&#39;/g,/\&#58;/g,/\&#123;/g,/\&#125;/g,/\&amp;/g],n=["<",">",'"',"'",":","{","}","&"],r=[],i=0,s=t.length;for(i=0;i<s;i++){var o=e.indexOf("&");if(-1==o)break;if(0<o){r.push(e.substr(0,o));e=e.substr(o)}e=e.replace(t[i],n[i])}r.push(e);return r.join("")};e.Encoding_STSHtmlEncode=function(e){if(null==e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charAt(r);switch(s){case"<":n.push("&lt;");break;case">":n.push("&gt;");break;case"&":n.push("&amp;");break;case'"':n.push("&quot;");break;case"'":n.push("&#39;");break;default:n.push(s)}}return n.join("")};e.GetCSSClassForFieldTd=function(e){return"TRUE"==e.CalloutMenu||"Menu"==e.ClassInfo||"TRUE"==e.listItemMenu?"ms-cellstyle ms-vb-title":"Menu"==e.ClassInfo||"TRUE"==e.listItemMenu?"ms-cellstyle ms-vb-title ms-positionRelative":"Icon"==e.ClassInfo?"ms-cellstyle ms-vb-icon":"User"==e.Type||"UserMulti"==e.Type?"ms-cellstyle ms-vb-user":"ms-cellstyle ms-vb2"};e.SiteUrl="";e.GetImageUrl=function(e){return t.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+e};e.GetLocalizedImageUrl=function(e){return t.Internal.SiteUrl+"/_layouts/15/1033/images/"+e};e.GetScrollParent=function e(t){return"true"===t.getAttribute("data-is-scrollable")?t:t.parentElement?e(t.parentElement):null};e.GetGridParentElement=function(){var e=document.getElementsByClassName("quickEditParentDiv");return e&&e.length>0?e[0]:null};e.GetFocusElement=function(e){return t._uniqueGridIdKillSwitchIsActive?document.getElementById("spgridcontainer_"+t.privateWpq+"_focusElement"):document.getElementById("spgridcontainer_"+e+"_focusElement")};function N(e){return window.g_SPGridInitInfo[Object.keys(window.g_SPGridInitInfo)[0]].jsInitObj.flightStatus[e.ODB]}e.IsFeatureEnabled=N;e.IsIEBrowser=function(){void 0===m&&(m=new c.PlatformDetection);return m.isIE};e.IsStickyColumnEnabled=function(){return t.Internal.IsStickyColumnFlightEnabled()&&!t.Internal.noSizeForSticky};e.IsStickyColumnFlightEnabled=function(){if(N(p)){void 0===m&&(m=new c.PlatformDetection);return N(h)&&N(p)&&!m.isIE&&!m.isEdge&&!m.isSafari}return!1};e.GetStickyDataColumnsWidth=function(e){for(var n=0,r=0;r<e.length&&r<=t.Internal.stickyLastColIdx;r++)e[r].width&&(n+=e[r].width);return n};e.stickyLeftEdgeOffset=0;e.stickyCheckColumnSize=60;e.stickyChromeless=!0;e.stickyLastColIdx=0;e.noSizeForSticky=!1;e.normalizeColumnKey=function(e,t){var n="Title"===e?"LinkTitle":e;t&&(n="FileLeafRef"===e?"LinkFilename":n);return n};e.getColumnFromListSchema=function(e,t){var n,r=e.GetSpCsrRenderCtx();if(r)for(var i=0,s=r.ListSchema.Field;i<s.length;i++){var o=s[i];if(o.RealFieldName===t){n=o;break}}return n};e.positionWidget=function(e,n,r){if(r){var i=t.Internal.GetGridParentElement(),s=i.getElementsByTagName("TABLE")[0].clientWidth-e.offsetWidth,o=t.Internal.GetScrollParent(i).scrollWidth-e.offsetWidth;e.style.left=Math.min(s,o,n.x)+"px"}else e.style.left=Math.max(0,n.x+n.width-e.offsetWidth)+"px"};var C=void 0;e.isSpClient=function(e){if(t._spClientFocusFixKillSwitchIsActive)return!1;if(void 0===C)for(var n=e;null!=n;){if(-1!=n.className.indexOf("SPCanvas")){C=!0;break}n=n.parentElement}return C}})(g=t.Internal||(t.Internal={}));(function(e){e.CellFocusChanged=function(e,t,n,r){return{newRecordKey:e,newFieldKey:t,oldRecordKey:n,oldFieldKey:r}};e.RowFocusChanged=function(e,t){return{newRecordKey:e,oldRecordKey:t}};e.CellEditBegin=function(e,t){return{recordKey:e,fieldKey:t}};e.CellEditCompleted=function(e,t,n,r){return{recordKey:e,fieldKey:t,changeKey:n,bCancelled:r}};e.Click=function(e,t,n,r){return{eventInfo:e,context:t,recordKey:n,fieldKey:r}};e.PropertyChanged=function(e,t,n,r,i,s,o){return{recordKey:e,fieldKey:t,oldProp:n,newProp:r,propType:i,changeKey:s,validationState:o}};e.RecordInserted=function(e,t,n,r){return{recordKey:e,recordIdx:t,afterRecordKey:n,changeKey:r}};e.RecordDeleted=function(e,t,n){return{recordKey:e,recordIdx:t,changeKey:n}};e.RecordChecked=function(e,t){return{recordKeySet:e,bChecked:t}};e.OnCellErrorStateChanged=function(e,t,n,r,i,s){return{recordKey:e,fieldKey:t,bAddingError:n,bCellCurrentlyHasError:r,bCellHadError:i,errorId:s}};e.OnRowErrorStateChanged=function(e,t,n,r,i,s){return{recordKey:e,bAddingError:t,bErrorCurrentlyInRow:n,bRowHadError:r,errorId:i,message:s}};e.OnEntryRecordAdded=function(e){return{recordKey:e}};e.OnEntryRecordCommitted=function(e,t,n){return{originalRecordKey:e,recordKey:t,changeKey:n}};e.SingleCellClick=function(e,t,n){return{eventInfo:e,recordKey:t,fieldKey:n}};e.PendingChangeKeyInitiallyComplete=function(e){return{changeKey:e}};e.VacateChange=function(e){return{changeKey:e}};e.GridErrorStateChanged=function(e){return{bAnyErrors:e}};e.SingleCellKeyDown=function(e,t,n){return{eventInfo:e,recordKey:t,fieldKey:n}};e.OnRecordsReordered=function(e,t){return{reorderedKeys:e,changeKey:t}};e.OnRowEscape=function(e){return{recordKey:e}};e.OnEndRenameColumn=function(e,t,n){return{columnKey:e,originalColumnTitle:t,newColumnTitle:n}};e.OnBeginRedoDataUpdateChange=function(e){return{changeKey:e}};e.OnBeginUndoDataUpdateChange=function(e){return{changeKey:e}}})(t.EventArgs||(t.EventArgs={}));var b=(function(){function e(e,t,n,r,i){this.imgSrc=e;this.bIsClustered=t;this.outerCssNames=n;this.imgCssNames=r;this.bIsAnimated=i;this._imageWithFabricIcons=new w({imgSrc:e,bIsClustered:t,optOuterCssNames:n,optImgCssNames:r,bIsAnimated:i})}e.prototype.Render=function(e,t,n){return this._imageWithFabricIcons.Render(e,t,n)};return e})();t.Image=b;var w=(function(){function e(e){this.imgSrc=e.imgSrc;this.bIsClustered=e.bIsClustered;this.outerCssNames=e.optOuterCssNames;this.imgCssNames=e.optImgCssNames;this.bIsAnimated=e.bIsAnimated;this.iconProps=e.iconProps;this.spinnerProps=e.spinnerProps}e.prototype.Render=function(e,o,u){if(!this.imgSrc&&!this.iconProps&&!this.spinnerProps)return null;var l;if(this.iconProps||this.spinnerProps){var c=document.createElement("span");this.iconProps?r.render(i.createElement(a.Icon,n.__assign({ariaLabel:e},this.iconProps)),c):r.render(i.createElement(f.Spinner,n.__assign({ariaLabel:e},this.spinnerProps)),c);l=c}else{var h=document.createElement("img");h.src=this.imgSrc;if(null!=e){h.alt=e;u||(h.title=e)}else h.alt="";l=h}l.style.border="0";null!=this.imgCssNames&&(l.className=this.imgCssNames);if(this.bIsClustered){var p=document.createElement("div");p.className=this.outerCssNames;p.appendChild(l);l=p}if(this.bIsAnimated){t.DebugAssert(null==o,"Cannot specify a clickFn to an animated image.");o=function(e){l.style.visibility="hidden"}}if(null!=o){l.addEventListener("mousedown",o);l.addEventListener("keydown",function(e){e.keyCode==s.JsGridConstants.Key.enter&&o(e)});l.style.cursor="pointer";l.tabIndex=-1}null!=o&&(l.Dispose=function(){o=null;p=null;l.Dispose=null;l=null});return l};return e})();t.ImageWithFabricIcons=w;t.ApplyServerChangesToGrid=function(e,n,r,i,o,a){var f;if(null!=n)for(var l=0;l<n.length;l++){for(var c=n[l],h=[],p=[],d=[],v=0;v<c.updates.length;v++){var m=c.updates[v];m.type==s.JsGridConstants.ChangeType.Prop?h.push(g(m.recordKey,m.fieldKey,m.newProp)):m.type==s.JsGridConstants.ChangeType.Insert?d.push(m):m.type==s.JsGridConstants.ChangeType.Delete&&p.push(m.recordKey)}w(d);E(h);S(p);f=null}function g(e,t,n){return n.hasLocalizedValue&&n.hasDataValue?u.CreateValidatedPropertyUpdate(e,t,n.dataValue,n.localizedValue):u.CreateUnvalidatedPropertyUpdate(e,t,n.hasDataValue?n.dataValue:n.localizedValue,!n.hasDataValue)}function y(){var n=f;null!=n||o||(-1==c.changeNumber?t.DebugAssert(!1,"Invalid change list from server - if these changes are to be applied as a new update, please set the bOptNewChange parameter to true"):n=e.GetChangeKeyForVersion(c.changeNumber));return n}function b(e){f=e}function w(e){for(var n=0;n<e.length;n++){var i=r(e[n].afterRecordKey,e[n].recordKey,y());t.DebugAssert(null!=i,"The change key from inserting the record must be returned.");b(i)}}function E(t){if(h.length>0){var n=e.UpdateProperties(h,s.JsGridConstants.UserAction.UserEdit,y());null!=a&&a(h,n);b(n)}}function S(t){if(p.length>0){b(e.DeleteRecords(p,y()))}}};var E=(function(){function e(){this.events={}}e.prototype.FireEvent=function(e,t){var n=this.events[e];if(null!=n)for(var r in n)n[r](t)};e.prototype.AttachEvent=function(e,t){null==this.events[e]&&(this.events[e]=[]);this.events[e].push(t)};e.prototype.DetachEvent=function(e,n){if(null!=this.events[e]){var r=t.Internal.FindInArray(this.events[e],function(e){return e==n},null);null!=r&&this.events[e].splice(r,1)}};return e})();t.EventManager=E;var S=(function(){function e(){this._delegates={}}e.prototype.SetDelegate=function(e,t){null!=t?this._delegates[e]=t:delete this._delegates[e]};e.prototype.DelegatePresent=function(e){return e in this._delegates};e.prototype.GetDelegate=function(e){return this._delegates[e]};e.prototype.Apply=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._delegates[e[0]];if(null!=n)return n.apply(null,Array.prototype.slice.call(e,1))};return e})();t.DelegateManager=S;t.MakeShapeStyle=function(e,t){return{shape:e,color:t}};t.MakeBarStyle=function(e,t,n,r,i,s){return{shape:e,color:t,pattern:n,start:r,end:i,strokeWeight:s}};function x(){var e;return function(t){null==e&&(e=null!=t?t:1);e>0&&--e}}t.GetSingleStopBreakpoint=x;t.bpt=x();var T=(function(){function e(e,t,n){this._elementToCover=e;this._childElems=t;this._optId=n;this.Init()}e.prototype.Show=function(){this._elementToCover.addEventListener("resize",this.OnResize);this._elementToCover.appendChild(this.transparentDiv);this._elementToCover.appendChild(this.opaqueContainerDiv);this.RefreshLayout()};e.prototype.Hide=function(){this._elementToCover.removeEventListener("resize",this.OnResize);this._elementToCover.removeChild(this.transparentDiv);this._elementToCover.removeChild(this.opaqueContainerDiv)};e.prototype.Dispose=function(){this.transparentDiv=this.opaqueDiv=this.opaqueContainerDiv=null};e.prototype.RefreshLayout=function(){this.opaqueContainerDiv.style.height=this.transparentDiv.style.height=Math.max(0,this._elementToCover.offsetHeight-2)+"px";this.opaqueContainerDiv.style.width=this.transparentDiv.style.width=Math.max(0,this._elementToCover.offsetWidth-2)+"px";this.opaqueDiv.style.left=Math.max((this._elementToCover.offsetWidth-this.opaqueDiv.offsetWidth)/2,50)+"px";this.opaqueDiv.style.marginTop=(this._elementToCover.offsetHeight-this.opaqueDiv.offsetHeight)/2+"px"};e.prototype.OnResize=function(e){this.RefreshLayout()};e.prototype.Init=function(){t.DebugAssert("DIV"==this._elementToCover.tagName.toUpperCase()&&"RELATIVE"==this._elementToCover.style.position.toUpperCase(),"Banner can only cover relative positioned div elements!");this.transparentDiv=document.createElement("div");this.transparentDiv.style.cssText="z-index:5; position:absolute; top:0px; left:0px; background-color:#ffffff;border:1px solid #999999;";g.DomElement.GetInstance().SetOpacity(this.transparentDiv,.85);null!=this._optId&&(this.transparentDiv.id=this._optId);this.opaqueContainerDiv=document.createElement("div");this.opaqueContainerDiv.style.cssText="z-index:6; position:absolute; top:0px; left:0px; background-color:transparent;";this.opaqueDiv=document.createElement("div");this.opaqueDiv.style.cssText="position:absolute; vertical-align:middle; top:0px; left:0px; padding-left:20px; padding-right:20px; background-color:#ffffff; border:1px solid #EBEEF2; white-space:nowrap;";for(var e=0;e<this._childElems.length;e++)this.opaqueDiv.appendChild(this._childElems[e]);this.opaqueContainerDiv.appendChild(this.opaqueDiv)};return e})();t.ElementCover=T;var N=(function(){function e(e,t){this._elementToCover=e;this._optBannerId=t;this.Init()}e.prototype.Show=function(e){if(null==e){this.imgElem.alt=this.imgElem.title="";this.textElem.style.display="none"}else{g.DomElement.GetInstance().SetText(this.textElem,e);this.imgElem.alt=this.imgElem.title=e;this.textElem.style.display=""}this.elemCover.Show()};e.prototype.Hide=function(){this.elemCover.Hide()};e.prototype.UpdateText=function(e){g.DomElement.GetInstance().SetText(this.textElem,e);this.elemCover.RefreshLayout()};e.prototype.Dispose=function(){this.elemCover.Dispose();this.textElem=this.imgElem=this._elementToCover=null};e.prototype.Init=function(){this.imgElem=document.createElement("img");this.imgElem.src=t.Internal.SiteUrl+s.JsGridConstants.ImagesDirectory+"progress-circle-24.gif";this.imgElem.style.cssText="vertical-align:middle;margin:30px 10px 30px 10px";this.textElem=document.createElement("span");this.textElem.style.cssText="vertical-align:middle; margin:30px 10px 30px 10px; color:black; text-align:center; white-space:nowrap; overflow:hidden";this.elemCover=new T(this._elementToCover,[this.imgElem,this.textElem],this._optBannerId)};return e})();t.LoadingBanner=N;var C=(function(){function e(e,t){this._elementToCover=e;this._optBannerId=t;this.Init()}e.prototype.Show=function(e){g.DomElement.GetInstance().SetText(this.textElem,e);this.elemCover.Show()};e.prototype.Hide=function(){this.elemCover.Hide()};e.prototype.UpdateText=function(e){g.DomElement.GetInstance().SetText(this.textElem,e);this.elemCover.RefreshLayout()};e.prototype.Dispose=function(){this.elemCover.Dispose();this.textElem=this._elementToCover=null};e.prototype.Init=function(){var e=document.createElement("table");this.textElem=e.insertRow(-1).insertCell(-1);this.textElem.style.cssText="align:middle; vertical-align:middle; color:#AA0000;text-align:center; padding:20px;";this.elemCover=new T(this._elementToCover,[e],this._optBannerId)};return e})();t.ErrorBanner=C;(function(e){e.IsChar=function(e){return e.rawEvent?"keypress"==e.type&&(null==e.rawEvent.which||e.rawEvent.which>0&&e.rawEvent.charCode>0):"keypress"==e.type};e.FocusElementInDOMCollection=function(e,n,r){var i=[];function s(e){return null!=e.hasAttribute?e.hasAttribute("tabIndex")&&-1==e.getAttribute("tabIndex"):null!=e.tabIndex&&-1==e.tabIndex}(function e(t){for(var n=0;n<t.length;n++){var r=t[n];s(r)&&i.push(r);e(r.childNodes)}})(e);return(function(){if(0==i.length)return null;var e;if(null==n)e=i[0];else for(var s=0;s<i.length;s++)if(i[s]===n){e=r?s==i.length-1?i[0]:i[s+1]:0==s?i[i.length-1]:i[s-1];break}if(null!=e)try{e.focus()}catch(e){t.DebugAssert(!1,"Incorrectly trying to focus the element. Is it hidden?")}return e})()};e.CloneObj=function(e,t){return g.CloneObj(e,t)};e.GetDocumentDirection=function(){return document.documentElement.getAttribute("dir")};e.HTMLDecode=function(e){return g.Encoding_STSHtmlDecode(e)};e.HTMLEncode=function(e){return g.Encoding_STSHtmlEncode(e)};var n=(function(){function e(e){this._jsFilesLoaded=!1;this._totalFilesToLoad=e;this._numLoadedJsFiles=0}e.prototype._countLoadedJsFiles=function(e,t){void 0===t&&(t=[]);this._numLoadedJsFiles++;if(this._numLoadedJsFiles>=this._totalFilesToLoad){this._jsFilesLoaded=!0;t.forEach(function(e){return e()});e()}};e.prototype._ensureExternalJsFilesLoaded=function(e,n,r){void 0===e&&(e=[]);if(this._jsFilesLoaded)n();else{var i=t.injectJsScript,s=this._countLoadedJsFiles.bind(this,n,r);e.forEach(function(e){return i(e,s)})}};return e})();e.LoadExternalJsFiles=n})(t.Utility||(t.Utility={}));var k=(function(){function e(){this._changeKeys=new Array}e.prototype.GetList=function(){return this._changeKeys};e.prototype.AddMapping=function(e,t){var n={id:e,fn:t};this._changeKeys.splice(g.LowerBound(this._changeKeys,e,"id"),0,n)};e.prototype.RemoveMapping=function(e){var t=g.BinarySearch(this._changeKeys,e,"id");null!=t&&this._changeKeys.splice(t,1);return null!=t};e.prototype.CallFunctions=function(e,t,n){for(var r=0;r<this._changeKeys.length&&this._changeKeys[r].id<=e;r++){null!=this._changeKeys[r].fn&&this._changeKeys[r].fn(t,n);this.RemoveMapping(this._changeKeys[r].id)}};return e})();t.ChangeKeyOnCompleteMap=k;t.SpRegionalSettings=t._spRegionalSettingsDefaultsKillSwitchIsActive?{adjustHijriDays:1,calendarType:1,firstDayOfWeek:3,firstWeekOfYear:4,localeId:1033,currentDateInLocalCalendar:new Date(2013,10,9),showWeeks:!0,timeZone:"-7:00",timeZoneInHours:-7,workDayEnd:16,workDayStart:8,workDays:"1110111",time24:"1"}:{adjustHijriDays:1,calendarType:1,firstDayOfWeek:0,firstWeekOfYear:0,localeId:1033,currentDateInLocalCalendar:new Date(2013,10,9),showWeeks:!0,timeZone:"-7:00",timeZoneInHours:-7,workDayEnd:16,workDayStart:8,workDays:"0111110",time24:!1};t.hasPasteStarted=!1;t.injectJsScript=function(e,t,n){void 0===n&&(n=function(){});if(null==document.getElementById(e)){var r=document.createElement("script");r.setAttribute("type","text/javascript");r.setAttribute("src",e);r.id=e;r.onload=function(){t();n()};document.getElementsByTagName("head")[0].appendChild(r)}else{t();n()}};t.csomJsFilesLoader=new t.Utility.LoadExternalJsFiles(4);t.taxonomyLoadCallback=function(){SP.Taxonomy||(function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["GFt"],t,n)})];case 1:return[2,t.sent()]}})})})().then(function(e){SP.Taxonomy={TaxonomyFieldValue:e.TaxonomyFieldValue,TaxonomyFieldValueCollection:e.TaxonomyFieldValueCollection}})}})(t.JsGridUtil||(t.JsGridUtil={}))});
define("$qe",["require","exports","o","r","Lqe","Dqe","Nqe","we","Ou","qd","tQe","k","hqe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d=p.tablemgr_9;p=p.headermgr_6;Object.defineProperty(t,"__esModule",{value:!0});var v={ODB:1725},m={ODB:60017},g=s.JsGridConstants.Internal.ColumnHeaderHeight,y="QuickEditHeaderColumn",b=c.Killswitch.isActivated("9340DEC3-CF41-4D00-BDD8-2AA84E33D2C2","2/05/2020","Make headers accessible with keyboard only."),w=c.Killswitch.isActivated("D132AFD6-52B6-4C09-98A9-18CE1F461F78","4/13/2020","Making sure not to hide the resize bar to early on mouse move."),E=(function(){function e(e,t,s,o){var u=this;this.ElementState={Normal:1,Hover:2,Clicked:3};this._headerChildObjects={};this._columnInfoMap={};this._partsEnabled={};this._initalColorMap={};this._styles={};this._lockedElements={};this._sortStates={};this._filterStates={};this._activeColumn=null;this._dropDownMenuVisible=!1;this._currentEditColumnKey=null;this.constMenuWidth=15;this.constEyeBrowHeight=5;this.constResizeWidth=5;this.RenderDetailsColumn=function(e){var t,s=u._columnInfoMap[e],o=u._headerChildObjects[e],c=null===(t=o)||void 0===t?void 0:t.th,h=o?o.coreContent:null,p=o?o.dropHint:null;if(s&&h){var d=s.column,m=s.columnIndex,g=d.isSortable?u._sortStates[e]:void 0,b=!!g,w=-1===g,E=u._filterStates.hasOwnProperty(e);n.render(r.createElement(a.DetailsColumn,{column:{name:d.name,key:d.columnKey,columnActionsMode:f.ColumnActionsMode.hasDropdown,minWidth:d.width,isSorted:b,isSortedDescending:w,isFiltered:E,isIconOnly:d.isIconOnly,iconName:d.iconName,headerClassName:y},columnIndex:m+1,styles:{root:[{padding:0,lineHeight:32,width:"100%",overflow:d.isIconOnly?"hidden":void 0},i.JsGridUtil.Internal.IsFeatureEnabled(v)&&{display:"flex",alignItems:"center"}],cellTooltip:[{position:"relative"},i.JsGridUtil.Internal.IsFeatureEnabled(v)&&{minWidth:0}],cellTitle:{paddingLeft:d.isFooter?4:12,paddingRight:8}},isDraggable:!d.isFooter,updateDragInfo:u._dragDropMgr._updateDragInfo,dragDropHelper:u._dragDropMgr.getDragDropHelper(),isDropped:u._dragDropMgr._onDropIndexInfo?u._dragDropMgr._onDropIndexInfo.targetIndex===m:null}),h,function(){var t,n,r,s,o,a;if(!i.JsGridUtil._headerScreenreaderKillSwitchIsActive){var f=null===(t=h)||void 0===t?void 0:t.querySelector("."+y);if(f){f.removeAttribute("role");f.removeAttribute("aria-colindex");f.removeAttribute("aria-sort")}var p=b?w?"descending":"ascending":"none";null===(n=c)||void 0===n||n.setAttribute("aria-sort",p)}if(!i.JsGridUtil._columnHeaderErrorIndicatorKillSwitchIsActive){var d=null===(o=null===(s=null===(r=u._focusMgr)||void 0===r?void 0:r._gridPane)||void 0===s?void 0:s.tableMgr)||void 0===o?void 0:o.fieldsWithErrors[e];if(d){var v=null===(a=c)||void 0===a?void 0:a.querySelector("."+l.FIELD_TITLE_SPAN_CLASSNAME);v.parentNode.contains(d)||v.parentNode.insertBefore(d,v.nextSibling)}}});p&&u._dragDropMgr.renderDropHint&&n.render(u._dragDropMgr.renderDropHint(m+1),p)}};this.GetLargestColumnIdx=function(){for(var e=0,t=Object.keys(u._columnInfoMap),n=0;n<t.length;n++)u._columnInfoMap.hasOwnProperty(t[n])&&u._columnInfoMap[t[n]].columnIndex>e&&(e=u._columnInfoMap[t[n]].columnIndex);return e};this.constCoreContentPadding=0;this.borderMap={menu:e.RTL.Left,resize:e.RTL.Right,eyeBrow:"Bottom"};this._objBag=e;this._styleMgr=t;this._fnGetLocStr=s;this._fnUpdatePositionedElements=o;this._dragDropMgr=this._objBag.dragDropMgr;this._focusMgr=this._objBag.focusMgr;this.CreateCoreContentMeasuringElement()}e.prototype.CreateCoreContentMeasuringElement=function(){var e=this._styleMgr.columnHeaderStyleCollection.normal,t=null!=e.font?"font-family:"+e.font+";":"";this._coreContentBaseCssText=u.format("text-align:{0};padding-{0}:{1}px;{2}font-size:{3};font-weight:{4};",this._objBag.RTL.left,this.constCoreContentPadding,t,e.fontSize,e.fontWeight);var n=document.createElement("table");n.style.cssText="position:absolute;visibility:hidden;top:0px;left:0px;width:0px;height:0px;";n.insertRow(-1);var r=document.createElement("th");n.rows[0].appendChild(r);this._coreContentWidthMeasuringElement=document.createElement("div");this._coreContentWidthMeasuringElement.className=i.JsGridUtil.Internal.IsFeatureEnabled(v)?p.spGridHeaderCoreContent:"jsgrid-header-core-content";this._coreContentWidthMeasuringElement.style.cssText=this._coreContentBaseCssText;r.appendChild(this._coreContentWidthMeasuringElement);this._objBag.parentNode.appendChild(n)};e.prototype.CalculateChildObjects=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetChildrenWithCustomAttribute(e,"colid");t.th=e;return t};e.prototype.CreateTableHeaderCell=function(e,t,n,r,o,u,a,f,l,c){var h=this,y=i.JsGridUtil.Internal.IsFeatureEnabled(v),w=r&&!e.bOpenMenuOnContentClick&&!e.isFooter,E=w?"move":"default",S=o&&e.isResizable,x=e.bOpenMenuOnContentClick,T=(null!=e.imgSrc||!!e.iconName)&&x;this._columnInfoMap[e.columnKey]={column:e,columnIndex:c};var N,C,k,L,A,O=[];if(i.JsGridUtil.Internal.IsFeatureEnabled(v)){N=g;C="position:absolute;right:1px";k='class="'+p.resizeContainer+'" ';L="";A="height:"+g+"px"}else{N=32;C="float:"+this._objBag.RTL.right+";position:relative";L='<div style="width:1px;height:100%;left:9px;position:relative;background-color:#c8c8c8;"></div>';k="";A="left:1px;top:7px"}O.push('<div colid="resizeRight" ');O.push(k);O.push((S?'colAction="resize-current"':"")+'style="'+C);O.push(";cursor:"+(S?"w-resize":"default"));O.push(S?";width:16px;height:"+N+"px;margin-left:-8px;margin-right:-8px":"");O.push(';z-index:1;opacity:0">');O.push((S?L:"")+"</div>");if(!e.isFooter){O.push('<div colid="dropHint" ');O.push('style="float:');O.push(this._objBag.RTL.right);O.push(";z-index:1;position:relative;"+A+'">');O.push("</div>")}O.push('<div colid="move" '+(w?'colAction="move"':"")+' style="white-space:nowrap;overflow:auto;" class="ms-positionRelative">');O.push('<div colid="resize" ');O.push('style="float:');O.push(this._objBag.RTL.left+";");O.push("position:absolute;");O.push('"></div>');O.push('<div colid="content" ');O.push('style="cursor:'+E+';"><div colid="coreContent" coltype="text" ');O.push('style="'+this._coreContentBaseCssText+"cursor:"+E+';" unselectable="true">');O.push("</div>");O.push("</div></div>");O.push("</div>");t.innerHTML=O.join("");var M=e.columnKey,_=this._headerChildObjects[M]=this.CalculateChildObjects(t);this._partsEnabled[M]={selection:a,move:w,resize:S};if(null!=f){t.addEventListener("click",function(e){var t=i.JsGridUtil.Internal.GetEventSrcElement(e);if(null!=t&&null==t.getAttribute("colAction")){var n=t.getAttribute("colid");"resize"!=n&&"resizeRight"!=n&&f(e,M)}});if(!b){t.addEventListener("keydown",function(e){if(null===document.getElementById(M+"_"+h._focusMgr._gridPane.Id+"_focusElement")){var t=h._focusMgr._gridPane;e.keyCode!==s.JsGridConstants.Key.enter&&e.keyCode!==s.JsGridConstants.Key.space||f(e,M);if(e.keyCode===s.JsGridConstants.Key.right||y&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&e.keyCode===s.JsGridConstants.Key.tab&&!e.shiftKey){var n=h.GetLargestColumnIdx();if(c<n)h._focusMgr._gridPane.SetFocusToHeader(c+2);else if(e.keyCode===s.JsGridConstants.Key.tab){var r=h._focusMgr._selectionMgr,o=h._focusMgr._gridPane;r.SetFocusByPos(o,0,-1);h._focusMgr.Focus()}e.preventDefault();e.stopPropagation()}if(e.keyCode===s.JsGridConstants.Key.left||y&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&e.keyCode===s.JsGridConstants.Key.tab&&e.shiftKey){var u=y&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?0:1;if(c>=u){h._focusMgr._gridPane.SetFocusToHeader(c);e.preventDefault();e.stopPropagation()}}if(e.keyCode===s.JsGridConstants.Key.down){y&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?(function(){var e;if(h.GetLargestColumnIdx()!==c||!i.JsGridUtil._lastColumnVisibilityKillSwitchIsActive&&(!h._objBag.showAddColumnMenu||!h._objBag.canUserAddColumn)){var n=h._focusMgr._selectionMgr,r=null===(e=t.GetCellByIdx(0,0))||void 0===e?void 0:e.GetTr();r&&r.classList.add(d.rowHasOnlyOneCellSelected);n.SetFocusByPos(t,0,c);h._focusMgr.Focus();return!0}})():h._focusMgr.Focus()}if(i.JsGridUtil.Internal.IsFeatureEnabled(m)&&e.keyCode===s.JsGridConstants.Key.esc){t.HideFocusStyles();t.ScrollCellIntoView(0,0);h._focusMgr._gridFocusEntryPoint.focus()}}})}}if(T){_.menuImg&&(_.menuImg.style.display="none");_.menu&&(_.menu.style.visibility="hidden")}if("DocIcon"===e.columnKey){e.iconName="page";e.isIconOnly=!0}this.RenderDetailsColumn(e.columnKey);null!=e.name&&(t.title=e.name);this._fnGetHeaderSibling=l;i.JsGridUtil.DebugAssert(null!=e.width&&e.width>=e.isIconOnly?s.JsGridConstants.Internal.IconColumnWidth:s.JsGridConstants.Internal.MinColumnWidth,"Column width should have been adjusted via headerMgr.AdjustColumnWidth(column)!");t.thColumnKey=M;t.nowrap="nowrap";null!=this._activeColumn&&this._activeColumn.thColumnKey==M&&(this._activeColumn=null);if(i.JsGridUtil.Internal.IsStickyColumnEnabled())if(c<=i.JsGridUtil.Internal.stickyLastColIdx){t.classList.add(d.gridStickyDataColumn);t.classList.add(d.gridStickyDataColumnHeader);i.JsGridUtil._spClientStickyColumnFixKillSwitchIsActive||t.classList.add(d.gridStickydataColumnHeaderImportant);i.JsGridUtil.Internal.stickyChromeless?t.classList.add(d.gridStickyDataLeftChromeless):t.classList.add(d.gridStickyDataLeft);e.isSticky=!0;if(c>0){var D=i.JsGridUtil.Internal.stickyLeftEdgeOffset+i.JsGridUtil.Internal.stickyCheckColumnSize+this._objBag.paneMgr.gridPane.allColumns.GetColumnArray()[0].width;this._objBag.RTL.bEnabled?t.style.right=D+"px":t.style.left=D+"px"}}else e.isSticky=!1;return t=_=null};e.prototype.UpdateHeader=function(e,t){var n=this._headerChildObjects[e.thColumnKey].resize;if(null!=t&&this._partsEnabled[t.thColumnKey].resize){n.colAction="resize";n.style.cursor="w-resize"}else if(this._partsEnabled[e.thColumnKey].move){n.colAction="move";n.style.cursor="move"}else{n.colAction=null;n.style.cursor="default"}};e.prototype.NotifyColumnHeaderOrderSet=function(e){for(var t=e,n=null;null!=t;){this.UpdateHeader(t,n);n=t;t=this._fnGetHeaderSibling(t,!1)}};e.prototype.DisposeHeader=function(e){null!=this._curHighlightedElem&&this._curHighlightedElem.columnKey==e.thColumnKey&&(this._curHighlightedElem=null);null!=this._curActingColumnInfo&&this._curActingColumnInfo.key==e.thColumnKey&&(this._curActingColumnInfo=null);var t=this._headerChildObjects[e.thColumnKey]&&this._headerChildObjects[e.thColumnKey].menu;null!=t&&i.JsGridUtil.ClearEventListeners(t);delete this._headerChildObjects[e.thColumnKey];delete this._styles[e.thColumnKey];delete this._initalColorMap[e.thColumnKey];delete this._partsEnabled[e.thColumnKey];delete this._lockedElements[e.thColumnKey];e.thColumnKey=null};e.prototype.Dispose=function(){var e=[];for(var t in this._headerChildObjects)e.push(this._headerChildObjects[t].th);for(var n=e.length-1;n>=0;n--){delete this._sortStates[e[n].thColumnKey];this.DisposeHeader(e[n])}this._activeColumn=this._headerChildObjects=this._curActingColumnInfo=this._curHighlightedElem=this._lockedElements=this._partsEnabled=this._sortStates=null};e.prototype.ApplyHeaderStyle=function(e,t,n){var r=this._headerChildObjects[e.thColumnKey],s=i.JsGridUtil.Internal.IsFeatureEnabled(v);if(null==this._curActingColumnInfo||this._curActingColumnInfo.key!=e.thColumnKey){if(e.headerStyleType!==t.type){this._initalColorMap[e.thColumnKey]={};s?e.className+=" "+p.gridHeaderCell:e.style["border"+this._objBag.RTL.Right]=o.StyleUtil.MakeBorderString(1,"solid ",t.innerBorderColor);if(null!=r){null!=t.font&&(r.coreContent.style.fontFamily=t.font);r.coreContent.style.fontSize=t.fontSize;r.coreContent.style.fontWeight=t.fontWeight;r.coreContent.style.color=t.textColor;null!=r.sortA&&null!=r.sortA.style&&(r.sortA.style.color=t.textColor);e.style.backgroundColor=r.resize.style.backgroundColor=t.backgroundColor;r.resize.style["border"+this._objBag.RTL.Right]=o.StyleUtil.MakeBorderString(1,"solid ",t.backgroundColor)}if(null!=r&&null!=r.eyeBrow){this._initalColorMap[e.thColumnKey].eyeBrow={};this._initalColorMap[e.thColumnKey].eyeBrow.bg=r.eyeBrow.style.backgroundColor=t.eyeBrowColor;this._initalColorMap[e.thColumnKey].eyeBrow.border=r.eyeBrow.style["border"+this.borderMap.eyeBrow+"Color"]=t.eyeBrowBorderColor}else{delete this._initalColorMap[e.thColumnKey].eyeBrow;null!=t.innerBorderColor&&(e.style.borderTop=o.StyleUtil.MakeBorderString(1,"solid ",t.innerBorderColor))}s||(e.style.borderBottom=o.StyleUtil.MakeBorderString(1,"solid ",t.outerBorderColor));this._initalColorMap[e.thColumnKey].move=e.style.backgroundColor=t.backgroundColor;if(null!=r&&null!=r.menu){this._initalColorMap[e.thColumnKey].menu={};this._initalColorMap[e.thColumnKey].menu.bg=r.menu.style.backgroundColor=t.menuColor;null!=t.menuBorderColor&&(this._initalColorMap[e.thColumnKey].menu.border=r.menu.style.borderColor=t.menuBorderColor)}else delete this._initalColorMap[e.thColumnKey].menu;null!=r&&(r.resizeRight.style.backgroundColor=null!=r.menu&&"inline-block"==r.menu.style.display?t.menuColor:t.backgroundColor);this._styles[e.thColumnKey]=t}e.headerStyleType=t.type;e.headerStyleBorderString=o.StyleUtil.MakeBorderString(1,"solid",t.outerBorderColor);e.headerStyleInnerBorderString=o.StyleUtil.MakeBorderString(1,"solid",t.innerBorderColor);var u=this._fnGetHeaderSibling(e,!0);null==u||s||(null!=t.innerBorderColor?u.style["border"+this._objBag.RTL.Right]=l(u,e).headerStyleInnerBorderString:u.style["border"+this._objBag.RTL.Right]=l(u,e).headerStyleBorderString);if(null!=this._partsEnabled[e.thColumnKey]&&null!=this._partsEnabled[e.thColumnKey].resize){var a=this._fnGetHeaderSibling(e,!1);if(null!=a&&null!=this._headerChildObjects[a.thColumnKey]&&null!=this._initalColorMap[a.thColumnKey]){s||(null!=t.innerBorderColor?e.style["border"+this._objBag.RTL.Right]=l(a,e).headerStyleInnerBorderString:e.style["border"+this._objBag.RTL.Right]=l(a,e).headerStyleBorderString);var f=this._headerChildObjects[a.thColumnKey].resize;if(n){this._initalColorMap[a.thColumnKey].resize={};this._initalColorMap[a.thColumnKey].resize.bg=f.style.backgroundColor=this._styles[a.thColumnKey].resizeColor;this._initalColorMap[a.thColumnKey].resize.border=f.style["border"+this.borderMap.resize+"Color"]=this._styles[a.thColumnKey].resizeBorderColor}else{this._initalColorMap[a.thColumnKey].resize={};this._initalColorMap[a.thColumnKey].resize=f.style.backgroundColor=f.style["border"+this.borderMap.resize+"Color"]=this._styles[a.thColumnKey].backgroundColor}}}}else this._curActingColumnInfo.curStyle=t;function l(e,t){i.JsGridUtil.DebugAssert(null!=e.headerStyleType||null!=t.headerStyleType);return null==e.headerStyleType?t:null==t.headerStyleType?e:e.headerStyleType>t.headerStyleType?e:t}};e.prototype.ApplyHeaderClassnames=function(e){for(var t=this._objBag.paneMgr.GetGridPane(),n=this._objBag.selectionMgr,r=e.GetColIdx(),i=n.GetRowRanges(t),s=!1,o=0;o<i.length;o++)i[o].Contains(0)&&(s=!0);if(0===i.length||s){for(var u=n.GetCellRanges(t),a=0;a<u.length;a++)if(u[a].colRange.Contains(r)&&!u[a].rowRange.Contains(0)){e.GetTd().classList.add(p.columnIsActive);return}e.GetTd().classList.remove(p.columnIsActive)}else e.GetTd().classList.add(p.columnIsActive)};e.prototype.GetColumnHeaderAutoResizeWidth=function(e){var t=this._headerChildObjects[e.thColumnKey];return null!=t.coreContent?e.offsetWidth+Math.max(t.coreContent.scrollWidth-t.coreContent.offsetWidth,0):e.offsetWidth};e.prototype.AdjustColumnWidth=function(e){if(null==e.width||e.width<=0){e.width=s.JsGridConstants.Internal.MinColumnWidth;if(null!=e.name){i.JsGridUtil.Internal.DomElement.GetInstance().SetText(this._coreContentWidthMeasuringElement,e.name);var t=this._dropDownMenuVisible?this.constMenuWidth+10:0;e.width=this._coreContentWidthMeasuringElement.scrollWidth+this.constResizeWidth+this.constResizeWidth+t}}"JSGrid_NewColumn"===e.columnKey?e.width=Math.max(e.width,s.JsGridConstants.Internal.IconColumnWidth):i.JsGridUtil.Internal.IsFeatureEnabled(v)&&"DocIcon"===e.columnKey?e.width=Math.max(e.width,s.JsGridConstants.Internal.IconColumnNewWidth):e.width=Math.max(e.width,s.JsGridConstants.Internal.MinColumnWidth)};e.prototype.ResizeColumn=function(e,t){this._objBag.bUpdateCoordCache=!0};e.prototype.ShowMenuOnColumn=function(e){if(this._activeColumn!==e&&null!=e.thColumnKey){null!=this._headerChildObjects[e.thColumnKey].menu&&(this._activeColumn=e)}};e.prototype.GetChildObjects=function(e){return this._headerChildObjects[e]};e.prototype.GetColumnHeaderElement=function(e){var t=this._headerChildObjects[e];return null!=t?t.th:null};e.prototype.GetColumnHeaderPosition=function(e){var t=this._headerChildObjects[e],n=null;null!=t&&(n=t.th);if(null==n)return null;var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(n);return{left:r.x,width:n.offsetWidth,top:r.y+(this._objBag.RTL.bEnabled?4:0),height:n.offsetHeight}};e.prototype.GetColumnMenuElementPosition=function(e){var t=this._headerChildObjects[e].menu;if(null==t)return null;var n=this._headerChildObjects[e].resizeRight,r=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(t),s=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(n);return{left:Math.min(r.x,s.x),width:t.offsetWidth+n.offsetWidth,top:r.y+(this._objBag.RTL.bEnabled?4:0),height:t.offsetHeight}};e.prototype.OnSort=function(e,t){i.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);e.preventDefault();this._objBag.delegateMgr.Apply(s.JsGridConstants.DelegateType.Sort,[{columnName:t,isDescending:1==this._sortStates[t]}])};e.prototype.RenameColumn=function(e,t){var n,r=this,o=i.JsGridUtil.Internal.IsFeatureEnabled(v),u=null,a=function(e){null==u&&(u=setTimeout(function(){f(e)},50))},f=function(o){var u=h.TrimSpaces(n.value);r.SetColumnEdited(e);n.removeEventListener("blur",a);n.removeEventListener("keydown",l);if(u.length<1){alert(r._fnGetLocStr("RenameColumn_BlankColumnName"));u=N}T.name=u;r._columnInfoMap[T.columnKey].column.name=u;r.RenderDetailsColumn(T.columnKey);E.title=u;E.style.width=S;E.style.minWidth=x;y.className=b;n.parentNode.replaceChild(w,n);if(u!==N){T.width=null;r.AdjustColumnWidth(T);r.ResizeColumn(E,T.width)}r._objBag.bUpdateCoordCache=!0;i.JsGridUtil.DebugAssert(null!=r._fnUpdatePositionedElements);null!=r._fnUpdatePositionedElements&&r._fnUpdatePositionedElements();r._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnEndRenameColumn,i.JsGridUtil.EventArgs.OnEndRenameColumn(e,N,u));t&&t();E.focus()},l=function(e){e&&e.keyCode==s.JsGridConstants.Key.esc&&(n.value=N);!e||e.keyCode!=s.JsGridConstants.Key.tab&&e.keyCode!=s.JsGridConstants.Key.enter||n.blur()},c=function(e){null!=u&&clearTimeout(u);e.stopPropagation()};this._objBag.eventMgr.FireEvent(s.JsGridConstants.EventType.OnBeginRenameColumn);this._objBag.selectionMgr.Clear(!1);var d=this._objBag.paneMgr.GetGridPane(),m=d.GetGridPaneConverter(),g=this._headerChildObjects[e],y=g.content,b=y.className,w=g.coreContent,E=(function(e){for(;e&&"TH"!==e.tagName;)e=e.parentNode;return e})(w),S=E.style.width,x=E.style.minWidth,T=m.GetColumnByKey(e),N=T.name;this.SetColumnEditing(e);(function(){(n=document.createElement("input")).id=e+"_"+d.Id+"_focusElement";n.className="jsgrid-control-header-editbox";n.value=N;n.style.width=E.clientWidth-(o?24:20)+"px";n.setAttribute("type","text");n.setAttribute("colAction","rename");n.addEventListener("blur",a.bind(r));n.addEventListener("keydown",l.bind(r));n.addEventListener("mousedown",c.bind(r));n.addEventListener("mouseup",c.bind(r));n.addEventListener("click",c.bind(r));var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(E,"width","width");E.style.width=t;E.style.minWidth=t;y.className=o?p.renameInputContainer:"ms-spGrid-HeaderContentStyle-Rename";w.parentNode.replaceChild(n,w);n.focus()})();n.select()};e.prototype.ColumnIsPresent=function(e){return e in this._headerChildObjects};e.prototype.UpdateColorFromEventInfo=function(e,t){var n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"thColumnKey");if(null!=n&&this.ColumnIsPresent(n.elem.thColumnKey)){var r=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colid");if(null!=r&&this.UpdateColor(n.elem.thColumnKey,r.elem,t))return r.elem}return null};e.prototype.UpdateColor=function(e,t,n){var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(t,"colid");if("move"==i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(t,"colAction"))return!1;if("resizeRight"==r){var s=this._fnGetHeaderSibling(this._headerChildObjects[e].th,!1);if(null!=s){r="resize";e=s.thColumnKey}else r="menu"}null!=r&&e in this._initalColorMap&&r in this._initalColorMap[e]&&!(e in this._lockedElements&&r in this._lockedElements[e])&&("eyeBrow"!==r||this._partsEnabled[e].selection)&&(n==this.ElementState.Normal?this.ApplyColorToElem(e,r,this._initalColorMap[e][r].bg,this._initalColorMap[e][r].border):n==this.ElementState.Hover?this.ApplyColorToElem(e,r,this._styles[e][r+"HoverColor"],this._styles[e][r+"HoverBorderColor"]):n==this.ElementState.Clicked&&this.ApplyColorToElem(e,r,this._styles[e].elementClickColor,this._styles[e].elementClickBorderColor));return!0};e.prototype.ApplyColorToElem=function(e,t,n,r){if(null!=n){this._headerChildObjects[e][t].style.backgroundColor=n;"menu"==t&&(this._headerChildObjects[e].resizeRight.style.backgroundColor=n)}null!=r&&(this._headerChildObjects[e][t].style["border"+this.borderMap[t]+"Color"]=r)};e.prototype.ClearSort=function(e){delete this._sortStates[e];this.RenderDetailsColumn(e)};e.prototype.SetColumnSortState=function(e,t){delete this._sortStates[e];if(1==t||-1==t){this._sortStates[e]=t;null!=this._headerChildObjects[e]&&this.RenderDetailsColumn(e)}else this.ClearSort(e)};e.prototype.ClearColumnFiltered=function(e){delete this._filterStates[e];this.RenderDetailsColumn(e)};e.prototype.SetColumnFiltered=function(e){this._filterStates[e]=null;this.RenderDetailsColumn(e)};e.prototype.SetSortState=function(e){for(var t in this._sortStates)this.ClearSort(t);if(null!=e)for(var n=0;n<e.length;n++)this.SetColumnSortState(e[n].fieldKey,e[n].isDescending?-1:1)};e.prototype.SetFilterState=function(e){for(var t in this._filterStates)this.ClearColumnFiltered(t);if(null!=e)for(var n=0;n<e.length;n++)this.SetColumnFiltered(e[n])};e.prototype.HeaderMouseDown=function(e){this.UpdateColorFromEventInfo(e,this.ElementState.Clicked)};e.prototype.HeaderMouseUp=function(e){this.UpdateColorFromEventInfo(e,this.ElementState.Normal)};e.prototype.HeaderMouseMove=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"thColumnKey");if(null!=t&&this.ColumnIsPresent(t.elem.thColumnKey)){var n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colid");if(null!=n&&null!=n.elem){var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(n.elem,"colid");"resizeRight"===r&&(this._headerChildObjects[t.elem.thColumnKey][r].style.opacity=1)}}};e.prototype.HeaderMouseOut=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"thColumnKey");if(null!=t&&this.ColumnIsPresent(t.elem.thColumnKey)){var n=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e.target,"colid");if(null!=n&&null!=n.elem){var r=i.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(n.elem,"colid");"resizeRight"===r&&(w?this._headerChildObjects[t.elem.thColumnKey][r].style.opacity=0:this._columnIsResizing||(this._headerChildObjects[t.elem.thColumnKey][r].style.opacity=0))}}};e.prototype.InColumnHeaderEditMode=function(){return null!=this._currentEditColumnKey};e.prototype.ColumnCurrentlyEditing=function(e){return this._currentEditColumnKey==e};e.prototype.SetColumnSelected=function(e){this.LockItem(e,"eyebrow")};e.prototype.SetColumnUnselected=function(e){this.UnlockItem(e,"eyebrow")};e.prototype.SetColumnMenuExpanded=function(e){};e.prototype.SetColumnMenuCollapsed=function(e){};e.prototype.SetColumnMoving=function(e){this.LockItem(e,"move",!0)};e.prototype.SetColumnMoved=function(e){this.UnlockItem(e,"move",!0)};e.prototype.SetColumnResizing=function(e){this._columnIsResizing=!0;this.LockItem(e,"resize",!0)};e.prototype.SetColumnEdited=function(e){this._currentEditColumnKey=null;this.UnlockItem(e,"coreContent",!0)};e.prototype.SetColumnEditing=function(e){this._currentEditColumnKey=e;this.LockItem(e,"coreContent",!0)};e.prototype.SetColumnResized=function(e){this._columnIsResizing=!1;this.UnlockItem(e,"resize",!0)};e.prototype.LockColumn=function(e){null!=this._curActingColumnInfo&&i.JsGridUtil.DebugAssert(!1);this._curActingColumnInfo={};this._curActingColumnInfo.key=e};e.prototype.UnLockColumn=function(){if(null!=this._curActingColumnInfo){var e=this._curActingColumnInfo;this._curActingColumnInfo=null;null!=e.curStyle&&this.ApplyHeaderStyle(this._headerChildObjects[e.key].th,e.curStyle)}};e.prototype.LockItem=function(e,t,n){this.UpdateColor(e,this._headerChildObjects[e][t],this.ElementState.Clicked);null==this._lockedElements[e]&&(this._lockedElements[e]={});this._lockedElements[e][t]="";n&&this.LockColumn(e)};e.prototype.UnlockItem=function(e,t,n){i.JsGridUtil.DebugAssert(e in this._lockedElements&&t in this._lockedElements[e]);if(e in this._lockedElements&&t in this._lockedElements[e]){delete this._lockedElements[e][t];i.JsGridUtil.Internal.IsAssocArrayEmpty(this._lockedElements[e])&&delete this._lockedElements[e];null!=this._curActingColumnInfo&&this._curActingColumnInfo.key==e&&this.UnLockColumn();this.ColumnIsPresent(e)&&this.UpdateColor(e,this._headerChildObjects[e][t],this._headerChildObjects[e][t]==this._curHighlightedElem?this.ElementState.Hover:this.ElementState.Normal)}};return e})();t.HeaderManager=E});
define("zqe",["require","exports","Lqe","Dqe","Aqe","Nqe","bQe","_Qe","mQe","lQe","Yqe","RWe","Qqe","qqe","Gqe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(){function e(e,t,i){var s=this;this.disableCount=0;this.bIsInitialized=!1;this.bViewSet=!1;this.eventMgr=new n.JsGridUtil.EventManager;this.delegateMgr=new n.JsGridUtil.DelegateManager;this.intDelegateMgr=new n.JsGridUtil.DelegateManager;this.objBag={};this.TestEventType={Start:0,Finish:1};this.Dispose=function(){if(s.bIsInitialized){window.removeEventListener("unload",s.Dispose);s.objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnBeforeGridDispose);s.objBag.intEventMgr.FireEvent(r.JsGridConstants.Internal.EventType.OnGridDisposing);s.loadingBanner.Dispose();if(n.JsGridUtil.Internal.DomElement.GetInstance().ElementAttachedToDom(s.parentNode)){s.paneMgr.Dispose();s.parentNode.innerHTML="";s.parentNode=s.parentNode.jsgrid=s.parentNode.jsgridparams=s.parentNode.jsgridtableviewparams=s.parentNode.jsgridrowviewparams=null}delete s.parentNode;s.objBag.parentNode=null;s.bIsInitialized=s.bViewSet=!1;s.commandMgr.RemovePreExecuteNotifier(s.StopEditing.bind(s))}};this.StaticInit();e.style.position="relative";this.parentNode=e;this.bShowLoadingBanner=t;this.loadingBanner=new n.JsGridUtil.LoadingBanner(e,e.id+"_disable_banner");e.jsgrid=this;t&&this.SetEnabledState(!1);if(i){this.objBag.setColumnWidthsToLocalStorage=i.setColumnWidthsToLocalStorage;this.objBag.dragDropMgr=i.dragDropMgr;this.objBag.onSelectionChanged=i.onSelectionChanged}}e.prototype.IsInitialized=function(){return this.bIsInitialized};e.prototype.ResetData=function(e){this.tableCache=e};e.prototype.Init=function(e){var t=this,i=e;this._jsGridParams=this.parentNode.jsgridparams=i;this.parentNode.jsgridtableviewparams=i.tableViewParams;this.parentNode.jsgridrowviewparams=i.tableViewParams&&i.tableViewParams.rowViewParams;this.FireTestEvent(this.TestEventType.Start);this.name=null!=i.name?i.name:"";this.InitOldStyleDelegates();this.tableCache=i.tableCache;this.commandMgr=i.commandMgr;this.commandMgr.IsUndoEnabled()&&this.commandMgr.AddPreExecuteNotifier(this.StopEditing.bind(this));this.objBag.RTL={bEnabled:i.isRTL,left:i.isRTL?"right":"left",Left:i.isRTL?"Right":"Left",right:i.isRTL?"left":"right",Right:i.isRTL?"Left":"Right",ltr:i.isRTL?"rtl":"ltr"};s.Style.getInstance().SetRTL(this.objBag.RTL);this.intDelegateMgr.SetDelegate(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,this.CallAsyncFn.bind(this));this.intDelegateMgr.SetDelegate(r.JsGridConstants.Internal.DelegateType.GetLocalizedString,this.GetLocalizedString.bind(this));this.intDelegateMgr.SetDelegate(r.JsGridConstants.Internal.DelegateType.DoLargeTask,this.DoLargeTask.bind(this));this.objBag.jsGridObj=this;this.objBag.jsGridParams=this._jsGridParams;this.objBag.gridId=this.parentNode.id;this.objBag.eventMgr=this.eventMgr;this.objBag.intEventMgr=new n.JsGridUtil.EventManager;this.objBag.intDelegateMgr=this.intDelegateMgr;this.objBag.commandMgr=i.commandMgr;this.objBag.portalManager=i.portalManager;this.objBag.delegateMgr=this.delegateMgr;this.objBag.styleMgr=i.styleManager;this.objBag.tableCache=i.tableCache;this.objBag.canUserAddColumn=i.canUserAddColumn;this.objBag.showAddColumnMenu=i.showAddColumn;this.objBag.spGrid=i.spGrid;this.objBag.spCsrRenderCtx=i.spCsrRenderCtx;this.objBag.qualifier=i.qualifier;this.objBag.errorMgr=new o.ErrorManager(this.objBag);this.objBag.rowHeaderStateMgr=new u.RowHeaderStateManager(this.objBag.intEventMgr);this.objBag.rowHeaderStates=new u.RowHeaderStates(this.objBag);this.objBag.rowHeaderAutoStates=new u.AutoRowHeaderStates(i.enabledRowHeaderAutoStates,this.objBag);this.objBag.entryRecordMgr=new a.EntryRecordManager(this.objBag);this.objBag.provisionalRecordMgr=new a.ProvisionalRecordManager(this.objBag);this.objBag.parentNode=this.parentNode;this.objBag.bUpdateCoordCache=!1;this.objBag.gridControls={};this.spCsrRenderCtx=i.spCsrRenderCtx;var h="{cursor:pointer} :link {color:"+this.objBag.styleMgr.gridPaneStyle.linkColor+"} :visited {color: "+this.objBag.styleMgr.gridPaneStyle.visitedLinkColor+"}";c.DisplayControl.ImageTextDisplayControl.prototype._styleForLinks=h;c.DisplayControl.TextDisplayControl.prototype._styleForLinks=h;i.bNotificationsEnabled&&o.ErrorNotificationManager.Instance.Init(this.objBag.gridId,this.objBag);this.objBag.controller=this.controller=new f.MVCController(this.objBag,this.GetLocalizedString.bind(this));this.objBag.paneMgr=this.paneMgr=new l.PaneManager(this.parentNode.id,this.objBag,this.GetLocalizedString.bind(this),this.parentNode,i.minHeaderHeight,i.minRowHeight,function(){return 0==t.disableCount});this.paneMgr.SetEventSinks(this.controller.GetViewEventSinks());null!=e.tableViewParams&&this.SetTableViewInternal(e.tableViewParams);window.addEventListener("unload",this.Dispose);this.bIsInitialized=!0;this.FireTestEvent(this.TestEventType.Finish)};e.prototype.InitOldStyleDelegates=function(){null!=this._jsGridParams.fnCreateNewRecords&&this.delegateMgr.SetDelegate(r.JsGridConstants.DelegateType.CreateRecords,this._jsGridParams.fnCreateNewRecords);null!=this._jsGridParams.fnExpandColumnMenu&&this.delegateMgr.SetDelegate(r.JsGridConstants.DelegateType.ExpandColumnMenu,this._jsGridParams.fnExpandColumnMenu);null!=this._jsGridParams.fnSort&&this.delegateMgr.SetDelegate(r.JsGridConstants.DelegateType.Sort,this._jsGridParams.fnSort)};e.prototype.Cleanup=function(){window.removeEventListener("unload",this.Dispose);this.loadingBanner.Dispose();if(n.JsGridUtil.Internal.DomElement.GetInstance().ElementAttachedToDom(this.parentNode)){this.paneMgr.Dispose();this.parentNode.innerHTML=""}this.bIsInitialized=this.bViewSet=!1};e.prototype.NotifyDataAvailable=function(){this.controller.NotifyDataAvailable()};e.prototype.NotifySave=function(){this.controller.NotifySave()};e.prototype.NotifyHide=function(){this.controller.NotifyHide()};e.prototype.NotifyResize=function(){this.paneMgr.NotifyResize()};e.prototype.ClearTableView=function(){if(this.bViewSet){this.controller.ClearTableView();this.bViewSet=!1}};e.prototype.HideInitialLoadingBanner=function(){if(this.bShowLoadingBanner){this.SetEnabledState(!0);this.bShowLoadingBanner=!1}};e.prototype.ShowInitialGridErrorMsg=function(e){n.JsGridUtil.DebugAssert(!this.bViewSet);this.HideInitialLoadingBanner();this.errorBanner=new n.JsGridUtil.ErrorBanner(this.parentNode,this.parentNode.id+"_initial_error_banner");this.errorBanner.Show(e)};e.prototype.ShowGridErrorMsg=function(e){this.HideInitialLoadingBanner();this.errorBanner=new n.JsGridUtil.ErrorBanner(this.parentNode,this.parentNode.id+"_error_banner");this.errorBanner.Show(e)};e.prototype.LaunchPrintPreview=function(e,t,n,i,s,o,u,a,f,l){var c=this,p=null;null==i&&(i="test");this.paneMgr.GetRecordMap(function(d){c.objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(e){return p=c.tableCache.GetRecords([{pos:0,count:c.tableCache.GetRecordCount()}],function(t){p=t;e()})},function(){c._jsGridParams.tableViewParams.rowViewParams.view=c.tableCache.GetView();s?h.FinishLaunchPrintPreview(p.records[0],c._jsGridParams,e,t,n,u,a,i,s,o,c.parentNode.clientWidth-c.objBag.paneMgr.GetSplitterPosition()-r.JsGridConstants.Internal.SplitterWidth,c.objBag.paneMgr.GetGanttZoomLevel(),f,l):h.FinishLaunchPrintPreview(p.records[0],c._jsGridParams,e,t,n,u,a,i,s,null,0,0,null,null)})})};e.prototype.GetAllDataJson=function(e,t){this.paneMgr.GetAllDataJson(e,t)};e.prototype.GetAllDataAfterExpansionJson=function(e,t){this.paneMgr.GetAllDataAfterExpansionJson(e,t)};e.prototype.AddColumn=function(e,t,n){this.paneMgr.AddColumn(e,n);this.objBag.entryRecordMgr.AddColumn(e.columnKey,t)};e.prototype.SetTableView=function(e){this._jsGridParams.tableViewParams=this.parentNode.jsgridtableviewparams=e;this.parentNode.jsgridrowviewparams=e.rowViewParams;this.FireTestEvent(this.TestEventType.Start);this.SetTableView(e);this.FireTestEvent(this.TestEventType.Finish)};e.prototype.SetTableViewInternal=function(e){this.bViewSet&&this.ClearTableView();this.bViewSet=!0;this.HideInitialLoadingBanner();this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.GetGridRowStyleId)&&(e.fnGetGridRowStyleId=this.delegateMgr.GetDelegate(r.JsGridConstants.DelegateType.GetGridRowStyleId));null!=this._oldStyleAttachedRightClickFn&&this.eventMgr.DetachEvent(r.JsGridConstants.EventType.OnRightClick,this._oldStyleAttachedRightClickFn);this._oldStyleAttachedRightClickFn=null==e.fnOnRightClick?null:function(t){e.fnOnRightClick(t.eventInfo,t.context,t.recordKey,t.fieldKey)};null!=this._oldStyleAttachedRightClickFn&&this.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRightClick,this._oldStyleAttachedRightClickFn);this.posConverter=new p.PositionConverter(this.tableCache,this.objBag);if(null!=e.operationalConstantsFieldKeyMap){this.operationalConstantsFieldKeyMap=e.operationalConstantsFieldKeyMap;this.operationalUtil=this.GetOperationalUtility()}n.JsGridUtil.DebugAssert(!e.bNewRowEnabled||this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CreateEntryRecord)&&this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.TryInsertEntryRecord));n.JsGridUtil.DebugAssert(null!=this.operationalUtil);this.controller.SetTableView(e.rowViewParams,e.columns,e.gridFieldMap,e.defaultEditMode,e.bNewRowEnabled,e.bEditingEnabled,e.splitterPos,this.posConverter,this.operationalUtil,e.fnGetGridRowStyleId,e.allowedSelectionTypes,e.bMovableColumns,e.bResizableColumns,e.bHidableColumns,e.bSortableColumns,e.bAutoFilterableColumns,e.bRowHeadersEnabled,e.paneLayout,e.ganttParams,e.pivotedGridParams,e.bRecordIndicatorCheckboxesEnabled,e.checkSelectionCheckboxHiddenRecordKeys,e.checkSelectionCheckboxDisabledRecordKeys,e.checkSelectionCheckedRecordKeys)};e.prototype.SetRowView=function(e){this._jsGridParams.tableViewParams.rowViewParams=this.parentNode.jsgridrowviewparams=e;this.FireTestEvent(this.TestEventType.Start);this.controller.SetRowView(e);this.FireTestEvent(this.TestEventType.Finish)};e.prototype.Enable=function(){this.SetEnabledState(!0)};e.prototype.Disable=function(e){this.SetEnabledState(!1,e)};e.prototype.EnableEditing=function(){this.controller.EnableEditing()};e.prototype.DisableEditing=function(){this.controller.DisableEditing()};e.prototype.TryBeginEdit=function(){return this.controller.TryBeginEdit()};e.prototype.FinalizeEditing=function(e,t){this.controller.FinalizeEditing(e,t)};e.prototype._GetPaneManager=function(){return this.objBag.paneMgr};e.prototype.GetColumnByFieldKey=function(e,t){var n=this.paneMgr.GetGridPane().GetGridPaneConverter().FieldKeyToColIdx(e);return null==n?null:this.paneMgr.GetColumns(t)[n]};e.prototype.Focus=function(){this.paneMgr.Focus()};e.prototype.TryCommitFirstEntryRecords=function(e){this.objBag.entryRecordMgr.TryCommitFirstEntryRecords(e,!0)};e.prototype.ClearUncommittedEntryRecords=function(){this.objBag.entryRecordMgr.ClearUncommittedEntryRecords()};e.prototype.ClearEntryRecord=function(e){this.objBag.entryRecordMgr.ClearEntryRecord(e)};e.prototype.AnyUncomittedEntryRecords=function(){return null!=this.objBag&&null!=this.objBag.entryRecordMgr&&this.objBag.entryRecordMgr.AnyUncomittedEntryRecords()};e.prototype.AnyUncomittedProvisionalRecords=function(){return null!=this.objBag&&null!=this.objBag.provisionalRecordMgr&&this.objBag.provisionalRecordMgr.AnyUncomittedProvisionalRecords()};e.prototype.GetRecord=function(e){return this.objBag.entryRecordMgr.IsEntryRecordKey(e)?this.objBag.entryRecordMgr.GetEntryRecord(e):this.objBag.tableCache.GetCachedRecord(e)};e.prototype.GetEntryRecord=function(e){return this.objBag.entryRecordMgr.GetEntryRecord(e)};e.prototype.IsEntryRecordKey=function(e){return this.objBag.entryRecordMgr.IsEntryRecordKey(e)};e.prototype.IsCellEditable=function(e,t,n){return this.paneMgr.IsCellEditable(e,t,n)};e.prototype.AddBuiltInRowHeaderState=function(e,t){this.AddRowHeaderState(e,this.objBag.rowHeaderStates[t])};e.prototype.AddRowHeaderState=function(e,t){this.objBag.rowHeaderStateMgr.AddRowHeaderState(e,t)};e.prototype.RemoveRowHeaderState=function(e,t){this.objBag.rowHeaderStateMgr.RemoveRowHeaderState(e,t)};e.prototype.GetCheckSelectionManager=function(){return this.controller.GetCheckSelectionManager()};e.prototype.UpdateProperties=function(e,t,r){var i=this.controller.UpdateProperties(e,t,r,null);n.JsGridUtil.DebugAssert(null!=i,"can't update the NewRow programmatically");return i};e.prototype.GetLastRecordKey=function(){return this.objBag.paneMgr.GetLastRecordKey()};e.prototype.InsertProvisionalRecordBefore=function(e,t,n){return this.objBag.provisionalRecordMgr.InsertProvisionalRecordBefore(e,t,n)};e.prototype.InsertProvisionalRecordAfter=function(e,t,n){null==e&&(e=this.objBag.paneMgr.GetLastRecordKey());return this.objBag.provisionalRecordMgr.InsertProvisionalRecordAfter(e,t,n)};e.prototype.IsProvisionalRecordKey=function(e){return this.objBag.provisionalRecordMgr.IsProvisionalRecordKey(e)};e.prototype.InsertRecordAfter=function(e,t,n){return this.controller.InsertRecordAfter(e,t,n,!0)};e.prototype.InsertRecordBefore=function(e,t,n){return this.controller.InsertRecordBefore(e,t,n,!0)};e.prototype.InsertHiddenRecord=function(e,t,n){return this.controller.InsertHiddenRecord(e,t,n)};e.prototype.DeleteRecords=function(e,t){return this.controller.DeleteRecords(e,t)};e.prototype.IndentRecords=function(e,t){return this.controller.AdjustRecordsIndentLevel(e,1,t)};e.prototype.OutdentRecords=function(e,t){return this.controller.AdjustRecordsIndentLevel(e,-1,t)};e.prototype.ReorderRecords=function(e,t,n,r){return this.controller.ReorderRecords(e,t,n,r)};e.prototype.GetContiguousRowSelectionWithoutEntryRecords=function(){var e=this,t=function(t){for(var n=[],r=0;r<t.length;r++)e.IsEntryRecordKey(t[r])||n.push(t[r]);return n},n=(function(e){if(e.length<=1)return e;var t=e.slice(0);t.sort(function(e,t){return e.begin<t.begin});for(var n=[t[0]],r=1;r<t.length;r++){if(n[0].end+1!=t[r].begin)return e;n[0].end=t[r].end;n[0].keys.push(t[r].keys)}return n})(this.GetSelectedRowRanges());return 1==n.length?{begin:n[0].begin,end:n[0].end,keys:t(n[0].keys)}:1==(n=this.GetSelectedCellRanges()).length&&n[0].rowRange.keys.length>0?{begin:n[0].rowRange.begin,end:n[0].rowRange.end,keys:t(n[0].rowRange.keys)}:null};e.prototype.CanMoveRecordsUpByOne=function(e){return!(!this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CanReorderRecords)||!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.CanReorderRecords,e))&&(!(this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.OnBeforeRecordReordered)&&!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.OnBeforeRecordReordered,e))&&(0!=(e=this.GetReorderRange(e)).length&&this.posConverter.RecordKeyToViewIdx(e[0])>0))};e.prototype.CanMoveRecordsDownByOne=function(e){return!(!this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.CanReorderRecords)||!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.CanReorderRecords,e))&&(!(this.delegateMgr.DelegatePresent(r.JsGridConstants.DelegateType.OnBeforeRecordReordered)&&!this.delegateMgr.Apply(r.JsGridConstants.DelegateType.OnBeforeRecordReordered,e))&&(0!=(e=this.GetReorderRange(e)).length&&this.posConverter.RecordKeyToViewIdx(e[e.length-1])<this.GetViewRecordCount()-1))};e.prototype.MoveRecordsUpByOne=function(e){e=this.GetReorderRange(e);var t=this.posConverter.RecordKeyToViewIdx(e[0]),n=this.posConverter.ViewIdxToRecordKey(t-1);return this.ReorderRecords(e[0],e[e.length-1],n,!0)};e.prototype.MoveRecordsDownByOne=function(e){e=this.GetReorderRange(e);var t=this.posConverter.RecordKeyToViewIdx(e[e.length-1]),n=this.posConverter.ViewIdxToRecordKey(t+2);this.IsEntryRecordKey(n)&&(n=null);return this.ReorderRecords(e[0],e[e.length-1],n,!0)};e.prototype.GetReorderRange=function(e){return e};e.prototype.GetNodeExpandCollapseState=function(e){return this.controller.GetNodeExpandCollapseState(e)};e.prototype.ToggleExpandCollapse=function(e){this.controller.ToggleExpandCollapse(e)};e.prototype.AttachEvent=function(e,t){this.eventMgr.AttachEvent(e,t)};e.prototype.DetachEvent=function(e,t){this.eventMgr.DetachEvent(e,t)};e.prototype.SetDelegate=function(e,t){this.delegateMgr.SetDelegate(e,t)};e.prototype.GetDelegate=function(e){return this.delegateMgr.GetDelegate(e)};e.prototype.RefreshRow=function(e){this.paneMgr.NotifyChangedRows(this.posConverter.RecordKeyToViewIdx(e),1)};e.prototype.RefreshAllRows=function(e,t){this.paneMgr.RefreshAllRows(e,t)};e.prototype.ClearChanges=function(){this.controller.ClearChanges()};e.prototype.GetGanttZoomLevel=function(){return this.paneMgr.GetGanttZoomLevel()};e.prototype.SetGanttZoomLevel=function(e){this.paneMgr.SetGanttZoomLevel(e)};e.prototype.ScrollGanttToDate=function(e){this.paneMgr.ScrollGanttToDate(e)};e.prototype.ScrollCellIntoView=function(e,t,n){this.paneMgr.ScrollCellIntoView(e,t,n)};e.prototype.GetTopRecordIndex=function(){return this.posConverter.GetTopViewIdx()};e.prototype.GetTopRowIndex=function(e){return this.paneMgr.GetTopRowIndex(e)};e.prototype.GetViewRecordCount=function(){return this.posConverter.GetViewRecordCount()};e.prototype.GetViewIndexOfRecord=function(e){return this.posConverter.RecordKeyToViewIdx(e)};e.prototype.GetRecordKeyByViewIndex=function(e){return this.posConverter.ViewIdxToRecordKey(e)};e.prototype.GetLeftColumnIndex=function(e){return this.paneMgr.GetLeftColumnIndex(e)};e.prototype.GetOutlineLevel=function(e){return this.controller.GetOutlineLevel(e)};e.prototype.ShowColumn=function(e,t){this.paneMgr.ShowColumn(e,t)};e.prototype.HideColumn=function(e){this.paneMgr.HideColumn(e)};e.prototype.EnsurePaneWidth=function(){this.paneMgr.EnsurePaneWidth()};e.prototype.RenameColumn=function(e){this.paneMgr.RenameColumn(e)};e.prototype.UpdateColumns=function(e){this.paneMgr.UpdateColumns(e)};e.prototype.GetColumns=function(e){return this.paneMgr.GetColumns(e)};e.prototype.GetSplitterPosition=function(){return this.paneMgr.GetSplitterPosition()};e.prototype.SetSplitterPosition=function(e){this.paneMgr.SetSplitterPosition(e)};e.prototype.AnyErrors=function(){return this.objBag.errorMgr.AnyErrors()};e.prototype.AnyErrorsInRecord=function(e){return this.objBag.errorMgr.AnyErrorsInRow(e)};e.prototype.SetCellError=function(e,t,n){return this.objBag.errorMgr.SetCellError(e,t,n)};e.prototype.SetRowError=function(e,t){return this.objBag.errorMgr.SetRowError(e,t)};e.prototype.ClearCellError=function(e,t,n){this.objBag.errorMgr.ClearCellError(e,t,n)};e.prototype.ClearAllErrorsOnCell=function(e,t){this.objBag.errorMgr.ClearAllErrorsOnCell(e,t)};e.prototype.ClearRowError=function(e,t){this.objBag.errorMgr.ClearRowError(e,t)};e.prototype.ClearAllErrorsOnRow=function(e){return this.objBag.errorMgr.ClearAllErrorsOnRow(e)};e.prototype.GetRowErrorMessage=function(e){return this.objBag.errorMgr.GetMessageForRow(e)};e.prototype.GetCellErrorMessage=function(e,t){return this.objBag.errorMgr.GetMessageForCell(e,t)};e.prototype.ScrollToAndExpandNextError=function(e,t){return this.objBag.paneMgr.ScrollToAndExpandNextError(e,null,t)};e.prototype.ScrollToAndExpandNextErrorOnRecord=function(e,t,r,i){n.JsGridUtil.DebugAssert(null!=t);return this.objBag.paneMgr.ScrollToAndExpandNextError(e,t,r,i)};e.prototype.GetFocusedItem=function(){return this.paneMgr.GetFocusedItemInfo()};e.prototype.SendKeyDownEvent=function(e){return this.objBag.focusMgr.HandleKeyDown(e)};e.prototype.JumpToEntryRecord=function(){this.paneMgr.JumpToEntryRecord()};e.prototype.SelectRowRange=function(e,t,n,r){this.paneMgr.Select(e,t,null,null,n,r)};e.prototype.SelectColumnRange=function(e,t,n,r){this.paneMgr.Select(null,null,e,t,n,r)};e.prototype.SelectCellRange=function(e,t,n,r,i,s){this.paneMgr.Select(e,t,n,r,i,s)};e.prototype.SelectRowRangeByKey=function(e,t,n,r){this.paneMgr.SelectByKey(e,t,null,null,n,r)};e.prototype.SelectColumnRangeByKey=function(e,t,n,r){this.paneMgr.SelectByKey(null,null,e,t,n,r)};e.prototype.SelectCellRangeByKey=function(e,t,n,r,i,s){this.paneMgr.SelectByKey(e,t,n,r,i,s)};e.prototype.ChangeKeys=function(e,t){this.objBag.controller.ChangeKeys(e,t)};e.prototype.GetSelectedRowRanges=function(e){return this.paneMgr.GetOrderedSelections(e,r.JsGridConstants.SelectionType.RowRange)};e.prototype.GetSelectedColumnRanges=function(e){return this.paneMgr.GetOrderedSelections(e,r.JsGridConstants.SelectionType.ColumnRange)};e.prototype.GetSelectedCellRanges=function(e){return this.paneMgr.GetOrderedSelections(e,r.JsGridConstants.SelectionType.CellRange)};e.prototype.GetSelectedRanges=function(e){return this.paneMgr.GetOrderedSelections(e,null)};e.prototype.MarkPropUpdateInvalid=function(e,t,n,r){return this.controller.MarkPropUpdateInvalid(e,t,n,r)};e.prototype.GetCurrentChangeKey=function(){return this.controller.GetCurrentChangeKey()};e.prototype.CreateAndSynchronizeToNewChangeKey=function(){var e=this.controller.CreateDataUpdateCmd();this.commandMgr.Execute(e,null,d.CommandManagerConstants.CommandType.Explicit);return e.GetChangeKey()};e.prototype.CreateDataUpdateCmd=function(e){return this.controller.CreateDataUpdateCmd(e)};e.prototype.IsChangeKeyApplied=function(e){return this.objBag.controller.IsChangeKeyApplied(e)};e.prototype.GetChangeKeyForVersion=function(e){return this.controller.GetChangeKeyForVersion(e)};e.prototype.TryReadPropForChangeKey=function(e,t,n){return this.controller.TryReadPropForChangeKey(e,t,n)};e.prototype.GetUnfilteredHierarchyMap=function(){return null};e.prototype.GetHierarchyState=function(e){return null};e.prototype.IsGroupingRecordKey=function(e){return!1};e.prototype.IsGroupingColumnKey=function(e){return!1};e.prototype.GetSelectedRecordKeys=function(e){return this.GetSelectedRecordKeysInternal(e)};e.prototype.CutToClipboard=function(){var e=this.objBag.selectionMgr.GetFocusedPane();null!=e&&this.objBag.cutcopypasteMgr.OnCut(e)};e.prototype.CopyToClipboard=function(){var e=this.objBag.selectionMgr.GetFocusedPane();null!=e&&this.objBag.cutcopypasteMgr.OnCopy(e)};e.prototype.PasteFromClipboard=function(){var e=this.objBag.selectionMgr.GetFocusedPane();null!=e&&this.objBag.cutcopypasteMgr.OnPaste(e)};e.prototype.TryRestoreFocusAfterInsertOrDeleteColumns=function(e){var t=this.objBag.selectionMgr.GetFocusedPane();null!=t&&t.TryRestoreFocusAfterInsertOrDeleteColumns(e)};e.prototype.GetUndoManager=function(){return this.commandMgr};e.prototype.GetVisibleRecordCount=function(){return this.objBag.paneMgr.GetVisibleRecordCount()};e.prototype.GetRecordIndicatorCheckBoxColumnIndex=function(){return this.objBag.paneMgr.GetRecordIndicatorCheckBoxColumnIndex()};e.prototype.IsRecordVisibleInView=function(e){return null!=this.posConverter.RecordKeyToViewIdx(e)};e.prototype.GetHierarchyQueryObject=function(){return null};e.prototype.StopEditing=function(){this.objBag.paneMgr.StopEditing(!1)};e.prototype.GetSelectedRecordKeysInternal=function(e){var t,n=this.GetSelectedRowRanges(),r=this.GetSelectedColumnRanges(),s=this.GetSelectedCellRanges();if(0!==r.length)t=this.tableCache.GetView();else if(e){t=[];for(var o=0;o<n.length;o++)t=t.concat(n[o].keys);for(o=0;o<s.length;o++)t=t.concat(s[o].rowRange.keys)}else{var u=new i.Set;for(o=0;o<n.length;o++)u.AddArray(n[o].keys);for(o=0;o<s.length;o++)u.AddArray(s[o].rowRange.keys);t=u.ToArray()}return t};e.prototype.StaticInit=function(){this._bStaticInit||(this._bStaticInit=!0)};e.prototype.GetOperationalUtility=function(){var e=this,t=function(t){return e.operationalConstantsFieldKeyMap[t]};return{GetFieldKey:t,GetProp:function(e,n){var r=t(n);return{fieldKey:r,prop:e.GetProp(r)}},GetValue:function(e,n){return e.GetDataValue(t(n))}}};e.prototype.CallAsyncFn=function(e,t){return n.JsGridUtil.Internal.CallAsyncFn(e,t,function(){this.Disable()},function(){this.Enable()})};e.prototype.DoLargeTask=function(e,t,r,i,s){var o=this,u=0;if(e>t){n.JsGridUtil._fixPasteNewRowPerfKillSwitchIsActive&&this.Disable();n.JsGridUtil.AsynchronousTaskManager.GetInstance().RegisterTask(function(){var s=(Math.floor(u/t)+1)*t;if((u=r(u,s))<e)return!0;n.JsGridUtil._fixPasteNewRowPerfKillSwitchIsActive&&o.Enable();i();return!1},s)}else{r(0,e);i()}};e.prototype.GetLocalizedString=function(e){e=e.charAt(0).toLowerCase()+e.substr(1);var t=this._jsGridParams.tableViewParams.messageOverrides;return t&&t[e]||SP.JsGrid.Res[e]};e.prototype.FireTestEvent=function(e){if(this.parentNode.fireEvent)switch(e){case this.TestEventType.Start:this.parentNode.fireEvent("onbeforeupdate");break;case this.TestEventType.Finish:this.parentNode.fireEvent("onafterupdate")}};e.prototype.SetEnabledState=function(e,t){if(e&&1==this.disableCount)this.loadingBanner.Hide();else if(!e){var r=null==t?SP.JsGrid.Res.loadingMsg:t;0==this.disableCount?this.loadingBanner.Show(r):this.loadingBanner.UpdateText(r)}this.disableCount-=e?1:-1;null!=this.objBag.ariaMgr&&this.objBag.ariaMgr.EnableGrid(e);n.JsGridUtil.DebugAssert(this.disableCount>=0)};e.prototype.GetSpCsrRenderCtx=function(){return this.spCsrRenderCtx};return e})();t.JsGridControl=v;var m=function(e){this.tableCache=null;this.name=null;this.bNotificationsEnabled=!1;this.styleManager=s.Style.getInstance().MakeJsGridStyleManager();this.minHeaderHeight=0;this.minRowHeight=0;this.commandMgr=new d.CommandManager(e.commandManagerParams);this.enabledRowHeaderAutoStates=(new i.Set).AddArray([r.JsGridConstants.RowHeaderAutoStyleId.Error]);this.isRTL="rtl"==n.JsGridUtil.Utility.GetDocumentDirection();this.tableViewParams=new g};t.JsGridControlParameters=m;var g=function(){this.keyFieldName=null;this.columns=null;this.gridFieldMap=null;this.messageOverrides=null;this.operationalConstantsFieldKeyMap=null;this.defaultEditMode=r.JsGridConstants.EditMode.ReadWriteDefer;this.allowedSelectionTypes=r.JsGridConstants.SelectionTypeFlags.MultipleCellRanges|r.JsGridConstants.SelectionTypeFlags.MultipleRowRanges|r.JsGridConstants.SelectionTypeFlags.MultipleColRanges;this.bMovableColumns=!0;this.bResizableColumns=!0;this.bHidableColumns=!0;this.bSortableColumns=!0;this.bAutoFilterableColumns=!0;this.bRowHeadersEnabled=!0;this.bRecordIndicatorCheckboxesEnabled=!1;this.bCreateFieldColumnEnabled=!1;this.bFillControlEnabled=!0;this.checkSelectionCheckboxHiddenRecordKeys=[];this.checkSelectionCheckboxDisabledRecordKeys=[];this.checkSelectionCheckedRecordKeys=[];this.bEditingEnabled=!1;this.bNewRowEnabled=!1;this.splitterPos=400;this.paneLayout=r.JsGridConstants.PaneLayout.GridOnly;this.ganttParams=null;this.pivotedGridParams=null;this.rowViewParams=new y};t.TableViewParameters=g;var y=function(){this.view=null;this.minimalInfo=null;this.topViewIdx=0;this.hierarchyMode=r.JsGridConstants.HierarchyMode.None;this.groupingLevel=null;this.groupingRecordKeyPrefix;this.autoFilterState=null;this.unfilteredHierarchyMgr=null;this.hierarchyDelayLoadKeys=null;this.hierarchyState=null;this.sortState=null;this.filterState=null;this.autoFilterEntries=null;this.filteredDescCounts=null};t.RowViewParameters=y;var b=function(){this.columns=null};t.PivotedGridParameters=b;var w=function(){this.dateRange=null;this.ganttBarStyles=null;this.ganttZoomLevel=3;this.fnRenderGanttRow=null;this.fnGetGanttBarDate=null;this.fnGetGanttBarStyleIds=null;this.fnGetPredecessors=null;this.workDayStart=n.JsGridUtil.SpRegionalSettings.workDayStart;this.workDayEnd=n.JsGridUtil.SpRegionalSettings.workDayEnd;this.fieldKeyRedrawFilter=null};t.GanttParameters=w});
define("bqe",["require","exports","Lqe","vqe","hqe","we"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.global_core=function(){(function(){var e=null,t=null,r=-1;function s(){if(null===e){e=new a;(function(){if(null!=t)return t;var e=(function(){var e=document.getElementById("notificationArea");if(null==e){(e=document.createElement("div")).id="notificationArea";var t=document.getElementById("contentBox");null!=t?t.appendChild(e):document.body.appendChild(e)}e.style.display="none";return(function(e){var t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");t.className="ms-trcnoti-border";n.className="ms-fullWidth";r.className="ms-trcnoti-host ms-fullWidth";n.appendChild(r);t.appendChild(n);e.appendChild(t);return{ctr:e,root:t,host:r}})(e)})(),n=e.ctr,r=e.host;t=new l(u.ContainerID.Basic,r,50);t.SetEventHandler(u.EventID.OnHide,function(e){n.style.display="none";e()});t.SetEventHandler(u.EventID.OnShow,function(e){n.setAttribute("aria-live","polite");n.setAttribute("aria-relevant","all");n.style.display="block";e()});t.SetEventHandler(u.EventID.OnDisplayNotification,function(e,t){(function(e){c(e,"ms-trcnoti-toast").innerHTML=e.strHtml})(e);var n=e.elm;n.style.top="0px";r.appendChild(n);t()});t.SetEventHandler(u.EventID.OnRemoveNotification,function(e,t){t()})})()}return e}a.prototype={Initialized:!1,Notifications:void 0,Containers:void 0,Initialize:void 0,AddNotification:void 0,AddContainer:void 0,DisposeNotification:void 0,SetExpireTimer:void 0,RetireNotificationInternal:void 0};a.prototype.Initialize=function(){if(!this.Initialized){this.Notifications={};this.Containers={};this.Initialized=!0}};a.prototype.Reset=function(){var e,t;for(t in this.Containers){(e=this.Containers[t]).Dispose();e.UnblockUpdatesInternal()}var n=r;r=-1;window.clearInterval(n)};a.prototype.AddNotification=function(e,t){var n=this.Containers[e];Sys.Debug.assert(null!=n,"[NotificationEngine.AddNotification] : Container ID is invalid ("+String(e)+")");t.container=n;this.Notifications[t.id]=t};a.prototype.AddContainer=function(e){this.Containers[e.id]=e};a.prototype.DisposeNotification=function(e){null!=this.Notifications[e.id]&&delete this.Notifications[e.id]};a.prototype.SetExpireTimer=function(e,t){var n=new Date;e.expires=n.valueOf()+t;-1==r&&(r=window.setInterval(function(){s().RetireNotificationInternal()},750))};a.prototype.RetireNotificationInternal=function(){var e=(new Date).valueOf(),t=!0,n=[];for(var i in this.Notifications){null!=(s=this.Notifications[i]).expires&&(e>s.expires?n.push(s):t=!1)}for(;n.length>0;){var s;(o=(s=n.shift()).container).RemoveNotification(s);o.pendingUpdate=!0}for(var i in this.Containers){var o;(o=this.Containers[i]).items.length>0&&(t=!1);if(Boolean(o.pendingUpdate)){o.Update();delete o.pendingUpdate}}if(t){var u=r;r=-1;window.clearInterval(u)}};f.prototype={id:void 0,elm:void 0,strHtml:void 0,strTooltip:void 0,bSticky:void 0,bIsAdd:void 0,bNoAnimate:void 0,bHidden:void 0,onclickHandler:void 0,container:void 0,extraData:void 0,expires:void 0,ariaLiveAttribute:void 0};f.prototype.Initialize=function(e,t,n,r,o,u,a){var f="notification_"+String(i.getUniqueIndex()),l=document.createElement("span");l.id=f;this.id=f;this.bIsAdd=!0;this.elm=l;this.strHtml=t;this.extraData=u;this.bSticky=n;this.strTooltip=r;this.onclickHandler=o;this.bHidden=!1;this.ariaLiveAttribute=a;s().AddNotification(e,this)};f.prototype.Show=function(e){1==Boolean(e)&&(this.bNoAnimate=!0);this.container.AddNotification(this)};f.prototype.Hide=function(e){1==Boolean(e)&&(this.bNoAnimate=!0);this.container.RemoveNotification(this)};l.prototype={id:void 0,element:void 0,bIsShown:void 0,bIsBlocked:void 0,nDisposalState:void 0,nNotificationLayer:25,notificationDisplayDuration:7e3,nMaxNotifications:20,events:void 0,items:void 0,pending:void 0,blockedUpdates:void 0};l.prototype.Initialize=function(e,t,n,r){this.id=e;this.element=t;this.events=new Array(o);this.bIsShown=!1;this.nNotificationLayer=n;this.bIsBlocked=!1;this.items=[];this.pending=[];this.blockedUpdates=[];this.nDisposalState=0;var i=this;this.items.add=function(e){this.push(e);i.FireEvent(u.EventID.OnNotificationCountChanged)};this.items.remove=function(e){var t,n;for(t=0,n=this.length;t<n;t++)if(e.id==this[t].id){this.splice(t,1);i.FireEvent(u.EventID.OnNotificationCountChanged);return!0}return!1};null!=r&&(this.nMaxNotifications=r);s().AddContainer(this)};l.prototype.Dispose=function(){if(!(this.nDisposalState>0)){this.nDisposalState=1;this.Clear()}};l.prototype.AddNotification=function(e){Sys.Debug.assert(e.container.id==this.id,"[AddNotification] : Notification does not match container! Expected: "+String(this.id)+"; Actual: "+String(e.container.id));var t,n;for(t=0,n=this.items.length;t<n;t++)if(e.id==this.items[t].id)return;if(this.GetCount()<this.nMaxNotifications){e.bHidden=!1;e.elm.style.display=""}else{e.bHidden=!0;e.elm.style.display="none"}this.items.add(e);var r=this,i=function(){Boolean(e.bSticky)||s().SetExpireTimer(e,r.notificationDisplayDuration);r.bIsShown||r.Show();r.FireEvent(u.EventID.OnDisplayNotification,e,function(){r.Update();return!0});r.Update()};this.bIsBlocked&&0===this.nDisposalState?this.pending.push(i):i()};l.prototype.RemoveNotification=function(e){if(!1!==e.bIsAdd){e.bIsAdd=!1;Sys.Debug.assert(e.container.id==this.id,"[RemoveNotification] : Notification does not match container! Expected: "+String(this.id)+"; Actual: "+String(e.container.id));var t,n,r=!1;for(t=0,n=this.pending.length;t<n;t++)if(e.id==this.pending[t].id){this.pending.splice(t,1);r=!0}if(r)this.items.remove(e);else{var i=this,o=function(){i.FireEvent(u.EventID.OnRemoveNotification,e,function(){try{i.items.remove(e);var t=e.elm;i.element.removeChild(t)}catch(e){}s().DisposeNotification(e);i.Update();return!0});i.Update()};this.bIsBlocked&&0===this.nDisposalState?this.pending.push(o):o()}}};l.prototype.ShowAllNotifications=function(){var e,t,n=this.items;for(e=0,t=n.length;e<t;e++){var r=n[e];if(r.bHidden){r.bHidden=!1;r.elm.style.display=""}}};l.prototype.Update=function(){this.element.hasChildNodes()||0!=this.items.length||this.Hide();if(this.bIsShown)for(var e in s().Containers)this.BlockUpdatesInternal(s().Containers[e])};l.prototype.Clear=function(e){for(var t=this.items,n=t.length-1;n>=0;n--){var r=t[n];if(Boolean(r)&&r.bIsAdd){Boolean(e)&&(r.bNoAnimate=!0);this.RemoveNotification(r)}}};l.prototype.GetCount=function(){return this.items.length};l.prototype.GetHiddenCount=function(){var e,t,n=0,r=this.items;for(e=0,t=r.length;e<t;e++){r[e].bHidden&&n++}return n};l.prototype.SetEventHandler=function(e,t){if(null!=this.events[e])throw"Event handler already specified for eventId "+String(e)+". ContainerId: "+String(this.id);this.events[e]=t};l.prototype.FireEvent=function(e){if(e>o)throw"Invalid eventId "+String(e)+". ContainerId: "+String(this.id);if(null!=this.events[e]){var t=this.events[e];Array.prototype.shift.call(arguments);Sys.Debug.assert(arguments.length<=2,"[FireEvent] : Too many arguments passed to callback. Expected <= 2; Actual: "+String(arguments.length));t.apply(null,arguments)}};l.prototype.Show=function(){if(!this.bIsShown){this.bIsShown=!0;var e=this;this.FireEvent(u.EventID.OnShow,function(){e.Update();return!0})}};l.prototype.Hide=function(){if(this.bIsShown){this.bIsShown=!1;for(;this.element.hasChildNodes();)this.element.removeChild(this.element.firstChild);var e=this;this.FireEvent(u.EventID.OnHide,function(){if(0==e.nDisposalState){e.UnblockUpdatesInternal();e.Update()}else if(1==e.nDisposalState){e.nDisposalState=2;e.FireEvent(u.EventID.OnDisposing)}return!0})}};l.prototype.BlockUpdatesInternal=function(e){if(!(e.nNotificationLayer>this.nNotificationLayer||e.id==this.id)){var t,n,r=!1;for(t=0,n=this.blockedUpdates.length;t<n;t++)if(e.id==this.blockedUpdates[t].id){r=!0;break}if(!r){e.bIsBlocked=!0;this.blockedUpdates.push(e)}}};l.prototype.UnblockUpdatesInternal=function(){for(;this.blockedUpdates.length>0;){var e=this.blockedUpdates.shift();e.bIsBlocked=!1;for(;e.pending.length>0;){e.pending.shift()()}e.Update()}};var c=function(e,t){var r=e.elm,i=e.onclickHandler,s=e.strTooltip,o=e.bNoAnimate;r.className="ms-trcnoti-base";e.bNoAnimate||n.JsGridUtil.Internal.DomElement.GetInstance().SetOpacity(r,0);var u=document.createElement("div");u.className="ms-trcnoti-bg";"function"==typeof AttachEvent&&AttachEvent("click",function(){null!=i&&i();h(r.id,o);return!1},u);var a=document.createElement("div");a.className=t;u.appendChild(a);r.appendChild(u);Boolean(s)&&(r.title=s);r.setAttribute("role","alert");if(Boolean(e.ariaLiveAttribute)&&Boolean(e.container)){var f=e.container.element;Boolean(f)&&f.setAttribute("aria-live",e.ariaLiveAttribute)}return a};function h(e,t){var n=s().Notifications[e];Boolean(n)&&n.Hide(t)}window.addNotification=function(e,t,n,r,i){var s=new f(u.ContainerID.Basic,e,t,n,r);s.Show(i);return s.id};window.removeNotification=h})()};var o=5,u={ContainerID:{Basic:0,Status:1},EventID:{OnShow:0,OnHide:1,OnDisplayNotification:2,OnRemoveNotification:3,OnNotificationCountChanged:4,OnDisposing:5}};function a(){this.Initialize()}function f(e,t,n,r,i,s,o){this.Initialize(e,t,n,r,i,s,o)}function l(e,t,n,r){this.Initialize(e,t,n,r)}t.deleteSelectedItemsCore=function(e,t,n,o,u,a){e=(function(e){if(Boolean(e)&&void 0===e.clvp&&void 0!==e.ctxId){var t=window["ctx"+e.ctxId];if(t)return t}return e})(e);var f=t.length,l=e.clvp;l.EnsureChangeContext(a);var c=null,h=null;if(!((function(e){for(var t in e){var n=e[t];if(Boolean(n)&&void 0!==n.id&&Boolean(n.id)){var r=n.id;if(-1!=r.indexOf(".0.")||-1!=r.indexOf(".1.")||-1!=r.indexOf(".2."))return!0}}return!1})(t)||f<=0)){if(!Boolean(u)){var p="undefined"!=typeof Strings?Strings.STS.L_STSRecycleConfirm_Text:"";Boolean(e.RecycleBinEnabled)&&!e.ExternalDataList||(p="undefined"!=typeof Strings?Strings.STS.L_STSDelConfirm_Text:"");null!=e.overrideDeleteConfirmation&&(p=e.overrideDeleteConfirmation);Boolean(e.HasRelatedCascadeLists)&&null!=e.CascadeDeleteWarningMessage&&(p=e.CascadeDeleteWarningMessage+p);if(Boolean(e.HasRelatedCascadeLists)&&171==e.listTemplate){var d=!1,v=0;if(e.inGridMode){var m=window[g_SPGridInitInfo[e.view].controllerId];Sys.Debug.assert(null!=m);for(v=0;v<f;v++)if(m.IsParent(t[v])){d=!0;break}}else{var g=null!=r.GetClientHierarchyManagerForWebpart?r.GetClientHierarchyManagerForWebpart(e.wpq):null;if(null!=g)for(v=0;v<f;v++)if(g.IsParent(t[v])){d=!0;break}}p=d?"undefined"!=typeof Strings?Strings.STS.L_STSDelConfirmParentTask:"":"undefined"!=typeof Strings?Strings.STS.L_STSDelConfirm_Text:""}var y=(function(e,t){if(Boolean(ctx)&&Boolean(t)&&t.length>0&&Boolean(e)&&Boolean(e.ListData)){var n={},r=e.ListData.Row;if(Boolean(r)){for(var s=0;s<r.length;s++){var o=r[s];i.IsMountPoint(o)&&(n[o.ID]=o["FileLeafRef.Name"])}var u=null;for(var a in t){var f=t[a];if(Boolean(n[f])){null==u&&(u={});u[f]=n[f]}}return u}}return null})(l.ctx,t);if(Boolean(y)&&1===f){var b=y[t[0]];p=s.format("undefined"!=typeof Strings?Strings.STS.L_RemoveMountPointConfirmation:"",b)}if(!confirm(p))return}if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(l.ctx.RealHttpRoot)){h=new SP.ExceptionHandlingScope(l.cctx).startScope();c=new SP.RemoteWeb(l.cctx,l.ctx.HttpRoot);h.dispose()}for(var w=0;w<f;w++){var E=t[w];l.DeleteItemCore(String(E),c)}l.pendingItems=[];if(f>0){var S="undefined"!=typeof Strings?Strings.STS.L_Notification_Delete:"",x=addNotification(S,!0);l.cctx.executeQueryAsync(function(){if(void 0!==l.rgehs){if(1==l.rgehs.length&&l.rgehs[0].get_serverErrorCode()==SP.ClientErrorCodes.redirect&&"function"==typeof GoToPage){GoToPage(l.rgehs[0].get_serverErrorValue());return}removeNotification(x);l.ShowErrorDialog(n)}else null!=n&&n()},function(e,t){removeNotification(x);void 0!==l.rgehs&&l.ShowErrorDialog(o)})}}};t._CLVPDeleteItemCore=function(e,t,n){var r=1==e.ctx.listBaseType;e.EnsureChangeContext();var i,s,o=null;void 0===e.rgehs&&(e.rgehs=[]);i=new SP.ExceptionHandlingScope(e.cctx);e.rgehs.push(i);s=i.startScope();e.cctx.get_pendingRequest().set_navigateWhenServerRedirect(!0);var u=null;u=(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(e.ctx.RealHttpRoot)?n.getListById(e.ctx.listName):e.cctx.get_web().get_lists().getById(e.ctx.listName);o=e.ctx.ExternalDataList?u.getItemById(String(t)):u.getItemById(parseInt(t));if(r){o.retrieve("FileLeafRef");i.itmContext=o}Boolean(e.ctx.RecycleBinEnabled)&&!e.ctx.ExternalDataList?o.recycle():o.deleteObject();e.changePending=!0;s.dispose()};t._CLVPShowErrorDialog=function(e,t,n){var r,i=[],s=null,o=!1;function u(e,t,n){var r="s4-dlg-err-itm";if(!t){r="s4-dlg-err-firstitm";n.push(SP.Res.dlgTitleError)}var i=e.get_errorMessage();n.push('<div class="'+r+'">');if(void 0!==e.itmContext)try{n.push('<div class="s4-dlg-err-itmName">');n.push(e.itmContext.get_item("FileLeafRef"));n.push("</div>")}catch(e){n.push("</div>")}n.push('<div class="s4-dlg-err-itmMsg">');n.push(i);n.push("</div>");n.push("</div>")}if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(n)&&n.get_hasException()){u(n,o,i);o=!0}for(r in e.rgehs){var a=e.rgehs[r];if(a.get_hasException()&&(171!=e.ctx.listTemplate||-2147024809!=a.get_serverErrorCode())){u(a,o,i);o=!0}}if(o){i.push("<div class='ms-core-form-bottomButtonBox' id='dlgDivButton'><button id='ms-OKBtnDismissDlg' class='ms-ButtonHeightWidth' onclick='DismissErrDlg(this)'>");i.push(SP.Res.okButtonCaption);i.push("</button></div>")}var f=i.join("");if(f.length>0){var l=document.createElement("DIV");l.className="s4-dlg-err";l.innerHTML=f;var c={html:l,title:"undefined"!=typeof Strings?Strings.STS.L_ErrorDialog_Title:"",dialogReturnValueCallback:t};SP.UI.ModalDialog.showModalDialog(c);s=document.getElementById("ms-OKBtnDismissDlg");Boolean(s)&&s.focus()}else"function"==typeof t&&t();e.rgehs=[]}});
define("hqe",["require","exports","Lqe","k"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k=r.Killswitch.isActivated("042F9C52-243F-407C-8752-4E8F7D7623B1","5/13/2020","Make sure to check the ListModule object presence on the window because some 3rd party code can already instantiate the object"),L="_mpSPSiteId",A="_mpSPWebId",O="_mpItemUniqueId";t.globalInit=function(){window.RegisterModuleInit=j;window.commonShowModalDialog=z;window.ExecuteAndRegisterBeginEndFunctions=H;window.ExecuteOrDelayUntilScriptLoaded=q;window.currentCtx=null;window._dlgWndTop=U;window.ctx=void 0;window.setInnerText=V;window.GetImageUrlWithRevision=$;window.IsFullNameDefined=Y;void 0===i&&((i={__namespace:!0}).IsActive=function(e){var t=window.g_SPOffSwitches,n=null;if(null==t){var r=window._spPageContextInfo;n=null==r?null:r.killSwitches;t=n}null==t||t.hasOwnProperty("C1AF433B-A979-4DD9-8C60-56024438168A")||e&&(e=e.toUpperCase().replace(/[{}]/g,""));return null!=t&&t.hasOwnProperty(e)});window.OffSwitch=i;if(void 0===s){s={__namespace:!0};(function(){s.MismatchError=function(e,t,n){Error.call(this,n);this.expected=e;this.actual=t};s.MismatchError.prototype=new Error;s.ArgumentTypeError=function(e,t){s.MismatchError.call(this,e,t,"runtime type mismatch")};s.ArgumentTypeError.prototype=new s.MismatchError})()}void 0===o&&(o={__namespace:!0});void 0===u&&(u={__namespace:!0});void 0===a&&(a={__namespace:!0});(function(){t.prototype={firefox:void 0,firefox36up:void 0,firefox3up:void 0,firefox4up:void 0,ie:void 0,ie55up:void 0,ie5up:void 0,ie7down:void 0,ie8down:void 0,ie8standard:void 0,ie8standardUp:void 0,ie9down:void 0,ie9standardUp:void 0,ipad:void 0,windowsphone:void 0,chrome:void 0,chrome7up:void 0,chrome8up:void 0,chrome9up:void 0,iever:void 0,mac:void 0,major:void 0,msTouch:void 0,isTouch:void 0,nav:void 0,nav6:void 0,nav6up:void 0,nav7up:void 0,osver:void 0,safari:void 0,safari125up:void 0,safari3up:void 0,verIEFull:void 0,w3c:void 0,webKit:void 0,win:void 0,win8AppHost:void 0,win32:void 0,win64bit:void 0,winnt:void 0,armProcessor:void 0};e.prototype=t.prototype;e.prototype.ie10standardUp=void 0;e.prototype.ie11=void 0;e.prototype.ie11up=void 0;e.prototype.msEdge=void 0;function e(){var e,t=navigator.userAgent.toLowerCase();this.osver=1;if(Boolean(t)){var n=t.substring(t.indexOf("windows ")+11);this.osver=parseFloat(n)}this.major=parseInt(navigator.appVersion);this.msEdge=-1!=t.indexOf("edge/");var r=t.indexOf("msie"),i=t.indexOf("trident");this.ie=-1!=r||-1!=i;var s="0";if(this.ie)if(-1!=r)s=t.substring(r+5);else{var o=t.indexOf("rv:");-1!=o&&(s=t.substring(o+3))}this.iever=parseInt(s);this.verIEFull=parseFloat(s);this.ie4up=this.ie&&this.major>=4;this.ie5up=this.ie&&this.iever>=5;this.ie55up=this.ie&&this.verIEFull>=5.5;this.ie6up=this.ie&&this.iever>=6;this.ie7down=this.ie&&this.iever<=7;this.ie8down=this.ie&&this.iever<=8;this.ie9down=this.ie&&this.iever<=9;this.ie7up=this.ie&&this.iever>=7;this.ie8standard=this.ie&&Boolean(document.documentMode)&&8==document.documentMode;this.ie8standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=8;this.ie9standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=9;this.ie10standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=10;this.ie11=this.ie&&Boolean(document.documentMode)&&11==document.documentMode;this.ie11up=this.ie&&Boolean(document.documentMode)&&document.documentMode>=11;this.nav=-1!=t.indexOf("mozilla")&&-1==t.indexOf("spoofer")&&-1==t.indexOf("compatible")&&!this.ie;this.nav6=this.nav&&5==this.major;this.nav6up=this.nav&&this.major>=5;this.nav7up=!1;this.nav6up&&(e=t.indexOf("netscape/"))>=0&&(this.nav7up=parseInt(t.substring(e+9))>=7);this.winnt=-1!=t.indexOf("winnt")||-1!=t.indexOf("windows nt");this.win32=this.major>=4&&"Win32"==navigator.platform||-1!=t.indexOf("win32")||-1!=t.indexOf("32bit");this.win64bit=-1!=t.indexOf("win64");this.win=this.winnt||this.win32||this.win64bit;this.safari=-1!=t.indexOf("webkit")&&!this.ie&&!this.msEdge;this.safari125up=!1;this.safari3up=!1;if(this.safari&&this.major>=5){(e=t.indexOf("webkit/"))>=0&&(this.safari125up=parseInt(t.substring(e+7))>=125);var u=t.indexOf("version/");u>=0&&(this.safari3up=parseInt(t.substring(u+8))>=3)}this.firefox=this.nav&&-1!=t.indexOf("firefox");this.firefox3up=!1;this.firefox36up=!1;this.firefox4up=!1;if(this.firefox&&this.major>=5){var a=t.indexOf("firefox/");if(a>=0){var f=t.substring(a+8);this.firefox3up=parseInt(f)>=3;this.firefox36up=parseFloat(f)>=3.6;this.firefox4up=parseInt(f)>=4}}this.chrome=this.nav&&-1!=t.indexOf("chrome")&&!this.ie&&!this.msEdge;this.chrome7up=!1;this.chrome8up=!1;this.chrome9up=!1;if(this.chrome&&this.major>=5){var l=t.indexOf("chrome/");if(l>=0){var c=t.substring(l+7),h=parseInt(c);this.chrome7up=h>=7;this.chrome8up=h>=8;this.chrome9up=h>=9}}this.ipad=-1!=t.indexOf("ipad");this.windowsphone=-1!=t.indexOf("windows phone");this.aol=this.ie&&-1!=t.indexOf(" aol ");this.mac=-1!=t.indexOf("mac");this.w3c=this.nav6up;this.webKit=-1!=t.indexOf("webkit")&&!this.ie&&!this.msEdge;this.win8AppHost=-1!=t.indexOf("msapphost");this.msTouch=void 0!==navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>0;this.isTouch=this.msTouch||"ontouchstart"in document.documentElement;this.armProcessor=-1!=t.indexOf("arm")}function t(){var e,t=navigator.userAgent.toLowerCase();this.osver=1;if(Boolean(t)){var n=t.substring(t.indexOf("windows ")+11);this.osver=parseFloat(n)}this.major=parseInt(navigator.appVersion);this.nav=-1!=t.indexOf("mozilla")&&-1==t.indexOf("spoofer")&&-1==t.indexOf("compatible");this.nav6=this.nav&&5==this.major;this.nav6up=this.nav&&this.major>=5;this.nav7up=!1;this.nav6up&&(e=t.indexOf("netscape/"))>=0&&(this.nav7up=parseInt(t.substring(e+9))>=7);this.ie=-1!=t.indexOf("msie");this.ipad=-1!=t.indexOf("ipad");this.windowsphone=-1!=t.indexOf("windows phone");this.aol=this.ie&&-1!=t.indexOf(" aol ");if(this.ie){var r=t.substring(t.indexOf("msie ")+5);this.iever=parseInt(r);this.verIEFull=parseFloat(r)}else this.iever=0;this.ie4up=this.ie&&this.major>=4;this.ie5up=this.ie&&this.iever>=5;this.ie55up=this.ie&&this.verIEFull>=5.5;this.ie6up=this.ie&&this.iever>=6;this.ie7down=this.ie&&this.iever<=7;this.ie8down=this.ie&&this.iever<=8;this.ie9down=this.ie&&this.iever<=9;this.ie7up=this.ie&&this.iever>=7;this.ie8standard=this.ie&&Boolean(document.documentMode)&&8==document.documentMode;this.ie8standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=8;this.ie9standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=9;this.ie10standardUp=this.ie&&Boolean(document.documentMode)&&document.documentMode>=10;this.winnt=-1!=t.indexOf("winnt")||-1!=t.indexOf("windows nt");this.win32=this.major>=4&&"Win32"==navigator.platform||-1!=t.indexOf("win32")||-1!=t.indexOf("32bit");this.win64bit=-1!=t.indexOf("win64");this.win=this.winnt||this.win32||this.win64bit;this.mac=-1!=t.indexOf("mac");this.w3c=this.nav6up;this.webKit=-1!=t.indexOf("webkit");this.safari=-1!=t.indexOf("webkit");this.safari125up=!1;this.safari3up=!1;if(this.safari&&this.major>=5){(e=t.indexOf("webkit/"))>=0&&(this.safari125up=parseInt(t.substring(e+7))>=125);var i=t.indexOf("version/");i>=0&&(this.safari3up=parseInt(t.substring(i+8))>=3)}this.firefox=this.nav&&-1!=t.indexOf("firefox");this.firefox3up=!1;this.firefox36up=!1;this.firefox4up=!1;if(this.firefox&&this.major>=5){var s=t.indexOf("firefox/");if(s>=0){var o=t.substring(s+8);this.firefox3up=parseInt(o)>=3;this.firefox36up=parseFloat(o)>=3.6;this.firefox4up=parseInt(o)>=4}}this.win8AppHost=-1!=t.indexOf("msapphost");this.chrome=this.nav&&-1!=t.indexOf("chrome");this.chrome7up=!1;this.chrome8up=!1;this.chrome9up=!1;if(this.chrome&&this.major>=5){var u=t.indexOf("chrome/");if(u>=0){var a=t.substring(u+7),f=parseInt(a);this.chrome7up=f>=7;this.chrome8up=f>=8;this.chrome9up=f>=9}}this.msTouch=void 0!==navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>0;this.isTouch=this.msTouch||"ontouchstart"in document.documentElement;this.armProcessor=-1!=t.indexOf("arm")}"undefined"!=typeof _browserisFlight?a.userAgent=new e:a.userAgent=new t})();void 0===f&&(f={__namespace:!0});if(void 0===l){l={__namespace:!0};(function(){l.rightToLeft="rtl"==document.documentElement.dir;l.GetElementsByName=function(e){var t;0==(t=document.getElementsByName(e)).length&&Boolean(XMLHttpRequest)&&(t=(function(e,t){var n,r=[],i=e.getElementById(t);for(;null!=i;){r.push(i);i.id="";i=e.getElementById(t)}for(n=0;n<r.length;n++)r[n].id=t;return r})(document,e));return t};l.AddEventHandler=function(e,t,n,r){if(Boolean(e.addEventListener)){r=void 0!==r&&null!=r&&r;e.addEventListener(t.substr(2),n,r)}else Boolean(e.attachEvent)&&e.attachEvent(t,n)}})()}if(void 0===c){c={__namespace:!0};(function(){c.HtmlEncode=function(e){if(null==e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charAt(r);switch(s){case"<":n.push("&lt;");break;case">":n.push("&gt;");break;case"&":n.push("&amp;");break;case'"':n.push("&quot;");break;case"'":n.push("&#39;");break;default:n.push(s)}}return n.join("")};c.HtmlEncodeEx=function(e){if(null==e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charAt(r);switch(s){case"<":n.push("&lt;");break;case">":n.push("&gt;");break;case"&":n.push("&amp;");break;case'"':n.push("&quot;");break;case"'":n.push("&#39;");break;case"#":n.push("%23");break;case"%":n.push("%25");break;default:n.push(s)}}return n.join("")};c.ScriptEncode=function(e){if(null==e||void 0===e)return"";var t=new String(e),n=[],r=0,i=t.length;for(r=0;r<i;r++){var s=t.charCodeAt(r);if(s>4095)n.push("\\u"+s.toString(16).toUpperCase());else if(s>255)n.push("\\u0"+s.toString(16).toUpperCase());else if(s>127)n.push("\\u00"+s.toString(16).toUpperCase());else{var o=t.charAt(r);switch(o){case"\n":n.push("\\n");break;case"\r":n.push("\\r");break;case'"':n.push("\\u0022");break;case"%":n.push("\\u0025");break;case"&":n.push("\\u0026");break;case"'":n.push("\\u0027");break;case"(":n.push("\\u0028");break;case")":n.push("\\u0029");break;case"+":n.push("\\u002b");break;case"/":n.push("\\u002f");break;case"<":n.push("\\u003c");break;case">":n.push("\\u003e");break;case"\\":n.push("\\\\");break;default:n.push(o)}}}return n.join("")}})()}window.Encoding=c;void 0===h&&(h={__namespace:!0});if(void 0===p){p={__namespace:!0};(function(){p.arrayIndexOf=function(e,t,n){if(void 0!==Array.prototype.indexOf)return e.indexOf(t,n);if(void 0===t)return-1;var r=e.length;if(0!==r){n-=0;if(isNaN(n))n=0;else{isFinite(n)&&(n-=n%1);n<0&&(n=Math.max(0,r+n))}for(var i=n;i<r;i++)if(void 0!==e[i]&&e[i]===t)return i}return-1};p.attachDOMContentLoaded=function(e){void 0===document.addEventListener?document.onreadystatechange=function(){"complete"==document.readyState&&e()}:document.addEventListener("DOMContentLoaded",e,!1)}})()}if(void 0===d){d={__namespace:!0};(function(){d.BuildParam=function(e){var t,n;for(n=1;n<arguments.length;n++){t=new RegExp("\\^"+String(n));e=e.replace(t,arguments[n])}return e};d.IsGuid=function(e){return/^((\{[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}\})|([0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}))$/i.test(e)}})()}void 0===v&&(v={__namespace:!0});m=function(e,t){var n=this,r=!1;void 0!==t&&"boolean"==typeof t.queryCaseInsensitive&&(r=t.queryCaseInsensitive);var i=!1;void 0!==t&&"boolean"==typeof t.disableEncodingDecodingForLegacyCode&&(i=t.disableEncodingDecodingForLegacyCode);var s="",o="",u={};this.setQuery=function(e){var t=a(e);n.setQueryFromObject(t)};this.getQueryAsObject=function(){return u};this.setQueryFromObject=function(e){u={};for(var t in e)e.hasOwnProperty(t)&&n.setQueryParameter(t,e[t])};this.getQueryParameter=function(e){var t=null,i=n.getQueryAsObject();if(r)for(var s in i)u.hasOwnProperty(s)&&s.toLowerCase()===e.toLowerCase()&&(t=i[s]);else t=i[e];return void 0!==t?t:null};this.setQueryParameter=function(e,t){var n=p(e),r=p(t);u[n]=r};var a=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var n=e.split(/[;&]+/),r=0;r<n.length;r++){var i=n[r].split("=");if(i.length>0){var s=i[0];if(s.length>0){var o="";2==i.length&&(o=i[1]);t[s]=o}}}return t},f=function(e){o=e;var t=e.lastIndexOf("@");t>=0&&(o=o.substring(t+1));var n=o.indexOf(":");if(!(t<0&&n<0)){var r=e;if(t<0)o=r;else{s=r.substring(0,t);o=r.substring(t+1)}n>=0&&(o=o.substring(0,n));s=p(s);o=p(o)}},l=function(e){for(var t=e.split("/"),n=0;n<t.length;++n){var r=t[n].split(";"),i=p(r[0]);t[n]=h(i);for(var s=1;s<r.length;++s){var o=p(r[s]);t[n]+=";"+h(o)}}},c=function(e,t){for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<t.length;i++)if(r===t[i])return n;return-1},h=function(e){return i?e:encodeURIComponent(e)},p=function(e){return i?e:m.decodeURIComponent(e)};(function(){var t=e,r=t.indexOf("#");if(r>=0){var i=t.substring(r+1);n.setFragment(i);t=t.substring(0,r)}var s=c(t,";/?:@&=$,");if(s>=0){var o=t.indexOf(":");o>=0&&o===s&&(t=t.substring(s+1));var u="",a=t.indexOf("//");if(a>=0&&0===a){t=t.substring(2);var h,p=c(t,"/?");if(p>=0){u=t.substring(0,p);t=t.substring(p);h=!1}else{u=t;h=!0}f(u);if(h)return}var d=t.indexOf("?");if(d>=0){n.setQuery(t.substring(d+1));t=t.substring(0,d)}l(t)}else l(t)})()};(function(){var e=[0,128,2048,65536,2097152,67108864,2147483648];function t(t){for(var n,r,i,s,o=0,u="";o<t.length;)if(t[o]<=127)u+=String.fromCharCode(t[o++]);else{r=t[o++];s=i=Boolean(32&r)?Boolean(16&r)?3:2:1;n=r&255>>>2+i;for(;Boolean(i)&&o<t.length;){--i;if(0==(r=t[o++]))return u;if(128!=(192&r)){u+="?";break}n=n<<6|63&r}if(Boolean(i)){u+="?";break}if(n<e[s]){u+="?";break}if(n<=65535)u+=String.fromCharCode(n);else if(n<=1114111){n-=65536;u+=String.fromCharCode(55296|n>>>10);u+=String.fromCharCode(56320|1023&n)}else u+="?"}return u}function n(e){var n=null;try{n=decodeURIComponent(e)}catch(r){n=(function(e){if(null==e)return"null";var n,r,i=0,s=0,o="",u=[],a=0;for(;i<e.length;)if("%"==e.charAt(i))if("u"==e.charAt(++i)){n="";for(s=0;s<4&&i<e.length;++s)n+=e.charAt(++i);for(;n.length<4;)n+="0";r=parseInt(n,16);isNaN(r)?o+="?":o+=String.fromCharCode(r)}else{n="";for(s=0;s<2&&i<e.length;++s)n+=e.charAt(i++);for(;n.length<2;)n+="0";r=parseInt(n,16);if(isNaN(r)){if(Boolean(a)){o+=t(u);a=0;u.length=a}o+="?"}else u[a++]=r}else{if(Boolean(a)){o+=t(u);a=0;u.length=a}o+=e.charAt(i++)}if(Boolean(a)){o+=t(u);a=0;u.length=a}return o})(e)}return n}m.decodeURIComponent=n;m.getAbsolute=function(e){var t=document.createElement("a");t.href=e;var n=t.href;t=null;return n};m.removeKeyValue=function(e,t){var n=new RegExp(e+"=[^&]*&");t=t.replace(n,"");n=new RegExp(e+"=[^&]*");return t=t.replace(n,"")};m.removeParameters=function(e){var t=e.indexOf("?");return-1==t?e:e.substr(0,t)};m.removeQueryParameter=function(e,t){var n=e.indexOf("?"),r=e.indexOf("#");if(-1==n)return e;-1==r&&(r=e.length);if(r<=n)return e;var i=e.substr(n,r-n),s=new RegExp("[&?]"+t+"=[^&]*","");(i=i.replace(s,"")).length>0&&"&"==i[0]&&(i="?"+i.substr(1));return e.substr(0,n)+i+e.substr(r)};m.completeDecode=function(e){if(void 0===e||null==e)return e;for(var t=e,r=n(t);t!=r;)r=n(t=r);return t};m.restructureFilterUrl=function(e,t){var n=t+1,r=e.match(new RegExp("FilterField"+String(n)+"=[^&]*")),i=!1;Boolean(r)||(i=null!=(r=e.match(new RegExp("FilterFields"+String(n)+"=[^&]*"))));for(var s=t;null!=r;s++){var o=i?"FilterFields"+String(s):"FilterField"+String(s),u=i?"FilterFields"+String(n):"FilterField"+String(n);e=e.replace(u,o);o=i?"FilterValues"+String(s):"FilterValue"+String(s);u=i?"FilterValues"+String(n):"FilterValue"+String(n);e=e.replace(u,o);o="FilterOp"+String(s);u="FilterOp"+String(n);e=e.replace(u,o);o="FilterLookupId"+String(s);u="FilterLookupId"+String(n);e=e.replace(u,o);o="FilterData"+String(s);u="FilterData"+String(n);n++;r=(e=e.replace(u,o)).match(new RegExp("FilterField"+String(n)+"=[^&]*"));Boolean(r)||(r=e.match(new RegExp("FilterFields"+String(n)+"=[^&]*")))}return e};m.parseMultiColumnValue=function(e,t,n){var r,i=[];null==t&&(t=";#");var s=t.charCodeAt(0),o=t.charCodeAt(1);if(null==e||0==e.length)return i;var u=t.charAt(0),a=new RegExp(u+u,"g"),f=t.charAt(0),l=0;if(e.substr(0,2)==t){Boolean(n)&&i.push("");l=2}for(var c=l,h=!1,p=e.length;c<p;){var d=e.indexOf(u,c);if(d>=0){c=d;c++;if(e.charCodeAt(c)==o){if(c-1>l){r=e.substr(l,c-l-1);h&&(r=r.replace(a,f));i.push(r);h=!1}else i.push("");l=++c;continue}if(e.charCodeAt(c)==s){c++;h=!0;continue}throw"ArgumentException"}c=p}if(c>l){r=e.substr(l,c-l);h&&(r=r.replace(a,f));i.push(r)}else Boolean(n)&&i.push("");return i};m.convertMultiColumnValueToString=function(e,t,n){null==t&&(t=";#");null==n&&(n=!0);for(var r=t.charAt(0),i=r+r,s=new RegExp(t.charAt(0),"g"),o=!1,u="",a=0;a<e.length;a++){var f=e[a];null!=f&&f.length>0&&(f=f.replace(s,i));null!=f&&f.length>0&&(o=!0);(n||0!=a)&&(u+=t);u+=f}if(o){n&&(u+=t);return u}return""}})();if(void 0===g){g={__namespace:!0};(function(){function e(e,t,n,r){var i="",s=0;if(void 0===e)return"";for(s=0;s<e.length;s++){var o=e.charCodeAt(s),u=e.charAt(s);if(t&&("#"==u||"?"==u)){i+=e.substr(s);break}if(n&&"&"==u)i+=u;else if(o<=127)r?i+=u:o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||t&&o>=32&&o<=95&&" \"%<>'&".indexOf(u)<0?i+=u:o<=15?i+="%0"+o.toString(16).toUpperCase():o<=127&&(i+="%"+o.toString(16).toUpperCase());else if(o<=2047){i+="%"+(192|o>>6).toString(16).toUpperCase();i+="%"+(128|63&o).toString(16).toUpperCase()}else if(55296!=(64512&o)){i+="%"+(224|o>>12).toString(16).toUpperCase();i+="%"+(128|(4032&o)>>6).toString(16).toUpperCase();i+="%"+(128|63&o).toString(16).toUpperCase()}else if(s<e.length-1){o=(1023&o)<<10;s++;o|=1023&e.charCodeAt(s);i+="%"+(240|(o+=65536)>>18).toString(16).toUpperCase();i+="%"+(128|(258048&o)>>12).toString(16).toUpperCase();i+="%"+(128|(4032&o)>>6).toString(16).toUpperCase();i+="%"+(128|63&o).toString(16).toUpperCase()}}return i}g.encodeURIComponent=e;g.escapeUrlForCallback=function(t){var n=t.indexOf("#"),r=t.indexOf("?");if(n>0&&(-1==r||n<r)){var i=t.substr(0,n);r>0&&(i+=t.substr(r));t=i}return e(t,!0,!1,!0)}})()}if(void 0===y){y={__namespace:!0};(function(){function e(e,t){if(M(e,"/")){t.startsWith("/")&&(t=t.substring(1));return e+t}return t.startsWith("/")?e+t:e+"/"+t}var t=new(function(){this._list=new Array(0);this.get_href=function(){var e=null;if(M(window.location.pathname.toLowerCase(),"/_layouts/15/start.aspx")){"undefined"!=typeof g_MinimalDownload&&g_MinimalDownload&&(e=this.getSavedFormAction());Boolean(e)||(e=(function(){var e=null,t=window.location.href,n=t.toLowerCase().indexOf("/_layouts/15/start.aspx"),r=t.indexOf("://"),i=t.indexOf("/",r+3);-1==i&&(i=t.length);var s=t.indexOf("#");e=-1!=s&&s+1<=t.length&&"/"==t[s+1]?s+2<=t.length&&"/"==t[s+2]?t.substr(0,i)+t.substr(s+2):t.substr(0,n)+t.substr(s+1):t.substr(0,n);return e})())}else e=window.location.href;return e};this.get_search=function(){var e="";if("undefined"!=typeof g_MinimalDownload&&g_MinimalDownload&&M(window.location.pathname.toLowerCase(),"/_layouts/15/start.aspx")){var t=this.getSavedFormAction();if(Boolean(t)){var n=t.indexOf("?");-1!=n&&(e=t.substr(n))}}else e=window.location.search;return e};this.add_navigate=function(e){if("function"!=typeof e)throw"unexpected";-1==p.arrayIndexOf(this._list,e,0)&&this._list.push(e)};this.convertMDSURLtoRegularURL=function(t){var n=t;if(null!=t||""!=t){var r=t.toLowerCase().indexOf("/_layouts/15/start.aspx");if(-1!=r){var i=t.substring(0,r);r+="/_layouts/15/start.aspx".length;if(t.length==r)n=i;else if("#"==t[r]){r+=1;if(t.length==r)n=i;else if(t.length>=r+2&&"/"==t[r]&&"/"==t[r+1]){var s=t.indexOf("://");if(-1!=s){var o=t.indexOf("/",s+3);if(-1!=o){n=e(t.substring(0,o),t.substring(r+1))}}}else if(t.length>=r+1&&"/"==t[r]){n=e(i,t.substring(r))}}}}return n}});y.ajaxNavigate=t;y.combineUrl=e;y.pageUrlValidation=function(e,t){if(n(e))return e;Boolean(t)&&alert(t);return""};y.getUrlKeyValue=function(e,t,n,r){var i,s,o="";null==n&&(n=y.ajaxNavigate.get_href()+"");(i=n.indexOf("#"))>=0&&(n=n.substr(0,i));if(r){e=e.toLowerCase();s=n.toLowerCase()}else s=n;-1==(i=s.indexOf("&"+e+"="))&&(i=s.indexOf("?"+e+"="));if(-1!=i){var u=n.indexOf("&",i+1);-1==u&&(u=n.length);o=n.substring(i+e.length+2,u)}return t?o:m.decodeURIComponent(o)};y.isPageUrlValid=n;function n(e){return"http"==e.substr(0,4)||"/"==e.substr(0,1)||-1==e.indexOf(":")}})()}if(k){if(void 0===b){b={__namespace:!0};_()}window.ListModule=b;if(void 0===w){w={__namespace:!0};D()}}else{if(void 0===window.ListModule){b={__namespace:!0};_();window.ListModule=b}if(void 0===window.List_Util){window.List_Util={__namespace:!0};D()}}null==E&&((E={}).ExpFeatures=[]);E.VariantConfiguration={};E.VariantConfiguration.IsExpFeatureClientEnabled=function(e){var t,n=Math.floor(e/32);if(null==window.OffSwitch||i.IsActive("AF5A380E-20E0-4096-BA87-2C4CDFB4DBDF")){if(n<0||n>=E.ExpFeatures.length)return!1;t=1<<e%32;return 0!=(E.ExpFeatures[n]&t)}var r=E.ExpFeatures,s=window._spPageContextInfo;0===r.length&&null!=s&&null!=s.ExpFeatures&&(r=_spPageContextInfo.ExpFeatures);if(n<0||n>=r.length)return!1;t=1<<e%32;return 0!=(r[n]&t)};window.Flighting=E;String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};void 0===S&&(S=new Array(0));window.NotifyScriptLoadedAndExecuteWaitingJobs=function(){};void 0!==Date.now&&null!==Date.now||(Date.now=function(){return Number(new Date)});P.prototype={webPartId:void 0,serverUrl:void 0,siteRelativeUrl:void 0,listName:void 0,rootFolder:void 0,overwriteAll:void 0,hideProgressBar:void 0,refreshFunc:void 0,preUploadFunc:void 0,postUploadFunc:void 0,checkPermissionFunc:void 0};window.PageMinimized=F;if(null==x){(x=[]).push("_spBodyOnLoad");x.push("_spRestoreScrollForDiv_rscr")}null!=document.body&&null!=document.body.firstChild||void 0!==document.addEventListener&&void 0!==window.msWriteProfilerMark&&document.addEventListener("DOMContentLoaded",function(){window.msWriteProfilerMark("DOMContentLoaded")},!1);T=new Object;R.prototype.buildMinimized=void 0;R.prototype.initialTabId=void 0;N=0;C=null;(function(){W.prototype.hasRetVal=void 0;W.prototype.retVal=void 0;W.prototype.set=function(e){if(void 0!==e){this.retVal=e;this.hasRetval=!0}};W.prototype.isSet=function(){return this.hasRetval};W.prototype.get=function(){return this.hasRetval?this.retVal:void 0};W.prototype.clear=function(){this.hasRetval=!1;this.retVal=null}})();n.JsGridUtil.SPListView=!0;X("SP");X("SP.UI");x.push("AllowCSSFiltersOnIE8")};function M(e,t){return-1!==e.indexOf(t,e.length-t.length)}function _(){b.BasePermissions=function(){};b.BasePermissions.prototype={ManageLists:void 0,OpenItems:void 0};b.Context=function(){this.listBaseType=null;this.listTemplate=null;this.listName=null;this.view=null;this.listUrlDir=null;this.HttpPath=null;this.HttpRoot=null;this.serverUrl=null;this.imagesPath=null;this.PortalUrl=null;this.RecycleBinEnabled=null;this.enteringGridMode=!1;this.inGridMode=!1;this.isWebEditorPreview=null;this.rootFolderForDisplay=null;this.isPortalTemplate=null;this.isModerated=!1;this.recursiveView=!1;this.displayFormUrl=null;this.editFormUrl=null;this.newFormUrl=null;this.ctxId=null;this.CurrentUserId=null;this.isForceCheckout=!1;this.EnableMinorVersions=!1;this.ModerationStatus=0;this.verEnabled=0;this.isVersions=0;this.WorkflowsAssociated=!1;this.ExternalDataList=!1;this.HasRelatedCascadeLists=0;this.CascadeDeleteWarningMessage=null;this.ContentTypesEnabled=!1;this.SendToLocationName="";this.SendToLocationUrl="";this.StateInitDone=!1;this.TotalListItems=null;this.CurrentSelectedItems=null;this.LastSelectableRowIdx=null;this.SelectAllCbx=null;this.TableCbxFocusHandler=null;this.TableMouseoverHandler=null;this.onItemSelectionChangedHandlers=[]};b.Context.prototype={AllowGridMode:void 0,BasePermissions:void 0,BaseViewID:void 0,CascadeDeleteWarningMessage:void 0,ContentTypesEnabled:void 0,CurrentSelectedItems:void 0,CurrentUserId:void 0,EnableMinorVersions:void 0,ExternalDataList:void 0,HasRelatedCascadeLists:void 0,HttpPath:void 0,HttpRoot:void 0,RealHttpRoot:void 0,NoScriptEnabled:void 0,LastSelectableRowIdx:void 0,LastSelectedItemIID:void 0,LastRowIndexSelected:void 0,RowFocusTimerID:void 0,ListData:void 0,ListSchema:void 0,ModerationStatus:void 0,mountPointUrl:void 0,PortalUrl:void 0,RecycleBinEnabled:void 0,SelectAllCbx:void 0,SendToLocationName:void 0,SendToLocationUrl:void 0,StateInitDone:void 0,TableCbxFocusHandler:void 0,TableMouseoverHandler:void 0,TotalListItems:void 0,WorkflowsAssociated:void 0,clvp:void 0,ctxId:void 0,ctxType:void 0,dictSel:void 0,displayFormUrl:void 0,editFormUrl:void 0,imagesPath:void 0,inGridMode:void 0,inGridFullRender:void 0,isForceCheckout:void 0,isModerated:void 0,isPortalTemplate:void 0,isVersions:void 0,isWebEditorPreview:void 0,leavingGridMode:!1,loadingAsyncData:!1,listBaseType:void 0,listName:void 0,listTemplate:void 0,listUrlDir:void 0,newFormUrl:void 0,onRefreshFailed:void 0,overrideDeleteConfirmation:void 0,overrideFilterQstring:void 0,overrideScope:void 0,searchTerm:void 0,recursiveView:void 0,rootFolderForDisplay:void 0,serverUrl:void 0,verEnabled:void 0,view:void 0,queryString:void 0,IsClientRendering:void 0,wpq:void 0,rootFolder:void 0,hasRootFolder:void 0,IsAppWeb:void 0,NewWOPIDocumentEnabled:void 0,NewWOPIDocumentUrl:void 0,NewWOPIDocumentTypes:void 0,AllowCreateFolder:void 0,CanShareLinkForNewDocument:void 0,VisioDrawingCreationEnabled:void 0,noGroupCollapse:void 0,SiteTemplateId:void 0,RealSiteTemplateId:void 0,ExcludeFromOfflineClient:!1,onItemSelectionChangedHandlers:void 0,bNoDelete:!1,qcb:void 0};b.Context.Type={EditMenu:0,ViewSelector:1};b.Settings={SupportsCallouts:!1,SupportsDragDrop:!1,SupportsRibbon:!1,SupportsQCB:!1,SupportsUpload:!1,SupportsInplHash:!1,SupportsAnimation:!1,SupportsGrouping:!1,SupportsNonCSR:!1,SupportsInPlaceEdit:!1,SupportsItemDelete:!1,SupportsCheckout:!1,SupportsPopup:!1,SupportsErrorDlg:!1,SupportsFileAttach:!1,SupportsCopies:!1,SupportsModeration:!1,SupportsMQuery:!1,SupportsRest:!1,SupportsDatapipes:!1,SupportsAddToOneDrive:!1,SupportsAddToOneDriveQCB:!1,SupportsTaskListEditMode:!1,SupportsPeopleHoverCard:!1,SupportsMaintainUserChrome:!1,SupportsInfiniteScroll:!1,SupportsDragDropAttract:!1,SupportsDragDropAttractB:!1,SupportsDoclibAccessibility:!1,SupportsDoclibQCB:!1,SupportsOldDesktopMenus:!1,SupportsPolicyTips:!1,SupportsRightClickECB:!1,SupportsShortcutLink:!1,SupportsFileExtensionDefinition:!1,SupportsFileExtensionControls:!1,SupportsFileHandlerForAllNonOfficeFiles:!1,SupportsFileExtensionDataPipe:!1,SupportsFileHandlerAddInPicker:!1,SupportsFileHandlerFileCreation:!1}}function D(){b.Util={};b.Util.createViewEditUrl=e;b.Util.createItemPropertiesTitleUrl=function(t,n){if(t.inGridMode)return e(t,n,!0,!1);return e(t,n,!1,!1)};b.Util.isDefinedAndNotNullOrEmpty=function(e){return null!=e&&""!==e};b.Util.hasEditPermission=function(e){var t=String(e.PermMask);return 0!=(4&parseInt("0x"+t.substring(t.length-1)))};b.Util.makeMountedFolderQueryStrParams=function(e,t){var n=(function(e,t){var n=new m(y.ajaxNavigate.get_href()),r=n.getQueryParameter("RemoteSiteId"),i=[];if(Boolean(r)){var s=n.getQueryParameter("RemoteWebId");if(Boolean(s)){var o=null;e&&(o=n.getQueryParameter("RemoteFolderId"));if(d.IsGuid(r)&&d.IsGuid(s)&&(!e||Boolean(o)&&d.IsGuid(o))){i.push({k:"RemoteSiteId",v:r});i.push({k:"RemoteWebId",v:s});e&&i.push({k:"RemoteFolderId",v:o})}}}else{var u=n.getQueryParameter("GroupSiteUrl");if(Boolean(u)){var a=n.getQueryParameter("GroupId");if(Boolean(a)&&d.IsGuid(a)){i.push({k:"GroupSiteUrl",v:u});i.push({k:"GroupId",v:a})}}}if(i.length>0){if(t){var f=n.getQueryParameter("MPPrefix");if(Boolean(f)){i.push({k:"MPPrefix",v:f});i.push("&MPPrefix=");i.push(f)}}return i}return null})(e,t);if(null==n)return null;for(var r=[],i=0;i<n.length;i++){r.push("&");r.push(n[i].k);r.push("=");r.push(n[i].v)}return r.join("")};b.Util.removeOnlyPagingArgs=function(e){e=e.replace(/&*Paged=TRUE/gi,"");e=e.replace(/&*PagedPrev=TRUE/gi,"");e=e.replace(/&p_[^&]*/gi,"");e=e.replace(/&PageFirstRow=[^&]*/gi,"");return e=e.replace(/&PageLastRow=[^&]*/gi,"")};b.Util.groupStringFromGroupName=function(e){if(null==e||""==e)return null;var t=document.getElementById("titl"+e+"_");if(null==t)return null;var n=t.getAttribute("groupString");return""!=n?n:null};b.Util.ctxInitItemState=function(e){e.TotalListItems=0;e.CurrentSelectedItems=0;e.LastSelectableRowIdx=0;e.StateInitDone=!0};b.Util.clearSelectedItemsDict=function(e){null!=e&&(e.dictSel=[])};b.Util.getHostUrl=function(e){var t=e;t.lastIndexOf("/")>t.indexOf("//")+1&&(t=t.substring(0,t.indexOf("/",t.indexOf("//")+2)));return t};function e(e,t,n,r){var i=[];n?i.push(e.editFormUrl):i.push(e.displayFormUrl);i.push("&ID=");i.push(t.ID);i.push("&ContentTypeID=");i.push(t.ContentTypeId);if(r){i.push("&Source=");i.push(y.getSource())}return i.join("")}}t.TrimSpaces=function(e){var t,n,r=(e=e.toString()).length;for(t=0;t<r&&" "==e.charAt(t);t++);if(t==r)return"";for(n=r-1;n>t&&" "==e.charAt(n);n--);n++;return e.substring(t,n)};function P(e,t,n,r,i,s,o,u,a,f,l){this.webPartId=e;this.serverUrl=t;this.siteRelativeUrl=n;this.listName=r;this.rootFolder=i;this.overwriteAll=s;this.hideProgressBar=o;this.refreshFunc=u;this.preUploadFunc=a;this.postUploadFunc=f;this.checkPermissionFunc=l}function H(e,t,n,r){B(e,e,t,n,r);null!=t&&t();null!=n&&n();null!=r&&r()}function B(e,t,n,r,i){if("string"!=typeof t)throw"Unexpected";if(null!=n&&"function"!=typeof n)throw"Unexpected";if(null!=r&&"function"!=typeof r)throw"Unexpected";if(null!=i&&"function"!=typeof i)throw"Unexpected";S[t]||(S[t]={tag:t,scriptURI:new m(e),beginFunc:n,endFunc:r,loadFunc:i,executed:!1})}function j(e,t){B(e,e,t,null,null)}function F(){return!0}t.IsXhrAborted=function(e){try{if(4==e.readyState&&(void 0===e.status||0==e.status))return!0}catch(e){return!0}return!1};function I(e,t){var n=T[t];if(null!=n&&n.notified){null!=n.args?e.apply(null,n.args):e();return!0}(function(e,t){var n=T[t];if(null==n){(n=new Object).notified=!1;n.jobs=[];n.args=null;T[t]=n}n.jobs.push(e)})(e,t);return!1}function q(e,t){return I(e,"sp.scriptloaded-"+(t=t.toLowerCase()))}function R(){}t.getUniqueIndex=function(){return++N};function U(){if(Boolean(C))return C;try{var e;e=window;for(;null!=e&&e!=e.parent;)null!=(e=e.parent)&&e.g_spDlgLauncher&&(C=e)}catch(e){}finally{Boolean(C)||(C=window)}return C}function z(e,t,n,r){}function W(){}t.IsShortcutLink=function(e){return Boolean(e)&&("url"==e.File_x0020_Type||"website"==e.File_x0020_Type)};t.AjaxNavAddNavigate=function(e){y.ajaxNavigate.add_navigate(e)};function X(e){(function(e,t){for(var n,r=e.split("."),i=0,s=r.length;i<s;i++){var o=r[i];void 0===n&&(n=window);void 0===n[o]&&(n[o]=new Object);n=n[o];t&&(n.__namespace=!0)}})(e,!0)}function V(e,t){var n=e.ownerDocument;if(Boolean(n.createTextNode)){var r=n.createTextNode(t);e.innerHTML="";e.appendChild(r)}else e.innerText=t}function $(e){return e.search(/[?]/)>-1?e:e+"?rev=47"}function J(e,t,n,r,i,s){var o=r._ShortcutUniqueId,u=r._ShortcutWebId,a=r._ShortcutSiteId,f=r._ShortcutUrl,l=(function(e,t,n,r,i){var s="",o="?";if(Boolean(t)){var u=t.indexOf("?");-1!=u&&(o=t.substring(u))}if(Boolean(i)&&Boolean(r)&&Boolean(n)){s=e.WebUrl+"/_layouts/15/ShortcutLink.aspx";s+=o;s+="&siteid="+g.encodeURIComponent(n);s+="&webid="+g.encodeURIComponent(r);s+="&uniqueid="+g.encodeURIComponent(i)}else Boolean(t)&&(s=t);return s})(e,f,a,u,o);t.push('<a onfocus="OnLink(this)" class="ms-listlink" href="');if(""!=l){t.push(c.HtmlEncode(l));t.push('" title="');t.push(c.HtmlEncode(f))}else{l=e.WebUrl+"/_layouts/15/ShortcutLink.aspx?shortcut="+g.encodeURIComponent(r.FileRef);t.push(l);t.push('" title="');t.push(c.HtmlEncode(Strings.STS.L_Shortcut_Processing));if(s){t.push('" id="shortcut_');t.push(c.HtmlEncode(r.FileRef));(function(e,t){if(null!=window.XMLHttpRequest){var n=t.WebUrl+"/_api/SP.Utilities.ShortcutLink.GetShortcutLink('"+g.encodeURIComponent(e)+"')",r=new XMLHttpRequest;r.open("GET",n,!0);r.setRequestHeader("Content-Type","application/json");r.setRequestHeader("Accept","application/json");r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var t=JSON.parse(r.responseText),n=void 0;if(null!=(n=document.getElementById("shortcut_"+e))){n.href=t.url;n.title=t.url}}};r.send(null)}})(r.FileRef,e)}}t.push('" aria-label="');t.push(c.HtmlEncode(Strings.STS.L_FieldType_File_Shortcut));t.push('">')}t.RenderShortcutLink=function(e,t,n,r,i){J(e,t,0,r,0,!0);t.push(c.HtmlEncode(n));t.push("</a>")};t.RenderShortcutLinkIcon=function(e,t,n,r,i){J(e,t,0,r,0,!1);t.push('<img border="0" alt="');t.push(c.HtmlEncode(Strings.STS.L_FieldType_File_Shortcut));t.push('" title="');t.push(c.HtmlEncode(Strings.STS.L_FieldType_File_Shortcut));t.push('" src="');t.push(ListView.ImageBasePath+"/_layouts/15/images/icspgen.gif?rev=47");t.push('" />');t.push("</a>")};function K(e){return E.VariantConfiguration.IsExpFeatureClientEnabled(134)&&Boolean(e)&&Boolean(e[L])&&Boolean(e[A])&&Boolean(e[O])}t.IsMountPoint=K;function Q(e,t){var n={};if(Boolean(K(e))&&Boolean(t)){var r=null;E.VariantConfiguration.IsExpFeatureClientEnabled(168)&&(r=new m("http://foo?"+(function(e){var t="",n="";if(null!=e&&null!=e.clvp&&"function"==typeof e.clvp.WebPartId){n=(r=e.clvp.WebPartId(),y.ajaxNavigate.getParam("InplviewHash"+r));Boolean(n)&&(t=(function(e){return e.replace(/-/g,"&").replace(/&&/g,"-")})(n))}var r;return t})(t)));Boolean(r)||(r=new m(y.ajaxNavigate.get_href()));if(Boolean(r)){n.mpPrefix=r.getQueryParameter("MPPrefix");Boolean(n.mpPrefix)||(n.mpPrefix=e.FileRef.replace(/.url$/,""));n.siteId=e[L];n.webId=e[A];n.folderId=e[O]}}return(function(e){var t=e.rootFolder,n=e.siteId,r=e.webId,i=e.folderId,s=e.mpPrefix,o=Boolean(s)&&Boolean(n)&&Boolean(r)&&Boolean(i),u=Boolean(e.mpLevel)?e.mpLevel:"1,0",a=-1,f=-1,l=[];if(Boolean(u)&&o&&2==(l=u.split(",")).length){a=h(l[0],1);f=h(l[1],0)}function c(e,t){a+=e;0==e?f+=t:f=0;u=String(a)+","+String(f)}function h(e,t){var n=t;return null!=e&&e.length>0&&!isNaN(n)&&(n=parseInt(e))<t?t:n}function p(e){if(!o)return{};var t={RemoteSiteId:n,RemoteWebId:r,RemoteFolderId:i};if(!Boolean(e)){t.MPLevel=u;t.MPPrefix=s}return t}return{isInitProperly:o,mpPrefix:o?s:"",rootFolder:o?t:"",getMajorLevel:function(){return a},getMinorLevel:function(){return f},incrementMajorLevel:function(){c(1,0)},incrementMinorLevel:function(){c(0,1)},decrementMinorLevel:function(){c(0,-1)},getMountPointProperties:p,getMountPointUrl:function(e,t){var n=[];if(o){var r=p(t);for(var i in r)n.push(i+"="+r[i])}Boolean(e)||(e="&");return n.join(e)}}})(n)}t.createByListItem=Q;function G(e){return Boolean(e)&&!e.inGridMode&&(E.VariantConfiguration.IsExpFeatureClientEnabled(168)&&700==e.ListTemplateType&&51==e.BaseViewID||E.VariantConfiguration.IsExpFeatureClientEnabled(424)&&null!=window.groupContextData&&101==e.ListTemplateType&&1==e.BaseViewID)}t.SupportAjaxFolderNav=G;t.RenderMountPointLink=function(e,t,n,r,i){var s=Q(r,e);t.push('<a onfocus="OnLink(this)" class="ms-listlink" href="');if(e.NoScriptEnabled&&G(e)){t.push('"#" onclick="');t.push("EnterFolderAjax(event, '");t.push(g.encodeURIComponent(r.FileRef));t.push("', '");t.push(s.getMountPointUrl());t.push("', true);return false;\"");E.VariantConfiguration.IsExpFeatureClientEnabled(169)&&t.push(' aria-label="'+c.HtmlEncode(Strings.STS.L_FieldType_SharedFolder)+'"');t.push(">")}else{t.push(i.PagePath);t.push("?");t.push(s.getMountPointUrl());E.VariantConfiguration.IsExpFeatureClientEnabled(169)?t.push('" aria-label="'+c.HtmlEncode(Strings.STS.L_FieldType_SharedFolder)+'">'):t.push('">')}t.push(c.HtmlEncode(n));t.push("</a>")};function Y(e){if(!Boolean(e))return!1;for(var t=e.split("."),n=t.length,r=window,i=0;i<n;i++)if(void 0===(r=r[t[i]]))return!1;return!0}(function(e){e.AddClass=function(e,t){if(null!=e&&!n(e,t)){e.className+=" "+t;return!0}return!1};e.RemoveClass=function(e,r){if(n(e,r)){e.className=e.className.replace(t(r)," ");return!0}return!1};function t(e){return new RegExp("(\\s|^)"+e+"(\\s|$)")}function n(e,n){return null!=e&&null!=n&&null!=e.className.match(t(n))}})(t.CSSUtil||(t.CSSUtil={}))});
define("gqe",["require","exports","Lqe","bqe","hqe","vqe","k"],function(require,exports,gridutil_1,core_1,init_1,clienttemplates_1,Killswitch_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var reconcileQstringFiltersKillSwitchIsActive=Killswitch_1.Killswitch.isActivated("B05B33FA-F6BB-43C4-9503-F2BD4EF272A6","4/23/2020","Use existing reconcileQstringFilters function in JsGridUtil rather then rely on a global variable"),focusAcc,SPListOperationType;function global_inplview(){window.g_SPGridInitInfo={};ServerData.prototype.GetValue=function(e){};ServerData.prototype.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",SPRequestDuration:"SPRequestDuration",SPIisLatency:"SPIisLatency"};CLVP_InitializePrototype();FocusInfo_InitializePrototype();focusAcc=null;SPListOperationType={Default:0,Sort:1,PagingRight:2,PagingLeft:3};exports.inplview={CLVPFromCtx:CLVPFromCtx,InitAllClvps:InitAllClvps,DeleteSelectedItemsCore:DeleteSelectedItemsCore};ListModule.Settings.SupportsInplHash&&init_1.AjaxNavAddNavigate(RestoreAllClvpsNavigation);InitAllClvps()}exports.global_inplview=global_inplview;function SPGridMakeInplviewRequest(e,t,n,r,i,s,o){var u=new XMLHttpRequest,a=[];a.push(SP.Utilities.Utility.getLayoutsPageUrl("inplview.aspx"));a.push("?Cmd=");a.push(e);a.push("&List=");a.push(t);a.push("&View=");a.push(n);a.push("&IsXslView=TRUE&Grid=True");if(Boolean(r)){a.push("&");a.push(r)}else{if(i){a.push("&SortField=");a.push(URI_Encoding.encodeURIComponent(i.sortField));a.push("&SortDir=");a.push(i.isDescending?"Desc":"Asc")}Boolean(s)&&a.push(s)}u.open("POST",a.join(""),!0);u.onreadystatechange=o(u);u.send(null)}function SPGridFetchSchema(e,t,n){window.g_SPGridInitInfo[t].stale=!0;SPGridMakeInplviewRequest("Schema",e,t,null,null,null,function(e){return function(){if(4==e.readyState&&!init_1.IsXhrAborted(e)){try{e.onreadystatechange=null}catch(e){}var t=e.responseText;if(601==e.status)throw t;var r=JSON.parse(t);n(r)}}})}exports.SPGridFetchSchema=SPGridFetchSchema;function GetCtxFromView(e){var t=null;for(var n in g_ctxDict){var r=g_ctxDict[n];if(r.view==e){t=r;break}}return t}function ExitGrid(e,t,n,r){var i=window.g_SPGridInitInfo[e],s=GetCtxFromView(e),o=window[i.controllerId],u=o.GetCLVPQString(),a=o.GetUnfilteredHierarchyMap();o.TryDispose(function(e){if(null==window.OffSwitch||OffSwitch.IsActive("7265707D-3E1D-4281-8FF2-B3AB155897ED")||!PageMinimized()||r){i.initialized=!1;s.inGridMode=!1;s.leavingGridMode=!0;var o=null;if(null!=e&&e.markGridSerializerAsStale)i.stale=!0;else if(null!=a){var f=[{Key:0}],l={0:0},c=function(e){for(var t=0;t<e.length;t++){var n=e[t],r={};r.Key=Number(n);if(null!=a[n].parentKey){var i=l[a[n].parentKey];Sys.Debug.assert(null!=i);r.Parent=i}null!=a[n].tag&&(r.Tag=a[n].tag);Sys.Debug.assert(null==l[n]);l[n]=f.length;f.push(r);null!=a[n].childKeys&&c(a[n].childKeys)}};c(a[0].childKeys);o=f}window[i.controllerId]=null;i.unfilteredHierarchyInfo=o;var h=document.getElementById("js-listviewthead-"+s.wpq);null!=h&&(h.style.display="");var p=document.getElementById("agg"+s.wpq);null!=p&&(p.style.display="");t||s.clvp.RefreshPaging(u.toString());null!=n&&n()}else parent.postMessage("ExitGrid","*")})}function ServerData(){}function ServerConnection(){var e=null,t=null,n="json";this.abort=function(){if(null!=e){e.isCancelled;e.abort();e=null}if(null!=t){t.Abort();t=null}};this.isRequestActive=function(){return Boolean(e)||Boolean(t)};this.getServerData=function(n,o,u,a,f,l){var c=n();return ListModule.Settings.SupportsDatapipes&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(216)?(function(e,n,r,o){var u=new i(e,n,r),a=new s(e,o),f="";"undefined"!=typeof MSOWebPartPageFormName&&(f=document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value);var l=new SPTouchData.DatapipeFactoryParameters("",f,"/"),c=new SPTouchData.DatapipeFactory(l).GetDatapipe(SPTouchData.DatapipeType.ObjectDatapipe);c.Initialize(a);c.SetCallbackObj(u);var h=c.CreateSession();h.GetData();t=h;return})(c,o,u,f):(function(t,n,i,s,o,u){var a=new s;a.open("POST",t,!0);u?a.setRequestHeader("Content-Type","application/json;odata=verbose"):a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");u&&("undefined"!=typeof MSOWebPartPageFormName?a.setRequestHeader("x-requestdigest",document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value):"string"==typeof pageDigest&&a.setRequestHeader("x-requestdigest",pageDigest));a.onreadystatechange=function(){r(a,t,n,i)};e=a;a.send(o);return})(c,o,u,a,f,l)};var r=function(e,t,n,r){if(4==e.readyState){this._currentXhrRequest=null;if(!init_1.IsXhrAborted(e)&&(void 0===e.isCancelled||1!=e.isCancelled)){var i=new ServerData;i.GetValue=function(n){var r=void 0,s=i;switch(n){case s.DataValueKeys.SourceURL:r=t;break;case s.DataValueKeys.CorrelationId:r=e.getResponseHeader("SPRequestGuid");break;case s.DataValueKeys.Status:try{r=e.status}catch(e){}break;case s.DataValueKeys.AuthenticationRedirect:r=e.getResponseHeader("X-Forms_Based_Auth_Required");break;case s.DataValueKeys.ResponseText:r=e.responseText;break;case s.DataValueKeys.SPRequestDuration:r=e.getResponseHeader(s.DataValueKeys.SPRequestDuration);break;case s.DataValueKeys.SPIisLatency:r=e.getResponseHeader(s.DataValueKeys.SPIisLatency)}return r};200===e.status?n(i):r(i);try{e.onreadystatechange=null}catch(e){}}}};function i(e,r,i){this.OnDataAvailable=function(i){t=null;var s=new ServerData;s.GetValue=function(t){var r=void 0,o=s;switch(t){case o.DataValueKeys.SourceURL:r=e;break;case o.DataValueKeys.CorrelationId:r=void 0;break;case o.DataValueKeys.Status:r=200;break;case o.DataValueKeys.AuthenticationRedirect:r=void 0;break;case o.DataValueKeys.ResponseText:r=i.GetValue(n)}return r};r(s)};this.OnDataError=function(e){t=null;var n=new ServerData;n.GetValue=function(t){var r=void 0,i=n;switch(t){case i.DataValueKeys.SourceURL:r=e.Url;break;case i.DataValueKeys.CorrelationId:r=e.ServerCorrelationId;break;case i.DataValueKeys.Status:r=e.XHRResponseStatus;break;case i.DataValueKeys.AuthenticationRedirect:r=void 0;break;case i.DataValueKeys.ResponseText:r=e.ErrorMessage}return r};i(n)};this.OnPreAuthenticationRedirect=function(){return!1}}function s(e,t){this.RestUrl=e;this.MakeData=function(e){return new o(e)};this.AdditionalHeaders={};this.HttpMethod="POST";this.IsWrite=!1;this.PostBody=t}function o(e){this.GetValue=function(t){var r;t==n&&(r=JSON.stringify(e));return r}}}function SharePointListRestUrlBuilder(){var e;this.setHttpRoot=function(t){e=t};var t=!1;this.setUseRest=function(e){t=e};var n=!1;this.setIsClientRendering=function(e){n=e};var r,i,s,o,u=!1;this.setIsEcbInfo=function(e){u=e};this.setListName=function(e){r=e};this.setListUrl=function(e){i=e};this.setView=function(e){s=e};this.setCtxId=function(e){o=e};var a,f,l,c,h=!1;this.setIsXslView=function(e){h=e};this.setOverrideSelectCommand=function(e){a=e};this.setOverrideFilterQstring=function(e){f=e};this.setOverrideScope=function(e){l=e};this.setSearchTerm=function(e){c=e};var p=!1;this.setIsFullListSearch=function(e){p=e};var d,v,m,g=!1;this.setIsRealHttpRoot=function(e){g=e};this.setRootFolder=function(e){d=e};this.setInGridMode=function(e){v=e};this.setCmd=function(e){m=e};var y,b,w,E,S,x=!1;this.setShouldCascadeDeleteWarningMessage=function(e){x=e};this.setWebPartID=function(e){y=e};this.setGroupString=function(e){b=e};this.setPagingParams=function(e){w=e};this.setSortField=function(e){E=e};this.setSortDir=function(e){S=e};var T=!1;this.setIgnoreQString=function(e){T=e};this.buildUrl=function(){var N=new URI(URI_Encoding.escapeUrlForCallback(e)),C=N.getPath();if(t)if(g)N.setPath(C+"/_api/SP.Requestcontext.Current/GetRemoteContext/list/RenderListDataAsStream");else{Boolean(r)?C+="/_api/web/lists/getById('"+r:C+="/_api/web/GetList('"+i;N.setPath(C+"')/RenderListDataAsStream");Boolean(s)&&N.setQueryParameter("View",s)}else{N.setPath(C+"/_layouts/15/inplview.aspx");N.setQueryParameter("List",r);null!=s&&N.setQueryParameter("View",s);N.setQueryParameter("ViewCount",o);h&&N.setQueryParameter("IsXslView","TRUE");n&&N.setQueryParameter("IsCSR","TRUE")}a&&N.setQueryParameter("HasOverrideSelectCommand","TRUE");var k=null;void 0!==f&&(k=f.match(RegExp("OverrideScope=[^&]*")));void 0!==l&&null==k&&N.setQueryParameter("OverrideScope",l);void 0!==f&&M(N,f);if(n){var L=new URI(Nav.ajaxNavigate.get_href(),{disableEncodingDecodingForLegacyCode:!0});N.setQueryParameter("ListViewPageUrl",URI_Encoding.encodeURIComponent(L.getStringWithoutQueryAndFragment(),!1))}void 0!==c&&null!=c&&N.setQueryParameter("InplaceSearchQuery",URI_Encoding.encodeURIComponent(c,!0));p&&N.setQueryParameter("InplaceFullListSearch","true");if(g){M(N,ListModule.Util.makeMountedFolderQueryStrParams(!0,!1))}n&&u&&N.setQueryParameter("IsRibbon","TRUE");Boolean(d)&&N.setQueryParameter("RootFolder",URI_Encoding.encodeURIComponent(d,!0));Boolean(m)&&N.setQueryParameter("Cmd",m);var A=!1;if(Boolean(w))for(var O in w)if("List"!=O&&"View"!=O&&"ID"!=O)if("ShowInGrid"==O){A=!0;N.setQueryParameter("ShowInGrid",Boolean(v)?"True":"False")}else"GroupString"!=O||!Boolean(b)&&""!=b?N.setQueryParameter(O,w[O]):N.setQueryParameter("GroupString",b);Boolean(v)&&!A&&N.setQueryParameter("ShowInGrid","True");Boolean(y)&&N.setQueryParameter("WebPartID",y);x&&N.setQueryParameter("CascDelWarnMessage","1");if(Boolean(b)||""==b){w.hasOwnProperty("IsGroupRender")||N.setQueryParameter("IsGroupRender","TRUE");N.setQueryParameter("DrillDown","1");w.hasOwnProperty("GroupString")||N.setQueryParameter("GroupString",b)}Boolean(E)&&N.setQueryParameter("SortField",E);Boolean(S)&&N.setQueryParameter("SortDir",S);T&&N.setQueryParameter("IgnoreQString","TRUE");return N.getString();function M(e,t){if(Boolean(t))for(var n=t.split("&"),r=0,i=n.length;r<i;r++){var s=n[r].split("=");Boolean(s[0])&&e.setQueryParameter(s[0],s[1])}}}}function CLVP_InitializePrototype(){CLVP.prototype={outstandingServerConnection:void 0,cctx:void 0,ctx:void 0,dsrc:null,fnEcbCallbacks:{},fRestore:!1,inplUrl_deprecated:null,cachedUrlBuilder:null,fRest:!1,isEcbInfo:!1,hasEcbInfo:!1,isInserting:!1,pagingTab:null,queueEcbInfo:[],rgehs:void 0,rgpag:null,rgpaging:null,rootFolder:null,rootFolderGuid:null,strGroupCache:null,strGroupName:null,tBody:null,currentTBody:null,tab:null,trEmpty:null,wpid:null,wpq:null,strHash:"",xmlHttpCtr:window.XMLHttpRequest,CancelAnyOutstandingRequest:CLVPCancelAnyOutstandingRequest,Init:CLVPInit,PagingString:CLVPPagingString,RefreshPagingEx:CLVPRefreshPagingEx,IsServerConnectionRequestActive:CLVPIsServerConnectionRequestActive,FindTab:CLVPFindTab,EnsureChangeContext:CLVPEnsureChangeContext,DeleteItemCore:CLVPDeleteItemCore,ShowErrorDialog:CLVPShowErrorDialog,InplViewUrl:CLVPInplViewUrl}}function CLVP(e){this.ctx=e;e.clvp=this}function CLVPInit(){if(null!=this.FindTab()){this.pagingTab=document.getElementById("bottomPagingCell"+this.wpq.substr(7));if(null!=this.tab&&"ms-emptyView"==this.tab.className){var e=gridutil_1.JsGridUtil.Internal.DomElement.GetInstance().GetAncestorByTag(this.tab,"TR");this.trEmpty=e.nextSibling}null!=this.ctx.rootFolder&&(this.rootFolder=URI.decodeURIComponent(this.ctx.rootFolder));Boolean(this.rootFolder)||(this.rootFolder=Nav.getUrlKeyValue("RootFolder"));0==this.rootFolder.length&&(this.rootFolder=null);var t=this.GetQueryStringFromHash();null===t&&void 0===t||(this.ctx.queryString=t)}}function CLVPFindTab(){var e=1==this.ctx.listBaseType,t=this.ctx.listName+"-"+this.ctx.view,n=DOM.GetElementsByName(t);if(0==n.length&&e){t="onetidDoclibViewTbl0";n=DOM.GetElementsByName(t)}var r,i=null;0!=n.length||e||(n=DOM.GetElementsByName("onetidDoclibViewTbl0"));0==n.length&&(n=DOM.GetElementsByName("onetidDoclibViewTbl"+this.ctx.ctxId));for(r=0;r<n.length;r++){var s=n[r],o=(i=s).getAttribute("view");if(!Boolean(o))for(;null!=i&&("DIV"!=i.tagName||null==(o=i.getAttribute("WebPartID")))&&null!=i.parentNode;)i=i.parentNode;if(null!=i&&null!=o&&1==this.ctx.view.indexOf(o.toUpperCase())){this.tab=s;this.wpq="WebPart"+this.ctx.wpq;break}}if(null==i||null==this.tab)return null;this.tab.clvp=this;return i}function CLVPPagingString(e){if(null==this.rgpaging)return null;var t,n=[],r=!0;for(t in this.rgpaging){var i=!1;if(null==e)i=!0;else for(var s in e)if(0==t.indexOf(s)){i=!0;break}if(i)if(r)r=!1;else{n.push("&");n.push(t);n.push("=");n.push(this.rgpaging[t])}}return n.join("")}function CLVPIsServerConnectionRequestActive(){var e=this.outstandingServerConnection;return Boolean(e)&&e.isRequestActive()}function CLVPRefreshPagingEx(e,t,n,r,i){var s=this;"1"==Nav.getUrlKeyValue("PageFirstRow",!1,e)&&(e=ListModule.Util.removeOnlyPagingArgs(e));var o=new URI(Boolean(i)?i:e,{disableEncodingDecodingForLegacyCode:!0}),u=document.getElementById("GroupByWebPartID"+s.ctx.ctxId),a=null;null!=u&&(a=u.getAttribute("webPartID"));var f=1==s.ctx.HasRelatedCascadeLists&&null==s.ctx.CascadeDeleteWarningMessage,l=null;null!=s.strGroupName&&(l=ListModule.Util.groupStringFromGroupName(s.strGroupName));var c=Nav.getUrlKeyValue("RootFolder",!0,e);s.ctx.startTime=(new Date).getTime();var h,p,d,v,m=o.getQuery();(t||void 0===s.rgpaging||null==s.rgpaging)&&(s.rgpaging=getPagingQueryParams(m));h=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(216)?(function(){var e=Nav.getUrlKeyValue("SortField",!0,window.location.href),t=Nav.getUrlKeyValue("SortDir",!0,window.location.href);s.fRest=ListModule.Settings.SupportsRest&&!s.isEcbInfo;var r=__CreateSharePointListRestUrlBuilder(s);Boolean(s.rgpaging.RootFolder)||r.setRootFolder(c);r.setInGridMode(s.ctx.inGridMode);r.setCmd(n);r.setShouldCascadeDeleteWarningMessage(f);r.setWebPartID(a);r.setGroupString(l);r.setSortField(e);r.setSortDir(t);r.setPagingParams(s.rgpaging);return r})():(p=buildQueryParams(s.rgpaging,n,f,a,l),d=buildServerDataEndpoint(s.InplViewUrl(!0),o,c,p,s.ctx.inGridMode),v={buildUrl:function(){var e=d;v._ignoreQString&&(e=SetUrlKeyValue("IgnoreQString","TRUE",!1,e));null==v._rootFolder&&(e=URI.removeKeyValue("RootFolder",e));return e},setIgnoreQString:function(e){v._ignoreQString=e},_ignoreQString:!1,setRootFolder:function(e){v._rootFolder=e},_rootFolder:""});if(r)return h.buildUrl();var g=new ServerConnection;ListModule.Settings.SupportsPopup&&void 0!==window.ctxFilter&&null==window.ctxFilter&&MenuHtc_hide&&MenuHtc_hide();var y="",b=!1,w=!1;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(168)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&null!=window.groupContextData){b=Boolean(s.ctx.hasRootFolder);w=Boolean(s.ctx.mountPointUrl)}if(s.fRest){y="{'parameters': {'__metadata': { 'type': 'SP.RenderListDataParameters' }, 'ViewXml': ''";w&&(y+=", 'RenderOptions': '7'");y+="}}"}else{if(void 0!==s.ctx.overrideSelectCommand){y="&OverrideSelectCommand="+s.ctx.overrideSelectCommand;h.setIgnoreQString(!0)}if(c.length>0){y=y+"&InplRootFolder="+c;h.setRootFolder(null)}}s.ctx.hasRootFolder=!1;s.ctx.mountPointUrl=null;var E=!1;if(s.isEcbInfo){E=!0;s.isEcbInfo=!1;s.hasEcbInfo=!0}var S=s.tBody,x=s.currentTBody;s.tBody=null;s.CancelAnyOutstandingRequest();var T=null;null!=focusAcc&&null!=focusAcc.focusInCLVPTab&&(T=focusAcc);if(!s.ctx.enteringGridMode||s.fRestore){var N={},C=h.buildUrl().indexOf("?");N.action=h.buildUrl().substr(C+1);var k=function(){var e=function(e){var t=e.GetValue(e.DataValueKeys.Status),n=e.GetValue(e.DataValueKeys.ResponseText),r=e.GetValue(e.DataValueKeys.AuthenticationRedirect),i=e.GetValue(e.DataValueKeys.SourceURL);s.OnReadyStateChangeCallback(t,n,i,r,E,x,S,T,c,b,w)};g.getServerData(h.buildUrl,function(t){var n=t.GetValue(t.DataValueKeys.CorrelationId);N.correlationId=n;e(t)},function(t){var n=t.GetValue(t.DataValueKeys.CorrelationId);N.correlationId=n;e(t)},s.xmlHttpCtr,y,s.fRest);s.outstandingServerConnection=g};s.ctx.inGridMode&&!s.ctx.enteringGridMode&&!E&&ListModule.Settings.SupportsInPlaceEdit?ExitGrid(s.ctx.view,!0,function(){s.ctx.inGridMode=!0;s.ctx.leavingGridMode=!1;k()},!0):k()}else window.ReRenderListView(s.ctx,h.buildUrl(),null,null)}exports.CLVPRefreshPagingEx=CLVPRefreshPagingEx;function CLVPInplViewUrl(e){var t=this;return Flighting.VariantConfiguration.IsExpFeatureClientEnabled(216)&&!Boolean(e)?(function(){if(null!=t.cachedUrlBuilder){t.cachedUrlBuilder.setIsClientRendering(t.ctx.IsClientRendering);t.cachedUrlBuilder.setIsEcbInfo(t.isEcbInfo)}else{t.fRest=ListModule.Settings.SupportsRest&&!t.isEcbInfo;t.cachedUrlBuilder=__CreateSharePointListRestUrlBuilder(t)}return t.cachedUrlBuilder})():(function(){var e="undefined"!=typeof ctx?ctx:t.ctx,n=ListModule.Settings.SupportsRest&&!t.isEcbInfo,r=void 0!==t.ctx.IsClientRendering&&t.ctx.IsClientRendering,i=t.isEcbInfo;if(null==t.inplUrl_deprecated){var s=new SharePointListRestUrlBuilder;s.setHttpRoot(Boolean(e.RealHttpRoot)?e.RealHttpRoot:e.HttpRoot);s.setUseRest(n);s.setIsClientRendering(r);s.setListName(t.ctx.listName);s.setView(t.ctx.view);s.setCtxId(String(t.ctx.ctxId));s.setIsXslView(void 0!==t.ctx.isXslView&&t.ctx.isXslView);s.setOverrideSelectCommand(void 0!==t.ctx.overrideSelectCommand);s.setOverrideFilterQstring(t.ctx.overrideFilterQstring);s.setOverrideScope(t.ctx.overrideScope);s.setSearchTerm(t.ctx.searchTerm);s.setIsFullListSearch(void 0!==t.ctx.fullListSearch&&null!=t.ctx.fullListSearch&&t.ctx.fullListSearch);s.setIsRealHttpRoot(Boolean(t.ctx.RealHttpRoot));t.inplUrl_deprecated=s.buildUrl();t.fRest=n}return t.inplUrl_deprecated+(r&&i?"&IsRibbon=TRUE":"")})()}function CLVPCancelAnyOutstandingRequest(){if(this.IsServerConnectionRequestActive()){if(this.isEcbInfo){this.isEcbInfo=!1;this.strGroupName=null}this.outstandingServerConnection.abort();this.outstandingServerConnection=void 0}return!1}function CLVPEnsureChangeContext(e){var t;null==this.cctx&&(gridutil_1.JsGridUtil._usePerInstancePageContextKillSwitchIsActive?this.cctx=new SP.ClientContext(null):this.cctx=new SP.ClientContext(null===(t=e)||void 0===t?void 0:t.webServerRelativeUrl))}function CLVPDeleteItemCore(e,t){ListModule.Settings.SupportsItemDelete&&core_1._CLVPDeleteItemCore(this,e,t)}function CLVPShowErrorDialog(e,t){ListModule.Settings.SupportsErrorDlg&&core_1._CLVPShowErrorDialog(this,e,t)}function __CreateSharePointListRestUrlBuilder(e){var t="undefined"!=typeof ctx?ctx:e.ctx,n=void 0!==e.ctx.IsClientRendering&&e.ctx.IsClientRendering,r=e.isEcbInfo,i=new SharePointListRestUrlBuilder;i.setHttpRoot(Boolean(t.RealHttpRoot)?t.RealHttpRoot:t.HttpRoot);i.setUseRest(e.fRest);i.setIsClientRendering(n);i.setIsEcbInfo(r);i.setListName(e.ctx.listName);i.setView(e.ctx.view);i.setCtxId(String(e.ctx.ctxId));i.setIsXslView(void 0!==e.ctx.isXslView&&e.ctx.isXslView);i.setOverrideSelectCommand(void 0!==e.ctx.overrideSelectCommand);i.setOverrideFilterQstring(e.ctx.overrideFilterQstring);i.setOverrideScope(e.ctx.overrideScope);i.setSearchTerm(e.ctx.searchTerm);i.setIsFullListSearch(void 0!==e.ctx.fullListSearch&&null!=e.ctx.fullListSearch&&e.ctx.fullListSearch);i.setIsRealHttpRoot(Boolean(e.ctx.RealHttpRoot));return i}function InitCLVPs(){if("undefined"!=typeof g_ViewIdToViewCounterMap){var e;for(e in g_ViewIdToViewCounterMap){var t=window["ctx"+g_ViewIdToViewCounterMap[e]];if(Boolean(t)){new CLVP(t).Init()}}}}function getPagingQueryParams(e){var t=e.split("&"),n=[],r=0;for(r=0;r<t.length;r++){var i=t[r].split("=");"List"!=i[0]&&"View"!=i[0]&&"ID"!=i[0]&&(i.length>1&&(n[i[0]]=i[1]))}return n}function buildQueryParams(e,t,n,r,i){var s,o=[];null!=t&&o.push("&Cmd="+t);n&&o.push("&CascDelWarnMessage=1");for(s in e)if("List"!=s&&"View"!=s&&"ID"!=s){o.push("&");o.push(s);o.push("=");o.push(e[s])}Boolean(r)&&o.push("&WebPartID="+r);null!=i&&o.push("&IsGroupRender=TRUE&DrillDown=1&GroupString="+i);return o.join("")}function buildServerDataEndpoint(e,t,n,r,i){var s,o=new URI(e,{disableEncodingDecodingForLegacyCode:!0}),u=o.getStringWithoutQueryAndFragment(),a=o.getQuery();s=reconcileQstringFiltersKillSwitchIsActive?u+"?"+ListModule.Util.reconcileQstringFilters(a,r):u+"?"+gridutil_1.JsGridUtil.Internal.List_ReconcileQstringFilters(a,r);if(0==Nav.getUrlKeyValue("SortField",!0,s).length){var f=Nav.getUrlKeyValue("SortField",!0,window.location.href);f.length>0&&(s=SetUrlKeyValue("SortField",f,!1,s));var l=Nav.getUrlKeyValue("SortDir",!0,window.location.href);l.length>0&&(s=SetUrlKeyValue("SortDir",l,!1,s))}n.length>0&&0==Nav.getUrlKeyValue("RootFolder",!0,s).length&&(s=SetUrlKeyValue("RootFolder",n,!1,s));var c=Nav.getUrlKeyValue("ShowInGrid",!0,s);"True"!=c||i?"True"!=c&&i&&(s=SetUrlKeyValue("ShowInGrid","True",!0,s)):s=SetUrlKeyValue("ShowInGrid","False",!0,s);return s}function SetUrlKeyValue(e,t,n,r){null==r&&(r=window.location.href+"");var i=t,s=new URI(r,{disableEncodingDecodingForLegacyCode:!0});r=s.getQuery();n&&(i=URI_Encoding.encodeURIComponent(i));if(r.indexOf(e+"=")<0){r.length>1?r+="&":0==r.length&&(r+="?");r+=e+"="+i}else{var o=new RegExp(e+"=[^&]*");r=r.replace(o,e+"="+i)}s.setQuery(r);return s.getString()}function ReRenderListView(e,t,n,r){var i=e.clvp,s=EnableListAnimation(e),o=!1,u=!1;s&&(o=0==e.ListData.Row.length||Boolean(e.ListData.NextHref));var a=e.bNoDelete?n:null;s&&(u=0==e.ListData.Row.length||Boolean(e.ListData.NextHref));var f=s&&u&&!o,l=null;null!=i&&i.fRestore||e.enteringGridMode||e.leavingGridMode||(l=document.getElementById("scriptBody"+e.wpq));"function"==typeof RenderListView&&RenderListView(e,e.wpq,l,s,f);FixSortOrderIcon(e,e.ListData,e.ListSchema);FixAggregate(e,e.ListData,e.ListSchema);if(null==i){i=new CLVP(e);e.clvp=i}null==i.tab?i.Init():null==l&&i.FindTab();if(i.fRestore||e.enteringGridMode||e.leavingGridMode){i.fRestore=!1;null!=i.tab&&init_1.CSSUtil.RemoveClass(i.tab,"s4-hide-tr")}if(!Boolean(i.ctx.loadingAsyncData)&&!i.fRestore&&!Boolean(i.ctx.bNoDelete)||i.ctx.enteringGridMode||i.ctx.leavingGridMode||null!=r&&!Boolean(i.ctx.bNoDelete)){var c={},h=i.InplViewUrlHash(t,r);c["InplviewHash"+i.WebPartId()]=h;ListModule.Settings.SupportsInplHash&&"function"==typeof AjaxNavUpdate&&AjaxNavUpdate(c);i.strHash=h}i.ctx.bNoDelete=!1;Boolean(i.ctx.loadingAsyncData)&&(i.ctx.loadingAsyncData=!1);if(null==a){ListModule.Util.ctxInitItemState(e);ListModule.Util.clearSelectedItemsDict(e)}null==i.tab||void 0!==i.tab.onmouseover&&null!=i.tab.onmouseover||(i.tab.onmouseover=i.ctx.TableMouseoverHandler);null==e.SelectAllCbx||void 0!==e.SelectAllCbx.onfocus&&null!=e.SelectAllCbx.onfocus||(e.SelectAllCbx.onfocus=e.TableCbxFocusHandler);if(null==a){i.InvalidateEcbInfo();i.ResetSelection();i.SyncPagingTables()}if(ListModule.Settings.SupportsAnimation&&s&&null!=l)AnimateListDelta(e,l.parentNode);else if("undefined"!=typeof ProcessImn&&"undefined"!=typeof imnCount&&"undefined"!=typeof bIMNOnloadAttached){imnCount=0;bIMNOnloadAttached=!1;ProcessImn()}var p=e.qcb;Boolean(p)&&p.Poll();if("function"==typeof i.ctx.onViewReRenderCompleted){var d=i.ctx.onViewReRenderCompleted;i.ctx.onViewReRenderCompleted=null;null!=d&&d(i.ctx)}e.operationType=SPListOperationType.Default;e.leavingGridMode&&(e.leavingGridMode=!1);if(null!=a){e.ListData=MergeListData(a,e.ListData);"function"==typeof window.scrollManager.ScrollHandler&&["scrollManager"].ScrollHandler();null!=l&&null!=(l=l.parentNode.lastChild)&&l.setAttribute("url",t)}}exports.ReRenderListView=ReRenderListView;function FixAggregate(e,t,n){if(null!=t&&null!=n){var r=n.Aggregate;if(null!=r&&!n.groupRender&&!e.inGridMode){var i=document.getElementById("aggr"+e.wpq),s="<table>"+clienttemplates_1.RenderAggregate(e,null,t.Row[0],n,null,!0,r)+"</table>",o=document.createElement("div");o.innerHTML=s;var u=o.firstChild.firstChild;i.replaceChild(u.firstChild,i.firstChild)}}}function FixSortOrderIcon(e,t,n){if(null!=e&&null!=t&&null!=n)if(e.IsClientRendering){var r,i,s;if(null!=t.SortField&&null!=(r=document.getElementById("diidSortArrowSpan"+e.ctxId+t.SortField))){var o=r.getElementsByTagName("img")[0];if(null!=o){if("ascending"==t.SortDir){r.className="ms-sortarrowup-iconouter";o.className="ms-sortarrowup-icon";o.alt=window.ListView.Strings.L_viewedit_onetidSortAsc}else{r.className="ms-sortarrowdown-iconouter";o.className="ms-sortarrowdown-icon";o.alt=window.ListView.Strings.L_viewedit_onetidSortDesc}r.style.display=""}}for(var u in n.Field){var a=n.Field[u];if(null==a.GroupField){a.Name!=t.SortField&&null!=(r=document.getElementById("diidSortArrowSpan"+e.ctxId+a.Name))&&(r.style.display="none");if(null!=(s=document.getElementById("diidFilterSpan"+e.ctxId+a.Name))){i=null!=t.FilterFields&&t.FilterFields.indexOf(";"+a.Name+";")>=0;s.style.display=i?"":"none"}}}}else FixSortOrderIcon_NonCSR(e,t,n)}function FixSortOrderIcon_NonCSR(e,t,n){var r="/_layouts/15/images/sort.gif",i="/_layouts/15/images/rsort.gif";if(null!=t&&null!=n){if(null!=t.SortField){var s=document.getElementById("diidSort"+e.ctxId+t.SortField);if(null!=s){var o=s.lastChild;if(null!=o){var u=o.previousSibling;null==u||"IMG"!=u.tagName||u.src.substr(u.src.length-r.length)!=r&&u.src.substr(u.src.length-i.length)!=i||u.parentNode.removeChild(u);var a=document.createElement("IMG");a.border=0;if("ascending"==t.SortDir){a.alt=window.ListView.Strings.L_viewedit_onetidSortAsc;a.src="/_layouts/15/images/sort.gif?rev=47"}else{a.alt=window.ListView.Strings.L_viewedit_onetidSortDesc;a.src="/_layouts/15/images/rsort.gif?rev=47"}if("IMG"!=o.tagName){var f=document.createElement("IMG");f.border=0;f.src="/_layouts/15/images/blank.gif";o=s.appendChild(f)}s.insertBefore(a,o)}}}for(var l in n.Field){var c=n.Field[l];if(null==c.GroupField){s=document.getElementById("diidSort"+e.ctxId+c.Name);c.Name!=t.SortField&&null!=s&&null!=(o=s.lastChild)&&(null==(u=o.previousSibling)||"IMG"!=u.tagName||u.src.substr(u.src.length-r.length)!=r&&u.src.substr(u.src.length-i.length)!=i||u.parentNode.removeChild(u));if(null!=s){var h=s.nextSibling;if(null==h){(h=document.createElement("IMG")).border=0;s.parentNode.appendChild(h)}var p=null!=t.FilterFields&&t.FilterFields.indexOf(";"+c.Name+";")>=0;h.src=p?"/_layouts/15/images/filter.gif":"/_layouts/15/images/blank.gif"}}}}}function AnimateListDelta(e,t){var n=e.ctxId,r=FetchTableBodies(t),i=r.oldbody,s=r.newbody,o=document.getElementById("scriptPaging"+e.wpq);if(null!=i||null!=s){e.operationType==SPListOperationType.PagingRight||(e.operationType,SPListOperationType.PagingLeft),FixupTable(i,s,o,n);ListModule.Settings.SupportsAnimation&&(g_fAnimateListCSR=!0)}}function FixupTable(e,t,n,r){var i=Boolean(e)?e.parentNode:t.parentNode;if(null!=i&&"TABLE"==i.nodeName){Boolean(e)&&"TBODY"==e.nodeName&&i.removeChild(e);Boolean(t)&&"TBODY"==t.nodeName&&(t.style.display="");"function"==typeof window.EnsureSelectionHandler&&window.EnsureSelectionHandler(null,i,r)}if("undefined"!=typeof ProcessImn&&"undefined"!=typeof imnCount&&"undefined"!=typeof bIMNOnloadAttached){imnCount=0;bIMNOnloadAttached=!1;ProcessImn()}null!=n&&"none"==n.style.display&&(n.style.display="")}function FetchTableBodies(e){for(var t,n=e.firstChild;null!=n&&"TBODY"!=n.nodeName;)n=n.nextSibling;if(null==n)t=null;else if("none"==n.style.display){t=n;n=null}else t=n.nextSibling;return{oldbody:n,newbody:t}}function FocusInfo_InitializePrototype(){FocusInfo.prototype={elem:null,id:null,tagName:null,focusInCLVPTab:null,fromRibbon:void 0,setActive:void 0}}function FocusInfo(){}function MergeListData(e,t){if(ListModule.Settings.SupportsMQuery)for(var n in t.Row){var r=!1;for(var i in e.Row)if(t.Row[n].ID!=e.Row[i].ID);else{r=!0;window.m$.extend(e.Row[i],t.Row[n])}r||e.Row.push(t.Row[n])}return e}exports.MergeListData=MergeListData;function EnableListAnimation(e){var t=!1;if(ListModule.Settings.SupportsAnimation){t=SPAnimation.Settings.IsAnimationEnabled()&&gridutil_1.JsGridUtil.Internal.IsNullOrUndefined(e.ListSchema.group1)&&gridutil_1.JsGridUtil.Internal.IsNullOrUndefined(e.ListSchema.group2)&&gridutil_1.JsGridUtil.Internal.IsNullOrUndefined(e.ListSchema.Aggregate)&&e.Templates.Body===RenderBodyTemplate&&(1==e.BaseViewID||101==e.ListTemplateType&&"1"==e.ListSchema.IsDocLib&&50==e.BaseViewID||700==e.ListTemplateType&&(51==e.BaseViewID||52==e.BaseViewID)||Boolean(e.RealHttpRoot)&&51==e.BaseViewID&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Boolean(e.RealHttpRoot)&&56==e.BaseViewID&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&!e.clvp.fRestore&&!e.skipNextAnimation&&!e.bNoDelete&&!e.inGridMode&&!e.leavingGridMode;e.skipNextAnimation=!1}return t}function InitAllClvps(){InitCLVPs()}function DeleteSelectedItemsCore(e,t,n,r,i,s){ListModule.Settings.SupportsItemDelete&&core_1.deleteSelectedItemsCore(e,t,n,r,i,s)}function RestoreAllClvpsNavigation(){EnumCLVPs(RestoreClvpNavigation)}function CLVPFromCtx(e,t){Boolean(t)&&EnsureCLVP(e);return void 0!==e.clvp?e.clvp:null}function EnsureCLVP(e){if(void 0===e.clvp){e.clvp=new CLVP(e);e.clvp.Init()}}function CLVPFromEventReal(e){return null==e?null:void 0!==e.currentCtx&&Boolean(e.currentCtx)?CLVPFromCtx(e.currentCtx,!0):"function"==typeof CLVPFromEventToolbar?CLVPFromEventToolbar(e):null}exports.CLVPFromEventReal=CLVPFromEventReal;function EnumCLVPs(callback){var fRet=!1;if("undefined"!=typeof g_ViewIdToViewCounterMap){var vid;for(vid in g_ViewIdToViewCounterMap){var ctxT;eval("ctxT = ctx"+g_ViewIdToViewCounterMap[vid]+";");var clvp=ctxT.clvp;if(null!=clvp){callback(clvp);fRet=!0}}}return fRet}function RestoreClvpNavigation(e){e.RestoreNavigation()}});
define("yqe",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){(function(t){function r(t,n){var r="";if(e.Utility.isObjectInstance(t))if(n){for(var i=new Sys.StringBuilder,s=0;s<t.length;s++){s>0&&i.append(";");e.JsonTerm.appendTo(i,t[s])}r=i.toString()}else r=e.JsonTerm.getLocalizedValue(t);return r}t.DataValueToInputValue=r;t.InputValueToDataValue=function(t,n){var r=null;if(!e.Utility.isNullOrEmpty(t))if(n){r=[];for(var i=t.split(";"),s=0;s<i.length;s++)r.push(e.JsonTerm.parseInputValue(i[s]))}else r=e.JsonTerm.parseInputValue(t);return r};t.SPListValueToGridValue=function(t,n,s){if(e.Utility.isNullOrUndefined(t))return null;var o=e.JsonTerm.create(t.get_label(),t.get_termGuid());return i(o,r(o,!1))};t.SPListValueCollectionToGridValue=function(t,n,s){for(var o=[],u=t.get_count(),a=0;a<u;a++){var f=e.JsonTerm.parseTaxonomyFieldValue(t.itemAt(a));o.push(f)}return i(o,r(o,!0))};t.GridValueToInputValue=function(t){var r=n.__assign({},t);e.Utility.isObject(t.data)||(r.data=null);e.Utility.isString(t.localized)||(r.localized="");return r.localized};function i(t,n){var r=t,i=n;e.Utility.isObject(t)||(r=null);e.Utility.isString(n)||(i="");return{data:r,localized:i}}t.CreateGridValue=i})(e.DataConverters||(e.DataConverters={}));(function(t){t.renderViewControl=function(t,n,r,i){var s="";if(t&&n&&r){var o=r[n.Name];e.Utility.isObjectInstance(o)&&(n.AllowMultipleValues?s=e.JsonTerm.arrayToDisplayString(o):e.Utility.isNullOrUndefined(o)||(s=o.Label))}return s}})(e.TaxonomyFieldTemplate||(e.TaxonomyFieldTemplate={}));(function(e){e.isObjectInstance=function(e){return!t(e)&&r(e)};function t(e){return null===e||n(e)}e.isNullOrUndefined=t;e.isNullOrEmpty=function(e){return t(e)||""===e};function n(e){return void 0===e}e.isUndefined=n;function r(e){return"object"==typeof e}e.isObject=r;e.isString=function(e){return"string"==typeof e}})(e.Utility||(e.Utility={}));(function(e){e.appendTo=function(e,t){e.append(t.Label);e.append("|");e.append(t.TermID)};e.getLocalizedValue=function(e){return e.Label+"|"+e.TermID};function t(e,t){var n={};n.Label=e;n.TermID=t;return n}e.create=t;e.parseInputValue=function(e){var n=e.split("|");return t(n[0],n[1])};e.parseTaxonomyFieldValue=function(e){return t(e.get_label(),e.get_termGuid())};e.arrayToDisplayString=function(e){var t=new Sys.StringBuilder;if(e)for(var n=0;n<e.length;n++){t.append(e[n].Label);t.append("; ")}return t.toString()}})(e.JsonTerm||(e.JsonTerm={}));var t=(function(){function t(e){this.ID="TaxonomyField";this.customFieldInfo=e}t.prototype.LocalizedValueToCSRValue=function(t){return e.DataConverters.InputValueToDataValue(t,!1)};t.prototype.BeginValidateNormalizeConvert=function(t,n,r,i,s,o){var u={};if(i){u.normalizedLocValue=r;u.dataValue=e.DataConverters.InputValueToDataValue(u.normalizedLocValue,!1)}else{u.dataValue=r;u.normalizedLocValue=SP.UI.Taxonomy.DataConverters.DataValueToInputValue(u.dataValue,!1)}u.isValid=!0;s&&s(u)};t.prototype.GetFieldSchema=function(e){return this.customFieldInfo?this.customFieldInfo[e]:null};return t})();e.TaxonomyFieldPropertyType=t})(t.Taxonomy||(t.Taxonomy={}))});
define("mQe",["require","exports","Lqe","Dqe","Aqe","Eqe","kqe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function u(e,t){for(var n={},r=0;r<e;r++)t.IsChangeKeyApplied(e[r].changeKey)&&(n[e[r].fieldKey]=0);return n}var a=(function(){function e(e){this._entryRecordKeyPrefix="NewRowKey";this._entryRecordKeys=new i.Set;this._entryRecords=[];this._entryRecordUpdates={};this._entryRecordKeyIdxCache={};this._committedRecordKeys=new i.Set;this._bRegisteredEvent=!1;this._bCurrentlyCommitting=!1;this._curEntryRecordIdx=0;this._bReadyToCommit=!1;this._commitErrorId=null;this._bClearingUncommittedChanges=!1;this._commitAttemptCompleteNotifiers=[];this._objBag=e}e.prototype.GetNextEntryRecordKey=function(){return this._entryRecordKeyPrefix+this._curEntryRecordIdx++};e.prototype.CreateEntryRecord=function(e,t){var i=null==t?this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.CreateEntryRecord):t;null==i.recordKey&&(i.recordKey=this.GetNextEntryRecordKey());n.JsGridUtil.DebugAssert(i.key()==i.recordKey);i.properties[this._objBag.jsGridParams.tableViewParams.keyFieldName].dataValue=i.recordKey;this._entryRecords.push(i);this._entryRecordKeyIdxCache[i.key()]=this._entryRecords.length-1;this._entryRecordKeys.Add(i.key());i.bIsNewRow=!0;i.newRowNumber=this._curEntryRecordIdx;this._objBag.paneMgr.NotifyCreateEntryRow(this._entryRecords.length-1,e);this._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnEntryRecordAdded,n.JsGridUtil.EventArgs.OnEntryRecordAdded(i.key()));return i};e.prototype.IsEntryRecordDirty=function(e){var t=this._objBag.controller.GetEarliestChangeKeyForRecord(e);return null!=t&&this._objBag.controller.IsChangeKeyApplied(t)};e.prototype.RemoveEntryRow=function(e,t){this._objBag.editUtil.IsNewRowEnabled()&&!t&&this._objBag.paneMgr.NotifyRemoveEntryRow(e);var n=this._entryRecords[e].key();this._entryRecords.splice(e,1);this._entryRecordKeys.Remove(n);this._entryRecordKeyIdxCache[n]=null;for(e=n+1;null!=this._entryRecordKeyIdxCache[e];++e)this._entryRecordKeyIdxCache[e]=this._entryRecordKeyIdxCache[e]-1;delete this._entryRecordUpdates[n];this._objBag.controller.ClearAllPropChangesForRecord(n);return n};e.prototype.RemoveLastEntryRecord=function(){var e=null;this._entryRecords.length>1&&(e=this.RemoveEntryRow(this._entryRecords.length-1));return e};e.prototype.ClearUncommittedEntryRecordsInternal=function(e,t){var n=this;this._bClearingUncommittedChanges=!0;this._objBag.paneMgr.StopEditing(!0);this._objBag.paneMgr.UnbindEditing(function(){if(null==t)for(;n._entryRecords.length>0;)n.RemoveEntryRow(0,e);else for(var r=0;r<n._entryRecords.length;r++)if(n._entryRecords[r].key()==t){n.RemoveEntryRow(r,e);break}n._bClearingUncommittedChanges=!1})};e.prototype.CreateEntryRecordWithChangeKey=function(e,t,r){var i=this,s=this.CreateEntryRecord(e,r);this._objBag.controller.AttachUndoActionToChangeKey(t,function(){var e=i.RemoveLastEntryRecord();n.JsGridUtil.DebugAssert(null==e||s.key()==e,"either the record we're removing should have been committed or it should be the record we added.")})};e.prototype.OnEntryRecordPropertyUpdated=function(e){this.GetLastEntryKey()==e.recordKey&&this.CreateEntryRecordWithChangeKey(!1,e.changeKey);if(e.validationState==r.JsGridConstants.ValidationState.Valid){null==this._entryRecordUpdates[e.recordKey]&&(this._entryRecordUpdates[e.recordKey]=[]);this._entryRecordUpdates[e.recordKey].push(e);e.recordKey==this._entryRecords[0].key()&&this.ForceReadyToCommit()}var t=this._objBag.paneMgr.GetFocusedItemInfo();null!=t&&t.recordKey==e.recordKey||this.TryCommitFirstEntryRecord()};e.prototype.ForceReadyToCommit=function(){this._bReadyToCommit=!0;if(null!=this._commitErrorId){var e=this._objBag.errorMgr.ClearRowError(this._entryRecords[0].key(),this._commitErrorId);n.JsGridUtil.DebugAssert(e);this._commitErrorId=null}};e.prototype.OnRowFocusChanged=function(e){this._entryRecords.length>0&&e.oldRecordKey==this._entryRecords[0].key()&&this.TryCommitFirstEntryRecord()};e.prototype.OnRecordFailedCommit=function(e,t){this._objBag.commandMgr.Unlock();this._bCurrentlyCommitting=!1;this._bReadyToCommit=!1;this._commitErrorId=null!=t?t:this._objBag.errorMgr.SetRowError(this._entryRecords[0].key(),e)};e.prototype.OnRecordSuceededCommit=function(e,t,n){this._objBag.commandMgr.Unlock();this._bCurrentlyCommitting=!1;return this.Commit(e,t,n)};e.prototype.Commit=function(e,t,i){var s=this._entryRecords[0],o=s.key(),a=u(this._entryRecordUpdates[o],this._objBag.jsGridObj);delete this._entryRecordUpdates[o];this._entryRecordKeys.Remove(o);this._committedRecordKeys.Add(o);if(null!=e&&e!==o){this._objBag.controller.ChangeKeys(o,e);s.recordKey=e;s.properties[this._objBag.jsGridParams.tableViewParams.keyFieldName].dataValue=s.recordKey}n.JsGridUtil.DebugAssert(null==s.key().startsWith||!s.key().startsWith(this._entryRecordKeyPrefix));this._entryRecords.shift();this._entryRecordKeyIdxCache={};delete s.bIsNewRow;for(var f in i)f in a||s.AddFieldValue(f,{hasData:!0,data:i[f]});for(var f in t)f in a||s.AddFieldValue(f,{hasLocalized:!0,localized:t[f]});var l=this._objBag.controller.GetEarliestChangeKeyForRecord(s.key());n.JsGridUtil.DebugAssert(this._objBag.controller.IsChangeKeyApplied(l));0==this._entryRecords.length&&this.CreateEntryRecordWithChangeKey(!1,l);var c=this._objBag.paneMgr.GetLastRecordKey();this._objBag.controller.InsertRecordAfter(c,s,l,!1,!0,null,!1);this._objBag.eventMgr.FireEvent(r.JsGridConstants.EventType.OnEntryRecordCommitted,n.JsGridUtil.EventArgs.OnEntryRecordCommitted(o,s.key(),l));this._objBag.paneMgr.NotifyChangedRowByKey(s.key());this.TryCommitFirstEntryRecord();return l};e.prototype.TryCommitFirstEntryRecords=function(e,t){null!=e&&this._commitAttemptCompleteNotifiers.push(e);t&&this.ForceReadyToCommit();this.TryCommitFirstEntryRecord()};e.prototype.TryCommitFirstEntryRecord=function(){var e=this,t=!1;if(!this._bCurrentlyCommitting&&this._bReadyToCommit&&this._entryRecords.length>0&&this._entryRecords[0].key()in this._entryRecordUpdates&&!this._bClearingUncommittedChanges&&this.IsEntryRecordDirty(this._entryRecords[0].key())){t=this._bCurrentlyCommitting=!0;this._objBag.commandMgr.Lock();setTimeout(function(){e._objBag.pendingChangeMgr.WaitForPendingUpdates(n)},0)}t||this._bCurrentlyCommitting||this.TryNotifyCommitComplete();var n=function(){if(e._objBag.errorMgr.AnyErrorsInRow(e._entryRecords[0].key())){e._bCurrentlyCommitting=!1;e._bReadyToCommit=!1;e._objBag.commandMgr.Unlock();e.TryNotifyCommitComplete()}else e._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.TryInsertEntryRecord,e._entryRecords[0],e._entryRecordUpdates[e._entryRecords[0].key()],e.OnRecordSuceededCommit.bind(e),e.OnRecordFailedCommit.bind(e))}};e.prototype.TryNotifyCommitComplete=function(){if(this._commitAttemptCompleteNotifiers.length>0)for(var e=!this.AnyUncomittedEntryRecords();this._commitAttemptCompleteNotifiers.length>0;)this._commitAttemptCompleteNotifiers.shift()(e)};e.prototype.CreateEntryRows=function(e,t,n){for(var r=0;r<e;r++)this.CreateEntryRecordWithChangeKey(!t,n)};e.prototype.AnyUncomittedEntryRecords=function(){return this._entryRecords.length>1||1==this._entryRecords.length&&this.IsEntryRecordDirty(this._entryRecords[0].key())};e.prototype.ClearUncommittedEntryRecords=function(){this.ClearUncommittedEntryRecordsInternal(!1,null)};e.prototype.ClearEntryRecord=function(e){this.ClearUncommittedEntryRecordsInternal(!1,e)};e.prototype.EnsureLastEntryRowExists=function(){if(this._objBag.editUtil.IsNewRowEnabled()&&0==this._entryRecords.length){this.CreateEntryRecord(!1);if(!this._bRegisteredEvent){this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnEntryRecordPropertyChanged,this.OnEntryRecordPropertyUpdated.bind(this));this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,this.OnRowFocusChanged.bind(this));this._bRegisteredEvent=!0}}};e.prototype.AddColumn=function(e,t){if(this._entryRecords.length>0){var n={isProp:!0,prop:s.PropertyType.Property.prototype.MakeProperty(void 0,void 0,t.hasDataValue,t.hasLocalizedValue,t.GetPropType())};this._entryRecords[0].AddFieldValue(e,n)}};e.prototype.NotifyTableViewChangeCompleted=function(){this._bReadyToCommit=!1;this.EnsureLastEntryRowExists()};e.prototype.NotifyTableViewCleared=function(){if(this._entryRecords.length>0){this.ClearUncommittedEntryRecordsInternal(!0,null);if(this._bRegisteredEvent){this._objBag.eventMgr.DetachEvent(r.JsGridConstants.EventType.OnEntryRecordPropertyChanged,this.OnEntryRecordPropertyUpdated.bind(this));this._objBag.eventMgr.DetachEvent(r.JsGridConstants.EventType.OnRowFocusChanged,this.OnRowFocusChanged.bind(this));this._bRegisteredEvent=!1}}};e.prototype.GetEntryRecords=function(){return this._entryRecords};e.prototype.IsEntryRecordKey=function(e){return this._entryRecordKeys.Contains(e)};e.prototype.GetLastEntryKey=function(){n.JsGridUtil.DebugAssert(this._entryRecords.length>0);return null!=this._objBag?this._entryRecords[this._entryRecords.length-1].key():null};e.prototype.GetEntryRecordIdx=function(e){if(null!=this._entryRecordKeyIdxCache[e])return this._entryRecordKeyIdxCache[e];var t=n.JsGridUtil.Internal.FindInArray(this._entryRecords,function(t){return e==t.key()});n.JsGridUtil.DebugAssert(null!=t);this._entryRecordKeyIdxCache[e]=t;return t};e.prototype.GetEntryRecord=function(e){return this._entryRecords[this.GetEntryRecordIdx(e)]};return e})();t.EntryRecordManager=a;var f=(function(){function e(e){this._provisionalRecordKeyPrefix="NewInsertedKey";this._currentKey=null;this._bPastingCells=!1;this._provisionalRecords={};this._provisionalRecordUpdates={};this._curProvisionalRecordIdx=0;this._bRegisteredEvents=!1;this._objBag=e}e.prototype.GetNextProvisionalRecordKey=function(){return this._provisionalRecordKeyPrefix+this._curProvisionalRecordIdx++};e.prototype.EnsureEventHandlers=function(){if(!this._bRegisteredEvents){this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnPropertyChanged,this.OnProvisionalRecordPropertyUpdated.bind(this));this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnPasteBegin,this.OnPasteBegin.bind(this));this._objBag.eventMgr.AttachEvent(r.JsGridConstants.EventType.OnPasteEnd,this.OnPasteEnd.bind(this));this._bRegisteredEvents=!0}};e.prototype.AnyUncomittedProvisionalRecords=function(){return!n.JsGridUtil.Internal.IsAssocArrayEmpty(this._provisionalRecords)};e.prototype.IsProvisionalRecordKey=function(e){return e in this._provisionalRecords};e.prototype.InsertProvisionalRecordBefore=function(e,t,n){return this.InsertionProvisionalRecord(e,t,this._objBag.jsGridObj.InsertRecordBefore,n)};e.prototype.InsertProvisionalRecordAfter=function(e,t,n){return this.InsertionProvisionalRecord(e,t,this._objBag.jsGridObj.InsertRecordAfter,n)};e.prototype.InsertionProvisionalRecord=function(e,t,i,s){var u=this;this.EnsureEventHandlers();t.recordKey=this.GetNextProvisionalRecordKey();this._provisionalRecords[t.key()]=t;var a=i(e,t,null,!0);(function(e,t,i){u._provisionalRecordUpdates[e]=[];if(null!=t)for(var s=0;s<t.length;s++)u._provisionalRecordUpdates[e].push(n.JsGridUtil.EventArgs.PropertyChanged(e,t[s].fieldKey,null,new o.PropertyUpdate(t[s].propertyValue.hasDataValue?t[s].propertyValue.dataValue:n.JsGridUtil.EmptyValue,t[s].propertyValue.hasLocalizedValue?t[s].propertyValue.localizedValue:n.JsGridUtil.EmptyValue),null,i,r.JsGridConstants.ValidationState.Pending))})(t.key(),s,a);this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.TryCreateProvisionalRecord,t,this._provisionalRecordUpdates[t.key()],function(e){u.OnSuccess.apply(u,[t.key()].concat(e))},this.OnFailed);return a};e.prototype.OnProvisionalRecordPropertyUpdated=function(e){var t=e.recordKey;if(null!=this._provisionalRecords[t]){null==this._provisionalRecordUpdates[t]&&(this._provisionalRecordUpdates[t]=[]);this._provisionalRecordUpdates[t].push(e);if(this._bPastingCells){var n=this._currentKey;this._currentKey=t;n!==t&&this.TryCommitProvisionalRecordUpdatesForKey(n)}else this.TryCommitProvisionalRecordUpdatesForKey(t)}};e.prototype.OnPasteBegin=function(){this._bPastingCells=!0;this._currentKey=null};e.prototype.OnPasteEnd=function(){this._bPastingCells=!1;this.TryCommitProvisionalRecordUpdatesForKey(this._currentKey)};e.prototype.TryCommitProvisionalRecordUpdatesForKey=function(e){var t=this;this._provisionalRecords[e]&&this._provisionalRecordUpdates[e]&&this._provisionalRecordUpdates[e].length>0&&this._objBag.delegateMgr.Apply(r.JsGridConstants.DelegateType.TryCreateProvisionalRecord,this._provisionalRecords[e],this._provisionalRecordUpdates[e],function(n){t.OnSuccess.apply(t,[e].concat(n))},this.OnFailed)};e.prototype.OnSuccess=function(e,t,n,r){var i=this._provisionalRecords[e],s=u(this._provisionalRecordUpdates[e],this._objBag.jsGridObj);delete this._provisionalRecords[e];delete this._provisionalRecordUpdates[e];if(null!=t&&t!==e){this._objBag.jsGridObj.ChangeKeys(e,t);i.recordKey=t;i.properties.ID.dataValue=i.recordKey}for(var o in n)o in s||i.AddFieldValue(o,{hasLocalized:!0,localized:n[o]});for(var o in r)o in s||i.AddFieldValue(o,{hasData:!0,data:r[o]});this._objBag.paneMgr.NotifyChangedRowByKey(i.key())};e.prototype.OnFailed=function(){};return e})();t.ProvisionalRecordManager=f});
define("Yqe",["require","exports","Lqe","Dqe","Wqe","Aqe","dQe","cQe","oQe","rQe","iQe","aQe","Zqe","dQe","Eqe","Rqe","Xqe","Nqe","bQe","Iqe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";w=w.panemgr_9;Object.defineProperty(t,"__esModule",{value:!0});var E={ODB:1725},S={ODB:1170},x=(function(){function e(e,t,s,h,p,d,v){var m=this;this.CONST_minPaneWidth=o.GetMinScrollBarLength();this.CONST_minControlWidth=2*this.CONST_minPaneWidth+r.JsGridConstants.Internal.SplitterWidth+o.GetSystemScrollBarThickness();this.CONST_minControlHeight=o.GetMinScrollBarLength()+o.GetSystemScrollBarThickness();this.rowData=[];this.recordCount=0;this.keyToViewIdxMap={};this.bHandlersSet=!1;this.bHorizontalScrollBarVisible=!0;this.cleared=!0;this.mostRecentMouseDownCoords=null;this.bResizingScrollbar=!1;this.bRefreshingAllRows=!1;this.bDeletingOrInsertingRows=!1;this.OnFocus_Window=function(e){m.cutcopypasteMgr.CheckClipboard()};this.OnResize_Window=function(e){m.HandleParentResize()};this.OnMouseDown=function(e){m.mostRecentMouseDownCoords={x:e.clientX,y:e.clientY};if(m._fnIsGridEnabled()){n.JsGridUtil.Internal.DomElement.GetInstance().StopEvent(e);m.Focus()}};this._jsGridElementId=e;this._objBag=t;this._fnGetLocStr=s;this._parentNode=h;this._minHeaderHeight=p;this._minRowHeight=d;this._fnIsGridEnabled=v;this.lastParentSize={height:h.offsetHeight,width:h.offsetWidth};this.selectionMgr=this._objBag.selectionMgr=new i.SelectionManager(function(e){null!=m.eventSinks.OnFocusedCellChanged&&m.eventSinks.OnFocusedCellChanged(e)});this.changeHighlightMgr=new u.ChangeHighlightManager;this.editMgr=new a.EditManager(this._objBag,function(e,t,n,r){m.eventSinks.OnPropertiesChanged(e,t,n,r)},this.GetCellValue.bind(this));this.cutcopypasteMgr=this._objBag.cutcopypasteMgr=new f.CutCopyPasteManager(this._objBag,s);this.fillDownMgr=new l.FillDownManager(this._objBag.intDelegateMgr,this._objBag.styleMgr);this.focusMgr=this._objBag.focusMgr=new c.FocusManager(e,this._objBag,h,s,v,this.IsGridVisible.bind(this),this.selectionMgr,this.editMgr,this.GetCellValue.bind(this),this.RetryErrorRows.bind(this),this.ScrollIntoViewVertically.bind(this));this.Init()}e.prototype.SetEventSinks=function(e){this.eventSinks=e};e.prototype.Dispose=function(){var e=this,t=function(){e.vertScrollBarContainer=e.leftPaneParent=e.rightPaneParent=e._parentNode=e.borderElement=null;e.editMgr.Dispose();e.focusMgr.Dispose();null!=e.touchMgr&&e.touchMgr.Dispose()};if(null!=this.panes){this.cutcopypasteMgr.CancelMode();this.editMgr.StopEditing(!0);this.editMgr.Unbind(function(){e.UpdatePanes(0,e.rowData.length,0,0,!0);e.panes.each("Dispose");e.vertScrollBar.Dispose();e._parentNode.removeEventListener("mousedown",e.OnMouseDown);window.removeEventListener("focus",e.OnFocus_Window);window.removeEventListener("resize",e.OnResize_Window);t()})}else t()};e.prototype.ClearView=function(){this.cleared=!0;this._objBag.entryRecordMgr.NotifyTableViewCleared();this.editMgr.Unbind();this.selectionMgr.Clear();this.cutcopypasteMgr.CancelMode();this.RefreshAllRows(0);null!=this.panes&&this.panes.each("ClearView")};e.prototype.NotifyCreateEntryRow=function(e,t){if(null!=this.posConverter){var n=e+this.posConverter.GetViewRecordCount(),r=this.posConverter.ViewIdxToRelViewIdx(n);this.UpdateRecordCount(1);this.vertScrollBar.GetItemDisplayCapacity()>r?this.UpdatePanes(0,0,r,1,!0):t&&this.ScrollIntoViewVertically(n)}};e.prototype.NotifyRemoveEntryRow=function(e){null!=this.posConverter&&this.NotifyDeleteRows(e+this.posConverter.GetViewRecordCount(),1)};e.prototype.GetLastRecordKey=function(){return null!=this.posConverter?this.posConverter.GetLastRecordKey():null};e.prototype.ChangeKeys=function(e,t){this.panes.each("ChangeKeys",e,t);if(e in this.keyToViewIdxMap){this.keyToViewIdxMap[t]=this.keyToViewIdxMap[e];delete this.keyToViewIdxMap[e]}};e.prototype.GetVirtualRowCount=function(){return this.gridPane.GetGridPaneConverter().GetVirtualRowCount()};e.prototype.GetVisibleRecordCount=function(){return Math.min(this.recordCount-this.vertScrollBar.GetTopItemIdx(),this.vertScrollBar.GetItemDisplayCapacity())};e.prototype.GetPartialRecordMap=function(e,t){var n,i=this.gridPane.GetGridPaneConverter();this._objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(t){return n=i.GetRecordsInvolved(e.begin,e.Size(),function(e){n=e;t()})},function(){t(n)})};e.prototype.GetRawRecordMap=function(e,t){var n,i=this;this._objBag.intDelegateMgr.Apply(r.JsGridConstants.Internal.DelegateType.CallAsyncFn,function(){i._objBag.tableCache.GetRawDataRecords();return n=i._objBag.tableCache.GetRecordCache()},function(){t(n)})};e.prototype.GetRecordMap=function(e){var t=this.gridPane.GetGridPaneConverter(),n=new s.Range(0,t.GetVirtualRowCount()-1);this.GetPartialRecordMap(n,e)};e.prototype.GetGridPaneRowRange=function(){return new s.Range(0,this.gridPane.GetGridPaneConverter().GetVirtualRowCount()-1)};e.prototype.AddColumn=function(e,t){var n=this.gridPane.GetAllColumns(),r=t||"JSGrid_NewColumn",i=n.GetColumnPosition(r);t&&i++;n.InsertColumnAt(i,e)};e.prototype.GetAllDataJson=function(e,t){this.GenerateGridDataJson(e,t,!1)};e.prototype.GetAllDataAfterExpansionJson=function(e,t){this.GenerateGridDataJson(e,t,!0)};e.prototype.GenerateGridDataJson=function(e,t,n){var r=this;this._objBag.jsGridObj.Disable();var i=this.gridPane.GetGridPaneConverter(),o=n?new s.Range(0,this._objBag.tableCache.GetRecordCacheSize()-1):new s.Range(0,i.GetVirtualRowCount()-1),u=new s.Range(0,i.GetVirtualColumnCount()-1),a=null!=this.pivotedGridPane?this.pivotedGridPane.GetGridPaneConverter():null,f=null!=this.pivotedGridPane?a.GetRowMultiple():0,l=null!=this.pivotedGridPane?new s.Range(0,a.GetVirtualColumnCount()-1):null,c=function(e){for(var t=e.GetColumnArray(!0),n=[],r=0;r<t.length;++r)n.push(e.GetColumnByKey(t[r].columnKey).name);return n},h={gridPaneData:null,gridPaneColumns:null,gridPaneStyleData:{cellStyleData:[]},pivotedGridPaneData:null,pivotedGridPaneColumns:null,pivotedGridPaneStyleData:{cellStyleData:[]}},p=[],d=0,v=0,m=[],g=0,y=0,b=this.gridPane.GetAllColumns(),w=b.GetColumnArray();h.gridPaneColumns=c(b);null!=this.pivotedGridPane&&(h.pivotedGridPaneColumns=c(this.pivotedGridPane.GetAllColumns()));var E=function(e){var t=e,i=null;if(e.end-e.begin+1>128){t=new s.Range(e.begin,e.begin+128-1);i=new s.Range(e.begin+128,e.end)}n?r.GetRawRecordMap(t,function(e){return S(e,t,i)}):r.GetPartialRecordMap(t,function(e){return S(e,t,i)})},S=function(i,o,a){var c=r.gridPane.GetData(i,o,u,n);if(null!=t)for(var b in i)for(var S=r._objBag.paneMgr.RecordKeyToViewIdx(b),x=i[b],T=0;T<w.length;++T){var N=w[T].columnKey,C=t(x,N);null!=C&&h.gridPaneStyleData.cellStyleData.push({matrixRow:S,matrixColumn:T,styleText:C})}var k=JSON.stringify(c.matrix);p.push(k.substr(1,k.length-2));d+=c.height;v=c.width;var L=null;if(null!=r.pivotedGridPane){var A=new s.Range(o.begin*f,o.end*f+f-1);L=r.pivotedGridPane.GetData(i,A,l,n);var O=JSON.stringify(L.matrix);m.push(O.substr(1,O.length-2));g+=L.height;y=L.width}null!=a?setTimeout(function(){E(a)},0):setTimeout(function(){var t=["{",'"gridPaneData":{"matrix":',"[",p.join(","),"]",',"height":',d,',"width":',v,"},",'"gridPaneColumns":',JSON.stringify(h.gridPaneColumns),",",'"gridPaneStyleData":',JSON.stringify(h.gridPaneStyleData),",",'"pivotedGridPaneData":',null!=r.pivotedGridPane?['{"matrix":',"[",m.join(","),"]",',"height":',g,',"width":',y,"}"].join(""):"null",",",'"pivotedGridPaneColumns":',null!=r.pivotedGridPane?JSON.stringify(h.pivotedGridPaneColumns):"null",",",'"pivotedGridPaneStyleData":',JSON.stringify(h.pivotedGridPaneStyleData),",",'"pivotedGridPaneRowMultiple":',f,"}"].join("");r._objBag.jsGridObj.Enable();setTimeout(function(){e(t)},0)},0)};E(o)};e.prototype.SetView=function(e,t,i,s,o,u,a,f,l,c,d,v,m,g,y,b,w,E,S){this.lastParentSize={height:this._parentNode.offsetHeight,width:this._parentNode.offsetWidth};0==this._parentNode.offsetHeight&&0==this._parentNode.offsetWidth&&(this.lastParentSize={height:this._parentNode.clientHeight,width:this._parentNode.clientWidth});this.cleared=!1;this.posConverter=e;this.paneLayout=y;this.gridFieldMap=i;this.splitterPos=u;this.bNewRowEnabled=this._objBag.editUtil.IsNewRowEnabled();this.posConverter.SetPaneMgrObj(this);this.posConverter.SetScrollBarObj(this.vertScrollBar);this.selectionMgr.SetAllowedSelectionTypes(f);this.cutcopypasteMgr.CancelMode();n.JsGridUtil.DebugAssert(this.paneLayout==r.JsGridConstants.PaneLayout.GridOnly||this.paneLayout==r.JsGridConstants.PaneLayout.GridAndGantt&&null!=b||this.paneLayout==r.JsGridConstants.PaneLayout.GridAndPivotedGrid&&null!=w);if(null==this.gridPane){this.CreateBorderHtmlElements();this.CreateSelectionBorderHtmlElements();this.CreateLeftPaneHtmlElements();var x=new T(this.leftPaneParent,this);this.gridPane=new h.GridPane(this.leftPaneParent,this._objBag,this.ScrollIntoViewVertically.bind(this),this.ScrollVerticallyByTouch.bind(this),this.paneLayout==r.JsGridConstants.PaneLayout.GridOnly?this.OnHorizontalGridPaneScrollBarVisibilityChange:null,this._objBag.commandMgr,this.selectionMgr,this.changeHighlightMgr,this.editMgr,this.cutcopypasteMgr,this.fillDownMgr,x,this.GetCellValue.bind(this),this._fnGetLocStr,this.RetryErrorRows,this.visualSelectionHtmlElements);this.gridPane.paneSize=x;this.panes=[this.gridPane];this.panes.each=N;this.touchMgr.RegisterTouchableAction("left",{element:this.leftPaneParent,control:this.gridPane})}else this.borderElement.style.display="none";null==this.vertScrollBar&&(this.vertScrollBar=new p.ScrollBar(p.ScrollBarType.Vertical,this.vertScrollBarContainer,!0,null,this._objBag.styleMgr.scrollBarStyle,this._objBag.RTL.bEnabled,this._objBag));this.posConverter.SetScrollBarObj(this.vertScrollBar);this.vertScrollBar.Update({topItemIdx:0,bScrollNotifiy:!1});this.CoordinateHeights();this.LayoutChildElements(!0);this.gridPane.SetView(e,o,this.AddSentinalColumns(t,E),this.gridFieldMap,a,l,c,d,v,m,g,S);null!=this.pivotedGridPane&&this.pivotedGridPane.SetView(e,o,w.columns,this.gridFieldMap,a,!1,!1,!1,!1,!1,!1,null);this.CoordinateHeights();this.panes.each("SetEventSinks",this.eventSinks);this.RefreshAllRows(s);if(!this.bHandlersSet){this.vertScrollBar.SetOnScroll(this.OnVerticalScroll.bind(this));this.vertScrollBar.SetOnVisibilityChanged(this.OnVerticalScrollbarVisibilityChanged.bind(this),!0);this._parentNode.addEventListener("mousedown",this.OnMouseDown);window.addEventListener("focus",this.OnFocus_Window);window.addEventListener("resize",this.OnResize_Window);this.bHandlersSet=!0}this.panes.each("OnResize");this.focusMgr.SetView(this.paneLayout,this.gridPane,this.pivotedGridPane,this.gridFieldMap,l,c,d,v,m,g,S);this._objBag.entryRecordMgr.NotifyTableViewChangeCompleted();this.borderElement.style.display=""};e.prototype.SetFilterState=function(e){this.gridPane.SetFilterState(e)};e.prototype.SetSortState=function(e){this.gridPane.SetSortState(e)};e.prototype.RecordKeyToViewIdx=function(e){return this.keyToViewIdxMap[e]};e.prototype.RefreshAllRows=function(e,t){this.bRefreshingAllRows=!0;if(null!=this.posConverter){this.SetRecordCount(this.posConverter.GetViewRecordCount(),e);this.UpdatePanes(0,this.rowData.length,0,this.GetVisibleRecordCount(),!t)}else this.UpdatePanes(0,this.rowData.length,0,this.rowData.length,!t);this.bRefreshingAllRows=!1};e.prototype.NotifyNewRowStateChanged=function(e){this.cutcopypasteMgr.CancelMode();var t=this.bNewRowEnabled;this.bNewRowEnabled=this._objBag.editUtil.IsNewRowEnabled();if(t!==this.bNewRowEnabled){this._objBag.entryRecordMgr.EnsureLastEntryRowExists();e||this.RefreshAllRows()}};e.prototype.NotifyChangedRowByKey=function(e){e in this.keyToViewIdxMap&&this.NotifyChangedRows(this.keyToViewIdxMap[e],1)};e.prototype.NotifyChangedRows=function(e,t){n.JsGridUtil.DebugAssert(e+t<=this.recordCount);var r=this.GetClippedRangeInfo(e,t);r.clippedCount<1||this.UpdatePanes(r.clippedRelViewIdx,r.clippedCount,r.clippedRelViewIdx,r.clippedCount,!1)};e.prototype.NotifyUpdateProperty=function(e,t,n,r,i,s){if(null!=e)this.panes.each("NotifyUpdateProperty",e,t,n,r,i,s);else for(var o=0;o<this.rowData.length;o++){var u=this.rowData[o];null!=u&&this.panes.each("NotifyUpdateProperty",u.recordKey,t,n,r,i,s)}};e.prototype.NotifyInsertRows=function(e,t,r,i){var s=this;n.JsGridUtil.DebugAssert(e<=this.recordCount&&t>=0);this.editMgr.Unbind(function(){s.bDeletingOrInsertingRows=!0;var n=s.vertScrollBar.GetTopItemIdx(),o=n+(e<n?t:0);s.UpdateRecordCount(t,o);s.bDeletingOrInsertingRows=!1;var u=s.GetClippedRangeInfo(e,t);if(u.clippedCount<1)s.RebuildKeyToPosMap();else{var a=u.clippedRelViewIdx,f=u.clippedCount,l=s.vertScrollBar.GetItemDisplayCapacity()-s.rowData.length,c=Math.max(f-l,0),h=s.rowData.length-c;s.UpdatePanes(h,c,a,f,!0);r&&s.UpdateFocusAfterInsertOrDeleteRows(e,t-1,!0);null!=i&&i()}})};e.prototype.NotifyDeleteRows=function(e,t){var r=this;this.editMgr.Unbind(function(){var i=r.GetClippedRangeInfo(e,t);r.bDeletingOrInsertingRows=!0;var s=r.vertScrollBar.GetTopItemIdx(),o=s+Math.max(Math.min(e-s,0),-t);r.UpdateRecordCount(-t,o);n.JsGridUtil.DebugAssert(r.vertScrollBar.GetTopItemIdx()<=o,"the scroll bar should never auto scroll down");var u=Math.max(o-r.vertScrollBar.GetTopItemIdx(),0);o=r.vertScrollBar.GetTopItemIdx();r.bDeletingOrInsertingRows=!1;if(i.clippedCount<1)r.RebuildKeyToPosMap();else{var a=r.vertScrollBar.GetItemDisplayCapacity(),f=o+a==r.recordCount+1&&r.vertScrollBar.PartialRowPresent(),l=r.rowData.length!==a,c=i.clippedRelViewIdx,h=Math.max(Math.min(c+i.clippedCount,r.rowData.length)-c,0);r.UpdatePanes(c,h,0,u,!0);var p=Math.max(Math.min(i.clippedCount,r.recordCount-r.rowData.length+u),0),d=Math.min(r.recordCount-(o+r.rowData.length),p);n.JsGridUtil.DebugAssert(d>=0,"Insert bottom count should not be negative.");r.UpdatePanes(0,0,r.rowData.length,d,!0);var v=p-d-u;v>0&&!l&&f&&v--;r.UpdatePanes(0,0,0,v,!0);r.UpdateFocusAfterInsertOrDeleteRows(e,t,!1)}})};e.prototype.UpdateFocusAfterInsertOrDeleteRows=function(e,t,n){this.panes.each("UpdateFocusAfterInsertOrDeleteRows",e,t,n)};e.prototype.ScrollCellIntoView=function(e,t,n){var r=this.GetPane(n);null!=e&&this.vertScrollBar.ScrollIntoView(r.GetGridPaneConverter().RowIdxToViewIdx(e));null!=t&&r.ScrollColumnIntoViewHorizontally(t)};e.prototype.ScrollUpByOne=function(){this.vertScrollBar.ScrollUpByOne()};e.prototype.ScrollDownByOne=function(){this.vertScrollBar.ScrollDownByOne()};e.prototype.IsCellEditable=function(e,t,n){var r=this.GetPane(n).GetGridPaneConverter(),i=r.GetColumnByIdx(r.FieldKeyToColIdx(t));return this._objBag.editUtil.CanEditField(e,i,t)};e.prototype.Focus=function(){this.focusMgr.Focus()};e.prototype.GetMostRecentMouseDownCoordinates=function(){return this.mostRecentMouseDownCoords};e.prototype.StopEditing=function(e){this.editMgr.StopEditing(e)};e.prototype.UnbindEditing=function(e){this.editMgr.Unbind(e)};e.prototype.NotifyResize=function(){this.HandleParentResize()};e.prototype.GetTopRowIndex=function(e){return this.GetPane(e).BeginRowIdx()};e.prototype.GetLeftColumnIndex=function(e){return this.GetPane(e).BeginColIdx()};e.prototype.ShowColumn=function(e,t){this.gridPane.ShowColumn(e,t)};e.prototype.EnsurePaneWidth=function(){this.gridPane.EnsurePaneWidth()};e.prototype.HideColumn=function(e){this.gridPane.HideColumn(e)};e.prototype.RenameColumn=function(e,t){this.gridPane.RenameColumn(e,t)};e.prototype.DeleteColumn=function(e){this.gridPane.DeleteColumn(e)};e.prototype.UpdateColumns=function(e){this.gridPane.UpdateColumns(e)};e.prototype.GetColumns=function(e){return this.FilterColumns(this.GetPane(e).GetColumns(),[r.JsGridConstants.RecordIndicatorCheckboxColumnKey,"JSGrid_NewColumn"])};e.prototype.GetRecordIndicatorCheckBoxColumnIndex=function(){var e=this.GetPane(null);return e&&n.JsGridUtil.Internal.FindInArray(e.GetColumns(),function(e){return e.columnKey==r.JsGridConstants.RecordIndicatorCheckboxColumnKey})};e.prototype.ScrollToAndExpandNextError=function(e,t,n,i){var s=this,o=null==t?this._objBag.errorMgr.GetNextError(e,n):this._objBag.errorMgr.GetNextErrorForRecord(e,t,n);if(null!=o){var u,a=this.posConverter.RecordKeyToViewIdx(o.recordKey);if(null!=a){for(var f=0;f<this.panes.length&&null==u;f++){var l=this.panes[f];if((l.Id==r.JsGridConstants.PaneId.MainGrid||l.Id==r.JsGridConstants.PaneId.PivotedGrid)&&null==(u=o.type==y.ErrorType.Row?0:l.GetGridPaneConverter().FieldKeyToColIdx(o.fieldKey))){var c=l.FieldKeyToColumnKey(o.fieldKey);if(null!=c){l.ShowColumn(c,null);u=l.GetGridPaneConverter().FieldKeyToColIdx(o.fieldKey)}}}this.ScrollCellIntoView(a,u,l.Id);if(o.type==y.ErrorType.Cell&&null!=u){this.selectionMgr.SetFocusByKey(l,o.recordKey,o.fieldKey);!0!==i&&setTimeout(function(){s.editMgr.ExpandWidget(r.JsGridConstants.ErrorWidgetId)},0)}return o.id}}return null};e.prototype.FilterColumns=function(e,t){for(var n=0;n<t.length;n++)for(var r=0;r<e.length;r++)if(e[r].columnKey==t[n]){e.splice(r,1);break}return e};e.prototype.ClearAllChangeIndications=function(){this.panes.each("NotifyChangeIndicatorsClearing");this.changeHighlightMgr.Clear()};e.prototype.GetFocusedItemInfo=function(){var e=this.selectionMgr.GetFocus();return null==e?null:{recordKey:e.recordKey,fieldKey:e.fieldKey,paneId:e.gridPane.Id}};e.prototype.JumpToEntryRecord=function(){if(this.bNewRowEnabled){var e=this._objBag.entryRecordMgr.GetLastEntryKey(),t=this.gridPane.GetColumns()[0].columnKey;this.gridPane.SelectByKey(e,e,t,t,!1);this.ScrollCellIntoView(this.posConverter.RecordKeyToViewIdx(e),0,this.gridPane.Id)}};e.prototype.GetSplitterPosition=function(){return null!=this.rightPane?this.splitterPos:0};e.prototype.SetSplitterPosition=function(e){this.SetSplitterPositionCore(e);this.LayoutChildElements()};e.prototype.Select=function(e,t,n,r,i,s){this.GetPane(s).Select(e,t,n,r,i)};e.prototype.SelectByKey=function(e,t,n,r,i,s){this.GetPane(s).SelectByKey(e,t,n,r,i)};e.prototype.GetOrderedSelections=function(e,t){return this.selectionMgr.GetOrderedSelections(this.GetPane(e),t)};e.prototype.NotifyCanEditUpdated=function(){this.panes.each("NotifyCanEditUpdated")};e.prototype.GetGridPane=function(){return this.gridPane};e.prototype.GetPane=function(e){var t=e==r.JsGridConstants.PaneId.MainGrid||null==e?this.gridPane:null;n.JsGridUtil.DebugAssert(null!=t,"Invalid PaneId ("+e+")");return t};e.prototype.SetSplitterPositionCore=function(e){null!=this.rightPane&&(this.splitterPos=Math.min(Math.max(e,this.CONST_minPaneWidth),this.GetControlWidth()-o.GetSystemScrollBarThickness()-(this.rightPane?this.CONST_minPaneWidth+r.JsGridConstants.Internal.SplitterWidth:0)))};e.prototype.GetControlWidth=function(){return Math.max(this.lastParentSize.width-2,this.CONST_minControlWidth)};e.prototype.GetControlHeight=function(){return Math.max(this.lastParentSize.height-2,this.CONST_minControlHeight)};e.prototype.AddSentinalColumns=function(e,t){var n=e;this._objBag.showAddColumnMenu&&this._objBag.canUserAddColumn&&(n=this.AddCreateColumn(n));return this.TryAddRecordIndicatorCheckboxesToColumns(n,t)};e.prototype.AddCreateColumn=function(e){var t="JSGrid_NewColumn";(this.gridFieldMap[t]=new v.GridField(t,!1,!1,r.JsGridConstants.TextDirection.Default,null,r.JsGridConstants.EditMode.ReadOnly)).SetSingleValuePropType(d.PropertyType.Utils.GetPropType("String"));if(n.JsGridUtil.Internal.IsFeatureEnabled(S)){var i;(i=new v.ColumnInfo("",null,t,150)).isResizable=!0;i.isSortable=!1;i.isHidable=!1;i.isAutoFilterable=!1;i.isFooter=!0;i.name="+ "+b.default.L_AddColumn_Text;i.bOpenMenuOnContentClick=!0;return new v.ColumnInfoCollection(e.GetColumnArray().concat([i]))}(i=new v.ColumnInfo("",null,t,r.JsGridConstants.Internal.IconColumnWidth)).isResizable=!1;i.isSortable=!1;i.isHidable=!1;i.isAutoFilterable=!1;i.isFooter=!0;i.name=this._fnGetLocStr("AddColumn");i.imgSrc=n.JsGridUtil.Internal.SiteUrl+"/_layouts/images/createview.gif";i.iconName="CalculatorAddition";i.isIconOnly=!0;i.bOpenMenuOnContentClick=!0;return new v.ColumnInfoCollection(e.GetColumnArray().concat([i]))};e.prototype.TryAddRecordIndicatorCheckboxesToColumns=function(e,t){var i=this,s=e;if(t){var o=r.JsGridConstants.RecordIndicatorCheckboxColumnKey,u=this.gridFieldMap[o]=new v.GridField(o,!1,!1,r.JsGridConstants.TextDirection.Default,null,r.JsGridConstants.EditMode.ReadOnly),a=n.JsGridUtil.Internal.object(d.PropertyType.Utils.GetPropType("CheckBoxBoolean"));a.ID="RecordIndicatorCheckBoxBoolean";a.GetDisplayValue=function(e,t,n){return i._objBag.checkSelMgr.IsRecordIndicatorCheckboxChecked(e.key())?SP.JsGrid.Res.checkboxChecked:SP.JsGrid.Res.checkboxUnchecked};d.PropertyType.RegisterNewDerivedCustomPropType(a,"CheckBoxBoolean");u.SetSingleValuePropType(a);var f=new v.ColumnInfo("",null,o,r.JsGridConstants.Internal.MinColumnWidth);f.isResizable=f.isSortable=f.isHidable=f.isAutoFilterable=f.isAutoFilterable=!1;f.fnGetDisplayControlName=function(){return i._objBag.gridControls[r.JsGridConstants.RecordIndicatorControlId].Id};s=new v.ColumnInfoCollection([f].concat(e.GetColumnArray()))}return s};e.prototype.Init=function(){};e.prototype.ScrollIntoViewVertically=function(e){return this.vertScrollBar.ScrollIntoView(e)};e.prototype.ScrollVerticallyByTouch=function(e){e?this.ScrollUpByOne():this.ScrollDownByOne()};e.prototype.SetRecordCount=function(e,t){this.recordCount=this.cleared?0:e+(this.bNewRowEnabled?this._objBag.entryRecordMgr.GetEntryRecords().length:0);this.vertScrollBar.Update({itemCount:this.recordCount,topItemIdx:t});return this.recordCount};e.prototype.UpdateRecordCount=function(e,t){this.recordCount+=e;this.vertScrollBar.Update({itemCount:this.recordCount,topItemIdx:t});return this.recordCount};e.prototype.GetClippedRangeInfo=function(e,t){var n=e,r=e+t-1;n=Math.max(0,Math.min(this.recordCount-1,n));r=Math.max(0,Math.min(this.recordCount-1,r));var i=this.posConverter.ViewIdxToRelViewIdx(n),s=this.posConverter.ViewIdxToRelViewIdx(r);return{clippedRelViewIdx:i=Math.max(i,0),clippedCount:(s=Math.min(s,this.vertScrollBar.GetItemDisplayCapacity()-1))-i+1}};e.prototype.CreateBorderHtmlElements=function(){this._parentNode.style.direction=this._objBag.RTL.ltr;this.borderElement=document.createElement("div");this.borderElement.style.width="100%";this._parentNode.appendChild(this.borderElement);this.touchMgr=new m.GridTouchManager(this.borderElement)};e.prototype.CreateLeftPaneHtmlElements=function(){this.leftPaneParent=document.createElement("div");this.leftPaneParent.id=this._jsGridElementId+"_leftpane";this.leftPaneParent.gridItem=!0;this.borderElement.appendChild(this.leftPaneParent);this.vertScrollBarContainer=document.createElement("div");this.vertScrollBarContainer.gridItem=!0;this.vertScrollBarContainer.style.cssText="display:none;";this.borderElement.appendChild(this.vertScrollBarContainer)};e.prototype.CreateDragHandle=function(){var e=n.JsGridUtil.Internal.IsFeatureEnabled(E),t=document.createElement("div");t.style.cssText=n.JsGridUtil.Internal.IsStickyColumnEnabled()?"":"position:absolute; visibility:hidden; top:0px; left:0px; width:0px; height:0px;";if(e){t.style.width=t.style.height="6px";t.classList.add(w.selectionDragHandle)}else{t.style.width=t.style.height="5px";t.style.cursor="crosshair"}if(n.JsGridUtil.Internal.IsStickyColumnEnabled()){var r=document.createElement("div");r.classList.add(w.selectionDragHandleContents);t.classList.add(w.selectionDragHandleContainer);t.classList.remove(w.selectionDragHandle);t.style.height=null;t.style.width="1px";t.appendChild(r);this._objBag.parentNode.insertBefore(t,this._objBag.parentNode.children[0])}else this._objBag.parentNode.appendChild(t);return t};e.prototype.CreateSelectionBorderHtmlElements=function(){var e=n.JsGridUtil.Internal.IsFeatureEnabled(E),t="position:absolute; visibility:hidden; top:0px; left:0px; width:0px; height:0px;",r=this.CreateDragHandle(),i={Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")};for(var s in i){var o=i[s];o.style.cssText=t;e&&this.AddFrameElementClassName(o,s);this._objBag.parentNode.appendChild(o)}var u={Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")};for(var s in u){var a=u[s];a.style.cssText=t;if(e){this.AddFrameElementClassName(a,s);a.style.borderWidth="2px";a.style.cursor="default"}else a.style["border"+s]=g.StyleUtil.MakeBorderString(1,"solid",this._objBag.styleMgr.gridPaneStyle.selectionRectBorderColor);this._objBag.parentNode.appendChild(a)}var f={Back:{Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")},Fore:{Top:document.createElement("div"),Right:document.createElement("div"),Bottom:document.createElement("div"),Left:document.createElement("div")}};for(var s in f){var l=void 0,c=void 0;e?c="Back"===s?w.solidBorder:w.dashedBorder:l="Back"==s?g.StyleUtil.MakeBorderString(2,"solid",this._objBag.styleMgr.gridPaneStyle.copyRectBackBorderColor):g.StyleUtil.MakeBorderString(2,"dashed",this._objBag.styleMgr.gridPaneStyle.copyRectForeBorderColor);for(var h in f[s]){var p=f[s][h];p.style.cssText=t;if(e){p.classList.add(c,w.copyFrame);this.AddFrameElementClassName(p,h)}else p.style["border"+h]=l;this._objBag.parentNode.appendChild(p)}}this.visualSelectionHtmlElements={selectionDragHandle:r,selectionFrames:i,focusFrames:u,copyFrames:f}};e.prototype.AddFrameElementClassName=function(e,t){switch(t){case"Top":e.classList.add(w.topFrameElement);break;case"Bottom":e.classList.add(w.bottomFrameElement);break;case"Left":e.classList.add(w.leftFrameElement);break;case"Right":e.classList.add(w.rightFrameElement)}};e.prototype.GetEffectiveHorizontalScrollBarHeight=function(){return this.bHorizontalScrollBarVisible?o.GetSystemScrollBarThickness():0};e.prototype.GetEffectiveVerticalScrollBarWidth=function(){return"none"!==this.vertScrollBarContainer.style.display?o.GetSystemScrollBarThickness():0};e.prototype.LayoutChildElements=function(e){this.SetSplitterPositionCore(this.splitterPos);var t=this.GetControlHeight();null!=this.vertScrollBar&&this.vertScrollBar.Update({physicalViewportSize:t-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight(),scrollbarSize:t});var n=this.GetControlWidth();if(null!=this.rightPaneParent){var i=this.splitterPos,s=n-(this.splitterPos+r.JsGridConstants.Internal.SplitterWidth+this.GetEffectiveVerticalScrollBarWidth());if(this._objBag.RTL.bEnabled){this.rightPane.paneSize.SetValues(s,this.GetEffectiveVerticalScrollBarWidth());this.gridPane.paneSize.SetValues(i,n-i)}else{this.gridPane.paneSize.SetValues(i,0);this.rightPane.paneSize.SetValues(s,n-this.GetEffectiveVerticalScrollBarWidth()-s)}}else{i=n-this.GetEffectiveVerticalScrollBarWidth();this.gridPane.paneSize.SetValues(i,this._objBag.RTL.bEnabled?this.GetEffectiveVerticalScrollBarWidth():0)}this.cleared||e||this.panes.each("OnResize");this.editMgr.NotifyMove()};e.prototype.HandleParentResize=function(){this.borderElement.style.display="none";if(!this.IsGridVisible()||this._parentNode.offsetHeight==this.lastParentSize.height&&this._parentNode.offsetWidth==this.lastParentSize.width)this.borderElement.style.display="";else{this.lastParentSize={height:this._parentNode.offsetHeight,width:this._parentNode.offsetWidth};this.borderElement.style.display="";n.JsGridUtil.Internal.DomElement.GetInstance().ForceIEZoomFactorRecomputation();var e=this.vertScrollBar.GetItemDisplayCapacity(),t=this.vertScrollBar.GetTopItemIdx();this.bResizingScrollbar=!0;this.LayoutChildElements();var r=this.GetControlHeight();this.vertScrollBar.SetViewportSize(r-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight(),!0,r-this.GetEffectiveHorizontalScrollBarHeight());this.bResizingScrollbar=!1;this.ModifyRowsForNewViewport(e,t)}};e.prototype.CoordinateHeights=function(){var e=this.headerHeight,t=this.rowHeight;this.headerHeight=this._minHeaderHeight?this._minHeaderHeight:0;this.headerHeight=Math.max(this.headerHeight,this.gridPane.GetMinHeaderHeight());if(this.rightPane){this.headerHeight=Math.max(this.headerHeight,this.rightPane.GetMinHeaderHeight());this.rightPane.SetHeaderHeight(this.headerHeight)}this.gridPane.SetHeaderHeight(this.headerHeight);this.rowHeight=this._minRowHeight?this._minRowHeight:0;this.rowHeight=Math.max(this.rowHeight,this.gridPane.GetMinRowHeight());if(this.rightPane){this.rowHeight=Math.max(this.rowHeight,this.rightPane.GetMinRowHeight());this.rightPane.SetRowHeight(this.rowHeight)}this.gridPane.SetRowHeight(this.rowHeight);e===this.headerHeight&&t===this.rowHeight||null==this.vertScrollBar||this.vertScrollBar.Update({physicalViewportSize:this.GetControlHeight()-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight(),scrollbarSize:this.GetControlHeight(),itemSize:this.rowHeight})};e.prototype.OnVerticalScrollbarVisibilityChanged=function(e){this.vertScrollBarContainer.style.display=e?"":"none";this.LayoutChildElements()};e.prototype.OnHorizontalGridPaneScrollBarVisibilityChange=function(e){this.bHorizontalScrollBarVisible=e;this.vertScrollBar.Update({bOtherScrollMeets:e,physicalViewportSize:this.GetControlHeight()-this.headerHeight-this.GetEffectiveHorizontalScrollBarHeight()})};e.prototype.OnVerticalScroll=function(e,t){var n=e.topIdx-t;0===n||this.bResizingScrollbar||this.bRefreshingAllRows||this.bDeletingOrInsertingRows||(n<0?this.ScrollUp(e.topIdx,-n):this.ScrollDown(e.topIdx,n))};e.prototype.ScrollDown=function(e,t){var n=this.vertScrollBar.GetItemDisplayCapacity(),r=e+n==this.recordCount+1&&this.vertScrollBar.PartialRowPresent(),i=Math.min(t,n),s=i-(r?1:0),o=n-i;this.UpdatePanes(0,i,o,s,!1)};e.prototype.ScrollUp=function(e,t){var n=this.vertScrollBar.GetItemDisplayCapacity(),r=this.rowData.length!==n,i=Math.min(Math.min(t,this.recordCount),n),s=i-(r?1:0),o=n-i;this.UpdatePanes(o,s,0,i,!1)};e.prototype.ModifyRowsForNewViewport=function(e,t){var r=this.vertScrollBar.GetItemDisplayCapacity(),i=r-e,s=this.vertScrollBar.GetTopItemIdx();if(i<0){var o=Math.max(this.rowData.length-r,0),u=this.rowData.length-o;this.UpdatePanes(u,o,null,0,!1)}else if(i>0){var a=t-s;n.JsGridUtil.DebugAssert(a>=0);this.UpdatePanes(null,0,0,a,!1);n.JsGridUtil.DebugAssert(i>=a);var f=i-a,l=this.rowData.length,c=this.posConverter.RelViewIdxToViewIdx(l);f=Math.min(c+f,this.recordCount)-c;this.UpdatePanes(null,0,l,f,!1)}};e.prototype.UpdatePanes=function(e,t,r,i,s){n.JsGridUtil.DebugAssert(t>=0&&i>=0);var o=null!=e&&t>0,u=null!=r&&i>0;if(o||u){var a=u&&i>0?this.posConverter.GetViewRecords(this.posConverter.RelViewIdxToViewIdx(r),i,this.RenderMissingRows).records:[];o&&this.rowData.splice(e,t);if(u){n.JsGridUtil.DebugAssert(null==this.rowData||0==this.rowData.length||null==a[0]||null==this.rowData[0]||this.rowData[0].recordKey!=a[0].recordKey,"Inserting duplicate key in rowData!");Array.prototype.splice.apply(this.rowData,[r,0].concat(a))}this.RebuildKeyToPosMap();this.panes.each("SpliceRows",e,t,r,a,s);this.editMgr.NotifyMove()}};e.prototype.RetryErrorRows=function(){this.RenderMissingRows(this.vertScrollBar.GetTopItemIdx(),this.rowData.length,!0)};e.prototype.RenderMissingRows=function(e,t,i,o){var u=this;if(void 0!==n.JsGridUtil.Internal.FindKey(this.rowData,function(e){return null==e})){var a=this.vertScrollBar.GetTopItemIdx(),f={};if(i&&a!=o){var l=this.posConverter.GetViewRecords(a,this.rowData.length,function(e,t,n){u.RenderMissingRows(e,t,n,a)}).records;for(h=0;h<this.rowData.length;h++)null==this.rowData[h]&&(f[h]=this.rowData[h]=l[h]);this.rowData=[].concat(this.rowData);this.RebuildKeyToPosMap()}else for(var c=new s.Range(e,e+t-1),h=0;h<this.rowData.length;h++)null==this.rowData[h]&&c.Contains(a+h)&&(f[h]=r.JsGridConstants.Internal.LoadErrorState);this.panes.each("RenderRows",f)}};e.prototype.RebuildKeyToPosMap=function(){this.keyToViewIdxMap={};for(var e=this.posConverter.GetTopViewIdx(),t=0;t<this.rowData.length;t++)null!=this.rowData[t]&&(this.keyToViewIdxMap[this.rowData[t].key()]=t+e)};e.prototype.GetCellValue=function(e,t,r){return{data:e.HasDataValue(t)?e.GetDataValue(t):n.JsGridUtil.EmptyValue,localized:null!=r&&null!=r.GetDisplayValue?r.GetDisplayValue(e,e.HasDataValue(t)?e.GetDataValue(t):null,e.HasLocalizedValue(t)?e.GetLocalizedValue(t):null):e.HasLocalizedValue(t)?e.GetLocalizedValue(t):n.JsGridUtil.EmptyValue}};e.prototype.IsGridVisible=function(){return this._parentNode.offsetHeight>0&&this._parentNode.offsetWidth>0};return e})();t.PaneManager=x;var T=(function(){function e(e,t){this._pangeMgr=t}e.prototype.SetValues=function(e,t){this.width=e;this.leftOffset=t};e.prototype.GetHeight=function(){return this._pangeMgr.GetControlHeight()};e.prototype.GetWidth=function(){return this.width};e.prototype.GetLeftOffset=function(){return this.leftOffset};e.prototype.Dispose=function(){};return e})();function N(e){for(var t=Array.prototype.slice.call(arguments,1),n=0;n<this.length;++n){var r=this[n][e];r&&r.apply(this[n],t)}}});
define("Qqe",["require","exports","Lqe","Dqe","Eqe","zqe","Vqe","we"],function(require,exports,gridutil_1,constants_1,property_1,jsgridobj_1,tablecache_1,StringHelper){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var QuickEditVisualRefreshFlight={ODB:1725};function AdjustPrintPreviewGridDivWidth(e,t,n,r){for(var i=0,s=0;s<e.length;++s)e[s].isVisible&&(i+=e[s].width);i+=t?gridutil_1.JsGridUtil.Internal.IsFeatureEnabled(QuickEditVisualRefreshFlight)?constants_1.JsGridConstants.Internal.RowHeaderWidthNewStyles:constants_1.JsGridConstants.Internal.RowHeaderWidth:0;i+=n?constants_1.JsGridConstants.Internal.SplitterWidth+r:0;i+=2;document.getElementById("jsgrid_div_element").style.width=i+"px";return i}var PrintPreviewGrid=(function(){function e(){this._bLimitRecordSize=!1;this._enableGantt=!1;this._ganttDelegateNames=null}e.prototype.Init=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g=this;this._enableGantt=c;this._ganttDelegateNames=h;this._ganttPaneWidth=p;this._ganttZoomLevel=d;this._groupingStyles=n;property_1.PropertyType.Internal.Property.GetInstance().RegisterDefaultPropTypesFromDefaultDisplayControlMap(s,o);var y=this.CallGlobalFunc(u,[a]);this._jsGridControl=e;this._jsGridParams=new jsgridobj_1.JsGridControlParameters({});this._jsGridParams.name=StringHelper.format(SP.JsGrid.Res.printPreviewName,this._jsGridControl.name);this._jsGridParams.tableViewParams=t;for(var b in this._jsGridParams.tableViewParams.gridFieldMap){var w=this._jsGridParams.tableViewParams.gridFieldMap[b];null!=w._propType&&(w._propType.ID in o||!w._propType.bMultiValue?property_1.PropertyType.Internal.Property.GetInstance().PropTypeExists(w._propType.ID)&&(w._propType=property_1.PropertyType.Internal.Property.GetInstance().GetPropType(w._propType.ID)):w._propType.bMultiValue&&(w._propType=new property_1.PropertyType.MultiValuePropType(w._propType.singleValuePropType.ID,w._propType.separator,!property_1.PropertyType.Internal.Property.GetInstance().PropTypeExists(w._propType.singleValuePropType.ID))))}null!=y&&"function"==typeof y&&y(this._jsGridParams,this._jsGridControl);this.CallGlobalFunc(f,[this._jsGridParams.tableViewParams,l]);this.CallGlobalFunc(v,[this._jsGridParams.tableViewParams,this._jsGridControl,m]);this._tableCache=new tablecache_1.TableCache(null,function(e,t){var n=new Array(t.length);for(var r in t){var i=e[t[r]],s=g._recordFactory.MakeRecord(i.data,i.localized,g._bLimitRecordSize);s.fieldRawDataMap=i.fieldRawDataMap;s.fieldRawLocMap=i.fieldRawLocMap;n[t[r]]=s}return n});this.LoadDataIntoTableCache(r,t.gridFieldMap,i);this._jsGridParams.tableCache=this._tableCache;this.SetJsGridParameters();this._jsGridControl.Init(this._jsGridParams);window.document.body.addEventListener("mouseup",function(){var e=document.getElementById("jsgrid_div_element").clientWidth,t=AdjustPrintPreviewGridDivWidth(g._jsGridControl.GetColumns(),g._jsGridParams.tableViewParams.bRowHeadersEnabled,g._enableGantt,g._ganttPaneWidth);g._jsGridControl.NotifyResize();if(g._enableGantt){var n=g._jsGridControl.GetSplitterPosition();g._jsGridControl.SetSplitterPosition(n+(t-e))}});setTimeout(function(){window.print()},0)};e.prototype.CallGlobalFunc=function(e,t){if(null==e)return null;for(var n=e.split("."),r=window,i=0;i<n.length;++i){if(i==n.length-1&&n[i]in r&&"function"==typeof r[n[i]])return r[n[i]].apply(null,t);if(!(n[i]in r))break;r=r[n[i]]}return null};e.prototype.LoadDataIntoTableCache=function(e,t,n){this._tableCache.Clear();this._tableCache.AddRawDataToCache(gridutil_1.JsGridUtil.Internal.ConvertSetKeysToArray(e),e);this._recordFactory=new property_1.PropertyType.RecordFactory(t,n)};e.prototype.SetJsGridParameters=function(){this._jsGridParams.styleManager.groupingStyles=this._groupingStyles;if(this._enableGantt){this._jsGridParams.tableViewParams.splitterPos=document.getElementById("jsgrid_div_element").clientWidth,this._ganttPaneWidth,constants_1.JsGridConstants.Internal.SplitterWidth;this._jsGridParams.tableViewParams.ganttParams.ganttZoomLevel=this._ganttZoomLevel;if(null!=this._ganttDelegateNames){null!=this._ganttDelegateNames.fnGetGanttBarDate&&this._ganttDelegateNames.fnGetGanttBarDate in window&&(this._jsGridParams.tableViewParams.ganttParams.fnGetGanttBarDate=window[this._ganttDelegateNames.fnGetGanttBarDate]);null!=this._ganttDelegateNames.fnGetGanttBarStyleIds&&this._ganttDelegateNames.fnGetGanttBarStyleIds in window&&(this._jsGridParams.tableViewParams.ganttParams.fnGetGanttBarStyleIds=window[this._ganttDelegateNames.fnGetGanttBarStyleIds]);null!=this._ganttDelegateNames.fnRenderGanttRow&&this._ganttDelegateNames.fnRenderGanttRow in window&&(this._jsGridParams.tableViewParams.ganttParams.fnRenderGanttRow=window[this._ganttDelegateNames.fnRenderGanttRow]);null!=this._ganttDelegateNames.fnGetPredecessors&&this._ganttDelegateNames.fnGetPredecessors in window&&(this._jsGridParams.tableViewParams.ganttParams.fnGetPredecessors=window[this._ganttDelegateNames.fnGetPredecessors])}}else{this._jsGridParams.tableViewParams.ganttParams=null;this._jsGridParams.tableViewParams.paneLayout=constants_1.JsGridConstants.PaneLayout.GridOnly}this._jsGridParams.tableViewParams.bMovableColumns=!0;this._jsGridParams.tableViewParams.bResizableColumns=!0;this._jsGridParams.tableViewParams.bEditingEnabled=!1;this._jsGridParams.tableViewParams.allowedSelectionTypes=0;this._jsGridParams.tableViewParams.bNewRowEnabled=!1;this._jsGridParams.tableViewParams.bSortableColumns=!1;this._jsGridParams.tableViewParams.bHidableColumns=!1;this._jsGridParams.tableViewParams.bAutoFilterableColumns=!1;this._jsGridParams.tableViewParams.bRecordIndicatorCheckboxesEnabled=!1};return e})();exports.PrintPreviewGrid=PrintPreviewGrid;function CreatePrintPreviewBlobFromRecords(e){for(var t={},n=0;n<e.length;++n){var r=e[n],i={},s={};for(var o in r.properties){i[o]=r.properties[o].dataValue;r.properties[o].HasLocalizedValue()&&(s[o]=r.properties[o].localizedValue)}t[r.key()]={data:i,localized:s,fieldRawDataMap:r.fieldRawDataMap,fieldRawLocMap:r.fieldRawLocMap}}return t}function GetSerializedUnfilteredHierarchyManagerClone(e){return JSON.stringify({unfilteredHierMap:e.rowViewParams.unfilteredHierarchyMgr.GetUnfilteredHierarchyMap(),topNodeKey:e.rowViewParams.unfilteredHierarchyMgr.GetTopNodeKey()})}function GetSerializedTableViewParametersClone(e){var t={};for(var n in e.gridFieldMap)t[n]=GetSerializedGridFieldClone(e.gridFieldMap[n]);return JSON.stringify({simpleFields:{messageOverrides:e.messageOverrides,operationalConstantsFieldKeyMap:e.operationalConstantsFieldKeyMap,defaultEditMode:e.defaultEditMode,allowedSelectionTypes:e.allowedSelectionTypes,bMovableColumns:e.bMovableColumns,bResizableColumns:e.bResizableColumns,bHidableColumns:e.bHidableColumns,bSortableColumns:e.bSortableColumns,bAutoFilterableColumns:e.bAutoFilterableColumns,bRowHeadersEnabled:e.bRowHeadersEnabled,bRecordIndicatorCheckboxesEnabled:e.bRecordIndicatorCheckboxesEnabled,checkSelectionCheckboxHiddenRecordKeys:e.checkSelectionCheckboxHiddenRecordKeys,checkSelectionCheckboxDisabledRecordKeys:e.checkSelectionCheckboxDisabledRecordKeys,checkSelectionCheckedRecordKeys:e.checkSelectionCheckedRecordKeys,bEditingEnabled:e.bEditingEnabled,bNewRowEnabled:e.bNewRowEnabled,hierarchyKey:e.hierarchyKey,splitterPos:e.splitterPos,paneLayout:e.paneLayout,rowViewParams:e.rowViewParams},gridFieldMap:JSON.stringify(t),columns:GetSerializedColumnInfoCollectionClone(e.columns),pivotedGridParams_columns:null==e.pivotedGridParams?null:GetSerializedColumnInfoCollectionClone(e.pivotedGridParams.columns),ganttParams:null==e.ganttParams?null:GetSerializedGanttParametersClone(e.ganttParams),unfilteredHierarchyMgr:null==e.rowViewParams.unfilteredHierarchyMgr?null:GetSerializedUnfilteredHierarchyManagerClone(e)})}function GetSerializedGanttParametersClone(e){return JSON.stringify({dateRange:e.dateRange,ganttBarStyles:e.ganttBarStyles,ganttZoomLevel:e.ganttZoomLevel})}function GetSerializedGridFieldClone(e){return JSON.stringify({key:e.key,hasDataValue:e.hasDataValue,hasLocalizedValue:e.hasLocalizedValue,textDirection:e.textDirection,_defaultCellStyleId:e._defaultCellStyleId,_editMode:e._editMode,_propType:e._propType,_multiValue:e._multiValue})}function GetSerializedCloneFromColumnInfo(e){return"column"==e.ColumnType()?JSON.stringify({name:e.name,imgSrc:e.imgSrc,columnKey:e.columnKey,fieldKeys:e.fieldKeys,width:e.width,isVisible:e.isVisible,isHidable:e.isHidable,isResizable:e.isResizable,isSortable:e.isSortable,isAutoFilterable:e.isAutoFilterable,pivoted:!1}):"pivotedColumn"==e.ColumnType()?JSON.stringify({name:e.name,imgSrc:e.imgSrc,columnKey:e.columnKey,fieldKeys:e.fieldKeys,width:e.width,pivoted:!0}):void 0}function GetSerializedColumnInfoCollectionClone(e){for(var t=[],n=e.GetColumnArray(),r=0;r<n.length;++r)t.push(GetSerializedCloneFromColumnInfo(n[r]));return JSON.stringify(t)}function FinishLaunchPrintPreview(records,jsGridParams,additionalScriptFiles,beforeInitFnName,beforeInitFnArgsObj,initTableViewParamsFnName,initTableViewParamsFnArgsObj,title,bEnableGantt,optGanttDelegateNames,ganttPaneWidth,ganttZoomLevel,initGanttStylesFnName,initGanttStylesFnArgsObj){var newWin,cssLinkScripts=[],AJAXScripts=[],scripts=[],requiredScriptFiles=["scriptresx.ashx","SP.JsGrid.Res.js","jsgrid.js","sp.datetimeutil.js","jsgrid.gantt.js","init.js","strings.js"],requiredAJAXFiles=["scriptresource.axd","webresource.axd","msajaxbundle.js","msformbundle.js"];function MatchNodeWithSourceFiles(node,requiredFilesArray,htmlElementArray,attrib){var nodeStr=eval("node."+attrib).toLowerCase();if(null!=requiredFilesArray)for(var idx=0;idx<requiredFilesArray.length;++idx){var fileName=requiredFilesArray[idx].toLowerCase();if(-1!==nodeStr.indexOf(fileName)||fileName.indexOf(".js")==fileName.length-3&&-1!==nodeStr.indexOf(fileName.substr(0,fileName.length-3)+".debug.js")){htmlElementArray.push(gridutil_1.JsGridUtil.Internal.DomElement.GetInstance().GetOuterHtml(node));return!0}}}function CopyRequiredDOMElements(e){for(var t=0;t<e.childNodes.length;++t){var n=e.childNodes[t];1==n.nodeType&&CopyRequiredDOMElements(n)}"stylesheet"==e.rel||e.type;if("LINK"==e.nodeName)cssLinkScripts.push(gridutil_1.JsGridUtil.Internal.DomElement.GetInstance().GetOuterHtml(e));else if("SCRIPT"==e.nodeName){if(MatchNodeWithSourceFiles(e,requiredScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(e,additionalScriptFiles,scripts,"src"))return;if(MatchNodeWithSourceFiles(e,requiredAJAXFiles,AJAXScripts,"src"))return}}function RenderHTMLElementArray(e){for(var t=0;t<e.length;++t)newWin.document.writeln(e[t])}function RenderPrintPreviewDocument(){(newWin=window.open()).document.writeln('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"');newWin.document.writeln('"http www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">');newWin.document.writeln('<html style="height:100%;margin:0px;">');newWin.document.writeln("<head>");newWin.document.writeln("<title>"+gridutil_1.JsGridUtil.Utility.HTMLEncode(title)+"</title>");RenderHTMLElementArray(cssLinkScripts);RenderHTMLElementArray(AJAXScripts);newWin.document.writeln("</head>");newWin.document.writeln('<body style="overflow:auto;height:100%;margin:0px;">');newWin.document.writeln('<div id="jsgrid_div_element" style="width:100%; min-height:100%;height:570px;" display="block"/>');newWin.document.writeln(StringHelper.format(["<script>","var JsGridUtil.SpRegionalSettings={0}","<\/script>"].join("\n"),JSON.stringify(gridutil_1.JsGridUtil.SpRegionalSettings)));RenderHTMLElementArray(scripts);newWin.document.writeln(StringHelper.format(["<script>","Sys.Application.initialize();","var printPreviewGrid = new SP.JsGrid.PrintPreviewGrid();","Sys.Application.add_init(function()","{{",'    var jsGridDiv = $get("jsgrid_div_element");','    jsGridDiv.style.backgroundColor = "white";','    var defaultDisplayControlMap = SP.JsGrid.Internal.JSONParse(unescape("{0}"));','    var lookupPropTypeMap = SP.JsGrid.Internal.JSONParse(unescape("{8}"));','    var tableViewParams = new SP.JsGrid.JsGridControl.TableViewParameters.CreateFromSerializedClone(unescape("{1}"));','    var dataBlob = SP.JsGrid.Internal.JSONParse(unescape("{2}"));',"    var recordCount = {3};",'    jsGridDiv.style.height = (recordCount * 22 + 50) + "px";',"    AdjustPrintPreviewGridDivWidth(tableViewParams.columns.GetColumnArray(), tableViewParams.bRowHeadersEnabled, {9}, {11});",'    var keyColumnName = unescape("{4}");',"    printPreviewGrid.Init(","        new SP.JsGrid.JsGridControl(jsGridDiv, false),","        tableViewParams,",'        SP.JsGrid.Internal.JSONParse(unescape("{7}")),',"        dataBlob,","        keyColumnName,","        defaultDisplayControlMap,","        lookupPropTypeMap,","        {5},",'        SP.JsGrid.Internal.JSONParse(unescape("{6}")),',"        {13},",'        SP.JsGrid.Internal.JSONParse(unescape("{14}")),',"        {9},",'        SP.JsGrid.Internal.JSONParse(unescape("{10}")),',"        {11},","        {12},","        {16},",'        SP.JsGrid.Internal.JSONParse(unescape("{17}"))',"    );","}});","Sys.CultureInfo.CurrentCulture = (","function(a)","{{","   return new Sys.CultureInfo(a.name,a.numberFormat,a.dateTimeFormat)","}}",')(SP.JsGrid.Internal.JSONParse(unescape("{15}")));',"<\/script>","</body>","</html>"].join("\n"),escape(JSON.stringify(property_1.PropertyType.Internal.Property.GetInstance().GetDefaultDisplayControlMap())),escape(GetSerializedTableViewParametersClone(jsGridParams.tableViewParams)),escape(JSON.stringify(CreatePrintPreviewBlobFromRecords(records))),records.length,escape(jsGridParams.tableViewParams.keyFieldName),beforeInitFnName?['"',beforeInitFnName,'"'].join(""):"null",escape(JSON.stringify(beforeInitFnArgsObj)),escape(JSON.stringify(jsGridParams.styleManager.groupingStyles)),escape(JSON.stringify(property_1.PropertyType.Internal.Property.GetInstance().GetLookupPropTypeMap())),bEnableGantt?"true":"false",escape(JSON.stringify(optGanttDelegateNames)),ganttPaneWidth,ganttZoomLevel,initTableViewParamsFnName?['"',initTableViewParamsFnName,'"'].join(""):"null",escape(JSON.stringify(initTableViewParamsFnArgsObj)),escape(constants_1.JsGridConstants.SUPERTEMPORARY_defaultCultureStringify),initGanttStylesFnName?['"',initGanttStylesFnName,'"'].join(""):"null",escape(JSON.stringify(initGanttStylesFnArgsObj))));newWin.document.close()}CopyRequiredDOMElements(document);RenderPrintPreviewDocument()}exports.FinishLaunchPrintPreview=FinishLaunchPrintPreview});
define("Eqe",["require","exports","ww","Lqe","Dqe","RWe","we","k","U5"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=u.Killswitch.isActivated("5A1F221C-336E-4AD0-B168-F49F39DC1347","3/20/2020","fix custom formatter choice fields");(function(e){var t=(function(){function e(){var e=this;this.ID="String";this.toString=function(){return e.ID}}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){n=null!=n&&0==n.length?null:n;s({isValid:!0,dataValue:n=r.JsGridUtil.SPUserValueOnPasteFixup(n),normalizedLocValue:n})};return e})();e.String=t;var u=function(e,t,n){var i=this;this.GetItemFromData=function(e){return null==e?null:r.JsGridUtil.Internal.Find(i._items,function(t){return t.value==e})};this.GetItemFromLocalized=function(e){if(null==e)return null;var t=e.toLowerCase();return r.JsGridUtil.Internal.Find(i._items,function(e){return e.localString.toLowerCase()==t})};this.BeginValidateNormalizeConvert=function(e,t,n,r,s,o){var u={},a=r?i.GetItemFromLocalized(n):i.GetItemFromData(n);u.isValid=null!=a||!i._bLimitToList;if(null!=a){u.normalizedLocValue=a.localString;u.dataValue=a.value}else u.normalizedLocValue=u.dataValue=n;s(u)};this.GetItems=function(e){for(var t=[],n=0;n<i._items.length;n++)t.push(x.prototype.MakeProperty(i._items[n].value,i._items[n].localString,!0,!0,i));e(t)};this.DataToLocalized=function(e){var t=i.GetItemFromData(e);return f?t?t.localString:r.JsGridUtil.EmptyValue:t?t.localString:""};this.LocalizedToData=function(e){var t=i.GetItemFromLocalized(e);return f?t?t.value:r.JsGridUtil.EmptyValue:t?t.value:""};this.GetImageSource=function(e,t){var n=i.GetItemFromData(t);return null!=n?n.imageUrl:null};this.GetStyleId=function(e){var t=i.GetItemFromData(e);return null!=t?t.styleId:null};this.GetIsLimitedToList=function(){return i._bLimitToList};this.GetSerializableLookupPropType=function(){return{items:i._items,id:i._id,bLimitToList:i._bLimitToList}};this._items=e;this._id=t;this._bLimitToList=n;this.ID=t};e.LookupTable=u;var l=(function(){function e(){this.ID="CheckBoxBoolean"}e.prototype.BeginValidateNormalizeConvert=function(e,n,r,i,s,o){"string"!=typeof r&&r.constructor!=t||(r=r.toUpperCase());i||"boolean"==typeof r||(r="1"==r);s({isValid:!0,dataValue:r=i?""!==r&&"0"!==r:!!r,normalizedLocValue:this.DataToLocalized(r)})};e.prototype.DataToLocalized=function(e){"boolean"!=typeof e&&(e="1"==e);return e?"1":"0"};e.prototype.toString=function(){return this.ID};return e})();e.CheckBoxBoolean=l;var c=(function(){function n(){this.ID="DropdownBoolean"}n.prototype.BeginValidateNormalizeConvert=function(e,n,r,i,s,o){"string"!=typeof r&&r.constructor!=t||(r=r.toUpperCase());i||"boolean"==typeof r||(r="1"==r);s({isValid:!0,dataValue:r=i?""!==r&&r!==SP.JsGrid.Res.booleanNo.toUpperCase():!!r,normalizedLocValue:this.DataToLocalized(r)})};n.prototype.DataToLocalized=function(e){"boolean"!=typeof e&&(e="1"==e);return e?SP.JsGrid.Res.booleanYes:SP.JsGrid.Res.booleanNo};n.prototype.GetBool=function(e){"boolean"!=typeof e&&(e="1"==e);return e!=r.JsGridUtil.EmptyValue&&!!e};n.prototype.GetItems=function(t){for(var n=[],r=0;r<2;r++){var i=1==r?SP.JsGrid.Res.booleanYes:SP.JsGrid.Res.booleanNo;n.push(e.Property.prototype.MakeProperty(r,i,!0,!0,this))}t(n)};n.prototype.toString=function(){return this.ID};return n})();e.DropdownBoolean=c;var h=(function(){function t(e,t,n,i){var s=this;this.LocStrArrayToLocStr=function(e){return r.JsGridUtil.Internal.JoinStrings(e,s._separatorChar+" ")};this._singleValuePropTypeID=e;this._separatorChar=t;this._bDelayInit=n;this._bAllowDuplicateValues=i;this.ID=e+"_MultiValue";this.bMultiValue=!0;this.separator=t;this.singleValuePropType=this.svPropType;n||this.InitSVPropType()}t.prototype.InitSVPropType=function(){var t=this;this.svPropType=e.Internal.Property.GetInstance().GetPropType(this._singleValuePropTypeID);this.singleValuePropType=this.svPropType;null!=this.svPropType&&null!=this.svPropType.SetSeparator&&this.svPropType.SetSeparator(this._separatorChar);this.GetImageSource=this.svPropType.GetImageSource&&function(e,n){return t.ForEachInArray(n,function(n){return t.svPropType.GetImageSource(e,n)})};this.GetItems=this.svPropType.GetItems;this.GetUpdateTrackingMode=this.svPropType.GetUpdateTrackingMode;this.GetUpdateSerializeMode=this.svPropType.GetUpdateSerializeMode;this.DataToLocalized=this.svPropType.DataToLocalized&&function(e){return t.LocStrArrayToLocStr(t.ForEachInArray(e,function(e){return t.svPropType.DataToLocalized(e)}))};this.LocalizedToData=this.svPropType.LocalizedToData&&function(e){return t.ForEachInArray(t.LocStrToLocStrArray(e),function(e){return t.svPropType.LocalizedToData(e)})};this.GetDisplayValue=this.svPropType.GetDisplayValue&&function(e,n,i){var s=[];if(null!=n&&n!==r.JsGridUtil.EmptyValue&&n!==r.JsGridUtil.InvalidValue)for(var o=t.LocStrToLocStrArray(i),u=0;u<n.length;u++)s.push(t.svPropType.GetDisplayValue(e,n[u],u>=o.length?null:o[u]));else s.push(t.svPropType.GetDisplayValue(e,n,i));return r.JsGridUtil.Internal.JoinStrings(s,t._separatorChar+" ")}};t.prototype.GetCopyValue=function(e,t,n){return"SPUser"==this._singleValuePropTypeID&&null!=t&&t!==r.JsGridUtil.EmptyValue&&t!==r.JsGridUtil.InvalidValue?this.svPropType.GetCopyValue(e,t,n):n};t.prototype.GetSerializableMultiValuePropType=function(){return{singleValuePropTypeID:this._singleValuePropTypeID,separatorChar:this._separatorChar,bDelayInit:this._bDelayInit}};t.prototype.InitSingleValuePropType=function(){this.InitSVPropType()};t.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){var u=this,a=function(){u.svPropType.BeginValidateNormalizeConvert(e,t,n[p],i,f,o)},f=function(e){l(e);++p<n.length?a():s(c())},l=function(e){if(0==p)h={isValid:e.isValid,dataValue:[e.dataValue],normalizedLocValue:[e.normalizedLocValue]};else{h.isValid=h.isValid&&e.isValid;h.dataValue.push(e.dataValue);h.normalizedLocValue.push(e.normalizedLocValue)}},c=function(){if(null!=h){if(h.isValid){if(!u._bAllowDuplicateValues)for(var e=u.svPropType.IsDataEqual,t=h.dataValue,n=0;n<t.length;n++)for(var r=0;r<t.length;r++)n!=r&&(null==e?t[n]==t[r]:e(t[n],t[r]))&&t.splice(r,1);h.normalizedLocValue=u.LocStrArrayToLocStr(h.normalizedLocValue);return h}return{isValid:!1}}return{isValid:!0,dataValue:null,normalizedLocValue:null}};if(i&&""==n||!(i||null!=n&&0!=n.length))s({isValid:!0,dataValue:[],normalizedLocValue:""});else{i&&(n=this.LocStrToLocStrArray(n));r.JsGridUtil.DebugAssert(n.constructor==Array);var h,p=0;a()}};t.prototype.LocStrToLocStrArray=function(e){return e&&"string"!=typeof e?[]:r.JsGridUtil.Internal.TokenizeString(e,this._separatorChar)};t.prototype.ForEachInArray=function(e,t){if(null==e)return null;for(var n=[],r=0;r<e.length;r++)n.push(t(e[r]));return n};return t})();e.MultiValuePropType=h;var p=(function(){function e(){this.ID="Hyperlink";this.bHyperlink=!0;this._serializedValueStartsEndsWith='"';this._serializedValueSeparator='", "';this._serializedValueSeparatorEncoded=encodeURIComponent(this._serializedValueSeparator)}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){n=r.JsGridUtil.SPUserValueOnPasteFixup(n);var u=i?this.Deserialize(n):n;s({isValid:null!=u,dataValue:u,normalizedLocValue:this.DataToLocalized(u)})};e.prototype.DataToLocalized=function(e){return e?e.display:""};e.prototype.GetAddress=function(e){return e?e.address:""};e.prototype.GetCopyValue=function(e,t,n){return this.Serialize(t)};e.prototype.Serialize=function(e){if(!e)return null;var t=e.address.replace(this._serializedValueSeparator,this._serializedValueSeparatorEncoded);return o.format("{0}{1}{2}{3}{0}",this._serializedValueStartsEndsWith,t,this._serializedValueSeparator,e.display)};e.prototype.Deserialize=function(e){if(null==e)return null;0==e.length&&(e="");var t=e.indexOf(this._serializedValueSeparator);return t<0||!e.startsWith(this._serializedValueStartsEndsWith)||!e.endsWith(this._serializedValueStartsEndsWith)?{address:e,display:e}:{address:e.substring(1,t).replace(this._serializedValueSeparatorEncoded,this._serializedValueSeparator),display:e.substring(t+this._serializedValueSeparator.length,e.length-1)}};e.prototype.toString=function(){return this.ID};return e})();e.Hyperlink=p;var d=(function(){function e(){this.ID="Location";this.ForceDataCopy=!0}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s,o){n=r.JsGridUtil.SPUserValueOnPasteFixup(n);var u=i?this.Deserialize(n):n;s({isValid:null!=u,dataValue:u,normalizedLocValue:this.DataToLocalized(u)})};e.prototype.DataToLocalized=function(e){return e?e.DisplayName:""};e.prototype.GetCopyValue=function(e,t,n){return r.JsGridUtil._locationFilldownKillswitchIsActive?this.Serialize(t):JSON.stringify(this.Serialize(t))};e.prototype.toString=function(){return this.ID};e.prototype.Serialize=function(e){return r.JsGridUtil._locationFilldownKillswitchIsActive?null:e};e.prototype.Deserialize=function(e){return null};return e})();e.Location=d;e.RegisterNewLookupPropType=function(t,n,i,o){r.JsGridUtil.DebugAssert(i==s.DisplayControlType.Image||i==s.DisplayControlType.ImageText||i==s.DisplayControlType.Text);var u=new e.LookupTable(n,t,o);v.Property.GetInstance().RegisterPropType(u,i,s.EditControlType.ComboBox,[])};e.RegisterNewCustomPropType=function(e,t,n,r){v.Property.GetInstance().RegisterPropType(e,t,n,r)};e.RegisterNewDerivedCustomPropType=function(e,t){v.Property.GetInstance().RegisterDerivedPropType(e,t)};(function(e){e.RegisterDisplayControl=function(e,t,n){v.Property.GetInstance().RegisterDisplayControl(e,t,n)};e.RegisterEditControl=function(e,t,n){v.Property.GetInstance().RegisterEditControl(e,t,n)};e.RegisterWidgetControl=function(e,t,n){v.Property.GetInstance().RegisterWidgetControl(e,t,n)};e.UpdateDisplayControlForPropType=function(e,t){v.Property.GetInstance().UpdateDisplayControlForPropType(e,t)};e.UpdateEditControlForPropType=function(e,t){v.Property.GetInstance().UpdateEditControlForPropType(e,t)};e.UpdateWidgetControlsForPropType=function(e,t){v.Property.GetInstance().UpdateWidgetControlsForPropType(e,t)};e.GetPropType=function(e){return v.Property.GetInstance().GetPropType(e)};e.GetPropTypes=function(){return v.Property.GetInstance().GetPropTypes()}})(e.Utils||(e.Utils={}));var v,m={ODB:1507},g={ODB:1806},y={ODB:1892},b={ODB:1300},w={ODB:1470};(function(e){var n=(function(){function e(){this.defaultControlsMap={};this.eligibleControlsMap={};var e=r.JsGridUtil.Internal.IsFeatureEnabled(m),n=1==r.JsGridUtil.SpRegionalSettings.calendarType,o=r.JsGridUtil.Internal.IsFeatureEnabled(g),u=r.JsGridUtil.Internal.IsFeatureEnabled(y),a=r.JsGridUtil.Internal.IsFeatureEnabled(b),f=r.JsGridUtil.Internal.IsFeatureEnabled(w);this.propTypeInfoTable=[[new t,s.DisplayControlType.Text,s.EditControlType.EditBox,[]],[new l,s.DisplayControlType.Checkbox,s.EditControlType.Checkbox,[]],[new c,s.DisplayControlType.Text,u?s.EditControlType.BooleanComboBox:s.EditControlType.ComboBox,[]],[new p,s.DisplayControlType.Text,s.EditControlType.Hyperlink,o?[]:[s.WidgetControlType.Hyperlink]],[new d,s.DisplayControlType.Text,s.EditControlType.LocationPicker,[]]];this.propSingletonMap=r.JsGridUtil.Internal.ConvertTableToMap(this.propTypeInfoTable,"0","1");this.displayControlInfoTable=[[s.DisplayControlType.Image,new s.DisplayControl.ImageDisplayControl,["GetImageSource"]],[s.DisplayControlType.ImageText,new s.DisplayControl.ImageTextDisplayControl,["GetImageSource"]],[s.DisplayControlType.Text,new s.DisplayControl.TextDisplayControl,[]],[s.DisplayControlType.Checkbox,new s.DisplayControl.CheckboxDisplayControl,["GetBool"]],[s.DisplayControlType.CSR,new s.DisplayControl.CSRDisplayControl,[]],[s.DisplayControlType.CustomFormatter,new s.DisplayControl.CustomFormatterDisplayControl,[]],[s.DisplayControlType.User,new s.DisplayControl.UserDisplayControl,["GetSipAddress"]],[s.DisplayControlType.ImageThumbnail,new s.DisplayControl.ImageThumbnailDisplayControl,[]]];this.displayControlsSingletonMap=r.JsGridUtil.Internal.ConvertTableToMap(this.displayControlInfoTable,"0","1");this.displayControlInterfaceMap=r.JsGridUtil.Internal.ConvertTableToMap(this.displayControlInfoTable,"0","2");this.editControlInfoTable=[[s.EditControlType.EditBox,function(e,t){return new s.EditControl.EditBoxEditControl(e,t)},[]],[s.EditControlType.Checkbox,function(e){return new s.EditControl.CheckboxEditControl(e)},["GetBool"]],[s.EditControlType.PeoplePicker,function(e){return new s.EditControl.PeoplePickerEditControl(e)},["GetSipAddress"]],[s.EditControlType.LocationPicker,function(e){return new s.EditControl.LocationPickerEditControl(e)},[]]];f&&this.editControlInfoTable.push([s.EditControlType.Checkbox,function(e){return new s.EditControl.CheckboxEditControl(e)},[]]);a&&this.editControlInfoTable.push([s.EditControlType.NumberBox,function(e){return new s.EditControl.NumberEditControl(e)},[]]);e&&n&&!r.JsGridUtil.Internal.IsIEBrowser()&&this.editControlInfoTable.push([s.EditControlType.DatePicker,function(e){return new s.EditControl.DateEditControl(e)},[]]);o?this.editControlInfoTable.push([s.EditControlType.Hyperlink,function(e){return new s.EditControl.HyperlinkEditControlV2(e)},[]]):this.editControlInfoTable.push([s.EditControlType.Hyperlink,function(e,t){return s.EditControl.GetHyperlinkEditControl(e,t)},[]]);if(u){this.editControlInfoTable.push([s.EditControlType.ComboBox,function(e){return new s.EditControl.ModernComboBoxEditControl(e)},["GetItems"]]);this.editControlInfoTable.push([s.EditControlType.BooleanComboBox,function(e){return new s.EditControl.ComboBoxEditControl(e)},["GetItems"]])}else this.editControlInfoTable.push([s.EditControlType.ComboBox,function(e){return new s.EditControl.ComboBoxEditControl(e)},["GetItems"]]);this.editControlsFactoryMap=r.JsGridUtil.Internal.ConvertTableToMap(this.editControlInfoTable,"0","1");this.editControlInterfaceMap=r.JsGridUtil.Internal.ConvertTableToMap(this.editControlInfoTable,"0","2");this.widgetControlInfoTable=[[i.JsGridConstants.ErrorWidgetId,function(e,t){return new s.WidgetControl.ErrorWidget(e,t)},[]]];e&&n&&!r.JsGridUtil.Internal.IsIEBrowser()||this.widgetControlInfoTable.push([s.WidgetControlType.Date,function(e){return new s.WidgetControl.DateWidget(e)},[]]);o||this.widgetControlInfoTable.push([s.WidgetControlType.Hyperlink,function(e){return new s.WidgetControl.HyperlinkWidget(e)},["GetAddress"]]);this.widgetControlsFactoryMap=r.JsGridUtil.Internal.ConvertTableToMap(this.widgetControlInfoTable,"0","1");this.widgetControlInterfaceMap=r.JsGridUtil.Internal.ConvertTableToMap(this.widgetControlInfoTable,"0","2");this.Init()}e.GetInstance=function(){this._instance||(this._instance=new e);return this._instance};e.prototype.GetDefaultDisplayControlMap=function(){var e={};for(var t in this.defaultControlsMap)e[t]=this.defaultControlsMap[t].display.Id;return e};e.prototype.RegisterDefaultPropTypesFromDefaultDisplayControlMap=function(e,t){null==t&&(t={});for(var n in e)null==this.defaultControlsMap[n]&&this.RegisterDefaultDisplayPropTypeInternal(n,this.GetDisplayControl(e[n]),t)};e.prototype.GetLookupPropTypeMap=function(){var e={};for(var t in this.propSingletonMap)null!=this.propSingletonMap[t].GetSerializableLookupPropType?e[t]=this.propSingletonMap[t].GetSerializableLookupPropType():this.propSingletonMap[t].bMultiValue&&null!=this.propSingletonMap[t].singleValuePropType.GetSerializableLookupPropType&&(e[t]=this.propSingletonMap[t].GetSerializableMultiValuePropType());return e};e.prototype.RegisterDisplayControl=function(e,t,n){this.displayControlsSingletonMap[e]=t;this.displayControlInterfaceMap[e]=n;this.eligibleControlsMap={}};e.prototype.RegisterEditControl=function(e,t,n){this.editControlsFactoryMap[e]=t;this.editControlInterfaceMap[e]=n;this.eligibleControlsMap={}};e.prototype.RegisterWidgetControl=function(e,t,n){this.widgetControlsFactoryMap[e]=t;this.widgetControlInterfaceMap[e]=n;this.eligibleControlsMap={}};e.prototype.GetPropType=function(e){r.JsGridUtil.DebugAssert(e in this.propSingletonMap);return this.propSingletonMap[e]};e.prototype.GetPropTypes=function(){var e=[];for(var t in this.propSingletonMap)e.push(t);return e};e.prototype.PropTypeExists=function(e){return e in this.propSingletonMap};e.prototype.GetDisplayControl=function(e){r.JsGridUtil.DebugAssert(e in this.displayControlsSingletonMap);return this.displayControlsSingletonMap[e]};e.prototype.GetEditControl=function(e,t){r.JsGridUtil.DebugAssert(e in this.editControlsFactoryMap,o.format("Edit control named {0} needs to be registered before being instatiated."));return this.editControlsFactoryMap[e].apply(null,t)};e.prototype.GetWidgetControl=function(e,t){r.JsGridUtil.DebugAssert(e in this.widgetControlsFactoryMap,o.format("Widget control named {0} needs to be registered before being instatiated."));return this.widgetControlsFactoryMap[e].apply(null,t)};e.prototype.GetUpdateTrackingMode=function(e,t){if(null!=e.GetUpdateTrackingMode)return e.GetUpdateTrackingMode();r.JsGridUtil.DebugAssert(null==t||t.hasDataValue||t.hasLocalizedValue);return null!=t&&t.hasDataValue?t.hasLocalizedValue?i.JsGridConstants.UpdateTrackingMode.PropBoth:i.JsGridConstants.UpdateTrackingMode.PropData:i.JsGridConstants.UpdateTrackingMode.PropLocalized};e.prototype.GetUpdateSerializeMode=function(e,t){if(e&&null!=e.GetUpdateSerializeMode)return e.GetUpdateSerializeMode();var n=null!=e&&null!=t?this.GetUpdateTrackingMode(e,t):i.JsGridConstants.UpdateSerializeMode.PropBoth;n==i.JsGridConstants.UpdateSerializeMode.PropBoth&&(n=i.JsGridConstants.UpdateSerializeMode.PropLocalizedOnly);return n};e.prototype.RegisterDefaultDisplayPropTypeInternal=function(e,t,n){if(e in n){var r=n[e];null!=r.singleValuePropTypeID?this.propSingletonMap[e]=new h(r.singleValuePropTypeID,r.separatorChar,r.bDelayInit,null):this.propSingletonMap[e]=new u(r.items,r.id,r.bLimitToList)}delete this.eligibleControlsMap[e];this.defaultControlsMap[e]={display:t,editControlName:"",widgetControlNames:[]}};e.prototype.RegisterPropType=function(e,t,n,r){t||(t=s.DisplayControlType.Text);r=null==r?[]:r;this.RegisterPropTypeInternal(e,this.GetDisplayControl(t),n,r)};e.prototype.RegisterDerivedPropType=function(e,t){var n=this.defaultControlsMap[t];this.RegisterPropTypeInternal(e,n.display,n.editControlName,n.widgetControlNames)};e.prototype.RegisterPropTypeInternal=function(e,t,n,r){this.propSingletonMap[e.ID]=e;delete this.eligibleControlsMap[e.ID];this.defaultControlsMap[e.ID]={display:t,editControlName:n,widgetControlNames:r}};e.prototype.UpdateDisplayControlForPropType=function(e,t){r.JsGridUtil.DebugAssert(null!=this.propSingletonMap[e]);r.JsGridUtil.DebugAssert(null!=this.defaultControlsMap[e]);this.defaultControlsMap[e].display=this.GetDisplayControl(t)};e.prototype.UpdateEditControlForPropType=function(e,t){r.JsGridUtil.DebugAssert(null!=this.propSingletonMap[e]);r.JsGridUtil.DebugAssert(null!=this.defaultControlsMap[e]);this.defaultControlsMap[e].editControlName=t};e.prototype.UpdateWidgetControlsForPropType=function(e,t){r.JsGridUtil.DebugAssert(null!=this.propSingletonMap[e]);r.JsGridUtil.DebugAssert(null!=this.defaultControlsMap[e]);this.defaultControlsMap[e].widgetControlNames=t};e.prototype.GetDisplayControlForProperty=function(e,t){return null!=t?this.GetDisplayControl(t):this.defaultControlsMap[e.ID].display};e.prototype.GetEditAndWidgetControlNamesForProperty=function(e,t,n,r){var i,s;return{editControlName:null!=t.fnGetEditControlName&&null!=(i=t.fnGetEditControlName(e,n))?i:this.defaultControlsMap[r.ID].editControlName,widgetControlNames:null!=t.fnGetWidgetControlNames&&null!=(s=t.fnGetWidgetControlNames(e,n))?s:[].concat(this.defaultControlsMap[r.ID].widgetControlNames)}};e.prototype.Init=function(){for(var e in this.propTypeInfoTable){var t=this.propTypeInfoTable[e];this.RegisterPropType(t[0],t[1],t[2],t[3])}this.InitLocalNumericTypesForGrid();this.InitLocalDateTypeForGrid()};e.prototype.InitLocalDateTypeForGrid=function(){var e=1==r.JsGridUtil.SpRegionalSettings.calendarType;r.JsGridUtil.Internal.IsFeatureEnabled(m)&&e&&!r.JsGridUtil.Internal.IsIEBrowser()?this.RegisterPropType(new a("JSDateTime","M/d/yyyy"),s.DisplayControlType.Text,s.EditControlType.DatePicker,[]):this.RegisterPropType(new a("JSDateTime","M/d/yyyy"),s.DisplayControlType.Text,s.EditControlType.EditBox,[s.WidgetControlType.Date])};e.prototype.InitLocalNumericTypesForGrid=function(){var e=function(e,t,n,r,i,s){var o=this;var u=r?(function(e){e=null!=o.PreParse?o.PreParse(e):e;var t=parseFloat(e);return null!=o.PostParse?o.PostParse(t):t})(n):null!=n.format?n:parseFloat(n+""),a=u.localeFormat(this.FormatString);i({isValid:!isNaN(u),dataValue:null!=this.ProcessData?this.ProcessData(u):u,normalizedLocValue:null!=this.ProcessLocalized?this.ProcessLocalized(u,a):a})},t=function(e,t){r.JsGridUtil.DebugAssert("number"==typeof e&&"number"==typeof t);return e-t},n=[{ID:"JSNumber",FormatString:"D"}];for(var i in n){var o=r.JsGridUtil.Internal.object(n[i]);o.BeginValidateNormalizeConvert=e;o.CompareTo=t;this.RegisterPropType(o,s.DisplayControlType.Text,s.EditControlType.EditBox,[])}};return e})();e.Property=n;var a=(function(){function e(e,t){this.ID=e;this._formatString=t}e.prototype.BeginValidateNormalizeConvert=function(e,t,n,i,s){var o={};n=r.JsGridUtil.SPUserValueOnPasteFixup(n);var u=i?Date.parse(n)||Date.parse(n)||Date.parse(n):null!=n.getTime?n:new Date(+n);u=null!=u?new Date(u):null;o.isValid=null!=u&&!isNaN(u.getTime());o.dataValue=o.isValid?u:null;o.normalizedLocValue=o.isValid?u.localeFormat(this._formatString):null;s(o)};return e})();e.JSDateTime=a})(v=e.Internal||(e.Internal={}));var E=(function(){function t(e,t,n){this.gridFieldMap=e;this._keyColumnName=t;this._fnGetPropType=n}t.prototype.MakeRecord=function(t,n,r){var i=new S;i.recordKey=t[this._keyColumnName];for(var s in this.gridFieldMap){var o=this.gridFieldMap[s],u=e.Property.prototype.MakePropertyFromGridField(o,t[s],n[s],null==this._fnGetPropType||o.GetIsMultiValue()?null:this._fnGetPropType(i.recordKey,o.key,t));if(null!=u){i.properties[s]=u;if(!r){delete t[s];delete n[s]}}}i.fieldRawDataMap=null!=t?t:{};i.fieldRawLocMap=null!=n?n:{};return i};return t})();e.RecordFactory=E;var S=(function(){function e(){this.properties={};this.areValuesUpdated=!1}e.prototype.key=function(){return this.recordKey};e.prototype.GetDataValue=function(e){return e in this.properties?this.properties[e].GetData():this.fieldRawDataMap[e]};e.prototype.GetLocalizedValue=function(e){return e in this.properties?this.properties[e].GetLocalized():this.fieldRawLocMap[e]};e.prototype.HasDataValue=function(e){return e in this.properties?this.properties[e].HasDataValue():e in this.fieldRawDataMap};e.prototype.HasLocalizedValue=function(e){return e in this.properties?this.properties[e].HasLocalizedValue():e in this.fieldRawLocMap};e.prototype.HasUpdatedValues=function(){return this.areValuesUpdated};e.prototype.UpdateLocalizedValuesWithColumnData=function(e){for(var t=0;t<e.length;t++)if("Number"===e[t].FieldType&&null!=e[t].CommaSeparator){var n=this.properties[e[t].Name],r=n.GetLocalized();r=a.formatNumberString(r,e[t].CommaSeparator);n.LocalizedProperty(r)}this.areValuesUpdated=!0};e.prototype.GetProp=function(e){return this.properties[e]};e.prototype.SetProp=function(e,t){r.JsGridUtil.DebugAssert(e in this.properties);this.properties[e]=t};e.prototype.AddFieldValue=function(e,t){if(t.isProp)this.properties[e]=t.prop;else if(e in this.properties)this.properties[e].Update(t.hasData?t.data:r.JsGridUtil.EmptyValue,t.hasLocalized?t.localized:r.JsGridUtil.EmptyValue);else{t.hasLocalized&&(this.fieldRawLocMap[e]=t.localized);t.hasData&&(this.fieldRawDataMap[e]=t.data)}};e.prototype.RemoveFieldValue=function(e){delete this.properties[e];delete this.fieldRawLocMap[e];delete this.fieldRawDataMap[e]};return e})();e.Record=S;var x=(function(){function e(e,t,n){null!=n&&(this.propType=n);null!=e&&(this.dataValue=e);null!=t&&(this.localizedValue=t)}e.prototype.LocalizedProperty=function(e,t){this.localizedValue=e;null!=t&&(this.propType=t)};e.prototype.DataProperty=function(e,t){this.dataValue=e;null!=t&&(this.propType=t)};e.prototype.HasLocalizedValue=function(){return!0};e.prototype.HasDataValue=function(){return!0};e.prototype.Clone=function(){return this.MakeProperty(r.JsGridUtil.Internal.CloneObj(this.dataValue,null),this.localizedValue,!0,!0,this.propType)};e.prototype.Update=function(e,t){e!==r.JsGridUtil.EmptyValue&&(this.dataValue=e!==r.JsGridUtil.InvalidValue?r.JsGridUtil.Internal.CloneObj(e,null):e);t!==r.JsGridUtil.EmptyValue&&(this.localizedValue=t)};e.prototype.GetLocalized=function(){return this.localizedValue};e.prototype.GetData=function(){return this.dataValue};e.prototype.MakeProperty=function(t,n,r,i,s){return r&&i?new e(t,n,s):r?new T(t,null,s):new N(null,n,s)};e.prototype.MakePropertyFromGridField=function(e,t,n,r){var i=null,s=null!=r?r:e.GetPropType();null!=s&&(i=this.MakeProperty(t,n,e.hasDataValue,e.hasLocalizedValue,s));return i};return e})();e.Property=x;var T=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.HasLocalizedValue=function(){return null!=this.propType.DataToLocalized};t.prototype.HasDataValue=function(){return!0};t.prototype.Clone=function(){return this.MakeProperty(r.JsGridUtil.Internal.CloneObj(this.dataValue,null),this.localizedValue,!0,!1,this.propType)};t.prototype.Update=function(e,t){e!==r.JsGridUtil.EmptyValue&&(this.dataValue=e!==r.JsGridUtil.InvalidValue?r.JsGridUtil.Internal.CloneObj(e,null):e)};t.prototype.GetLocalized=function(){r.JsGridUtil.DebugAssert(this.HasLocalizedValue());return this.dataValue!==r.JsGridUtil.InvalidValue?this.propType.DataToLocalized(this.dataValue):""};t.prototype.GetData=function(){return this.dataValue};return t})(x);e.DataProperty=T;var N=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.HasLocalizedValue=function(){return!0};t.prototype.HasDataValue=function(){return null!=this.propType.LocalizedToData};t.prototype.Clone=function(){return this.MakeProperty(r.JsGridUtil.Internal.CloneObj(this.dataValue,null),this.localizedValue,!1,!0,this.propType)};t.prototype.Update=function(e,t){t!==r.JsGridUtil.EmptyValue&&(this.localizedValue=t)};t.prototype.GetLocalized=function(){return this.localizedValue};t.prototype.GetData=function(){r.JsGridUtil.DebugAssert(this.HasDataValue());return this.localizedValue!==r.JsGridUtil.InvalidValue?this.propType.LocalizedToData(this.localizedValue):null};return t})(x);e.LocalizedProperty=N})(t.PropertyType||(t.PropertyType={}))});
define("dQe",["require","exports","Lqe","Dqe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,n,r,i,o,u,a){this._thickness=f();this._arrowBoxSize=this._thickness-1;this._itemSizes=[];this._disabled=!1;this._partialRowPresent=!1;this._middleBoxLength=0;this._middleBoxLocation=0;this._topItemIdx=0;this._primitiveMgr=new s(e==t.ScrollBarType.Vertical,this);this._bOtherScrollMeets=r;this._type=e;this._optUpdateParams=i;this._bRTL=u;this.Init()}e.prototype.Init=function(){null!=this._optUpdateParams&&this.Update(this._optUpdateParams)};e.prototype.ComputeValidTopItemIdx=function(e){return Math.max(0,Math.min(e,null!=this._scrollableRows?this._scrollableRows:0))};e.prototype.ComputeValidTopItemIdxFromBottomIdx=function(e){var t=Math.max(Math.min(e,this._itemCount-1),0);return t-this.ComputeNumberOfRowsOnPage(null,t).count};e.prototype.ScrollToIdx=function(e,t,n,r){var i=this._topItemIdx;if(this._topItemIdx!==e||n){this._topItemIdx=e;this.ComputeScrollPosition(this._topItemIdx);null==this._fnOnScroll||i===this._topItemIdx&&!n||r||this._fnOnScroll(t,i);return!0}return!1};e.prototype.ScrollToBottomIdx=function(e,t,n){var r=this.ComputeValidTopItemIdxFromBottomIdx(e);return this.ScrollToIdx(r,new o(r,e,u.Bottom),t,n)};e.prototype.ScrollToTopIdx=function(e,t,n){var r=this.ComputeValidTopItemIdx(e);return this.ScrollToIdx(r,new o(r,this.ComputeNumberOfRowsOnPage(r,null),u.Top),t,n)};e.prototype.ComputeRemainingSpace=function(){return Math.max(0,this.GetTotalScrollableDistance()-this._middleBoxLocation-this._middleBoxLength)};e.prototype.GetTotalScrollableDistance=function(){return this._length-2*this._arrowBoxSize-4};e.prototype.ComputeNumberOfRowsOnPage=function(e,t){for(var r,i=null!=e?e:t,s=null==e,o=0,u=0!==this._itemSizes.length?n.JsGridUtil.Internal.UpperBound(this._itemSizes,i,"pos")-1:-1;o<this._physicalViewportSize&&i>=0&&i<this._itemCount;){null==r&&-1!==u&&u<this._itemSizes.length&&(r=this._itemSizes[u]);o+=null!=r&&i==r.pos?r.size:this._itemSize;if(null!=r&&i==r.pos){u+=s?-1:1;r=null}i+=s?-1:1}var a=o!==this._physicalViewportSize;return{count:Math.max(Math.abs((null!=e?e:t)-i)-(a?1:0),0),partial:a}};e.prototype.GetPartialItemDisplayCapacity=function(){return this._itemCount};e.prototype.GetWholeItemDisplayCapacityInternal=function(){return this._itemCount};e.prototype.ComputeBottomIdx=function(){return this.ComputeNumberOfRowsOnPage(this._topItemIdx,null).count};e.prototype.TopIndexToPixelOffset=function(e){this._bRTL&&this._type==t.ScrollBarType.Horizontal&&(e=this._scrollableRows-e);return Math.floor(this._scrollablePixels/this._scrollableRows*e)};e.prototype.PixelOffsetToTopIndex=function(e){this._bRTL&&this._type==t.ScrollBarType.Horizontal&&(e=this._scrollablePixels-e);return this._scrollablePixels>0?this.ComputeValidTopItemIdx(Math.round(e/(this._scrollablePixels/this._scrollableRows))):0};e.prototype.ComputeScrollPosition=function(e){this._middleBoxLocation=this._scrollableRows>0?this.TopIndexToPixelOffset(e):0;this._primitiveMgr.UpdateBGDiv("bgAboveBox",this._middleBoxLocation+1);this._primitiveMgr.SetTop("middleBoxDiv",this._middleBoxLocation+this._arrowBoxSize);this._primitiveMgr.UpdateBGDiv("bgBelowBox",this.ComputeRemainingSpace()+1)};e.prototype.Dispose=function(){this._renderedBar&&n.JsGridUtil.ClearEventListeners(this._renderedBar);this._eventToDispose&&document.body.removeEventListener("mousemove",this._eventToDispose);this._primitiveMgr.Dispose();this._renderedBar=null};e.prototype.SetOnVisibilityChanged=function(e,t){this._fnOnVisibilityChanged=e;null!=this._fnOnVisibilityChanged&&t!==!this._disabled&&this._fnOnVisibilityChanged(!this._disabled)};e.prototype.Update=function(e){this._itemCount=null==e.itemCount?this._itemCount:e.itemCount;this._itemSize=null==e.itemSize?this._itemSize:e.itemSize;this._bOtherScrollMeets=null==e.bOtherScrollMeets?this._bOtherScrollMeets:e.bOtherScrollMeets;return!1};e.prototype.GetItemDisplayCapacity=function(){return this.GetPartialItemDisplayCapacity()};e.prototype.GetWholeItemDisplayCapacity=function(){return this.GetWholeItemDisplayCapacityInternal()};e.prototype.GetTopItemIdx=function(){return this._topItemIdx};e.prototype.Refresh=function(){this.ComputeScrollPosition(this._topItemIdx)};e.prototype.ScrollIntoView=function(e){e=Math.max(0,Math.min(this._itemCount-1,e));var n=this.GetItemDisplayInfo(e);if(n==t.ScrollBarRowDisplayInfo.Before){this.ScrollToTopIdx(e);return!0}if(n==t.ScrollBarRowDisplayInfo.After||n==t.ScrollBarRowDisplayInfo.Partial){this.ScrollToTopIdx(e+1-this.GetWholeItemDisplayCapacity());return!0}return!1};e.prototype.ScrollUpByOne=function(){this.Update({topItemIdx:this._topItemIdx-1})};e.prototype.ScrollDownByOne=function(){this.Update({topItemIdx:this._topItemIdx+1})};e.prototype.PartialRowPresent=function(){return this._partialRowPresent};e.prototype.GetVisibleItemCount=function(){};e.prototype.SetOnScroll=function(e){this._fnOnScroll=e};e.prototype.SetViewportSize=function(){};e.prototype.GetItemDisplayInfo=function(e){var n=this.GetWholeItemDisplayCapacity(),r=this.GetPartialItemDisplayCapacity();return n!==r?e<this._topItemIdx?t.ScrollBarRowDisplayInfo.Before:e>this._topItemIdx+r-1?t.ScrollBarRowDisplayInfo.After:e==this._topItemIdx+r-1?t.ScrollBarRowDisplayInfo.Partial:t.ScrollBarRowDisplayInfo.InView:e<this._topItemIdx?t.ScrollBarRowDisplayInfo.Before:e>this._topItemIdx+r-1?t.ScrollBarRowDisplayInfo.After:t.ScrollBarRowDisplayInfo.InView};return e})();t.ScrollBar=i;var s=(function(){function e(e,t){this._activeColors={outerBorder:{mouseDown:"#737A83",mouseOver:"#8A8D91",mouseOut:"#B7BABE"},innerBorder:{mouseDown:"#C3C6CA",mouseOver:"#DADBDD",mouseOut:"#F0F1F4"},shade:{mouseDown:"#969BA2",mouseOver:"#CACCD0",mouseOut:"#E8EBEE"},main:{mouseDown:"#868C93",mouseOver:"#B3B6BB",mouseOut:"#DFE3E8"}};this._renderedItemDivs={};this._bIsVert=e;this._scrollBar=t;this._thicknessCssString=e?"width":"height";this._lengthCssString=e?"height":"width";this._cssNamePreFix=e?"vert-":"horiz-";this._upSideCssName=e?"top":"left";this._leftSideCssName=e?"left":"top";this._arrowDivClass=e?"clip9x6":"clip6x9";this._upArrowInactiveImgClass="jsgridcluster_scrollbar-mouseout-"+(e?"uparrow":"leftarrow");this._downArrowInactiveImgClass="jsgridcluster_scrollbar-mouseout-"+(e?"downarrow":"rightarrow");this._upArrowActiveImgClass="jsgridcluster_scrollbar-mousein-"+(e?"uparrow":"leftarrow");this._downArrowActiveImgClass="jsgridcluster_scrollbar-mousein-"+(e?"downarrow":"rightarrow")}e.prototype.Dispose=function(){this._renderedItemDivs=null};e.prototype.GetThicknessCssString=function(e){return this._thicknessCssString+":"+e+"px;"};e.prototype.GetLengthCssString=function(e){return this._lengthCssString+":"+e+"px;"};e.prototype.GetLengthAndThicknessCssString=function(e,t){return this.GetLengthCssString(e)+this.GetThicknessCssString(t)};e.prototype.GetCssName=function(e,t){return this._cssNamePreFix+e+(t?" "+e:"")};e.prototype.RegisterPrimitives=function(e){for(var t=0;t<e.length;t++){var r=n.JsGridUtil.Internal.DomElement.GetInstance().GetCustomAttribute(e[t],"elemid");null!=r&&(this._renderedItemDivs[r]=e[t])}};e.prototype.GetLocation=function(e){return n.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(this._renderedItemDivs[e])};e.prototype.GetHeight=function(e){return this._renderedItemDivs[e].offsetHeight};e.prototype.GetWidth=function(e){return this._renderedItemDivs[e].offsetWidth};e.prototype.GetDomElem=function(e){return this._renderedItemDivs[e]};e.prototype.AppendItem=function(e,t){this._renderedItemDivs[e].appendChild(t);this.RegisterPrimitives(n.JsGridUtil.Internal.DomElement.GetInstance().FindChildrenWithProperty(this._renderedItemDivs[e],"id"))};e.prototype.GenerateBGDivHTML=function(e,t,n){var r=(this._scrollBar._thickness-4)/2;return['<div class="'+this.GetCssName("scroll-bar-bg-block",null)+'" style="'+(n?"position:relative;":"")+this.GetLengthCssString(e)+'" '+this.GetOptionalElemString("elemid",t,null)+">",'<div class="'+this.GetCssName("scroll-bar-background-shade",!0)+'" style="'+this.GetLengthAndThicknessCssString(e,Math.ceil(r))+'" '+this.GetOptionalElemString("elemid",t,"_shade")+"></div>",'<div class="'+this.GetCssName("scroll-bar-background-main",!0)+'" style="'+this.GetLengthAndThicknessCssString(e,Math.floor(r))+'" '+this.GetOptionalElemString("elemid",t,"_main")+"></div></div>"].join("")};e.prototype.GetOptionalElemString=function(e,t,n){return null==t?"":e+'="'+t+(null==n?"":n)+'"'};e.prototype.GenerateMiddleScroll=function(e){var t=document.createElement("div"),n=(this._scrollBar._thickness-6)/2,r=(this._scrollBar._thickness-6-5)/2;t.innerHTML=['<div style="position:relative;',this.GetThicknessCssString(this._scrollBar._thickness-6),';margin-top:1px;margin-left:1px;">','<div elemid="',e,'_shade" class="',this.GetCssName("scroll-bar-inner-box-shade",!0),'" style="',this.GetThicknessCssString(Math.floor(n)),';"></div>','<div elemid="',e,'_main" class="',this.GetCssName("scroll-bar-inner-box-main",!0),'" style="',this.GetThicknessCssString(Math.ceil(n)),';"></div>','<div elemid="',e,'_gripTop" class="',this.GetCssName("scroll-bar-grip",!0),'" style="',this._leftSideCssName,":",Math.round(r),'px"></div>','<div elemid="',e,'_gripMiddle" class="',this.GetCssName("scroll-bar-grip",!0),'" style="',this._leftSideCssName,":",Math.round(r),'px;"></div>','<div elemid="',e,'_gripBottom" class="',this.GetCssName("scroll-bar-grip",!0),'" style="',this._leftSideCssName,":",Math.round(r),'px"></div></div>'].join("");t.elemid=e;t.className=this.GetCssName("scroll-bar-outer-box",!0);t.style.cssText=this.GetThicknessCssString(this._scrollBar._thickness-4);return t};e.prototype.GenerateArrowDiv=function(e,t,i){var s=document.createElement("div"),o=(this._scrollBar._thickness-4-(this._bIsVert?6:9))/2,u=(this._scrollBar._thickness-4-(this._bIsVert?9:6))/2,a=this._bIsVert?i?SP.JsGrid.Res.upScrollbarLabel:SP.JsGrid.Res.downScrollbarLabel:i?SP.JsGrid.Res.leftScrollbarLabel:SP.JsGrid.Res.rightScrollbarLabel;s.innerHTML=['<div elemid="'+e+'_inner" class="scroll-bar-inner-arrow-cell" style="'+this.GetLengthAndThicknessCssString(this._scrollBar._thickness-4,this._scrollBar._thickness-4)+'">','<div class="'+this._arrowDivClass+'" style="margin-top:'+(this._bIsVert?i?Math.floor(o):Math.ceil(o):Math.round(o))+"px;margin-left:"+(this._bIsVert?Math.round(u):i?Math.floor(u):Math.ceil(u))+'px;"><img elemid="'+e+'_img" src="'+n.JsGridUtil.Internal.SiteUrl+r.JsGridConstants.ImagesDirectory+'jsgridcluster.png" class="'+this.GetCssName("scroll-bar-arrow",null)+" "+(i?this._upArrowInactiveImgClass:this._downArrowInactiveImgClass)+'" role="button" aria-label="'+a+'" />',"</div>","</div>"].join("");s.elemid=e;s.className=this.GetCssName("scroll-bar-arrow-cell",!0);s.style.cssText=(this._bIsVert?"top:":"left:")+t+"px;"+this.GetLengthAndThicknessCssString(this._scrollBar._thickness-2,this._scrollBar._thickness-2);return s};e.prototype.UpdateBGDiv=function(e,t){this._renderedItemDivs[e].style[this._lengthCssString]=t+"px";this._renderedItemDivs[e+"_shade"].style[this._lengthCssString]=t+"px";this._renderedItemDivs[e+"_main"].style[this._lengthCssString]=t+"px"};e.prototype.UpdateMiddleScroll=function(e,t){this._renderedItemDivs[e].style[this._lengthCssString]=t-2+"px";var n=t-4;this._renderedItemDivs[e+"_main"].style[this._lengthCssString]=n+"px";this._renderedItemDivs[e+"_shade"].style[this._lengthCssString]=n+"px";var r=Math.round(Math.max(n-8,0)/2);this._renderedItemDivs[e+"_gripTop"].style[this._upSideCssName]=r+"px";this._renderedItemDivs[e+"_gripMiddle"].style[this._upSideCssName]=r+3+"px";this._renderedItemDivs[e+"_gripBottom"].style[this._upSideCssName]=r+6+"px"};e.prototype.UpdateDisplay=function(e,t){this._renderedItemDivs[e].style.display=t?"block":"none"};e.prototype.ActivateArrowDiv=function(e,t,n,r){this._renderedItemDivs[e+"_img"].className=this.GetCssName("scroll-bar-arrow",null)+" "+(n?this._upArrowActiveImgClass:this._downArrowActiveImgClass);this.ActivateDiv(e,r,t)};e.prototype.DeactivateArrowDiv=function(e,t,n){this._renderedItemDivs[e+"_img"].className=this.GetCssName("scroll-bar-arrow",null)+" "+(n?this._upArrowInactiveImgClass:this._downArrowInactiveImgClass);this.DeactivateDiv(e,t)};e.prototype.MarkMouseDown=function(e,t){this._renderedItemDivs[e].curStateName="mouseDownPending"};e.prototype.RemoveMouseDown=function(e,t,n){this._renderedItemDivs[e].curStateName=""};e.prototype.ActivateDiv=function(e,t,r){var i=this._renderedItemDivs[e];if("mouseDown"!=i.curStateName){var s="mouseDownPending"==i.curStateName?"mouseDown":n.JsGridUtil.Internal.DomElement.GetInstance().PointInDomElem(t.x,t.y,i,null)?"mouseOver":"mouseOut";if(i.curStateName!==s){i.style.borderColor=this._activeColors.outerBorder[s];e+"_inner"in this._renderedItemDivs?this._renderedItemDivs[e+"_inner"].style.borderColor=this._activeColors.innerBorder[s]:this._renderedItemDivs[e].style.backgroundColor=this._activeColors.innerBorder[s];this._renderedItemDivs[(null!=r?r:e)+"_shade"].style.backgroundColor=this._activeColors.shade[s];this._renderedItemDivs[(null!=r?r:e)+"_main"].style.backgroundColor=this._activeColors.main[s];i.curStateName=s}}};e.prototype.DeactivateDiv=function(e,t){this._renderedItemDivs[e].curStateName="";this._renderedItemDivs[e].style.borderColor="";e+"_inner"in this._renderedItemDivs?this._renderedItemDivs[e+"_inner"].style.borderColor="":this._renderedItemDivs[e].style.backgroundColor="";this._renderedItemDivs[(null!=t?t:e)+"_shade"].style.backgroundColor="";this._renderedItemDivs[(null!=t?t:e)+"_main"].style.backgroundColor=""};e.prototype.HighlightBGDiv=function(e){this._renderedItemDivs[e+"_main"].style.backgroundColor="#DEDFE2";this._renderedItemDivs[e+"_shade"].style.backgroundColor="#DEDFE2"};e.prototype.RestoreBGDiv=function(e){this._renderedItemDivs[e+"_shade"].style.backgroundColor="";this._renderedItemDivs[e+"_main"].style.backgroundColor=""};e.prototype.SetTop=function(e,t){this._renderedItemDivs[e].style[this._upSideCssName]=t+"px"};e.prototype.SetLength=function(e,t){this._renderedItemDivs[e].style[this._lengthCssString]=t+"px"};return e})(),o=function(e,t,n){this.topIdx=e;this.bottomIdx=t;this.userSetType=n},u={Bottom:0,Top:1},a=function(){this.itemSizes={};this.bClearItemSizes=!1;this.bMergeItemSizes=!1;this.bUpdateWhileDragging=!1};t.UpdateParams=a;t.ScrollBarType={Horizontal:0,Vertical:1};t.ScrollBarRowDisplayInfo={Before:-1,InView:0,Partial:1,After:2};function f(){var e=document.createElement("div"),t=document.createElement("div");e.style.cssText="overflow-x:scroll;position:absolute;visibility:hidden";t.style.cssText="height:50px;width:50px";e.appendChild(t);document.body.appendChild(e);var n=Math.max(e.offsetHeight-50,13);document.body.removeChild(e);f=function(){return n};return n}t.GetSystemScrollBarThickness=f;t.GetMinScrollBarLength=function(){return 2*f()+12+8+2}});
define("Wqe",["require","exports","Dqe","Lqe","Aqe","k","q"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SelectionType=n.JsGridConstants.SelectionType;t.SelectOp={Set:0,Append:1,ReplaceLast:2};t.RowSelectOp={Select:3,Unselect:4};var u=s.Killswitch.isActivated("86CDDB78-0503-4987-9214-48BC92A7E039","8/1/2019","Allow more commands in command bar in quick edit"),a={ODB:1725},f={ODB:1439},l=(function(){function e(e){this._fnOnFocusedCellChanged=e;this.Clear(!0)}e.prototype.SetAllowedSelectionTypes=function(e){this._allowedSelectionTypes=e};e.prototype.GetLastSelectionEndpoints=function(){return{rowIdx1:this._lastSelEndpt1.rowIdx,colIdx1:this._lastSelEndpt1.colIdx,rowIdx2:this._lastSelEndpt2.rowIdx,colIdx2:this._lastSelEndpt2.colIdx}};e.prototype.GetLastSelectionRangeNormalized=function(){return this._lastSelectionType==t.SelectionType.None?null:{rowRange:new i.Range(this._lastSelectionType!==t.SelectionType.ColumnRange?Math.min(this._lastSelEndpt1.rowIdx,this._lastSelEndpt2.rowIdx):0,this._lastSelectionType!==t.SelectionType.ColumnRange?Math.max(this._lastSelEndpt1.rowIdx,this._lastSelEndpt2.rowIdx):this._curFocus.gridPane.GetGridPaneConverter().GetVirtualRowCount()-1),colRange:new i.Range(this._lastSelectionType!==t.SelectionType.RowRange?Math.min(this._lastSelEndpt1.colIdx,this._lastSelEndpt2.colIdx):0,this._lastSelectionType!==t.SelectionType.RowRange?Math.max(this._lastSelEndpt1.colIdx,this._lastSelEndpt2.colIdx):this._curFocus.gridPane.GetGridPaneConverter().GetVirtualColumnCount()-1)}};e.prototype.GetFocus=function(){return this.GetFocusForPaneInternal(null)};e.prototype.GetFocusForPane=function(e){return this.GetFocusForPaneInternal(e)};e.prototype.GetFocusedPane=function(){return this._curFocus.gridPane};e.prototype.SetFocusByKey=function(e,t,n){var r=e.GetGridPaneConverter().KeyToIdx(t,n);null!=r&&this.SetFocusByPos(e,r.rowIdx,r.colIdx)};e.prototype.SetFocusByPos=function(e,n,r){this.SelectRange(e,n,n,r,r,t.SelectOp.Set,!0,!1)};e.prototype.IsCellSelected=function(e,t,n){if(e!==this._curFocus.gridPane)return!1;for(var r=0;r<this._selectedRowRanges.length;r++)if(this._selectedRowRanges[r].Contains(t))return!0;for(r=0;r<this._selectedColRanges.length;r++)if(this._selectedColRanges[r].Contains(n))return!0;for(r=0;r<this._selectedCellRanges.length;r++)if(this._selectedCellRanges[r].rowRange.Contains(t)&&this._selectedCellRanges[r].colRange.Contains(n))return!0;return!1};e.prototype.IsRowSelected=function(e,t){if(e!==this._curFocus.gridPane)return!1;for(var n=0;n<this._selectedRowRanges.length;n++)if(this._selectedRowRanges[n].Contains(t))return!0;return!1};e.prototype.isRowContainsSelectedCell=function(e,t){if(e!==this._curFocus.gridPane)return!1;if(this.IsRowSelected(e,t))return!0;for(var n=0;n<this._selectedCellRanges.length;n++)if(this._selectedCellRanges[n].rowRange.Contains(t))return!0};e.prototype.IsOneCellSelected=function(e){return null!=e&&e.rowRange.begin==e.rowRange.end&&e.colRange.begin==e.colRange.end};e.prototype.GetComponentsWithin=function(e,t,n){if(e!==this._curFocus.gridPane)return new i.Set;for(var s={},o=function(e,t){if(!e.IsEmpty()&&!t.IsEmpty())for(var n=e.begin;n<=e.end;n++)for(var i=t.begin;i<=t.end;i++)s[r.JsGridUtil.Internal.MakeCellKey(n,i)]=1},u=0;u<this._selectedRowRanges.length;u++)o(this._selectedRowRanges[u].Intersect(t),n);for(u=0;u<this._selectedColRanges.length;u++)o(t,this._selectedColRanges[u].Intersect(n));for(u=0;u<this._selectedCellRanges.length;u++)o(this._selectedCellRanges[u].rowRange.Intersect(t),this._selectedCellRanges[u].colRange.Intersect(n));return new i.Set(s)};e.prototype.SelectRange=function(e,s,l,c,h,p,d,v){var m,g=this,y=!0;e.GetDelegateMgr().Apply(n.JsGridConstants.DelegateType.AllowSelectionChange,function(e){y=e});if(!y)return!1;null!=s&&s==l&&null!=c&&c==h&&d&&p==t.SelectOp.Set&&(m={rowIdx:s,colIdx:c});if(!(function(){var e=g._allowedSelectionTypes&n.JsGridConstants.SelectionTypeFlags._RowMask,r=g._allowedSelectionTypes&n.JsGridConstants.SelectionTypeFlags._ColMask,i=g._allowedSelectionTypes&n.JsGridConstants.SelectionTypeFlags._CellMask;do{var o=!1;switch(g.ComputeSelectionType(s,l,c,h)){case t.SelectionType.RowRange:switch(e){case n.JsGridConstants.SelectionTypeFlags.SingleRow:l=s;case n.JsGridConstants.SelectionTypeFlags.SingleRowRange:p=p==t.SelectOp.Append?t.SelectOp.Set:p;break;case n.JsGridConstants.SelectionTypeFlags.NoRows:return!1}break;case t.SelectionType.ColumnRange:switch(r){case n.JsGridConstants.SelectionTypeFlags.SingleCol:h=c;case n.JsGridConstants.SelectionTypeFlags.SingleColRange:p=p==t.SelectOp.Append?t.SelectOp.Set:p;break;case n.JsGridConstants.SelectionTypeFlags.NoCols:return!1}break;case t.SelectionType.CellRange:switch(i){case n.JsGridConstants.SelectionTypeFlags.SingleCell:l=s;h=c;case n.JsGridConstants.SelectionTypeFlags.SingleCellRange:p=p==t.SelectOp.Append?t.SelectOp.Set:p;break;case n.JsGridConstants.SelectionTypeFlags.NoCells:if(e!==n.JsGridConstants.SelectionTypeFlags.NoRows){c=h=null;o=!0}else{if(r===n.JsGridConstants.SelectionTypeFlags.NoCols)return!1;s=l=null;o=!0}}}}while(o);return!0})())return!1;g.ComputeSelectionType(s,l,c,h)==t.SelectionType.CellRange&&(Math.abs(c-h)+1==e.GetGridPaneConverter().GetVirtualColumnCount()?c=h=null:Math.abs(s-l)+1==e.GetGridPaneConverter().GetVirtualRowCount()&&(s=l=null));this._lastSelEndpt1={rowIdx:s,colIdx:c};this._lastSelEndpt2={rowIdx:l,colIdx:h};this.FirePreChangeNotifications(this._curFocus.gridPane,e);var b=this.GetFocus(),w=this.ComputeSelectionType(s,l,c,h);(function(n,i){if(e!==g._curFocus.gridPane){p=t.SelectOp.Set;g._curFocus.gridPane=e}if(v){var o=e.GetGridPaneConverter().KeyToIdx(n.recordKey,n.fieldKey);g._curFocus.rowIdx=o.rowIdx;g._curFocus.colIdx=o.colIdx}else if(null!=m){g._curFocus.rowIdx=m.rowIdx;g._curFocus.colIdx=m.colIdx}else{g._curFocus.rowIdx=i==t.SelectionType.ColumnRange?e.BeginRowIdx():s;g._curFocus.colIdx=i==t.SelectionType.RowRange?e.BeginColIdx():c}if(r.JsGridUtil.Internal.IsFeatureEnabled(a)&&r.JsGridUtil.Internal.IsFeatureEnabled(f))if(p===t.SelectOp.Set&&i===t.SelectionType.RowRange){g._rowSelectionFocusOrder=[];if(s<=l)for(var u=l;u>=s;u--)g._rowSelectionFocusOrder.push(u);else for(u=l;u<=s;u++)g._rowSelectionFocusOrder.push(u)}else if(p===t.RowSelectOp.Select)g._rowSelectionFocusOrder.push(s);else if(p===t.RowSelectOp.Unselect)if(n.rowIdx!==s){g._curFocus.rowIdx=n.rowIdx;g._rowSelectionFocusOrder.splice(g._rowSelectionFocusOrder.indexOf(s),1)}else{g._rowSelectionFocusOrder.pop();g._curFocus.rowIdx=g._rowSelectionFocusOrder[g._rowSelectionFocusOrder.length-1]}else g._rowSelectionFocusOrder=[]})(b,w);(function(n){r.JsGridUtil.DebugAssert(n!==t.SelectionType.None);var d,v=n==t.SelectionType.ColumnRange?null:new i.Range(s,l).Normalize(),m=n==t.SelectionType.RowRange?null:new i.Range(c,h).Normalize();if(p==t.SelectOp.Set){g._selectedRowRanges=[];g._selectedColRanges=[];g._selectedCellRanges=[];g._orderedSelections=[]}else if(p==t.SelectOp.ReplaceLast){g._lastSelectionType==t.SelectionType.RowRange?g._selectedRowRanges.pop():g._lastSelectionType==t.SelectionType.ColumnRange?g._selectedColRanges.pop():g._lastSelectionType==t.SelectionType.CellRange&&g._selectedCellRanges.pop();g._orderedSelections.pop()}if(n==t.SelectionType.RowRange){d=v;if(r.JsGridUtil.Internal.IsFeatureEnabled(a)&&r.JsGridUtil.Internal.IsFeatureEnabled(f))if(p===t.RowSelectOp.Select){g._selectedCellRanges=[];g._selectedRowRanges.push(d)}else if(p===t.RowSelectOp.Unselect){var y=v.begin;if(1===g._selectedRowRanges.length){var b=g._selectedRowRanges[0];if(y===b.begin){var w=new i.Range(b.begin+1,b.end);g._selectedRowRanges=[w];g._lastSelEndpt1.rowIdx=w.begin;g._lastSelEndpt2.rowIdx=w.end}else if(y===b.end){w=new i.Range(b.begin,b.end-1);g._selectedRowRanges=[w];g._lastSelEndpt1.rowIdx=w.begin;g._lastSelEndpt2.rowIdx=w.end}else g._selectedRowRanges=[new i.Range(b.begin,y-1),new i.Range(y+1,b.end)]}else{for(var E=void 0,S=0;S<g._selectedRowRanges.length;S++)if(g._selectedRowRanges[S].Contains(y)){E=S;break}var x=g._selectedRowRanges[E];g._selectedRowRanges.splice(E,1);if(x.Size()>1){w=void 0;x.begin===y?w=new i.Range(x.begin+1,x.end):x.end===y&&(w=new i.Range(x.begin,x.end-1));w?g._selectedRowRanges.push(w):g._selectedRowRanges.push(new i.Range(x.begin,y-1),new i.Range(y+1,x.end))}if(1===g._selectedRowRanges.length){g._lastSelEndpt1.rowIdx=g._selectedRowRanges[0].begin;g._lastSelEndpt2.rowIdx=g._selectedRowRanges[0].end}}}else g._selectedRowRanges.push(d);else g._selectedRowRanges.push(d)}else if(n==t.SelectionType.ColumnRange){d=m;g._selectedColRanges.push(d)}else if(n==t.SelectionType.CellRange){d={rowRange:v,colRange:m};g._selectedCellRanges.push(d)}g._orderedSelections.push({type:n,range:d});g._lastSelectionType=n;if(!u&&e._objBag&&e._objBag.onSelectionChanged&&e.tableMgr){var T=e._objBag.jsGridParams.telemetry,N=void 0;T&&(N=new(T(o.Qos))({name:"QuickEditUpdateSelectionForCommandBar"}));try{var C=[],k=e.GetGridPaneConverter();for(S=0;S<g._selectedRowRanges.length;S++)for(var L=g._selectedRowRanges[S],A=L.begin;A<=L.end;A++){var O=k.RowIdxToRecordKey(A),M=e.tableMgr.GetRecordByKey(O);M&&M.fieldRawDataMap&&M.fieldRawDataMap.csrInfo&&C.push(M.fieldRawDataMap.csrInfo.ID)}e._objBag.onSelectionChanged(C);N&&N.end({resultType:o.ResultTypeEnum.Success})}catch(e){N&&N.end({resultType:o.ResultTypeEnum.Failure,resultCode:"FailToUpdateSelection",error:e.message})}}})(w);this.FirePostChangeNotifications(b,d);return!0};e.prototype.GetRowRanges=function(e){return e==this._curFocus.gridPane?this._selectedRowRanges:[]};e.prototype.GetColumnRanges=function(e){return e==this._curFocus.gridPane?this._selectedColRanges:[]};e.prototype.GetCellRanges=function(e){return e==this._curFocus.gridPane?this._selectedCellRanges:[]};e.prototype.Clear=function(e){var n;if(!e){this.FirePreChangeNotifications(this._curFocus.gridPane,null);n=this.GetFocus()}this._selectedRowRanges=[];this._selectedColRanges=[];this._selectedCellRanges=[];this._orderedSelections=[];this._curFocus={};this._rowSelectionFocusOrder=[];this._lastSelEndpt1=this._lastSelEndpt2=null;this._lastSelectionType=t.SelectionType.None;e||this.FirePostChangeNotifications(n,!1)};e.prototype.GetLastSelectionType=function(){return this._lastSelectionType};e.prototype.GetOrderedSelections=function(e,n){var i=function(e){for(var t=new Array(e.Size()),n=e.begin;n<=e.end;n++)t[n-e.begin]=u.RowIdxToRecordKey(n);return{begin:e.begin,end:e.end,keys:t}},s=function(e){for(var t=new Array(e.Size()),n=e.begin;n<=e.end;n++)-1===n&&r.JsGridUtil.Internal.IsFeatureEnabled(a)&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive?t[n-e.begin]="SelectionRowHeaderCell":t[n-e.begin]=u.ColIdxToColKey(n);return{begin:e.begin,end:e.end,keys:t}},o=[];if(e==this._curFocus.gridPane)for(var u=e.GetGridPaneConverter(),f=0;f<this._orderedSelections.length;f++){var l=this._orderedSelections[f].type,c=this._orderedSelections[f].range;if(null==n||n==l)switch(l){case t.SelectionType.RowRange:o.push(i(c));break;case t.SelectionType.ColumnRange:o.push(s(c));break;case t.SelectionType.CellRange:var h=c;o.push({rowRange:i(h.rowRange),colRange:s(h.colRange)})}}return o};e.prototype.FirePreChangeNotifications=function(e,t){this._updatingReturnOld=null!=e?e.NotifySelectionUpdating():null;this._updatingReturnNew=null!=t?t!==e?t.NotifySelectionUpdating():this._updatingReturnOld:null};e.prototype.FirePostChangeNotifications=function(e,t){var n=this.GetFocus();null!=e&&e.gridPane.NotifySelectionUpdated(this._updatingReturnOld,t);null==n||null!=e&&n.gridPane===e.gridPane||n.gridPane.NotifySelectionUpdated(this._updatingReturnNew,t);(null==e&&null!=n||null!=e&&null==n||null!=e&&null!=n&&(e.recordKey!=n.recordKey||e.fieldKey!=n.fieldKey))&&this._fnOnFocusedCellChanged(r.JsGridUtil.EventArgs.CellFocusChanged(n&&n.recordKey,n&&n.fieldKey,e&&e.recordKey,e&&e.fieldKey))};e.prototype.ComputeSelectionType=function(e,n,r,i){return null==e||null==n?t.SelectionType.ColumnRange:null==r||null==i?t.SelectionType.RowRange:t.SelectionType.CellRange};e.prototype.GetFocusForPaneInternal=function(e){if(null==this._curFocus.gridPane||null!=e&&this._curFocus.gridPane!==e||this._curFocus.colIdx>=this._curFocus.gridPane.GetGridPaneConverter().GetVirtualColumnCount())return null;var t=this._curFocus.colIdx,n=!1;if(r.JsGridUtil.Internal.IsFeatureEnabled(a)&&!r.JsGridUtil._keyboardToRowHeaderKillswitchIsActive&&-1===t){t=0;n=!0}var i=this._curFocus.gridPane.GetGridPaneConverter().IdxToKey(this._curFocus.rowIdx,t);return null==i.recordKey||null==i.fieldKey||null==i.columnKey?null:{rowIdx:this._curFocus.rowIdx,colIdx:this._curFocus.colIdx,recordKey:i.recordKey,fieldKey:n?"SelectionRowHeaderCell":i.fieldKey,columnKey:n?"SelectionRowHeaderCell":i.columnKey,gridPane:this._curFocus.gridPane,isSelectionCellFocused:n}};return e})();t.SelectionManager=l});
define("Aqe",["require","exports","Lqe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.collection=n.JsGridUtil.Internal.IsNullOrUndefined(e)?{}:e}e.prototype.IsEmpty=function(){for(var e in this.collection)return!1;return!0};e.prototype.First=function(){for(var e in this.collection)return e;n.JsGridUtil.DebugAssert(!1,"Should not call First on empty Set");return null};e.prototype.GetCollection=function(){return this.collection};e.prototype.ToArray=function(){return n.JsGridUtil.Internal.ConvertSetKeysToArray(this.collection)};e.prototype.AddArray=function(e){for(var t=0;t<e.length;t++)this.collection[e[t]]=1;return this};e.prototype.Add=function(e){this.collection[e]=1;return e};e.prototype.Remove=function(e){var t=this.collection[e];delete this.collection[e];return t};e.prototype.Clear=function(){this.collection={};return this};e.prototype.Contains=function(e){return e in this.collection};e.prototype.Clone=function(){var t={};for(var n in this.collection)t[n]=1;return new e(t)};e.prototype.SymmetricDifference=function(t){var n={};for(var r in this.collection)r in t.collection||(n[r]=1);for(r in t.collection)r in this.collection||(n[r]=1);return new e(n)};e.prototype.Difference=function(t){var n={};for(var r in this.collection)r in t.collection||(n[r]=1);return new e(n)};e.prototype.Union=function(e){var t=this.Clone();for(var n in e.collection)t.collection[n]=1;return t};e.prototype.UnionWith=function(e){for(var t in e.collection)this.collection[t]=1};e.prototype.Intersection=function(t){var n={};for(var r in this.collection)r in t.collection&&(n[r]=1);return new e(n)};return e})();t.Set=r;var i=(function(){function e(){this.dictionary={};this.valueKeyMap={}}e.prototype.Add=function(e,t){this.dictionary[e]=t;this.valueKeyMap[t]=e};e.prototype.RemoveKey=function(e){delete this.valueKeyMap[this.dictionary[e]];delete this.dictionary[e]};e.prototype.RemoveValue=function(e){delete this.dictionary[this.valueKeyMap[e]];delete this.valueKeyMap[e]};e.prototype.GetValue=function(e){return this.dictionary[e]};e.prototype.GetKey=function(e){return this.valueKeyMap[e]};e.prototype.GetDictionary=function(){return this.dictionary};e.prototype.Clear=function(){this.dictionary={};this.valueKeyMap={}};e.prototype.ContainsKey=function(e){return e in this.dictionary};e.prototype.ContainsValue=function(e){return e in this.valueKeyMap};return e})();t.KeyMap=i;var s=(function(){function e(e,t){if(null==e||null==t)this.Clear();else{this.begin=e;this.end=t}}e.prototype.Normalize=function(){var e=Math.min(this.begin,this.end),t=Math.max(this.begin,this.end);this.begin=e;this.end=t;return this};e.prototype.Contains=function(e){return e>=this.begin&&e<=this.end};e.prototype.IsEmpty=function(){return this.begin>this.end};e.prototype.Clear=function(){this.begin=0;this.end=-1};e.prototype.Size=function(){return Math.max(0,this.end-this.begin+1)};e.prototype.Overlaps=function(e){return this.end>=e.begin&&e.end>=this.begin};e.prototype.Intersect=function(t){return new e(Math.max(this.begin,t.begin),Math.min(this.end,t.end))};e.prototype.IsDifferent=function(e){return this.begin!==e.begin||this.end!==e.end};return e})();t.Range=s});
define("jqe",["require","exports","Dqe","Lqe","zqe","gQe","Vqe","Eqe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t,n,r,i,s,o){this.groupingRecords=null;this.rememberedRecordKeyHash=null;this.inVirtualMode=!1;this.populatingWebMethod=e;this.initWebMethod=t;this.computeDataRangeWebMethod=n;this._webMethodMgr=r;this._jsGridControl=i;this._fnRefreshRowViewCallback=s;this._fnUpdateDisplayAndEditControls=o}e.prototype.RefreshTableView=function(e,t,r){var o=this,u=new i.TableViewParameters,a=n.JsGridConstants.DeserializationMode.TableView;return this._webMethodMgr[this.initWebMethod.name](this.GetArguments(this.initWebMethod,a),function(n){var r=new s.Deserializer(n,a,o.keyColumnName);o.rememberedRecordKeyHash=r.recordKeyHash;if(!e){o._jsGridControl.ClearTableView();o.tableCache.Clear()}o.ProcessNewTableView(r,u,!0);null!=t&&t(u,r.additionalParams)},r)};e.prototype.RefreshRowView=function(e,t,r){var i=this,o=n.JsGridConstants.DeserializationMode.RowView;return this._webMethodMgr[this.populatingWebMethod.name](this.GetArguments(this.populatingWebMethod,o),function(n){var r=new s.Deserializer(n,o,i.keyColumnName);i.rememberedRecordKeyHash=r.recordKeyHash;var u=r.InitJsGridRowViewParams();e||i.tableCache.Clear();i.ProcessNewRowView(r,u);null!=t&&t(u,r.additionalParams)},r)};e.prototype.GetAutoFilterEntries=function(e,t,r){var i=this,o=n.JsGridConstants.DeserializationMode.AutoFilter;return this._webMethodMgr[this.populatingWebMethod.name](this.GetArguments(this.populatingWebMethod,o,e),function(e){var n=new s.Deserializer(e,o,i.keyColumnName);t(n.autoFilterEntries)},r)};e.prototype.BeginFullLoad=function(e,t,r){var i=this,u=n.JsGridConstants.DeserializationMode.Full;return this._webMethodMgr[this.initWebMethod.name](this.GetArguments(this.initWebMethod,u),function(t){var n=new s.Deserializer(t,u);null!=n.minimalInfo&&(i.inVirtualMode=!0);i.rememberedRecordKeyHash=n.recordKeyHash;i.keyColumnName=n.keyColumnName;i.jsGridParams=n.InitJsGridParams(r);i.jsGridParams.tableCache=i.tableCache=new o.TableCache(i.GetData.bind(i),i.ConvertDataToRecords.bind(i),i._webMethodMgr[i.computeDataRangeWebMethod.name]);i.tableCache.SetConvertAllBlobsToRecords(!0);i.tableCache.SetKeepDataInBlobCache(!1);i.tableCache.SetMaxRecordCount(1e3);i.ProcessNewTableView(n,i.jsGridParams.tableViewParams,!1);e(i.jsGridParams,n.additionalParams)},t)};e.prototype.HasColumnName=function(e){return null!=this.recordFactory.gridFieldMap[e]};e.prototype.AddColumn=function(e){this.recordFactory.gridFieldMap[e.key]=e;var t={},n=this.tableCache.GetView(),r=function(){return{isProp:!0,prop:u.PropertyType.Property.prototype.MakeProperty(void 0,void 0,e.hasDataValue,e.hasLocalizedValue,e.GetPropType())}};for(var i in n)t[n[i]]=r();this.tableCache.AddColumn(e.key,t,r)};e.prototype.ProcessNewTableView=function(e,t,n){n&&e.InitJsGridTableViewParams(t);this.keyColumnName!=e.keyColumnName&&(this.keyColumnName=e.keyColumnName);this.recordFactory=new u.PropertyType.RecordFactory(e.gridFieldMap,this.keyColumnName);this.ProcessNewRowView(e,t.rowViewParams)};e.prototype.ProcessNewRowView=function(e,t){null!=this.groupingRecords&&this.tableCache.ClearRecords(this.groupingRecords);this.tableCache.AddRawDataToCache(r.JsGridUtil.Internal.ConvertSetKeysToArray(e.data),e.data);this.groupingRecords=e.viewDependentKeys;e.InitCellStyles(this.jsGridParams.styleManager);this._fnUpdateDisplayAndEditControls()};e.prototype.GetArguments=function(e,t,n,r){var i=e.fnGenerateArgs(t),s=null==i.gridSerializerArgs?{}:i.gridSerializerArgs;this.inVirtualMode?null==s.PagingInfo&&(s.PagingInfo=null!=r?{pos:r[0].pos,count:r[0].count}:{pos:0,count:100}):null==s.PagingInfo&&(s.PagingInfo=null!=r?this.GenerateRangeStrings(r):["FirstVisible:100"]);s.RequestType=t;null!=this.rememberedRecordKeyHash&&(s.RememberedRecordKeyHash=this.rememberedRecordKeyHash);null!=n&&(s.AutoFilterColumnKeys=n);i.gridSerializerArgs=s;return i};e.prototype.ConvertDataToRecords=function(e,t){var n={};for(var r in t)if(t[r]in e){var i=e[t[r]];n[t[r]]=this.recordFactory.MakeRecord(i.data,i.localized)}return n};e.prototype.GetData=function(e,t){var i=this;return this._webMethodMgr[this.populatingWebMethod.name](this.GetArguments(this.populatingWebMethod,n.JsGridConstants.DeserializationMode.Slice,null,e),function(o){var u=new s.Deserializer(o,n.JsGridConstants.DeserializationMode.Slice,i.keyColumnName);i.rememberedRecordKeyHash=u.recordKeyHash;if(u.recordKeyOrderChanged){var a=(u=new s.Deserializer(o,n.JsGridConstants.DeserializationMode.RowView,i.keyColumnName)).InitJsGridRowViewParams();i.ProcessNewRowView(u,a);null!=i._fnRefreshRowViewCallback&&i._fnRefreshRowViewCallback(a,u.additionalParams)}else null==u.minimalInfo&&null!=u.viewDependentKeys&&(i.groupingRecords=null==i.groupingRecords?u.viewDependentKeys:i.groupingRecords.concat(u.viewDependentKeys));var f=r.JsGridUtil.Internal.ConvertSetKeysToArray(u.data);if(i.inVirtualMode)for(var l=0;l<f.length;l++){var c=i.tableCache.RecordIdxToKey(e[0].pos+l);i._jsGridControl.ChangeKeys(c,f[l])}t([{data:u.data,keys:f}])},function(){t(null)})};e.prototype.GenerateRangeStrings=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].pos+","+e[n].count);return t};return e})();t.SharePointDataSource=a});
define("Mqe",["require","exports","r","Lqe","Dqe","jqe","Eqe","Aqe","RWe","zqe","Nqe","kqe","Rqe","ga","Hqe","bv","So","IL","Fqe","Ak","k","yqe","gqe","q","Uqe","Tqe","Iqe","PFe","ze","M","Q8","_qe","Pqe","lWe","Q3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var H={ODB:1310},B={ODB:1746},j={ODB:1806},F={ODB:1170},I={ODB:1725},q={ODB:1507},R={ODB:1892},U={ODB:1024},z={ODB:1740},W={ODB:1300},X={ODB:1843},V={ODB:60053},$=w.Killswitch.isActivated("8DAECEAF-4AEF-45B5-A606-9A3034CC2124","10/18/2019","Use modern taxonomy editor in quick edit."),J=w.Killswitch.isActivated("91C4DDB5-64CC-4DD8-A3E5-BB6D7E38971E","10/2/2019","Batch the csom calls so that they dont hit the csom limit."),K=w.Killswitch.isActivated("0432E43E-C631-4773-A94E-2E508B1B7769","11/20/2019","Add some QOS to SPGantt."),Q=w.Killswitch.isActivated("D1EB03FD-9CB4-47AA-83E2-BC9D730B6DB1","12/31/2019","Add a better check for an email being null."),G=w.Killswitch.isActivated("79AF3379-785D-4527-8C2E-79CAC8F796D2","3/12/2020","Get rid of open editors when a column moves"),Y=w.Killswitch.isActivated("C4807DCB-BAA4-421D-B130-BD340C0B259D","6/2/2020","rebind column functions after edit"),Z=w.Killswitch.isActivated("A886E7B9-6E94-4486-B7D4-65AA7916EB0B","8/20/2020","Break loop when new field is found"),ee=w.Killswitch.isActivated("81D986A7-7828-4B05-8F08-2209F0ED1D9B","8/31/2020","Convert csom SP.FieldUserValue data into email and displayText format"),te=w.Killswitch.isActivated("033378EB-16AC-4609-9145-26934DDCE68B","10/7/2020","When activated, default values of fields will not show"),ne=w.Killswitch.isActivated("EC4AE4F1-A4D6-4A7D-B010-0F14A2EFA541","10/15/2019","Fix issue with sending raw CSOM objects down into cell renderers."),re={writeChange:"QuickEditWriteChange",renameColumn:"QuickEditRenameColumn",deleteItems:"QuickEditDeleteItems",moveColumn:"QuickEditMoveColumn",addColumn:"QuickEditAddColumn",createItem:"QuickEditCreateItem",undoChange:"QuickEditUndoChange",redoChange:"QuickEditRedoChange"},ie={};t.OnJsGridIframeLoad=function(e){ie[e].OnAutoFilterReturn()};var se=function(e,t){this.name=e;this.fnGenerateArgs=t};t.WebMethod=se;var oe=(function(){function t(t,n){var i=this;this._serverWriteTimeout=null;this._hierarchyEnabled=!1;this._rowLevelErrors={};this._GridValueToSPListValueConverters={};this._SPListValueToGridValueConverters={};this._selfReferencingLookupPropTypes={};this._propChangesPendingValidation=new u.Set;this._changeKeysPendingValidation={};this._changesToSend={};this._currentlyRenamingColumn=!1;this._fnCallbacksByChangeKey=new r.JsGridUtil.ChangeKeyOnCompleteMap;this._isFullLoadCompleted=!1;this._fnCallbackCompleteFullLoad=[];this._fnRowChanged=[];this._isUsingDataSync=!1;this.Undo=function(){var e=new(i._telemetry(x.Qos))({name:re.undoChange});try{i._commandMgr.Undo();e.end({resultType:x.ResultTypeEnum.Success})}catch(n){var t=M.getErrorMessage(n);e.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToUndoChange",error:t})}};this.Redo=function(){var e=new(i._telemetry(x.Qos))({name:re.redoChange});try{i._commandMgr.Redo();e.end({resultType:x.ResultTypeEnum.Success})}catch(n){var t=M.getErrorMessage(n);e.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToRedoChange",error:t})}};this._onBeginUndoDataUpdateChange=function(e){e.changeKey;i._logEngagement("QuickEditOnBeginUndoDataUpdateChange")};this._onBeginRedoDataUpdateChange=function(e){e.changeKey;i._logEngagement("QuickEditOnBeginRedoDataUpdateChange")};this.addColumnOnCompleteCallback=function(){var e=i._jsGridControl.GetSpCsrRenderCtx();i._ensureExternalJsFilesLoaded(function(){S.SPGridFetchSchema(e.listName,e.view,function(e){for(var t,n,r,s,o=i._jsGridControl.GetSpCsrRenderCtx(),u=e.Field.length,a=function(u){t=e.Field[u];n=!1;for(var a=0;a<o.ListSchema.Field.length;a++)if(t.RealFieldName===o.ListSchema.Field[a].RealFieldName){n=!0;break}if(!n){if("Choice"===t.FieldType||"MultiChoice"===t.FieldType){var f;r=function(){var e,n=f.get_schemaXml();if(n){var r=(new DOMParser).parseFromString(n,"text/xml");e=i.createNewColumn(t,r)}else e=i.createNewColumn(t);i._dataSource.AddColumn(e);var s=i.createColumnInfo(t);i._jsGridControl.AddColumn(s,e,i._currentAddColumnInternalName);i._jsGridControl.ShowColumn(t.RealFieldName);i._jsGridControl.EnsurePaneWidth();i._jsGridControl.NotifyDataAvailable()};i.runQuery(function(e){var n=i.InitContext(r,{},e),s=n.list.get_fields();f=s.getByInternalNameOrTitle(t.Name);n.context.load(f);n.context.executeQueryAsync()})}else{s=i.createNewColumn(t);i._dataSource.AddColumn(s);var l=i.createColumnInfo(t);i._jsGridControl.AddColumn(l,s,i._currentAddColumnInternalName);i._jsGridControl.ShowColumn(t.RealFieldName);i._jsGridControl.EnsurePaneWidth();i._jsGridControl.NotifyDataAvailable()}if(!Z)return"break"}},f=0;f<u;f++){if("break"===a(f))break}o.ListSchema=e})})};this.editColumnOnCompleteCallback=function(){var e=i._jsGridControl.GetSpCsrRenderCtx();i._ensureExternalJsFilesLoaded(function(){S.SPGridFetchSchema(e.listName,e.view,function(e){var t=i._jsGridControl.GetSpCsrRenderCtx();if(i._currentEditColumnInternalName){for(var n,r=!1,s=0;s<e.Field.length;s++)if(e.Field[s].RealFieldName===i._currentEditColumnInternalName){r=!0;n=e.Field[s];break}r?i.editColumnInternal(e,t,n):i.deleteColumnInternal(t)}})})};window.OnJsGridIframeLoad=function(e){ie[e].OnAutoFilterReturn()};this._disposeDialogContainer=document.createElement("div");this._aadUserId=n;K||(this._telemetry=t);var s=function(e){return r.JsGridUtil.Internal.IsFeatureEnabled(e)};this._isUsingDataSync=P.isDataSyncEnabled(s,P.DataSyncEntityType.SharePointList);this._getDataSyncClientImport=i._isUsingDataSync?new Promise(function(t,n){e(["lWe"],t,n)}).then(function(e){return function(t){return e.getDataSyncClient(t,s)}}):Promise.resolve(function(e){})}Object.defineProperty(t,"Instances",{get:function(){return this._instances},enumerable:!0,configurable:!0});Object.defineProperty(t,"FnGanttCreationCallback",{get:function(){return this._FnGanttCreationCallback},enumerable:!0,configurable:!0});t.WaitForGanttCreation=function(e){for(var t=this.Instances,n=0;n<t.length;n++)e(t[n]);this.FnGanttCreationCallback.push(e)};t.prototype.get_Api=function(){return this._api};t.prototype.AttachFullLoadCallback=function(e){this._fnCallbackCompleteFullLoad.push(e);this._isFullLoadCompleted&&e(this._gridFieldMap)};t.prototype.AttachRowChanged=function(e){this._fnRowChanged.push(e)};t.prototype.GetListId=function(){return this._params.listId};t.prototype.UpdateProperties=function(e){this._jsGridControl.UpdateProperties(e,null,null)};t.prototype.IsParseAndSetFields=function(e){return e in this._params.parseAndSetFields};t.prototype.UpdateDisplayAndEditControls=function(){o.PropertyType.Utils.UpdateEditControlForPropType("String",this._editBoxControlId);o.PropertyType.Utils.UpdateEditControlForPropType("Hyperlink",this._hyperlinkControlId);var e=1==r.JsGridUtil.SpRegionalSettings.calendarType;r.JsGridUtil.Internal.IsFeatureEnabled(q)&&e&&!r.JsGridUtil.Internal.IsIEBrowser()&&o.PropertyType.Utils.UpdateEditControlForPropType("SPDateTime",this._datePickerControlId);for(var t=o.PropertyType.Utils.GetPropTypes(),n=0;n<t.length;n++){var i=t[n];"SPUser"===i||"SPUser_MultiValue"==i?o.PropertyType.Utils.UpdateDisplayControlForPropType(i,a.DisplayControlType.User):"SPImageThumbnail"===i?o.PropertyType.Utils.UpdateDisplayControlForPropType(i,a.DisplayControlType.ImageThumbnail):o.PropertyType.Utils.UpdateDisplayControlForPropType(i,a.DisplayControlType.CSR)}};t.prototype.Init=function(e,n,u){var l=this;this._jsGridControl=e;ie[this._jsGridControl.parentNode.id]=this;this._params=u;if(this._params.viewSelectorId){var c=RenderViewSelectorPivotMenu({wpq:this._params.viewSelectorId,viewTitle:this._params.viewTitle,ListSchema:{ViewSelectorPivotMenuOptions:this._params.ViewSelectorPivotMenuOptions}});document.getElementById(this._params.viewSelectorId).innerHTML='<div class="ms-csrlistview-controldiv">'+c+"</div>"}if(null!=n){if(null!=n.SortState&&1==n.SortState.length){var h=n.SortState;this._sortState={sortField:h[0].fieldKey,isDescending:h[0].isDescending}}this.ResolveAutoFilterState(n.AutoFilterState);var p=u.spCsrRenderCtx;if(p){p.inGridMode=!1;var d=new r.JsGridUtil.Internal.List_QstringStruct(p.clvp.PagingString());for(var v in d.filterParams)delete d.filterParams[v];for(var m in d.nonFilterParams)"Paged"!==m&&"PagedPrev"!==m&&"PageFirstRow"!==m&&"PageLastRow"!==m&&"FirstRow"!==m&&0!==m.indexOf("p_")&&delete d.nonFilterParams[m];this._pagingInfo=d.toString();p.inGridMode=!0}}this._infoFetched=new Array(this._params.totalItemCount);this.InitSPListValueConversion(this._params.splookupFieldInfo);this.customFieldInfo=this._params.customFieldInfo;this._gridParams=new f.JsGridControlParameters({commandManagerParams:{maxUndoDepth:100,onUndoRealCmdCountChange:this._params.onUndoRealCmdCountChange,onRedoRealCmdCountChange:this._params.onRedoRealCmdCountChange}});this._gridParams.canUserAddColumn=this._params.canUserAddColumn;this._gridParams.showAddColumn=this._params.showAddColumn;this._gridParams.spGrid=this._params.spGrid;this._gridParams.spCsrRenderCtx=this._params.spCsrRenderCtx;this._gridParams.qualifier=this._params.qualifier;this._gridParams.peoplePickerDataSource=this._params.peoplePickerDataSource;this._gridParams.portalManager=this._params.portalManager||_.defaultPortalManger;this._gridParams.locationDataSource=this._params.locationDataSource;this._gridParams.taxonomyPickerDataSource=this._params.taxonomyPickerDataSource;this._gridParams.pageContext=this._params.pageContext;this._gridParams.customFormatterProps=this._params.customFormatterProps;this._gridParams.telemetry=this._params.telemetry;this._gridParams.onLaunchFilterPanel=this._params.onLaunchFilterPanel;this._gridParams.onSort=this._params.onSort;this._gridParams.launchColumnCustomization=this._params.launchColumnCustomization;this._gridParams.launchColumnsEditor=this._params.launchColumnsEditor;this._gridParams.onLaunchColumnManagementPanel=this._params.onLaunchColumnManagementPanel;this._gridParams.onColumnChangeSucceeded=this._params.onColumnChangeSucceeded;this._gridParams.baseEngagementData=this._params.baseEngagementData;this._gridParams.onPinToFiltersPane=this._params.onPinToFiltersPane;this._gridParams.gridId=this._params.gridId;if(null!=this._gridParams.tableViewParams){"boolean"==typeof this._params.bHidableColumns&&(this._gridParams.tableViewParams.bHidableColumns=this._params.bHidableColumns);"boolean"==typeof this._params.bMovableColumns&&(this._gridParams.tableViewParams.bMovableColumns=this._params.bMovableColumns)}this._pageContext=this._params.pageContext;this._editBoxControlId=a.EditControlType.EditBox;this._peoplePickerControlId=a.EditControlType.PeoplePicker;this._locationPickerControlId=a.EditControlType.LocationPicker;this._datePickerControlId=a.EditControlType.DatePicker;this._checkBoxControlId=a.EditControlType.Checkbox;this._numberBoxControlId=a.EditControlType.NumberBox;this._editBoxControlId="EDIT_SPGRIDEDITBOX";o.PropertyType.Utils.RegisterEditControl(this._editBoxControlId,function(e){return N.GetEditBoxEditControl(e)},[]);this._peoplePickerControlId="EDIT_SPGPEOPLEPICKER";o.PropertyType.Utils.RegisterEditControl(this._peoplePickerControlId,function(e){return N.GetPeoplePickerEditControl(e)},[]);this._locationPickerControlId="EDIT_SPGLOCATIONPICKER";o.PropertyType.Utils.RegisterEditControl(this._locationPickerControlId,function(e){return N.GetLocationPickerEditControl(e)},[]);r.JsGridUtil.Internal.IsFeatureEnabled(z)&&o.PropertyType.Utils.RegisterEditControl(this._checkBoxControlId,function(e){return N.GetCheckBoxEditControl(e)},[]);r.JsGridUtil.Internal.IsFeatureEnabled(W)&&o.PropertyType.Utils.RegisterDisplayControl(this._numberBoxControlId,function(e){return N.GetNumberBoxEditControl(e)},[]);o.PropertyType.RegisterNewCustomPropType(new T.TextMaxLengthPropertyType(this.BuildMaxLengthTable(this._params.customFieldInfo)),a.DisplayControlType.Text,this._editBoxControlId);var g,y,b=1==r.JsGridUtil.SpRegionalSettings.calendarType;if(r.JsGridUtil.Internal.IsFeatureEnabled(q)&&b&&!r.JsGridUtil.Internal.IsIEBrowser()){o.PropertyType.Utils.RegisterEditControl(this._datePickerControlId,function(e){return N.GetDatePickerEditControl(e)},[]);o.PropertyType.RegisterNewCustomPropType(new T.DatePropertyType,a.DisplayControlType.Text,this._editBoxControlId)}else o.PropertyType.RegisterNewCustomPropType(new T.DatePropertyType,a.DisplayControlType.Text,this._editBoxControlId,[a.WidgetControlType.Date]);o.PropertyType.RegisterNewCustomPropType(new T.EditPropertyType,a.DisplayControlType.Image,this._editBoxControlId);o.PropertyType.RegisterNewCustomPropType(new T.UserPropertyType(this),a.DisplayControlType.Text,this._peoplePickerControlId);o.PropertyType.RegisterNewCustomPropType(new T.PercentCompletePropertyType,a.DisplayControlType.Text,this._editBoxControlId);r.JsGridUtil.Internal.IsFeatureEnabled(W)&&o.PropertyType.RegisterNewCustomPropType(new T.NumberPropertyType,a.DisplayControlType.Text,this._numberBoxControlId);if(r.JsGridUtil.Internal.IsFeatureEnabled(j)){this._hyperlinkControlId=a.EditControlType.Hyperlink;o.PropertyType.Utils.RegisterEditControl(this._hyperlinkControlId,function(e){return N.GetHyperlinkEditControl(e)},[])}else{this._hyperlinkControlId="EDIT_SPGHYPERLINK";o.PropertyType.Utils.RegisterEditControl(this._hyperlinkControlId,function(e){return N.GetEditBoxEditControl(e,!0)},[])}var S=null!=this._params.spCsrRenderCtx;if(S){g="EDIT_SPGMULTILINEPLAINTEXT";o.PropertyType.Utils.RegisterEditControl(g,function(e){return new N.MultilinePlainTextEditControl(e)},[]);y="EDIT_SPGENHANCEDRICHTEXT";o.PropertyType.Utils.RegisterEditControl(y,function(e){return new N.EnhancedRichTextEditControl(e,l._params.qualifier)},[])}o.PropertyType.RegisterNewCustomPropType(new T.MultilineTextPropertyType,a.DisplayControlType.Text,S?g:this._editBoxControlId);o.PropertyType.RegisterNewCustomPropType(new T.EnhancedRichTextPropertyType,a.DisplayControlType.Text,S?y:this._editBoxControlId);w.Killswitch.isActivated("9328df4d-1b7a-4a12-a64f-036d20af969b","01/10/2020","Render thumbnail in quick edit")||o.PropertyType.RegisterNewCustomPropType(new T.ImageThumbnailPropertyType,a.DisplayControlType.ImageThumbnail,this._editBoxControlId);if($)SP.UI.Taxonomy.ControlRegistration.RegisterGridControls(this,this.customFieldInfo,S);else{if(r.JsGridUtil.Internal.IsFeatureEnabled(B)){o.PropertyType.RegisterNewCustomPropType(new E.Taxonomy.TaxonomyFieldPropertyType(this.customFieldInfo),"","EDIT_TAXONOMY");this.RegisterGridValueToSPListValueConverter("TaxonomyField",E.Taxonomy.DataConverters.GridValueToInputValue);this.RegisterSPListValueToGridValueConverter("TaxonomyField",E.Taxonomy.DataConverters.SPListValueToGridValue);this.RegisterGridValueToSPListValueConverter("TaxonomyField_MultiValue",E.Taxonomy.DataConverters.GridValueToInputValue);this.RegisterSPListValueToGridValueConverter("TaxonomyField_MultiValue",E.Taxonomy.DataConverters.SPListValueCollectionToGridValue)}else SP.UI.Taxonomy.ControlRegistration.RegisterGridControls(this,this.customFieldInfo,S);this._taxonomyPickerControlId="EDIT_TAXONOMY";o.PropertyType.Utils.RegisterEditControl(this._taxonomyPickerControlId,function(e){return N.GetTaxonomyPickerEditControl(e,l.customFieldInfo)},[]);o.PropertyType.Internal.Property.GetInstance().UpdateWidgetControlsForPropType("TaxonomyField",[])}var x=this._params.siteUrl+"/",C=r.JsGridUtil.Internal.IsFeatureEnabled(R);for(var k in this._params.splookupFieldInfo){var L=this._params.splookupFieldInfo[k],A=new T.LookupPropertyType(k,L,x);o.PropertyType.RegisterNewCustomPropType(A,a.DisplayControlType.Text,C?a.EditControlType.BooleanComboBox:a.EditControlType.ComboBox);if(L.listId.toUpperCase()==this._params.listId.toUpperCase()){null==this._selfReferencingLookupPropTypes[L.field]&&(this._selfReferencingLookupPropTypes[L.field]=[]);this._selfReferencingLookupPropTypes[L.field].push(A)}}this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.GetFieldEditMode,this.GetFieldEditMode.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.GetFieldReadOnlyActiveState,this.GetFieldReadOnlyActiveState.bind(this));var O=this._gridParams.styleManager,M=O.columnHeaderStyleCollection;O.UpdateHeaderStyleFromCss(M,{normal:{base:"ms-spgrid-col-header-normal"},normalHover:{base:"ms-spgrid-col-header-normal-hover",elementColor:"ms-spgrid-col-header-elem-bg-colors-normal-hover",elementHoverColor:"ms-spgrid-col-header-elem-hover-bg-colors-normal-hover",elementClickColor:"ms-spgrid-col-elem-colors-click-normal-hover"},partSelected:{base:"ms-spgrid-col-header-part-selected"},partSelectedHover:{base:"ms-spgrid-col-header-part-selected-hover",elementColor:"ms-spgrid-col-header-elem-bg-colors-part-selected-hover",elementHoverColor:"ms-spgrid-col-header-elem-hover-bg-colors-part-selected-hover",elementClickColor:"ms-spgrid-col-elem-colors-click-part-selected-hover"},allSelected:{base:"ms-spgrid-col-header-all-selected"},allSelectedHover:{base:"ms-spgrid-col-header-all-selected-hover",elementColor:"ms-spgrid-col-header-elem-bg-colors-all-selected-hover",elementHoverColor:"ms-spgrid-col-header-elem-hover-bg-colors-all-selected-hover",elementClickColor:"ms-spgrid-col-elem-colors-click-all-selected-hover"}});this._dataSource=new s.SharePointDataSource(new se("Populate",function(){return{}}),new se("Init",function(){return{}}),new se("ComputeDataRange",function(){return{}}),{Populate:function(e,t,n){var r=l.GetCLVPQString().toArray();r.push("ShowInGrid=True");var i=l._jsGridControl.GetSpCsrRenderCtx(),s="?"+r.join("&");i.queryString=s;i.clvp.RefreshPaging(s)},Init:function(e,t,r){t(n);l.SetItemInfoPresent(l._jsGridControl.GetTopRowIndex())},ComputeDataRange:function(e){return l.ComputeSPDataRange(e)}},this._jsGridControl,function(){},this.UpdateDisplayAndEditControls.bind(this));this._dataSource.BeginFullLoad(this.FinishFullLoad.bind(this),function(){},this._gridParams);t.Instances.push(this);for(var D=t.FnGanttCreationCallback,P=0;P<D.length;P++)D[P](this)};t.prototype.GetUnfilteredHierarchyMap=function(){return null};t.prototype.GetCLVPQString=function(){var e=this._jsGridControl.GetSpCsrRenderCtx();r.JsGridUtil.DebugAssert(null!=e);var t=null;null!=this._sortState&&(t="SortField="+this._sortState.sortField+"&SortDir="+(this._sortState.isDescending?"Desc":"Asc"));var n=new r.JsGridUtil.Internal.List_QstringStruct(r.JsGridUtil.Internal.List_ReconcileQstringFilters(r.JsGridUtil.Internal.List_ReconcileQstringFilters(this._pagingInfo,this._filterUrl),t));null!=n.nonFilterParams.SortField&&(n.nonFilterParams.SortField=this.GetCSRFieldKeyFromJsGridFieldKey(n.nonFilterParams.SortField));for(var i in n.filterParams){var s="FilterField",o=n.filterParams[i][s];if(null==o){s="FilterFields";o=n.filterParams[i][s]}r.JsGridUtil.DebugAssert(null!=o);n.filterParams[i][s]=this.GetCSRFieldKeyFromJsGridFieldKey(o)}this._params.viewRootFolder&&(n.nonFilterParams.RootFolder=r.JsGridUtil.Internal.EscapeProperly(this._params.viewRootFolder));return n};t.prototype.TryDispose=function(e){var t=this,n=function(){t.TryDisposeInternal(e)};this._jsGridControl.FinalizeEditing(n,n)};t.prototype.TryDisposeInternal=function(e,t){var n=this,i=function(){n._currentlyShowingDisposeDialog=!1;n.Dispose();e();n._gridParams.portalManager.unmount(n._disposeDialogContainer)},s=this._currentlyWritingChangesToList||this._currentlyCreatingNewListItem||this._currentlyDeletingListItems||this._currentlyRenamingColumn;if(!(t&&!this._currentlyDisposing||this._isDisposed)){if(this._jsGridControl.AnyUncomittedEntryRecords()){this._jsGridControl.JumpToEntryRecord();s=!0}if(!r.JsGridUtil.Internal.IsAssocArrayEmpty(this._changesToSend)){J?this.WriteChangesToListCore():this.BatchedWriteChangesToListCore();s=!0}if(this._jsGridControl.AnyErrors()){this._currentlyShowingDisposeDialog&&this._gridParams.portalManager.unmount(this._disposeDialogContainer);this._currentlyShowingDisposeDialog=!0;this._showDisposeDialog(Strings.STS.L_SPGanttDisposeErrorDialogTitle,Strings.STS.L_SPGanttDisposeErrorDialogBody,Strings.STS.L_SPGanttDisposeErrorDialogFixButton,Strings.STS.L_SPGanttDisposeDialogDiscardButton,function(){n._currentlyShowingDisposeDialog=!1;n._currentlyDisposing=!1;n._gridParams.portalManager.unmount(n._disposeDialogContainer)},i)}else if(s){if(!this._currentlyShowingDisposeDialog){this._currentlyDisposing=!0;this._currentlyShowingDisposeDialog=!0;this._showWarningDialog(Strings.STS.L_SPGanttDisposeSavingDialogTitle,Strings.STS.L_SPGanttDisposeSavingDialogBody,Strings.STS.L_SPGanttDisposeDialogLeaveButton,i)}this._currentlyDisposing&&setTimeout(function(){n.TryDisposeInternal(e,!0)},200)}else{var o=SP.UI.ModalDialog.get_childDialog();if(this._currentlyShowingDisposeDialog){r.JsGridUtil.DebugAssert(null!=o);i()}else{r.JsGridUtil.DebugAssert(null==o);i()}}}};t.prototype.Dispose=function(){this._isDisposed=!0;this._jsGridControl.Dispose();this._api=null};t.prototype._showDisposeDialog=function(e,t,r,i,s,o){this._gridParams.portalManager.render(n.createElement(g.ConfirmationDialog,{title:e,prompt:t,noText:r,yesText:i,onCancel:s,onConfirm:o,maxWidth:"450px"}),this._disposeDialogContainer)};t.prototype._showWarningDialog=function(e,t,r,i){this._gridParams.portalManager.render(n.createElement(y.WaitingDialog,{title:e,prompt:t,maxWidth:"450px"}),this._disposeDialogContainer)};t.prototype._logEngagement=function(e,t){this._gridParams.telemetry&&this._gridParams.telemetry(v.default).logData(m.graft(this._gridParams.baseEngagementData,{name:e,extraData:t}))};t.prototype.FinishFullLoad=function(e,t){var n=this;this._tableViewParams=e.tableViewParams;this._bGrouped=!1;this._gridFieldMap=e.tableViewParams.gridFieldMap;SP.Res?e.name=SP.Res.ganttListName:e.name="";r.JsGridUtil.Internal.IsFeatureEnabled(I)||e.enabledRowHeaderAutoStates.Add(i.JsGridConstants.RowHeaderAutoStyleId.Dirty);this._newRowEnabled=e.tableViewParams.bNewRowEnabled=!this._bGrouped&&this._params.listPermissions&i.JsGridConstants.SPGPermissions.addListItems&&(null==this._params.spCsrRenderCtx||"1"!==this._params.spCsrRenderCtx.ListSchema.IsDocLib);if(null!=e.tableViewParams.ganttParams){e.tableViewParams.ganttParams.fnGetGanttBarDate=this.GetGanttBarDate.bind(this);e.tableViewParams.ganttParams.fnGetGanttBarStyleIds=function(){r.JsGridUtil.DebugAssert(!1,"Oh no!  We've disabled hierarchy")};e.tableViewParams.ganttParams.fnGetPredecessors=this.GetPredecessors.bind(this)}e.styleManager.RegisterCellStyle("CheckmarkStyle",l.StyleUtil.CreateStyle(l.StyleType.Cell,{textAlign:"center"}));var s=e.tableViewParams.columns.GetColumnByKey("Checkmark");null!=s&&(s.fnGetCellStyleId=function(){return"CheckmarkStyle"});null!=e.tableViewParams.ganttParams&&e.styleManager.RegisterCellStyle("Summary",l.StyleUtil.CreateStyle(l.StyleType.Cell,{fontWeight:"bold"}));this._editRowEnabled=e.tableViewParams.bEditingEnabled=this._params.listPermissions&i.JsGridConstants.SPGPermissions.editListItems;this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.GetRecordEditMode,this.GetRecordEditMode.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRightClick,this.OnRightClick.bind(this));var o=e.tableViewParams.columns.GetColumnByKey("Edit");if(null!=o){o.fnShouldLinkSingleValue=function(){return!0};o.fnSingleValueClicked=this.OnEditCellContentsClicked}var u=e.tableViewParams.columns.GetColumnByKey("Title");if(null!=u){u.fnShouldLinkSingleValue=this.ShouldLinkTitleCell;u.fnSingleValueClicked=this.OnTitleCellContentsClicked}this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.AutoFilter,this.OnAutoFilter.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.Sort,this.OnSort.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.MoveColumn,this.MoveColumn.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.NextPage,this.OnNextPage.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.AddNewColumn,this.AddNewColumn.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.GetAutoFilterEntries,this.GetAutoFilterEntries.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.LaunchFilterDialog,this.LaunchFilterDialog.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.CreateEntryRecord,this.CreateEntryRecord.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.TryInsertEntryRecord,this.CreateNewListItem.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.TryCreateProvisionalRecord,this.CreateNewListItem.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.DeleteRecords,this.DeleteSelectedRecords.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.RemoveColumnFromView,this.RemoveColumnFromView.bind(this));this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.GetGridRowStyleId,null);this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.CanReorderRecords,function(){return n._params.canShowReorderUI});this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.OnBeforeRecordReordered,function(){r.JsGridUtil.DebugAssert("Oh no!  We've disabled hierarchy.")});this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.EditColumn,this.EditColumn.bind(this));r.JsGridUtil.Internal.IsFeatureEnabled(F)?this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.AddNewColumnMenuItems,this.PopulateAddNewColumnMenuItemsV2.bind(this)):this._jsGridControl.SetDelegate(i.JsGridConstants.DelegateType.AddNewColumnMenuItems,this.PopulateAddNewColumnMenuItems.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRowEscape,this.OnRowEscape.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRowFocusChanged,this.OnRowFocusChanged.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnPropertyChanged,this.OnPropertyChanged.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRecordInserted,this.OnRecordInsertedOrDeleted.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRecordDeleted,this.OnRecordInsertedOrDeleted.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnRecordsReordered,function(){r.JsGridUtil.DebugAssert("Oh no!  We've disabled hierarchy.")});this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnBeforePropertyChanged,this.OnBeforePropertyChanged.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnBeginRenameColumn,this.OnBeginRenameColumn.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnEndRenameColumn,this.OnEndRenameColumn.bind(this));this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnSingleCellKeyDown,this.OnSingleCellKeyDown.bind(this));if(r.JsGridUtil.Internal.IsFeatureEnabled(U)){this._jsGridControl.AttachEvent(b.SPGridEvents.redoChangeEventName,this.Redo);this._jsGridControl.AttachEvent(b.SPGridEvents.undoChangeEventName,this.Undo);this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnBeginUndoDataUpdateChange,this._onBeginUndoDataUpdateChange);this._jsGridControl.AttachEvent(i.JsGridConstants.EventType.OnBeginRedoDataUpdateChange,this._onBeginRedoDataUpdateChange)}if(null!=this._params.spCsrRenderCtx&&null!=this._params.spCsrRenderCtx.ListData&&this._params.spCsrRenderCtx.ListData.ForceNoHierarchy){this._hierarchyEnabled=!1;e.tableViewParams.rowViewParams.hierarchyMode=i.JsGridConstants.HierarchyMode.None}"rtl"==this._params.listDirection?e.isRTL=!0:"ltr"==this._params.listDirection&&(e.isRTL=!1);this.CustomizeGridStyles(e);this._jsGridControl.Init(e);this._commandMgr=e.commandMgr;for(var a=0;a<this._fnCallbackCompleteFullLoad.length;a++)this._fnCallbackCompleteFullLoad[a](this._gridFieldMap);this._isFullLoadCompleted=!0};t.prototype.CustomizeGridStyles=function(e){var t=e.styleManager;t.groupingStyles=null;t.gridPaneStyle.backgroundColor="transparent";t.defaultCellStyle.textAlign=e.isRTL?"right":"left";t.defaultCellStyle.backgroundColor="transparent";var n=t.columnHeaderStyleCollection;n.normal.innerBorderColor="transparent";n.normal.eyeBrowColor="transparent";n.partSelected.innerBorderColor="transparent";n.partSelected.eyeBrowColor="transparent";n.allSelected.innerBorderColor="transparent";n.allSelected.eyeBrowColor="transparent"};t.prototype.ZoomInGantt=function(){this._jsGridControl.SetGanttZoomLevel(this._jsGridControl.GetGanttZoomLevel()-1)};t.prototype.ZoomOutGantt=function(){this._jsGridControl.SetGanttZoomLevel(this._jsGridControl.GetGanttZoomLevel()+1)};t.prototype.ScrollGanttToFocusedItem=function(){var e=this.GetFocusedRecord();if(null!=e){var t=e.GetDataValue(this._params.startColumnName);null==t&&(t=e.GetDataValue(this._params.finishColumnName));null!=t&&this._jsGridControl.ScrollGanttToDate(t)}};t.prototype.get_SelectedItems=function(){for(var e=this._jsGridControl.GetSelectedRecordKeys(),t=[],n=0;n<e.length;n++){var r=e[n];this._jsGridControl.IsGroupingRecordKey(r)||this._jsGridControl.IsEntryRecordKey(r)||this._jsGridControl.IsProvisionalRecordKey(r)||t.push(e[n])}return t};t.prototype.get_SelectedItemsIncludingProvisionalItems=function(){for(var e=this._jsGridControl.GetSelectedRecordKeys(),t=[],n=0;n<e.length;n++){var r=e[n];this._jsGridControl.IsGroupingRecordKey(r)||this._jsGridControl.IsEntryRecordKey(r)||t.push(e[n])}return t};t.prototype.AddItemsToTimeline=function(e){if(null!=e&&e.length&&e.length>0){for(var t=[],n=0;n<e.length;n++){var r={};r.id=e[n];t.push(r)}this.AddItemsToTimeline(t)}};t.prototype.DeleteSelectedItems=function(){this.DeleteSelectedRecords()};t.prototype.LaunchEditItemFormForItem=function(e){this.ViewOrEditItem(!0,e)};t.prototype.LaunchViewItemFormForItem=function(e){this.ViewOrEditItem(!1,e)};t.prototype.ViewOrEditItem=function(e,t){var n=GetCurrentCtx(),r=e?n.editFormUrl:n.displayFormUrl,i=-1==r.indexOf("?")?"?":"&",s=this._dataSource.tableCache.GetCachedRecord(t).GetDataValue("_ContentTypeId");r=r+i+"ID="+t+(null!=s&&""!==s?"&ContentTypeID="+s:"");r=AddSourceToUrl(r)+GetRootFolder(n);EditItem2(null,r)};t.prototype.GetCSRFieldFromJsGridFieldKey=function(e){for(var t=this._jsGridControl.GetSpCsrRenderCtx().ListSchema.Field,n=0;n<t.length;n++){var i=t[n];if(i.RealFieldName==r.JsGridUtil.Internal.UnescapeProperly(e))return i}};t.prototype.GetCSRFieldKeyFromJsGridFieldKey=function(e){var t=this.GetCSRFieldFromJsGridFieldKey(e);return null==t?e:r.JsGridUtil.Internal.EscapeProperly(t.Name)};t.prototype.GetFocusedRecord=function(){var e,t=this._jsGridControl.GetFocusedItem();null!=t&&(e=this._dataSource.tableCache.GetCachedRecord(t.recordKey));return e};t.prototype.GetRecordKeysToSend=function(){var e=new u.Set;for(var t in this._changesToSend)if(!this._jsGridControl.AnyErrorsInRecord(t)||t in this._rowLevelErrors&&this._rowLevelErrors[t].bCommunicationsError){var n=this._changesToSend[t];for(var r in n)if(n[r].changeKey.GetVersionNumber()in this._changeKeysPendingValidation){e.Add(t);break}}else e.Add(t);return new u.Set(this._changesToSend).Difference(e).GetCollection()};t.prototype.CanDiscardChangesForRow=function(e){return e in this._changesToSend};t.prototype.DiscardChangesForRow=function(e){var t=this;if(e in this._changesToSend){this._showDisposeDialog(Strings.STS.L_SPGanttDiscardChangesDialogTitle,Strings.STS.L_SPGanttDiscardChangesDialogMessage,Strings.STS.L_SPNo,Strings.STS.L_SPYes,function(){t._jsGridControl.Focus();t._gridParams.portalManager.unmount(t._disposeDialogContainer)},function(){t._jsGridControl.Focus();var n=t._changesToSend[e];delete t._changesToSend[e];var r=t.GetMostRecentChangeKey(n),i=[];for(var s in n){var o=n[s];i.push(c.CreateValidatedPropertyUpdate(e,s,o.oldProp.data,o.oldProp.localized))}t._jsGridControl.UpdateProperties(i,null,r);t._gridParams.portalManager.unmount(t._disposeDialogContainer)})}};t.prototype.OnRowEscape=function(e){var t=e.recordKey;this.CanDiscardChangesForRow(t)&&this.DiscardChangesForRow(t)};t.prototype.OnBeforePropertyChanged=function(e){var t=e.recordKey,n=this._jsGridControl.GetRecord(t),i=e.fieldKey;if(null!=n.properties[i]){var s=n.properties[i].propType;if("SPMultilineText"!=s.ID&&"SPEnhancedRichText"!=s.ID&&"TaxonomyField"!=s.ID&&"TaxonomyField_MultiValue"!=s.ID){var o=n.fieldRawDataMap.csrInfo;if(null!=o&&(null==this._changesBeingSent||null==this._changesBeingSent[t])&&!r.JsGridUtil.Internal.IsNoOpChange(e,n)){o.stale=o.stale||{};o.stale[i]=!0}}}};t.prototype.OnPropertyChanged=function(e,t){var n=this;if(!(this._jsGridControl.IsProvisionalRecordKey(e.recordKey)||e.fieldKey in this._params.computedFields)){(function(t){var r=n._selfReferencingLookupPropTypes[e.fieldKey];if(null!=r)for(var i=0;i<r.length;i++)r[i].InvalidateCache()})();if(e.changeKey!=this._cascadingChangeKey){null==this._rowLevelErrors[e.recordKey]||this._rowLevelErrors[e.recordKey].bCommunicationsError||this.ClearRowLevelError(e.recordKey);t||(function(e){var t={},r=n._jsGridControl.GetRecord(e.recordKey).fieldRawDataMap._ContentTypeId;if(null!=r&&r in n._params.contentTypes)for(var s=n._params.contentTypes[r].RequiredFields,o=0;o<s.length;o++){t[s[o]]=1}e.validationState==i.JsGridConstants.ValidationState.Valid&&(e.fieldKey in n._params.requiredFields||e.fieldKey in t)&&(e.newProp.HasLocalizedValue()&&(""==e.newProp.localized||null==e.newProp.localized)||e.newProp.HasDataValue()&&null==e.newProp.data)&&n._jsGridControl.SetCellError(e.recordKey,e.fieldKey,SP.Res.requiredField15)})(e);(function(e){if(e.validationState==i.JsGridConstants.ValidationState.Valid&&"Title"==e.fieldKey&&n._dataSource.tableCache.GetCachedRecord(e.recordKey).GetDataValue("_FolderLink")){var t=c.CreateValidatedPropertyUpdate(e.recordKey,"FileLeafRef",e.newProp.data,e.newProp.localized);n._jsGridControl.UpdateProperties([t],null,e.changeKey)}})(e);(function(e){var t=e.changeKey.GetVersionNumber(),r=[e.recordKey,e.fieldKey,t].join();if(e.validationState==i.JsGridConstants.ValidationState.Pending){n._propChangesPendingValidation.Add(r);t in n._changeKeysPendingValidation||(n._changeKeysPendingValidation[t]=0);n._changeKeysPendingValidation[t]++}else if(n._propChangesPendingValidation.Contains(r)){n._propChangesPendingValidation.Remove(r);n._changeKeysPendingValidation[t]--;0==n._changeKeysPendingValidation[t]&&delete n._changeKeysPendingValidation[t]}})(e);(function(e){if(e.validationState==i.JsGridConstants.ValidationState.Pending||e.validationState==i.JsGridConstants.ValidationState.Valid){null==(t=n._changesToSend[e.recordKey])&&(n._changesToSend[e.recordKey]=t={});null!=t[e.fieldKey]&&t[e.fieldKey].changeKey.Release();t[e.fieldKey]=e;e.changeKey.Reserve()}else{var t;if(null!=(t=n._changesToSend[e.recordKey])&&null!=t[e.fieldKey]){t[e.fieldKey].changeKey.Release();delete t[e.fieldKey]}}})(e);var r=this._jsGridControl.GetFocusedItem();e.validationState==i.JsGridConstants.ValidationState.Valid&&(null!=r&&e.recordKey!=r.recordKey||this._dataSource.tableCache.GetRecordCount()+(this._tableViewParams.bNewRowEnabled?1:0)==1)&&this.WriteChangesToList()}}};t.prototype.OnRecordInsertedOrDeleted=function(){for(var e in this._selfReferencingLookupPropTypes)for(var t=this._selfReferencingLookupPropTypes[e],n=0;n<t.length;n++)t[n].InvalidateCache()};t.prototype.OnRowFocusChanged=function(e){this.WriteChangesToList()};t.prototype.OnSort=function(e){this._pagingInfo=null;this._sortState={sortField:e[0].columnName,isDescending:e[0].isDescending};this.ClearItemInfoPresent();this._dataSource.RefreshRowView(!1,this.RefreshRowView.bind(this))};t.prototype.RefreshRowView=function(e,t){this._jsGridControl.SetRowView(e);RefreshCommandUI&&RefreshCommandUI()};t.prototype.RemoveColumnFromView=function(e){var t=this,n=function(){var e=t._jsGridControl.GetSpCsrRenderCtx();null!=e&&S.SPGridFetchSchema(e.listName,e.view,function(t){e.ListSchema=t});t._gridParams.onColumnChangeSucceeded&&t._gridParams.onColumnChangeSucceeded()};function r(){throw"Failed to delete column "+e}this._ensureExternalJsFilesLoaded(function(){var i=t._jsGridControl._GetPaneManager(),s=i.GetGridPane().GetAllColumns();s.RemoveColumn(e);i.UpdateColumns(s);t._jsGridControl.EnsurePaneWidth();t._jsGridControl.NotifyDataAvailable();t.runQuery(function(i){var s=t.InitContext(n,r,i);s.view.get_viewFields().remove(e);s.view.update();s.context.executeQueryAsync()})})};t.prototype.runQuery=function(e){var t=this;return this._isUsingDataSync&&this._aadUserId&&this._params.listId&&this._params.siteUrl?this._getDataSyncClientImport.then(function(n){var r=n(t._aadUserId);return r?r.getData({siteUrl:t._params.siteUrl,listId:t._params.listId,siteId:t._params.siteId,operation:D.DataSyncOperationType.ListQuickEdit},function(t){e(t);return Promise.resolve(void 0)},function(){e();return Promise.resolve(void 0)}):e()}):e()};t.prototype.OnBeginRenameColumn=function(){this._currentlyRenamingColumn=!0};t.prototype.OnSingleCellKeyDown=function(e){if("Checkmark"==e.fieldKey&&window.CheckMarkFieldTemplate&&e&&e.eventInfo&&32==e.eventInfo.keyCode){var t=document.getElementById(window.CheckMarkFieldTemplate.GetCheckMarkId(this._jsGridControl.GetSpCsrRenderCtx(),e.recordKey));t&&t.OnClickCheckmark()}};t.prototype.OnEndRenameColumn=function(e){var t,n=this;K||(t=new(this._telemetry(x.Qos))({name:re.renameColumn}));var r=function(){n._currentlyRenamingColumn=!1;var e=n._jsGridControl.GetSpCsrRenderCtx();null!=e&&S.SPGridFetchSchema(e.listName,e.view,function(t){e.ListSchema=t});K||t.end({resultType:x.ResultTypeEnum.Success})},i=function(){n._currentlyRenamingColumn=!1;if(K)throw"Failed to rename column "+s+" with name "+o;var e="Failed to rename column "+s+" with name "+o;t.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToRenameColumn",error:e});throw e},s=e.columnKey,o=e.newColumnTitle,u=e.originalColumnTitle;o!=u?this._ensureExternalJsFilesLoaded(function(){n.runQuery(function(e){var t=n.InitContext(r,i,e),u=t.list.get_fields().getByInternalNameOrTitle(s);u.set_title(o);u.update();t.context.executeQueryAsync()})}):this._currentlyRenamingColumn=!1};t.prototype.MoveColumn=function(e){var t,n=this;G||this._jsGridControl.StopEditing();K||(t=new(this._telemetry(x.Qos))({name:re.moveColumn}));var r=e.columnInfo,i=e.dragDropDetails,s=e.onColumnChangeSucceeded,o=i.draggedIndex,u=i.targetIndex,a=r.columnKey,f=function(){var e=n._jsGridControl.GetSpCsrRenderCtx();null!=e&&S.SPGridFetchSchema(e.listName,e.view,function(t){e.ListSchema=t});s&&s();K||t.end({resultType:x.ResultTypeEnum.Success})},l=function(){if(K)throw"Failed to move column "+a+" to position "+u;var e="Failed to move column "+a+" to position "+u;t.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToMoveColumn",error:e});throw MessageChannel};this._ensureExternalJsFilesLoaded(function(){var e=n._jsGridControl._GetPaneManager(),t=e.GetGridPane().GetAllColumns();t.RemoveColumn(a);t.InsertColumnAt(u,r);e.UpdateColumns(t);n._jsGridControl.EnsurePaneWidth();n._jsGridControl.NotifyDataAvailable();n.runQuery(function(e){var t=n.InitContext(f,l,e),r=t.view;r.get_viewFields().moveFieldTo("Title"===a?"LinkTitle":a,u>o?u+1:u);r.update();t.context.executeQueryAsync()})})};t.prototype.AddNewColumn=function(e,t,n,s){var u,a,f=this;K||(a=new(this._telemetry(x.Qos))({name:re.addColumn}));var l=function(){var e,n=function(){var t=f._jsGridControl.GetSpCsrRenderCtx();if(null!=t){S.SPGridFetchSchema(t.listName,t.view,function(n){for(var i=n.Field.length,s=0;s<i&&(u=n.Field[s]).RealFieldName!=r;s++);e.csrInfo=u;t.ListSchema=n});s&&s()}},r=u.get_internalName(),i=o.PropertyType.Internal.Property.GetInstance().GetPropType(t.propType);if("SPDateTime"==i.ID){e=new h.GridField(r,t.hasData,t.hasLocalized,null,null,null,!1,null);f._params.parseAndSetFields[r]=1}else e=new h.GridField(r,t.hasData,t.hasLocalized);"SPUser"==i.ID&&i.SetPeoplePickerDefaultSettings(r);e.SetSingleValuePropType(i);f._dataSource.AddColumn(e);var l=new h.ColumnInfo(v,null,r,100);f._jsGridControl.AddColumn(l,e);f._jsGridControl.ShowColumn(r);f._jsGridControl.EnsurePaneWidth();f._jsGridControl.NotifyDataAvailable();f._jsGridControl.RenameColumn(r);null!=m?f.runQuery(function(e){var t=f.InitContext(n,c,e),i=t.view;i.get_viewFields().add(r);i.update();t.context.executeQueryAsync()}):n();K||a.end({resultType:x.ResultTypeEnum.Success})},c=function(){if(K)throw"Failed to add new column "+v+" to view";var e="Failed to add new column "+v+" to view";a.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToAddColumn",error:e});throw e},p=function(e){if(e==i.JsGridConstants.DialogResult.OK){var t=f._jsGridControl.GetSpCsrRenderCtx();S.SPGridFetchSchema(t.listName,t.view,function(e){for(var t=f._jsGridControl.GetSpCsrRenderCtx(),n=e.Field.length,r=0;r<n;r++){for(var s=e.Field[r],u=!1,a=0;a<t.ListSchema.Field.length;a++)s.RealFieldName===t.ListSchema.Field[a].RealFieldName&&(u=!0);if(!u){var l,c=s.RealFieldName,p=o.PropertyType.Internal.Property.GetInstance().GetPropType(i.JsGridConstants.FieldTypeToJsGridType[s.Type]);if("SPDateTime"==p.ID){l=new h.GridField(c,!0,!0,null,null,null,!1,null);f._params.parseAndSetFields[c]=1}else l=new h.GridField(c,!0,!0);"SPUser"==p.ID&&p.SetPeoplePickerDefaultSettings(c);"1"==s.AllowMultipleValues?l.SetIsMultiValue(";"):l.SetSingleValuePropType(p);l.csrInfo=s;f._dataSource.AddColumn(l);var d=new h.ColumnInfo(v,null,c,100);d.name=s.Name;f._jsGridControl.AddColumn(d,l);f._jsGridControl.ShowColumn(c);f._jsGridControl.EnsurePaneWidth();f._jsGridControl.NotifyDataAvailable()}}t.ListSchema=e})}},d=function(e,t){var n=[];n.push(r.JsGridUtil.Internal.SiteUrl+"/_layouts/15/"+e);n.push("?List=");n.push(f._params.listId);n.push("&AddToView=");n.push(f._params.viewId);n.push("&FieldTypeParam=");n.push(t);n.push("&IsDlg=");n.push(1);return n.join("")},v=null!=n&&n.length>0?n:e,m=null,g=String.fromCharCode(97+Math.floor(26*Math.random()))+Math.random().toString(36).substring(2,5);this._ensureExternalJsFilesLoaded(function(){switch(e){case"Text":case"Note":case"Number":case"Currency":case"DateTime":case"Boolean":case"URL":case"User":case"Location":f.runQuery(function(t){var n=f.InitContext(l,c,t),s="<Field Name='"+g+"' DisplayName='"+r.JsGridUtil.Internal.Encoding_STSHtmlEncode(v)+"' Type='"+e+"'";"User"==e&&(s+=" List='UserInfo'");s+=" />";u=n.list.get_fields().addFieldAsXml(s,!1,i.JsGridConstants.AddFieldOptions.defaultValue|i.JsGridConstants.AddFieldOptions.addFieldInternalNameHint);m=n.view;u.update();n.context.load(u);n.context.load(m);n.context.executeQueryAsync()});return;case"Choice":case"Lookup":case"Calculated":case"BusinessData":case"MoreColumnTypes":var t="Choice"==e||"Calculated"==e?"FldNew.aspx":"FldNewEx.aspx",n={title:SP.JsGrid.Res.addColumnName,dialogReturnValueCallback:p,url:d(t,e)};SP.UI.ModalDialog.showModalDialog(n);return}})};t.prototype.onClickMoreColumnOptions=function(){this._navigation||(this._navigation=new k.Navigation);var e=r.JsGridUtil.Internal.SiteUrl+"/_layouts/15/fldNew.aspx?List="+L.default.encodeURIComponent(A.default.normalizeUpper(this._params.listId,!0))+"&Source="+L.default.encodeURIComponent(window.location.href)+"&AddToView="+L.default.encodeURIComponent(this._params.viewId);this._navigation.navigateTo({url:e})};t.prototype.onLaunchColumnManagementPanelAction=function(e,t,n){this.onLaunchColumnManagementPanelActionInternal(e,!1,t,n)};t.prototype.onLaunchColumnManagementPanelActionWithLink=function(e,t,n){this.onLaunchColumnManagementPanelActionInternal(e,!0,t,n)};t.prototype.onLaunchColumnManagementPanelActionInternal=function(e,t,n,i){r.JsGridUtil.Internal.IsFeatureEnabled(X)&&(this._currentAddColumnInternalName=i);n({createField:{fieldType:e,fieldToInsertAfter:i},isHyperlink:t},this.addColumnOnCompleteCallback)};t.prototype.editColumnInternal=function(e,t,n){for(var r,i,s,o,f,l,c,h,p,d,v=this,m=this._jsGridControl._GetPaneManager(),g=m.GetGridPane().GetAllColumns(),y=function(y){if(t.ListSchema.Field[y].RealFieldName!==b._currentEditColumnInternalName)return"continue";var w=t.ListSchema.Field[y];r=g.RemoveColumn(w.RealFieldName);if("Location"!==n.FieldType){var E;i=function(){var i,s=E.get_schemaXml();if(s){var o=(new DOMParser).parseFromString(s,"text/xml");i=v.createNewColumn(n,o)}else i=v.createNewColumn(n);v._dataSource.AddColumn(i);var u=v.createColumnInfo(n);if(!Y&&n.customFormatter){u.customFormatter=n.customFormatter;u.fnGetDisplayControlName=function(){return a.DisplayControlType.CustomFormatter}}g.InsertColumnAt(r,u);m.UpdateColumns(g);v._jsGridControl.EnsurePaneWidth();v._jsGridControl.NotifyDataAvailable();t.ListSchema=e};b.runQuery(function(e){var t=v.InitContext(i,{},e),r=t.list.get_fields();E=r.getByInternalNameOrTitle(n.Name);t.context.load(E);t.context.executeQueryAsync()});return"break"}var S=b.createColumnInfo(n);if(!Y&&n.customFormatter){S.customFormatter=n.customFormatter;S.fnGetDisplayControlName=function(){return a.DisplayControlType.CustomFormatter}}g.InsertColumnAt(r,S);s=new u.Set;o=new u.Set;for(var x=n.ID,T=0;T<t.ListSchema.Field.length;T++)(f=t.ListSchema.Field[T].StaticName)&&f.indexOf(x)>=0&&s.Add(f);for(T=0;T<e.Field.length;T++)(f=e.Field[T].StaticName)&&f.indexOf(x)>=0&&o.Add(f);l=s.Difference(o);for(var N=0;N<t.ListSchema.Field.length;N++){c=t.ListSchema.Field[N];l.Contains(c.StaticName)&&g.RemoveColumn(c.RealFieldName)}h=o.Difference(s);for(var C=0;C<e.Field.length;C++){p=e.Field[C];if(h.Contains(p.StaticName)){d=b.createNewColumn(p);b._dataSource.AddColumn(d);var k=b.createColumnInfo(p);b._jsGridControl.AddColumn(k,d);b._jsGridControl.ShowColumn(p.RealFieldName)}}m.UpdateColumns(g);b._jsGridControl.EnsurePaneWidth();b._jsGridControl.NotifyDataAvailable();t.ListSchema=e;return{value:void 0}},b=this,w=0;w<t.ListSchema.Field.length;w++){var E=y(w);if("object"==typeof E)return E.value;if("break"===E)break}};t.prototype.deleteColumnInternal=function(e){for(var t=0;t<e.ListSchema.Field.length;t++)if(e.ListSchema.Field[t].RealFieldName===this._currentEditColumnInternalName){var n=this._jsGridControl._GetPaneManager(),r=n.GetGridPane().GetAllColumns(),i=e.ListSchema.Field[t],s=i.ID;r.RemoveColumn(i.RealFieldName);if("Location"===i.FieldType)for(var o=0;o<e.ListSchema.Field.length;o++){var u=e.ListSchema.Field[o].StaticName;u&&u.indexOf(s)>=0&&r.RemoveColumn(e.ListSchema.Field[o].RealFieldName)}n.UpdateColumns(r);this._jsGridControl.EnsurePaneWidth();this._jsGridControl.NotifyDataAvailable();break}};t.prototype.createNewColumn=function(e,t){var n=e.Name,r=i.JsGridConstants.FieldTypeToJsGridType[e.Type];if("Lookup"===r){var s=!0,u=[];if(t){s="false"===t.firstElementChild.getAttribute("FillInChoice").toLowerCase();var f=[];t.firstElementChild.children&&t.firstElementChild.children[0]&&t.firstElementChild.children[0].children&&(f=t.firstElementChild.children[0].children);if(f&&f.length>0)for(var l=0;l<f.length;l++)u.push({value:f[l].textContent,localString:f[l].textContent});else if(e.Choices)for(l=0;l<e.Choices.length;l++)u.push({value:e.Choices[l],localString:e.Choices[l]});"MultiChoice"===e.Type&&(e.AllowMultipleValues="1")}else if(e.Choices)for(l=0;l<e.Choices.length;l++)u.push({value:e.Choices[l],localString:e.Choices[l]});var c=n;"Choice"!==e.FieldType&&"MultiChoice"!==e.FieldType||(c=n+"_Choice");o.PropertyType.RegisterNewLookupPropType(c,u,a.DisplayControlType.CSR,s);r=c}var p,d=o.PropertyType.Internal.Property.GetInstance().GetPropType(r);if(d&&"SPDateTime"==d.ID){p=new h.GridField(n,!0,!0,null,null,null,!1,null);this._params.parseAndSetFields[n]=1}else p=new h.GridField(n,!0,!0);d&&"SPUser"==d.ID&&d.SetPeoplePickerDefaultSettings(n);if("1"==e.AllowMultipleValues){p.SetSingleValuePropType(d);p.SetIsMultiValue(";")}else p.SetSingleValuePropType(d);p.csrInfo=e;return p};t.prototype.createColumnInfo=function(e){var t=new h.ColumnInfo(e.DisplayName,null,e.RealFieldName,100),n=!("FALSE"===e.Filterable||"TRUE"===e.FilterDisable||"Note"===e.FieldType||"URL"===e.FieldType||"FileSizeDisplay"===e.Name||"_IsRecord"===e.Name),r=e.Name,i="TRUE"!==e.FromBaseType,s=e.FieldType,o="Calculated"===e.role;t.isFilterable=n;t.internalName=r;t.isEditable=i;t.fieldType=s;t.isCalculated=o;return t};t.prototype.PopulateAddNewColumnMenuItems=function(e,t){var n=this,r={propType:"SPUser",hasData:!0,hasLocalized:!0},i={propType:"String",hasData:!1,hasLocalized:!0},s={propType:"SPDateTime",hasData:!1,hasLocalized:!0},o={propType:"Location",hasData:!0,hasLocalized:!0},u={Text:{Desc:Strings.STS.L_AddColumnDefaultName_Text,FnOnClick:function(){n.AddNewColumn("Text",i,Strings.STS.L_AddColumnDefaultName_Text,t)}},Number:{Desc:Strings.STS.L_AddColumnDefaultName_Number,FnOnClick:function(){n.AddNewColumn("Number",i,Strings.STS.L_AddColumnDefaultName_Number,t)}},DateTime:{Desc:Strings.STS.L_AddColumnDefaultName_DateAndTime,FnOnClick:function(){n.AddNewColumn("DateTime",s,Strings.STS.L_AddColumnDefaultName_DateAndTime,t)}},User:{Desc:Strings.STS.L_AddColumnDefaultName_PersonOrGroup,FnOnClick:function(){n.AddNewColumn("User",r,Strings.STS.L_AddColumnDefaultName_PersonOrGroup,t)}},Location:{Desc:C.default.L_AddColumnDefaultName_Location,FnOnClick:function(){n.AddNewColumn("Location",o,C.default.L_AddColumnDefaultName_Location,t)}},MoreColumnTypes:{Desc:Strings.STS.L_AddColumnDefaultName_MoreColumnTypes,FnOnClick:function(){n.AddNewColumn("MoreColumnTypes",null,null,t)}}};for(var a in u){var f=u[a];e.InsertMenuItem({key:f.Desc,text:f.Desc,onClick:f.FnOnClick})}};t.prototype.PopulateAddNewColumnMenuItemsV2=function(e,t,n,i,s){var o=this,u={Text:{Desc:C.default.L_AddColumnDefaultName_Text,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Text,n,i)}},Note:{Desc:C.default.L_AddColumnDefaultName_Note,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Note,n,i)}},Location:{Desc:C.default.L_AddColumnDefaultName_Location,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Location,n,i)}},Number:{Desc:C.default.L_AddColumnDefaultName_Number,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Number,n,i)}},Boolean:{Desc:C.default.L_AddColumnDefaultName_Boolean,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Boolean,n,i)}},User:{Desc:C.default.L_AddColumnDefaultName_PersonOrGroup,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.User,n,i)}},DateTime:{Desc:C.default.L_AddColumnDefaultName_DateAndTime,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.DateTime,n,i)}},Choice:{Desc:C.default.L_AddColumnDefaultName_Choice,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Choice,n,i)}},URL:{Desc:C.default.L_AddColumnDefaultName_URL,FnOnClick:function(){o.onLaunchColumnManagementPanelActionWithLink(O.default.URL,n,i)}},Picture:{Desc:C.default.L_AddColumnDefaultName_Picture,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.URL,n,i)}},Currency:{Desc:C.default.L_AddColumnDefaultName_Currency,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Currency,n,i)}},Thumbnail:{Desc:C.default.L_AddColumnDefaultName_Thumbnail,FnOnClick:function(){o.onLaunchColumnManagementPanelAction(O.default.Thumbnail,n,i)}},MoreColumnTypes:{Desc:C.default.L_AddColumnDefaultName_MoreColumnTypes,FnOnClick:function(){o.onClickMoreColumnOptions()}}},a=[];if(r.JsGridUtil.Internal.IsFeatureEnabled(V))for(var f=0,l=["Text","Choice","DateTime","Note","User","Number","Boolean","URL","Currency","Location","Thumbnail","Picture","MoreColumnTypes"];f<l.length;f++){(h=u[c=l[f]])&&(a=ae(c,h,e,s))}else for(var c in u){var h;a=ae(c,h=u[c],e,s)}return a};t.prototype.EditColumn=function(e,t,n,i,s){var o=this;if(r.JsGridUtil.Internal.IsFeatureEnabled(F)){this._currentEditColumnInternalName=i;var u={key:"ColumnManagement",text:C.default.L_EditColumn,onClick:function(){o._ensureExternalJsFilesLoaded(function(){t({editField:{fieldName:i,fieldType:O.default[n]},isHyperlink:"Hyperlink"===n.toString()},o.editColumnOnCompleteCallback)})}};s||e.InsertMenuItem(u);return u}};t.prototype.OnNextPage=function(e){var t=this._jsGridControl.GetTopRowIndex(),n=this._jsGridControl.GetVisibleRecordCount(),r=t+n-1;if(r!=this._params.totalItemCount){var i=r+n;this._jsGridControl.ScrollCellIntoView(Math.min(i,this._params.totalItemCount))}};t.prototype.ResolveAutoFilterState=function(e){var t=1;for(var n in e){var i="FilterField",s="FilterValue";if(-1!==e[n].indexOf(";#")){i="FilterFields";s="FilterValues"}null==this._filterUrl&&(this._filterUrl="");this._filterUrl+="&"+i+t+"="+r.JsGridUtil.Internal.EscapeProperly(n)+"&"+s+t+"="+r.JsGridUtil.Internal.EscapeProperly(e[n]);t++}};t.prototype.OnAutoFilter=function(e){this._filterUrl=null;this._pagingInfo=null;this.ResolveAutoFilterState(e);this.ClearItemInfoPresent();this._dataSource.RefreshRowView(!1,this.RefreshRowView.bind(this))};t.prototype.GetAutoFilterEntries=function(e,t,n,i,s){var o,u=document.getElementById(this._params.iframeId),a="",f=0,l=this._params.filterLink;l||(l=null!=this._params.spCsrRenderCtx?this._params.spCsrRenderCtx.queryString:window.location.href);do{f++;null!=(o=l.match("FilterField"+f+"=[^&]*&FilterValue"+f+"=[^&]*"))&&(a=a+"&"+o)}while(o);var c=l.match("MembershipGroupId=[^&]*");null!=c&&(a+="&"+c);var h=l.match("RootFolder=[^&]*");null!=h&&(a+="&"+h);var p=l.match("InstanceID=[^&]*");null!=p&&(a+="&"+p);this._autoFilterContext={FieldName:t,OnSuccess:i,OnFailure:s};u.src=this._params.siteUrl+"/_layouts/15/filter.aspx?ListId="+this._params.listId+"&FieldInternalName="+r.JsGridUtil.Internal.EscapeProperly(t)+"&ViewId="+this._params.viewId+"&FilterOnly=1&Filter=1"+a+"&CallbackFn=OnJsGridIframeLoad&CallbackParam="+this._jsGridControl.parentNode.id};t.prototype.OnAutoFilterReturn=function(){var e;if(null!=(e=document.getElementById(this._params.iframeId))){var t=null;e.contentDocument?t=e.contentDocument:e.contentWindow&&e.contentWindow.document?t=e.contentWindow.document:e.document&&(t=e.document);if(null!=t){var n=t.getElementById("diidFilter"+this._autoFilterContext.FieldName);if(null!=n){var r=n.childNodes.length;if(r<=500){for(var i=n.childNodes,s=void 0,o=[],u=1;u<r;u++){s=i[u].innerText?i[u].innerText:i[u].textContent?i[u].textContent:i[u].innerHTML;o.push({displayString:s,dataValue:i[u].value})}var a={};a[this._autoFilterContext.FieldName]=o;this._autoFilterContext.OnSuccess(a);this._autoFilterContext=null;return}}}}this._autoFilterContext.OnFailure();this._autoFilterContext=null};t.prototype.LaunchFilterDialog=function(e){alert("launch filter dialog here")};t.prototype.WriteChangesToList=function(){this.FixScrollAfterPaste();null!=this._serverWriteTimeout&&clearTimeout(this._serverWriteTimeout);this._serverWriteTimeout=J?setTimeout(this.WriteChangesToListCore.bind(this),500):setTimeout(this.BatchedWriteChangesToListCore.bind(this),500)};t.prototype.RetrieveCSRData=function(e,t){var n=null,r=this._jsGridControl.GetSpCsrRenderCtx();if(null!=r){for(var i=['<FieldRef Name="ID"/>'],s=r.ListSchema.Field,o=0;o<s.length;o++)i.push('<FieldRef Name="'+s[o].Name+'"/>');var u=[],a=0,f=0;for(var l in e){a++;u.push(["<Eq>",'<FieldRef Name="ID" />','<Value Type="Number">',l,"</Value>","</Eq>"].join(""));if(a>1){u.push("</Or>");f++}}for(var c=[];f>0;){c.push("<Or>");f--}u=c.concat(u).join("");var h=['<View Scope="RecursiveAll">',"<ViewFields>"].concat(i).concat(["</ViewFields>","<Query>","<OrderBy>",'<FieldRef Name="ID"/>',"</OrderBy>","<Where>"]).concat(u).concat(["</Where>","</Query>","</View>"]).join("");n=t.renderListData(h)}return n};t.prototype.HandleCSRData=function(e,t,n){for(var i=e.get_value(),s=JSON.parse(i),o=null,u=0;u<s.Row.length;u++)if(s.Row[u].ID==n){o=s.Row[u];break}r.JsGridUtil.DebugAssert(null!=o,"Should be able to find the row we're querying for");this._jsGridControl.GetRecord(t).fieldRawDataMap.csrInfo=o;var a=this._jsGridControl.GetSpCsrRenderCtx();a.ListData=S.MergeListData(a.ListData,s)};t.prototype.PostCSRRender=function(){this._jsGridControl.GetSpCsrRenderCtx()};t.prototype.GetMostRecentChangeKey=function(e){var t=null;for(var n in e){var r=e[n].changeKey;t=null==t||r.GetVersionNumber()>t.GetVersionNumber()?r:t}return t};t.prototype.SetErrorFromCSOMException=function(e,t,n,s,o){var u=null;switch(t){case i.JsGridConstants.ClientErrorCodes.InvalidFieldValue:this._jsGridControl.SetCellError(e,n.split(",")[1],s);break;case i.JsGridConstants.ClientErrorCodes.DocAlreadyExists:this._jsGridControl.SetCellError(e,"Title",SP.Res.docAlreadyExists);break;case i.JsGridConstants.ClientErrorCodes.FieldValueFailedValidation:var a=o.get_fieldFailures();r.JsGridUtil.DebugAssert(a.length>0);for(var f=0;f<a.length;f++)this._jsGridControl.SetCellError(e,a[f].get_name(),a[f].get_message());break;case i.JsGridConstants.ClientErrorCodes.ItemValueFailedValidation:var l=o.get_itemFailure(),c=l?l.get_message():s;u=this.SetRowLevelError(e,c,!1);break;default:u=this.SetRowLevelError(e,s,!1)}return u};t.prototype.WriteChangesToListCore=function(){var e=this,t=function(){for(var t in o){var n=f[t].scope;if(n.get_hasException()){e.SetErrorFromCSOMException(t,n.get_serverErrorCode(),n.get_serverErrorValue(),n.get_errorMessage(),n.get_serverErrorDetails());for(var a in e._changesBeingSent[t])e._fnCallbacksByChangeKey.CallFunctions(e._changesBeingSent[t][a].changeKey.GetVersionNumber(),!1)}else{var l=f[t].item,h=l.get_fieldValuesAsText().get_fieldValues();null!=e._jsGridControl.GetSpCsrRenderCtx()&&e.HandleCSRData(u,t,l.get_id());var p=e._changesBeingSent[t],d=e.GetMostRecentChangeKey(p),v={};for(var a in e._gridFieldMap)if(a in h){var m=p[a]&&p[a].changeKey,g=e._gridFieldMap[a].csrInfo?e._gridFieldMap[a].csrInfo.StaticName:"",y=!1;for(var b in p)if(0===g.indexOf(e._gridFieldMap[b].csrInfo.ID)){y=!0;break}var w=null!=m;if(w||y||a in e._params.computedFields){var E=e.SPListValueToGridValue(l.get_item(a),l.get_fieldValuesAsText().get_item(a),e._gridFieldMap[a].GetPropType(),a),S=c.CreateValidatedPropertyUpdate(t,a,E&&E.data,E&&E.localized);e._cascadingChangeKey=w?m:d;e._jsGridControl.UpdateProperties([S],null,e._cascadingChangeKey);if(w){e._cascadingChangeKey.Release();var x=void 0;if("SPDateTime"==e._gridFieldMap[a].GetPropType().ID){x=null==l.get_item(a)?h[a]:SP.DateTimeUtil.IntlDate.createFromJsUtcDate(E.data,r.JsGridUtil.SpRegionalSettings.calendarType).toJsDate()._toFormattedString("s",JSON.parse(i.JsGridConstants.SUPERTEMPORARY_invariantCultureStringify))}else x=h[a];v[a]={localizedValue:x}}e._cascadingChangeKey=null}}for(var a in p)e._fnCallbacksByChangeKey.CallFunctions(p[a].changeKey.GetVersionNumber(),!0,l.get_id());e._jsGridControl.GetRecord(t);for(var T=0;T<e._fnRowChanged.length;T++)e._fnRowChanged[T](t,v,!1);delete e._changesBeingSent[t];e.ClearRowLevelError(t)}}s(o);e.PostCSRRender()},n=function(t,n){for(var r in o)e.SetRowLevelError(r,SP.Res.serverCommError,!0);for(var r in e._changesBeingSent)for(var i in e._changesBeingSent[r])e._fnCallbacksByChangeKey.CallFunctions(a[i].changeKey.GetVersionNumber(),!1);s(o)},s=function(t){e._currentlyWritingChangesToList=!1;e._queuedWriteChangesRequest&&setTimeout(e.WriteChangesToList.bind(e),0);for(var n in t)e._jsGridControl.RemoveRowHeaderState(n,i.JsGridConstants.RowHeaderStyleId.Transfer);if(r.JsGridUtil.Internal.IsAssocArrayEmpty(e._changesToSend))e._changesToSend=e._changesBeingSent;else for(var n in e._changesBeingSent)if(null==e._changesToSend[n])e._changesToSend[n]=e._changesBeingSent[n];else for(var s in e._changesBeingSent[n]){null!=e._changesToSend[n][s]&&e._changesToSend[n][s].changeKey.Release();e._changesToSend[n][s]=e._changesBeingSent[n][s]}e._changesBeingSent=null},o=this.GetRecordKeysToSend();if(!r.JsGridUtil.Internal.IsAssocArrayEmpty(o)&&(function(t){if(e._currentlyWritingChangesToList){e._queuedWriteChangesRequest=!0;return!1}e._currentlyWritingChangesToList=!0;e._queuedWriteChangesRequest=!1;for(var n in t){e._jsGridControl.RemoveRowHeaderState(n,i.JsGridConstants.RowHeaderAutoStyleId.Dirty);e._jsGridControl.AddBuiltInRowHeaderState(n,i.JsGridConstants.RowHeaderStyleId.Transfer)}e._changesBeingSent=e._changesToSend;e._changesToSend={};return!0})(o)){var u,a,f={};this._ensureExternalJsFilesLoaded(function(){e.runQuery(function(r){var i=e.InitContext(t,n,r);for(var s in o){var l=new SP.ExceptionHandlingScope(i.context),c=l.startScope(),h=i.list.getItemById(s);a=e._changesBeingSent[s];for(var p in a){var d=a[p],v=e.GridValueToSPListValue(d.newProp,d.propType);if(p in e._params.parseAndSetFields){h.parseAndSetFieldValue(p,v);null!=e._params.spCsrRenderCtx&&106===e._params.spCsrRenderCtx.ListTemplateType&&("EndDate"===p&&!a.EventDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EventDate?h.parseAndSetFieldValue("EventDate",e._params.spCsrRenderCtx.CurrentItem.EventDate):"EventDate"===p&&!a.EndDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EndDate&&h.parseAndSetFieldValue("EndDate",e._params.spCsrRenderCtx.CurrentItem.EndDate))}else if(null==d.propType||"TaxonomyField"!=d.propType.ID&&"TaxonomyField_MultiValue"!=d.propType.ID)h.set_item(p,v);else{i.list.get_fields().getByInternalNameOrTitle(p).validateSetValue(h,v)}}h.update();h.get_fieldValuesAsText().retrieve();h.retrieve();c.dispose();f[s]={item:h,scope:l}}u=e.RetrieveCSRData(o,i.list);i.context.executeQueryAsync()});var r=Object.keys(o);p.EventGroup.raise(document,b.SPGridEvents.quickEditWriteChangesToListEventName,{itemIds:r});e._logEngagement("QuickEdit.WriteChangesToListCore",{itemIds:r})})}};t.prototype.BatchedWriteChangesToListCore=function(){var e=this,t=this.GetRecordKeysToSend();if(!r.JsGridUtil.Internal.IsAssocArrayEmpty(t)&&(function(t){if(e._currentlyWritingChangesToList){e._queuedWriteChangesRequest=!0;return!1}e._currentlyWritingChangesToList=!0;e._queuedWriteChangesRequest=!1;for(var n in t){e._jsGridControl.RemoveRowHeaderState(n,i.JsGridConstants.RowHeaderAutoStyleId.Dirty);e._jsGridControl.AddBuiltInRowHeaderState(n,i.JsGridConstants.RowHeaderStyleId.Transfer)}e._changesBeingSent=e._changesToSend;e._changesToSend={};return!0})(t)){var n=Object.keys(t),s=0;this._ensureExternalJsFilesLoaded(function(){for(var o=function(o){var u;K||(u=new(e._telemetry(x.Qos))({name:re.writeChange}));for(var a={},f=0;f<50&&o+f<n.length;f++){var l=n[o+f];a[l]=t[l]}var h,d,v=function(){s+=Object.keys(a).length;for(var o in a){var f=y[o].scope;if(f.get_hasException()){e.SetErrorFromCSOMException(o,f.get_serverErrorCode(),f.get_serverErrorValue(),f.get_errorMessage(),f.get_serverErrorDetails());for(var l in e._changesBeingSent[o])e._fnCallbacksByChangeKey.CallFunctions(e._changesBeingSent[o][l].changeKey.GetVersionNumber(),!1)}else{var p=y[o].item,d=p.get_fieldValuesAsText().get_fieldValues();null!=e._jsGridControl.GetSpCsrRenderCtx()&&e.HandleCSRData(h,o,p.get_id());var v=e._changesBeingSent[o],m=e.GetMostRecentChangeKey(v),b={};for(var l in e._gridFieldMap)if(l in d){var w=v[l]&&v[l].changeKey,E=e._gridFieldMap[l].csrInfo?e._gridFieldMap[l].csrInfo.StaticName:"",S=!1;for(var T in v)if(0===E.indexOf(e._gridFieldMap[T].csrInfo.ID)){S=!0;break}var N=null!=w;if(N||S||l in e._params.computedFields){var C=e.SPListValueToGridValue(p.get_item(l),p.get_fieldValuesAsText().get_item(l),e._gridFieldMap[l].GetPropType(),l),k=c.CreateValidatedPropertyUpdate(o,l,C&&C.data,C&&C.localized);e._cascadingChangeKey=N?w:m;e._jsGridControl.UpdateProperties([k],null,e._cascadingChangeKey);if(N){e._cascadingChangeKey.Release();var L=void 0;if("SPDateTime"==e._gridFieldMap[l].GetPropType().ID){L=null==p.get_item(l)?d[l]:SP.DateTimeUtil.IntlDate.createFromJsUtcDate(C.data,r.JsGridUtil.SpRegionalSettings.calendarType).toJsDate()._toFormattedString("s",JSON.parse(i.JsGridConstants.SUPERTEMPORARY_invariantCultureStringify))}else L=d[l];b[l]={localizedValue:L}}e._cascadingChangeKey=null}}for(var l in v)e._fnCallbacksByChangeKey.CallFunctions(v[l].changeKey.GetVersionNumber(),!0,p.get_id());e._jsGridControl.GetRecord(o);for(var A=0;A<e._fnRowChanged.length;A++)e._fnRowChanged[A](o,b,!1);delete e._changesBeingSent[o];e.ClearRowLevelError(o)}}s>=n.length&&g(t);e.PostCSRRender();K||u.end({resultType:x.ResultTypeEnum.Success})},m=function(r,i){s+=Object.keys(a).length;for(var o in a)e.SetRowLevelError(o,SP.Res.serverCommError,!0);if(s>=n.length){for(var o in e._changesBeingSent)for(var f in e._changesBeingSent[o])e._fnCallbacksByChangeKey.CallFunctions(d[f].changeKey.GetVersionNumber(),!1);g(t)}K||u.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToWriteChange",error:SP.Res.serverCommError})},g=function(t){e._currentlyWritingChangesToList=!1;e._queuedWriteChangesRequest&&setTimeout(e.WriteChangesToList.bind(e),0);for(var n in t)e._jsGridControl.RemoveRowHeaderState(n,i.JsGridConstants.RowHeaderStyleId.Transfer);if(r.JsGridUtil.Internal.IsAssocArrayEmpty(e._changesToSend))e._changesToSend=e._changesBeingSent;else for(var n in e._changesBeingSent)if(null==e._changesToSend[n])e._changesToSend[n]=e._changesBeingSent[n];else for(var s in e._changesBeingSent[n]){null!=e._changesToSend[n][s]&&e._changesToSend[n][s].changeKey.Release();e._changesToSend[n][s]=e._changesBeingSent[n][s]}e._changesBeingSent=null},y={},w={};e.runQuery(function(t){var n=e.InitContext(v,m,t);for(var r in a){var i=new SP.ExceptionHandlingScope(n.context),s=i.startScope(),o=n.list.getItemById(r);d=e._changesBeingSent[r];for(var u in d){var f=e.GetCSRFieldFromJsGridFieldKey(u);f&&f.FieldType&&(w.hasOwnProperty(f.FieldType)?w[f.FieldType]++:w[f.FieldType]=1);var l=d[u],c=e.GridValueToSPListValue(l.newProp,l.propType);if(u in e._params.parseAndSetFields){o.parseAndSetFieldValue(u,c);null!=e._params.spCsrRenderCtx&&106===e._params.spCsrRenderCtx.ListTemplateType&&("EndDate"===u&&!d.EventDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EventDate?o.parseAndSetFieldValue("EventDate",e._params.spCsrRenderCtx.CurrentItem.EventDate):"EventDate"===u&&!d.EndDate&&null!=e._params.spCsrRenderCtx.CurrentItem&&e._params.spCsrRenderCtx.CurrentItem.EndDate&&o.parseAndSetFieldValue("EndDate",e._params.spCsrRenderCtx.CurrentItem.EndDate))}else if(null==l.propType||"TaxonomyField"!=l.propType.ID&&"TaxonomyField_MultiValue"!=l.propType.ID)o.set_item(u,c);else{n.list.get_fields().getByInternalNameOrTitle(u).validateSetValue(o,c)}}o.update();o.get_fieldValuesAsText().retrieve();o.retrieve();s.dispose();y[r]={item:o,scope:i}}h=e.RetrieveCSRData(a,n.list);n.context.executeQueryAsync()});var E=Object.keys(a);p.EventGroup.raise(document,b.SPGridEvents.quickEditWriteChangesToListEventName,{itemIds:E});e._logEngagement("QuickEdit.WriteChangesToListCore",{itemIds:E,fieldTypes:w})},u=0;u<n.length;u+=50)o(u)})}};t.prototype._ensureExternalJsFilesLoaded=function(e){if(!$&&r.JsGridUtil.Internal.IsFeatureEnabled(B)){var t=[r.JsGridUtil.taxonomyLoadCallback],n=this._params.siteUrl+"/",s=i.JsGridConstants.csomFiles.map(function(e){return n+e});r.JsGridUtil.csomJsFilesLoader._ensureExternalJsFilesLoaded(s,e,t)}else e()};t.prototype.SetRowLevelError=function(e,t,n){this.ClearRowLevelError(e);var r=this._jsGridControl.SetRowError(e,t);this._rowLevelErrors[e]={id:r,bCommunicationsError:n};return r};t.prototype.ClearRowLevelError=function(e){if(e in this._rowLevelErrors){this._jsGridControl.ClearRowError(e,this._rowLevelErrors[e].id);delete this._rowLevelErrors[e]}};t.prototype.SetItemInfoPresent=function(e){for(var t=this._jsGridControl._GetPaneManager().GetGridPane().GetGridPaneConverter(),n=Math.min(e+this._params.viewRowLimit,this._infoFetched.length),r=e;r<n;r++)this._infoFetched[r]=t.RowIdxToRecordKey(r)};t.prototype.ClearItemInfoPresent=function(){this._infoFetched=new Array(this._params.totalItemCount)};t.prototype.ComputeSPDataRange=function(e){var t,n={pos:-1,count:0},r={rangesToFillRequest:1,totalRanges:[]},i=this._params.viewRowLimit,s=this._params.totalItemCount,o=this._jsGridControl.GetTopRowIndex(),u=this._jsGridControl.GetVisibleRecordCount(),a=Math.min(o+u,s);for(t=o;t<a;t++)if(!this._infoFetched[t]){n.pos=t;break}if(t==o)for(var f=a;f>=o;f--)if(!this._infoFetched[f]){n.pos=Math.max(0,f-i+1);for(;n.pos<this._infoFetched.length&&this._infoFetched[n.pos];)n.pos++;break}n.callbacks=[e];n.count=Math.min(s-n.pos,i);r.totalRanges.push(n);return r};t.prototype.CreateEntryRecord=function(){return this._dataSource.recordFactory.MakeRecord({},{})};t.prototype.FixScrollAfterPaste=function(){if(this._jsGridControl.paneMgr.gridPane.dontReflow)if(r.JsGridUtil._updatedPasteReflowKillSwitchIsActive){this._jsGridControl.paneMgr.gridPane.dontReflow=!1;this._jsGridControl.paneMgr.gridPane.ScrollCellIntoView(this._jsGridControl.paneMgr.gridPane.afterReflowScrollGoal,0)}else{this._jsGridControl.paneMgr.gridPane.dontReflow=!1;this._jsGridControl.paneMgr.gridPane.ScrollCellIntoView(this._jsGridControl.paneMgr.gridPane.afterReflowRowScrollGoal,this._jsGridControl.paneMgr.gridPane.afterReflowColScrollGoal)}};t.prototype.CreateNewListItem=function(e,t,n,r){var s,o,u=this;this.FixScrollAfterPaste();K||(o=new(this._telemetry(x.Qos))({name:re.createItem}));var a=function(){var r=s.get_fieldValues(),a=s.get_fieldValuesAsText().get_fieldValues();r&&r.ID&&p.EventGroup.raise(document,b.SPGridEvents.quickEditWriteChangesToListEventName,{itemIds:[r.ID]});var f=function(s){var f,l,c,h,p={},d={};for(var v in u._gridFieldMap)if(v in r){te||null===r[v]||null!=e[v]||(e[v]=r[v]);var m=void 0,g=void 0;if(ne){m=r[v];g=a[v]}else if(te){m=null===(c=e[v])||void 0===c?void 0:c.data;g=null===(h=e[v])||void 0===h?void 0:h.value}else{m=(null===(f=e[v])||void 0===f?void 0:f.data)||e[v];g=(null===(l=e[v])||void 0===l?void 0:l.value)||e[v]}var y=null==e[v]?null:u.SPListValueToGridValue(m,g,u._gridFieldMap[v].GetPropType(),v);y&&y.hasOwnProperty("data")&&(d[v]=y.data);y&&y.hasOwnProperty("localized")&&(p[v]=y.localized)}var b=s.get_id();d.ID=p.ID=b;d.ContentType=p.ContentType=s.get_contentType().get_name();d.Edit=i.JsGridConstants.SPGPermissions.editListItems|i.JsGridConstants.SPGPermissions.deleteListItems;u._jsGridControl.RemoveRowHeaderState(e.key(),i.JsGridConstants.RowHeaderStyleId.Transfer);null!=n&&n(b,p,d);u._currentlyCreatingNewListItem=!1;u._jsGridControl.GetRecord(b);for(v=0;v<u._fnRowChanged.length;v++)u._fnRowChanged[v](b,p,!1);if(null!=t)for(var w=0;w<t.length;w++)u._fnCallbacksByChangeKey.CallFunctions(t[w].changeKey.GetVersionNumber(),!0,b);K||o.end({resultType:x.ResultTypeEnum.Success})},l=u._jsGridControl.GetSpCsrRenderCtx();null!=l?(function(e,t){u.runQuery(function(n){var r=u.InitContext(function(){u.HandleCSRData(s,t.recordKey,e.get_id());f(e);var n=t.fieldRawDataMap.csrInfo;l.ListData.Row.push(n);u.PostCSRRender()},void 0,n),i={};i[e.get_id()]=1;var s=u.RetrieveCSRData(i,r.list);r.context.executeQueryAsync()})})(s,e):f(s)},f=function(n,s,a){u._jsGridControl.RemoveRowHeaderState(e.key(),i.JsGridConstants.RowHeaderStyleId.Transfer);var f=a;null!=s&&(f=u.SetErrorFromCSOMException(e.key(),s.get_errorCode(),s.get_errorValue(),s.get_message(),s.get_errorDetails()));null!=r&&r(s&&s.get_message(),f);u._currentlyCreatingNewListItem=!1;if(null!=t)for(var l=0;l<t.length;l++)u._fnCallbacksByChangeKey.CallFunctions(t[l].changeKey.GetVersionNumber(),!1);K||o.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToCreateItem",error:s&&s.get_message()})};this._jsGridControl.RemoveRowHeaderState(e.key(),i.JsGridConstants.RowHeaderAutoStyleId.Dirty);this._jsGridControl.AddBuiltInRowHeaderState(e.key(),i.JsGridConstants.RowHeaderStyleId.Transfer);var l={},c={};if(null!=t)for(var h=0;h<t.length;h++){c[t[h].fieldKey]=t[h];l[t[h].fieldKey]=t[h].newProp}var d=(function(t){var n,r=!1,i=null,s=function(t){null==u._jsGridControl.GetColumnByFieldKey(t)?i=u.SetRowLevelError(e.recordKey,SP.Res.requiredFieldNotInEditView,!1):u._jsGridControl.SetCellError(e.recordKey,t,SP.Res.requiredField15);r=!0};for(var o in u._params.requiredFields)(null==(n=t[o])||n.HasLocalizedValue()&&(""==n.localized||null==n.localized)||n.HasDataValue()&&null==n.data)&&s(o);if(null!=e.fieldRawDataMap&&null!=e.fieldRawDataMap._ContentTypeId){var a=e.fieldRawDataMap._ContentTypeId;if(null!=a&&a in u._params.contentTypes)for(var f=u._params.contentTypes[a].RequiredFields,l=0;l<f.length;l++){(null==(n=t[o=f[l]])||n.HasLocalizedValue()&&(""==n.localized||null==n.localized)||n.HasDataValue()&&null==n.data)&&s(o)}}return{fieldsMissing:r,errorId:i}})(l);d.fieldsMissing?f(0,null,d.errorId):this._ensureExternalJsFilesLoaded(function(){u.runQuery(function(e){var t,n=u.InitContext(a,f,e);null!=u._params.viewRootFolder&&(t=new SP.ListItemCreationInformation).set_folderUrl(u._params.viewRootFolder);s=n.list.addItem(t);for(var r in c){var i=c[r],o=u.GridValueToSPListValue(i.newProp,i.propType);if(r in u._params.parseAndSetFields)s.parseAndSetFieldValue(r,o);else if(null==i.propType||"TaxonomyField"!=i.propType.ID&&"TaxonomyField_MultiValue"!=i.propType.ID)s.set_item(r,o);else{n.list.get_fields().getByInternalNameOrTitle(r).validateSetValue(s,o)}}s.update();s.get_fieldValuesAsText().retrieve();s.retrieve();s.get_contentType().retrieve();n.context.executeQueryAsync();u._currentlyCreatingNewListItem=!0})})};t.prototype.InitContext=function(e,t,n){var r=this,i=new SP.ClientContext(this._isUsingDataSync&&n&&n.url||this._params.siteUrl);i.add_requestSucceeded(function(t,i){setTimeout(function(){r._isUsingDataSync&&n&&n.client.onRequestComplete({succeeded:!0,endpoint:n});e(t,i)},0)});i.add_requestFailed(function(e,i){setTimeout(function(){r._isUsingDataSync&&n&&n.client.onRequestComplete({succeeded:!1,endpoint:n});t&&t(e,i)},0)});this._isUsingDataSync&&n&&n.authToken&&i.add_executingWebRequest(function(e,t){t.get_webRequest().get_headers().Authorization=n.authToken});var s=i.get_web(),o=s.get_lists().getById(this._params.listId),u=o.get_views().getById(this._params.viewId);return{context:i,web:s,list:o,view:u}};t.prototype.InitSPListValueConversion=function(e){var t=this;this._GridValueToSPListValueConverters.Hyperlink=function(e){if(null==e.data)return null;var t=new SP.FieldUrlValue;t.set_url(e.data.address);t.set_description(e.data.display);return t};this._SPListValueToGridValueConverters.Hyperlink=function(e,t,n){return null==e?null:{data:{address:e.get_url(),display:e.get_description()},localized:e.get_description()}};this._SPListValueToGridValueConverters.SPEnhancedRichText=function(e,t,n){return null==e||""==e?null:{data:e,localized:e}};this._GridValueToSPListValueHelper=function(e){return Q?null!=e&&e.hasOwnProperty("email")&&""!==e.email?-1==e.email.indexOf("@")&&e.email!==e.display?e.email+";#"+e.display:"-1;#"+e.email:"-1;#"+e.display:null!=e&&e.hasOwnProperty("email")&&e.email?-1==e.email.indexOf("@")&&e.email!==e.display?e.email+";#"+e.display:"-1;#"+e.email:"-1;#"+e.display};this._GridValueToSPListValueConverters.SPUser=function(e){var n=e.data;!ee&&n&&t.isArray(n)&&(n=0===n.length?null:n[0]);var i=null==n||n==r.JsGridUtil.EmptyValue?"":t._GridValueToSPListValueHelper(n);return""!==i?i:null==e.localized||""==e.localized?null:"-1;#"+e.localized};this._SPListValueToGridValueConverters.SPUser=function(e,t,n){if(ee)return{data:[e],localized:e.get_lookupValue()};var r=ue(e);return{data:[r],localized:r.display}};this._GridValueToSPListValueConverters.SPUser_MultiValue=function(e){var n=e.localized,i=e.data,s="";if(!(null==i||i==r.JsGridUtil.EmptyValue))if(i.hasOwnProperty("email"));else if("undefined"!==i.length)for(var o=0;o<i.length;o++){s=s+(""==s?"":";#")+t._GridValueToSPListValueHelper(i[o])}return""!==s?s:null==n||""==n?null:"-1;#"+r.JsGridUtil.Internal.TokenizeString(n,";").join(";#-1;#")};this._SPListValueToGridValueConverters.SPUser_MultiValue=function(e,t,n){var r=[];if(ee){for(s=0;s<e.length;s++)r.push(e[s].get_lookupValue());return{data:e,localized:r.join("; ")}}for(var i=[],s=0;s<e.length;s++){var o=ue(e[s]);i.push(o);r.push(o.display)}return{data:i,localized:r.join("; ")}};this._GridValueToSPListValueConverters.Location=function(e){return e.data?JSON.stringify(e.data):null};this._SPListValueToGridValueConverters.Location=function(e,t,n){var r=JSON.parse(e);return{data:r,localized:r.DisplayName}};this._GridValueToSPListValueConverters.DropdownBoolean=function(e){return e.data?1:0};this._SPListValueToGridValueConverters.SPDateTime=function(e,t,n){return{data:new Date(e.valueOf()+60*r.JsGridUtil.SpRegionalSettings.timeZoneInHours*60*1e3),localized:t}};var n=function(e){return e.data&&e.data+";#"},i=function(e,t,n){return{data:e.get_lookupId(),localized:t}},s=function(e){return e.data&&e.data.join(";#;#")+";#"},o=function(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(e[i].get_lookupId());return{data:r,localized:t}};for(var u in e){var a=u+"_Lookup";this._GridValueToSPListValueConverters[a]=n;this._SPListValueToGridValueConverters[a]=i;a=u+"_Lookup_MultiValue";this._GridValueToSPListValueConverters[a]=s;this._SPListValueToGridValueConverters[a]=o}};t.prototype.RegisterSPListValueToGridValueConverter=function(e,t){this._SPListValueToGridValueConverters[e]=t};t.prototype.RegisterGridValueToSPListValueConverter=function(e,t){this._GridValueToSPListValueConverters[e]=t};t.prototype.GridValueToSPListValue=function(e,t){var n;return""===(n=null==t?e.HasDataValue()?e.data:e.localized:null!=this._GridValueToSPListValueConverters[t.ID]?this._GridValueToSPListValueConverters[t.ID](e):t.bMultiValue?t.LocStrToLocStrArray(e.localized).join(";#"):e.localized)?null:n};t.prototype.SPListValueToGridValue=function(e,t,n,i){return null==e?null:n&&null!=this._SPListValueToGridValueConverters[n.ID]?this._SPListValueToGridValueConverters[n.ID](e,t,i):{data:e,localized:n&&n.bMultiValue?n.LocStrArrayToLocStr(this.isArray(e)?e:r.JsGridUtil.Internal.TokenizeString(e,";#")):t}};t.prototype.isArray=function(e){return e&&e.constructor==Array};t.prototype.GetGanttBarDate=function(e,t,n){var r,s=e.GetDataValue(this._params.startColumnName),o=e.GetDataValue(this._params.finishColumnName);if(null!=s&&null!=o&&s>o){var u=s;s=o;o=u}if(n==i.JsGridConstants.GanttBarDateType.End&&1==t&&null!=s&&null!=o){var a=null!=this._params.pctCompleteColumnName?e.GetDataValue(this._params.pctCompleteColumnName):null;a=Math.min(null==a?0:a,1);if(isNaN(a))r=null;else{o instanceof Date||(o=new Date(o));s instanceof Date||(s=new Date(s));var f=Math.abs(o.getTime()-s.getTime());r=0!==a?new Date(s.getTime()+f*a):null}}else r=n==i.JsGridConstants.GanttBarDateType.Start?s:o;return r};t.prototype.GetPredecessors=function(e,t){if(null==t)return null;for(var n=[],r=0;r<t.length;r++)n.push({key:t[r],type:i.JsGridConstants.LinkType.FinishStart});return n};t.prototype.GetFieldReadOnlyActiveState=function(e){var t=this.GetCSRFieldFromJsGridFieldKey(e);return null==t||null==t.GridActiveAndReadOnly?null:"TRUE"==t.GridActiveAndReadOnly?i.JsGridConstants.ReadOnlyActiveState.ReadOnlyActive:i.JsGridConstants.ReadOnlyActiveState.ReadOnlyDisabled};t.prototype.GetFieldEditMode=function(e){var t=this.GetCSRFieldFromJsGridFieldKey(e);return null==t?i.JsGridConstants.EditMode.ReadOnly:(w.Killswitch.isActivated("ae71ac90-2661-4917-9476-c1542f2e6849","12/23/2019","Make new image columns read only in quick edit")||"Thumbnail"!==t.FieldType||"Thumbnail"===t.RealFieldName||"ThumbnailOnForm"===t.RealFieldName)&&"TRUE"==t.AllowGridEditing&&"TRUE"!==t.ReadOnly&&"1"!==t.XSLRender?i.JsGridConstants.EditMode.ReadWriteDefer:i.JsGridConstants.EditMode.ReadOnly};t.prototype.GetRecordEditMode=function(e){return e.GetDataValue("Edit")&i.JsGridConstants.SPGPermissions.editListItems?i.JsGridConstants.EditMode.ReadWriteDefer:i.JsGridConstants.EditMode.ReadOnly};t.prototype.ShouldLinkTitleCell=function(e,t,n,r){return null!=e.GetDataValue("_FolderLink")};t.prototype.OnTitleCellContentsClicked=function(e,t,n,i){var s=SP.Utilities.UrlBuilder.urlCombine(SP.PageContextInfo.get_webServerRelativeUrl(),e.GetDataValue("_FolderLink"));window.location.href=SP.Utilities.UrlBuilder.urlCombine(SP.PageContextInfo.get_webServerRelativeUrl(),this._params.viewUrl+"?RootFolder="+r.JsGridUtil.Internal.EscapeProperly(s)+"&FolderCTID="+this._params.folderContentTypeId)};t.prototype.OnEditCellContentsClicked=function(e,t,n,i){var s=GetCurrentCtx().editFormUrl,o=-1==s.indexOf("?")?"?":"&";window.location.href=s+o+"ID="+e.GetDataValue("ID")+"&Source="+r.JsGridUtil.Internal.EscapeProperly(window.location.href)};t.prototype.DeleteSelectedRecords=function(e){for(var t=this._jsGridControl.GetSelectedRecordKeys(),n=!1,r=0;r<t.length;r++)if(t[r]==e){n=!0;break}n&&0!=t.length||null==e||(t=[e]);this.DeleteItems(t)};t.prototype.IsParent=function(e){return!1};t.prototype.DeleteItems=function(e,t){var n,s=this,o=[];K||(n=new(this._telemetry(x.Qos))({name:re.deleteItems}));var u=function(e){return function(){for(var e=0;e<o.length;e++)for(var r=o[e],i=s._jsGridControl.GetRecord(r),u=0;u<s._fnRowChanged.length;u++)s._fnRowChanged[u](r,i.properties,!0);null!=o&&s._jsGridControl.DeleteRecords(o);s._currentlyDeletingListItems=!1;null!=t&&t(!0);K||n.end({resultType:x.ResultTypeEnum.Success})}},a=function(e){return function(){e&&alert(SP.Res.deleteFailed);s._currentlyDeletingListItems=!1;null!=t&&t(!1);K||n.end({resultType:x.ResultTypeEnum.Failure,resultCode:"FailToDeleteItemsd",error:SP.Res.deleteFailed})}};this._ensureExternalJsFilesLoaded(function(){for(var n=0;n<e.length;n++)s._jsGridControl.IsEntryRecordKey(e[n])||o.push(e[n]);var f=[];for(n=0;n<o.length;n++)s._jsGridControl.IsProvisionalRecordKey(o[n])?s._jsGridControl.DeleteRecords([o[n]]):f.push(o[n]);for(n=0;n<o.length;n++){var l=o[n];null!=s._changesToSend[l]&&delete s._changesToSend[l]}var c=s._jsGridControl.GetSpCsrRenderCtx();if(null==c){if(null!=s._jsGridControl.DeleteRecords(o))if(0!==f.length){s._currentlyDeletingListItems=!0;s.runQuery(function(e){for(var t=s.InitContext(u(),a(!0),e),n="1"==ctx.RecycleBinEnabled&&!ctx.ExternalDataList,r=0;r<f.length;r++){if(s._dataSource.tableCache.GetCachedRecord(f[r]).GetDataValue("Edit")&i.JsGridConstants.SPGPermissions.deleteListItems){var o=t.list.getItemById(f[r]);n?o.recycle():o.deleteObject()}}t.context.executeQueryAsync()})}else null!=t&&t(!0)}else r.JsGridUtil.Internal.IsFeatureEnabled(B)?S.inplview.DeleteSelectedItemsCore(c,f,u(),a(!1),!1,s._pageContext):window.inplview.DeleteSelectedItemsCore(c,f,u(),a(!1))})};t.prototype.get_ItemCount=function(){return this._jsGridControl.GetViewRecordCount()};t.prototype.GetViewIndexOfItem=function(e){return this._jsGridControl.GetViewIndexOfRecord(e)};t.prototype.TrySelectItem=function(e){this._jsGridControl.SelectRowRangeByKey(e,e,!1)};t.prototype.ToggleAllItems=function(){var e=this._jsGridControl._GetPaneManager().RecordKeyToViewIdx(this._jsGridControl.GetLastRecordKey()),t=this._jsGridControl.GetSelectedRecordKeys();null==t||t.length!==e-0+1?this._jsGridControl.SelectRowRange(0,e,!1):this._jsGridControl.SelectCellRange(0,0,0,0,!1)};t.prototype.ReadValue=function(e,t,n){this._dataSource.tableCache.GetRecordsByKey([e],function(e,r,i){if(i){var s=r[0],o={hasDataValue:s.HasDataValue(t),hasLocalizedValue:s.HasLocalizedValue(t)};o.hasDataValue&&(o.dataValue=s.GetDataValue(t));o.hasLocalizedValue&&(o.localizedValue=s.GetLocalizedValue(t));if(n)return n(!0,o)}else null!=n&&n(!1)})};t.prototype.GetOutlineLevel=function(e,t){var n=this;this._dataSource.tableCache.GetRecordsByKey([e],function(e,r,i){if(i){var s=n._jsGridControl.GetOutlineLevel(r[0]);if(t)return t(!0,s)}else null!=t&&t(!1)})};t.prototype.get_Columns=function(){return this._jsGridControl.GetColumns()};t.prototype.get_RequiredColumnKeys=function(){var e=[];for(var t in this._params.requiredFields)e.push(t);return e};t.prototype.get_IsInsertProvisionalChildOfFocusedItemEnabled=function(){return!!(null!=this._jsGridControl.GetFocusedItem()&&this._hierarchyEnabled&&this._params.listPermissions&i.JsGridConstants.SPGPermissions.addListItems)};t.prototype.get_IsReadOnly=function(){return(this._params.listPermissions&i.JsGridConstants.SPGPermissions.editListItems)!==i.JsGridConstants.SPGPermissions.editListItems};t.prototype.get_ContiguousSelectedItemsWithoutEntryItems=function(){var e=this._jsGridControl.GetContiguousRowSelectionWithoutEntryRecords();return null==e?null:e.keys};t.prototype.GetNodeExpandCollapseState=function(e){return this._jsGridControl.GetNodeExpandCollapseState(e)};t.prototype.ToggleExpandCollapse=function(e){this._jsGridControl.ToggleExpandCollapse(e)};t.prototype.MakeRecord=function(e,t){return this._dataSource.recordFactory.MakeRecord(e,t)};t.prototype.IsRWTimelineAwareOfList=function(e,t){if(void 0===SP.UI.Timeline)return!1;var n=!1;RunOperationOnTimelineData(function(){n=SP.UI.Timeline.ListTimelineDatasource.IsRWTimelineAwareOfList(e,t)});return n};t.prototype.OnRightClick=function(e){var t=this;if(e.context==i.JsGridConstants.ClickContext.RowHeader&&(this._params.listPermissions&i.JsGridConstants.SPGPermissions.deleteListItems||this._params.listPermissions&i.JsGridConstants.SPGPermissions.addListItems||this._params.listPermissions&i.JsGridConstants.SPGPermissions.editListItems)){var n=new d.ContextMenuWrapper({target:e.eventInfo,id:this._jsGridControl.parentNode.id+"_rowcontextmenu",portalManager:this._jsGridControl.objBag?this._jsGridControl.objBag.portalManager:void 0});this._params.listPermissions&i.JsGridConstants.SPGPermissions.deleteListItems&&n.InsertMenuItem({key:"deleteItem",text:SP.Res.deleteText,onClick:function(){t.DeleteSelectedRecords(e.recordKey)},disabled:this._jsGridControl.IsGroupingRecordKey(e.recordKey)||this._jsGridControl.IsEntryRecordKey(e.recordKey)});if(this._params.listPermissions&i.JsGridConstants.SPGPermissions.editListItems){this._jsGridControl.GetSpCsrRenderCtx();this.IsRWTimelineAwareOfList(this._params.listId,this._params.selectedTimelineView)&&n.InsertMenuItem({key:"addToTimeLine",text:Strings.STS.L_TimelineAddToTimeline,onClick:function(){var n=!1,r=t._jsGridControl.GetSelectedRecordKeys(),i=[];if(null!=r&&r.length&&r.length>0)for(var s=0;s<r.length;s++){(o={}).id=r[s];i.push(o);o.id==e.recordKey&&(n=!0)}if(0==n){var o;(o={}).id=e.recordKey.toString();i=[o]}t.AddItemsToTimeline(i)},disabled:this._bGrouped||this._jsGridControl.IsEntryRecordKey(e.recordKey)});this.CanDiscardChangesForRow(e.recordKey)&&n.InsertMenuItem({key:"discardChange",text:Strings.STS.L_SPGanttDiscardChangesMenuItem,onClick:function(){t.DiscardChangesForRow(e.recordKey)}})}n.Show()}};t.prototype.BuildMaxLengthTable=function(e){var t={};for(var n in e)"number"==typeof e[n]&&(t[n]=e[n]);return t};t._instances=[];t._FnGanttCreationCallback=[];return t})();t.GanttControl=oe;function ue(e){return e?{email:e.get_email(),display:e.get_lookupValue()}:{email:"",display:""}}function ae(e,t,n,i){var s=[];if("Thumbnail"!==e||r.JsGridUtil.Internal.IsFeatureEnabled(H)){var o={key:t.Desc,text:t.Desc,onClick:t.FnOnClick};i||n.InsertMenuItem(o);s.push(o)}return s}});
define("Fqe",["require","exports","r","HA","MA","ou"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WaitingDialog=function(e){var t=e.title,o=e.prompt;return n.createElement(r.Dialog,{hidden:!1,title:t,maxWidth:e.maxWidth},n.createElement(i.Label,null,o),n.createElement(r.DialogFooter,null,n.createElement(s.Spinner,{size:s.SpinnerSize.large})))}});
define("Tqe",["require","exports","Dqe","Lqe","RWe","k","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o){"use strict";o=o.SPGrid_6;Object.defineProperty(t,"__esModule",{value:!0});var u=s.Killswitch.isActivated("CAF8B57F-023A-49B5-B7B6-A92006D95286","10/11/2019","Fix several issues with items positioned far off to the left causing RTL bugs."),a=s.Killswitch.isActivated("983CF6BF-776A-4753-92FC-1D8F1F1C6DAA","10/17/2019","make quick edit compatible with dark themes"),f=s.Killswitch.isActivated("6BD41586-EA3C-4EDB-B381-53736E836DEA","03/04/2020","Fix when first element in a RTE editor is a <p> tag that collapses margins causing the editor to shift down in relation to the cell."),l={ODB:1725},c={ODB:60017},h=(function(){function e(e){var t=this;this.SupportedWriteMode=n.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=n.JsGridConstants.EditActorReadType.LocalizedOnly;this.id="jsgrid_multilineeditbox";this.OnMouseDown=function(e){e.stopPropagation()};this.OnKeyDown=function(e){if(e.keyCode!=n.JsGridConstants.Key.enter&&"function"==typeof t.gridContext.OnKeyDown){e.StopInfiniteKeyDownLoop=!0;t.gridContext.OnKeyDown(e)}};this.gridContext=e;this.parentNode=e.parentNode;this.textArea=document.createElement("textarea");this.textArea.id=this.id;this.textArea.className=a?"jsgrid-control-multiline":r.JsGridUtil.Internal.IsFeatureEnabled(l)?o.jsgridControlMultilineTextarea:"jsgrid-control-multiline-quickedit";this.textArea.style.cssText="visibility:hidden;position:absolute;top:0px;left:0px;";this.textArea.tabIndex=-1;this.textArea.style.direction=e.RTL.ltr;this.parentNode.appendChild(this.textArea)}e.prototype.SizeToCellOrDefault=function(){var e,t;if(r.JsGridUtil.Internal.IsFeatureEnabled(l)){e=this.cellContext.cellWidth-3;t=this.cellContext.cellHeight-5}else{e=this.cellContext.cellWidth-6;t=this.cellContext.cellHeight-6}this.textArea.style.width=e+"px";this.textArea.style.height=t+"px"};e.prototype.SetupHandlers=function(e){if(e){this.textArea.addEventListener("focus",this.gridContext.OnActivateActor);this.textArea.addEventListener("blur",this.gridContext.OnDeactivateActor);this.textArea.addEventListener("keydown",this.OnKeyDown);this.textArea.addEventListener("mousedown",this.OnMouseDown)}else{this.textArea.removeEventListener("focus",this.gridContext.OnActivateActor);this.textArea.removeEventListener("blur",this.gridContext.OnDeactivateActor);this.textArea.removeEventListener("keydown",this.OnKeyDown);this.textArea.removeEventListener("mousedown",this.OnMouseDown)}};e.prototype.GetCSRFieldValue=function(){var e=this.cellContext.field.key;if(null!=this.cellContext.record.fieldRawDataMap.csrInfo){var t=this.cellContext.record.fieldRawDataMap.csrInfo[e];null!=t&&(t=(t=r.JsGridUtil.Internal.Encoding_STSHtmlDecode(t)).replace(/<br>/g,"\n"));return t}return null};e.prototype.SetCSRFieldValue=function(e){var t=e;null!=e&&(t=(t=r.JsGridUtil.Internal.Encoding_STSHtmlDecode(t)).replace(/\n/g,"<br>"));var n=this.cellContext.field.key;null==this.cellContext.record.fieldRawDataMap.csrInfo&&(this.cellContext.record.fieldRawDataMap.csrInfo={});this.cellContext.record.fieldRawDataMap.csrInfo[n]=t;this.cellContext.SetCurrentValue({localized:e})};e.prototype.Dispose=function(){r.JsGridUtil.ClearEventListeners(this.textArea)};e.prototype.Focus=function(e){var t,i=this;try{this.textArea.focus();if(null==e)this.textArea.value=this.textArea.value;else if("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==n.JsGridConstants.Key.F2)t=i.GetCSRFieldValue(),i.textArea.value=null==t||t==r.JsGridUtil.EmptyValue?"":t;else if(r.JsGridUtil.Utility.IsChar(e)){this.textArea.value=String.fromCharCode(e.charCode);this.SetCSRFieldValue(this.textArea.value)}}catch(e){r.JsGridUtil.DebugAssert(!1,"Incorrectly trying to focus the MultilineEditControl while hidden?")}};e.prototype.BindToCell=function(e){this.cellContext=e;this.SizeToCellOrDefault();this.cellContext.field.textDirection!==n.JsGridConstants.TextDirection.Default&&(this.textArea.style.direction=this.cellContext.field.textDirection==n.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");var t=this.GetCSRFieldValue();this.textArea.value=null==t||t==r.JsGridUtil.EmptyValue?"":t};e.prototype.OnBeginEdit=function(e){var t=this;this.cellContext.Show(this.textArea);this.bInEdit=!0;this.SetupHandlers(!0);"mousedown"==e.type?setTimeout(function(){t.Focus(e)},0):this.Focus(e)};e.prototype.Unbind=function(){this.textArea.value=""};e.prototype.OnEndEdit=function(){this.SetupHandlers(!1);var e=this.GetCSRFieldValue();e=null==e||e==r.JsGridUtil.EmptyValue?"":e;this.textArea.value!==e&&this.SetCSRFieldValue(this.textArea.value);this.cellContext.Hide(this.textArea);this.bInEdit=!1};e.prototype.OnCellMove=function(){this.SizeToCellOrDefault();this.bInEdit&&this.cellContext.Show(this.textArea)};e.prototype.OnValueChanged=function(e){this.textArea.value=null==e.localized||e.localized==r.JsGridUtil.EmptyValue?"":e.localized};return e})();t.MultilinePlainTextEditControl=h;var p=(function(){function e(e,t){var i=this;this.SupportedWriteMode=n.JsGridConstants.EditActorWriteType.LocalizedOnly;this.SupportedReadMode=n.JsGridConstants.EditActorReadType.LocalizedOnly;this.id="jsgrid_richtexteditbox";this.rteMinHeight=84;this.OnMouseDown=function(e){e.stopPropagation()};this.OnKeyDown=function(e){if(e.keyCode!=n.JsGridConstants.Key.enter&&"function"==typeof i.gridContext.OnKeyDown){e.StopInfiniteKeyDownLoop=!0;i.gridContext.OnKeyDown(e)}};this.gridContext=e;this.parentNode=e.parentNode;this.outerSpan=document.createElement("span");this.outerSpan.id=this.id;this.outerSpan.className=a?"jsgrid-control-rte":r.JsGridUtil.Internal.IsFeatureEnabled(l)?o.jsgridControlRteContainer:"jsgrid-control-rte-quickedit";this.outerSpan.style.cssText=u?"visibility:hidden;position:absolute;top:-10000px;left:-10000px;":"visibility:hidden;position:absolute;top:-10000px;"+e.RTL.left+":-10000px;";this.outerSpan.tabIndex=-1;this.divRteStateField=document.createElement("div");this.divRteStateField.className="ms-rtestate-field ms-rtefield ms-shadow";this.divRteStateField.style.minWidth="0px";this.divRteStateField.id=this.id+"_topDiv";var s=document.createElement("div");s.id=this.id+"_label";s.style.display="none";this.divRteStateWriteId=this.id="_rte"+(t||"");this.divRteStateWrite=null;this.divRteExtra=document.createElement("div");this.divRteExtra.style.clear="both";this.divRteStateField.appendChild(s);this.divRteStateField.appendChild(this.divRteExtra);this.outerSpan.appendChild(this.divRteStateField);var f=document.createElement("span");this.saveInputId=this.id+"_saveInput";this.saveInput=document.createElement("input");this.saveInput.id=this.saveInputId;this.saveInput.type="hidden";var c=document.createElement("input");c.id="ms-rtefocuselementid";c.name="ms-rtefocuselementid";c.type="hidden";f.appendChild(this.saveInput);f.appendChild(c);this.outerSpan.appendChild(f);this.parentNode.appendChild(this.outerSpan)}e.prototype.SizeToCellOrDefault=function(){var e,t;if(r.JsGridUtil.Internal.IsFeatureEnabled(l)){e=this.cellContext.cellWidth-5+"px";t=this.cellContext.cellHeight+"px"}else{e=this.cellContext.cellWidth-6+"px";t=this.cellContext.cellHeight-6+"px"}this.outerSpan.style.minWidth=e;this.outerSpan.style.minHeight=t;this.divRteStateWrite.style.minWidth=e;this.divRteStateWrite.style.minHeight=t};e.prototype.SetupHandlers=function(e){if(e){this.divRteStateWrite.addEventListener("focus",this.gridContext.OnActivateActor);this.divRteStateWrite.addEventListener("keydown",this.OnKeyDown);this.divRteStateWrite.addEventListener("mousedown",this.OnMouseDown)}else{this.divRteStateWrite.removeEventListener("focus",this.gridContext.OnActivateActor);this.divRteStateWrite.removeEventListener("keydown",this.OnKeyDown);this.divRteStateWrite.removeEventListener("mousedown",this.OnMouseDown)}};e.prototype.GetCSRFieldValue=function(){var e=this.cellContext.field.key;return null!=this.cellContext.record.fieldRawDataMap.csrInfo?this.cellContext.record.fieldRawDataMap.csrInfo[e]:null};e.prototype.SetCSRFieldValue=function(e){var t=this.cellContext.field.key;null==this.cellContext.record.fieldRawDataMap.csrInfo&&(this.cellContext.record.fieldRawDataMap.csrInfo={});this.cellContext.record.fieldRawDataMap.csrInfo[t]=e;this.cellContext.SetCurrentValue({localized:e})};e.prototype.Dispose=function(){r.JsGridUtil.ClearEventListeners(this.divRteStateWrite)};e.prototype.Focus=function(e){var t=this;try{this.divRteStateWrite.focus();if(null==e){RTE.Cursor.get_range().moveToEndOfNode(this.divRteStateWrite);RTE.Cursor.update()}else if("mousedown"==e.type||"gridapi"==e.type||"keydown"==e.type&&e.keyCode==n.JsGridConstants.Key.F2||"keydown"==e.type&&r.JsGridUtil.Internal.IsFeatureEnabled(c)&&e.keyCode==n.JsGridConstants.Key.enter)(function(){var e=t.GetCSRFieldValue();t.saveInput.value=null==e||e==r.JsGridUtil.EmptyValue?"":e;t.divRteStateWrite.innerHTML=t.saveInput.value;RTE.Cursor.get_range().moveToEndOfNode(t.divRteStateWrite);RTE.Cursor.update()})();else if(r.JsGridUtil.Utility.IsChar(e)){this.divRteStateWrite.innerHTML="";this.saveInput.value=String.fromCharCode(e.charCode);this.SetCSRFieldValue(this.saveInput.value);var i=document.createTextNode(this.saveInput.value);RTE.Cursor.get_range().moveToEndOfNode(this.divRteStateWrite);RTE.Cursor.get_range().insertNode(i);RTE.Cursor.get_range().moveToEndOfNode(this.divRteStateWrite);RTE.Cursor.update()}}catch(e){r.JsGridUtil.DebugAssert(!1,"Incorrectly trying to focus the MultilineEditControl while hidden?")}};e.prototype.BindToCell=function(e){this.cellContext=e;this.RecreateDivRteStateWrite();this.SizeToCellOrDefault();this.cellContext.field.textDirection!==n.JsGridConstants.TextDirection.Default&&(this.divRteStateWrite.style.direction=this.cellContext.field.textDirection==n.JsGridConstants.TextDirection.RightToLeft?"rtl":"ltr");var t=this.GetCSRFieldValue();this.saveInput.value=null==t||t==r.JsGridUtil.EmptyValue?"":t;this.divRteStateWrite.innerHTML=this.saveInput.value};e.prototype.OnBeginEdit=function(e){var t=this;r.JsGridUtil.Internal.IsFeatureEnabled(l)?this.cellContext.Show(this.outerSpan,!0):this.cellContext.Show(this.outerSpan);this.bInEdit=!0;this.SetupHandlers(!0);"mousedown"==e.type?setTimeout(function(){t.Focus(e)},0):this.Focus(e)};e.prototype.Unbind=function(){this.saveInput.value="";this.divRteStateWrite.innerHTML=""};e.prototype.OnEndEdit=function(){this.SetupHandlers(!1);var e=this.GetCSRFieldValue();e=null==e||e==r.JsGridUtil.EmptyValue?"":e;RTE.RichTextEditor.transferContentsToInputField(this.divRteStateWriteId,!1);this.saveInput.value!==e&&this.SetCSRFieldValue(this.saveInput.value);this.cellContext.Hide(this.outerSpan);this.outerSpan.style.top="-10000px";u?this.outerSpan.style.left="-10000px":this.outerSpan.style[this.gridContext.RTL.left]="-10000px";this.bInEdit=!1};e.prototype.OnCellMove=function(){this.SizeToCellOrDefault();this.bInEdit&&(r.JsGridUtil.Internal.IsFeatureEnabled(l)?this.cellContext.Show(this.outerSpan,!0):this.cellContext.Show(this.outerSpan))};e.prototype.OnValueChanged=function(e){this.saveInput.value=null==e.localized||e.localized==r.JsGridUtil.EmptyValue?"":e.localized;this.divRteStateWrite.innerHTML=this.saveInput.value};e.prototype.RecreateDivRteStateWrite=function(){if(null!=this.divRteStateWrite){this.divRteStateField.removeChild(this.divRteStateWrite);this.divRteStateWrite=null}this.divRteStateWrite=document.createElement("div");this.divRteStateWrite.className="ms-rtestate-write ms-rteflags-0 "+(f?"":o.msRteStateField);this.divRteStateWrite.id=this.divRteStateWriteId;this.divRteStateWrite.style.minHeight=this.rteMinHeight+"px";this.divRteStateWrite.setAttribute("aria-labelledby",this.id+"_label");this.divRteStateWrite.setAttribute("contentEditable","true");this.divRteStateWrite.style.direction=this.gridContext.RTL.ltr;this.divRteStateWrite.style.paddingLeft="3px";this.divRteStateWrite.style.paddingRight="3px";this.divRteStateField.appendChild(this.divRteStateWrite);null!=this.divRteStateWrite&&(this.divRteStateWrite.InputFieldId=this.saveInputId);null!=this.saveInput&&""==this.saveInput.value&&(this.saveInput.value=this.divRteStateWrite.innerHTML);RTE.Canvas.fixRegion(this.divRteStateWriteId,!1)};return e})();t.EnhancedRichTextEditControl=p;t.GetEditBoxEditControl=function(e,t){var n=t?i.EditControl.GetHyperlinkEditControl(e):new i.EditControl.EditBoxEditControl(e),r=n.BindToCell;n.BindToCell=function(e){r.call(this,e);var t=this.GetInputElement();"function"==typeof e.propType.GetMaxLength&&t.setAttribute("MaxLength",e.propType.GetMaxLength(e.fieldKey))};var s=n.Unbind;n.Unbind=function(){s.call(this);this.GetInputElement().setAttribute("MaxLength",null)};return n};t.GetPeoplePickerEditControl=function(e){var t=new i.EditControl.PeoplePickerEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetLocationPickerEditControl=function(e){var t=new i.EditControl.LocationPickerEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetCheckBoxEditControl=function(e){var t=new i.EditControl.CheckboxEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetTaxonomyPickerEditControl=function(e,t){var n=new i.EditControl.TaxonomyPickerEditControl(e,t),r=n.BindToCell;n.BindToCell=function(e){r.call(this,e)};var s=n.Unbind;n.Unbind=function(){s.call(this)};return n};t.GetHyperlinkEditControl=function(e){var t=new i.EditControl.HyperlinkEditControlV2(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetNumberBoxEditControl=function(e){var t=new i.EditControl.NumberEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t};t.GetDatePickerEditControl=function(e){var t=new i.EditControl.DateEditControl(e),n=t.BindToCell;t.BindToCell=function(e){n.call(this,e)};var r=t.Unbind;t.Unbind=function(){r.call(this)};return t}});
define("Uqe",["require","exports","Lqe","Dqe","Eqe","we","k"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.Killswitch.isActivated("8DAECEAF-4AEF-45B5-A606-9A3034CC2124","10/18/2019","Use modern taxonomy editor in quick edit."),a=o.Killswitch.isActivated("7B1ACA6D-A5F4-4412-BE1E-93F3F72B1A4F","3/10/2020","Fix XSS issue in some text columns."),f={ODB:1746},l=(function(){function e(e){this.ID="SPTextMaxLength";this.maxLengthTable=e;a||(this.LocalizedValueToCSRValue=function(e){return null==e?null:n.JsGridUtil.Internal.Encoding_STSHtmlEncode(e.replace(/\n/g,"<br>"))})}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r;r=n.JsGridUtil.SPUserValueOnPasteFixup(r);var u=this.maxLengthTable[t];null!=r&&null!=u&&0!==u&&(r=r.substr(0,u));s({isValid:!0,dataValue:r,normalizedLocValue:r})};e.prototype.GetMaxLength=function(e){return this.maxLengthTable[e]};e.prototype.toString=function(){return this.ID};return e})();t.TextMaxLengthPropertyType=l;var c=(function(){function e(){this.ID="Number"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.DebugAssert(i);n.JsGridUtil.DebugAssert("string"==typeof r);r=n.JsGridUtil.SPUserValueOnPasteFixup(r);s({isValid:!0,dataValue:n.JsGridUtil.EmptyValue,normalizedLocValue:r.toUpperCase()})};return e})();t.NumberPropertyType=c;var h=(function(){function e(){this.ID="SPDateTime"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.DebugAssert(i);n.JsGridUtil.DebugAssert("string"==typeof r);r=n.JsGridUtil.SPUserValueOnPasteFixup(r);s({isValid:!0,dataValue:n.JsGridUtil.EmptyValue,normalizedLocValue:r.toUpperCase()})};return e})();t.DatePropertyType=h;var p=(function(){function e(){this.ID="SPPercentComplete"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.DebugAssert(i);s({isValid:!0,dataValue:null,normalizedLocValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r)})};return e})();t.PercentCompletePropertyType=p;var d=(function(){function e(){this.ID="SPEdit"}e.prototype.GetImageSource=function(e,t){return t&r.JsGridConstants.SPGPermissions.editListItems?n.JsGridUtil.Internal.SiteUrl+"/_layouts/images/edititem.gif":null};e.prototype.DataToLocalized=function(e){return e&r.JsGridConstants.SPGPermissions.editListItems?SP.Res.editColEditable:SP.Res.editColReadOnly};return e})();t.EditPropertyType=d;var v=(function(){function e(e){this.ID="SPUser";this.spGanttControl=e}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){n.JsGridUtil.hasPasteStarted=!1;var u=i?this.LocalizedToData(r):r,a=null!=u&&u!==n.JsGridUtil.EmptyValue&&u!==n.JsGridUtil.InvalidValue&&(Boolean(u.display!==u.email)||Boolean(u.length>1));s({isValid:!0,dataValue:u,normalizedLocValue:i&&!a?r:this.DataToLocalized(u)})};e.prototype.GetPeoplePickerSettings=function(e){return this.spGanttControl.customFieldInfo[e]};e.prototype.SetPeoplePickerDefaultSettings=function(e){this.spGanttControl.customFieldInfo[e]="User,SecGroup,SPGroup;#0;#false"};e.prototype.LocalizedToData=function(e){return this.Deserialize(e)};e.prototype.DataToLocalized=function(e){if(null==e)return null;var t=null;if(void 0===e.length)t=e.display;else{for(var r=[],i=0;i<e.length;i++)r.push(e[i].display);t=n.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(r,n.JsGridUtil.multiValSeparator,!1)}return t};e.prototype.IsDataEqual=function(e,t){if(null==e||null==t)return e==t;var n=function(e,t){return e.display==t.display&&e.email==t.email},r=!1;if(!e.hasOwnProperty("length")||!t.hasOwnProperty("length"))return n(e,t);if(e.length!==t.length)return!1;for(var i=0;i<e.length&&(r=n(e[i],t[i]));i++);return r};e.prototype.GetCopyValue=function(e,t,r){n.JsGridUtil.lastCopiedValueType_SPUser=!0;return null==t?r:this.Serialize(t)};e.prototype.SetSeparator=function(e){null!=e&&(n.JsGridUtil.multiValSeparator=1==e.length?e+" ":e)};e.prototype.deserializeSingleVal=function(e){var t=e.split(n.JsGridUtil.serializedFieldSeparator);return{display:t[0],email:void 0!==t[1]?t[1]:t[0]}};e.prototype.Deserialize=function(e){if(e==n.JsGridUtil.EmptyValue||""==e)return null;var t=e.split(n.JsGridUtil.multiValSeparator);if(1==t.length)return this.deserializeSingleVal(t[0]);for(var r=[],i=0;i<t.length;i++)r.push(this.deserializeSingleVal(t[i]));return r};e.prototype.svSerialize=function(e){return void 0===e.display||void 0===e.email?s.format("{0}{1}{2}",e.get_lookupValue(),n.JsGridUtil.serializedFieldSeparator,e.get_email()):s.format("{0}{1}{2}",e.display,n.JsGridUtil.serializedFieldSeparator,e.email)};e.prototype.Serialize=function(e){if(null==e)return null;var t=[];if(e.hasOwnProperty("email"))t.push(this.svSerialize(e));else if(e.hasOwnProperty("length"))for(var r=0;r<e.length;r++)null!=e[r].data?t.push(this.svSerialize(e[r].data)):t.push(this.svSerialize(e[r]));return n.JsGridUtil.Internal.URI_ConvertMultiColumnValueToString(t,n.JsGridUtil.multiValSeparator,!1)};return e})();t.UserPropertyType=v;var m=(function(){function e(e,t,n){var r=this;this.GetItems=function(e){r.EnsureEntriesCached(function(){for(var t=[],n=0;n<r._entries.length;n++)t.push(i.PropertyType.Property.prototype.MakeProperty(r._entries[n].id,r._entries[n].locValue,!0,!0,r));e(t)},function(){e(null)})};this.ID=e+"_Lookup";this._lookupFieldInfo=t;this._fileLoadUrl=n}e.prototype.InvalidateCache=function(){this._entries=null};e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){var u=this;this.EnsureEntriesCached(function(){if(!u._lookupFieldInfo.required&&i&&""==r||!i&&null==r)s({isValid:!0,dataValue:[],normalizedLocValue:""});else{var e=n.JsGridUtil.Internal.FindInArray(u._entries,i?function(e){return r==e.locValue}:function(e){return r==e.id});s(null==e?{isValid:!1}:{isValid:!0,dataValue:u._entries[e].id,normalizedLocValue:u._entries[e].locValue})}},o)};e.prototype.EnsureEntriesCached=function(e,t){var n=this;null==this._entries?this.GetFieldValues(this._lookupFieldInfo.webUrl,this._lookupFieldInfo.listId,this._lookupFieldInfo.field,function(r){if(null==r)t();else{n._entries=r;e()}}):e()};e.prototype.GetFieldValues=function(e,t,i,s){var o,a=this,l=function(){for(var e=[],t=o.get_count(),r=0;r<t;r++){var u=o.itemAt(r),a=u.get_fieldValues(),f=u.get_fieldValuesAsText().get_fieldValues();n.JsGridUtil.Internal.IsStrNullOrEmpty(f[i])||e.push({id:a.ID,locValue:f[i]})}s(e)},c=function(){s(null)},h=['<View Scope="RecursiveAll">',"<ViewFields>",'<FieldRef Name="ID"/>','<FieldRef Name="'+escape(i)+'"/>',"</ViewFields>",'<Query><OrderBy><FieldRef Name="'+escape(i)+'"/></OrderBy></Query>',"</View>"].join(""),p=function(){var n=new SP.ClientContext(e),r=n.get_web().get_lists().getById(t),s=new SP.CamlQuery;s.set_viewXml(h);var u=(o=r.getItems(s)).retrieveItems();u.retrieve("ID");u.retrieveObject("FieldValuesAsText").retrieve(i);n.add_requestSucceeded(l);n.add_requestFailed(c);n.executeQueryAsync()};if(!u&&n.JsGridUtil.Internal.IsFeatureEnabled(f)){var d=[n.JsGridUtil.taxonomyLoadCallback],v=r.JsGridConstants.csomFiles.map(function(e){return a._fileLoadUrl+e});n.JsGridUtil.csomJsFilesLoader._ensureExternalJsFilesLoaded(v,p,d)}else p()};return e})();t.LookupPropertyType=m;var g=(function(){function e(){this.ID="SPMultilineText"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r.replace(/<br>/g,"\n");s({isValid:!0,dataValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r),normalizedLocValue:r})};e.prototype.LocalizedValueToCSRValue=function(e){return null==e?null:n.JsGridUtil.Internal.Encoding_STSHtmlEncode(e.replace(/\n/g,"<br>"))};return e})();t.MultilineTextPropertyType=g;var y=(function(){function e(){this.ID="SPEnhancedRichText"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r;s({isValid:!0,dataValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r),normalizedLocValue:r})};e.prototype.LocalizedValueToCSRValue=function(e){return e};return e})();t.EnhancedRichTextPropertyType=y;var b=(function(){function e(){this.ID="SPImageThumbnail"}e.prototype.BeginValidateNormalizeConvert=function(e,t,r,i,s,o){r=null!=r&&0==r.length?null:r;s({isValid:!0,dataValue:r=n.JsGridUtil.SPUserValueOnPasteFixup(r),normalizedLocValue:r})};e.prototype.LocalizedValueToCSRValue=function(e){return e};return e})();t.ImageThumbnailPropertyType=b});
define("Nqe",["require","exports","Lqe","ld","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i){"use strict";var s=i.SPGrid_6;i=i.styles_9;Object.defineProperty(t,"__esModule",{value:!0});var o=r.getTheme(),u={ODB:1725};function a(e){var t=n.JsGridUtil.Internal.Color.HexStringToColor(e);null!=t&&(t=n.JsGridUtil.Internal.Color.MakeAlphaColor(.2,t.r,t.g,t.b));return t}t.StyleType={Splitter:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{}},SplitterHandle:{outerBorderColor:{jsId:"borderTopColor"},leftInnerBorderColor:{jsId:"borderLeftColor"},innerBorderColor:{jsId:"borderBottomColor"},backgroundColor:{},gripUpperColor:{jsId:"color"},gripLowerColor:{jsId:"borderRightColor"}},GridPane:{verticalBorderColor:{jsId:"borderRightColor"},verticalBorderStyle:{jsId:"borderRightStyle"},horizontalBorderColor:{jsId:"borderBottomColor"},horizontalBorderStyle:{jsId:"borderBottomStyle"},backgroundColor:{jsId:"backgroundColor"},columnDropIndicatorColor:{jsId:"borderLeftColor"},rowDropIndicatorColor:{jsId:"borderLeftColor"},linkColor:{classId:"link",jsId:"color"},visitedLinkColor:{classId:"link",jsId:"backgroundColor"},copyRectForeBorderColor:{classId:"selection",jsId:"borderLeftColor"},copyRectBackBorderColor:{classId:"selection",jsId:"borderRightColor"},focusRectBorderColor:{classId:"selection",jsId:"borderTopColor"},selectionRectBorderColor:{classId:"selection",jsId:"borderBottomColor",semanticColor:"inputFocusBorderAlt"},selectedCellBgColor:{classId:"selection",jsId:"color",fromCss:a},readonlySelectionRectBorderColor:{classId:"readOnlySelection",jsId:"borderBottomColor"},changeHighlightCellBgColor:{classId:"edit",jsId:"backgroundColor",fromCss:a},fillRectBorderColor:{classId:"edit",jsId:"borderLeftColor",semanticColor:"inputFocusBorderAlt"},errorRectBorderColor:{classId:"edit",jsId:"borderTopColor"}},Header:{font:{jsId:"fontFamily"},fontSize:{},fontWeight:{},textColor:{jsId:"color"},outerBorderColor:{jsId:"borderBottomColor"},innerBorderColor:{jsId:"borderRightColor"},eyeBrowBorderColor:{jsId:"borderTopColor"},eyeBrowColor:{jsId:"borderLeftColor"},menuColor:{classId:"elementColor",jsId:"backgroundColor"},menuBorderColor:{classId:"elementColor",jsId:"borderLeftColor"},resizeColor:{classId:"elementColor",jsId:"borderBottomcolor"},resizeBorderColor:{classId:"elementColor",jsId:"borderRightColor"},menuHoverColor:{classId:"elementHoverColor",jsId:"backgroundColor"},menuHoverBorderColor:{classId:"elementHoverColor",jsId:"borderLeftColor"},resizeHoverColor:{classId:"elementHoverColor",jsId:"borderTopColor"},resizeHoverBorderColor:{classId:"elementHoverColor",jsId:"borderRightColor"},eyeBrowHoverColor:{classId:"elementHoverColor",jsId:"borderTopColor"},eyeBrowHoverBorderColor:{classId:"elementHoverColor",jsId:"borderBottomColor"},elementClickColor:{classId:"elementClickColor",jsId:"backgroundColor"},elementClickBorderColor:{classId:"elementClickColor",jsId:"borderLeftColor"}},RowHeaderStyle:{backgroundColor:{},outerBorderColor:{jsId:"borderBottomColor"},innerBorderColor:{jsId:"borderRightColor"}},TimescaleTier:{font:{jsId:"fontFamily"},fontSize:{},fontWeight:{},textColor:{jsId:"color"},backgroundColor:{},verticalBorderColor:{jsId:"borderRightColor"},verticalBorderStyle:{jsId:"borderRightStyle"},horizontalBorderColor:{jsId:"borderBottomColor"},horizontalBorderStyle:{jsId:"borderBottomStyle"},outerBorderColor:{jsId:"borderLeftColor"},todayLineColor:{jsId:"borderTopColor"}},Cell:{font:{jsId:"fontFamily"},fontSize:{},fontWeight:{},fontStyle:{},textColor:{jsId:"color"},backgroundColor:{},textAlign:{}},Widget:{backgroundColor:{jsId:"backgroundColor"},borderColor:{jsId:"borderColor"}}};var f,l=0,c=1,h=2,p=3,d=4,v=5,m=(function(){function e(){var e=this;this.Dispose=function(){window.removeEventListener("unload",e.Dispose);e.testElement=null};this.Type=t.StyleType;for(var r in t.StyleType)for(var i in t.StyleType[r]){var s=t.StyleType[r][i],o=null==s.jsId?i:s.jsId;if(""!==o&&(null==s.cssId||""==s.cssId)){s.cssId=n.JsGridUtil.Internal.DomElement.GetInstance().DashNameFromCamelName(o);s.jsId=o}}window.addEventListener("unload",this.Dispose)}e.getInstance=function(){e._instance||(e._instance=new e);return e._instance};e.prototype.CreateStyleObject=function(e){var t={};for(var n in e)t[n]=null;return t};e.prototype.CreateReadOnlyCellStyle=function(){return{textColor:null}};e.prototype.MakeHeaderStyleCollection=function(){var e=this,n=function(n){var r=e.CreateStyleObject(t.StyleType.Header);r.type=n;return r};return{normal:n(l),normalHover:n(p),partSelected:n(c),partSelectedHover:n(d),allSelected:n(h),allSelectedHover:n(v)}};e.prototype.MakeSplitterStyleCollection=function(){return{normal:this.CreateStyleObject(t.StyleType.Splitter),normalHandle:this.CreateStyleObject(t.StyleType.SplitterHandle),hover:this.CreateStyleObject(t.StyleType.Splitter),hoverHandle:this.CreateStyleObject(t.StyleType.SplitterHandle),drag:this.CreateStyleObject(t.StyleType.Splitter),dragHandle:this.CreateStyleObject(t.StyleType.SplitterHandle)}};e.prototype.LoadNameClassInfoFromStyle=function(e){var t={};for(var n in e){var r=null==e[n].classId?"base":e[n].classId;r in t||(t[r]={});t[r][n]=e[n]}return t};e.prototype.LoadCollectionCss=function(e,t,n){for(var r in t)null!=n[r]&&f.CreateStyleFromCss(t[r],n[r],e)};e.prototype.GetDefaultStyleMgr=function(){var e=this,r={};return{gridPaneStyle:this.CreateStyleObject(t.StyleType.GridPane),columnHeaderStyleCollection:this.MakeHeaderStyleCollection(),rowHeaderStyleCollection:this.MakeHeaderStyleCollection(),splitterStyleCollection:this.MakeSplitterStyleCollection(),defaultCellStyle:{},readOnlyCellStyle:this.CreateReadOnlyCellStyle(),readOnlyFocusedCellStyle:{},timescaleTierStyle:this.CreateStyleObject(t.StyleType.TimescaleTier),groupingStyles:[],widgetDockStyle:{},widgetDockHoverStyle:{},widgetDockPressedStyle:{},RegisterCellStyle:function(e,t){r[e]=t},GetCellStyle:function(e){return r[e]},UpdateSplitterStyleFromCss:function(e,n){for(var r in n)for(var i in n[r])f.CreateStyleFromCss(t.StyleType.Splitter,n[r][i],e[r],i)},UpdateHeaderStyleFromCss:function(e,n){for(var r in n)for(var i in n[r])f.CreateStyleFromCss(t.StyleType.Header,n[r][i],e[r],i)},UpdateGridPaneStyleFromCss:function(n,r){e.LoadCollectionCss(n,e.LoadNameClassInfoFromStyle(t.StyleType.GridPane),r)},UpdateDefaultCellStyleFromCss:function(e,r){f.CreateStyleFromCss(t.StyleType.Cell,r,e);e.textAlign="rtl"==n.JsGridUtil.Utility.GetDocumentDirection()?"right":"left"},UpdateGroupStylesFromCss:function(e,r){for(var i={},s=1;s<10;s++){i=f.CreateStyleFromCss(t.StyleType.Cell,r+s);n.JsGridUtil.Internal.IsAssocArrayEmpty(i)||e.push(i)}}}};e.prototype.InitStylesFromCSS=function(e){for(var r=n.JsGridUtil.Internal.IsFeatureEnabled(u),o=[[e.gridPaneStyle,e.UpdateGridPaneStyleFromCss,null,{base:r?s.msGrid:"ms-grid",link:r?s.msGridLink:"ms-grid-link",selection:r?s.msGridSelection:"ms-grid-selection",readOnlySelection:r?s.msGridSelectionReadonly:"ms-grid-selection-readonly",edit:r?s.msGridEdit:"ms-grid-edit"}],[e.columnHeaderStyleCollection,e.UpdateHeaderStyleFromCss,null,{normal:{base:r?s.msGridColHeaderNormal:"ms-grid-col-header-normal",elementColor:r?s.msGridColHeaderElemBgColorsNormal:"ms-grid-col-header-elem-bg-colors-normal",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsNormal:"ms-grid-col-header-elem-hover-bg-colors-normal",elementClickColor:r?s.msGridColElemColorsClickNormal:"ms-grid-col-elem-colors-click-normal"},normalHover:{base:r?s.msGridColHeaderNormalHover:"ms-grid-col-header-normal-hover",elementColor:r?s.msGridColHeaderElemBgColorsNormalHover:"ms-grid-col-header-elem-bg-colors-normal-hover",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsNormalHover:"ms-grid-col-header-elem-hover-bg-colors-normal-hover",elementClickColor:r?s.msGridColElemColorsClickNormalHover:"ms-grid-col-elem-colors-click-normal-hover"},partSelected:{base:r?s.msGridColHeaderPartSelected:"ms-grid-col-header-part-selected",elementColor:r?s.msGridColHeaderElemBgColorsPartSelected:"ms-grid-col-header-elem-bg-colors-part-selected",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsPartSelected:"ms-grid-col-header-elem-hover-bg-colors-part-selected",elementClickColor:r?s.msGridColElemColorsClickPartSelected:"ms-grid-col-elem-colors-click-part-selected"},partSelectedHover:{base:r?s.msGridColHeaderPartSelectedHover:"ms-grid-col-header-part-selected-hover",elementColor:r?s.msGridColHeaderElemBgColorsPartSelectedHover:"ms-grid-col-header-elem-bg-colors-part-selected-hover",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsPartSelectedHover:"ms-grid-col-header-elem-hover-bg-colors-part-selected-hover",elementClickColor:r?s.msGridColElemColorsClickPartSelectedHover:"ms-grid-col-elem-colors-click-part-selected-hover"},allSelected:{base:r?s.msGridColHeaderAllSelected:"ms-grid-col-header-all-selected",elementColor:r?s.msGridColHeaderElemBgColorsAllSelected:"ms-grid-col-header-elem-bg-colors-all-selected",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsAllSelected:"ms-grid-col-header-elem-hover-bg-colors-all-selected",elementClickColor:r?s.msGridColElemColorsClickAllSelected:"ms-grid-col-elem-colors-click-all-selected"},allSelectedHover:{base:r?s.msGridColHeaderAllSelectedHover:"ms-grid-col-header-all-selected-hover",elementColor:r?s.msGridColHeaderElemBgColorsAllSelectedHover:"ms-grid-col-header-elem-bg-colors-all-selected-hover",elementHoverColor:r?s.msGridColHeaderElemHoverBgColorsAllSelectedHover:"ms-grid-col-header-elem-hover-bg-colors-all-selected-hover",elementClickColor:r?s.msGridColElemColorsClickAllSelectedHover:"ms-grid-col-elem-colors-click-all-selected-hover"}}],[e.rowHeaderStyleCollection,e.UpdateHeaderStyleFromCss,null,{normal:{base:r?s.msGridRowHeaderNormal:"ms-grid-row-header-normal"},normalHover:{base:r?s.msGridRowHeaderNormalHover:"ms-grid-row-header-normal-hover"},partSelected:{base:r?s.msGridRowHeaderPartSelected:"ms-jsgrid-rowheader-partselected"},partSelectedHover:{base:r?s.msGridRowHeaderPartSelectedHover:"ms-jsgrid-rowheader-partselected"},allSelected:{base:r?s.msGridRowHeaderAllSelected:"ms-grid-row-header-all-selected"},allSelectedHover:{base:r?s.msGridRowHeaderAllSelectedHover:"ms-grid-row-header-all-selected-hover"}}],[e.splitterStyleCollection,e.UpdateSplitterStyleFromCss,null,{normal:{base:r?s.msGridSplitter:"ms-grid-splitter"},normalHandle:{base:r?s.msGridSplitterHandle:"ms-grid-splitter-handle"},hover:{base:r?s.msGridSplitterHover:"ms-grid-splitter-hover"},hoverHandle:{base:r?s.msGridSplitterHandleHover:"ms-grid-splitter-handle-hover"},drag:{base:r?s.msGridSplitterDrag:"ms-grid-splitter-drag"},dragHandle:{base:r?s.msGridSplitterHandleDrag:"ms-grid-splitter-handle-drag"}}],[e.defaultCellStyle,e.UpdateDefaultCellStyleFromCss,null,i.msGridCell],[e.readOnlyCellStyle,t.StyleType.Cell,i.msGridCellReadonly],[e.readOnlyFocusedCellStyle,t.StyleType.Cell,i.msGridCellReadonlyFocused],[e.timescaleTierStyle,t.StyleType.TimescaleTier,r?s.msGridTimescale:"ms-grid-timescale"],[e.groupingStyles,e.UpdateGroupStylesFromCss,null,"ms-grid-group"],[e.widgetDockStyle,t.StyleType.Widget,r?s.msGridWidgetDock:"jsgrid-widget-dock"],[e.widgetDockHoverStyle,t.StyleType.Widget,r?s.msGridWidgetDockHover:"jsgrid-widget-dock-hover"],[e.widgetDockPressedStyle,t.StyleType.Widget,r?s.msGridWidgetDockPressed:"jsgrid-widget-dock-pressed"]],a=0;a<o.length;a++){var l=o[a];null!=l[2]?f.CreateStyleFromCss(l[1],l[2],l[0]):l[1].apply(e,[l[0],l[3]])}return e};e.prototype.SetRTL=function(e){this._rtl=e};e.prototype.MakeJsGridStyleManager=function(){return this.InitStylesFromCSS(this.GetDefaultStyleMgr())};return e})();t.Style=m;(function(e){var r,s;e.CreateStyleFromCss=function(e,t,u,a){var f=n.JsGridUtil.Internal.IsNullOrUndefined(u)?{}:u;if(n.JsGridUtil.Internal.IsNullOrUndefined(r)){n.JsGridUtil.DebugAssert(n.JsGridUtil.Internal.IsNullOrUndefined(s));(r=document.createElement("div")).style.display="none";document.body.appendChild(r);(s=document.createElement("div")).style.display="none";document.body.appendChild(s)}n.JsGridUtil.DebugAssert(""==s.className);r.className=i.msGridBaseStyle+" "+t;for(var l in e)if(null==a||a==e[l].classId||"base"==a&&null==e[l].classId){var c=e[l].jsId;if(e[l].semanticColor)f[l]=o.semanticColors[e[l].semanticColor];else if(""!==c){var h=n.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(r,c,e[l].cssId),p=n.JsGridUtil.Internal.DomElement.GetInstance().GetComputedStyle(s,c,e[l].cssId);if("backgroundColor"!==c||h!==p){var d=n.JsGridUtil.Internal.IsNullOrUndefined(e[l].fromCss)?h:e[l].fromCss(h);null!=d&&(f[l]=d)}else f[l]="transparent"}}return f};e.CreateStyle=function(e,t){var n={};for(var r in e)null!=t[r]&&(n[r]=t[r]);return n};e.MergeCellStyles=function(e,n){var r={};for(var i in t.StyleType.Cell)r[i]=null!=e&&null!=e[i]?e[i]:n[i];return r};e.ApplyCellStyle=function(e,t){var n=e.style;null!=t.textColor&&(n.color=t.textColor);null!=t.backgroundColor&&(n.backgroundColor=t.backgroundColor);null!=t.font&&(n.fontFamily=t.font);null!=t.fontSize&&(n.fontSize=t.fontSize);null!=t.fontWeight&&(n.fontWeight=t.fontWeight);null!=t.fontStyle&&(n.fontStyle=t.fontStyle);null!=t.textAlign&&(n.textAlign=t.textAlign)};function u(e,t,r){var i=e.style;if(e.headerStyleType!==t.type){e.headerStyleType=t.type;i.backgroundColor=t.backgroundColor;if(null!=t.innerBorderColor){e.headerStyleInnerBorderString=i.borderBottom="1px solid "+t.innerBorderColor;i["border"+m.getInstance()._rtl.Right]="1px solid "+t.outerBorderColor}else e.headerStyleBorderString=i.borderBottom=i["border"+m.getInstance()._rtl.Right]="1px solid "+t.outerBorderColor;i.borderTop="0px"}var s=r&&r(e,!0);if(null!=s){var o=a(s,e);null!=t.innerBorderColor?s.style.borderBottom=o.headerStyleInnerBorderString:s.style.borderBottom=o.headerStyleBorderString}var u=r&&r(e,!1);null!=(o=null!=u?a(u,e):e).headerStyleInnerBorderString?i.borderBottom=o.headerStyleInnerBorderString:i.borderBottom=o.headerStyleBorderString;function a(e,t){n.JsGridUtil.DebugAssert(null!=e.headerStyleType||null!=t.headerStyleType);return null==e.headerStyleType?t:null==t.headerStyleType?e:e.headerStyleType>t.headerStyleType?e:t}}e.ApplyRowHeaderStyle=u;e.ApplyCornerHeaderBorderStyle=function(e,t,n){u(e,t,function(){return null})};e.ApplyHeaderInnerBorderStyle=function(e,t,n,r){e.style[t?"borderTop":"border"+r.Left]=n.headerStyleInnerBorderString};e.ApplyColumnContextMenuStyle=function(e,t){e.style.border=a(1,"solid",t.borderColor);e.style.backgroundColor=t.backgroundColor||"transparent"};e.ApplySplitterStyle=function(e,t){e.style.borderLeft=e.style.borderRight=a(1,"solid",t.outerColor);e.style.backgroundColor=t.innerColor};function a(e,t,n){return[e,"px ",t," ",n||"transparent"].join("")}e.MakeBorderString=a;e.GetCellStyleDefaultBackgroundColor=function(){return"#FFFFFF"}})(f=t.StyleUtil||(t.StyleUtil={}))});
define("Vqe",["require","exports","Lqe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t,n){this.dataPageSize=300;this.optMaxRecordCount=null;this.bConvertAllBlobsToRecords=!1;this.bKeepDataInBlobCache=!1;this.backgroundConversionSize=10;this.blobKeys=[];this.curRequestGeneration=0;this.blobConvertIdx=0;this._fnRequestData=e;this._fnConvertDataToRecords=t;this._fnComputeDataRangeRequest=n;this.InitCache()}e.prototype.ChangeKeys=function(e,t){if(e in this.recordCache){this.recordCache[t]=this.recordCache[e];delete this.recordCache[e]}if(e in this.blobCache){this.blobCache[t]=this.blobCache[e];delete this.blobCache[e]}if(e in this.columnCache){this.columnCache[t]=this.columnCache[e];delete this.columnCache[e]}for(var n=0;n<this.blobKeys.length;n++)if(e in this.blobKeys[n]){this.blobKeys[n][t]=this.blobKeys[n][e];delete this.blobKeys[n][e]}this.view.ChangeKeys(e,t);null!=this.sizeMgr&&this.sizeMgr.ChangeKeys(e,t)};e.prototype.SetDataPageSize=function(e){this.dataPageSize=e};e.prototype.GetDataPageSize=function(){return this.dataPageSize};e.prototype.GetRecordCacheSize=function(){var e,t=0;for(e in this.recordCache)t++;return t};e.prototype.GetRecordCache=function(){return this.recordCache};e.prototype.GetRawDataRecords=function(){this.ConvertBlobsToRecords()};e.prototype.SetMaxRecordCount=function(e){this.optMaxRecordCount=e;n.JsGridUtil.DebugAssert(null==this.sizeMgr||null==this.optMaxRecordCount||n.JsGridUtil.Internal.IsAssocArrayEmpty(this.recordCache));this.TryInitSizeMgr(!1)};e.prototype.GetMaxRecordCount=function(){return this.optMaxRecordCount};e.prototype.SetConvertAllBlobsToRecords=function(e){this.bConvertAllBlobsToRecords=e};e.prototype.GetConvertAllBlobsToRecords=function(){return this.bConvertAllBlobsToRecords};e.prototype.SetBackgroundConversionSize=function(e){this.backgroundConversionSize=e};e.prototype.GetBackgroundConversionSize=function(){return this.backgroundConversionSize};e.prototype.SetKeepDataInBlobCache=function(e){this.bKeepDataInBlobCache=e};e.prototype.GetKeepDataInBlobCache=function(){return this.bKeepDataInBlobCache};e.prototype.MakeRange=function(e,t){return{pos:e,count:t}};e.prototype.GetCachedRecord=function(e){e in this.blobCache&&!(e in this.recordCache)&&this.AddRecordsToCache(this._fnConvertDataToRecords(this.blobCache[e],[e]));return this.recordCache[e]};e.prototype.GetRecordsByKey=function(e,t){var r=this,i=function(){for(var t=new Array(e.length),n=0;n<e.length;n++){var i=r.view.GetPosFromKey(e[n]);if(null==i)return null;t[n]={pos:i,count:1}}return t},s=function(i){var s=r.GetRecords(i,o);if(s.recordSetComplete){var u=n.JsGridUtil.Internal.Flatten2LevelArray(s.records);setTimeout(function(){t(e,u,!0)},0)}},o=function(n,r){var o=i();r&&null!=n?s(o):t(e,null,!1)},u=i();if(null==u)return!1;s(u);return!0};e.prototype.GetRecords=function(e,t){var n=this,r=[],i=[],s=[];for(var o in e)r[o]=this.GetAvailability(e[o],s,i);this.LoadBlobs(s);if(i.length>0){var u,a,f=!0;a=function(n){f=f&&n;0==--u&&null!=t&&setTimeout(function(){t(e,f)},0)};if("function"==typeof this._fnComputeDataRangeRequest){var l=this._fnComputeDataRangeRequest(a);this.outstandingRequestRanges.AppendRangeObject(l.totalRanges[0])}else l=this.FindAndRegisterRanges(i,a);u=l.rangesToFillRequest;var c=l.totalRanges;if(c.length>0){var h=this.curRequestGeneration;this._fnRequestData(c,function(e){n.RequestResultDispatch(c,e,h)})}}return{recordSetComplete:0==i.length,records:r}};e.prototype.AddRecordsToCache=function(e){for(var t in e){var n=e[t];this.recordCache[t]=n;null!=this.sizeMgr&&this.sizeMgr.AddRecord(t);null!=this.fnApplyUpdatesToNewRecord&&this.fnApplyUpdatesToNewRecord(n);if((null==this.optMaxRecordCount||!this.bKeepDataInBlobCache)&&t in this.blobCache){delete this.blobCache[t];t in this.columnCache&&delete this.columnCache[t]}}};e.prototype.AddColumn=function(e,t,n){this.IncrementRequestGeneration();for(var r in this.recordCache)null!=t[r]?this.recordCache[r].AddFieldValue(e,t[r]):null!=n&&this.recordCache[r].AddFieldValue(e,n());for(var r in this.blobCache)if(null!=t[r]){null==this.columnCache[r]&&(this.columnCache[r]={});this.columnCache[r][e]=t[r]}};e.prototype.RemoveColumn=function(e){this.IncrementRequestGeneration();for(var t in this.recordCache)this.recordCache[t].RemoveFieldValue(e);for(var t in this.columnCache){delete this.columnCache[t][e];n.JsGridUtil.Internal.IsAssocArrayEmpty(this.columnCache[t])&&delete this.columnCache[t]}};e.prototype.ClearRecords=function(e){for(var t=0;t<e.length;t++){delete this.recordCache[e[t]];delete this.blobCache[e[t]]}};e.prototype.SetView=function(e,t){this.ClearOutstandingRequestRanges();this.view.SetViewMap(e,t)};e.prototype.GetView=function(){return this.view.GetKeys(0,this.view.GetRecordCount())};e.prototype.RecordIdxToKey=function(e){return this.view.GetKeyFromPos(e)};e.prototype.KeyToRecordIdx=function(e){return this.view.GetPosFromKey(e)};e.prototype.UpdateProperty=function(e,t,n){e.SetProp(t,n)};e.prototype.SeedInsertedRecord=function(e){e.key()in this.recordCache||(this.recordCache[e.key()]=e)};e.prototype.InsertRecord=function(e,t){this.ClearOutstandingRequestRanges();this.view.InsertRecord(e,t)};e.prototype.DeleteRecord=function(e){this.ClearOutstandingRequestRanges();this.view.DeleteRecord(e)};e.prototype.GetRecordCount=function(){return this.view.GetRecordCount()};e.prototype.IsKeyInView=function(e){return this.view.IsKeyPresent(e)};e.prototype.BulkMoveRecords=function(e,t,n){this.ClearOutstandingRequestRanges();null==n&&(n=this.view.GetRecordCount());this.view.BulkMoveRecords(e,t,n)};e.prototype.AddRawDataToCache=function(e,t,n){var r=!1;for(var i in e)if(!(e[i]in this.recordCache)){this.blobCache[e[i]]=t;r=!0}if(this.bConvertAllBlobsToRecords&&r){this.blobKeys.push(e);null!=n&&this.ConvertBlobsToRecords()}};e.prototype.AddRawViewToCache=function(e,t,n){this.AddRawDataToCache(e,t,n);this.view.SpliceView(n)};e.prototype.Clear=function(){this.InitCache()};e.prototype.ConvertBlobsToRecords=function(){if(this.blobKeys.length>0){for(var e=[];this.blobConvertIdx<this.blobKeys[0].length&&e.length<this.backgroundConversionSize;this.blobConvertIdx++)this.blobKeys[0][this.blobConvertIdx]in this.blobCache&&e.push(this.blobKeys[0][this.blobConvertIdx]);if(this.blobConvertIdx==this.blobKeys[0].length){this.blobConvertIdx=0;this.blobKeys.shift()}e.length>0&&this.AddRecordsToCache(this._fnConvertDataToRecords(this.blobCache[e[0]],e))}return this.blobKeys.length>0};e.prototype.IncrementRequestGeneration=function(){this.ClearOutstandingRequestRanges();this.curRequestGeneration++};e.prototype.ClearOutstandingRequestRanges=function(){if(null!=this.outstandingRequestRanges)for(var e=this.outstandingRequestRanges.GetAllCallbacks(),t=0;t<e.length;t++)e[t](!1);this.outstandingRequestRanges=new i};e.prototype.InitCache=function(){this.recordCache={};this.blobCache={};this.columnCache={};this.IncrementRequestGeneration();this.view=new o;this.TryInitSizeMgr(!0)};e.prototype.TryInitSizeMgr=function(e){null==this.sizeMgr||null==this.optMaxRecordCount||e?this.sizeMgr=null!=this.optMaxRecordCount?new u(20,this.optMaxRecordCount,this):null:this.sizeMgr.SetMaxSize(this.optMaxRecordCount)};e.prototype.GetAvailability=function(e,t,r){var i=e.pos,s=e.count,o=this.view.GetKeys(i,s),u=new Array(s);n.JsGridUtil.DebugAssert(i>=0&&i+s<=this.view.GetRecordCount());for(var a=0;a<s;a++){var f=o[a],l=this.recordCache[f];null!=this.sizeMgr&&this.sizeMgr.TouchRecord(f);if(null!=l)u[a]=l;else{u[a]=null;var c=this.blobCache[f];null!=c?t.push({key:f,blob:c,destArray:u,destIdx:a}):r.push({pos:i+a,key:f})}}return u};e.prototype.LoadBlobs=function(e){var t,r=[];for(var i in e){t=e[i];var s=n.JsGridUtil.Internal.Find(r,function(e){return e.blob==t.blob});if(null==s){s={blob:t.blob,keys:[]};r.push(s)}s.keys.push(t.key)}for(var i in r)this.AddRecordsToCache(this._fnConvertDataToRecords(r[i].blob,r[i].keys));for(var i in e)(t=e[i]).destArray[t.destIdx]=this.recordCache[t.key]};e.prototype.RequestResultDispatch=function(e,t,n){if(n==this.curRequestGeneration){if(null!=t)for(var r=0;r<t.length;r++)this.AddRawDataToCache(t[r].keys,t[r].data,null);for(r=0;r<e.length;r++){var i=this.outstandingRequestRanges.FindRangeObject(e[r].pos);if(null!=i){for(var s in i.callbacks)i.callbacks[s](null!=t);this.outstandingRequestRanges.RemoveRangeObject(i)}}}};e.prototype.FindAndRegisterRanges=function(e,t){for(var n,r=0,i=[],s=null,o=0;o<e.length;o++){n=e[o].pos;if(null==(s=this.outstandingRequestRanges.FindRangeObject(n))){var u=this.CreateRanges(n,.75);for(var a in u)this.outstandingRequestRanges.AppendRangeObject(u[a]);i=i.concat(u)}}s=null;for(o=0;o<e.length;o++){n=e[o].pos;if(null==s||!this.outstandingRequestRanges.IsPosInRange(n,s)){r++;null==(s=this.outstandingRequestRanges.FindRangeObject(n))&&(s={});null==s.callbacks?s.callbacks=[t]:s.callbacks.push(t)}}return{rangesToFillRequest:r,totalRanges:i}};e.prototype.CreateRanges=function(e,t){for(var n,r=250,i=250,s=e-1,o=e,u=[],a=this.dataPageSize*(1-t),f=!0,l=!0,c=!0;c&&u.length<this.dataPageSize;){c=!1;if(f&&r>0){r-=(n=this.FindMissingRecords(s,a,r,-1)).scanned;s-=n.scanned+1;f=n.shouldContinue;u=u.concat(n.positions);a=this.dataPageSize-u.length;c=!0}if(l&&i>0){i-=(n=this.FindMissingRecords(o,a,i,1)).scanned;o+=n.scanned+1;l=n.shouldContinue;u=u.concat(n.positions);a=this.dataPageSize-u.length;c=!0}}return this.MakeRangesFromList(u)};e.prototype.MakeRangesFromList=function(e){var t=[];e.sort(function(e,t){return e-t});for(var n=e.length,r=Number.NEGATIVE_INFINITY,i=null,s=0;s<n;s++){if(e[s]!==r+1){i=this.MakeRange(e[s],1);t.push(i)}else i.count++;r=e[s]}return t};e.prototype.FindMissingRecords=function(e,t,n,r){for(var i,s={positions:[],shouldContinue:!0,scanned:0},o=this.view.GetRecordCount(),u=0;u<n;u++){if((i=e+u*r)<0||i>o){s.shouldContinue=!1;break}var a=this.view.GetKeyFromPos(i);if(!(a in this.recordCache||a in this.blobCache||null!=this.outstandingRequestRanges.FindRangeObject(i))){s.positions.push(i);if(--t<=0)break}}s.scanned=u;return s};return e})();t.TableCache=r;var i=(function(){function e(){this.ranges=[]}e.prototype.FindRangeObject=function(e){var t=null,n=this.FindRangeIdx(e);n<this.ranges.length&&this.IsPosInRange(e,this.ranges[n])&&(t=this.ranges[n]);return t};e.prototype.AppendRangeObject=function(e){var t=this.FindRangeIdx(e.pos);this.ranges.splice(t,0,e)};e.prototype.RemoveRangeObject=function(e){var t=this.FindRangeIdx(e.pos);n.JsGridUtil.DebugAssert(0==this.GetRangePosInfo(e.pos,this.ranges[t]));this.ranges.splice(t,1)};e.prototype.IsPosInRange=function(e,t){return 0==this.GetRangePosInfo(e,t)};e.prototype.IsEmpty=function(){return 0==this.ranges.length};e.prototype.GetAllCallbacks=function(){for(var e=[],t=0;t<this.ranges.length;t++)null!=this.ranges[t].callbacks&&(e=e.concat(this.ranges[t].callbacks));return e};e.prototype.FindRangeIdx=function(e){var t=this;return n.JsGridUtil.Internal.LowerBoundCompare(this.ranges,e,function(e,n){return t.GetRangePosInfo(n,t.ranges[e])})};e.prototype.GetRangePosInfo=function(e,t){return e<t.pos?1:t.pos+t.count<=e?-1:0};return e})(),s=(function(){function e(){this.bIsFakeKey=1}e.prototype.toString=function(){null==this.tempKey&&(this.tempKey="TempKey"+this.tempKeyIdx++);return this.tempKey};return e})(),o=(function(){function e(){}e.prototype.SetViewMap=function(e,t){this.keyPosMap=null;if(null!=t){n.JsGridUtil.DebugAssert(e.length<=t);this.posKeyMap=new Array(t);for(var r=0;r<e.length;r++)this.posKeyMap[r]=e[r];for(r=e.length;r<t;r++)this.posKeyMap[r]=new s}else this.posKeyMap=e};e.prototype.ChangeKeys=function(e,t){null==this.keyPosMap&&this.InitKeyPosMap();if(e in this.keyPosMap){this.keyPosMap[t]=this.keyPosMap[e];delete this.keyPosMap[e];this.posKeyMap[this.keyPosMap[t]]=t}};e.prototype.GetKeys=function(e,t){for(var n=new Array(t),r=0;r<t;r++)n[r]=this.GetKeyFromPos(e+r);return n};e.prototype.InsertRecord=function(e,t){this.posKeyMap.splice(e,0,t);this.keyPosMap=null};e.prototype.DeleteRecord=function(e){this.posKeyMap.splice(e,1);this.keyPosMap=null};e.prototype.BulkMoveRecords=function(e,t,n){var r=t-e+1,i=this.posKeyMap.splice(e,r);n=n<e?n:n-r;Array.prototype.splice.apply(this.posKeyMap,[n,0].concat(i));this.keyPosMap=null};e.prototype.SpliceView=function(e){for(var t in e)this.InsertRecord(t+this.GetRecordCount(),e[t])};e.prototype.GetRecordCount=function(){return null!=this.posKeyMap?this.posKeyMap.length:0};e.prototype.IsKeyPresent=function(e){null==this.keyPosMap&&this.InitKeyPosMap();return e in this.keyPosMap};e.prototype.GetKeyFromPos=function(e){var t;null!=this.posKeyMap&&(t=this.posKeyMap[e]);return t};e.prototype.GetPosFromKey=function(e){null==this.keyPosMap&&this.InitKeyPosMap();return e in this.keyPosMap?this.keyPosMap[e]:null};e.prototype.InitKeyPosMap=function(){this.keyPosMap={};for(var e=this.posKeyMap.length-1;e>=0;e--)this.keyPosMap[this.posKeyMap[e]]=e};return e})(),u=(function(){function e(e,t,r){this.generationOrder=[];this.generationCountMap={};this.numberOfRecordsToProcessPerTimeout=10;this.recordList=[];this.recordGenerationMap={};this.pageCount=0;n.JsGridUtil.DebugAssert(e<=t/5);this._genSize=e;this._maxSize=t;this.tableCache=r;this.Init()}e.prototype.ChangeKeys=function(e,t){if(e in this.recordGenerationMap){this.recordGenerationMap[t]=this.recordGenerationMap[e];delete this.recordGenerationMap[e]}};e.prototype.Init=function(){var e=this,t=function(t){var n=e.GenerateGenerationName();e.generationOrder.push(n);e.generationCountMap[n]=0};this.deleteQuota=new a(this.RemoveFromGeneration,this);t();t();this.curInsertIdx=0};e.prototype.GenerateGenerationName=function(){return this.pageCount++};e.prototype.IncrementRecordCount=function(e){var t=this.deleteQuota.TotalRemaingToDelete(),n=this.recordList.length-this._maxSize-t;n>0&&this.deleteQuota.AddToDeleteCount(n+this._genSize);this.recordList.push(e)};e.prototype.AddRecord=function(e){if(null==this.recordGenerationMap[e]){this.curInsertIdx=this.AddToGeneration(e,this.curInsertIdx,Math.ceil((this.generationOrder.length-1)/2));this.IncrementRecordCount(e)}};e.prototype.SetMaxSize=function(e){this._maxSize=e};e.prototype.TouchRecord=function(e){if(this.recordGenerationMap[e]!==this.generationOrder[this.generationOrder.length-1]){null!=this.recordGenerationMap[e]?this.RemoveFromGeneration(e):this.IncrementRecordCount(e);this.AddToGeneration(e,this.generationOrder.length-1,null)}};e.prototype.AddToGeneration=function(e,t,n){if(this.generationCountMap[this.generationOrder[t]]==this._genSize){var r=this.GenerateGenerationName();t=null!=n?n:t+1;this.generationOrder.splice(t,0,r);this.generationCountMap[r]=0}this.generationCountMap[this.generationOrder[t]]++;this.recordGenerationMap[e]=this.generationOrder[t];return t};e.prototype.RemoveFromGeneration=function(e){var t=this.recordGenerationMap[e];if(1==this.generationCountMap[t]){for(var r=0;r<this.generationOrder.length&&this.generationOrder[r]!=t;r++);n.JsGridUtil.DebugAssert(r!==this.generationOrder.length);delete this.generationCountMap[t];this.generationOrder.splice(r,1);this.recordGenerationMap[e]=-1}else this.generationCountMap[t]--};return e})(),a=(function(){function e(e,t){this.toDeleteCount=0;this.nScheduledForDeletion=0;this.curPos=0;this._fnRemoveRecordFromGen=e;this._tableSizeManager=t}e.prototype.AddToDeleteCount=function(e){n.JsGridUtil.AsynchronousTaskManager.GetInstance().TaskRegistered(this.processKey)||(this.processKey=n.JsGridUtil.AsynchronousTaskManager.GetInstance().RegisterTask(this.DeleteRecords));this.toDeleteCount=this.ComputeGensToDelete(this.nScheduledForDeletion+e)};e.prototype.TotalRemaingToDelete=function(){return this.nScheduledForDeletion};e.prototype.ComputeGensToDelete=function(e){this.gensToDelete={};this.nScheduledForDeletion=0;for(var t=0;t<this._tableSizeManager.generationOrder.length-3&&this.nScheduledForDeletion<e;t++){this.nScheduledForDeletion+=this._tableSizeManager.generationCountMap[this._tableSizeManager.generationOrder[t]];this.gensToDelete[this._tableSizeManager.generationOrder[t]]=null}};e.prototype.DeleteRecords=function(){for(var e=0;e<this._tableSizeManager.numberOfRecordsToProcessPerTimeout;e++)if(this._tableSizeManager.recordGenerationMap[this._tableSizeManager.recordList[this.curPos]]in this.gensToDelete){var t=this._tableSizeManager.recordList[this.curPos],n=this._tableSizeManager.recordGenerationMap[t];delete this._tableSizeManager.tableCache.recordCache[t];1==this._tableSizeManager.generationCountMap[n]&&delete this.gensToDelete[n];this._fnRemoveRecordFromGen(t);delete this._tableSizeManager.recordGenerationMap[t];this._tableSizeManager.recordList.splice(this.curPos,1);this.nScheduledForDeletion--}else this.curPos=(this.curPos+1)%(this._tableSizeManager.recordList.length-1);return 0!==this.nScheduledForDeletion};return e})()});
define("tQe",["require","exports","o","r","Lqe","Dqe","nQe","Eqe","Nqe","od","ld","aV","k","Oqe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";d=d.tablemgr_9;Object.defineProperty(t,"__esModule",{value:!0});t.tearDownStickyColumnKillswitchIsActive=h.Killswitch.isActivated("240CA0AF-7931-4C5F-A2E8-5970CC5D1434","07/10/2020","turn off sticky column if the window becomes too small to support it");t.extraSpacerColumnsKillswitchIsActive=h.Killswitch.isActivated("d53e19a7-5114-4a07-b430-991910d21dac","07/24/2020","add extra columns to quickedit for spacing for WebViewList, aka List App view");var v=h.Killswitch.isActivated("0A111CEE-8DE5-4D5A-8ABF-564CA178EE70","8/05/2020","Adding a data-error-message attribute for required fields with errors."),m=h.Killswitch.isActivated("61E4C9DD-4B72-4C41-B0FC-3E843EF4D2E7","8/20/2020","Fix the sticky left edge in Lists home."),g={ODB:1725},y={ODB:1439},b={ODB:1757},w={ODB:1198},E={ODB:60017};t.FIELD_TITLE_SPAN_CLASSNAME="ms-DetailsHeader-cellName";var S=(function(){function e(e,t,n,r,s,u,a,f,c,h,p,v,g){var y=this;this.leftmostColIdx=0;this.columns=[];this.rowRecords=[];this.tableColCount=0;this.loadingRects=[];this.errorDivs={};this.rowHeaderStateDivs={};this.tableMgr=this;this.tdCoordsHorizontalAdjustment=null;this.rowCoordCache=[];this.colCoordCache=[];this.fieldsWithErrors={};this.CellType={SelectAllSquare:0,RowHeader:1,ColumnHeader:2,Cell:3};this._assessedTableHeight=!1;this.HandleWindowResize=function(){var e=i.JsGridUtil.Internal.noSizeForSticky;if(i.JsGridUtil.Internal.GetStickyDataColumnsWidth(y.columns)+i.JsGridUtil.Internal.stickyLeftEdgeOffset>i.JsGridUtil.Internal.GetScrollParent(y._parentDiv).clientWidth/2){i.JsGridUtil.Internal.noSizeForSticky=!0;if(e!=i.JsGridUtil.Internal.noSizeForSticky){y._stickyLeftEdgeKeeperContainer.parentElement.removeChild(y._stickyLeftEdgeKeeperContainer);y._objBag.paneMgr.UpdateColumns(y._objBag.paneMgr.gridPane.allColumns);for(var t=document.getElementsByClassName(d.gridStickyCheckColumn);t.length>0;){t[0].classList.remove(d.gridStickyChromeLeft);t[0].classList.remove(d.gridStickyCheckColumn)}var n=y._objBag.paneMgr.gridPane.selectionDragHandle,r=n.parentElement;r.removeChild(n);var s=y._objBag.paneMgr.CreateDragHandle();r.insertBefore(s,r.children[0]);y._objBag.paneMgr.gridPane.selectionDragHandle=s;y._objBag.paneMgr.gridPane.UpdateSelectionFrames()}}if(!m){var o=y.GetProperTableHeight().toString()+"px";y._stickyLeftEdgeKeeper.style.height=o;y._stickyColumnShadow.style.height=o}};this._parentDiv=e;this._baseId=t;this._paneSize=n;this._fnGetLocStr=r;this._objBag=s;this._fnInsertedRow=u;this._fnInsertedColumns=a;this._fnRemovedColumns=f;this._fnRemovedHeaderCell=c;this._fnSetHeaderHeight=h;this._fnPopulateCell=p;this._fnRetryErrorRows=v;this._fnTryDisposeRow=g;this.cellErrorJobKey=i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterJob(this.AddOrUpdateCellError.bind(this));this.paneConverter=new o.GridPaneConverter(s);this.ariaMgr=s.ariaMgr;this.renderCtx=s.jsGridObj.GetSpCsrRenderCtx();this.selectionMgr=s.selectionMgr;this._selectionCircleIcon=l.getIcon("CircleRing");this._selectionCheckmarkIcon=l.getIcon("StatusCircleCheckmark");this._addNewItemIcon=l.getIcon("Add");this.Init()}e.prototype.GetGridPaneConverter=function(){return this.paneConverter};e.prototype.Dispose=function(){i.JsGridUtil.Internal.IsStickyColumnFlightEnabled()&&(t.tearDownStickyColumnKillswitchIsActive||window.removeEventListener("resize",this.HandleWindowResize));this.DisposeLoadingRects();this.tableElem=this._parentDiv=null};e.prototype.SetPosConverterObj=function(e){this.posConverter=e;this.paneConverter.SetPosConverterObj(e)};e.prototype.GetHeaderHeight=function(){i.JsGridUtil.DebugAssert(0!==this.tableElem.rows.length);return this.tableElem.rows[0].offsetHeight};e.prototype.SetHeaderHeight=function(e){this.headerHeight=e;if(this.tableElem.rows.length>0){this.tableElem.rows[0].style.height=this.headerHeight-1+"px";this._fnSetHeaderHeight(this.headerHeight)}};e.prototype.SetRowHeight=function(e){this.rowHeight=i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIEAndRenderingModeIs7?e-1:e};e.prototype.GetTdDefaultCssText=function(){return this.styleForTd};e.prototype.InitTable=function(e){var o=this;this.ClearTable();this.tableColCount=0;this.bRowHeadersEnabled=e;this.tableColIdxOfFirstDataCol=this.bRowHeadersEnabled?1:0;var u,a=i.JsGridUtil.Internal.IsFeatureEnabled(g),l=i.JsGridUtil.Internal.IsFeatureEnabled(y),c=this.tableElem.insertRow(-1);c.recordKey="__colheaders";this.ariaMgr.OnInsertTableRow(c,null,-1);if(this.bRowHeadersEnabled){var h=document.createElement("th");h.scope="col";h.nowrap="nowrap";if(a){h.className=d.gridSelectAllIconContainer;var v=this.renderCtx&&this.renderCtx.ListSchema&&this.renderCtx.ListSchema.Field,m=(v?v.length:0)+2,b=s.JsGridConstants.Internal.zIndex.tableHeader+m;h.style.zIndex=b}else{h.className=d.spGridSelectAllIconContainer;h.style.borderBottom="1px solid "+this._objBag.styleMgr.gridPaneStyle.horizontalBorderColor}if(l&&a){h.classList.add(d.selectAllCheckMarkCell);h.innerHTML=this.GetSelectionCheckElement("all")}else n.render(r.createElement(f.Icon,{iconName:"CheckMark",className:d.spGridSelectAllIcon}),h);var w=document.createElement("div");w.setAttribute("colid","dropHint");if(a){w.style.position="absolute";w.style.right="1px";w.style.top="2px"}else{w.style.cssFloat=this._objBag.RTL.right;w.style.position="relative";w.style.left="1px";w.style.top="7px"}w.style.zIndex="1";n.render(this._objBag.dragDropMgr.renderDropHint(0),w);h.appendChild(w);if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){h.classList.add(d.gridStickyCheckColumn);h.classList.add(d.gridStickyCheckColumnHeader);i.JsGridUtil.Internal.stickyChromeless?h.classList.add(d.gridStickyChromelessLeft):h.classList.add(d.gridStickyChromeLeft)}this.tableElem.rows[0].appendChild(h);this.tableColCount++;u=new x(0,0,this);if(a&&!i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive){this.ariaMgr.OnInsertColHeaderCell(h);h.setAttribute("aria-label",p.default.selectAllRowsCell);h.addEventListener("keydown",function(e){var t,n=o._objBag.focusMgr,r=null===(t=n)||void 0===t?void 0:t._gridPane;if(r){if(e.keyCode===s.JsGridConstants.Key.enter||e.keyCode===s.JsGridConstants.Key.space){r.SelectAllRows();n.Focus()}(e.keyCode===s.JsGridConstants.Key.right||e.keyCode===s.JsGridConstants.Key.tab&&!e.shiftKey)&&r.SetFocusToHeader(1);if(e.keyCode===s.JsGridConstants.Key.down){o.selectionMgr.SetFocusByPos(r,0,-1);n.Focus()}i.JsGridUtil.Internal.IsFeatureEnabled(E)&&e.keyCode===s.JsGridConstants.Key.tab&&e.shiftKey&&e.preventDefault();if(i.JsGridUtil.Internal.IsFeatureEnabled(E)&&e.keyCode===s.JsGridConstants.Key.esc){r.HideFocusStyles();r.ScrollCellIntoView(0,0);n._gridFocusEntryPoint.focus()}if(e.keyCode===s.JsGridConstants.Key.enter||e.keyCode===s.JsGridConstants.Key.space||e.keyCode===s.JsGridConstants.Key.right||e.keyCode===s.JsGridConstants.Key.down||e.keyCode===s.JsGridConstants.Key.tab&&!e.shiftKey){e.preventDefault();e.stopPropagation()}}})}else this.ariaMgr.OnInsertRowHeaderCell(h)}c.className="ms-viewheadertr ms-vhltr";c.classList.add(d.tableColumnHeadersRow);c.vAlign="top";if(!t.extraSpacerColumnsKillswitchIsActive){var S=document.createElement("th");S.setAttribute("role","presentation");S.classList.add("ms-listview-columnSpacer");var T=document.createElement("th");T.setAttribute("role","presentation");T.classList.add("ms-listview-lastColumn");this.tableElem.rows[0].appendChild(S);this.tableElem.rows[0].appendChild(T)}return u};e.prototype.SetColumns=function(e,t){i.JsGridUtil.Internal.IsStickyColumnEnabled()&&(e.length&&"DocIcon"===e[0].internalName?i.JsGridUtil.Internal.stickyLastColIdx=1:i.JsGridUtil.Internal.stickyLastColIdx=0);if(this.columns.length){this.RemoveTableColumns(this.tableColIdxOfFirstDataCol,this.GetDataColCount());this.leftmostColIdx=0}this.columns=e;t?this.paneConverter.SetView(this.columns):this.paneConverter.NotifyColumnsChanged(this.columns);this.OptimizeTableColumns()};e.prototype.ClearTable=function(){this.rowRecords.length>0&&this.SpliceRows(0,this.rowRecords.length,null,0);this.RemoveTableColumns(this.tableColIdxOfFirstDataCol,this.GetDataColCount());this.leftmostColIdx=0;for(;this.tableElem.rows.length>0;)this.tableElem.deleteRow(0);i.JsGridUtil.DebugAssert(0==this.tableElem.rows.length)};e.prototype.SpliceRows=function(e,t,n,r){var i=r.length,s=i>1;s&&this._parentDiv.removeChild(this.tableElem);if(null!=e&&0!==t){this.rowRecords.splice(e,t);for(var o=t-1;o>=0;o--)this.DeleteTableRow(e+o)}if(null!=n&&0!==i){Array.prototype.splice.apply(this.rowRecords,[n,0].concat(r));for(o=0;o<i;o++)this.InsertTableRow(n+o,this.rowRecords[n+o],s)}s&&this._parentDiv.appendChild(this.tableElem);this.RefreshLoadingRects()};e.prototype.RenderRows=function(e){for(var t in e){var n=e[t],r=parseInt(t,10);this.DeleteTableRow(r);this.rowRecords[r]=n;this.InsertTableRow(r,n)}i.JsGridUtil.Internal.IsAssocArrayEmpty(e)||(this.rowRecords=[].concat(this.rowRecords));this.RefreshLoadingRects()};e.prototype.InsertColumns=function(e,t){var n=this.ColIdxToTableColIdx(e);Array.prototype.splice.apply(this.columns,[e,0].concat(t));this.paneConverter.NotifyColumnsChanged(this.columns);n>=this.tableColIdxOfFirstDataCol&&n<=this.tableColCount&&this.InsertTableColumns(n,t.length);for(var r=0;r<t.length;r++)for(var i=t[r],s=0;s<this.rowRecords.length;s++)if(null==this.rowRecords[s].properties[i.columnKey]){var o=this._objBag.tableCache.GetCachedRecord(s);if(null!=o){var a=o.GetProp(i.columnKey);null!=a&&(this.rowRecords[s].properties[i.columnKey]=u.PropertyType.Property.prototype.MakeProperty(void 0,void 0,a.HasDataValue(),a.HasLocalizedValue(),a.propType))}}this.OptimizeTableColumns()};e.prototype.RefreshCell=function(e){var t=e.GetRecordKey(),n=e.GetFieldKey();this.ClearCellError(t,n);e.GetTd().innerHTML="";this._fnPopulateCell(e);this.UpdateCoordCache();this._objBag.errorMgr.CellHasError(t,n)&&this.AddOrUpdateCellError(t,n)};e.prototype.RemoveColumns=function(e,t){var n=this.ColIdxToTableColIdx(e);if(n>=this.tableColIdxOfFirstDataCol&&n<this.tableColCount){var r=t;n+t>this.tableColCount&&(r-=n+t-this.tableColCount);this.RemoveTableColumns(n,r)}this.columns.splice(e,t);this.paneConverter.NotifyColumnsChanged(this.columns);this.OptimizeTableColumns()};e.prototype.ScrollColumns=function(e){var t=this.CalcOptimalDataColumnCount(e),n=this.GetDataColCount(),r=this.leftmostColIdx;this.UpdateCoordCache();if(e>r){this.RemoveTableColumns(this.tableColIdxOfFirstDataCol,Math.min(n,e-r));this.leftmostColIdx=e}else if(e<r){this.leftmostColIdx=e;this.InsertTableColumns(this.tableColIdxOfFirstDataCol,Math.min(t,r-e))}this.OptimizeTableColumns()};e.prototype.ChangeKeys=function(e,t){if(this.paneConverter.IsRecordOnScreen(e))for(var n=this.tableElem.rows.length-1;n>=0;n--)if(this.tableElem.rows[n].recordKey==e){this.tableElem.rows[n].recordKey=t;break}if(e in this.errorDivs){this.errorDivs[t]=this.errorDivs[e];delete this.errorDivs[e]}if(e in this.rowHeaderStateDivs){this.rowHeaderStateDivs[t]=this.rowHeaderStateDivs[e];delete this.rowHeaderStateDivs[e]}};e.prototype.OptimizeTableColumns=function(){var e=this.CalcOptimalDataColumnCount(this.leftmostColIdx),n=this.GetDataColCount()-e;if(n<0)this.InsertTableColumns(this.tableColCount,-n);else if(n>0)this.RemoveTableColumns(this.tableColCount-n,n);else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){if(!this._stickyLeftEdgeKeeperContainer){this._stickyLeftEdgeKeeperContainer=document.createElement("DIV");var r="StickyLeftEdgeKeeperContainer";i.JsGridUtil._spClientStickyColumnFixKillSwitchIsActive||(r+=this._objBag.gridId);this._stickyLeftEdgeKeeperContainer.id=r;this._stickyLeftEdgeKeeperContainer.classList.add(d.stickyLeftEdgeKeeperContainer);i.JsGridUtil.Internal.stickyChromeless?this._stickyLeftEdgeKeeperContainer.classList.add(d.stickyLeftEdgeKeeperContainerChromeless):this._stickyLeftEdgeKeeperContainer.classList.add(d.stickyLeftEdgeKeeperContainerWithChrome);this._stickyLeftEdgeKeeper=document.createElement("DIV");var s="StickyLeftEdgeKeeper";i.JsGridUtil._spClientStickyColumnFixKillSwitchIsActive||(s+=this._objBag.gridId);this._stickyLeftEdgeKeeper.id=s;this._stickyLeftEdgeKeeper.classList.add(d.stickyLeftEdgeKeeper);i.JsGridUtil.Internal.stickyChromeless?this._stickyLeftEdgeKeeper.classList.add(d.stickyLeftEdgeKeeperChromeless):this._stickyLeftEdgeKeeper.classList.add(d.stickyLeftEdgeKeeperWithChrome);this._stickyLeftEdgeKeeper.style.height=this.GetProperTableHeight().toString()+"px";this._stickyLeftEdgeKeeperContainer.appendChild(this._stickyLeftEdgeKeeper);this._stickyColumnShadow=document.createElement("DIV");var o="StickyColumnShadow";i.JsGridUtil._spClientStickyColumnFixKillSwitchIsActive||(o+=this._objBag.gridId);this._stickyColumnShadow.id=o;this._objBag.RTL.bEnabled?this._stickyColumnShadow.className=d.stickyColumnShadowRtl:this._stickyColumnShadow.className=d.stickyColumnShadow;this._stickyColumnShadow.style.height=this.GetProperTableHeight().toString()+"px";this._stickyColumnShadow.style.opacity="0";this._stickyColumnShadow.style.visibility="hidden";this._stickyLeftEdgeKeeperContainer.appendChild(this._stickyColumnShadow);this._parentDiv.insertBefore(this._stickyLeftEdgeKeeperContainer,this._parentDiv.children[0])}this.UpdateLeftEdgeKeeperSizes()}else i.JsGridUtil.Internal.IsStickyColumnFlightEnabled()&&i.JsGridUtil.Internal.noSizeForSticky&&(t.tearDownStickyColumnKillswitchIsActive||this._stickyLeftEdgeKeeperContainer&&this._stickyLeftEdgeKeeperContainer.parentElement.removeChild(this._stickyLeftEdgeKeeperContainer));this.RefreshLoadingRects()};e.prototype.UpdateErrorFrames=function(){for(var e in this.errorDivs)for(var t in this.errorDivs[e])this.AddOrUpdateCellError(e,t,!0)};e.prototype.GetAllDataCells=function(){for(var e=[],t=1;t<this.tableElem.rows.length;t++)for(var n=this.tableColIdxOfFirstDataCol;n<this.tableColCount;n++)e.push(new x(t,n,this));return e};e.prototype.GetSelectAllSquare=function(){return this.bRowHeadersEnabled?new x(0,0,this):null};e.prototype.GetRowHeaderByKey=function(e){if(this.bRowHeadersEnabled&&this.paneConverter.IsRecordOnScreen(e))return new x(this.RowIdxToTableRowIdx(this.paneConverter.GetTopRowIdxForKey(e)),0,this)};e.prototype.GetRowHeader=function(e){if(this.bRowHeadersEnabled){var t=new x(this.RowIdxToTableRowIdx(e),0,this,!0,!1);return t.bIsInvalid?null:t}return null};e.prototype.GetRowHeaders=function(){var e=[];if(this.bRowHeadersEnabled)for(var t=this.tableElem.rows.length,n=1;n<t;n++)e.push(new x(n,0,this));return e};e.prototype.GetColumnHeader=function(e){var t=new x(0,this.ColIdxToTableColIdx(e),this,!0,!1);return t.bIsInvalid||null==t.GetColIdx()?null:t};e.prototype.GetColumnHeaders=function(){for(var e=[],t=this.tableColIdxOfFirstDataCol;t<this.tableColCount;t++)e.push(new x(0,t,this));return e};e.prototype.GetColumnHeaderTr=function(){return this.tableElem.rows[0]};e.prototype.GetRowHeaderWidth=function(){return this.bRowHeadersEnabled?i.JsGridUtil.Internal.IsFeatureEnabled(g)?s.JsGridConstants.Internal.RowHeaderWidthNewStyles:s.JsGridConstants.Internal.RowHeaderWidth:0};e.prototype.GetRowIdxColIdxFromCoord=function(e){for(var t=i.JsGridUtil.Internal.DomElement.GetInstance().GetEventLocation(e),n={},r=this.tableElem.rows,s=1;s<r.length;s++){var o=r[s],u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(o);if(t.y>=u.y&&t.y<u.y+o.offsetHeight){n.rowIdx=this.TableRowIdxToRowIdx(s);n.top=u.y;n.bottom=u.y+o.offsetHeight;break}}var a=this.tableElem.rows[0].cells;for(s=this.bRowHeadersEnabled?1:0;s<a.length;s++){var f=a[s];u=i.JsGridUtil.Internal.DomElement.GetInstance().GetLocation(f);if(t.x>=u.x&&t.x<u.x+f.offsetWidth){n.colIdx=this.TableColIdxToColIdx(s);n.left=u.x;n.right=u.x+f.offsetWidth;break}}return n};e.prototype.UpdateCoordCache=function(){this._objBag.bUpdateCoordCache=!0};e.prototype.ResizeColCoordCache=function(e,t){var n,r=this.colCoordCache[e];if(null!=r){if(0!=(n=(t+=1)-r.width)){r.width=t;this._objBag.RTL.bEnabled?r.left+=n:r.right+=n;for(var s=e+1;s<this.colCoordCache.length;s++)if(null!=(r=this.colCoordCache[s])){r.left+=n;r.right+=n}i.JsGridUtil.Internal.IsStickyColumnEnabled()&&1===e&&this._stickyLeftEdgeKeeper&&this.tableElem&&this.UpdateLeftEdgeKeeperSizes()}}else this.ClearColCoordCache(e)};e.prototype.GetTdCoords=function(e){var t={},n=e.cellIndex,r=e.parentNode.rowIndex;this.UpdateCoordCacheInternal();if(!0!==window.disableGetTdCoordsCache&&null!=this.rowCoordCache[r])this.CopyRowCoords(r,t);else{t.top=this.tableElem.offsetTop+e.offsetTop-1;t.bottom=this.tableElem.offsetTop+e.offsetTop+e.offsetHeight;t.height=t.bottom-t.top;this.InsertIntoCoordCacheArray(this.rowCoordCache,r,this.CloneRowCoords(t))}if(!0!==window.disableGetTdCoordsCache&&null!=this.colCoordCache[n])this.CopyColCoords(n,t);else{if(this._objBag.RTL.bEnabled)if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n==i.JsGridUtil.Internal.stickyLastColIdx+1&&e.nextElementSibling){var s=e.nextElementSibling;t.left=this.tableElem.offsetLeft+(s.offsetLeft-e.offsetWidth);t.right=this.tableElem.offsetLeft+s.offsetLeft+1}else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&1==n&&e.nextElementSibling&&e.nextElementSibling.nextElementSibling){var o=(u=e.nextElementSibling).nextElementSibling;t.left=this.tableElem.offsetLeft+(o.offsetLeft-u.offsetWidth-e.offsetWidth);t.right=t.left+e.offsetWidth+1}else{t.left=this.tableElem.offsetLeft+e.offsetLeft;t.right=this.tableElem.offsetLeft+e.offsetLeft+e.offsetWidth+1}else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&n==i.JsGridUtil.Internal.stickyLastColIdx+1&&e.nextElementSibling){s=e.nextElementSibling;t.left=this.tableElem.offsetLeft+(s.offsetLeft-e.offsetWidth-2);t.right=this.tableElem.offsetLeft+s.offsetLeft}else if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&1==n&&e.nextElementSibling&&e.nextElementSibling.nextElementSibling){var u;o=(u=e.nextElementSibling).nextElementSibling;t.left=this.tableElem.offsetLeft+(o.offsetLeft-u.offsetWidth-e.offsetWidth);t.right=t.left+e.offsetWidth+1}else{t.left=this.tableElem.offsetLeft+e.offsetLeft-1;t.right=this.tableElem.offsetLeft+e.offsetLeft+e.offsetWidth}if(null!=e.previousSibling){if(null==this.tdCoordsHorizontalAdjustment){var a=this.tableElem.rows[0].cells,f=a[this._objBag.RTL.bEnabled?0:a.length-1],l=f.offsetWidth-(i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIEAndRenderingModeIs7&&!this._objBag.RTL.bEnabled?1:0);this.tdCoordsHorizontalAdjustment=this.tableElem.offsetWidth-(f.offsetLeft+l)}t.left+=this.tdCoordsHorizontalAdjustment;t.right+=this.tdCoordsHorizontalAdjustment}t.width=t.right-t.left;this.InsertIntoCoordCacheArray(this.colCoordCache,n,this.CloneColCoords(t))}return t};e.prototype.GetCellByKey=function(e,t){if(!this.posConverter.IsRecordOnScreen(e))return null;var n=this.paneConverter.KeyToIdx(e,t);return n&&this.GetCellByIdx(n.rowIdx,n.colIdx)};e.prototype.GetCellByIdx=function(e,t){var n=new x(this.RowIdxToTableRowIdx(e),this.ColIdxToTableColIdx(t),this,!0,!0);return n.bIsInvalid?null:n};e.prototype.GetCellByChildElement=function(e){var t=i.JsGridUtil.Internal.DomElement.GetInstance().FindAncestorWithProperty(e,"recordKey");if(null==t)return null;var n=t.elem,r=t.child,s=(function(e,t){return i.JsGridUtil.Internal.FindInArray(e.rows,function(e){return e==t})})(this.tableElem,n),o=(function(e,t){for(var n=null,r=e.cells.length-1;r>=0;r--)if(e.cells[r]==t){n=r;break}return n})(n,r);return null!=s&&null!=o?new x(s,o,this):null};e.prototype.GetRowCount=function(){return this.rowRecords.length};e.prototype.GetColumnCount=function(){return this.GetDataColCount()};e.prototype.BeginRowIdx=function(){return this.paneConverter.RelRowIdxToRowIdx(0)};e.prototype.EndRowIdx=function(){return this.BeginRowIdx()+this.rowRecords.length};e.prototype.BeginColIdx=function(){return this.leftmostColIdx};e.prototype.EndColIdx=function(){return this.leftmostColIdx+this.GetDataColCount()};e.prototype.GetRecordByKey=function(e){for(var t in this.rowRecords)if(this.rowRecords[t].recordKey===e)return this.rowRecords[t];return null};e.prototype.GetColumnAutoResizeWidth=function(e){for(var t=this.ColIdxToTableColIdx(e),n=this.tableElem.rows,r=0,i=0;i<n.length;i++)r=Math.max(r,n[i].cells[t].scrollWidth);return r};e.prototype.GetTableWidth=function(){for(var e=this.tableMgr.GetRowHeaderWidth(),t=this.tableMgr.BeginColIdx();t<this.tableMgr.EndColIdx();t++)e+=this.columns[t].width;return e};e.prototype.GetColumnSchema=function(){return this.renderCtx.ListSchema.Field};e.prototype.GetProperTableHeight=function(){if(m)return this.tableElem.clientHeight;if(!this._assessedTableHeight){for(var e=this.tableElem.parentElement;null!=e;){if(-1!=e.className.indexOf("quickEditParentDiv"))this._quickEditParentDiv=e;else if(-1!=e.className.indexOf("layoutPositiningContainer")||-1!=e.className.indexOf("od-scrollablePane-content-ItemsScopeList")){this._positiningContainer=e;break}e=e.parentElement}this._assessedTableHeight=!0}return this._positiningContainer&&this._quickEditParentDiv&&-1!=window.location.href.indexOf("env=WebViewList")&&this._positiningContainer.clientHeight>this.tableElem.clientHeight?this._positiningContainer.clientHeight-17-(this._positiningContainer.clientHeight-this._quickEditParentDiv.clientHeight):this.tableElem.clientHeight};e.prototype.InitStyleRules=function(e){var t=e.defaultCellStyle,n=e.gridPaneStyle;this.styleForTd=";vertical-align:middle;border-"+this._objBag.RTL.right+":"+a.StyleUtil.MakeBorderString(1,n.verticalBorderStyle,n.verticalBorderColor)+";border-bottom:"+a.StyleUtil.MakeBorderString(1,n.horizontalBorderStyle,n.horizontalBorderColor)+";color:"+t.textColor+(null!=t.font?";font-family:"+t.font:"")+";font-size:"+t.fontSize+";font-weight:"+t.fontWeight+";font-style:"+t.fontStyle+";text-align:"+t.textAlign+";overflow:hidden;text-overflow:ellipsis"};e.prototype.InsertIntoCoordCacheArray=function(e,t,n){if(t>=e.length){for(var r=e.length;r<t;r++)e.push(null);e.push(n)}else e[t]=n};e.prototype.Init=function(){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){for(var e=0,n=this._parentDiv.offsetParent;n;){e+=n.offsetLeft;if(-1!=n.className.indexOf("layoutPositiningContainer")||-1!=n.className.indexOf("od-scrollablePane-content-ItemsScopeList"))break;n=n.offsetParent}this._objBag.RTL.bEnabled?e>0&&(i.JsGridUtil.Internal.stickyLeftEdgeOffset=32):i.JsGridUtil.Internal.stickyLeftEdgeOffset=e;e>0&&(i.JsGridUtil.Internal.stickyChromeless=!1)}this._objBag.eventMgr.AttachEvent(s.JsGridConstants.EventType.OnCellErrorStateChanged,this.DispatchCellError.bind(this));this._objBag.intEventMgr.AttachEvent(s.JsGridConstants.Internal.EventType.OnRowHeaderStateChanged,this.DispatchRowStateChange.bind(this));this.InitStyleRules(this._objBag.styleMgr);this.tableElem=document.createElement("table");this.tableElem.cellPadding=this.tableElem.cellSpacing=0;this.tableElem.style.width="1px";this.tableElem.border="0";this.tableElem.cellSpacing="0";this.tableElem.cellPadding="1";this.tableElem.className="ms-listviewtable ms-listviewgrid";this.tableElem.style.borderCollapse="separate";this.tableElem.style.tableLayout="fixed";this.tableElem.id=this._baseId+"_mainTable";this._parentDiv.style.marginRight="3px";this._parentDiv.appendChild(this.tableElem);i.JsGridUtil.Internal.IsStickyColumnEnabled()&&(t.tearDownStickyColumnKillswitchIsActive||window.addEventListener("resize",this.HandleWindowResize))};e.prototype.DispatchCellError=function(e){this.paneConverter.IsRecordOnScreen(e.recordKey)&&(!e.bCellCurrentlyHasError||e.recordKey in this.errorDivs&&e.fieldKey in this.errorDivs[e.recordKey]?e.bCellCurrentlyHasError||this.ClearCellError(e.recordKey,e.fieldKey):this.AddOrUpdateCellError(e.recordKey,e.fieldKey))};e.prototype.AddOrUpdateCellError=function(e,t,n){var r,s=this.tableMgr.GetCellByKey(e,t);if(null!=s){var o=s.GetTd();e in this.errorDivs||(this.errorDivs[e]={});null==this.errorDivs[e][t]&&(this.errorDivs[e][t]=n?null:this.CreateCellErrorFrames(o));null!=this.errorDivs[e][t]&&(i.JsGridUtil.Internal.IsFeatureEnabled(g)||this.PositionCellErrorFrames(o,this.errorDivs[e][t]));if(!v){if("TRUE"===(null===(r=this._objBag.jsGridParams.tableViewParams.gridFieldMap[t].csrInfo)||void 0===r?void 0:r.Required)){o.setAttribute("data-error-message",this._objBag.errorMgr.GetMessageForCell(e,t));o.classList.add(d.hasErrorData)}}i.JsGridUtil._columnHeaderErrorIndicatorKillSwitchIsActive||this.UpdateColumnHeaderCellError(t,s,!0)}};e.prototype.CreateCellErrorFrames=function(e){var t={};if(i.JsGridUtil.Internal.IsFeatureEnabled(g)){e.classList.add(d.cellHasError);return e}t.Top=document.createElement("div");t.Right=document.createElement("div");t.Bottom=document.createElement("div");t.Left=document.createElement("div");for(var n in t){var r=t[n];r.style.cssText="position:absolute; top:0px; left:0px; width:0px; height:0px;";r.style["border"+n]=a.StyleUtil.MakeBorderString(1,"solid",this._objBag.styleMgr.gridPaneStyle.errorRectBorderColor);e.appendChild(r)}return t};e.prototype.PositionCellErrorFrames=function(e,t){var n=this.tableMgr.GetTdCoords(e),r={Top:{left:n.left+1,top:n.top+1,width:n.width-2},Right:{left:n.right-2,top:n.top+1,height:n.height-2},Bottom:{left:n.left+1,top:n.bottom-2,width:n.width-2},Left:{left:n.left+1,top:n.top+1,height:n.height-2}};for(var i in t){var s=t[i];for(var o in r[i])s.style[o]=r[i][o]+"px"}};e.prototype.ClearAllErrorsForRecord=function(e){var t=this.errorDivs[e];if(null!=t){for(var n in t)this.ClearErrorCore(e,n,!1);delete this.errorDivs[e]}};e.prototype.ClearCellError=function(e,t){var n,r,s,o;if(e in this.errorDivs&&t in this.errorDivs[e]){this.ClearErrorCore(e,t,!0);if(!v){var u=null===(n=this.tableMgr.GetCellByKey(e,t))||void 0===n?void 0:n.GetTd();if("TRUE"===(null===(r=this._objBag.jsGridParams.tableViewParams.gridFieldMap[t].csrInfo)||void 0===r?void 0:r.Required)){null===(s=u)||void 0===s||s.removeAttribute("data-error-message");null===(o=u)||void 0===o||o.classList.remove(d.hasErrorData)}}if(!i.JsGridUtil._columnHeaderErrorIndicatorKillSwitchIsActive){var a=this.tableMgr.GetCellByKey(e,t);a&&this.UpdateColumnHeaderCellError(t,a,!1)}}};e.prototype.ClearErrorCore=function(e,t,n){if(i.JsGridUtil.Internal.IsFeatureEnabled(g))this.errorDivs[e][t].classList.remove(d.cellHasError);else for(var r in this.errorDivs[e][t])if(null!=r){var s=i.JsGridUtil.Internal.DomElement.GetInstance().GetParentElement(this.errorDivs[e][t][r]);i.JsGridUtil.DebugAssert(null!=s);null!=s&&s.removeChild(this.errorDivs[e][t][r])}delete this.errorDivs[e][t];n&&i.JsGridUtil.Internal.IsAssocArrayEmpty(this.errorDivs[e])&&delete this.errorDivs[e]};e.prototype.DispatchRowStateChange=function(e){this.bRowHeadersEnabled&&this.paneConverter.IsRecordOnScreen(e.recordKey)&&(null!=e.rowHeaderState?this.SetRowHeaderState(e.recordKey,e.rowHeaderState):this.ClearRowHeaderState(e.recordKey))};e.prototype.SetRowHeaderState=function(e,t){null!=this.rowHeaderStateDivs[e]&&this.ClearRowHeaderState(e);var n=this.tableMgr.GetRowHeaderByKey(e);i.JsGridUtil.DebugAssert(null!=n);var r=n.GetTd(),s=t.GetOnClick(),o=t.GetImg().Render(t.GetTooltip(),null!=s?function(t){s(t,e);t.stopPropagation();t.preventDefault()}:null,!0);if(i.JsGridUtil.Internal.IsFeatureEnabled(g)){var u=r.firstElementChild;if(u){u.classList.add(d.hasStateElements);u.appendChild(o)}}else{r.innerHTML="";r.appendChild(o)}this.rowHeaderStateDivs[e]=o};e.prototype.ClearRowHeaderState=function(e,t){if(e in this.rowHeaderStateDivs){var n=this.tableMgr.GetRowHeaderByKey(e);i.JsGridUtil.DebugAssert(null!=t||null!=n);var r=null==t?n.GetTd():t;this.ClearHandlers(r);if(i.JsGridUtil.Internal.IsFeatureEnabled(g)){var s=r.firstElementChild;if(s){s.classList.remove(d.hasStateElements);s.removeChild(this.rowHeaderStateDivs[e])}}else r.removeChild(this.rowHeaderStateDivs[e]);delete this.rowHeaderStateDivs[e]}};e.prototype.UpdateColumnHeaderCellError=function(e,n,r){var i,s,o=n.GetColIdx(),u=null===(s=null===(i=this.GetColumnHeader(o))||void 0===i?void 0:i.GetTd())||void 0===s?void 0:s.querySelector("."+t.FIELD_TITLE_SPAN_CLASSNAME);if(r){if(!this.fieldsWithErrors[e]&&u){var a=document.createElement("span");a.className=d.errorAsterisk;a.innerHTML="*";u.parentNode.insertBefore(a,u.nextSibling);this.fieldsWithErrors[e]=a}}else{if(!this._objBag.errorMgr.AnyErrorsInField(e)&&this.fieldsWithErrors[e]&&u&&u.parentNode===this.fieldsWithErrors[e].parentNode){u.parentNode.removeChild(this.fieldsWithErrors[e]);delete this.fieldsWithErrors[e]}}};e.prototype.GetDataColCount=function(){return this.tableColCount-this.tableColIdxOfFirstDataCol};e.prototype.TableRowIdxToRowIdx=function(e){return this.paneConverter.RelRowIdxToRowIdx(e-1)};e.prototype.RowIdxToTableRowIdx=function(e){return this.paneConverter.RowIdxToRelRowIdx(e)+1};e.prototype.TableColIdxToColIdx=function(e){return this.leftmostColIdx+e-this.tableColIdxOfFirstDataCol};e.prototype.ColIdxToTableColIdx=function(e){return e-this.leftmostColIdx+this.tableColIdxOfFirstDataCol};e.prototype.InsertTableRow=function(e,t,n){var r,o=this,u=i.JsGridUtil.Internal.IsFeatureEnabled(g),f=[];i.JsGridUtil.Internal.IsFeatureEnabled(w)&&!t.HasUpdatedValues()&&t.UpdateLocalizedValuesWithColumnData(this.GetColumnSchema());var l=e+1,h=this.tableElem.insertRow(l);h.style.height=this.rowHeight+"px";var v=null!=t&&t!==s.JsGridConstants.Internal.LoadErrorState,m=v?t.key():null;h.recordKey=v?m.toString():null;var y,b="";if(v&&!t.bIsNewRow){t.rowIndex=e;var E=this._objBag&&this._objBag.jsGridParams&&this._objBag.jsGridParams.customFormatterProps,S=E?E.additionalRowClass:"";if(S){var T=E&&E.customFormatterSchema,N=this._objBag.jsGridParams.pageContext,C=t&&t.fieldRawDataMap&&t.fieldRawDataMap.csrInfo;(b=new c.CustomFormatter({rowIndex:t?t.rowIndex:-1,fieldRendererFormat:void 0,row:C,currentFieldName:"Title",rowSchema:T,errorStrings:{},pageContextInfo:N}).evalExpression(S))&&(h.className+=b)}}if(u){h.classList.add(d.gridRow,"ms-gridRow");t.bIsNewRow&&h.classList.add(d.inLineNewItemRow);i.JsGridUtil._keyboardToRowHeaderKillswitchIsActive||0!==e||h.classList.add(d.rowHasOnlyOneCellSelected)}this.ariaMgr.OnInsertTableRow(h,t,this.TableRowIdxToRowIdx(l));if(this.bRowHeadersEnabled){var k=h.insertCell(-1);if(u){if(i.JsGridUtil.Internal.IsStickyColumnEnabled()){k.className="ms-vb-itmcbx ms-vb-firstCell "+d.gridCell+" "+d.firstCell+" "+d.gridStickyCheckColumn+" "+b;i.JsGridUtil.Internal.stickyChromeless?k.className+=" "+d.gridStickyChromelessLeft:k.className+=" "+d.gridStickyChromeLeft}else k.className="ms-vb-itmcbx ms-vb-firstCell "+d.gridCell+" "+d.firstCell;k.setAttribute("aria-label",p.default.selectRowCell);var L=this.selectionMgr.GetFocusedPane();this.selectionMgr.IsRowSelected(L,e)&&h.classList.add(d.rowIsSelected,"is-selected")}else{k.className="ms-vb-itmcbx ms-vb-firstCell "+d.spGridCell;k.style.cssText=this.styleForTd+";border-"+this._objBag.RTL.left+":"+a.StyleUtil.MakeBorderString(1,this._objBag.styleMgr.gridPaneStyle.verticalBorderStyle,this._objBag.styleMgr.gridPaneStyle.verticalBorderColor)+";padding-"+this._objBag.RTL.left+":4px"}k.setAttribute("data-automationid","spgridcell_"+e.toString()+"_firstCell");r=new x(l,0,this);if(u){var A=document.createElement("div");A.classList.add(d.headerStateContainer);var O=document.createElement("div");O.classList.add(d.headerStateBar);A.appendChild(O);var M=document.createElement("div");M.classList.add(d.selectionCheckMark);M.innerHTML=this.GetSelectionCheckElement(e.toString());k.appendChild(A);k.appendChild(M);if(t.bIsNewRow){var _=h.previousSibling;_&&_.classList.remove(d.inLineNewItemRow);var D=document.createElement("div");D.classList.add(d.inlineNewItemAddIconContainer);D.innerHTML=this.GetAddNewItemIconElement();k.appendChild(D)}if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this._stickyLeftEdgeKeeper){this._lastShadowHeightUpdate=Date.now();window.setTimeout(function(){if(Date.now()-o._lastShadowHeightUpdate>250){o._lastShadowHeightUpdate=Date.now();var e=o.GetProperTableHeight().toString()+"px";o._stickyLeftEdgeKeeper.style.height=e;o._stickyColumnShadow.style.height=e}},300)}this.ariaMgr.OnInsertGridCell(k)}else this.ariaMgr.OnInsertRowHeaderCell(k)}for(var P=this.tableColIdxOfFirstDataCol;P<this.tableColCount;P++){(k=h.insertCell(-1)).setAttribute("data-automationid","spgridcell_"+e.toString()+"_"+P.toString());y=new x(l,P,this);f.push(y);var H=P-1,B="ms-vb2";if(H>=0&&H<this.columns.length){var j=this.columns[H].fieldKeys[0],F=this._objBag.jsGridParams.tableViewParams.gridFieldMap[j].csrInfo;i.JsGridUtil.DebugAssert(null!=this.renderCtx);null!=F&&(B=i.JsGridUtil.Internal.GetCSSClassForFieldTd(F))}if(u){k.className=d.gridCell+" "+B;if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&H<=i.JsGridUtil.Internal.stickyLastColIdx){k.className+=" "+d.gridStickyDataColumn+" "+b;H>0&&(k.className+=" "+d.gridStickySecondDataColumn);i.JsGridUtil.Internal.stickyChromeless?k.className+=" "+d.gridStickyDataLeftChromeless:k.className+=" "+d.gridStickyDataLeft;if(H>0){var I=i.JsGridUtil.Internal.stickyLeftEdgeOffset+i.JsGridUtil.Internal.stickyCheckColumnSize+this.columns[0].width;this._objBag.RTL.bEnabled?k.style.right=I+"px":k.style.left=I+"px"}}}else{k.style.cssText=this.styleForTd;k.className=d.spGridCell+" "+B}if(P===this.tableColCount-1){k.className+=" ms-vb-lastCell";u&&(i.JsGridUtil._lastColumnVisibilityKillSwitchIsActive?k.className+=" "+d.lastCell:this._objBag.showAddColumnMenu&&this._objBag.canUserAddColumn&&(k.className+=" "+d.lastCell))}this.ariaMgr.OnInsertGridCell(k)}this._fnInsertedRow(r,f);var q=!1;for(P=0;P<f.length;P++){q=this._fnPopulateCell(f[P])||q;if(null!=m&&this._objBag.errorMgr.CellHasError(m,f[P].GetFieldKey())){this.AddOrUpdateCellError(m,f[P].GetFieldKey(),n);n&&i.JsGridUtil.AsynchronousCellUpdater.GetInstance().RegisterCell(this.cellErrorJobKey,m,f[P].GetFieldKey())}}var R=this._objBag.rowHeaderStateMgr.GetRowHeaderState(m);this.bRowHeadersEnabled&&null!=R&&this.SetRowHeaderState(m,R);if(!q&&i.JsGridUtil.Internal.DomElement.GetInstance().BrowserIsIEAndRenderingModeIs7){var U=h.cells.length>0?h.cells[0]:null;null!=U&&null!=U.innerHTML&&0==U.innerHTML.length&&(U.innerHTML="&nbsp;")}};e.prototype.ClearHandlers=function(e){i.JsGridUtil.ClearEventListeners(e);for(var t=e.childNodes,n=0;n<t.length;n++)this.ClearHandlers(t[n])};e.prototype.DeleteTableRow=function(e){var t=this.tableElem.rows[e+1].recordKey;this.bRowHeadersEnabled&&null!=this.rowHeaderStateDivs[t]&&this.ClearRowHeaderState(t,this.tableElem.rows[e+1].cells[0]);this.ClearAllErrorsForRecord(t);var n=this.tableElem.rows[e+1];this._fnTryDisposeRow(n.recordKey);n.recordKey=null;this.ClearRowCoordCache(e+1);this.tableElem.deleteRow(e+1);if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this._stickyLeftEdgeKeeper){var r=this.GetProperTableHeight().toString()+"px";this._stickyLeftEdgeKeeper.style.height=r;this._stickyColumnShadow.style.height=r}};e.prototype.CalcOptimalDataColumnCount=function(e){return this.paneConverter.GetVirtualColumnCount()};e.prototype.InsertTableColumns=function(e,t){var n=[],r=[],o=this.tableElem.rows[0],u=s.JsGridConstants.Internal.zIndex.tableHeader+t;this.ClearColCoordCache(e);this.ClearRowCoordCache(0);for(var a=0;a<t;a++){var f=document.createElement("th");f.style.textOverflow="ellipsis";e+a==o.cells.length?o.appendChild(f):o.insertBefore(f,o.cells[e+a]);this.tableColCount++;var l=new x(0,e+a,this);n.push(l);var c=l.GetColumn();if(c&&c.width){var h=c.width;f.style.width=h+"px"}if(i.JsGridUtil.Internal.IsFeatureEnabled(b)&&i.JsGridUtil.Internal.IsFeatureEnabled(g)){f.style.zIndex=u;u--}this.ariaMgr.OnInsertColHeaderCell(f);for(var p=0;p<this.rowRecords.length;p++){var d=this.tableElem.rows[p+1].insertCell(e+a);d.style.cssText=this.styleForTd;r.push(new x(p+1,e+a,this));this.ariaMgr.OnInsertGridCell(d)}}this._fnInsertedColumns(n,r,this.headerHeight);for(a=0;a<r.length;a++){this._fnPopulateCell(r[a]);this._objBag.errorMgr.CellHasError(r[a].GetRecordKey(),r[a].GetFieldKey())&&this.AddOrUpdateCellError(r[a].GetRecordKey(),r[a].GetFieldKey())}};e.prototype.RemoveTableColumns=function(e,t){var n=this.TableColIdxToColIdx(e);this.ClearColCoordCache(e);this.ClearRowCoordCache(0);for(;t-- >0;){for(var r=this.columns[n].fieldKeys,i=this.rowRecords.length;i>=0;i--){var s=this.tableElem.rows[i],o=s.cells[e];if(s.recordKey in this.errorDivs)for(var u=0;u<r.length;u++)this.ClearCellError(s.recordKey,r[u]);0==i&&this._fnRemovedHeaderCell(o,n);s.removeChild(o)}n++;this.tableColCount--}this._fnRemovedColumns()};e.prototype.RefreshLoadingRects=function(){var e=this;if(!this._objBag.jsGridObj.paneMgr.gridPane.dontReflow){this.DisposeLoadingRects();for(var t=null,n=[],r=-1,o=0;o<this.rowRecords.length;o++){var u=null==this.rowRecords[o]?1:this.rowRecords[o]==s.JsGridConstants.Internal.LoadErrorState?2:0;if(0!==u)if(u!==r){t={type:u,startIdx:o,count:1};n.push(t)}else t.count++;r=u}if(n.length){var a=this.tableMgr.GetRowHeaderWidth(),f=this._objBag.RTL.bEnabled?Math.max(0,this.tableElem.offsetLeft+1):a,l=Math.min(this.tableMgr.GetTableWidth()-1,this._paneSize.GetWidth())-a,c='<table cellpadding="0" cellspacing="0" style="height:100%;width:100%"><tr><td style="border:0px;text-align:center">',h=c+this._fnGetLocStr("LoadingMsg")+"</td></tr></table>",p=c+'<a href="#" tabIndex="-1" title="'+this._fnGetLocStr("RecordFetchError")+'">'+this._fnGetLocStr("RecordFetchError")+"</a></td></tr></table>";for(o=0;o<n.length;o++){t=n[o];var d=document.createElement("div");i.JsGridUtil.Internal.DomElement.GetInstance().SetOpacity(d,.75);d.style.position="absolute";d.style.top=this.rowHeight*t.startIdx+this.headerHeight+2-this._parentDiv.offsetTop+"px";d.style.left=f+"px";d.style.width=l+"px";d.style.height=this.rowHeight*t.count-1+"px";d.style.zIndex="100";if(1==t.type){d.innerHTML=h;this.loadingRects.push({div:d})}else{d.innerHTML=p;var v=d.firstChild.firstChild.firstChild.firstChild.firstChild;v.addEventListener("click",function(){e._fnRetryErrorRows();return!1});this.loadingRects.push({div:d,anchor:v})}this._parentDiv.appendChild(d)}}if(i.JsGridUtil.Internal.IsStickyColumnEnabled()&&this._stickyLeftEdgeKeeper&&this.tableElem){var m=this.GetProperTableHeight().toString()+"px";this._stickyLeftEdgeKeeper.style.height=m;this._stickyColumnShadow.style.height=m;this.UpdateLeftEdgeKeeperSizes()}}};e.prototype.DisposeLoadingRects=function(){for(var e=0;e<this.loadingRects.length;e++){this.loadingRects[e].anchor&&i.JsGridUtil.ClearEventListeners(this.loadingRects[e].anchor);this._parentDiv.removeChild(this.loadingRects[e].div)}this.loadingRects=[]};e.prototype.UpdateCoordCacheInternal=function(){if(this._objBag.bUpdateCoordCache){this.UpdateColCoordCache();this.UpdateRowCoordCache()}this._objBag.bUpdateCoordCache=!1};e.prototype.UpdateRowCoordCache=function(){for(var e,t,n,r=0,i=this.tableElem.rows,s=0;s<this.rowCoordCache.length;s++){if(null==(t=this.rowCoordCache[s])){this.ClearRowCoordCache(s);break}if(0!==(e=(n=i[s].cells[0].offsetHeight+1)-t.height)){t.height=n;t.bottom+=e}if(0!==r){t.top+=r;t.bottom+=r}0!==e&&(r+=e)}};e.prototype.UpdateColCoordCache=function(){for(var e,t,n=0,r=this.tableElem.rows[0],i=0;i<this.colCoordCache.length;i++)if(null!=(e=this.colCoordCache[i])){t=r.cells[i].offsetWidth;t+=1;e.width=t;0!==(n+=t-e.width)&&(this._objBag.RTL.bEnabled?e.left+=n:e.right+=n)}else if(this._objBag.bUpdateCoordCache){this.ClearColCoordCache(i);break}};e.prototype.ClearColCoordCache=function(e){this.colCoordCache.length>e&&this.colCoordCache.splice(e,this.colCoordCache.length-e)};e.prototype.ClearRowCoordCache=function(e){this.rowCoordCache.length>e&&this.rowCoordCache.splice(e,this.rowCoordCache.length-e)};e.prototype.CloneRowCoords=function(e){return{top:e.top,bottom:e.bottom,height:e.height}};e.prototype.CopyRowCoords=function(e,t){var n=this.rowCoordCache[e];t.top=n.top;t.bottom=n.bottom;t.height=n.height};e.prototype.CloneColCoords=function(e){return{left:e.left,right:e.right,width:e.width}};e.prototype.CopyColCoords=function(e,t){var n=this.colCoordCache[e];t.left=n.left;t.right=n.right;t.width=n.width};e.prototype.GetSelectionCheckElement=function(e){var t=this._selectionCircleIcon,n=this._selectionCheckmarkIcon,r='<i class="'+t.subset.className+" "+d.selectionCircleIcon+'">'+t.code+"</i>",i='<i class="'+n.subset.className+" "+d.selectionCheckIcon+'">'+n.code+"</i>";return['<div class="'+d.selectionCheckIconsWrapper+'" data-automationid="row-selection-checkmark-'+e+'">',r,i,"</div>"].join("")};e.prototype.GetAddNewItemIconElement=function(){var e=this._addNewItemIcon;return'<i class="'+e.subset.className+" "+d.inlineNewItemAddIcon+'">'+e.code+"</i>"};e.prototype.UpdateLeftEdgeKeeperSizes=function(){var e=i.JsGridUtil.Internal.GetStickyDataColumnsWidth(this.columns)+(32+i.JsGridUtil.Internal.stickyLeftEdgeOffset);this._stickyLeftEdgeKeeperContainer.style.width=e.toString()+"px";this._objBag.RTL.bEnabled?this._stickyColumnShadow.style.right=((i.JsGridUtil.Internal.stickyChromeless?32:0)+(e-4)).toString()+"px":this._stickyColumnShadow.style.left=((i.JsGridUtil.Internal.stickyChromeless?32:0)+(e-4)).toString()+"px"};e.prototype.IsTableRowIdxValid=function(e,t){return e>=(t?1:0)&&e<this.tableElem.rows.length};e.prototype.IsTableColIdxValid=function(e,t){return e>=(t&&this.bRowHeadersEnabled?1:0)&&e<this.tableColCount};return e})();t.TableManager=S;var x=(function(){function e(e,t,n,r,i){this.fieldKey=null;this.tableRowIdx=e;this.tableColIdx=t;this._tableMgr=n;if(!r||this._tableMgr.IsTableRowIdxValid(e,i)&&this._tableMgr.IsTableColIdxValid(t,i)){this.tableRowIdx=e;this.tableColIdx=t}else this.bIsInvalid=!0}e.prototype.GetTr=function(){return this._tableMgr.tableElem.rows[this.tableRowIdx]};e.prototype.GetTd=function(){return this._tableMgr.tableElem.rows[this.tableRowIdx].cells[this.tableColIdx]};e.prototype.GetRecordKey=function(){if(this.tableRowIdx<1)return null;var e=this._tableMgr.rowRecords[this.tableRowIdx-1];return null!=e&&null!=e.recordKey?e.recordKey:this.GetTr().recordKey};e.prototype.GetRecord=function(){var e=0==this.tableRowIdx?null:this._tableMgr.rowRecords[this.tableRowIdx-1];return e==s.JsGridConstants.Internal.LoadErrorState?null:e};e.prototype.GetFieldKey=function(){if(0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled||this.tableRowIdx<1)return null;this.fieldKey||(this.fieldKey=this._tableMgr.paneConverter.IdxToFieldKey(this._tableMgr.TableRowIdxToRowIdx(this.tableRowIdx),this._tableMgr.TableColIdxToColIdx(this.tableColIdx)));return this.fieldKey};e.prototype.GetColumn=function(){return 0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled?null:this._tableMgr.columns[this.GetColIdx()]};e.prototype.GetColIdx=function(){return 0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled?null:this._tableMgr.TableColIdxToColIdx(this.tableColIdx)};e.prototype.GetRowIdx=function(){return this.tableRowIdx<1?null:this._tableMgr.TableRowIdxToRowIdx(this.tableRowIdx)};e.prototype.Equals=function(e){return this.tableRowIdx==e.tableRowIdx&&this.tableColIdx==e.tableColIdx};e.prototype.GetCellType=function(){return 0==this.tableColIdx&&this._tableMgr.bRowHeadersEnabled?this.tableRowIdx<1?this._tableMgr.CellType.SelectAllSquare:this._tableMgr.CellType.RowHeader:this.tableRowIdx<1?this._tableMgr.CellType.ColumnHeader:this._tableMgr.CellType.Cell};return e})();t.CellInfo=x});
define("_qe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getErrorMessage=function(e){return"string"==typeof e?e:e.message}});
define("XYe",["require","exports","ww","A","cP"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{dataSourceName:"GraphContentTypeInfo"},t)||this;n._oAuthTokenProvider=t.oAuthTokenProvider;n._canUseGraph=n._pageContext.isSPO;return n}t.prototype.getSiteAndWebIdfromUrl=function(e){var t=this;return this._canUseGraph?this._oAuthTokenProvider.getToken(this._pageContext.msGraphEndpointUrl).then(function(n){return t._getSiteAndWebId(n,t._pageContext.msGraphEndpointUrl+e)}).catch(function(){return null}):r.default.resolve(null)};t.prototype._getSiteAndWebId=function(e,t){return this.dataRequestor.getData({url:t,authToken:e,qosName:"GetSiteId",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){var t=JSON.parse(e);return[t.id.split(",")[1],t.id.split(",")[2]]}})};return t})(i.DataSource);t.default=s});
define("Vk",["require","exports","zk","A3","I"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){var e=this.scope=new i.default;this._events=e.attach(new r.default(this))}e.prototype.start=function(){};e.prototype.abort=function(){};e.prototype.dispose=function(){this.scope.dispose()};e.prototype.updateState=function(e){if(e!==this.state){this.state=e;this._events.raise(n.UPLOADSTATE_CHANGE,e)}};return e})();t.BaseUploader=s;t.default=s});
define("zk",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UPLOADSTATE_CHANGE="upload_state_change"});
define("jk",["require","exports","ww","A","Yb","Kk","C","M","ze","Gk","Jy","k","Bk","Nk","Vk"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=8388608,m=262144e3,g=new s.default(3),y=!c.Killswitch.isActivated("72E63389-0C1B-4876-8C80-5F244AD63320","10/15/2020","Restrict retries on streaming uploads"),b=(function(e){n.__extends(t,e);function t(t){var n=this,r=t.fileUpload;(n=e.call(this)||this)._fileUpload=r;n._authToken=t.authToken;n._uploadId=null;n._chunkNumber=0;n._streamingChunkNumber=0;n._currentChunkSize=v;n._currentStreamingChunkSize=m;n._onProgress=t.onProgress;n._dataRequestor=t.dataRequestor;n._async=n.scope.attach(new i.default(n));n.totalBytes=r.size;n.uploadedBytes=0;n.fileName=r.name;n.iconName=t.iconName;n.state=0;n.error=null;n.nameConflictBehavior=0;n.allowRename=!1;n.supportsVersioning=!0;n._expandAllItemFields=t.expandAllItemFields;n._uniqueId=t.uniqueId;n._parentItemKey=t.parentItemKey;n._targetItemKey=t.targetItemKey;n._serverRelativeItemUrl=t.serverRelativeItemUrl;n._webApiUrl=t.webApiUrl;return n}t.prototype.start=function(){var e=this;this.updateState(0);var t=g.enqueue(function(){e.error=void 0;e.updateState(1);return e._upload().then(function(){e.updateState(2)},function(t){var n;n=t instanceof p.UploadError?t:new p.UploadError({message:t&&t.message||"",errorType:h.UploadErrorType.general});e.error=n;e.updateState(4);return r.default.reject(t)})});this._uploadPromise=t;return t};t.prototype.abort=function(){var e=this;if(2!==this.state){this.error=null;this.updateState(3);var t=this._uploadPromise;this._uploadPromise=void 0;if(t){t.cancel();t.then(function(){},function(){}).done(function(){return e._cancelChunkUpload()})}}};t.prototype.restart=function(){var e,t=this,n=this._uploadPromise;this._uploadPromise=void 0;if(n){n.cancel();e=n.catch(function(){return t._cancelChunkUpload().catch(function(){})})}else e=r.default.resolve();e.done(function(){t.start()})};t.prototype._upload=function(){var e,t=this;this.uploadedBytes=0;var n=this._fileUpload.size;if(n<=25165824)e=this._sendSingleRequestUpload();else{this._maxUploadRequestDuration=15e4;e=this._sendStreamingUpload()}return e.then(function(e){t.uploadedBytes=n;t.item=e})};t.prototype._createUploadError=function(e){var t,n,r,i;if("string"==typeof e)r=String(e);else{t=this._getErrorCode(e);n=e.status;r="string"==typeof e.message?String(e.message):e.message.value}switch(t){case-2130575257:i=h.UploadErrorType.conflict;break;case-1:i=h.UploadErrorType.disconnected;break;case-2130575245:i=h.UploadErrorType.invalidName;break;case-2130246326:i=h.UploadErrorType.versionMismatch;break;case-2147023080:case-2130575282:i=h.UploadErrorType.overQuota;break;default:switch(n){case 401:i=h.UploadErrorType.authFailure;break;case 404:i=h.UploadErrorType.targetFolderMissing;break;case 403:case 429:i=h.UploadErrorType.accessDenied;break;case 409:i=h.UploadErrorType.conflict;break;case 412:i=h.UploadErrorType.versionMismatch;break;case 415:i=h.UploadErrorType.emptyFileOrFolder;break;case 423:i=h.UploadErrorType.lockMismatch;break;case 507:i=h.UploadErrorType.overQuota;break;default:r?i||(i=h.UploadErrorType.other):i=h.UploadErrorType.general}}return new p.UploadError({message:r,errorType:i,allowRename:this.allowRename,supportsVersioning:this.supportsVersioning})};t.prototype._getErrorCode=function(e){var t=e.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]};t.prototype._getUploadFileUrl=function(){var e=this._uniqueId,t=this._serverRelativeItemUrl,n=this._webApiUrl;n=e?n.method("GetFolderById",e):w(n,{serverRelativeItemUrl:t,isFolder:!0});var r=this._fileUpload.name,i=1===this.nameConflictBehavior;n=n.segment("Files").methodWithAliases("AddUsingPath",{DecodedUrl:r,overwrite:i,AutoCheckoutOnInvalidData:!0});var s="ListItemAllFields";this._expandAllItemFields&&(s+="/ContentType/Fields");s&&(n=n.oDataParameter("$Expand",s));return n.toString()};t.prototype._isConflictFile=function(){var e=this;if(1===this.nameConflictBehavior)return r.default.resolve(!1);var t=this._serverRelativeItemUrl,n=this._webApiUrl;n=(n=w(n,{serverRelativeItemUrl:t,isFolder:!0})).segment("Files").oDataParameter("$filter","Name eq '"+a.default.encodeRestUriStringToken(this._fileUpload.name)+"'");return this._dataRequestor.getData({noRedirect:!0,url:n.toString(),qosName:"SingleFileUploader.GetFile",authToken:this._authToken,parseResponse:function(t){var n=JSON.parse(t);return!!(n&&n.d&&n.d.results&&n.d.results.length>0)&&!(n.d.results[0].Exists&&e._streamingChunkNumber>0)}}).then(function(e){return e},function(e){return!!r.default.isCanceled(e)&&r.default.reject(e)})};t.prototype._processUploadCompleteResponse=function(e){return this._getItemFromResponse(e)};t.prototype._getItemFromResponse=function(e){var t;try{var n=JSON.parse(e).d,r=this._targetItemKey,i=void 0;n.ListItemAllFields&&n.ListItemAllFields.Id&&(i=String(n.ListItemAllFields.Id));var s=!1;if(n.ListItemAllFields&&n.ListItemAllFields.ContentType&&n.ListItemAllFields.ContentType.Fields&&n.ListItemAllFields.ContentType.Fields.results){var o=n.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(o.length>0)for(var a=0,c=o;a<c.length;a++){var h=c[a];if(!n.ListItemAllFields[h.InternalName]){s=!0;break}}}var p=void 0;n.UniqueId&&(p=u.default.normalizeLower(n.UniqueId));var d=n.Name,v=l.getFileExtension(d);t={key:r,parentKey:this._parentItemKey,type:f.default.File,id:n.ServerRelativeUrl,name:d,displayName:d,extension:v,properties:{ID:i,uniqueId:p},itemFromServer:n,hasMissingMetadata:s}}catch(e){}return t};t.prototype._generateChunkPostUrl=function(e,t){var r,i=this._fileUpload,s=this._uniqueId,o=i.size<=t,u=this._serverRelativeItemUrl,a=this._webApiUrl,f={uploadId:{guid:this._uploadId}};if(0===this._chunkNumber&&0===this._streamingChunkNumber){r="StartUpload";a=(a=s?a.method("GetFolderById",s):w(a,{serverRelativeItemUrl:u,isFolder:!0})).segment("Files");a=1===this.nameConflictBehavior?a.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:i.name}):a.methodWithAliases("AddStubUsingPath",{DecodedUrl:i.name})}else{r=o?"FinishUpload":"ContinueUpload";a=w(a,{serverRelativeItemUrl:u+"/"+i.name,isFolder:!1});f=n.__assign(n.__assign({},f),{fileOffset:e})}return(a=a.methodWithAliases(r,f)).toString()};t.prototype._getUploadStatus=function(){var e=this._fileUpload,t=this._uploadId,n=this._serverRelativeItemUrl,i=this._webApiUrl;i=i.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:n+"/"+e.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:t}});return this._dataRequestor.getData({noRedirect:!0,url:i.toString(),authToken:this._authToken,qosName:"SingleFileUploader.GetUploadStatus",method:"GET"}).then(function(e){if(e.d&&e.d.ExpectedContentRange){return parseInt(e.d.ExpectedContentRange.split("-")[0],10)}return r.default.reject(new Error("No expected range from server response."))})};t.prototype._uploadFragment=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);var i=this._fileUpload.size,s=Math.min(this._currentChunkSize+e,i);this._uploadId||(this._uploadId=u.default.generate());var a=Date.now();return this._sendFileData({url:this._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:this._fileUpload.slice(e,s),offset:e,length:s-e}).then(function(e){n.uploadedBytes=s;if(s<i){n._chunkNumber++;Date.now()-a<6e4&&(n._currentChunkSize=Math.min(Math.floor(n._currentChunkSize*Math.pow(2,.25)),62914560));return n._uploadFragment(s)}return n._processUploadCompleteResponse(e)},function(i){if(r.default.isCanceled(i))return r.default.reject(i);if(-2===n._getErrorCode(i)){if(n._currentChunkSize>262144){n._currentChunkSize=Math.max(Math.floor(n._currentChunkSize/2),262144);var s=void 0;0===n._chunkNumber&&(s=n._cancelChunkUpload());return r.default.resolve(s).then(function(){return n._uploadFragment(e)})}}else if(t>0&&n._canRetry(i)){var u,a=new o.default(function(){u&&n._async.clearTimeout(u)});u=n._async.setTimeout(function(){return a.complete()},1e3);return a.getPromise().then(function(){return n._uploadFragment(e,t-1)})}return r.default.reject(n._createUploadError(i))})};t.prototype._sendSingleRequestUpload=function(){var e=this;return this._isConflictFile().then(function(t){if(t){var n=new p.UploadError({message:"",errorType:h.UploadErrorType.conflict});return r.default.reject(n)}return e._fileUpload.slice(0,e._fileUpload.size)}).then(function(t){return e._sendFileData({url:e._getUploadFileUrl(),qosName:"SingleFileUploader.UploadFile",data:t,offset:0,length:t.size}).then(function(t){return e._processUploadCompleteResponse(t)}).then(function(e){return e},function(t){if(r.default.isCanceled(t))return r.default.reject(t);if(-2===e._getErrorCode(t)){e.nameConflictBehavior=1;return e._uploadFragment()}return r.default.reject(e._createUploadError(t))})})};t.prototype._sendStreamingUpload=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._uploadId||(this._uploadId=u.default.generate());var i=this._fileUpload.size,s=this._streamingChunkNumber>0?Math.min(this._currentStreamingChunkSize+e,i):0;return this._isConflictFile().then(function(t){if(t){var i=new p.UploadError({message:"",errorType:h.UploadErrorType.conflict});return r.default.reject(i)}return n._fileUpload.slice(e,s)}).then(function(u){return n._sendFileData({url:n._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:u,offset:e,length:u.size}).then(function(e){n.uploadedBytes=s;if(s<i){n._streamingChunkNumber++;return n._sendStreamingUpload(s,t)}return n._processUploadCompleteResponse(e)},function(i){if(r.default.isCanceled(i))return r.default.reject(i);if(-2===n._getErrorCode(i)){if(n._currentStreamingChunkSize<=1048576)return r.default.reject(n._createUploadError(i));n._currentStreamingChunkSize=n._currentStreamingChunkSize/2;return n._sendStreamingUpload(e,t)}return n._getUploadStatus().then(function(e){return n._sendStreamingUpload(e,y?t-1:3)},function(e){if(t>0&&n._canRetry(i)){var s,u=new o.default(function(){s&&n._async.clearTimeout(s)});s=n._async.setTimeout(function(){return u.complete()},1e3);return u.getPromise().then(function(){return n._sendStreamingUpload(0,t-1)})}return r.default.reject(n._createUploadError(i))})})})};t.prototype._canRetry=function(e){var t;switch(this._getErrorCode(e)){case-2130575257:case-2130575142:t=!1;break;default:t=!0}return t};t.prototype._cancelChunkUpload=function(){var e=this._uploadId;this._uploadId=void 0;this._chunkNumber=0;if(e){var t=this._fileUpload,n=this._serverRelativeItemUrl,i=this._webApiUrl;i=(i=w(i,{serverRelativeItemUrl:n+"/"+t.name,isFolder:!1})).methodWithAliases("CancelUpload",{uploadId:{guid:e}});return this._dataRequestor.getData({noRedirect:!0,url:i.toString(),authToken:this._authToken,qosName:"SingleFileUploader.CancelUploadSession"}).then(function(){})}return r.default.resolve()};t.prototype._sendFileData=function(e){var t,n,r,i=this,s=e.url,u=e.qosName,a=e.data,f=e.offset,l=e.length,c=new o.default(function(){t.cancel()}),h=function(e){var t=i._chunkNumber>0&&f+l>=i._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&i._async.clearTimeout(n);e&&(n=i._async.setTimeout(function(){c.error({code:"-1",message:""})},r))},p=Date.now(),d=Date.now(),v=0,m=0,g=0,y=this._async.debounce(function(e){if(e>i.uploadedBytes){i.uploadedBytes=e;i._onProgress&&i._onProgress(e)}},100,{leading:!1});t=this._dataRequestor.getData({url:s,noRedirect:!0,authToken:this._authToken,qosName:u,parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:a,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();m+=(e.loaded-v)/(t-d);g++;r=e.loaded/(t-p);d=t;v=e.loaded;y(f+e.loaded);h(l-e.loaded)}}});h(l);var b=this._async.setInterval(function(){if(g){Date.now()-p+(l-v)/((m+r)/(g+1))>i._maxUploadRequestDuration&&v<l&&c.error({code:"-2",message:""})}},1e4);t.done(function(e){c.complete(e)},function(e){c.error(e)});c.getPromise().done(function(){n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)},function(){t.cancel();n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)});return c.getPromise()};return t})(d.BaseUploader);t.ItemUploader=b;function w(e,t){var n=t.serverRelativeItemUrl,r=t.isFolder;return e=e.methodWithAliases(r?"GetFolderByServerRelativePath":"GetFileByServerRelativePath",{DecodedUrl:n})}});
define("D$e",["require","exports","Yb","C","A","Kk"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={enqueue:function(e){return e()}},u=(function(){function e(e){void 0===e&&(e={});this.async=new n.default;this.uploaderCount=0;this.throttledSignals=[];var t=e.maxParallelUploads,r=void 0===t?3:t,i=e.maxUploadsPerSecond,u=void 0===i?8:i;this.uploadQueue=r===1/0?o:new s.default(r);this.maxUploads=u}e.prototype.throttle=function(e){var t=this;return this.uploadQueue.enqueue(function(){if(!t.isReady&&t.uploaderCount>=1e3){t.uploaderCount=0;t.isReady=!0}if(t.batchStartTime&&t.uploaderCount>=t.maxUploads)return t.throttleUploader(e);t.isReady&&!t.batchStartTime&&(t.batchStartTime=Date.now());return t.startUploader(e)})};e.prototype.addThrottleTimer=function(e){this.isReady=!0;this.setTimeout(e);return this.addUploaderCallback(function(){return i.default.resolve()})};e.prototype.startUploader=function(e){this.uploaderCount+=1;return e()};e.prototype.addUploaderCallback=function(e){var t=this,n=new r.default;this.throttledSignals.push(n);return n.getPromise().then(function(){return t.startUploader(e)})};e.prototype.throttleUploader=function(e){if(this.timeout)return this.addUploaderCallback(e);var t=1e3-(Date.now()-this.batchStartTime);if(t>0){this.setTimeout(t);return this.addUploaderCallback(e)}this.uploaderCount=0;this.batchStartTime=Date.now();return this.startUploader(e)};e.prototype.setTimeout=function(e){var t=this;if(this.timeout){this.async.clearTimeout(this.timeout);this.timeout=void 0}this.timeout=this.async.setTimeout(function(){t.timeout=void 0;t.uploaderCount=0;t.batchStartTime=Date.now();for(var e=0,n=t.throttledSignals;e<n.length;e++){n[e].complete()}t.throttledSignals=[]},e)};return e})();t.UploadThrottler=u});
define("DF",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.standard="HTML";e.datasheet="GRID";e.calendar="CALENDAR";e.recurrence="RECURRENCE";e.chart="CHART";e.gantt="GANTT";e.power="POWER";e.tiles="TILES";e.compactList="COMPACTLIST";e.modernCalendar="MODERNCALENDAR";e.gridFixed="GRIDFIXED"})(t.ViewType||(t.ViewType={}));t.ViewTypesSecondary=["TILES","COMPACTLIST","MODERNCALENDAR","GRIDFIXED"];(function(e){e[e.dynamicHeight=0]="dynamicHeight";e[e.fixedHeight=1]="fixedHeight"})(t.GridLayoutType||(t.GridLayoutType={}));(function(e){e[e.defaultScope=0]="defaultScope";e[e.recursive=1]="recursive";e[e.recursiveAll=2]="recursiveAll";e[e.filesOnly=3]="filesOnly"})(t.ViewScope||(t.ViewScope={}))});
define("YYe",["require","exports","ww","sGe","y9","JYe","k","A"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[{name:"Name",displayName:"Name",required:!1,text:{textType:""}},{name:"Group",displayName:"Group",required:!1,text:{textType:""}},{name:"Parent",displayName:"Parent",required:!1,text:{textType:""}}],f=(function(){function e(t,n,r,i,s,o){this.contentTypeHubPath="/sites/contenttypehub";this._graphDataSource=t;this._contentTypeDataSource=n;this._pageContext=r;this._isAdmin=void 0!==i&&!1!==i;this._siteId=void 0!==s?s:e.removeParenthesisIfExist(this._pageContext.siteId);this._webId=void 0!==o?o:e.removeParenthesisIfExist(this._pageContext.webId)}e.prototype.loadContentTypes=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this._contentTypeDataSource.getContentTypes(this._siteId,this._webId).then(function(e){return e})]})})};e.prototype.loadContentType=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.getContentType(e.removeParenthesisIfExist(this._pageContext.siteId),this._webId,t).then(function(e){return e})]})})};e.prototype.getSiteInfo=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this._contentTypeDataSource.getSiteInfo(this._siteId,this._webId).then(function(e){return e})]})})};e.prototype.loadContentTypesDetailedAvailableForList=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypesDetailedAvailableForList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId)).then(function(e){return e})]})})};e.prototype.loadListContentTypesDetailed=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.getListContentTypesDetailed(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),void 0,t).then(function(e){return e})]})})};e.prototype.addContentTypesToList=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.addContentTypesToList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadContentTypeColumns=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypeColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.loadReorderableContentTypeColumns=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getReorderableContentTypeColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.loadListContentTypeColumns=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.getListContentTypeColumns(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadReorderableListContentTypeColumns=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.getReorderableListContentTypeColumns(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.loadSiteColumns=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getSiteColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.loadAncestorColumns=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getAncestorColumns(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.createContentType=function(e,t,r,i,s){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.createContentType(e,t,r,i,this._siteId,this._webId,s).then(function(e){return e})]})})};e.prototype.updateContentType=function(e,t,r,i,s,o,u,a,f){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.updateContentType(this._siteId,this._webId,e,t,r,i,s,o,u,a,f).then(function(e){return e})]})})};e.prototype.publishContentType=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,1,,4]);return[2,this._contentTypeDataSource.publishContentType(this._siteId,e).then(function(e){return e})];case 1:return 400!==(t=n.sent()).status?[3,3]:[4,this._contentTypeDataSource.publishContentTypeGet(this._siteId,e)];case 2:return[2,n.sent()];case 3:throw t;case 4:return[2]}})})};e.prototype.unpublishContentType=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:t.trys.push([0,1,,4]);return[2,this._contentTypeDataSource.unpublishContentType(this._siteId,e).then(function(e){return e})];case 1:return 400!==t.sent().status?[3,3]:[4,this._contentTypeDataSource.unpublishContentTypeGet(this._siteId,e)];case 2:return[2,t.sent()];case 3:return[3,4];case 4:return[2]}})})};e.prototype.deleteContentTypeColumn=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.deleteContentTypeColumn(this._siteId,this._webId,e,t).then(function(e){return e})]})})};e.prototype.createOrAddContentTypeColumns=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.createOrAddContentTypeColumns(this._siteId,this._webId,e,t,r).then(function(e){return e})]})})};e.prototype.createContentTypeView=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){t.columns;return[2,this._contentTypeDataSource.createContentTypeView(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.getSharedPackages=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:t=[];if(o.Killswitch.isActivated("ec389545-4106-4ad8-a677-53106625a517","08/28/2020","Kill getting shared packages by title"))return[3,13];n.label=1;case 1:n.trys.push([1,7,,12]);return o.Killswitch.isActivated("415bb0d6-03e4-4102-8d98-8cc8bf666829","11/11/2020","Kill for modifying getting shared packages API call")?[3,4]:[4,this._contentTypeDataSource.getSharedPackageList(e,this.contentTypeHubPath)];case 2:r=n.sent();return[4,this._contentTypeDataSource.getSharedPackageListItems(this._siteId,this._webId,r)];case 3:return[2,t=n.sent()];case 4:return[4,this._contentTypeDataSource.getSharedPackagesByUrl(e,this.contentTypeHubPath)];case 5:t=n.sent();n.label=6;case 6:return[3,12];case 7:n.sent();n.label=8;case 8:n.trys.push([8,10,,11]);return[4,this.getSharedPackagesInfo()];case 9:t=n.sent();return[3,11];case 10:n.sent();return[3,11];case 11:return[3,12];case 12:return[3,16];case 13:n.trys.push([13,15,,16]);return[4,this.getSharedPackagesInfo()];case 14:t=n.sent();return[3,16];case 15:n.sent();return[3,16];case 16:return[2,t]}})})};e.prototype.getCurrencyList=function(){return n.__awaiter(this,void 0,u.default,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=this._isAdmin?i.getServerUrl(this._pageContext):this._pageContext.webAbsoluteUrl;return[4,this._contentTypeDataSource.getCurrencyList(e)];case 1:return[2,t.sent()]}})})};e.prototype.getRegionalDateTimeSchema=function(){return n.__awaiter(this,void 0,u.default,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=this._isAdmin?i.getServerUrl(this._pageContext):this._pageContext.webAbsoluteUrl;return[4,this._contentTypeDataSource.getRegionalDateTimeSchema(e)];case 1:return[2,t.sent()]}})})};e.prototype.getAllSitesLists=function(){return n.__awaiter(this,void 0,u.default,function(){return n.__generator(this,function(e){return[2,this._contentTypeDataSource.getAllSitesLists(this._siteId,this._webId).then(function(e){return e})]})})};e.prototype.getListFields=function(e){return n.__awaiter(this,void 0,u.default,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getListFields(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.getContentTypeDocTemplate=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypeDocTemplate(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.getContentTypeEnforcedHubSites=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getEnforcedHubSites(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.deleteListContentType=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.deleteContentTypeFromList(e.removeParenthesisIfExist(this._pageContext.siteId),e.removeParenthesisIfExist(this._pageContext.listId),t).then(function(e){return e})]})})};e.prototype.updateContentTypeColumn=function(e,t,r,i,s){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.updateContentTypeColumn(this._siteId,this._webId,e,t,r,i,s).then(function(e){return e})]})})};e.prototype.reorderContentTypeColumn=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.reorderContentTypeColumn(this._siteId,this._webId,e,t).then(function(e){return e})]})})};e.prototype.getContentTypeAncestors=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.getContentTypeAncestors(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.updateSiteColumn=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this._contentTypeDataSource.updateSiteColumn(this._siteId,t,e,r).then(function(e){return e})]})})};e.prototype.deleteSiteContentType=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this._contentTypeDataSource.deleteContentTypeFromSite(this._siteId,this._webId,e).then(function(e){return e})]})})};e.prototype.updateView=function(e,t,i,s){return n.__awaiter(this,void 0,u.default,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:o=this._isAdmin?r.contentTypeAdminViewName:r.contentTypeViewName;return[4,this._contentTypeDataSource.updateView(e,t,i,s,this._pageContext.webAbsoluteUrl,o)];case 1:return[2,n.sent()]}})})};e.prototype.createView=function(e,t,i){return n.__awaiter(this,void 0,u.default,function(){var s;return n.__generator(this,function(n){switch(n.label){case 0:s=this._isAdmin?r.contentTypeAdminViewName:r.contentTypeViewName;return[4,this._contentTypeDataSource.createView(e,t,i,this._pageContext.webAbsoluteUrl,s)];case 1:return[2,n.sent()]}})})};e.prototype.setDefaultView=function(e){return n.__awaiter(this,void 0,u.default,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t=this._isAdmin?r.contentTypeAdminViewName:r.contentTypeViewName;return[4,this._contentTypeDataSource.setDefaultView(this._pageContext.webAbsoluteUrl,e,t)];case 1:return[2,n.sent()]}})})};e.prototype.loadViews=function(){return n.__awaiter(this,void 0,u.default,function(){var t,i,s,o,u,f,l,c,h,p;return n.__generator(this,function(n){switch(n.label){case 0:t=this._pageContext.webAbsoluteUrl;i=e.removeParenthesisIfExist(this._pageContext.siteId);s=e.removeParenthesisIfExist(this._pageContext.webId);o=this._isAdmin?r.contentTypeAdminViewName:r.contentTypeViewName;u=["name","parent","group"];if(this._isAdmin||this._pageContext.webServerRelativeUrl.toLowerCase()===this.contentTypeHubPath){a.push({name:"LastPublished",displayName:"LastPublished",required:!1,text:{textType:""}});u.push("lastPublished")}else{a.push({name:"Source",displayName:"Source",required:!1,text:{textType:""}});u.push("source")}n.label=1;case 1:n.trys.push([1,3,,10]);return[4,this._contentTypeDataSource.loadViews(t,o)];case 2:return[2,n.sent()];case 3:if(404!==(f=n.sent()).status)return[3,8];l={displayName:o,list:{hidden:!0,template:"genericList"},columns:a};c={orderBy:{field:"name",direction:1}};return[4,this._contentTypeDataSource.createContentTypeViewList(i,s,l)];case 4:n.sent();return[4,this._contentTypeDataSource.loadViews(t,o)];case 5:h=n.sent();p=Object.keys(h)[0];return[4,this._contentTypeDataSource.updateView(p,h[p].title,c,u,this._pageContext.webAbsoluteUrl,o)];case 6:n.sent();return[4,this._contentTypeDataSource.loadViews(t,o)];case 7:return[2,n.sent()];case 8:throw f;case 9:return[3,10];case 10:return[2]}})})};e.prototype.getContentTypeHubSiteId=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:t=new s.ContentTypeUrlHelper({path:this.contentTypeHubPath,authority:e});r=t.getSiteByPathUrl();return[4,this._graphDataSource.getSiteAndWebIdfromUrl(r)];case 1:return[2,n.sent()]}})})};e.removeParenthesisIfExist=function(e){return e.indexOf("{")>=0&&e.lastIndexOf("}")===e.length-1?e.substring(1,e.length-1):e};e.prototype.getSharedPackagesInfo=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=[];return[4,this._contentTypeDataSource.getSharedPackages(this._siteId)];case 1:t.sent().forEach(function(t){e.push(t.fields)});return[2,e]}})})};return e})();t.default=f});
define("YWe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createSPPrincipalType=function(e){if(!e)return 0;for(var t=0,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i?t|=1:"DL"===i?t|=2:"SecGroup"===i?t|=4:"SPGroup"===i&&(t|=8)}return t}});
define("JYe",["require","exports","Te"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.uri=new n.default(""+e.authority+e.path)}e.prototype.getSiteByPathUrl=function(){return"/v1.0/sites/"+this.uri.domain+":"+this.uri.path};e.prototype.getWebAbsoluteUrlValue=function(){return""+this.uri.value};return e})();t.ContentTypeUrlHelper=r});
define("IWe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.WebhookSubscription=0]="WebhookSubscription";e[e.Meta=1]="Meta";e[e.EventHub=2]="EventHub"})(t.NotificationSource||(t.NotificationSource={}));(function(e){e[e.Zip=0]="Zip"})(t.NotificationScenario||(t.NotificationScenario={}))});
define("SWe",["require","exports","ww","Yb","Le","W","IWe","nM","DWe","k"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={ODB:819,ODC:"EnablePushChannelLogging"},c={ODB:459},h={ODB:!f.Killswitch.isActivated("390e1b6a-fe67-475a-a86e-07591cb0ebd5","04/01/2020","Log qos event for pushChannelService.Connect")},p={ODB:!f.Killswitch.isActivated("5eb8f962-4820-466c-a208-16534edec621","05/27/2020","Only use websockets when connecting to pushv2")},d=["Due to organizational policies, you can't access these resources from this network location","One of the provided arguments is not acceptable","Session has been revoked","The access token has expired","The caller does not have permission to perform the action","The caller is not authenticated","The request is malformed or incorrect","There has been an error authenticating the request"],v=(function(){function e(e,t){this._firedConnectQoSEvent=!1;this._getSubscriptionAttempts=0;this._socketIoReconnectAttempts=0;this._notificationHandlers={};this._connectionHandlers={};this._disableWebSockets=e.disableWebSockets;this._subscriptionService=t.subscriptionService;this._sessionTokenFetcher=t.sessionTokenFetcher;this._async=new r.default;this._socketIoReconnectAttempts=0}e.prototype.isConnected=function(){return!!this._socketIo&&this._socketIo.connected};e.prototype.getSocketIoSubscription=function(){return this._subscription};e.prototype.addConnectionHandler=function(e,t){this._connectionHandlers[e]=t};e.prototype.removeConnectionHandler=function(e){delete this._connectionHandlers[e]};e.prototype.setupNotificationHandler=function(e,t){var n=e.source,r=e.scenarios,i=e.id,s=void 0===i?"":i,u=o.NotificationSource[n];if(u){if(r&&r.length)for(var a=0,f=r;a<f.length;a++){var l=f[a];this._notificationHandlers[u.toLowerCase()+o.NotificationScenario[l].toLowerCase()+s]=t}else this._notificationHandlers[u.toLowerCase()+s]=t;return!0}return!1};e.prototype.connect=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,u,f,l,c=this;return n.__generator(this,function(d){switch(d.label){case 0:this.disconnect();if(void 0!==e)return[3,2];r=this;return[4,this._getSubscription("PushChannelService.Connect")];case 1:r._subscription=d.sent();return[3,3];case 2:this._subscription=e;d.label=3;case 3:this._log("Connecting to subscription",this._subscription);if(void 0===this._subscription){this._log("Invalid subscription");return[2,!1]}if(!this._firedConnectQoSEvent||i.default.isFeatureEnabled(h)){this._firedConnectQoSEvent=!0;u=new s.default({name:"PushChannelService.Connect",extraData:n.__assign({notificationUrl:this._subscription.notificationUrl},t||{})})}f={reconnectionAttempts:20};i.default.isFeatureEnabled(p)&&-1!==this._subscription.notificationUrl.indexOf("pushn")?f.transports=["websocket"]:this._disableWebSockets&&(f.transports=["polling"]);l=this._socketIo=a.connect(this._subscription.notificationUrl,f);this._socketIo.on("connect",function(){if(l===c._socketIo){c._log("Connected");u&&u.end({resultType:s.ResultTypeEnum.Success,extraData:n.__assign({notificationUrl:c._subscription.notificationUrl},t||{})});c._executeConnectionHandlers(!0)}else l.disconnect()});this._socketIo.on("disconnect",function(){if(l===c._socketIo){c._log("Disconnected");c._executeConnectionHandlers(!1)}});this._socketIo.on("reconnect_failed",function(){c._log("Reconnect failed");u&&u.end({resultType:s.ResultTypeEnum.Failure,extraData:n.__assign({notificationUrl:c._subscription.notificationUrl},t||{})});c._subscription=void 0;c._socketIoReconnectAttempts++;c._socketIoReconnectAttempts>3?c._log("Exceeded max reconnect attempts"):c._async.setTimeout(function(){c.connect(void 0,{methodInvoker:"reconnect_failed"})},0)});this._socketIo.on("notification",function(e){c._log("Notification",e);var t;try{t=JSON.parse(e)}catch(e){return}var n=t.source,r=t.scenario?t.scenario.toLowerCase():"";n||(n=o.NotificationSource[o.NotificationSource.WebhookSubscription]);n=n.toLowerCase();var i=!1;i=c._handleMessage(t,n);var s=n+r;for(var u in c._notificationHandlers)-1!==u.indexOf(s)&&u!==n&&(i=c._handleMessage(t,u,s)||i);i||c._log("Notification - missing handler for message")});return[2,!0]}})})};e.prototype.disconnect=function(){if(this._socketIo){this._socketIo.disconnect();this._socketIo=void 0}if(this._async){this._async.dispose();this._async=new r.default}this._subscription=void 0};e.prototype.refreshSubscription=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,this._getSubscription("PushChannelService.refreshSubscription")];case 1:if(void 0===(e=t.sent()))return[2,void 0];if(this.isConnected()&&this._subscription&&this._subscription.notificationUrl!==e.notificationUrl){this._log("Notification url changed. Reconnecting...");this.connect(e,{methodInvoker:"PushChannelService.refreshSubscription"});return[2,!1]}this._subscription=e;return[2,!0]}})})};e.prototype._getSubscription=function(e){void 0===e&&(e="unknown");return n.__awaiter(this,void 0,void 0,function(){var t,r,o,a,f,l,h,p,v=this;return n.__generator(this,function(n){switch(n.label){case 0:r=void 0;i.default.isFeatureEnabled(c)&&(r=new s.default({name:"PushChannelService.getSubscription",extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}}));n.label=1;case 1:n.trys.push([1,6,,7]);a=(o=this._subscriptionService).getSocketIoSubscription;f={};return this._sessionTokenFetcher?[4,this._sessionTokenFetcher()]:[3,3];case 2:l=n.sent();return[3,4];case 3:l=void 0;n.label=4;case 4:return[4,a.apply(o,[(f.sessionToken=l,f.existingSubscription=this._subscription,f)])];case 5:t=n.sent();r&&r.end({resultType:s.ResultTypeEnum.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}});return[3,7];case 6:h=n.sent();this._log("Failed to get socketIo subscription",h);p=!1;u.isGraphError(h)&&(403===h.status?p=!0:h.error&&h.error.message&&(p=d.some(function(e){return 0===h.error.message.indexOf(e)})));r&&r.end({resultType:s.ResultTypeEnum.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}});if(p)return[2,void 0];this._getSubscriptionAttempts++;return this._getSubscriptionAttempts>10?[2,void 0]:[2,new Promise(function(e){var t=500*Math.pow(2,v._getSubscriptionAttempts);v._log("Retrying in "+t+" milliseconds");v._async.setTimeout(function(){return e(v._getSubscription("Retry_getSubscription"))},t)})];case 7:return[2,t]}})})};e.prototype._handleMessage=function(e,t,n){void 0===n&&(n=t);var r=this._notificationHandlers[t];if(r){r(e.payload?e.payload:e.value);return!0}return!1};e.prototype._executeConnectionHandlers=function(e){for(var t=0,n=Object.keys(this._connectionHandlers);t<n.length;t++){var r=n[t];this._connectionHandlers[r](e)}};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.default.isFeatureEnabled(l)&&console.log.apply(console,n.__spreadArrays(["PushChannelService"],e))};return e})();t.default=v});
define("xWe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){this._dataRequestor=t.dataRequestor;this._listId=e.listId;this._webAbsoluteUrl=e.webAbsoluteUrl}e.prototype.getSocketIoSubscription=function(e){var t,n;if(this._listId&&this._webAbsoluteUrl){t=this._webAbsoluteUrl+"/_api/v2.0/sites/root/lists/"+this._listId;n=!1}else{if(!e.sessionToken)throw new Error("Invalid session token");t="/drive/root";n=!0}return this._dataRequestor.send({path:t+"/subscriptions/socketIo",apiName:"GetSocketIo",requestType:"GET",accessToken:e.sessionToken,useAuthorizationHeaders:n}).then(function(e){return e})};return e})();t.default=n});
define("LY",["require","exports","Yb","A3","I","A","C"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){var s=t.asyncType,o=void 0===s?n.default:s,u=t.eventGroupType,a=void 0===u?r.default:u,f=t.targetWindow,l=void 0===f?window:f,c=this._scope=new i.default;this._async=c.attach(new o(this));this._events=c.attach(new a(this));this._targetWindow=l}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.wait=function(e){var t,n=e.duration,r=e.allowWakeWhenOnline,i=void 0!==r&&r,u=this._async,a=this._events,f=this._targetWindow,l=new o.default(function(){u.clearTimeout(t)}),c=function(){i&&l.complete()};t=u.setTimeout(function(){l.complete()},n);a.on(f,"online",c);return l.getPromise().then(function(){a.off(f,"online",c)},function(e){a.off(f,"online",c);return s.default.reject(e)})};return e})();t.UploadWaiter=u});
define("NI",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[".oxps",".pdf"],r=[".doc",".docx",".dot",".dotx",".dotm",".odt",".rtf",".ods",".xls",".xlsm",".xlsx",".odp",".ppt",".pptx",".pps",".ppsx",".tiff",".tif",".dwg",".epub",".htm",".html",".eml",".msg",".md",".markdown"];t.XPS_MEDIA_TYPE="application/oxps";t.PDF_MEDIA_TYPE="application/pdf";t.isSupportedFileFormat=function(e){return!(!e||-1===n.indexOf(e.toLowerCase())&&-1===r.indexOf(e.toLowerCase()))};t.isFileTransformableToPdf=function(e){return!(!e||-1===r.indexOf(e.toLowerCase()))}});
define("VYe",["require","exports","ww","zYe","zYe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.ContentTypeManagementPanel});
define("qYe",["require","exports","ww","r","_A","ou","Zm","KYe","bv"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f="ContentTypeManagementPanel.",l=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i.addContentTypesToList=function(e){i.setState(n.__assign(n.__assign({},i.state),{showSpinner:!0,spinnerText:i.props.strings.applyingContentTypesSpinner}));i.props.addContentTypesToList(e)};i.onContentTypeSelected=function(e){return i.setState(n.__assign(n.__assign({},i.state),{selectedContentTypeIds:e}))};i.onErrorOccured=function(){i.setState(n.__assign(n.__assign({},i.state),{hasErrorOccurred:!0}))};i._renderFooterButtons=function(){return r.createElement(r.Fragment,null,r.createElement(o.PrimaryButton,{className:"ms-ContentTypeManagementPanel-Button",onClick:i._handleApplyClick,disabled:0===i.state.selectedContentTypeIds.length||i.state.showSpinner},i.props.strings.applyButtonLabel),r.createElement(o.DefaultButton,{className:"ms-ContentTypeManagementPanel-Button ms-ContentTypeManagementPanel-CancelButton",onClick:i._handleCancelClick},i.props.strings.cancelButtonLabel))};i._handleApplyClick=function(){var e=i._content.current.getSelectedContentTypesWithView();a.Engagement.logData({name:f+"ApplyClick",extraData:{countContentTypes:e.length}});i.addContentTypesToList(e)};i._handleCancelClick=function(){a.Engagement.logData({name:f+"CancelClick"});i.props.onDismiss()};i._content=r.createRef();i.state={showSpinner:!0,spinnerText:t.strings.loadingContentTypesSpinner,hasErrorOccurred:i.props.hasErrorOccurred,siteContentTypes:[],listContentTypes:[],selectedContentTypeIds:[],initialLoadComplete:!1};return i}t.prototype.componentDidMount=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,this.props.getSiteContentTypes()];case 1:e=n.sent();return[4,this.props.getListContentTypes()];case 2:t=n.sent();e.forEach(function(e){e.createNewView=!0;e.addColumnsToCurrentView=!1});e=e.sort(function(e,t){return e.name.localeCompare(t.name)});this.setState({showSpinner:!1,spinnerText:"",initialLoadComplete:!0,siteContentTypes:e,listContentTypes:t});return[3,4];case 3:n.sent();this.setState({showSpinner:!1,hasErrorOccurred:!0});return[3,4];case 4:return[2]}})})};t.prototype.componentDidUpdate=function(e,t){var n=this;this.props.panelProps.isOpen&&this.state.initialLoadComplete&&setTimeout(function(){var e;return n._content&&(null===(e=n._content.current)||void 0===e?void 0:e.focusFirstElement())},25)};t.getDerivedStateFromProps=function(e,t){return n.__assign(n.__assign({},t),{showSpinner:!e.hasErrorOccurred&&t.showSpinner,hasErrorOccurred:t.hasErrorOccurred||e.hasErrorOccurred})};t.prototype.render=function(){return r.createElement("div",null,r.createElement(i.Panel,n.__assign({},this.props.panelProps),this.state.showSpinner&&r.createElement(s.Spinner,{size:s.SpinnerSize.large,label:this.state.spinnerText,className:"ms-ContentTypeManagementPanel-Spinner"}),!this.state.showSpinner&&r.createElement(u.ContentTypeManagementPanelContent,{ref:this._content,availableContentTypes:this.state.siteContentTypes,addedContentTypes:this.state.listContentTypes,strings:this.props.strings,errorStrings:this.props.errorStrings,hasErrorOccurred:this.state.hasErrorOccurred,onContentTypeSelected:this.onContentTypeSelected,getContentType:this.props.getSiteContentType,getContentTypeColumns:this.props.getContentTypeColumns,getListContentTypeColumns:this.props.getListContentTypeColumns,removeContentType:this.props.removeContentType,onDismiss:this.props.onDismiss,onError:this.onErrorOccured}),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Buttons",role:"complimentary"},this.state.initialLoadComplete&&this._renderFooterButtons())))};return t})(r.PureComponent);t.ContentTypeManagementPanel=l});
define("KYe",["require","exports","ww","r","nre","jR","GYe","Zm","cN","b_e","W","je","bv","Nd","ul","pc","qd","Oe","pc","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b="ContentTypeManagementPanel.",w=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._isInnerZoneKeystroke=function(e){return e.which===v.getRTLSafeKeyCode(v.KeyCodes.right)};i._onRenderDropdownTitle=function(e){var t="",n=e.filter(function(e){return e.selected}).length;t=n>0?n+" "+i.props.strings.dropdownTitleSelectedLabel:i.props.strings.dropdownNoneLabel;return r.createElement("div",null,t)};i._handleDropdownChange=function(e,t){var r=n.__spreadArrays(i.state.selectedContentTypesIds),s=i.state.selectedContentTypeToViewInfoId;if(t.selected)r.push(t.key);else{r=r.filter(function(e){return e!==t.key});s&&s===t.key&&(s=void 0)}i.props.onContentTypeSelected(r);i.setState(n.__assign(n.__assign({},i.state),{selectedContentTypesIds:r,selectedContentTypeToViewInfoId:s}))};i._handleAddedContentTypeSelect=function(e){if(e.columns)i.setState(n.__assign(n.__assign({},i.state),{isLoadingContentTypeColumn:!1,selectedContentTypeToViewInfoId:e.id,isSelectedAnAddedContentType:!0,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));else{i.setState(n.__assign(n.__assign({},i.state),{isLoadingContentTypeColumn:!0,selectedContentTypeToViewInfoId:e.id,isSelectedAnAddedContentType:!0,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));i._updateColumnsOfAddedContentType(e)}};i._handleSelect=function(e){return n.__awaiter(i,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(s){t=c.deepCopy(this.state.availableContentTypes);r=void 0;for(i=0;i<t.length;i++)if(t[i].id===e){r=i;break}if(t[r].columns)this.setState(n.__assign(n.__assign({},this.state),{selectedContentTypeToViewInfoId:e,isLoadingContentTypeColumn:!1,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}));else{this._updateColumns(t,r);this.setState(n.__assign(n.__assign({},this.state),{isLoadingContentTypeColumn:!0,selectedContentTypeToViewInfoId:e,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}return[2]})})};i._onRenderAddedCTItem=function(e,t){return r.createElement(u.DefaultButton,{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container"+(e.isSelected?" ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container-selected":""),onClick:function(){return i._handleAddedContentTypeSelect(e)},key:e.id,styles:{label:{fontWeight:400}},ariaLabel:i._getAriaLabelforAddedCT(e.name,t+1)},e.name)};i._updateColumnsOfAddedContentType=function(e){return n.__awaiter(i,void 0,void 0,function(){var t=this;return n.__generator(this,function(r){this.props.getListContentTypeColumns(e.id).then(function(r){for(var i=c.deepCopy(t.state.addedContentTypes),s=0;s<i.length;s++)if(i[s].id===e.id){i[s].columns=r;break}t.setState(n.__assign(n.__assign({},t.state),{addedContentTypes:n.__spreadArrays(i),isLoadingContentTypeColumn:!1,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}).catch(function(e){t.props.onError()});return[2]})})};i._updateColumns=function(e,t){return n.__awaiter(i,void 0,void 0,function(){var r=this;return n.__generator(this,function(i){this.props.getContentTypeColumns(e[t].id).then(function(i){e[t].columns=i;r.setState(n.__assign(n.__assign({},r.state),{availableContentTypes:n.__spreadArrays(e),isLoadingContentTypeColumn:r.state.selectedContentTypeToViewInfoId!==e[t].id&&r.state.isLoadingContentTypeColumn,isSelectedAnAddedContentType:r.state.selectedContentTypeToViewInfoId!==e[t].id&&r.state.isSelectedAnAddedContentType,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))}).catch(function(e){r.props.onError()});return[2]})})};i._handleListCheckboxChangeWrapper=function(e){return function(t,n){return i._handleListCheckboxChange(n,e)}};i._handleListCheckboxChange=function(e,t){if(!e){var r=n.__spreadArrays(i.state.selectedContentTypesIds),s=i.state.selectedContentTypeToViewInfoId;r=r.filter(function(e){return e!==t});s&&s===t&&(s=void 0);i.props.onContentTypeSelected(r);i.setState(n.__assign(n.__assign({},i.state),{selectedContentTypesIds:r,selectedContentTypeToViewInfoId:s}))}};i._handleCreateNewViewToggle=function(e){h.Engagement.logData({name:b+"CreateNewViewToggle."+(e?"Enabled":"Disabled")});for(var t=c.deepCopy(i.state.availableContentTypes),r=0;r<t.length;r++)if(t[r].id===i.state.selectedContentTypeToViewInfoId){t[r]=n.__assign({},t[r]);t[r].createNewView=e;break}i.setState(n.__assign(n.__assign({},i.state),{availableContentTypes:n.__spreadArrays(t)}))};i._handleAddColumnsToCurrentViewToggle=function(e){h.Engagement.logData({name:b+"AddColumnsToCurrentViewToggle."+(e?"Enabled":"Disabled")});for(var t=c.deepCopy(i.state.availableContentTypes),r=0;r<t.length;r++)if(t[r].id===i.state.selectedContentTypeToViewInfoId){t[r]=n.__assign({},t[r]);t[r].addColumnsToCurrentView=e;break}i.setState(n.__assign(n.__assign({},i.state),{availableContentTypes:n.__spreadArrays(t)}))};i._handleRemoveContentTypeClick=function(e,t){h.Engagement.logData({name:b+"DeleteClick"});var r=new l.Qos({name:"ContentTypeManagementPanel.DeleteContentType"});i.props.removeContentType(e).then(function(){return n.__awaiter(i,void 0,void 0,function(){var i,s,o;return n.__generator(this,function(u){switch(u.label){case 0:r.end({resultType:l.ResultTypeEnum.Success,extraData:{contentTypeId:e}});i=(i=c.deepCopy(this.state.addedContentTypes)).filter(function(t){return t.id!==e});return[4,this.props.getContentType(t)];case 1:(s=u.sent()).createNewView=!1;s.addColumnsToCurrentView=!1;(o=c.deepCopy(this.state.availableContentTypes)).push(s);o=o.sort(function(e,t){return e.name.localeCompare(t.name)});this.setState(n.__assign(n.__assign({},this.state),{availableContentTypes:n.__spreadArrays(o),addedContentTypes:n.__spreadArrays(i),selectedContentTypeToViewInfoId:void 0,isSelectedAnAddedContentType:!1,hasCannotBeRemovedError:void 0,cannotBeRemovedError:void 0}));return[2]}})})}).catch(function(t){if(400===t.status){r.end({resultType:l.ResultTypeEnum.ExpectedFailure,error:t,extraData:{contentTypeId:e}});i.setState(n.__assign(n.__assign({},i.state),{hasCannotBeRemovedError:!0,cannotBeRemovedError:t.message}))}else{r.end({resultType:l.ResultTypeEnum.Failure,error:t,extraData:{contentTypeId:e}});i.props.onError()}})};i._dismissError=function(){i.setState(n.__assign(n.__assign({},i.state),{hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0}))};i.getSelectedContentTypesWithView=function(){var e=[];n.__spreadArrays(i.state.availableContentTypes).forEach(function(t){i.state.selectedContentTypesIds.find(function(e){return e===t.id})&&e.push(c.deepCopy(t))});return e};i.focusFirstElement=function(){var e;null===(e=i._dropdown)||void 0===e||e.focus()};i.state={availableContentTypes:c.deepCopy(i.props.availableContentTypes),selectedContentTypesIds:[],addedContentTypes:c.deepCopy(i.props.addedContentTypes),selectedContentTypeToViewInfoId:void 0,isLoadingContentTypeColumn:!0,isSelectedAnAddedContentType:!1,hasError:i.props.hasErrorOccurred,hasCannotBeRemovedError:!1,cannotBeRemovedError:void 0};return i}t.getDerivedStateFromProps=function(e,t){return n.__assign(n.__assign({},t),{hasError:t.hasError||e.hasErrorOccurred})};t.prototype.render=function(){var e=this,t=this.props.strings;if(this.state.hasError&&!this.state.hasCannotBeRemovedError)return r.createElement(r.Fragment,null,r.createElement(a.MessageBar,{isMultiline:!1,messageBarType:a.MessageBarType.error},this.props.errorStrings.genericErrorMessage));var l=[],h=void 0;this.state.availableContentTypes.forEach(function(t){e.state.selectedContentTypesIds.find(function(e){return e===t.id})&&l.push(c.deepCopy(t));e.state.isSelectedAnAddedContentType||t.id!==e.state.selectedContentTypeToViewInfoId||(h=c.deepCopy(t))});if(this.state.isSelectedAnAddedContentType)for(var v=0;v<this.state.addedContentTypes.length;v++)if(this.state.addedContentTypes[v].id===this.state.selectedContentTypeToViewInfoId){h=c.deepCopy(this.state.addedContentTypes[v]);break}var g=this.state.availableContentTypes.map(function(t){return{key:t.id,text:t.name,selected:void 0!==e.state.selectedContentTypesIds.find(function(e){return e===t.id})}}),y=[{key:"checkbox",name:"Checkbox",fieldName:"",minWidth:20,onRender:function(t){return r.createElement(s.Checkbox,{checked:!0,onChange:e._handleListCheckboxChangeWrapper(t.id),className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCTCheckbox",ariaLabel:t.name})}},{key:"button",name:"Button",fieldName:"",minWidth:20,className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCT-button-cell",styles:{root:{width:"100%"}},onRender:function(t){return r.createElement(u.DefaultButton,{text:t.name,className:"ms-ContentTypeManagementPanel-PrimaryPanel-DefaultButton",onClick:function(){return e._handleSelect(t.id)},styles:{label:{fontWeight:400}}})}}],b=new m.Selection;b.setItems(l.map(function(e){return n.__assign(n.__assign({},e),{key:e.id})}));return r.createElement("div",{className:"ms-ContentTypeManagementPanel"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel"},r.createElement("div",{role:"form"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Title"},t.title),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown"},r.createElement(i.Dropdown,{placeholder:t.dropdownNoneLabel,label:t.dropdownLabel,selectedKeys:n.__spreadArrays(this.state.selectedContentTypesIds),onChange:this._handleDropdownChange,multiSelect:!0,options:g,onRenderTitle:this._onRenderDropdownTitle,disabled:0===this.state.availableContentTypes.length,componentRef:this._resolveRef("_dropdown"),styles:{label:{color:"#323130"}}})),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentTypes"},r.createElement(p.FocusZone,{direction:p.FocusZoneDirection.vertical,isCircularNavigation:!0,isInnerZoneKeystroke:this._isInnerZoneKeystroke,role:"grid"},l.map(function(t,i){return r.createElement(m.DetailsRow,{key:t.id,item:n.__assign(n.__assign({},t),{key:t.id}),itemIndex:i,columns:y,selectionMode:m.SelectionMode.none,selection:b,styles:{root:{display:"block",width:"100%",height:"36px",border:"none",backgroundColor:e.state.selectedContentTypeToViewInfoId===t.id?"#F3F2F1":void 0},cell:{padding:"0px"}}})}))),this.state.addedContentTypes.length>0&&r.createElement(r.Fragment,null,r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label"},r.createElement("b",null,t.addedContentTypes)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes"},r.createElement(p.FocusZone,{direction:p.FocusZoneDirection.vertical,isCircularNavigation:!0},r.createElement(d.List,{items:this.state.addedContentTypes.map(function(t){return n.__assign(n.__assign({},t),{isSelected:e.state.selectedContentTypeToViewInfoId&&e.state.selectedContentTypeToViewInfoId===t.id})}),onRenderCell:this._onRenderAddedCTItem}))))))),r.createElement(f.Separator,{vertical:!0}),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel"},r.createElement(o.SecondaryPanel,{selectedContentTypeToViewInfo:h||void 0,isSelectedAnAddedContentType:this.state.isSelectedAnAddedContentType,strings:this.props.strings,errorStrings:this.props.errorStrings,cannotBeRemovedError:this.state.cannotBeRemovedError,handleCreateNewViewToggle:this._handleCreateNewViewToggle,handleAddColumnsToCurrentViewToggle:this._handleAddColumnsToCurrentViewToggle,removeContentType:this._handleRemoveContentTypeClick,dismissErrorMessage:this._dismissError})))};t.prototype._getAriaLabelforAddedCT=function(e,t){try{return g.format(this.props.strings.ariaLabelAddedCT,e,t,this.state.addedContentTypes.length)}catch(e){}};return t})(y.BaseComponent);t.ContentTypeManagementPanelContent=w});
define("GYe",["require","exports","ww","r","bl","ou","Xse","Zm","Hf","je","Tu","cN","Oe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.renderPanelContent=function(){var e=f.deepCopy(t.props.selectedContentTypeToViewInfo),n=t.props.strings;return r.createElement(r.Fragment,null,!t.props.selectedContentTypeToViewInfo.columns&&r.createElement(s.Spinner,{size:s.SpinnerSize.large}),t.props.selectedContentTypeToViewInfo.columns&&r.createElement("div",null,r.createElement("span",{tabIndex:-1,role:"alert","aria-live":"assertive","aria-label":t.getAriaLabelCTLoaded(),className:"ms-ContentTypeManagementPanel-screenReaderOnly"},t.getAriaLabelCTLoaded()),!t.props.isSelectedAnAddedContentType&&r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle"},r.createElement(o.Toggle,{onText:n.createNewViewLabel,offText:n.createNewViewLabel,onChange:t._onCreateNewViewToggle,checked:!!t.props.selectedContentTypeToViewInfo.createNewView})),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-column"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-row"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.nameLabel,e.name)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.parentLabel,e.parentReference.name))),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-row"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},t.renderKeyValueText(n.descriptionLabel,e.description)))),!t.props.isSelectedAnAddedContentType&&r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView"},r.createElement(o.Toggle,{onText:n.addColumnCurrentViewLabel,offText:n.addColumnCurrentViewLabel,onChange:t._onAddColumnsToCurrentViewToggle,checked:!!t.props.selectedContentTypeToViewInfo.addColumnsToCurrentView})),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Columns"},r.createElement("b",null,n.columnsLabel)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable"},t.renderFieldsTable()),t.props.cannotBeRemovedError&&r.createElement(c.MessageBar,{dismissButtonAriaLabel:n.closeButtonAriaLabel,messageBarType:c.MessageBarType.error,isMultiline:!0,onDismiss:t.props.dismissErrorMessage},t.props.cannotBeRemovedError),t.props.isSelectedAnAddedContentType&&r.createElement(l.Fabric,null,r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Buttons ms-ContentTypeManagementPanel-Button"},t.renderDeleteWithTooltip()))))};t._onCreateNewViewToggle=function(e,n){t.props.handleCreateNewViewToggle(n)};t._onAddColumnsToCurrentViewToggle=function(e,n){t.props.handleAddColumnsToCurrentViewToggle(n)};t._onRemoveContentTypeWrapper=function(e){t.props.removeContentType(t.props.selectedContentTypeToViewInfo.id,t.props.selectedContentTypeToViewInfo.parentReference.id)};t.renderKeyValueText=function(e,t,n){return r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-container-column"},r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},r.createElement("b",null,e)),r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-row"},n?r.createElement(i.Link,{href:n}):t))};t.renderFieldsTable=function(){var e=t.props.strings;return r.createElement(r.Fragment,null,r.createElement("table",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,e.secondaryPanelFieldsListNameDisplayName),r.createElement("th",null,e.secondaryPanelFieldsListTypeDisplayName),r.createElement("th",null,e.secondaryPanelFieldsListStatusDisplayName),r.createElement("th",null,e.secondaryPanelFieldsListSourceDisplayName))),r.createElement("tbody",null,t.props.selectedContentTypeToViewInfo.columns.map(function(e){return r.createElement("tr",{key:e.id},r.createElement("td",null,e.displayName),r.createElement("td",null,e.typeDisplayName),r.createElement("td",null,e.required?"Required":"Optional"),r.createElement("td",null,e.sourceContentType?e.sourceContentType.name:""))}))))};t.renderDeleteWithTooltip=function(){return t.props.selectedContentTypeToViewInfo?t.props.selectedContentTypeToViewInfo.readOnly?r.createElement(a.TooltipHost,{content:t.props.strings.tooltipReadonlyCT},t.renderDeleteButton()):t.renderDeleteButton():r.createElement(r.Fragment,null," ")};t.renderDeleteButton=function(){return r.createElement("div",null,r.createElement(u.PrimaryButton,{onClick:t._onRemoveContentTypeWrapper,disabled:t.props.selectedContentTypeToViewInfo&&t.props.selectedContentTypeToViewInfo.readOnly},t.props.strings.removeContentTypeButtonLabel))};t.getAriaLabelCTLoaded=function(){try{return h.format(t.props.strings.ariaLabelCTLoaded,t.props.selectedContentTypeToViewInfo.name)}catch(e){return""}};return t}t.prototype.render=function(){return r.createElement("div",{className:"ms-ContentTypeManagementPanel-SecondaryPanel-Content",role:"region"},void 0===this.props.selectedContentTypeToViewInfo?this.props.strings.defaultSecondaryPanelLabel:this.props.strings.contentTypeInformationLabel,r.createElement("br",null),void 0!==this.props.selectedContentTypeToViewInfo?this.renderPanelContent():"")};return t})(r.PureComponent);t.SecondaryPanel=p});
define("zYe",["require","exports","ww","qYe","KYe","GYe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("iet",["require","exports","ww","r","Oe","pc","net","od","aet"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderLabel=function(e){return r.createElement("div",{id:e.labelId,className:o.styles.accessible},i.format(a.default.siteDesignRunChooserAriaLabel,t.props.run.siteDesignTitle,t.props.run.runDate))};t._onSelected=function(){t.props.onSelected(t.props.run)};return t}t.prototype.render=function(){var e={};e[o.styles.runChoiceChecked]=this.props.radioButtonProps.checked;return r.createElement("div",{className:s.css(o.styles.runChoiceRoot,e),onClick:this._onSelected},r.createElement("div",{className:o.styles.runChoiceRadio},this.props.renderRadioButton(n.__assign(n.__assign({},this.props.radioButtonProps),{"aria-describedby":this.props.describedById,onRenderLabel:this._onRenderLabel}))),r.createElement("div",{className:o.styles.runChoiceText},r.createElement("div",{className:o.styles.runChoicePrimaryText},this.props.run.siteDesignTitle),r.createElement("div",{className:o.styles.runChoiceSecondaryText},i.format(a.default.progressPanelDateRanText,this.props.run.runDate))),r.createElement("div",{className:o.styles.runChoiceArrow},r.createElement(u.Icon,{iconName:"ChevronRight",className:"ms-Icon--m"})))};return t})(r.Component);t.SiteDesignRunChooser=f});
define("ret",["require","exports","ww","r","Oe","k","od","ou","pc","aet","net"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._renderStage=function(e,n){return 0===n?null:r.createElement("div",{key:t._getStageKey(n),className:l.styles.stageTitle,"data-automationid":"SiteScriptProgressStageTitle"},e)};return t}t.prototype.render=function(){var e,t=void 0,n=void 0,c=l.styles.activeActionTitle,h=void 0,p=this.props.stageNames[0];e=s.Killswitch.isActivated("402D171D-93E7-49F4-8E32-4231EFA41B9D","5/10/2019","Show stages for long site designs")?!!this.props.stageResultData:!!this.props.stageNames;if(!this.props.demoMode&&e){for(var d=Math.min(this.props.stageNames.length,Math.max(0,this.props.stageOutcomesKnown-this.props.stageStartIndex)),v=!1,m=!1,g=0;g<d;g++){var y=this.props.stageResultData[g+this.props.stageStartIndex];if(1===y.outcomeCode){v=!0;t=r.createElement("div",{className:l.styles.errorText},y.outcomeText||f.default.defaultFailureOutcomeText);break}4===y.outcomeCode&&(m=!0)}if(v){h=i.format(f.default.actionErrorAriaLabel,p);n=r.createElement(o.Icon,{ariaLabel:h,className:a.css(l.styles.actionIcon,l.styles.errorIcon),iconName:"Error",role:"img"})}else if(m){h=i.format(f.default.actionIncompleteAriaLabel,p);n=r.createElement(u.Spinner,{ariaLabel:h,className:l.styles.inProgressSpinner,role:"img",size:u.SpinnerSize.small})}else if(d>=this.props.stageNames.length){h=i.format(f.default.actionCompleteAriaLabel,p);n=r.createElement(o.Icon,{ariaLabel:h,className:a.css(l.styles.actionIcon,l.styles.successIcon),"data-automationid":"SiteScriptProgressSuccessIcon",iconName:"CheckMark",role:"img"})}else if(this.props.stageOutcomesKnown>=this.props.stageStartIndex){h=i.format(f.default.actionIncompleteAriaLabel,p);n=r.createElement(u.Spinner,{ariaLabel:h,className:l.styles.inProgressSpinner,role:"img",size:u.SpinnerSize.small})}else{h=i.format(f.default.actionIncompleteAriaLabel,p);n=r.createElement(o.Icon,{ariaLabel:h,className:a.css(l.styles.actionIcon,l.styles.incompleteIcon),iconName:"CheckMark",role:"img"});c=l.styles.inactiveActionTitle}}else n=r.createElement(o.Icon,{"aria-hidden":"true",iconName:"CheckMark",className:a.css(l.styles.actionIcon,l.styles.incompleteIcon)});return r.createElement("div",{role:"heading",className:l.styles.actionContainer,"data-automationid":"SiteScriptProgressActionContainer","aria-label":h},r.createElement("div",{className:l.styles.actionHeader},n,r.createElement("div",{className:a.css(l.styles.actionTitle,c,n?"":l.styles.actionTitleNoIcon),"data-automationid":"SiteScriptProgressActionTitle"},this.props.stageNames[0]||"")),t,r.createElement("div",{className:l.styles.stageContainer},this.props.stageNames.map(this._renderStage)))};t.prototype._getStageKey=function(e){return"scriptProgress_"+this.props.stageStartIndex.toString+"_"+e.toString()};return t})(r.Component);t.SiteScriptActionLabel=c});
define("eet",["require","exports","ww","r","Oe","bv","pc","Zm","JR","nre","oD","bl","_A","ak","ou","k","ude","ret","iet","aet","net","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._showTenantSiteDesigns=function(){s.Engagement.logData({name:"SiteScripts.ShowTenantSiteDesigns.Click"});i._siteScriptProgressStateManager.showTenantSiteDesigns()};i._hideTenantSiteDesigns=function(){s.Engagement.logData({name:"SiteScripts.HideTenantSiteDesigns.Click"});i._siteScriptProgressStateManager.hideTenantSiteDesigns()};i._renderChoiceGroupOption=function(e){return{key:e.runId,text:"",onRenderField:function(t,n){return r.createElement(y.SiteDesignRunChooser,{describedById:i._runChooserDescribedById,onSelected:i._onSiteDesignRunSelected,radioButtonProps:t,renderRadioButton:n,run:e})}}};i._onRadioChanged=function(e,t){i._siteScriptProgressStateManager.showSiteDesignRun(t.key)};i._onSiteDesignRunSelected=function(e){e&&e.runId&&i._siteScriptProgressStateManager.showSiteDesignRun(e.runId)};i._applySelectedTenantSiteDesign=function(){s.Engagement.logData({name:"SiteScripts.ApplyTenantSiteDesign.Click"});i.state.selectedTenantSiteDesign&&i._siteScriptProgressStateManager.applySiteDesign(i.state.selectedTenantSiteDesign)};i._onTenantSiteDesignSelected=function(e,t){i._siteScriptProgressStateManager.showTenantSiteDesign(e.key)};i._convertTenantSiteDesignToDropdownOption=function(e,t){return{key:e.id,text:e.title}};i._dismissAndRefresh=function(){s.Engagement.logData({name:"SiteScripts.DismissAndRefreshButton.Click"});i._onPanelDismissedInternal();window.location.reload(!0)};i._onClickNavigationCloseButton=function(){s.Engagement.logData({name:"SiteScripts.ClosePanelNavigation.Click"});i._onPanelDismissedInternal()};i._onPanelDismissed=function(){s.Engagement.logData({name:"SiteScripts.ClosePanel"});i._onPanelDismissedInternal()};i._onNewDataReceived=function(e){i.setState(e)};i.state={stagesRetrieved:!1,stageOutcomesKnown:0,stageOutcomesKnownButIncomplete:0};i._siteScriptProgressStateManager=i.props.siteScriptProgressStateManager;i.state=n.__assign({},i._siteScriptProgressStateManager.getState());i._runChooserDescribedById="SiteDesignRunChooserDescription"+Math.random().toString();i._designChooserDescribedById="SiteDesignChooserDescription"+Math.random().toString();return i}t.prototype.componentDidMount=function(){this._siteScriptProgressManagerKey="SiteScriptProgressPanel"+Math.random().toString();this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newProgressData,this._onNewDataReceived);this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newNonProgressData,this._onNewDataReceived);this.props.firstRunPanelExperience||this._siteScriptProgressStateManager.retrieveTenantSiteDesignsAndSiteDesignRuns()};t.prototype.componentWillUnmount=function(){this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newProgressData);this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,m.SiteScriptProgressCallbackType.newNonProgressData)};t.prototype.render=function(){var e=void 0;this.props.isOpen&&(e=r.createElement("div",{className:w.styles.siteScriptProgressPanelRoot},this._renderLeftColumn(),this._renderRightColumn()));return r.createElement(h.Panel,{isOpen:this.props.isOpen,className:w.styles.siteScriptProgressPanel,hasCloseButton:!1,isLightDismiss:!0,onDismiss:this._onPanelDismissed,type:h.PanelType.custom,customWidth:"900px"},e)};t.prototype._renderNavigation=function(){return r.createElement("div",{className:w.styles.navigation},r.createElement(u.IconButton,{className:w.styles.xButton,onClick:this._onClickNavigationCloseButton,"data-is-visible":!0,"data-is-focusable":!0,iconProps:{iconName:"Cancel"},ariaLabel:b.default.progressPanelDismissButtonText}))};t.prototype._renderLeftColumn=function(){var e;e=this.props.firstRunPanelExperience?this._renderSiteDesignWorkingImage():this._shouldShowTenantSiteDesigns()?this._renderTenantSiteDesignMetadata():this._renderSiteDesignRuns();return r.createElement("div",{className:o.css(w.styles.darker,w.styles.column,w.styles.leftColumn)},r.createElement("div",{className:w.styles.columnHeader},this._renderPanelTitle(),this._renderPanelSubtitle()),e,r.createElement("div",{className:o.css(w.styles.columnFooter)},this.props.firstRunPanelExperience?this._renderGearMenuHint():this._renderTenantSiteDesignsLink()))};t.prototype._renderSiteDesignWorkingImage=function(){if(this.props.imageUrls){var e=window.devicePixelRatio<2?this.props.imageUrls.workingSiteDesign:this.props.imageUrls.workingSiteDesign2x;if(e)return r.createElement(l.Image,{className:w.styles.workingImage,imageFit:l.ImageFit.contain,alt:"",role:"presentation",src:e})}};t.prototype._renderTenantSiteDesignMetadata=function(){var e;if(this.state.selectedTenantSiteDesign){var t=void 0,n="";if((e=this._siteScriptProgressStateManager.getTenantSiteDesign(this.state.selectedTenantSiteDesign)).imageUrl){t=e.imageUrl;n=e.imageAltText?e.imageAltText:""}else t=this.props.imageUrls?"68"===this._siteScriptProgressStateManager.getWebTemplate()?this.props.imageUrls.commSiteCustomizedLogo:this.props.imageUrls.teamSiteCustomizedLogo:"";if(e)return r.createElement("div",{className:w.styles.columnBody},r.createElement("div",{className:w.styles.siteDesignDescription},e.description),r.createElement("div",null,r.createElement(l.Image,{src:t,alt:n,className:w.styles.siteDesignLogoImage})))}return r.createElement("div",{className:w.styles.columnBody})};t.prototype._renderPanelSubtitle=function(){return!this.props.firstRunPanelExperience&&this._shouldShowTenantSiteDesigns()?this._renderTenantSiteDesignChooser():r.createElement("div",{className:w.styles.progressPanelSubtitle},this.props.firstRunPanelExperience?b.default.progressPanelSubtitle:b.default.progressPanelReopenedSubtitle)};t.prototype._renderPanelTitle=function(){var e=void 0,t=b.default.progressPanelTitle;if(!this.props.firstRunPanelExperience){this.state.showingTenantSiteDesigns&&(e=r.createElement(u.IconButton,{iconProps:{iconName:"Back"},onClick:this._hideTenantSiteDesigns,ariaLabel:b.default.backButtonAriaLabel}));t=this._shouldShowTenantSiteDesigns()?b.default.progressPanelOtherSiteDesignsTitle:b.default.progressPanelReopenedTitle}return r.createElement("div",{className:o.css(w.styles.progressPanelTitle,this.props.firstRunPanelExperience?w.styles.bigTitle:"")},e,t)};t.prototype._shouldShowTenantSiteDesigns=function(){return this.state.showingTenantSiteDesigns||this.state.siteDesignRuns&&0===this.state.siteDesignRuns.length};t.prototype._renderTenantSiteDesignsLink=function(){if(!this._shouldShowTenantSiteDesigns())return r.createElement(c.Link,{className:w.styles.tenantSiteDesigns,onClick:this._showTenantSiteDesigns},b.default.progressPanelSeeOtherDesignsLink)};t.prototype._renderGearMenuHint=function(){};t.prototype._renderSiteDesignRuns=function(){var e=this.state.siteDesignRuns;return e&&e.length?r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable)},r.createElement(a.ChoiceGroup,{selectedKey:this.state.displayedRunKey,onChange:this._onRadioChanged,options:e.map(this._renderChoiceGroupOption)}),r.createElement("div",{id:this._runChooserDescribedById,className:w.styles.accessible},b.default.runChooserDescription)):r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable)})};t.prototype._renderTenantSiteDesignChooser=function(){var e=this.state.tenantSiteDesigns;if(e){var t=n.__spreadArrays([{key:"",text:b.default.siteDesignChooserNone}],e.map(this._convertTenantSiteDesignToDropdownOption));return r.createElement("div",null,r.createElement("div",{className:w.styles.siteDesignChooserTitle},b.default.siteDesignChooserTitle),r.createElement(f.Dropdown,{placeHolder:b.default.siteDesignChooserNone,onChanged:this._onTenantSiteDesignSelected,options:t,selectedKey:this.state.selectedTenantSiteDesign}),r.createElement("div",{className:w.styles.accessible,id:this._designChooserDescribedById},b.default.tenantSiteDesignChooserDescription))}return r.createElement("div",null,r.createElement(d.Spinner,null))};t.prototype._renderRightColumn=function(){return r.createElement("div",{className:o.css(w.styles.column,w.styles.rightColumn)},this._renderNavigation(),r.createElement("div",{className:w.styles.columnInternal},this._renderRightColumnHeader(),this._renderRightColumnBody(),r.createElement("div",{className:w.styles.columnFooter},this._renderDismissButtonIfNecessary())))};t.prototype._renderRightColumnHeader=function(){if(this._shouldShowTenantSiteDesigns()){if(this.state.selectedTenantSiteDesign&&this.state.selectedTenantSiteDesignSchema)return r.createElement("div",{className:w.styles.columnHeader},this._renderTenantSiteDesignTitle(this.state.selectedTenantSiteDesignSchema.siteDesignTitle))}else{var e=this._siteScriptProgressStateManager.getData(this.state.displayedRunKey);if(e&&this.state.stagesRetrieved&&this.state.age!==m.SiteScriptRunAge.unknown)return r.createElement("div",{className:w.styles.columnHeader},this._renderProgressIndicator(e))}};t.prototype._renderRightColumnBody=function(){if(this._shouldShowTenantSiteDesigns()){if(!this.state.selectedTenantSiteDesign){var e=void 0;e=v.Killswitch.isActivated("c699dc3e-812b-49c7-9845-ba97f7d064e8","06/27/2019","SITE_DESIGN_OVERVIEW_URL_Localizable")?"http://aka.ms/spsitedesigns/":i.format("https://docs.microsoft.com/{0}/sharepoint/dev/declarative-customization/site-design-overview?branch=sitedesign",this.props.pageContext.currentUICultureName);return r.createElement("div",{className:o.css(w.styles.columnBody)},r.createElement("div",{className:w.styles.explainerTitle},b.default.progressPanelExplainerTitle),r.createElement("div",null,b.default.progressPanelExplainerText),r.createElement("div",{className:w.styles.explainerLink},r.createElement(c.Link,{href:e,target:"_blank"},b.default.progressPanelExplainerLink)))}if(this.state.selectedTenantSiteDesignSchema)return r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable,w.styles.schemaArea)},this._renderPanelContents(this.state.selectedTenantSiteDesignSchema,void 0,!0))}else{var t=this._siteScriptProgressStateManager.getData(this.state.displayedRunKey);if(t&&this.state.stagesRetrieved&&this.state.age!==m.SiteScriptRunAge.unknown)return r.createElement("div",{className:o.css(w.styles.columnBody,w.styles.scrollable,w.styles.schemaArea)},this._renderPanelContents(t.siteScriptData,t.stageResultData,!1))}return r.createElement("div",{className:w.styles.columnBody},this._renderEmptyState())};t.prototype._renderEmptyState=function(){return r.createElement("div",null,r.createElement(d.Spinner,{label:b.default.emptyStateText}))};t.prototype._renderProgressIndicator=function(e){if(this.state.age===m.SiteScriptRunAge.old){var t=this.props.siteScriptProgressStateManager.getSiteDesignRun(this.state.displayedRunKey);if(t)return r.createElement("div",{className:w.styles.progressIndicatorContainer},r.createElement("div",{className:w.styles.noProgressIndicator},e.siteScriptData.siteDesignTitle),r.createElement("div",{className:w.styles.siteScriptProgressSubtext},i.format(b.default.progressPanelVersionAndDateRanText,t.version,t.runDate)))}var n=void 0;this._siteScriptProgressStateManager.isRunComplete(this.state.displayedRunKey)||this.props.firstRunPanelExperience||(n=r.createElement("div",{className:w.styles.siteScriptLongRunningText},b.default.longRunningSiteDesignText));var s=this._siteScriptProgressStateManager.getCompletionRatio(this.state.displayedRunKey),o=this._getCompletionPercentage(s);return r.createElement("div",{className:w.styles.progressIndicatorContainer},r.createElement(p.ProgressIndicator,{label:e.siteScriptData.siteDesignTitle,percentComplete:s}),r.createElement("span",{className:w.styles.siteScriptProgressSubtext,role:"alert"},o),n)};t.prototype._renderTenantSiteDesignTitle=function(e){return r.createElement("div",{className:w.styles.progressIndicatorContainer},r.createElement("div",{className:w.styles.tenantSiteDesignTitle},e),r.createElement(u.PrimaryButton,{ariaLabel:b.default.applySiteDesignButtonText,disabled:!1,onClick:this._applySelectedTenantSiteDesign,text:b.default.applySiteDesignButtonText}))};t.prototype._renderPanelContents=function(e,t,n){var i=[],s=0;if(e&&e.siteScripts)for(var o=0;o<e.siteScripts.length;o++)for(var u=0;u<e.siteScripts[o].actions.length;u++){i.push(r.createElement(g.SiteScriptActionLabel,{key:"scriptAction_"+o.toString()+"_"+u.toString(),stageNames:e.siteScripts[o].actions[u].stages,stageResultData:t,stageOutcomesKnown:this.state.stageOutcomesKnown,stageStartIndex:s,demoMode:n}));s+=e.siteScripts[o].actions[u].stages.length}return i};t.prototype._renderDismissButtonIfNecessary=function(){return this.state.hasARunCompleted||this.props.firstRunPanelExperience&&this._siteScriptProgressStateManager.isRunComplete(this.state.displayedRunKey)?r.createElement(u.PrimaryButton,{ariaLabel:b.default.progressPanelDismissAndRefreshButtonText,"data-automationid":"SiteScriptProgressCloseButton",disabled:!1,onClick:this._dismissAndRefresh,text:b.default.progressPanelDismissAndRefreshButtonText}):void 0};t.prototype._onPanelDismissedInternal=function(){this.props.onDismissed&&this.props.onDismissed();this._siteScriptProgressStateManager.hideTenantSiteDesigns()};t.prototype._getCompletionPercentage=function(e){if(e>=1)return b.default.progressPanelCompleteStatus;if(e<=0)e=0;else{e*=100;e=Math.floor(e)}return i.format(b.default.progressPanelPercentComplete,e)};return t})(r.Component);t.SiteScriptProgressPanel=E});
define("net",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.styles={accessible:"ms-siteScriptProgress-accessible",siteScriptLongRunningText:"ms-siteScriptProgress-siteScriptLongRunningText",schemaArea:"ms-siteScriptProgress-schemaArea",workingImage:"ms-siteScriptProgress-workingImage",columnInternal:"ms-siteScriptProgress-columnInternal",siteDesignLogoImage:"ms-siteScriptProgress-siteDesignLogoImage",darker:"ms-siteScriptProgress-darker",xButton:"ms-siteScriptProgress-xButton",navigation:"ms-siteScriptProgress-navigation",siteDesignDescription:"ms-siteScriptProgress-siteDesignDescription",explainerLink:"ms-siteScriptProgress-explainerLink",explainerTitle:"ms-siteScriptProgress-explainerTitle",scrollable:"ms-siteScriptProgress-scrollable",siteDesignChooserTitle:"ms-siteScriptProgress-siteDesignChooserTitle",tenantSiteDesignTitle:"ms-siteScriptProgress-tenantSiteDesignTitle",gear:"ms-siteScriptProgress-gear",noProgressIndicator:"ms-siteScriptProgress-noProgressIndicator",bigTitle:"ms-siteScriptProgress-panelBigTitle",runChoiceChecked:"ms-siteScriptProgress-runChoiceChecked",runChoiceRoot:"ms-siteScriptProgress-runChoiceRoot",runChoiceRadio:"ms-siteScriptProgress-runChoiceRadio",runChoiceText:"ms-siteScriptProgress-runChoiceText",runChoicePrimaryText:"ms-siteScriptProgress-runChoicePrimaryText",runChoiceSecondaryText:"ms-siteScriptProgress-runChoiceSecondayText",runChoiceArrow:"ms-siteScriptProgress-runChoiceArrow",tenantSiteDesigns:"ms-siteScriptProgress-tenantSiteDesignsLink",column:"ms-siteScriptProgress-column",leftColumn:"ms-siteScriptProgress-leftColumn",rightColumn:"ms-siteScriptProgress-rightColumn",columnFooter:"ms-siteScriptProgress-columnFooter",columnBody:"ms-siteScriptProgress-columnBody",columnHeader:"ms-siteScriptProgress-columnHeader",panelBottomTextBold:"ms-siteScriptProgress-panelBottomTextBold",siteScriptProgressPanelRoot:"ms-siteScriptProgress-panelRoot",siteScriptProgressPanel:"ms-siteScriptProgress-panel",emptyStageContainer:"ms-siteScriptProgress-emptyStageContainer",errorIcon:"ms-siteScriptProgress-errorIcon",errorText:"ms-siteScriptProgress-errorText",inProgressSpinner:"ms-siteScriptProgress-inProgressSpinner",actionIcon:"ms-siteScriptProgress-actionIcon",successIcon:"ms-siteScriptProgress-successIcon",activeActionTitle:"ms-siteScriptProgress-activeActionTitle",actionTitle:"ms-siteScriptProgress-actionTitle",actionTitleNoIcon:"ms-siteScriptProgress-actionTitleNoIcon",incompleteIcon:"ms-siteScriptProgress-incompleteIcon",inactiveActionTitle:"ms-siteScriptProgress-inactiveActionTitle",stageTitle:"ms-siteScriptProgress-stageTitle",siteScriptProgressSubtext:"ms-siteScriptProgress-siteScriptProgressSubtext",progressIndicatorContainer:"ms-siteScriptProgress-progressIndicatorContainer",progressPanelTitle:"ms-siteScriptProgress-panelTitle",progressPanelSubtitle:"ms-siteScriptProgress-panelSubtitle",titleContainer:"ms-siteScriptProgress-titleContainer",actionContainer:"ms-siteScriptProgress-actionContainer",emptyStageProgressIndicator:"ms-siteScriptProgress-emptyStageProgressIndicator",stageContainer:"ms-siteScriptProgress-stageContainer",actionHeader:"ms-siteScriptProgress-actionHeader"}});
define("QYe",["require","exports","ww","_A","ZYe","XYe","iGe","YYe","wie","Iie","W","bF"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;(function(e){e[e.NO_VIEW=0]="NO_VIEW";e[e.DIRTY_VIEW=1]="DIRTY_VIEW";e[e.CLEAN_VIEW=2]="CLEAN_VIEW"})(h||(h={}));var p=(function(){function e(e){var t=this;this._onDismiss=function(){t._params.contentTypeManagementPanelContainer.state.isPanelOpen&&t._params.contentTypeManagementPanelContainer.setState({isPanelOpen:!1});t._params.contentTypeManagementPanelContainer.props.resolve()};this._getSiteContentTypesAvailableForList=function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this.contentTypeProvider.loadContentTypesDetailedAvailableForList()]})})};this._getSiteContentType=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.loadContentType(e)]})})};this._getListContentTypes=function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this.contentTypeProvider.loadListContentTypesDetailed("$filter=custom ne null")]})})};this._getContentTypeColumns=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.loadReorderableContentTypeColumns(e)]})})};this._getListContentTypeColumns=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.loadReorderableListContentTypeColumns(e)]})})};this._addContentTypesToList=function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,i,s,o,u,a,f,p,d,v,m,g,y,b,w,E;return n.__generator(this,function(S){switch(S.label){case 0:t=[];r=[];i=[];s=0,o=e;S.label=1;case 1:if(!(s<o.length))return[3,5];y=o[s];t.push(y.id);y.createNewView&&r.push(y);if(!y.addColumnsToCurrentView)return[3,4];if(y.columns)return[3,3];u=y;return[4,this._getContentTypeColumns(y.id)];case 2:u.columns=S.sent();S.label=3;case 3:y.columns.forEach(function(e){return i.push(e.name)});S.label=4;case 4:s++;return[3,1];case 5:a=new l.Qos({name:"ContentTypeManagementPanel.addContentTypesToList"});f=[];S.label=6;case 6:S.trys.push([6,8,,9]);return[4,this.contentTypeProvider.addContentTypesToList(t)];case 7:f=S.sent();a.end({resultType:l.ResultTypeEnum.Success});return[3,9];case 8:p=S.sent();this.handleError(a,p);return[2];case 9:if(!((r=this._updateToListContentTypes(r,f))&&r.length>=0))return[3,20];d=new l.Qos({name:"ContentTypeManagementPanel.CreateNewView"});v={};this._params.contentTypeManagementPanelContainer.props.views&&this._params.contentTypeManagementPanelContainer.props.views.forEach(function(e){if(e){var t=c.parseView(e.ListViewXml);t.associatedContentTypeId&&(v[t.associatedContentTypeId]=n.__assign(n.__assign({},e),{arrangedColumns:t.fieldNames}))}});S.label=10;case 10:S.trys.push([10,19,,20]);m=0,g=r;S.label=11;case 11:if(!(m<g.length))return[3,18];y=g[m];b=y;return[4,this._getListContentTypeColumns(y.id)];case 12:b.columns=S.sent();w=this.getExistingViewInfo(y,v);switch(w.status){case h.NO_VIEW:return[3,13];case h.DIRTY_VIEW:return[3,15]}return[3,17];case 13:return[4,this._createContentTypeView(y)];case 14:S.sent();return[3,17];case 15:return[4,this.updateViewWithNewColumns(v[y.parentReference.id],w.newColumnsNeeded)];case 16:S.sent();return[3,17];case 17:m++;return[3,11];case 18:d.end({resultType:l.ResultTypeEnum.Success});return[3,20];case 19:E=S.sent();this.handleError(d,E);return[2];case 20:this._onDismiss();this._params.contentTypeManagementPanelContainer.props.onSuccess&&this._params.contentTypeManagementPanelContainer.props.onSuccess(i);return[2]}})})};this._createContentTypeView=function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.contentTypeProvider.createContentTypeView(e)]})})};this._deleteContentType=function(e){return n.__awaiter(t,void 0,void 0,function(){var t=this;return n.__generator(this,function(n){return[2,this.contentTypeProvider.deleteListContentType(e).then(function(){t._params.contentTypeManagementPanelContainer.props.onSuccess([])})]})})};this._updateToListContentTypes=function(e,t){return t=t.filter(function(t){for(var n=0,r=e;n<r.length;n++){if(r[n].id===t.parentReference.id)return!0}return!1})};this.handleError=function(e,n){e.end({resultType:l.ResultTypeEnum.Failure,error:n});t._params.contentTypeManagementPanelContainer.setState({hasError:!0})};this.getExistingViewInfo=function(e,t){if(!(e.parentReference.id in t))return{status:h.NO_VIEW};var n=new Set;t[e.parentReference.id].arrangedColumns.forEach(function(e){return n.add(e)});for(var r=[],i=0,s=e.columns;i<s.length;i++){var o=s[i];n.has(o.name)||r.push(o.name)}return r.length>0?{status:h.DIRTY_VIEW,newColumnsNeeded:r}:{status:h.CLEAN_VIEW}};this.updateViewWithNewColumns=function(e,r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(i){if(r&&r.length>0){t=n.__spreadArrays(e.arrangedColumns,r);this._params.contentTypeManagementPanelContainer.props.updateViewWithNewColumns&&this._params.contentTypeManagementPanelContainer.props.updateViewWithNewColumns(e.Id,t)}return[2]})})};this._params=e;var r=this._params.contentTypeManagementPanelContainer.props.pageContext;this.contentTypeProvider=new u.default(new s.default({pageContext:r,oAuthTokenProvider:new a.default({},{oAuthTokenDataSource:new f.default(r)})}),new o.default(r,e.contentTypeManagementPanelContainer.props.getOAuthToken),r);this._params.contentTypeManagementPanelContainer.state={isPanelOpen:!0,hasError:!1}}e.prototype.getRenderProps=function(){var e=this._params.contentTypeManagementPanelContainer.state,t=i.fillInContentTypeManagementPanelStrings(this._params.strings),n=i.fillInContentTypeManagementPanelErrorStrings(this._params.errorStrings);return{panelProps:{type:r.PanelType.custom,isOpen:e.isPanelOpen,customWidth:"70%",onDismiss:this._onDismiss,isLightDismiss:!0,hasCloseButton:!1,onRenderNavigation:function(){return null},styles:{content:{padding:"0px",margin:"0px"}}},strings:t,errorStrings:n,hasErrorOccurred:e.hasError,onDismiss:this._onDismiss,getSiteContentTypes:this._getSiteContentTypesAvailableForList,getSiteContentType:this._getSiteContentType,getListContentTypes:this._getListContentTypes,getContentTypeColumns:this._getContentTypeColumns,getListContentTypeColumns:this._getListContentTypeColumns,addContentTypesToList:this._addContentTypesToList,removeContentType:this._deleteContentType}};return e})();t.ContentTypeManagementPanelContainerStateManager=p});
define("ZYe",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MockContentTypeManagementPanelStrings={title:null,closeButtonAriaLabel:null,dropdownNoneLabel:null,dropdownLabel:null,dropdownTitleSelectedLabel:null,addedContentTypes:null,selectedContentTypesColumnKey:null,nameLabel:null,parentLabel:null,descriptionLabel:null,columnsLabel:null,cancelButtonLabel:null,applyButtonLabel:null,addColumnCurrentViewLabel:null,createNewViewLabel:null,defaultSecondaryPanelLabel:null,contentTypeInformationLabel:null,secondaryPanelFieldsListNameDisplayName:null,secondaryPanelFieldsListTypeDisplayName:null,secondaryPanelFieldsListStatusDisplayName:null,secondaryPanelFieldsListSourceDisplayName:null,removeContentTypeButtonLabel:null,loadingContentTypesSpinner:null,applyingContentTypesSpinner:null,tooltipReadonlyCT:null,ariaLabelAddedCT:null,ariaLabelCTLoaded:null};t.MockContentTypeManagementPanelErrorStrings={cannotRemoveContentType:null,genericErrorMessage:null};t.fillInContentTypeManagementPanelStrings=function(e){var r=n.__assign({},t.MockContentTypeManagementPanelStrings);for(var i in t.MockContentTypeManagementPanelStrings)r[i]=e[i]?e[i]:i;return r};t.fillInContentTypeManagementPanelErrorStrings=function(e){var r=n.__assign({},t.MockContentTypeManagementPanelErrorStrings);for(var i in t.MockContentTypeManagementPanelErrorStrings)r[i]=e&&e[i]?e[i]:i;return r}});
define("tP",["require","exports","ww","OP","eM","A","C","dP","oP","rP","nP","ie","me","t2","nM","q"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(){function e(e){this._iframe=document.createElement("iframe");this._form=document.createElement("form");this._formInput=document.createElement("input");this._signal=new o.default;this._context=e.context;this._iframeWidth=0;this._iframeHeight=0;this._timeoutId=-1;this._isShareReady=!1;this._iframeUrl="";this._iframeBaseUrl="";this._messagesReceived={};this._props=e;this._receiveMessageBound=this._receiveMessage.bind(this);this._elementWindow=this._props.elementWindow||window;this._manager=c.createManager();this._sessionQos=new(v.Qos.withManager(this._manager))({name:"SharingSession."+u.Mode[e.context.mode||u.Mode.share]});if(!this._context.authToken)throw new Error("An access token is required for SharePrefetch optimization");new l.WebSharedAriaTelemetryHandler({clientName:this._context.clientId,userAuthToken:this._context.authToken}).attach(this._manager);switch(e.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com";this._iframeUrl=e.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms"}var t=this._props.isConsumer;if(!this._iframeUrl){var n=t?"&consumer=true":"";this._iframeUrl=this._iframeBaseUrl+"/share?smkt="+e.locale+n}this._iframeStartTime=new Date;this._initializeIframe();e.element.appendChild(this._iframe);if(t){this._initializeForm();e.element.appendChild(this._form)}}e.prototype.initializeUI=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,i,o,a,f,l,c=this;return n.__generator(this,function(h){e=this._context&&this._context.correlationId;t=this._props.isConsumer;r=this._context.mode===u.Mode.copy&&"teams"===this._context.clientId&&!this._context.shareId;i=r?this._getDefaultLink():Promise.resolve(void 0);o=t?Promise.resolve(void 0):this._getSharingInformation();a=t?Promise.resolve(void 0):this._signal.getPromise();this._isShareReady=!1;Promise.all([this._toTuple(i),this._toTuple(o),this._toTuple(a)]).then(function(r){var i=r[0],o=r[1];r[2];try{var u=!1;if(!t){var a=c._props.options.onError;if(c._isError(i)){u=!0;a&&a({name:"SharePrefetchError",message:"",error:i.error,resultCode:s.default.isCanceled(i.error)?"Canceled":d.getResultCodeFromError(i.error)})}if(c._isError(o)){u=!0;var f=o.error,l={code:f.code,status:f.status};a&&a({name:"SharePrefetchError",message:"",error:f,resultCode:s.default.isCanceled(o.error)?"Canceled":"["+l.status.toString()+"] "+(l.code||"Unknown")})}}var h=c._iframe.contentWindow;if(h&&!t){var p=c._props.options.spRestTokenProvider,m=n.__assign(n.__assign({},c._context),{rawInvite:i.value,sharingInformation:o.value,hasTokenProvider:!!p&&!!p.getAuthToken});h.postMessage(m,c._iframeUrl)}else if(t){c._formInput.value=JSON.stringify(c._context);c._form.submit()}else u||c._sessionQos.end({resultType:v.ResultTypeEnum.ExpectedFailure,resultCode:"abandoned",extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:c._elementWindow.document.body.contains(c._iframe),messagesReceived:Object.keys(c._messagesReceived).join(","),mode:c._context.mode,correlationId:e}})}catch(t){c._sessionQos.end({resultType:v.ResultTypeEnum.Failure,extraData:{unhandledError:t.toString(),correlationId:e}})}});if(!this._props.disableIframeDomainCheck){f=!this._props.iframeCheckTimeout||this._props.iframeCheckTimeout<=0?8e3:this._props.iframeCheckTimeout;setTimeout(function(){if(!c._scriptsLoadedTime){var t=new Image;t.onerror=function(){var t="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),n=c._props.options&&c._props.options.onError;n&&n({name:"SharePrefetchError",message:t,error:new Error(t),debugErrorMessage:"Unable to reach "+c._iframeBaseUrl+" domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges",resultCode:t});c._sessionQos.end({resultType:v.ResultTypeEnum.ExpectedFailure,resultCode:t,extraData:{mode:c._context.mode,iframeBaseUrl:c._iframeBaseUrl,correlationId:e}});clearTimeout(c._timeoutId)};t.src=c._iframeBaseUrl+"/favicon.ico?"+Math.random()}},f)}l=this._props.timeout||45e3;this._timeoutId=setTimeout(function(){return n.__awaiter(c,void 0,void 0,function(){var t,r,s,u,a,f,c,h,p,d;return n.__generator(this,function(n){switch(n.label){case 0:r=!1;n.label=1;case 1:n.trys.push([1,3,,4]);return[4,o];case 2:s=n.sent();r=!!s;return[3,4];case 3:u=n.sent();t=u;return[3,4];case 4:f=!1;n.label=5;case 5:n.trys.push([5,7,,8]);return[4,i];case 6:c=n.sent();f=!(!c||!c);return[3,8];case 7:h=n.sent();a=h;return[3,8];case 8:p={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:r,getSharingError:t,inviteHasData:f,inviteError:a,timeout:l,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,correlationId:e};this._showShareUX();(d=this._props.options&&this._props.options.onTimeout)&&d();this._sessionQos.end({resultType:v.ResultTypeEnum.Failure,resultCode:"timeout",extraData:p});return[2]}})})},l);return[2]})})};e.prototype.dispose=function(){var e=this._context&&this._context.correlationId;clearTimeout(this._timeoutId);this._messagesReceived.sharePrefetch_dispose=!0;this._elementWindow.removeEventListener("message",this._receiveMessageBound);this._props.element.removeChild(this._iframe);this._sessionQos.end({resultType:v.ResultTypeEnum.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,correlationId:e,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}})};e.prototype._getDefaultLink=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,o,u=this;return n.__generator(this,function(n){switch(n.label){case 0:e=new i.default({},{urlDataSource:{getApiBaseUrl:function(){return u._context.webAbsoluteUrl+"/_api/v2.0"}},sessionManagementProvider:this._props.options.graphTokenProvider||{getToken:function(){return s.default.resolve({accessToken:u._context.authToken})}},apiEvent:h.Api.withManager(this._manager)});t=new r.default({},{dataRequestor:e});o=[];this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(o=this._context.defaultRecipients.map(function(e){return{email:e}}));return[4,this._context.uniqueId?t.getDefaultLinkByUniqueId(this._context.uniqueId||"",o,!this._props.disableUseMultiPart):t.getDefaultLink(this._context.itemUrl||"",o,!this._props.disableUseMultiPart)];case 1:return[2,{value:n.sent()}]}})})};e.prototype._getSharingInformation=function(){var e={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},t=this._props.options.spRestTokenProvider,r=this._manager,i=new a.SharingDataSource({pageContext:e,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:e,dataRequestorType:(function(i){n.__extends(s,i);function s(n){return i.call(this,n,{pageContext:e,apiEvent:h.Api.withManager(r),tokenProvider:t})||this}return s})(p.DataRequestor),tokenProvider:t}),s=new f.SharingProvider({pageContext:e,getParentListId:this._getParentListId,itemProvider:{invalidateItem:function(){}},sharingDataSource:i}),o=this._context.mode===u.Mode.copy||this._context.mode===u.Mode.linkSettings;return s.getSharingInformation({key:"",name:this._context.itemName,properties:{}},o,!0)};e.prototype._initializeIframe=function(){var e=this;this._elementWindow.addEventListener("message",this._receiveMessageBound,!1);this._iframe.name="shareFrame";this._iframe.onload=function(){e._iframeLoadedTime=(new Date).getTime()-e._iframeStartTime.getTime()};this._iframe.src=this._iframeUrl;this._iframe.style.width="0px";this._iframe.style.height="0px";this._iframe.style.visibility="hidden";var t=this._props.styles;t&&t.border?this._iframe.style.border=t.border:this._iframe.style.border="0";if(t){t.margin&&(this._iframe.style.margin=t.margin);t.minWidth&&(this._iframe.style.minWidth=t.minWidth);t.minHeight&&(this._iframe.style.minHeight=t.minHeight)}};e.prototype._initializeForm=function(){this._form.target="shareFrame";this._form.method="POST";this._form.action=this._iframeUrl;this._form.style.display="none";this._formInput.type="text";this._formInput.name="context";this._form.appendChild(this._formInput);var e=document.createElement("input");e.type="submit";this._form.appendChild(e)};e.prototype._showShareUX=function(){this._isShareReady=!0;this._iframe.style.visibility="visible";this._iframe.style.height=(this._iframeHeight||400)+"px";this._iframe.style.width=(this._iframeWidth||320)+"px";var e=this._iframe.contentWindow;e&&e.focus();clearTimeout(this._timeoutId)};e.prototype._receiveMessage=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s,o,u,a,f,l,c,h,p,d,m,g,y,b,w,E,S;return n.__generator(this,function(n){switch(n.label){case 0:t=this._context&&this._context.correlationId;try{r=e&&e.data&&JSON.parse(e.data)}catch(e){return[2]}try{if(!this._elementWindow.document.body.contains(this._props.element)){this._messagesReceived.sharePrefetch_selfDispose=!0;this.dispose();return[2]}}catch(e){}i=r.name;this._messagesReceived[i||""]=!0;switch(i){case"share_scriptsLoaded":return[3,1];case"share_resize":return[3,2];case"share_started":return[3,3];case"share_ready":return[3,4];case"share_error":return[3,5];case"share_completed":return[3,6];case"share_dismiss":return[3,7];case"share_manageAccessClicked":return[3,8];case"share_linkSettingsCompleted":return[3,9];case"share_grantAccessCompleted":return[3,10];case"share_getToken":return[3,11]}return[3,18];case 1:this._scriptsLoadedTime=new Date;this._signal.complete();(s=this._props.options&&this._props.options.onScriptsLoaded)&&s();return[3,18];case 2:(o=this._props.options&&this._props.options.onResize)&&r.width&&r.height&&o(r.width,r.height);this._iframeWidth=r.width||320;this._iframeHeight=r.height||400;if(this._isShareReady){this._iframe.style.height=this._iframeHeight+"px";this._iframe.style.width=this._iframeWidth+"px"}return[3,18];case 3:(u=this._props.options&&this._props.options.onStarted)&&u();return[3,18];case 4:this._showShareUX();a={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId,correlationId:t};this._sessionQos.end({resultType:v.ResultTypeEnum.Success,extraData:a});(f=this._props.options&&this._props.options.onReady)&&f();return[3,18];case 5:this._showShareUX();l=this._props.options&&this._props.options.onError;c=JSON.parse(r.debugErrorMessage||"{}");h=c.code||c.status||"ShareError: ["+r.error+"]";this._sessionQos.end({resultType:v.ResultTypeEnum.Failure,resultCode:h,extraData:{correlationId:t}});l&&l({name:"SharePrefetchError",message:r.errorMessage||"",error:r.error,debugErrorMessage:r.debugErrorMessage,errorMessage:r.errorMessage,resultCode:h});return[3,18];case 6:(p=this._props.options&&this._props.options.onCompleted)&&p({scope:r.scope||""});return[3,18];case 7:(d=this._props.options&&this._props.options.onDismiss)&&d();return[3,18];case 8:(m=this._props.options&&this._props.options.openManageAccess)&&m();return[3,18];case 9:(g=this._props.options&&this._props.options.onLinkSettingsComplete)&&g(r);return[3,18];case 10:y=this._props.options&&this._props.options.onGrantAccessComplete;r.successful&&y&&y();return[3,18];case 11:b=new v.Qos({name:"SharingSession.GetToken"});if(!(w=this._iframe.contentWindow)){b.end({resultType:v.ResultTypeEnum.Failure,error:"no_window"});return[3,18]}if(!this._props.options.spRestTokenProvider||!this._props.options.spRestTokenProvider.getAuthToken)return[3,16];n.label=12;case 12:n.trys.push([12,14,,15]);return[4,this._props.options.spRestTokenProvider.getAuthToken(r)];case 13:if(E=n.sent()){w.postMessage(JSON.stringify({name:"share_newToken",token:E}),this._iframeUrl);b.end({resultType:v.ResultTypeEnum.Success})}else{w.postMessage(JSON.stringify({name:"share_newToken",error:"no_token"}),this._iframeUrl);b.end({resultType:v.ResultTypeEnum.Failure,error:"no_token"})}return[3,15];case 14:S=n.sent();w.postMessage(JSON.stringify({name:"share_newToken",error:"token_exception",errorDetails:S}),this._iframeUrl);b.end({resultType:v.ResultTypeEnum.Failure,error:String(S)});return[3,15];case 15:return[3,17];case 16:w.postMessage(JSON.stringify({name:"share_newToken",error:"no_handler"}),this._iframeUrl);b.end({resultType:v.ResultTypeEnum.Failure,error:"no_handler"});n.label=17;case 17:return[3,18];case 18:return[2]}})})};e.prototype._getParentListId=function(e){return""};e.prototype._toTuple=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);t={};return[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})};e.prototype._isError=function(e){return!!e.error};return e})();t.SharePrefetch=m});
define("nqe",["require","exports","ww","r","oL","pc","aqe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={root:{paddingBottom:8},subComponentStyles:{label:{root:{paddingTop:0}}}};t.HyperlinkControl=r.memo(function(e){var t=s.getNativeProps(e,s.divProperties);return r.createElement("div",n.__assign({},t),r.createElement(i.TextField,{label:o.default.Link,styles:u,value:e.linkText,onChange:e.onLinkTextChange,placeholder:o.default.LinkPlaceholder}),r.createElement(i.TextField,{label:o.default.Display,value:e.displayText,onChange:e.onDisplayTextChange,placeholder:o.default.DisplayPlaceholder}))})});
define("GB",["require","exports","ww","r","HB","ZB","od","FS","ODBItemsScopeDeferred_mini_css","wB","JB","Oe","ot","KB","IB","CB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";a=a.Conversations_module_6;Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._conversation=function(e,n){var s=t._context(e),f=e.deepLink,l=t._getIconName(e.conversationType),c=t._participants(e),h=e.referencePreview,p=u.getFriendlyDateTimeStringPast(new Date(e.activityTimestamp));return r.createElement("div",{key:n},r.createElement("div",{className:a.fileHoverCardConversation,onClick:function(){var e=window.open(f,"_blank");e&&e.focus();t.context.logData("FileHoverCard.Conversations.ClickDeepLink",{})}},r.createElement(i.ActivityItem,{activityIcon:r.createElement(o.Icon,{iconName:l,className:a.fileHoverCardConversationIcon}),activityDescription:c,comments:r.createElement(r.Fragment,null,s,r.createElement("div",{className:a.fileHoverCardConversationReferencePreview},h)),timeStamp:p})))};return t}t.prototype.render=function(){var e=this.props.conversations;return p.isConversationsExperimentOn()&&r.createElement("div",{className:a.fileHoverCardConversationsSection,style:d.isCollapsedSectionsEnabled()?{borderTop:0}:{}},!d.isCollapsedSectionsEnabled()&&r.createElement("div",{className:a.fileHoverCardConversationsTitle},f.default.ConversationsTitle),e.slice(0,3).map(this._conversation))};t.prototype._context=function(e){var t=e.context,n=r.createElement(r.Fragment,null),i=a.fileHoverCardConversationContext;if(e.conversationType===s.ConversationType.CalendarEvent){t=c.format(f.default.MeetingsConversationsSubject,e.context);n=r.createElement(o.Icon,{iconName:"Event",className:a.fileHoverCardConversationsMeetingIcon});i=a.fileHoverCardMeetingConversationContext}var u=0===t.length?r.createElement(r.Fragment,null):r.createElement("div",{className:i},t);return r.createElement(r.Fragment,null,n,u)};t.prototype._participants=function(e){var t,n=this;t=e.participants.filter(function(t){return t.identity.displayName&&!n._isSharedByUser(t.identity.email,e.sharedByUserEmail,t.identity.displayName,e.sharedByUserDisplayName)}).map(function(e){return l.isCurrentLoginUser(e.identity.email,n.props.loginUserEmail,n.props.userEmail)?f.default.you:e.identity.displayName}).join(", ");var i=e.isSharedByMe?f.default.you:e.sharedByUserDisplayName;return r.createElement("div",{className:a.fileHoverCardConversationParticipants},r.createElement("span",{className:a.fileHoverCardConversationSharedByUser},0===t.length?i:i+", "),t)};t.prototype._isSharedByUser=function(e,t,n,r){return e.toLowerCase()===t.toLowerCase()||n.toLowerCase()===r.toLowerCase()};t.prototype._getIconName=function(e){var t=e===s.ConversationType.CalendarEvent||e===s.ConversationType.Mail?h.getBrandTypeIconProps({extension:"",brand:"outlook"}):h.getBrandTypeIconProps({extension:"",brand:"teams"});if(t)return t.iconName};return t})(r.PureComponent);t.Conversations=m;m.contextType=v.EngagementContext});
define("KB",["require","exports","Le","WB"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={ODB:1153,OneDrive:!0};t.isConversationsExperimentOn=function(){if(n.default.isFeatureEnabled(i)){return new r.ABExperiment({name:"ConversationsExperiment",startDate:"11/8/2019"}).IsExperimentOn()}return!0}});
define("VB",["require","exports","r","HB","od","ODBItemsScopeDeferred_mini_css","wB","Md","Bc","IB","lb","Wv","$p","Tc"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";s=s.RelatedFiles_module_4;Object.defineProperty(t,"__esModule",{value:!0});var d=3;t.RelatedFiles=function(e){return n.createElement("div",{className:s.fileHoverCardRelatedFilesSection,style:f.isCollapsedSectionsEnabled()?{borderTop:0}:{}},!f.isCollapsedSectionsEnabled()&&n.createElement("div",{className:s.fileHoverCardRelatedFilesTitle},o.default.RelatedFilesTitle),e.relatedFilesKeys.slice(0,d).map(function(e,t){return(function(e,t){return n.createElement(u.WithItemCache,{key:t},function(o){var u,f=o.itemCache,d=f.demandItemFacet(a.displayNameFacet,e),v=(function(e){if(!e)return;var t=l.getFileTypeIconProps({extension:e,size:16});return t?t.iconName:void 0})(null===(u=d)||void 0===u?void 0:u.split(".")[1]),m=c.evaluateItemCacheComponent(f,n.createElement(h.ItemOpenUrlAction,{itemKey:e,engagement:{name:"FileHoverCard.RelatedFiles.ClickDeepLink"}}));return n.createElement(p.WithAction,{action:m},function(e){var o=e.execute;return n.createElement("div",{key:"relatedFile_"+t},n.createElement("div",{className:s.fileHoverCardRelatedFile,onClick:function(){o()}},n.createElement(r.ActivityItem,{activityIcon:n.createElement(i.Icon,{iconName:v,className:s.fileHoverCardRelatedFileIcon}),activityDescription:n.createElement(n.Fragment,null,n.createElement("div",{className:s.fileHoverCardRelatedFilesName},d)),isCompact:!0})))})})})(e,t)}))}});
define("aj",["require","exports","r","bl","Oe","JB","wB","ODBItemsScopeDeferred_mini_css","yh","FS","Lf"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";u=u.AnalyticsLifeCycle_module_8;Object.defineProperty(t,"__esModule",{value:!0});var c="https://go.microsoft.com/fwlink/?linkid=862871";t.AnalyticsLifeCycle=function(e){var t,n,r,u,p,d,v=e.lifeCycleSignalData,m=e.loginUserEmail,g=e.userEmail,y=e.createdBy,b=e.createdDateTime,w=e.onRenderLifeCycleSignal,E=v.signal;switch(v.key){case a.malwareSignalKey:t=o.default.malwareDetected;n=c;p=o.default.learnMore;break;case a.youCheckedOutSignalKey:t=o.default.youHaveThisCheckedOut;r=e.onCheckIn;u=e.onDiscardCheckOut;p=e.onCheckIn?o.default.checkIn:void 0;d=e.onDiscardCheckOut?o.default.discardCheckOut:void 0;break;case a.someoneCheckedOutSignalKey:t=v.title;break;case a.dlpBlockedSignalKey:t=o.default.DLPBlocked;r=e.onViewPolicyTip;p=o.default.viewPolicyTip;break;case a.missingMetadataSignalKey:t=o.default.missingMetaData;r=e.onAddMetadataNow;p=o.default.addMetaData;break;case a.dlpWarningSignalKey:t=o.default.DLPWarning;r=e.onViewPolicyTip;p=o.default.viewPolicyTip;break;case a.trendingSignalKey:t=v.title;break;case a.newSignalKey:var S=b&&f.getFriendlyDateTimeStringPast(new Date(b));t=y&&y.email&&s.isCurrentLoginUser(y.email,m,g)?i.format(o.default.youCreated,S):i.format(o.default.otherCreated,S,y&&y.displayName);break;default:E=null}return(w?l.composeRenderFunctions(w,h):h)({signal:E,content:t,action:r,actionName:p,secondaryAction:u,secondaryActionName:d,link:n})};function h(e){return e&&e.signal?n.createElement("div",{className:u.fileHoverCardLifeCycle},e.signal,n.createElement("div",{className:u.fileHoverCardLifeCycleMessage},e.content&&n.createElement("div",{className:u.fileHoverCardLifeCycleTitle},e.content),(e.action||e.link)&&n.createElement(r.Link,{className:u.fileHoverCardLifeCycleAction,href:e.link,target:e.link&&"_blank",onClick:e.action},e.actionName),e.secondaryAction&&" "+o.default.Or+" ",e.secondaryAction&&n.createElement(r.Link,{className:u.fileHoverCardLifeCycleAction,onClick:e.secondaryAction},e.secondaryActionName))):null}});
define("OB",["require","exports","ww","rh","Pg","Yv","rb","Tc","Md","ec","Ah","Bc","Oe","Nc","pc","r","EB","ODBItemsScopeDeferred_mini_css","wB","IB","N6","Es","Gc","Ac"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";g=g.FileHoverCard_module_7;Object.defineProperty(t,"__esModule",{value:!0});t.CompactCard=function(e){var t=e.itemKey,T=v.useRef(null);v.useEffect(function(){T.current&&e.updateCardHeight(T.current.clientHeight)});return v.createElement(a.WithItemCache,null,function(a){var N,C=a.itemCache,k=C.demandItemFacet(c.fileNameFacet,t),L=k&&k.name,A=k&&k.extension,O=C.demandItemFacet(c.analyticsItemFacet,t),M=O&&O.itemKey,_=v.createElement("div",{className:d.css(g.fileHoverCardCompactCardTitle,(N={},N[g.titleNotExpanded]=!T.current,N)),id:"ms-FileHoverCard-title","aria-label":h.format(y.default.hoverCardTitle,L)},L),D=v.createElement("div",{className:g.fileHoverCardCompactCardTitleRegion},v.createElement(o.FileTypeIcon,{className:g.fileHoverCardCompactCardFileIcon,extension:A,size:32}),_);return v.createElement("div",{ref:T,className:d.css(g.fileHoverCardCompactCard,{isFluent:!0})},D,!(!t||!M)&&(function(e,t,o,a){var h=e.demandItemFacet(l.viewCountFacet,o),d=e.demandItemFacet(l.viewerCountFacet,o),g=e.demandItemFacet(l.likeCountFacet,o),T=e.demandItemFacet(l.commentCountFacet,o),N=e.demandItemFacet(c.openUrlFacet,t),C=e.demandItemFacet(l.activitiesFacet,o),k=C&&C.filter(function(e){return void 0!==e.access}),L=S.getTelemetry(e).telemetry,A=x.getItemEngagement(e,{itemKey:t,engagement:{isIntentional:!0}}),O=e.isItemFacetResolved(l.viewCountFacet,o)||e.isItemFacetResolved(E.errorFacet,o)?{activities:k||[],viewCount:h,viewerCount:d,likeCount:g,commentCount:T}:void 0,M=e.demandItemFacet(w.hoverCardCommandsControl,t),_=w.hoverCardCommandsControl.evaluate(M)(e,{itemKey:t}),D=_.showDetailsPane,P=_.showFileAnalytics,H={showDetails:D,showItemAnalytics:P,shareAction:v.createElement(r.ItemShareAction,{itemKey:t})},B=n.__assign({},f.selectedItemsControl.pack(function(){return{itemKeys:[t]}}));return v.createElement(s.ControlHandlerProvider,{controlHandlers:B},v.createElement(u.WithActionSet,{actions:H},function(e){var r=e.actions,s=r.showDetails,o=r.showItemAnalytics,u=r.shareAction,f=s&&s.execute?function(){L(p.Engagement).logData(n.__assign({name:"FileHoverCard.SeeDetailsClick"},A));s.execute().catch(function(){})}:void 0,l=o&&o.execute?function(){L(p.Engagement).logData(n.__assign({name:"FileHoverCard.ViewCountClick"},A));o.execute().catch(function(){})}:void 0,c=u&&u.isAvailable?function(e){if(e&&a){e.target=a;e.persist();u.execute({event:e});L(p.Engagement).logData(n.__assign({name:"FileHoverCard.CommandBar.ShareClick"},A))}}:void 0,h=n.__spreadArrays(s&&s.isAvailable?[{key:"details",title:y.default.seeDetails,name:y.default.seeDetails,ariaLabel:y.default.seeDetails,onClick:f}]:[]),d={key:"share",iconProps:{iconName:"share"},title:y.default.Share,onClick:c},g={itemAnalytics:O,isCompact:!0,isLink:o&&o.isAvailable,pageUrl:N,onClick:l,itemKey:t},w=[];c&&w.push(d);b.isSaveForLaterOn()&&i.followCommand.action&&i.followCommand.onClick&&w.unshift(n.__assign(n.__assign({},i.followCommand),{iconOnly:!0,name:void 0}));return v.createElement(m.AnalyticsActionBar,{itemKey:t,analyticsStats:g,items:w,withFacePile:!0,farItems:h})}))})(C,t,M,e.target))})}});
define("jB",["require","exports","ww","r","rh","Yv","Tc","Md","ec","dh","ys","Ah","Bc","pc","r","sj","rj","aj","ODBItemsScopeDeferred_mini_css","IB","$B","N6","$M","Es","GB","yh","k6","Zm","wB","CB","Gc","Ac","Nc","od","Hf","tc","VB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B){"use strict";y=y.FileHoverCard_module_7;Object.defineProperty(t,"__esModule",{value:!0});t.ExpandedCard=function(e){var t=e.itemKey,i=d.useContext(A.EngagementContext),f=d.useRef(null),m=r.useState(!1),w=m[0],W=m[1],X=r.useState(!0),V=X[0],$=X[1],J=r.useState(!1),K=J[0],Q=J[1],G=r.useState(!0),Y=G[0],Z=G[1],ee=r.useState(!1),te=ee[0],ne=ee[1],re=r.useState(!0),ie=re[0],se=re[1],oe=r.useState(!1),ue=oe[0],ae=oe[1],fe=r.useState(!0),le=fe[0],ce=fe[1],he=r.useState(!1),pe=he[0],de=he[1],ve=r.useState(!0),me=ve[0],ge=ve[1];d.useEffect(function(){f.current&&e.onCardExpand(f.current.clientHeight)});function ye(e,t,n,r,s,o){r(!n);if(s){i.logData(e,t);o(!1)}}return d.createElement(u.WithItemCache,null,function(r){var i=r.itemCache,u=(function(e,t){var n,r=e.demandItemFacet(h.analyticsItemFacet,t),i=r&&r.itemKey,s=e.demandItemFacet(c.viewCountFacet,i),o=e.demandItemFacet(c.viewerCountFacet,i),u=e.demandItemFacet(c.isTrendingFacet,i),a=e.demandItemFacet(c.activitiesFacet,i),f=e.demandItemFacet(c.incompleteDataFacet,i),p=e.demandItemFacet(c.keyPointsFacet,i),d=e.demandItemFacet(l.loginUserFacet,l.configurationItemKey),v=e.demandItemFacet(h.fileNameFacet,t),m=a&&a.filter(function(e){return void 0!==e.access}),g=e.demandItemFacet(c.recommendedActionsFacet,i),y=e.demandItemFacet(c.conversationsFacet,i);if(b.isRelatedFilesApiCallEnabled()){var w=e.demandItemFacet(h.relatedFilesItemSetFacet,t),E=e.demandItemFacet(H.childItemsFacet,w&&w.itemKey);n=E&&E.itemKeys}return{analyticsKey:r,itemAnalyticsKey:i,viewCount:s,viewerCount:o,isTrending:u,activities:a,incompleteData:f,keyPointsData:p,loginUser:d,itemName:v,viewActivities:m,actions:g,conversations:y,relatedItemKeys:n}})(i,t),m=u.itemAnalyticsKey,A=u.viewCount,X=u.viewerCount,J=u.isTrending,G=u.incompleteData,ee=u.keyPointsData,re=u.loginUser,oe=u.itemName,fe=u.viewActivities,he=u.actions,ve=u.conversations,be=u.relatedItemKeys,we=N.getLifeCycleSignals(i,t,2,!0),Ee=i.isItemFacetResolved(c.keyPointsFacet,m)&&i.isItemFacetResolved(c.recommendedActionsFacet,m)&&i.isItemFacetResolved(c.conversationsFacet,m)&&(!b.isRelatedFilesApiCallEnabled()||i.isItemFacetResolved(h.relatedFilesItemSetFacet,t)),Se=i.isItemFacetResolved(x.errorFacet,m),xe=j(ee),Te=oe&&t&&F(oe.extension,he),Ne=I(ve),Ce=q(fe),ke=R(be),Le={keyPoints:xe,recommendedActions:!!Te,conversations:Ne,viewers:!!Ce,relatedFiles:ke};if(Ee||Se)return d.createElement("div",{ref:f,className:p.css(y.fileHoverCardExpandedCard,{isFluent:!0})},!!(re&&t&&m)&&we.map(function(e){return(function(e,t,r,i,u){var f,l=n.__assign({},a.selectedItemsControl.pack(function(){return{itemKeys:[r]}})),p=u.demandItemFacet(E.hoverCardCommandsControl,r),v=E.hoverCardCommandsControl.evaluate(p)(u,{itemKey:r}),m=v.checkInAction,y=v.undoCheckOutAction,b=v.policyTipAction,w=v.addMetadataAction,x={checkIn:m,undoCheckOut:y,viewPolicyTip:b,addMetadata:w},T=u.demandItemFacet(c.createdByPersonFacet,i),N=u.demandItemFacet(c.createdDateTimeFacet,i);if(T){var k=u.demandItem({displayName:h.displayNameFacet,email:C.emailFacet,image:C.pictureFacet,id:C.sipFacet},T.itemKey);f={email:k.email||"",displayName:k.displayName||"",image:k.image||"",id:k.id||""}}var L=u.demandItemFacet(S.hoverCardLifeCycleStatusControl,r),A=S.hoverCardLifeCycleStatusControl.evaluate(L)(u,{itemKey:r,signalData:e}).onRenderLifeCycleSignal,D=O.getTelemetry(u).telemetry,P=M.getItemEngagement(u,{itemKey:r,engagement:{isIntentional:!0}});return d.createElement(s.ControlHandlerProvider,{controlHandlers:l},d.createElement(o.WithActionSet,{actions:x},function(r){var i=r.actions,s=i.checkIn,o=i.undoCheckOut,u=i.viewPolicyTip,a=i.addMetadata;return d.createElement(g.AnalyticsLifeCycle,{lifeCycleSignalData:e,createdBy:f,createdDateTime:N,loginUserEmail:t.userLoginName,userEmail:t.userEmail,onViewPolicyTip:function(){D(_.Engagement).logData(n.__assign({name:"FileHoverCard.LifeCycle.ViewPolicyTip"},P));u&&u.execute()},onAddMetadataNow:function(){D(_.Engagement).logData(n.__assign({name:"FileHoverCard.LifeCycle.AddMetadata"},P));a&&a.execute()},onCheckIn:s&&s.isAvailable?function(){D(_.Engagement).logData(n.__assign({name:"FileHoverCard.LifeCycle.FileCheckIn"},P));s&&s.execute()}:void 0,onDiscardCheckOut:o&&o.isAvailable?function(){D(_.Engagement).logData(n.__assign({name:"FileHoverCard.LifeCycle.DiscardCheckOut"},P));o&&o.execute()}:void 0,onRenderLifeCycleSignal:A})}))})(e,re,t,m,i)}),d.createElement("div",{className:y.fileHoverCardExpandedCardScrollableSection},b.isCollapsedSectionsEnabled()&&d.createElement("div",{className:y.collapsedFileCardTooltip},d.createElement(P.TooltipHost,{content:L.default.CollapsedFileCardTooltip},d.createElement(D.Icon,{iconName:"info"}))),!!(xe&&ee&&t)&&(b.isCollapsedSectionsEnabled()?d.createElement("div",{className:y.fileCardExpandSectionContainer,style:{border:0}},d.createElement(k.DefaultButton,{className:y.fileCardExpandSectionButton,text:L.default.insideLook,menuIconProps:{iconName:w?"ChevronUp":"ChevronDown"},onClick:function(){return ye("FileHoverCard.KeyPointsExpanded",Le,w,W,V,$)}}),w&&U(i,{keyPointsData:ee,itemKey:t})):U(i,{keyPointsData:ee,itemKey:t})),Te&&m&&(b.isCollapsedSectionsEnabled()?d.createElement("div",{className:y.fileCardExpandSectionContainer,style:xe?{}:{border:0}},d.createElement(k.DefaultButton,{className:y.fileCardExpandSectionButton,text:L.default.RecommendedActionTitle,menuIconProps:{iconName:K?"ChevronUp":"ChevronDown"},onClick:function(){return ye("FileHoverCard.RecommendedActionsExpanded",Le,K,Q,Y,Z)}}),K&&z(i,{target:e.target,itemKey:t,itemAnalyticsKey:m})):z(i,{target:e.target,itemKey:t,itemAnalyticsKey:m})),b.isRelatedFilesSectionEnabled()&&be&&ke&&(b.isCollapsedSectionsEnabled()?d.createElement("div",{className:y.fileCardExpandSectionContainer,style:xe||ke?{}:{border:0}},d.createElement(k.DefaultButton,{className:y.fileCardExpandSectionButton,text:L.default.RelatedFilesTitle,menuIconProps:{iconName:pe?"ChevronUp":"ChevronDown"},onClick:function(){return ye("FileHoverCard.RelatedFilesExpanded",Le,pe,de,me,ge)}}),pe&&d.createElement(B.RelatedFiles,{relatedFilesKeys:be,itemKey:t})):d.createElement(B.RelatedFiles,{relatedFilesKeys:be,itemKey:t})),ve&&re&&Ne&&(b.isCollapsedSectionsEnabled()?d.createElement("div",{className:y.fileCardExpandSectionContainer,style:xe||Te?{}:{border:0}},d.createElement(k.DefaultButton,{className:y.fileCardExpandSectionButton,text:L.default.ConversationsTitle,menuIconProps:{iconName:te?"ChevronUp":"ChevronDown"},onClick:function(){return ye("FileHoverCard.ConversationsExpanded",Le,te,ne,ie,se)}}),te&&d.createElement(T.Conversations,{conversations:ve,loginUserEmail:re.userLoginName,userEmail:re.userEmail})):d.createElement(T.Conversations,{conversations:ve,loginUserEmail:re.userLoginName,userEmail:re.userEmail})),!(!Ce||!re)&&(b.isCollapsedSectionsEnabled()?d.createElement("div",{className:y.fileCardExpandSectionContainer,style:xe||Te||Ne?{}:{border:0}},d.createElement(k.DefaultButton,{className:y.fileCardExpandSectionButton,text:L.default.viewers,menuIconProps:{iconName:ue?"ChevronUp":"ChevronDown"},onClick:function(){return ye("FileHoverCard.ViewersExpanded",Le,ue,ae,le,ce)}}),ue&&d.createElement("div",{className:y.fileHoverCardActivitiesSection,style:{borderTop:0}},d.createElement(v.AnalyticsActivityList,{itemAnalytics:{activities:fe||[],viewCount:A,viewerCount:X,isTrending:J,incompleteData:G},loginUserEmail:re.userLoginName,userEmail:re.userEmail}))):d.createElement("div",{className:y.fileHoverCardActivitiesSection},d.createElement(v.AnalyticsActivityList,{itemAnalytics:{activities:fe||[],viewCount:A,viewerCount:X,isTrending:J,incompleteData:G},loginUserEmail:re.userLoginName,userEmail:re.userEmail})))))})};function j(e){var t=e&&e.readTime&&e.readTime.minutes;return!!(e&&e.keyPoints&&e.keyPoints.length>0)||!!t}t.isKeyPointsAvailable=j;function F(e,t){return Boolean(t&&t.length>0)&&b.isRecommendedActionsSupported(void 0,e)}t.isRecommendedActionsAvailable=F;function I(e){return Boolean(e&&e.length>0)}t.isConversationsAvailable=I;function q(e){return Boolean(e&&e.length>=1)}t.shouldShowActivities=q;function R(e){return Boolean(e&&e.length>0)}t.isRelatedFilesAvailable=R;function U(e,t){var n=t.keyPointsData,r=t.itemKey,i=e.demandItemFacet(E.hoverCardCommandsControl,r),s=E.hoverCardCommandsControl.evaluate(i)(e,{itemKey:r}),u={showKeyPoints:s.showKeyPointsPane,showFeedback:s.showFeedbackPane};return d.createElement(o.WithActionSet,{actions:u},function(e){var t=e.actions,r=t.showKeyPoints,i=t.showFeedback,s=r&&r.isAvailable?r.execute:void 0,o=i&&i.isAvailable?i.execute:void 0;return d.createElement(m.AnalyticsKeyPoints,{keyPointsData:n,onKeyPointsClick:s,onSendFeedbackClick:o})})}function z(e,t){var n=t.target,r=t.itemKey,u=t.itemAnalyticsKey,a=e.demandItemFacet(c.recommendedActionsFacet,u),p=b.isLowActivityTidbitEnabled()&&e.demandItemFacet(c.recommendedPeopleFacet,u)||[],v=e.demandItemFacet(h.openUrlFacet,r),m=e.demandItemFacet(c.activitiesFacet,u),g=e.demandItemFacet(l.loginUserFacet,l.configurationItemKey),y=m&&m.filter(function(e){return void 0!==e.edit}),S=e.demandItemFacet(E.hoverCardCommandsControl,r),x=E.hoverCardCommandsControl.evaluate(S)(e,{itemKey:r}).onDismiss;return d.createElement(s.ControlHandlerProvider,{controlHandlers:f.shareActionControl.pack(function(){return{defaultRecipients:p?p.map(function(e){return e.email}):[]}})},d.createElement(o.WithAction,{action:d.createElement(i.ItemShareAction,{itemKey:r})},function(e){var t=e.execute;return a&&x&&d.createElement(w.RecommendedActions,{actions:{recommendedActions:a,shareWith:p,editActivities:y},loginUserEmail:g&&g.userLoginName,userEmail:g&&g.userEmail,pageUrl:v,onDismiss:x,onShareWith:function(e,r){e.target=n;e.persist();t({event:e})}})}))}});
define("DB",["require","exports","ww","r","Ej","Nf","Md","bc","Bc","Ah","ld","ODBItemsScopeDeferred_mini_css","jB","OB","Gc","Ac","Nc","CB","W","Es","tC","uo","Wv","k","xB","tc","IB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";c=c.FileHoverCard_module_7;Object.defineProperty(t,"__esModule",{value:!0});var k=1,L=131,A=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._dynamicCompactCardHeight=function(e){n.state.compactCardHeight!==e&&n.setState({compactCardHeight:e})};n._dynamicExpandedCardHeight=function(e){var t=n.state.expandedCardHeight;e&&t!==e&&n.setState({expandedCardHeight:e})};n.state={visible:!1,expandedCardHeight:k,compactCardHeight:L};n._isFirstTimeOpenCard=!0;return n}t.prototype.componentDidCatch=function(e,t){this._hoverCardRenderQos&&this._hoverCardRenderQos.end({error:e.name+"_"+e.message,extraData:{stack:e.stack,errorInfo:JSON.stringify(t)},resultCode:e.name,resultType:y.ResultTypeEnum.Failure})};t.prototype.render=function(){var e=this,t=this.props,u=t.itemKey,a=t.cardDismissDelay,y=void 0===a?300:a,w=t.directionalHint,E=void 0===w?s.DirectionalHint.rightTopEdge:w,S=t.gapSpace,x=void 0===S?8:S,N=t.target;if(!u||!N)return null;var C,k,L,A,O,M={expandedCardScroll:c.fileHoverCardExpandedCardHostScroll},_=n.__assign({root:{boxShadow:l.getTheme().effects.elevation16,borderRadius:"2px",width:"320px",selectors:{".ms-Callout-main":{borderRadius:"2px"}}},expandedCard:[{selectors:{":before":{display:"none"}}}]},M),D=new T.FileHoverCardEngagement(this.props.telemetry(m.Engagement));return r.createElement(o.WithItemCache,null,function(t){var n=t.itemCache;if(e.state.visible){var s=e._demandFacets(n),o=s.itemAnalyticsKey,a=s.keyPointsData,l=s.itemName,c=s.recommendedActions,m=s.conversations,w=s.viewActivities,S=s.relatedItemKeys,T=n.isItemFacetResolved(f.viewCountFacet,o),M=n.isItemFacetResolved(b.errorFacet,o),P=M?n.demandItemFacet(b.errorFacet,o):void 0;e._errorMessage=P&&P.message;e._isViewCountDataError=M&&!T;C=h.isKeyPointsAvailable(a);k=!!l&&h.isRecommendedActionsAvailable(l.extension,c);L=h.isConversationsAvailable(m);A=h.shouldShowActivities(w);O=h.isRelatedFilesAvailable(S);if(n.demandItemFacet(b.errorFacet,u,{suppressGetItems:!0}))return null}var H=v.getItemEngagement(n,{itemKey:u,engagement:{isIntentional:!0}});D.engagementData=H;var B={onRenderCompactCard:function(){return r.createElement(p.CompactCard,{itemKey:u,target:N,updateCardHeight:e._dynamicCompactCardHeight})},onRenderExpandedCard:function(){return r.createElement(h.ExpandedCard,{itemKey:u,target:N,onCardExpand:function(t){return e._onCardExpand(t,H)}})},compactCardHeight:e.state.compactCardHeight,expandedCardHeight:e.state.expandedCardHeight,directionalHint:E,directionalHintFixed:!1,gapSpace:x,styles:_};return r.createElement(d.TelemetryProvider,{withContext:{component:"FileHoverCard"}},r.createElement(g.EngagementContext.Provider,{value:D},r.createElement(i.HoverCard,{expandingCardProps:B,cardDismissDelay:y,expandedCardOpenDelay:500,target:e.props.target,onCardVisible:function(){return e._onCardOpen(H)},onCardHide:function(){return e._onCardHide(H,C,k,L,A,O)},trapFocus:!0})))})};t.prototype._demandFacets=function(e){var t,n=e.demandItemFacet(a.analyticsItemFacet,this.props.itemKey),r=n&&n.itemKey,i=e.demandItemFacet(f.keyPointsFacet,r),s=e.demandItemFacet(a.fileNameFacet,this.props.itemKey),o=e.demandItemFacet(f.recommendedActionsFacet,r),u=e.demandItemFacet(f.conversationsFacet,r),l=e.demandItemFacet(f.activitiesFacet,r),c=l&&l.filter(function(e){return void 0!==e.access});if(C.isRelatedFilesApiCallEnabled()){var h=e.demandItemFacet(a.relatedFilesItemSetFacet,this.props.itemKey),p=e.demandItemFacet(N.childItemsFacet,h&&h.itemKey);t=p&&p.itemKeys}return{analyticsKey:n,itemAnalyticsKey:r,keyPointsData:i,itemName:s,recommendedActions:o,conversations:u,activities:l,viewActivities:c,relatedItemKeys:t}};t.prototype._onCardOpen=function(e){var t=this;if(!x.Killswitch.isActivated("b0d3df87-b7df-4431-a2ed-e94568d478c9","12/17/2019","Pre-fetch file card API calls")){var r=this.props.itemCacheDispatch;r(w.demandItems(function(e){return t._demandFacets(e)},{flushOperationQueue:!0}));r(E.forceStoreUpdate())}this.props.telemetry(m.Engagement).logData(n.__assign({name:"FileHoverCard.CompactCardOpen"},e));this._cardOpenTimeStamp=Date.now();this.setState({visible:!0});this._isFirstTimeOpenCard&&(this._hoverCardRenderQos=new(this.props.telemetry(y.Qos))({name:"ItemScope_FileHoverCardRender"}))};t.prototype._onCardHide=function(e,t,r,i,s,o){var u=Date.now()-this._cardOpenTimeStamp,a=this.state.expandedCardHeight>k,f=a&&u>2500?"FileHoverCard.DwellTimeLong":"FileHoverCard.DwellTime";this.props.telemetry(m.Engagement).logData(n.__assign(n.__assign({name:f},e),{extraData:n.__assign(n.__assign({},e.extraData),{time:u,compactCardOpen:this.state.expandedCardHeight===k,expandedCardOpen:a,keyPoints:t,recommendedActions:r,conversations:i,viewers:s,relatedFiles:o})}));if(this._isFirstTimeOpenCard){this._hoverCardRenderQos.end({resultType:y.ResultTypeEnum.Success});this._isFirstTimeOpenCard=!1}this.setState({visible:!1})};t.prototype._onCardExpand=function(e,t){this._dynamicExpandedCardHeight(e);if(!this._isCardExpanded&&e>k){this.props.telemetry(m.Engagement).logData(n.__assign({name:"FileHoverCard.ExpandedCardOpen"},t));this._isCardExpanded=!0}if(this._isFirstTimeOpenCard){this._isViewCountDataError?this._hoverCardRenderQos.end({resultType:y.ResultTypeEnum.Failure,resultCode:"NoViewCount",error:this._errorMessage}):this._hoverCardRenderQos.end({resultType:y.ResultTypeEnum.Success});this._isFirstTimeOpenCard=!1}};t.defaultProps={itemKey:""};return t})(r.Component);t.FileHoverCard=S.connectToItemCache()(d.withTelemetry()(A));t.CurrentFileHoverCard=u.withCurrentItem()(t.FileHoverCard)});
define("$M",["require","exports","Ni"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hoverCardLifeCycleStatusControl=new n.ControlFacet("hoverCardLifeCycleStatusControl")});
define("QE",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.aria=e("@ms/aria-private")});
define("aP",["require","exports","ww","H4","QC","YC","iP"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}return t})(i.fromUserAuthToken()(s.forSharedControls()(o.withAriaLoader()(r.AriaTelemetryHandler))));t.SharedAriaTelemetryHandler=u});
define("nP",["require","exports","ww","aP","qC"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}return t})(i.fromWebPlatform()(r.SharedAriaTelemetryHandler));t.WebSharedAriaTelemetryHandler=s});
define("QC",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fromUserAuthToken=function(){return function(e){return(function(e){n.__extends(t,e);function t(t){var r=t.context,i=void 0===r?{}:r,s=t.userAuthToken,o=t.userId,u=(t.context,n.__rest(t,["userAuthToken","userId","context"])),a=s&&(function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}})(s),f=a&&a.puid?"Business":"Unknown",l=a&&a.app_displayname||"Unknown",c=a&&a.appid||"Unknown",h=(function(e,t,n){return e?"Unknown"===n?"":e:"Business"===n&&t&&t.puid||""})(o,a,f),p=h?1:0,d=a&&a.tid||"Unknown";return e.call(this,n.__assign({context:n.__assign({AccountType:f,AppName:l,AppId:c,IsAuthenticated:p,SiteSubscriptionId:d,UserId:h},i)},u))||this}return t})(e)}}});
define("iP",["require","exports","ww"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withAriaLoader=function(){return function(t){return(function(t){n.__extends(r,t);function r(r){var i=this,s=r.context,o=void 0===s?{}:s,u=r.ariaLoader,a=void 0===u?function(){return n.__awaiter(i,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["QE"],t,n)})];case 1:return[2,t.sent().aria]}})})}:u,f=(r.context,n.__rest(r,["ariaLoader","context"]));return i=t.call(this,n.__assign({ariaLoader:a,context:n.__assign({},o)},f))||this}return r})(t)}}});
define("sX",["require","exports","cX"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.days=[n.default.sunday,n.default.monday,n.default.tuesday,n.default.wednesday,n.default.thursday,n.default.friday,n.default.saturday];t.shortDays=[n.default.shortSunday,n.default.shortMonday,n.default.shortTuesday,n.default.shortWednesday,n.default.shortThursday,n.default.shortFriday,n.default.shortSaturday];t.shortMonths=[n.default.shortJanuary,n.default.shortFebruary,n.default.shortMarch,n.default.shortApril,n.default.shortMay,n.default.shortJune,n.default.shortJuly,n.default.shortAugust,n.default.shortSeptember,n.default.shortOctober,n.default.shortNovember,n.default.shortDecember];t.months=[n.default.january,n.default.february,n.default.march,n.default.april,n.default.may,n.default.june,n.default.july,n.default.august,n.default.september,n.default.october,n.default.november,n.default.december]});
define("TF",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t,n,r){var i="",s=0;if(!e)return"";var o=e.length;for(s=0;s<o;s++){var u=e.charCodeAt(s),a=e.charAt(s);if(t&&("#"===a||"?"===a)){i+=e.substr(s);break}if(n&&"&"===a)i+=a;else if(u<=127)r?i+=a:u>=97&&u<=122||u>=65&&u<=90||u>=48&&u<=57||t&&u>=32&&u<=95&&" \"%<>'&".indexOf(a)<0?i+=a:u<=15?i+="%0"+u.toString(16).toUpperCase():u<=127&&(i+="%"+u.toString(16).toUpperCase());else if(u<=2047){i+="%"+(192|u>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}else if(55296!=(64512&u)){i+="%"+(224|u>>12).toString(16).toUpperCase();i+="%"+(128|(4032&u)>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}else if(s<e.length-1){u=(1023&u)<<10;s++;u|=1023&e.charCodeAt(s);i+="%"+(240|(u+=65536)>>18).toString(16).toUpperCase();i+="%"+(128|(258048&u)>>12).toString(16).toUpperCase();i+="%"+(128|(4032&u)>>6).toString(16).toUpperCase();i+="%"+(128|63&u).toString(16).toUpperCase()}}return i}t.encodeURIComponent=n;t.escapeUrlForCallback=function(e){var t=e.indexOf("#"),r=e.indexOf("?");if(t>0&&(-1===r||t<r)){var i=e.substr(0,t);r>0&&(i+=e.substr(r));e=i}return n(e,!0,!1,!0)};t.encodeRestUriStringToken=function(e){e&&(e=n(e=(e=e.replace(/'/g,"''")).replace(/%27/g,"%27%27")));return e}});
define("UN",["require","exports","r","r","HN","VN","GN","FN"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DragDropHookWrapper=function(e){var t=e.dragDropKey,a=e.dragType,f=e.acceptType,l=e.showDefaultDragPreview,c=e.hookCallback,h=e.handlers,p=!!h.canDragHandler,d=s.useDragSpec({dragSourceKey:t,type:a,handlers:h,collectDragAvailability:!1}),v=i.useDrag(d),m=v[0],g=v[1],y=v[2];r.useEffect(function(){p&&y&&!l&&y(u.getEmptyImage(),{captureDraggingState:!0})},[p,y,l]);var b=o.useDropSpec({acceptType:f,dropTargetKey:t,handlers:h}),w=i.useDrop(b),E=w[0],S=w[1];r.useEffect(function(){c({collectedDragProps:m,collectedDropProps:E,connectDragSource:g,connectDropTarget:S})},[m,E,g,y,S]);return e.children?n.createElement(n.Fragment,null,e.children):null}});
define("FWe",["require","exports","ww","r","o","un","Co"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=0,a=s.createMemoizer(function(e){return""+ ++u});t.usePortalManager=function(){var e=r.useState(function(){return{}}),t=e[0],s=e[1],u=o.useEventHandler(function(e,t){s(function(r){var s,o=a(t);return n.__assign(n.__assign({},r),((s={})[o]=i.createPortal(e,t),s))})}),f=o.useEventHandler(function(e){s(function(t){var r=a(e);t[r];return n.__rest(t,["symbol"==typeof r?r:r+""])})}),l=r.useRef(),c=l.current||(l.current={render:u,unmount:f}),h=r.useMemo(function(){return r.createElement(r.Fragment,null,Object.keys(t).map(function(e){return r.createElement(r.Fragment,{key:e},t[e])}))},[t]);return r.useMemo(function(){return[c,h]},[c,h])}});
define("XKe",["require","exports","ww","b_e"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("KJe",["require","exports","ww","r","Mc","Vs","Wv","Gi","zi","Qi","qJe","WJe","ty"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewAIBuilderModelDetailsAction=t.CreateAIBuilderModelAction=t.ViewAIBuilderModelsAction=void 0;var p=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,s=t.isAvailable,o=t.aiBuilderEnvironmentConfig,u=l.getCreateAIBuilderModelRunTimeHost(),a=l.isPowerAppsTestEnvSupportedKillSwitchActivated?l.getAIBuilderRunTimeHost():u.hostName,f="https://"+a+"/aibuilder/default-environment/models?template=SharePointFormProcessing";if(!l.isPowerAppsTestEnvSupportedKillSwitchActivated){var c=l.parseAIBuilderEnvironmentConfig(o);u.isTest||!c.envName||void 0===c.isDefault||c.isDefault?u.isTest&&c.testEnvName&&void 0!==c.isTestEnvDefault&&!c.isTestEnvDefault&&(f="https://"+a+"/environment/"+c.testEnvName+"/aibuilder/models?template=SharePointFormProcessing"):f="https://"+a+"/environment/"+c.envName+"/aibuilder/models?template=SharePointFormProcessing"}return r.createElement(i.Action,{isAvailable:s,onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){window.open(f,"_blank");return[2]})})}})};return t})(r.PureComponent),d=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.isModelApplied,n=e.permissions,i=h.default.hasItemPermission({permissions:n},h.default.manageLists),s=!t&&i;return r.createElement(r.Fragment,null,s&&r.createElement(c.LaunchCreateAIBModelPanelAction,null))};return t})(r.PureComponent),v=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.isModelApplied;return r.createElement(r.Fragment,null,e&&r.createElement(c.LaunchCreateAIBModelPanelAction,null))};return t})(r.PureComponent);function m(e){var t=s.getCurrentItemSetKey(e),n=e.demandItemFacet(f.spFolderItemSetKeyFacet,t),r=n&&f.spListKeyFacet.serialize(n),i=e.demandItemFacet(u.listFacet,r),o=n?n.webAbsoluteUrl:"",a=null==n?void 0:n.listFullUrl;return{viewId:n&&n.viewKey?n.viewKey.viewId:void 0,webAbsoluteUrl:o,list:i,listFullUrl:a,isPredictionModelApplied:!!i&&!!i.flags2&&8192==(8192&i.flags2),permissions:a?e.demandItemFacet(u.permissionsFacet,f.spItemKeyFacet.serialize({listFullUrl:a,webAbsoluteUrl:o})):void 0}}t.ViewAIBuilderModelsAction=o.connectToItemCache(function(e){var t=m(e).list;return{isAvailable:!!t&&!!t.isDocumentLibrary&&t.templateType!==a.ListTemplateType.webPageLibrary&&t.templateType!==a.ListTemplateType.mySiteDocumentLibrary,aiBuilderEnvironmentConfig:null==t?void 0:t.aiBuilderDefaultPowerAppsEnvironment}})(p);t.CreateAIBuilderModelAction=o.connectToItemCache(function(e){var t=m(e);return{isModelApplied:t.isPredictionModelApplied,permissions:t.permissions}})(d);t.ViewAIBuilderModelDetailsAction=o.connectToItemCache(function(e){return{isModelApplied:m(e).isPredictionModelApplied}})(v)});
define("HXe",["require","exports","ww","r","bc","Bc","e7","U1"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddToOneDriveAction=void 0;var a=o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/AddToOneDriveAction"],t,n)})];case 1:return[2,t.sent().AddToOneDriveAction]}})})},function(e,t){var n=t.itemKey;return!!n&&!!e.demandItemFacet(s.folderFacet,n)}),f=i.withSelectedItems()(i.withExactlyOneItem()(a));t.AddToOneDriveAction=function(){var e=u.useResourceScope();return r.createElement(f,{resources:e})}});
define("FZe",["require","exports","ww","e7","bc","Bc","Gi","Qi"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddToQuickLaunch=void 0;t.AddToQuickLaunch=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["rYe"],t,n)})];case 1:return[2,t.sent().AddToQuickLaunchAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(s.fileNameFacet,n),i=e.demandItemFacet(o.officeAppFacet,n),a=e.demandItemFacet(u.spItemKeyFacet,n);return!!r&&".aspx"===r.extension&&!i&&!!a&&-1!==a.listFullUrl.toLowerCase().indexOf("sitepages")}return!1})))});
define("_Ze",["require","exports","ww","r","bc","I7","D7","Gi","ty","Bc","e7","U1"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ManageAlertAction=t.AlertMeAction=void 0;var h=l.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["wYe"],t,n)})];case 1:return[2,t.sent().AlertAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!n)return!1;var i=s.getPageContextFromItemCache(e,n),l=e.demandItemFacet(u.permissionsFacet,n);if(!(!!i&&!i.isEmailAuthenticationGuestUser&&a.PermissionMask.hasItemPermission({permissions:l},a.PermissionMask.createAlerts)))return!1;var c=r&&r.consume(o.resourceKey.optional);if(c){var h=e.demandItemFacet(f.canonicalUrlFacet,n);if(c.getUrlParts({path:h}).isCrossDomain)return!1}return!0}),p=i.withSelectedItems()(i.withCurrentItemAsFallback()(i.withExactlyOneItem()(h)));t.AlertMeAction=function(){var e=c.useResourceScope();return r.createElement(p,{resources:e})};t.ManageAlertAction=function(){var e=c.useResourceScope();return r.createElement(p,{resources:e,manageAlerts:!0})}});
define("SZe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ApproveRejectAction=void 0;t.ApproveRejectAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ApproveRejectAction))})});
define("PXe",["require","exports","ww","r","e7","g","U1"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchCancelEditAtion=void 0;var u=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["OYe"],t,n)})];case 1:return[2,t.sent().CancelEditAtion]}})})},function(e,t){var n=t.resources;if(n){var r=n.consume(s.inplaceEditorUrl.optional);return!(!r||!r())}return!1});t.LaunchCancelEditAtion=function(){var e=o.useResourceScope();return r.createElement(u,{resources:e})}});
define("rZe",["require","exports","ww","r","Mc","bc","Tc","I7","mz","D7","Da","LH","Nx","Gi","O4","ty","Bc","Wv","Ac","U1","Qi","fB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CaptureVersionAction=void 0;var S=g.createItemCacheComponent(function(e,t){var s=t.itemKey,l=t.resources,g=e.demandItemFacet(p.listItemIdFacet,s),b=u.getPageContextFromItemCache(e,s),S=b?b.layoutsUrl:"",T=b&&b.listId||"",N=(b?b.webAbsoluteUrl:"")+"/"+S+"/CreateDocSetVersion.aspx?"+h.serializeQuery({list:T,ID:g||"",IsDlg:1}),C=(function(e,t){var n=t.itemKey,r=t.resources;if(!n||!r)return!1;var i=u.getPageContextFromItemCache(e,n),s=e.demandItemFacet(p.permissionsFacet,n),o=e.demandItemFacet(d.itemComplianceStatusFacet,n);if(!i||i.isEmailAuthenticationGuestUser||!v.PermissionMask.hasItemPermission({permissions:s},v.PermissionMask.editListItems)||3===o||4===o)return!1;var a=e.demandItemFacet(w.spItemKeyFacet,n),l=a&&w.spListKeyFacet.serialize(a),c=e.demandItemFacet(p.listFacet,l),h=!!c&&!!c.enableVersions;if(!h)return!1;var g=r.consume(f.resourceKey.optional);if(g){var y=e.demandItemFacet(m.canonicalUrlFacet,n);if(g.getUrlParts({path:y}).isCrossDomain)return!1}var b=e.demandItemFacet(p.documentSetFacet,n),S=e.demandItemFacet(p.listItemIdFacet,n),x=E.isFeatureEnabled(E.DocumentSetsModernView)&&E.isFeatureEnabled(E.UseItemsScopeInTeamSites)&&S;return h=!(!x||!b)})(e,{itemKey:s,resources:l}),k=o.renderComponentOnExecute(function(e){return r.createElement(c.IFrameDialog,{url:N,heightOffset:.7,dialogContentProps:{title:a.default.CaptureVersion},onDismiss:function(){e&&e.resolve&&e.resolve()},onLoad:x})});return r.createElement(i.Action,n.__assign({isAvailable:C,onExecute:k},y.getItemActionEngagement(e,{itemKey:s,engagement:{name:"CaptureVersion",isIntentional:!0}})))});function x(e){new l.Async(void 0).setTimeout(function(){if(e&&e.contentDocument){var t=e.contentDocument.body.clientHeight;t>0&&(e.style.height=t+"px")}},10)}var T=s.withSelectedItems()(s.withExactlyOneItem()(S));t.CaptureVersionAction=function(){var e=b.useResourceScope();return r.createElement(T,{resources:e})}});
define("CZe",["require","exports","ww","e7","bc","Bc","Gi","ty","Qi","Gi","zi"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ComplianceDetailsAction=void 0;t.ComplianceDetailsAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["CYe"],t,n)})];case 1:return[2,t.sent().ComplianceDetailsAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItem({isFolder:s.folderFacet,permissions:o.permissionsFacet,spItem:a.spItemKeyFacet},n),i=r.isFolder,c=r.permissions,h=r.spItem,p=h&&a.spListKeyFacet.serialize(h),d=e.demandItemFacet(f.listFacet,p);if(!!d&&d.templateType===l.ListTemplateType.mySiteDocumentLibrary)return!1;var v=u.default.hasItemPermission({permissions:c},u.default.viewVersions);return!i&&v}return!1})))});
define("UYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateClassicColumnAction=void 0;t.CreateClassicColumnAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateColumnAction))({fieldType:null})})});
define("wZe",["require","exports","LO","oYe","w8"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateTextFileAction=t.CreateExcelSurveyAction=t.CreateOneNoteAction=t.CreatePowerPointAction=t.CreateExcelAction=t.CreateWordAction=void 0;var s=function(e){return function(t){var r=t.consume(n.actionMap);return new(t.injected(r.CreateDocumentAction))({docType:e})}};t.CreateWordAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Word));t.CreateExcelAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Excel));t.CreatePowerPointAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.PowerPoint));t.CreateOneNoteAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.OneNote));t.CreateExcelSurveyAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.ExcelSurvey));t.CreateTextFileAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Text))});
define("IXe",["require","exports","ww","r","e7","bc","c3","ty","Gi","Qi","fB","KO","xv","U1","_ne"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreatePersistentShortcutAction=t.CreateShortcutAction=void 0;var v=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["xYe"],t,n)})];case 1:return[2,t.sent().CreateShortcutAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!r||!n)return!1;var i=e.demandItemFacet(f.spItemKeyFacet,n);if(i){if(r.consume(d.resourceKey.optional)){var p=f.spPageContextKeyFacet.serialize({listFullUrl:i.listFullUrl,webAbsoluteUrl:i.webAbsoluteUrl}),v=e.demandItemFacet(a.permissionsFacet,n),m=u.default.hasItemPermission({permissions:v},u.default.insertListItems),g=e.demandItemFacet(a.spPageContextFacet,p),y=o.getItemsScope(e).itemsScopeItemKey,b=s.getCurrentItemSetKey(e,y);if(b){var w=c.getQueryType(e,b);return!!g&&!g.isAnonymousGuestUser&&!g.isEmailAuthenticationGuestUser&&l.isFeatureEnabled(l.ShortcutLink)&&l.isFeatureEnabled(l.SpListNext)&&m&&w===h.default.Files}}}return!1}),m=s.withOnlyCurrentItem()(v),g=s.withCurrentItem()(v);t.CreateShortcutAction=function(){var e=p.useResourceScope();return r.createElement(m,{resources:e})};t.CreatePersistentShortcutAction=function(){var e=p.useResourceScope();return r.createElement(g,{resources:e})}});
define("MYe",["require","exports","ww","lYe","LO","oB","Je"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DefaultClickAction=void 0;var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(i.actionMap);n._action=new(n.managed(r.DefaultClickAction))(t);n._item=t.item;return n}t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!(!e||e.isPlaceholder)&&this._action.isAvailable()};t.prototype.onExecute=function(e){return this._action.execute(e)};return t})(s.default);t.DefaultClickAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(i.actionMap),r=o.default.isActivated("9FCD7B65-390C-4C59-9913-FC1D9D8D79E1","9/9/2019","Restore original DefaultClickAction behavior thanks to deferred execution")?u:n.DefaultClickAction;return new(e.injected(r,{injectChildResourceScope:!0}))({item:t.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"})})});
define("PYe",["require","exports","lYe","LO"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditItemAction=void 0;t.EditItemAction=n.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(r.actionMap);return new(e.injected(n.EditItemAction))({item:t.item,userInvokedItem:!0})})});
define("HZe",["require","exports","ww","e7","bc","c3","ty","Gi","Fb","I7","Qi","Gi","zi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditNewMenuAction=void 0;t.EditNewMenuAction=i.withCurrentItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["IYe"],t,n)})];case 1:return[2,t.sent().EditNewMenuAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(l.spItemKeyFacet,n),i=r&&e.demandItemFacet(c.listFacet,l.spListKeyFacet.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl})),p=f.getPageContextFromItemCache(e,n),d=e.demandItemFacet(u.permissionsFacet,n),v=o.default.hasItemPermission({permissions:d},o.default.editListItems),m=s.getItemsScope(e).itemsScopeItemKey,g=e.demandItemFacet(a.currentViewParamsFacet,m);return!!p&&!p.isAnonymousGuestUser&&!(g&&g.q)&&v&&!(i&&i.templateType===h.ListTemplateType.webPageLibrary)}return!1}))});
define("AZe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EmbedAction=void 0;t.EmbedAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EmbedAction))})});
define("TYe",["require","exports","ww","r","Mc","U1","KPe","Wv","az"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExternalNavigateAction=t.ExternalNavigateActionBase=void 0;t.ExternalNavigateActionBase=function(e){var t=e.item,u=s.useResourceScope();return r.createElement(i.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(n){e=window.open("","_blank");u.consumeAsync(o.resourceKey).then(function(e){return e.getItemUrl(t)}).then(function(t){e.location.href=t},function(){e.close()});return[2]})})}})};t.ExternalNavigateAction=u.connectToItemCache(function(e,t){var n=t.itemKey;return{item:e.demandItemFacet(a.oneDriveItemFacet,n)}})(t.ExternalNavigateActionBase)});
define("rXe",["require","exports","ww","e7","bc","Gi","Qi","I7","zi","Je","Vs","Bc","fB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileRequestAction=void 0;t.FileRequestAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["DYe"],t,n)})];case 1:return[2,t.sent().CreateFileRequestAction]}})})},function(e,t){if(!h.isFeatureEnabled(h.FileRequestUI))return!1;var n=t.itemKey,r=e.demandItemFacet(o.spItemKeyFacet,n);if(!r)return!1;var i=l.getCurrentItemSetKey(e);if(!e.demandItemFacet(o.spFolderItemSetKeyFacet,i)&&!f.default.isActivated("07a8a4f1-bb71-4166-9a57-94afe649189e","02/28/2020","Show Request files action only in Files view"))return!1;if(e.demandItemFacet(s.mountPointFacet,n))return!1;if(!e.demandItemFacet(c.folderFacet,n))return!1;var p=o.spListKeyFacet.serialize(r),d=e.demandItemFacet(s.listFacet,p);if(!d)return!1;if(d.templateType!==a.default.mySiteDocumentLibrary&&!f.default.isActivated("54638CBE-3322-47EB-B3BC-96645317201E","04/13/2020","Folder in ODB shared library could show file request command"))return!1;var v=u.getPageContextFromItemCache(e,n);return!!v&&(!!v.isSiteOwner&&(!v.isEmailAuthenticationGuestUser&&((!v.farmSettings||!v.farmSettings.ExternalService_filerequestenable||"0"!==v.farmSettings.ExternalService_filerequestenable)&&!(!f.default.isActivated("43A2AE6C-6893-4A99-A4BE-2996D6C2FF4C","03/27/2020","Show Request files action only if anonymous sharing is enabled and folder edit sharing is enabled, too.")&&(!v.isShareByLinkEnabled||0!==v.FolderAnonymousLinkPermission&&5!==v.FolderAnonymousLinkPermission)))))})))});
define("QJe",["require","exports","ww","bc","e7","$Je","ZJe","XJe","YJe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TriggerFlowItemAction=t.TriggerFlowAction=t.SetUpReminderFlowAction=t.SetUpApprovalFlowAction=t.ShowExistingFlowsAction=t.LaunchConfigureFlowsPanelAction=t.AddFlowAction=void 0;t.AddFlowAction=r.withCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["SYe"],t,n)})];case 1:return[2,t.sent().AddFlowAction]}})})},s.checkBaseAvailability));t.LaunchConfigureFlowsPanelAction=r.withCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["SYe"],t,n)})];case 1:return[2,t.sent().LaunchConfigureFlowsPanelAction]}})})},s.checkBaseAvailability));t.ShowExistingFlowsAction=r.withCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["SYe"],t,n)})];case 1:return[2,t.sent().ShowExistingFlowsAction]}})})},s.checkBaseAvailability));Object.defineProperty(t,"SetUpApprovalFlowAction",{enumerable:!0,get:function(){return o.SetUpApprovalFlowAction}});Object.defineProperty(t,"SetUpReminderFlowAction",{enumerable:!0,get:function(){return u.SetUpReminderFlowAction}});Object.defineProperty(t,"TriggerFlowAction",{enumerable:!0,get:function(){return a.TriggerFlowAction}});Object.defineProperty(t,"TriggerFlowItemAction",{enumerable:!0,get:function(){return a.TriggerFlowItemAction}})});
define("$Ye",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchColumnCustomizationPaneAction=void 0;t.LaunchColumnCustomizationPaneAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchColumnCustomizationPaneAction))(t)})});
define("HYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchColumnManagementPanelAction=void 0;t.LaunchColumnManagementPanelAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchColumnManagementPanelAction))(t)})});
define("eJe",["require","exports","ww","r","Mc","U1","tq","B5e","kte","fB","Qi","Gi","JP","cc","bw","Nq","Wb","Rq","CQ","gQ","OQ","fe","tJe","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchColumnsEditorPanelAction=void 0;var T=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._panelProvider=n.props.resources.consume(o.resourceKey);n._updateItemsScopeCurrentDerivedView=n.props.resources.consume(a.itemsScopeCurrentDerivedViewUpdatorResourceKey);n._operationProvider=n.props.resources.consume(b.resourceKey);n._resources=n.props.resources;return n}t.prototype.render=function(){var e=this;return r.createElement(i.Action,{isAvailable:!0,onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){var e,t,r=this;return n.__generator(this,function(n){e=this._resources.consume(m.resourceKey.optional);x.default.isActivated("22C304AE-F92B-4C31-8B42-B7BDD4857F31","10/22/2020","Add Spartan list ColumnsEdtior panel")&&"SpartanList"!==(null==e?void 0:e.hostName)?t=this._panelProvider.requestPanel({hasCommandBar:!0,component:{name:u.default.tagName,params:{onComplete:function(e){var n=!1;r._updateItemsScopeCurrentDerivedView(function(t){n=t.isDirty();t.replaceFields(e);return t});var i=r.props.resources.consume(g.isItemsScopeEnabledResourceKey);f.isFeatureEnabled(f.ColumnFieldsAutoSave)&&i&&r.props.resources.consumeAsync(d.resourceKey).then(function(e){r.props.resources.consumeAsync(v.resourceKey).then(function(t){var i,s,o=e.dispatch(p.readItems(function(e){var n=e.demandItemFacet(l.spFolderItemSetKeyFacet,t.peek());return{setKey:n,viewKey:n&&n.viewKey&&l.spViewKeyFacet.serialize(n.viewKey)}}));if(o.setKey&&o.viewKey){if(e.dispatch(p.readItems(function(e){var t=e.demandItemFacet(c.listFacet,l.spListKeyFacet.serialize({webAbsoluteUrl:o.setKey.webAbsoluteUrl,listFullUrl:o.setKey.listFullUrl}));return!!(t&&t.permissions&&t.permissions.manageLists)}))){var u=r._operationProvider.register({name:"",type:y.default.editViewColumns,payloads:{}});u.state(w.default.started);e.dispatch(h.saveViewCore({items:(i={},i[l.spListViewsSetKeyFacet.serialize(o.setKey)]={views:(s={},s[o.viewKey]={shouldSaveViewFieldsOnly:!0},s),qosName:"autoSaveShowHide"},i)})).then(function(){!1===n&&r._updateItemsScopeCurrentDerivedView(function(e){e.baseViewXml=e.getEffectiveViewXml();return e});u.state(w.default.completed)},function(e){E.default.logError(e,{eventName:"ShowHideAutoSave",feature:"ColumnFieldsAutoSave",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});r._updateItemsScopeCurrentDerivedView(function(e){e.setIsDirty(!0);return e});u.state(w.default.failed);throw e})}}})});t.state(1)}}}}):S.requestColumnsEditorPanel(this.props.resources);return[2]})})}})};return t})(r.PureComponent);t.LaunchColumnsEditorPanelAction=s.withResources()(T)});
define("RYe",["require","exports","ww","r","Tc","Mc","NYe","Wv","gc","I7","U1","Rq","Ete","Ote","Qi","Gi","Qi","tc","pO","y9","sB","bc","JP","Cs","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchContentTypeManagementPanelAction=t.LaunchContentTypeManagementPanelActionBase=void 0;var N=function(e,t,n,s,u){return i.renderComponentOnExecute(function(i){var a=i.resolve;i.reject;return r.createElement(o.ContentTypeManagementPanelContainer,{resolve:a,pageContext:e,views:t,onSuccess:n,getOAuthToken:s,updateViewWithNewColumns:u})})},C=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.onSuccess=function(e){var t=n._columnActionsHelper.getAddOrRemoveFromViewAction(void 0,e);new(n.props.resources.injected(t.action))(t.params).execute(null).done(function(){n._columnActionsHelper.invalidateInfoPaneCache()},function(){});n._isItemsScopeEnabled()&&n.props.resources.consumeAsync(h.resourceKey).then(function(e){e.invalidateCurrentItemSet();e.invalidateCurrentView();e.invalidateAvailableViews();e.invalidateListContentTypes()})};n.getOAuthToken=function(){return n.props.resources.consumeAsync(y.identity.bypass).then(function(e){if(!e.getSharePointToken){n._engagement.logData({name:"LaunchContentTypeManagementPanelAction.ErrorInGettInGettingIdentityDataSource"});return"No IdentityDataSource"}return e.getSharePointToken(b.getServerUrl(n.props.pageContext||{})).then(function(e){return e.accessToken})})};n._isItemsScopeEnabled=t.resources.consume(c.isItemsScopeEnabledResourceKey.lazy);n._columnActionsHelper=t.resources.consume(p.resourceKey);n._engagement=t.resources.consume(w.resourceKey);return n}t.prototype.render=function(){var e=this.props,t=e.pageContext,n=e.isAvailable,i=e.updateViewWithNewColumns,o=e.views;return t?r.createElement(s.Action,{isAvailable:n,onExecute:N(t,o,this.onSuccess,this.getOAuthToken,i)}):null};return t})(r.PureComponent);t.LaunchContentTypeManagementPanelActionBase=C;t.LaunchContentTypeManagementPanelAction=u.connectToItemCache(function(e){var t,n=a.getCurrentItemKey(e),r=E.getCurrentItemSetKey(e),i=e.demandItemFacet(d.spItemKeyFacet,n),s=i&&m.spListViewsSetKeyFacet.serialize(i),o=i&&d.spListKeyFacet.serialize(i),u=e.demandItemFacet(v.listFacet,o),l=e.dispatch,c=void 0;if(i){var h={webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl},p=m.spListViewsSetKeyFacet.serialize(h),y=e.demandItemFacet(g.childItemsFacet,p),b=y&&y.itemKeys;c=b&&b.map(function(t){return e.demandItemFacet(v.serverViewFacet,t)})}return{pageContext:f.getPageContextFromItemCache(e,n),isAvailable:T.default.isActivated("60f05460-551b-43bb-bd35-c9c9870d91fc","2/12/2020","Hide command to users who do not have manage lists permissions")?u&&u.contentTypesEnabled:u&&u.contentTypesEnabled&&(null===(t=u.permissions)||void 0===t?void 0:t.manageLists),views:c,updateViewWithNewColumns:function(e,t){var i,o,u=d.spViewKeyFacet.serialize({viewId:e}),a=l(x.readItem({derivedView:v.currentDerivedViewFacet},u)).derivedView;if(a){a.replaceFields(t);r&&n&&s&&l(S.saveViewCore({items:(i={},i[s]={views:(o={},o[u]={shouldSaveViewFieldsOnly:!0},o),qosName:"saveViewFieldsFromLaunchContentTypeManagementPanel"},i)}))}}}})(l.withResources()(C))});
define("WJe",["require","exports","ww","r","Wv","Ky","Hs","U1","Om","Vs","Qi","Gi","zi"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchCreateAIBModelPanelAction=void 0;var p=a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["I$e"],t,n)})];case 1:return[2,t.sent().default]}})})});t.LaunchCreateAIBModelPanelAction=i.createItemCacheComponent(function(e){var t=f.getCurrentItemSetKey(e),n=e.demandItemFacet(l.spFolderItemSetKeyFacet,t),i=n&&l.spListKeyFacet.serialize(n),a=e.demandItemFacet(c.listFacet,i),d=n?n.webAbsoluteUrl:"",v=(null==n?void 0:n.listFullUrl)?n.listFullUrl:"",m=(null==a?void 0:a.id)?a.id.replace("{","").replace("}",""):"",g=!!(v&&d&&m&&a&&a.isDocumentLibrary&&a.templateType!==h.ListTemplateType.webPageLibrary&&a.templateType!==h.ListTemplateType.mySiteDocumentLibrary),y=!!a&&!!a.flags2&&8192==(8192&a.flags2);return r.createElement(s.WizardAction,{engagement:{isIntentional:!0,name:y?"ViewFormProcessingModelPanelOpen":"CreateFormProcessingModelPanelOpen",currentPage:"DocumentLibraryPage"},isAvailable:g},u.withResources()(function(e){var t=e.reject,n=e.resolve;return r.createElement(p,{resources:e.resources,onDismiss:function(){t(new o.CancelError)},onComplete:function(e){e&&n()},createModelContext:{webAbsoluteUrl:d,listId:m,listFullUrl:v,isPredictionModelApplied:y,aiBuilderEnvironmentConfig:null==a?void 0:a.aiBuilderDefaultPowerAppsEnvironment}})}))})});
define("Vet",["require","exports","ww","r","Ky","Hs","U1","g","Om","h3","Je","L$e","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchCreateModelPanelAction=void 0;var h=f.afterPageLoad()(a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["RBt"],t,n)})];case 1:return[2,t.sent().default]}})})})),p=f.afterPageLoad()(a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["hJe"],t,n)})];case 1:return[2,t.sent().default]}})})}));t.LaunchCreateModelPanelAction=function(){return r.createElement(i.WizardAction,{engagement:{isIntentional:!0,name:"CreateModelPanelOpen",currentPage:"ModelListPage"},isAvailable:!0},o.withResources()(function(e){var t=e.reject,n=e.resolve,i=function(){t(new s.CancelError)},o=e.resources.consume(u.pageContext),a=function(e){e&&n()};return l.default.isActivated("61b2b6bf-ebbb-4237-aacc-30de3b9377e6","6/4/2020","Create Model Panel from odsp-common")?r.createElement(p,{resources:e.resources,onDismiss:i,onComplete:a}):r.createElement(h,{screenReaderAlert:c.default.alert,pageContext:o,onDismiss:i,onComplete:a})}))}});
define("DZe",["require","exports","ww","e7","bc","Gi","Qi","Gi","zi","Qs","CU"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchFormatViewPaneAction=void 0;t.LaunchFormatViewPaneAction=i.withCurrentItemSet()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["vYe"],t,n)})];case 1:return[2,t.sent().LaunchFormatViewPaneAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(o.spFolderItemSetKeyFacet,n),i=r&&o.spListKeyFacet.serialize(r),c=e.demandItemFacet(u.listFacet,i);if(!!c&&c.templateType===a.ListTemplateType.mySiteDocumentLibrary)return!1;var h=!!c&&c.permissions,p=h&&!(!h.manageLists&&!h.managePersonalViews),d=f.getCurrentLayout(e)===l.calendarMonthType;if(r&&r.viewKey){var v=o.spViewKeyFacet.serialize(r.viewKey);if(e.demandItemFacet(s.currentDerivedViewFacet,v)&&p&&!d)return!0}}return!1}))});
define("aJe",["require","exports","ww","bc","e7","j3","Tb"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPanelAction=void 0;t.LaunchMoveCopyPanelAction=r.withSelectedItems()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["EYe"],t,n)})];case 1:return[2,t.sent().LaunchMoveCopyPanelAction]}})})},function(e,t){var n=t.itemKeys;if(!n||n.length<1)return!1;var r=e.demandItemFacet(s.launchMoveCopyPanelActionControl,o.odspNextAppItemKey);return!!s.launchMoveCopyPanelActionControl.evaluate(r)(e,t).isAvailable}))});
define("nJe",["require","exports","LO","lYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchNewItemListFormInPanelAction=void 0;t.LaunchNewItemListFormInPanelAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchListFormAction))({item:t.item,type:2,contentTypeId:t.contentTypeId,defaultValueOverride:t.defaultValueOverride,url:t.formUrl})})});
define("OZe",["require","exports","ww","LO","oYe","bc","e7","I7","zi","Qi","Gi","fB","ty","Bc","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewItemAction=t.EditItemAction=t.CopyFieldAction=void 0;t.CopyFieldAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.CopyFieldAction))});function v(e,t){var n=u.getPageContextFromItemCache(e,t),r=e.demandItemFacet(f.spItemKeyFacet,t),i=r&&f.spListKeyFacet.serialize(r),s=i&&e.demandItemFacet(l.listFacet,i),o=s&&s.templateType===a.default.mySiteDocumentLibrary;return{isAvailable:!!n&&!n.isAnonymousGuestUser&&!o,pageContext:n,listContext:s}}t.EditItemAction=s.withSelectedItems()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["pYe"],t,n)})];case 1:return[2,t.sent().EditItemAction]}})})},function(e,t){var n=t.itemKeys;if(!n||n.length<1||!c.isFeatureEnabled(c.SPBulkEditItemCommand)&&n.length>1)return!1;var r=v(e,n[0]),i=r.isAvailable,s=r.listContext;if(!i)return!1;if(c.isFeatureEnabled(c.SPBulkEditItemCommand)&&s&&s.isDocumentLibrary&&n.length<=1)return!1;if(!d.default.isActivated("0F378815-7F92-48A5-B9E3-A127BEB75AC6","11/9/2020","disable bulk edit when list disableGridEditing is true")&&s&&!0===s.disableGridEditing&&n.length>1)return!1;for(var o=0,u=n;o<u.length;o++){var a=u[o],f=e.demandItemFacet(l.permissionsFacet,a);if(!(i=h.default.hasItemPermission({permissions:f},h.default.editListItems)))break}return!!i}));t.ViewItemAction=s.withSelectedItems()(s.withExactlyOneItem()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["fYe"],t,n)})];case 1:return[2,t.sent().ViewItemAction]}})})},function(e,t){var n=t.itemKey,r=t.preferredSection;if(!n)return!1;var i=v(e,n),s=i.isAvailable,o=i.listContext;return"comments"===r?s&&(null==o?void 0:o.templateType)===a.default.genericList&&!e.demandItemFacet(p.folderFacet,n):s})))});
define("MZe",["require","exports","ww","e7","Bc","bc","Gi","zi","ty","Qi"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MakeHomePageAction=void 0;t.MakeHomePageAction=s.withSelectedItems()(s.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["yYe"],t,n)})];case 1:return[2,t.sent().MakeHomePageAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(f.spItemKeyFacet,n),s=r&&e.demandItemFacet(o.listFacet,f.spListKeyFacet.serialize(r)),l=e.demandItem({permissions:o.permissionsFacet,isCheckedOut:i.isCheckedOutFacet},n),c=l.permissions,h=l.isCheckedOut,p=a.default.hasItemPermission({permissions:c},a.default.manageWeb);return!!s&&s.templateType===u.default.webPageLibrary&&p&&!!h&&!h.byYou}return!1})))});
define("iJe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ModifyShowInFiltersPaneAction=void 0;t.ModifyShowInFiltersPaneAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ModifyShowInFiltersPaneAction))(t)})});
define("xZe",["require","exports","ww","LO","oYe","CZe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CancelApprovalAction=t.UnPublishAction=t.PublishAction=t.EditRenditionsAction=t.WorkflowAction=void 0;n.__exportStar(s,t);t.WorkflowAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.WorkflowAction))});t.EditRenditionsAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.EditRenditionsAction))});t.PublishAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.PublishAction))});t.UnPublishAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UnPublishAction))({unPublishType:0})});t.CancelApprovalAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UnPublishAction))({unPublishType:1})})});
define("IZe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RemoveMountPointAction=t.CreateMountPointAction=void 0;t.CreateMountPointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateMountPointAction))});t.RemoveMountPointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.RemoveMountPointAction))})});
define("pJe",["require","exports","ww","r","U1","hDe","mJe","pO","Mc","mw","Wv","tC"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MoveCopyAction=void 0;var h=l.createItemCacheComponent(function(e,t){var i=t.itemKey,l=t.itemKeys,h=t.isMove,p=t.resources;if(!i||0===l.length)return null;var d=e.dispatch,v={name:h?"Move":"Copy",isIntentional:!0,extraData:{count:l.length}};return r.createElement(a.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,r,i,a,l,v,m,g,y;return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.all([p.consumeAsync(s.resourceKey),p.consumeAsync(o.resourceKey)])];case 1:e=n.sent(),r=e[0],i=e[1];return[4,d(c.demandItems(function(e){return(function(e,t){var n=e.demandItemFacet(f.knockoutStoreItemFacet,t.itemKey),r=t.itemKeys.map(function(t){return e.demandItemFacet(f.knockoutStoreItemFacet,t)});return{item:n,items:r}})(e,t)}))];case 2:a=n.sent(),l=a.item,v=a.items;m=(function(e,t){var n=e&&e.peek(),r=[],i=!1;if(n){var s=n.key;n.remoteItem||t.forEach(function(e){var t=e&&e.peek();if(t){var n=t.key,o=t.parentKey;t.remoteItem?i=!0:n!==s&&o!==s&&r.push(t)}})}return{targetItem:n,sourceItems:i?[]:r}})(l,v),g=m.targetItem,y=m.sourceItems;return g&&y&&y.length>0&&r&&i?[4,r.copyItems({items:y,parentKey:g.parentKey,targetId:g.id,targetKey:g.key,cid:i.getOwnerId(),group:g.isGroup?1:0,isAsync:!1,isMove:h})]:[3,5];case 3:n.sent();return[4,p.consumeAsync(u.itemInvalidator)];case 4:n.sent().invalidateItems(g.key);n.label=5;case 5:return[2]}})})},engagement:v})});t.MoveCopyAction=i.withResources()(h)});
define("yZe",["require","exports","LO","oYe","pO","Z$"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NavigateToQueryRootAction=void 0;t.NavigateToQueryRootAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),o=e.consume(s.resourceKey),u=e.consume(i.url);return new(e.injected(r.OpenAction))({item:o.getItemSync({parentKey:u.getRootItemKey(t.queryType)}).item,openRelation:2})})});
define("mXe",["require","exports","ww","r","bc","Gi","Qi","I7","zi","jv","Wv","N5","Mc","Ac","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInExplorerAction=void 0;var v=new f.default,m=l.createItemCacheComponent(function(t,i){var f=i.itemKey,l=v.isIE,m=!1,g=void 0;if(l){var y=t.demandItemFacet(o.spItemKeyFacet,f),b=y&&o.spListKeyFacet.serialize(y),w=b&&t.demandItemFacet(s.listFacet,b),E=u.getPageContextFromItemCache(t,f),S=t.demandItemFacet(s.folderPathFacet,f);d.default.isActivated("5924661A-1CC2-43BB-B508-25B4BEF86C42","10/20/2020","Navigate to the specific folder in case of list view threshold throttling")?g=y&&S?y.listFullUrl+"?"+c.serializeQuery({ExplorerWindowUrl:S}):void 0:y&&S&&(g=y.listFullUrl+"?"+c.serializeQuery({rootFolder:S,ExplorerWindowUrl:S}));l=!(!g||!w||!w.isDocumentLibrary||w.templateType===a.default.webPageLibrary||!E||E.viewOnlyExperienceEnabled||E.blockDownloadsExperienceEnabled);m=!!w&&w.templateType===a.default.mySiteDocumentLibrary}return r.createElement(h.Action,n.__assign({isAvailable:l,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["AYe"],t,n)})];case 1:(0,t.sent().openInExplorerExecutor)({isODB:m,explorerWindowUrl:g});return[2]}})})}},p.getItemActionEngagement(t,{itemKey:f,engagement:{name:"OpenInExplorer",isIntentional:!0}})))});t.OpenInExplorerAction=i.withCurrentItem()(m)});
define("TZe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInOfficeClientAction=void 0;t.OpenInOfficeClientAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInOfficeClientAction))})});
define("UZe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInOfficeOnlineAction=void 0;t.OpenInOfficeOnlineAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInOfficeOnlineAction))})});
define("yXe",["require","exports","ww","e7","w8","Bc","bc","O4","c3","ty","Gi","fB","KO","jee","LI"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInPowerBIAction=void 0;t.OpenInPowerBIAction=o.withSelectedItems()(o.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["gYe"],t,n)})];case 1:return[2,t.sent().OpenInPowerBIAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItem({fileName:s.fileNameFacet,itemStatus:u.itemComplianceStatusFacet,openUrl:s.openUrlFacet,permissions:l.permissionsFacet},n),v=r.fileName,m=r.itemStatus,g=r.openUrl,y=r.permissions,b=f.default.hasItemPermission({permissions:y},f.default.openItems),w=a.getItemsScope(e).itemsScopeItemKey,E=o.getCurrentItemSetKey(e,w);if(E){var S=h.getQueryType(e,E);return c.isFeatureEnabled(c.EnablePowerBIIngegration)&&!!v&&!!v.extension&&!!g&&(p.GetDocumentTypeFromExtension(v.extension)===i.DocumentType.Excel||".csv"===v.extension.toLowerCase())&&4!==m&&3!==m&&b&&!d.isRecycleBin(S)}}return!1})))});
define("fXe",["require","exports","ww","r","dv","r7","Wv","bc","Ac","Mc","Bc"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInSharePointAction=void 0;var c=o.createItemCacheComponent(function(e,t){var o=t.itemKey,u=e.demandItemFacet(l.folderFacet,o),c=e.demandItemFacet(l.canonicalUrlFacet,o);if(!u){var h=e.demandItemFacet(l.parentFolderItemFacet,o);c=h&&h.itemKey&&e.demandItemFacet(l.canonicalUrlFacet,h.itemKey)}var p=i.isTeamsWebView(),d=s.isCrossOrigin(),v=(p||d)&&!!c;return r.createElement(f.Action,n.__assign({isAvailable:v,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){window.open(c,"_blank");return[2]})})}},a.getItemActionEngagement(e,{itemKey:o,engagement:{name:"OpenInSharePoint",isIntentional:!0}})))});t.OpenInSharePointAction=u.withSelectedItems()(u.withCurrentItemAsFallback()(u.withExactlyOneItem()(c)))});
define("bXe",["require","exports","r","LO","oYe","Wv","$s"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInTextEditorAction=void 0;var u=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.OpenInTextEditorAction))});t.OpenInTextEditorAction=s.createItemCacheComponent(function(e){return 0===o.getSelectedItemKeys(e).length?null:n.createElement(u,null)})});
define("LZe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OrderPrintsAction=void 0;t.OrderPrintsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OrderPrintsAction))})});
define("fJe",["require","exports","lYe","LO"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PolicyTipAction=void 0;t.PolicyTipAction=n.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(r.actionMap);return new(e.injected(n.PolicyTipAction))({item:t.item})})});
define("uZe",["require","exports","ww","bc","I7","Ow","Qi","Gi","zi","e7"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SeeAllAppsAction=t.LaunchCreateAppViewPanelAction=t.CustomizeFormsNavigationAction=void 0;function l(e,t){var n=t.itemKey;if(!n)return!1;var r=i.getPageContextFromItemCache(e,n);return!!r&&!!n&&s.isFeatureEnabled(s.PowerApps)&&!r.disableAppViews}t.CustomizeFormsNavigationAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["hYe"],t,n)})];case 1:return[2,t.sent().CustomizeFormsNavigationAction]}})})},function(e,t){var n=t.itemKey,r=s.isFeatureEnabled(s.PowerAppListForms)&&s.isFeatureEnabled(s.PowerApps),i=!!n&&r;if(!i)return!1;var f=e.demandItemFacet(o.spItemKeyFacet,n),l=f&&o.spListKeyFacet.serialize(f),c=e.demandItemFacet(u.listFacet,l);if(!c||!c.id)return!1;var h=!(!c.permissions||!c.permissions.manageLists),p=c.isDocumentLibrary,d=Number(c.templateType)===a.ListTemplateType.genericList;return i=(p||d)&&h}));t.LaunchCreateAppViewPanelAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["hYe"],t,n)})];case 1:return[2,t.sent().LaunchCreateAppViewPanelAction]}})})},function(e,t){var n=t.itemKey,r=!!n&&l(e,t);if(r){var i=e.demandItemFacet(o.spItemKeyFacet,n),s=i&&o.spListKeyFacet.serialize(i),a=e.demandItemFacet(u.listFacet,s);r=!(!(a&&a.permissions&&a.permissions.manageLists)||a.isDocumentLibrary)}return r}));t.SeeAllAppsAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["hYe"],t,n)})];case 1:return[2,t.sent().SeeAllAppsAction]}})})},l))});
define("rJe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PreviewAction=void 0;t.PreviewAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.PreviewAction))})});
define("UXe",["require","exports","ww","r","e7","c3","bc","Gi","ty","Qi","Gp","tc","zi","g","fB","xte","U1","KO","xv","Fb","Ae"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchQuickEditAtion=void 0;var E=new l.PlatformDetection;var S=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["bYe"],t,n)})];case 1:return[2,t.sent().LaunchQuickEditAction]}})})},function(e,t){if(d.isFeatureEnabled(d.showQuickEditFeature)&&d.isFeatureEnabled(d.UseItemsScopeInTeamSites))return!1;if(E.isMobile)return!1;var n=t.itemKey;if(n){var r=e.demandItemFacet(f.spFolderItemSetKeyFacet,n);if(r){var i=f.spListKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl}),o=e.demandItemFacet(u.listFacet,i);if((function(e,t,n){if(n&&n.isDocumentLibrary){var r=e.demandItemFacet(c.schemaFacet,t),i=[];if(r&&r.columnKeys)for(var s=0,o=r.columnKeys;s<o.length;s++){var a=o[s],f=e.demandItemFacet(u.internalNameFacet,a);f&&i.push({internalName:f})}return v.isOutOfTheBoxList(i,!0)}return!1})(e,n,o))return!1;var l=f.spPageContextKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl}),m=e.demandItemFacet(u.spPageContextFacet,l);if(m&&m.isAnonymousGuestUser)return!1;if(o&&o.templateType===h.default.mySiteDocumentLibrary)return!1;var S=void 0;if(!t.resources)return!1;if(!(S=t.resources.isExposed(p.inplaceEditorUrl)?t.resources.consume(p.inplaceEditorUrl):null))return!1;var x=e.demandItemFacet(f.spFolderItemSetKeyFacet,n),T=void 0,N=void 0;if(x&&x.viewKey){var C=f.spViewKeyFacet.serialize(x.viewKey);if((N=e.demandItemFacet(u.currentDerivedViewFacet,C))&&N.baseViewXml){T=(new DOMParser).parseFromString(N.baseViewXml,"text/xml").getElementsByTagName("ViewStyle")}}var k=s.getItemsScope(e).itemsScopeItemKey,L=e.demandItemFacet(b.currentViewParamsFacet,k),A=e.demandItemFacet(u.permissionsFacet,f.spItemKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl})),O=a.default.hasItemPermission({permissions:A},a.default.editListItems),M=g.getQueryType(e,n),_=e.demandItemFacet(c.childItemsFacet,n),D=!1;if(_&&_.itemKeys)for(var P=0,H=_.itemKeys;P<H.length;P++){var B=H[P];f.spItemGroupKeyFacet.matches(B)&&(D=!0)}return M===y.default.Files&&!D&&!!o&&!!o.allowGridMode&&!!N&&!!N.id&&!!T&&0===T.length&&!(L&&L.needsAttentionView)&&O&&(!S||!S())&&!(function(e,t){if(e&&e.listBaseTemplate&&h.isPromotedLinksList(e.listBaseTemplate))try{if(t&&t.baseViewXml){var n=w.xmlToDom(t.baseViewXml);if("1"===w.getAttr(n.childNodes[0],"BaseViewID"))return!0}}catch(e){}return!1})(m,N)}}return!1}),x=o.withCurrentItemSet()(S);t.LaunchQuickEditAtion=function(){var e=m.useResourceScope();return r.createElement(x,{resources:e})}});
define("FYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenameColumnAction=void 0;t.RenameColumnAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.RenameColumnAction))(t)})});
define("PZe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReportAbuseAction=void 0;t.ReportAbuseAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ReportAbuseAction))})});
define("kZe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RotateAction=void 0;t.RotateAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.RotateAction))})});
define("QXe",["require","exports","ww","r","bc","U1","Wv","Mc","Bc","g","gJe","zi","gQ","CQ","OQ","IQ","sz","jP","Ex","fe","Qi","bc","Gi","Gi","fB"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RunModelAction=void 0;var N=o.createItemCacheComponent(function(e,t){var i,s,o,N=t.resources;if(!N)return null;var C=t.itemKeys;C=C.filter(function(t){return!e.demandItemFacet(a.folderFacet,t)});var k=N&&N.consume(f.listContext)||{},L=k.listUrl,A=k.listTemplateType,O=T.isFeatureEnabled(T.RunModelFlatFileStructureSupport),M=E.getCurrentItemSetKey(e),_=e.demandItemFacet(w.spFolderItemSetKeyFacet,M),D=_&&w.spListKeyFacet.serialize(_),P=e.demandItemFacet(S.listFacet,D),H="AE9D4F24-EE84-4C0C-A972-A74CFFE939A1",B="Microsoft.Office.Server.ContentCenter.SPMachineLearningWorkItemEntityData",j=N&&N.consume(l.resourceKey),F=N&&N.consume(f.pageContext),I=F&&(null===(i=F.siteId)||void 0===i?void 0:i.replace(/[\{\}']+/g,""))||"",q=F&&(null===(s=F.webId)||void 0===s?void 0:s.replace(/[\{\}']+/g,""))||"",R=F||{},U=R.webAbsoluteUrl,z=R.webServerRelativeUrl,W=C.map(function(t){var n=new m.default(t),r=e.demandItemFacet(x.uniqueIdFacet,t)||"",i=e.demandItem({fileName:a.fileNameFacet,openUrl:a.openUrlFacet},t),s=i.fileName,o=i.openUrl;n.name=(null==s?void 0:s.name)||"";n.extension=(null==s?void 0:s.extension)||"";n.displayName=""+n.name+n.extension;n.openUrl=o||"";n.itemId=r;return n}),X=C&&C.length>0&&A!==c.default.contentCenterSampleLibrary&&!!P&&!!P.flags2&&4096==(4096&P.flags2)&&!!(null===(o=null==P?void 0:P.permissions)||void 0===o?void 0:o.manageLists);return r.createElement(u.Action,{isAvailable:X,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e=(function(){var e=new v.default,t=N.consume(h.resourceKey),n=W.map(function(n){var r=t.register({name:n.displayName||"",iconName:g.getIconNameFromItem({type:y.default.File,extension:n.extension}),type:p.default.runModelOnItems,payloads:{runModelOnItems:{item:n}},batch:e,progress:{minimum:0,maximum:1,current:0}});r.progress.maximum(1);r.progress.current(0);return r});n.forEach(function(e){e.state(d.default.started)});return n})();t=(function(){var e=[];W.forEach(function(t){var n={__metadata:{type:B},Type:H,TargetSiteUrl:U,TargetWebServerRelativeUrl:z,TargetServerRelativeUrl:((null==_?void 0:_.rootFolder)||L)+"/"+t.displayName},r={__metadata:{type:B},Type:H,TargetSiteId:I,TargetWebId:q,TargetUniqueId:t.itemId||""};e.push(O?r:n)});return e})();return[4,null==j?void 0:j.runModel(t).then(function(t){e.forEach(function(e){if(t.has(e.name)){e.progress.current(1);e.state(d.default.completed)}else e.state(d.default.failed)})}).catch(function(t){var n;b.default.log("[ccui] fetching content type failed "+(null===(n=null==t?void 0:t.message)||void 0===n?void 0:n.value));e.forEach(function(e){e.state(d.default.failed)})})];case 1:n.sent();return[2]}})})}})}),C=i.withSelectedItems()(N);t.RunModelAction=function(){var e=s.useResourceScope();return r.createElement(C,{resources:e})}});
define("met",["require","exports","ww","r","Tc","Mc","bK","b3","U1","g","ey","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SchedulingAction=void 0;var h=u.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["yJe"],t,n)})];case 1:return[2,t.sent().SchedulingComponent]}})})}),p=c.default.isActivated("ffb3f710-f091-499b-880a-4dc902d3404b","4/27/2020","hide scheduling option on subwebs");t.SchedulingAction=function(){var e=a.useResourceScope(),t=e.consume(f.pageContext),n=t&&t.listBaseTemplate===o.ListTemplateType.webPageLibrary&&l.PermissionMask.hasPermission(t.webPermMasks,l.PermissionMask.manageWeb)&&(p||(function(e){return e.siteAbsoluteUrl===e.webAbsoluteUrl})(t)),u=i.renderComponentOnExecute(function(n){var i=n.resolve;n.reject;return r.createElement(h,{pageContext:t,resources:e,resolve:i})});return r.createElement(s.Action,{isAvailable:n,onExecute:u})}});
define("cJe",["require","exports","ww","r","b3","Wv","Vh","lYe","LO","Tc","Mc","Ac","Ow"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SharedColumnClickAction=void 0;var p=o.asAutoAction({timeout:3e3})(i.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["kYe"],t,n)})];case 1:return[2,t.sent().ShowPermissionsAction]}})})})),d=u.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(a.actionMap);return new(e.injected(n.ShowPermissionsAction))({item:t.item})}),v=s.createItemCacheComponent(function(e,t){var i=t.itemKey,s=l.logEngagementOnExecute(e,n.__assign({onExecute:f.renderComponentOnExecute(function(e){var i=e.resolve,s=e.reject,o=e.onExecuteProps;return r.createElement(p,n.__assign({},t,{onComplete:i,onError:s,onExecuteProps:o}))},{scope:"global"})},c.getItemActionEngagement(e,{itemKey:i,engagement:{name:"ShareColumnClicked"}})));return r.createElement(f.ActionBase,{onExecute:s})});t.SharedColumnClickAction=h.isFeatureEnabled(h.ManageAccessActionOnDemand)?v:d});
define("dJe",["require","exports","ww","r","sJe","yo","Wv","Tc","c3"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowDetailsPaneAction=void 0;t.ShowDetailsPaneAction=o.createItemCacheComponent(function(e,t){var f=a.getItemsScope(e).itemsScopeItemKey,l=t.itemKey;if(!l||!f)return null;var c=e.dispatch,h=o.evaluateItemCacheComponent(e,r.createElement(i.ToggleInfoPaneAction,null));return r.createElement(u.WithAction,{action:h},function(e){var t=e.isToggled,i=e.execute;return r.createElement(u.ActionBase,{onExecute:function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:c(s.selectItems({itemsScopeItemKey:f,selectedItemKeys:[l],currentSelectionKey:void 0}));return t?[3,2]:[4,i(e)];case 1:n.sent();n.label=2;case 2:return[2]}})})}})})})});
define("nZe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowInfoPaneAction=void 0;t.ShowInfoPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!1})},{isToggleable:!1})});
define("lJe",["require","exports","LO","lYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowItemAnalyticsAction=void 0;t.ShowItemAnalyticsAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ShowItemAnalyticsAction))({item:t.item})})});
define("uJe",["require","exports","LO","lYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowKeyPointsPaneAction=void 0;t.ShowKeyPointsPaneAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ShowKeyPointsAction))({item:t.item,showFeedbackPanel:t.showFeedbackPanel})})});
define("EZe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditSurveyAction=t.ViewSurveyAction=t.ShareSurveyAction=void 0;t.ShareSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:1})});t.ViewSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:2})});t.EditSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:3})})});
define("oJe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SyncAction=void 0;t.SyncAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SyncAction))})});
define("lXe",["require","exports","ww","e7","bc","c3","Gi","Qi","eW","dv","Je"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeamChannelAction=void 0;t.TeamChannelAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["_Ye"],t,n)})];case 1:return[2,t.sent().TeamChannelAction]}})})},function(e,t){var n=t.itemKey,r=s.getItemsScope(e).itemsScopeItemKey,c=i.getCurrentItemSetKey(e,r),h=e.demandItemFacet(u.spFolderItemSetKeyFacet,c),p=e.demandItemFacet(u.spItemKeyFacet,n);if(!h)return!1;if(!l.default.isActivated("1739891D-4D4D-458D-8561-2506E1685479","06/22/2020","special logic for teams file app")&&f.isTeamsWebView())return!1;var d=u.spItemKeyFacet.serialize({itemId:p?p.itemId:"",listFullUrl:h.listFullUrl,rootFolder:h.rootFolder,webAbsoluteUrl:h.webAbsoluteUrl}),v=e.demandItemFacet(o.progIdFacet,d)||"";return a.isTeamChannelBannerEnabled()&&a.isProgIdTeamChannelFolder(v)})))});
define("sJe",["require","exports","LO","oYe","fB"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleInfoPaneAction=void 0;t.ToggleInfoPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!0,allowMultiSelect:!i.isOneDrive})},{isToggleable:!0})});
define("sXe",["require","exports","ww","Qi","AO","bc","e7","Gp","Ge","Gi","Ge","Je","Ow","uy","Tb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UploadFolderAction=t.UploadFileAction=void 0;var v=new u.PlatformDetection,m=!c.default.isActivated("E7319AA8-83D4-406F-9D06-36A022A746F8","7/23/2020","Disable upload cross geo");function g(e,t){var n=e.demandItemFacet(f.spPageContextFacet,d.odspNextAppItemKey);if(n&&t.itemKey&&m){var i=p.getSpWebKey(e,{itemKey:t.itemKey}).itemKey;if(i){var s=r.spWebKeyFacet.deserialize(i).webAbsoluteUrl;return new a.ItemUrlHelper({},{pageContext:n}).getUrlParts({webUrl:s}).geoRelation===l.GeoRelation.crossGeo}}return!1}t.UploadFileAction=s.withOnlyCurrentItem()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return h.isFeatureEnabled(h.ShimSharePointUploader)?[4,new Promise(function(t,n){e(["k0"],t,n)})]:[3,2];case 1:return[2,t.sent().UploadFileAction];case 2:return[4,new Promise(function(t,n){e(["LYe"],t,n)})];case 3:return[2,t.sent().UploadFileAction]}})})},function(e,t){return v.isHtml5FileUploadSupported&&i.getIsUploadItemsActionAvailable(e,t)&&(h.isFeatureEnabled(h.SwitchListItemUploader)||!g(e,t))}));t.UploadFolderAction=s.withOnlyCurrentItem()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return h.isFeatureEnabled(h.ShimSharePointUploader)?[4,new Promise(function(t,n){e(["w0"],t,n)})]:[3,2];case 1:return[2,t.sent().UploadFolderAction];case 2:return[4,new Promise(function(t,n){e(["LYe"],t,n)})];case 3:return[2,t.sent().UploadFolderAction]}})})},function(e,t){return v.isFolderUploadSupported&&i.getIsUploadItemsActionAvailable(e,t)&&(h.isFeatureEnabled(h.SwitchListItemUploader)||!g(e,t))}))});
define("_Je",["require","exports","ww","r","U1","Wv","bc","mw","zb","Mc","LO","Dee","Iee","Qi","uT","QM","vee","Z_","e3","jo","ih","cc","Bc","Ex","D7","Gi","qi","So","nm","pO","tC"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UploadItemsAction=void 0;var M=new g.ProgressKeyFacet("shimUpload");function _(e){var t=this,s=y.useItemCacheDispatch(),o=i.useResourceScope(),a=o.consume(l.currentItemSet.optional),d=o.consume(T.resourceKey),v=e.itemKey,E=e.webAbsoluteUrl,N=e.listFullUrl,C=e.onItemUploaded,k=e.onUploadStarted,L=e.onUploadCompleted;return r.createElement(f.Action,{onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){function t(e){var t,r=null===(t=e.properties)||void 0===t?void 0:t.ID,i=e.type===x.default.Folder;if(i||r){var s=d.getItemUrlParts(e.key),o=s.serverRelativeItemUrl,u=o===s.serverRelativeListUrl?"":o;return p.spItemKeyFacet.serialize(n.__assign({webAbsoluteUrl:E,listFullUrl:N},i?{rootFolder:u}:{itemId:r}))}}var r,i,f,l,y,T,A,_,D;return n.__generator(this,function(p){switch(p.label){case 0:r=e&&e.event&&e.event;return(i=r&&r.dataTransfer)&&i.files?[4,s(O.demandItems(function(e){return e.demandItemFacet(u.knockoutStoreItemFacet,v)}))]:[2];case 1:if(!(f=p.sent()))throw new Error("No target store item for Upload");l=!1;y=[];for(T=0;T<i.files.length;T++){A=i.files[T];y.push(A);l||!0!==A.isFolder&&!0!==A.isDirectory||(l=!0)}_=g.progressBatchKeyFacet.serializeNext();D=M.serializeBatchKey(_);o.consumeAsync(c.asyncTypeResourceKey).then(function(e){var r=new e({files:y,parentItem:f.peek(),itemSet:a&&a.peek(),wasDragAndDropped:!0,type:l?h.default.Folder:h.default.Html5file,skipInvalidation:!0,onItemUploaded:function(e){var r,i=e.type===x.default.Folder,u=t(e);if(u){var a=e.parent?t(e.parent):void 0,f=M.serializeTaskKey(_,u,{});s(b.resolveItems({items:(r={},r[f]=w.createdItemFacet.pack({itemKey:u}),r[u]=n.__assign(n.__assign(n.__assign({},S.displayNameFacet.pack(e.displayName)),S.parentFolderItemFacet.pack(a?{itemKey:a}:void 0)),S.folderFacet.pack(i?{}:void 0)),r)}));C&&s(C({progressItemKey:f}));o.consumeAsync(m.resourceKey).then(function(t){return t(e)})}}});r.start();k&&s(k({progressItemKey:D}));return r.wait().catch(function(){}).then(function(){L&&s(L({progressItemKey:D}))})});return[2]}})})},engagement:{name:"Upload",isIntentional:!0}})}t.UploadItemsAction=i.withResources()(s.createItemCacheComponent(function(e,t){var i=t.itemKey,s=t.onItemUploaded,u=t.onUploadStarted,f=t.onUploadCompleted,l=t.resources,c=e.dispatch,h=i,m=e.demandItemFacet(p.spItemGroupKeyFacet,i),g=o.getCurrentItemSetKey(e),y=e.demandItemFacet(p.spFolderItemSetKeyFacet,g)||m&&m.itemSetKey;if(!i||!g||!y)return null;var S=y.webAbsoluteUrl,x=y.listFullUrl,T=y.rootFolder;m&&(h=p.spItemKeyFacet.serialize({webAbsoluteUrl:S,listFullUrl:x,rootFolder:T}));if(!a.hasKnockoutStoreItem(e,h))return null;return r.createElement(_,{itemKey:h,onItemUploaded:function(e){return function(){var t,n=c(E.readItems(function(t){var n=t.demandItemFacet(w.createdItemFacet,e.progressItemKey);return n&&n.itemKey}));if(n&&m){var r=c(E.readItems(function(e){return e.demandItemFacet(L.defaultCollapsedFacet,i)}));c(d.assignItemToGroup({items:(t={},t[n]={groupKey:i},t)})).then(function(){var e,t;r?l.consumeAsync(A.itemInvalidator).then(function(e){e.invalidateGroups([i])}):c(v.refreshItemsInSet({items:(e={},e[g]=(t={},t[n]={},t),e)}))})}s&&c(s(e))}},onUploadStarted:function(e){var t=e.progressItemKey;return function(){var r,s;c(b.resolveItems({items:(r={},r[i]=n.__assign({},N.activeUploadProjectionFoldersFacet.pack((s={},s[t]={},s))),r)}));u&&c(u(e))}},onUploadCompleted:function(e){var t=e.progressItemKey;return function(){var n,r;c(b.resolveItems({items:(n={},n[i]=C.pack({activeUploadProjectionFolders:N.activeUploadProjectionFoldersFacet},{activeUploadProjectionFolders:(r={},r[t]=new k.Delete,r)}),n)}));f&&c(f(e))}},webAbsoluteUrl:S,listFullUrl:x})}))});
define("pZe",["require","exports","ww","r","bc","I7","D7","Gi","O4","ty","Bc","e7","U1","Qi","Ow","Wi","Ge","k"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VersionHistoryAction=void 0;var y=g.Killswitch.isActivated("e24fa83b-6aa0-41b8-bf93-04694be57bee","11/16/2020","This killswitch controls whether or not OneDrive host specfic check gets executed.");var b=c.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["mYe"],t,n)})];case 1:return[2,t.sent().VersionHistoryAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!n)return!1;var i=s.getPageContextFromItemCache(e,n),c=e.demandItemFacet(u.permissionsFacet,n),h=e.demandItemFacet(a.itemComplianceStatusFacet,n),g=e.demandItemFacet(l.malwareDetectedFacet,n),b=!!i&&!i.isEmailAuthenticationGuestUser&&f.PermissionMask.hasItemPermission({permissions:c},f.PermissionMask.viewVersions)&&3!==h&&4!==h;if(g||!b)return!1;var w=e.demandItemFacet(p.spItemKeyFacet,n),E=w&&p.spListKeyFacet.serialize(w),S=e.demandItemFacet(u.listFacet,E),x=!(!S||!S.enableVersions&&!S.isModerated);if(!x)return!1;var T=r&&r.consume(o.resourceKey.optional);if(T){var N=e.demandItemFacet(l.canonicalUrlFacet,n),C=T.getUrlParts({path:N});if(!y&&d.isOneDrive){if(C.geoRelation===m.GeoRelation.crossGeo)return!1}else if(C.isCrossDomain)return!1}var k=e.demandItemFacet(l.folderFacet,n),L=e.demandItemFacet(u.documentSetFacet,n),A=e.demandItemFacet(v.oneNoteFacet,n),O=e.demandItemFacet(u.listItemIdFacet,n),M=d.isFeatureEnabled(d.DocumentSetsModernView)&&d.isFeatureEnabled(d.UseItemsScopeInTeamSites)&&O;return x=!k&&!A||!(!M||!L)}),w=i.withSelectedItems()(i.withExactlyOneItem()(b));t.VersionHistoryAction=function(){var e=h.useResourceScope();return r.createElement(w,{resources:e})}});
define("oYe",["require","exports","ww","r","v","Mc","U1","Bz","dz","oz","Je","g1"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemsScopeActionFromKnockout=void 0;var h=e("module").id;t.createItemsScopeActionFromKnockout=function(e,t){void 0===t&&(t={});function n(n){return r.createElement(c.WithKnockoutResourceScope,null,r.createElement(p,{createKnockoutAction:e,options:t,actionProps:n}))}return l.default.isActivated("DB243761-5E52-4E84-8204-175D856F50DE","9/4/2019","Always use ItemCache selection shim for actions")?n:o.withChildResources(function(e){e.exposeFactory(a.typeResourceKey,new i.AliasResourceFactory(f.typeResourceKey))},{owner:h})(n)};function p(e){var t=this,i=e.createKnockoutAction,a=e.options,f=e.actionProps,l=a.isToggleable,c=void 0!==l&&l,h=a.isExecutorOnly,p=void 0!==h&&h,d=o.useResourceScope(),v=r.useRef(),m=v.current||(v.current=i(d,f));r.useEffect(function(){return function(){m.dispose()}},[]);var g=u.useObservableValue(!!p||m.isAvailable),y=u.useObservableValue(c?m.isToggled:void 0);return r.createElement(s.ActionBase,{isAvailable:g,onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,m.execute(e.event)];case 1:t.sent();return[2]}})})},isToggled:y})}});
define("lYe",["require","exports","oYe","uYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemsScopeItemActionFromKnockout=void 0;t.createItemsScopeItemActionFromKnockout=function(e,t){void 0===t&&(t={});var i=n.createItemsScopeActionFromKnockout(e,t);return r.withKnockoutStoreItem(function(e){return{item:e}})(i)}});
define("rYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddToQuickLaunchAction=void 0;t.AddToQuickLaunchAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.AddToQuickLaunchAction))})});
define("wYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AlertAction=void 0;t.AlertAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.AlertAction))(t)})});
define("OYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CancelEditAtion=void 0;t.CancelEditAtion=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CancelEditAction))})});
define("CYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ComplianceDetailsAction=void 0;t.ComplianceDetailsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ComplianceDetailsAction))})});
define("DYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateFileRequestAction=void 0;t.CreateFileRequestAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateFileRequestAction))},{isExecutorOnly:!0})});
define("cYe",["require","exports","ww","fe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createNewTopic=void 0;function i(e){var t=(function(e){var t;if(null===(t=null==e?void 0:e.knowledgeHubSiteDetails)||void 0===t?void 0:t.Url)return e.knowledgeHubSiteDetails.Url;r.default.log(new Error("The Knowledge Hub/Center site url isn't valid, configure the KnowledgeCenter URL for Knowledge Mining scenarios to work correctly."));return""})(e);t&&window.open(t+"/"+e.layoutsUrl+"/CreateTopicPage.aspx")}t.createNewTopic=function(e){var t=this;return function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){i(e.pageContext);return[2]})})}}});
define("xYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateShortcutAction=void 0;t.CreateShortcutAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchCreateShortcutPanel))})});
define("sYe",["require","exports","ww","wYe","OYe","CYe","xYe","IYe","DYe","SYe","yYe","vYe","gYe","bYe","hYe","_Ye","mYe","pYe","fYe","dYe","cYe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t);n.__exportStar(d,t);n.__exportStar(v,t);n.__exportStar(m,t);n.__exportStar(g,t);n.__exportStar(y,t);n.__exportStar(b,t);n.__exportStar(w,t)});
define("pYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditItemAction=void 0;t.EditItemAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=t.isBulkEdit,i=e.consume(n.actionMap);return new(e.injected(i.EditItemAction))({isBulkEdit:r})})});
define("IYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditNewMenuAction=void 0;t.EditNewMenuAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditNewMenuAction))({templates:[]})})});
define("SYe",["require","exports","LO","oYe","hZ","lYe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TriggerFlowItemAction=t.TriggerFlowAction=t.SetUpReminderFlowAction=t.SetUpApprovalFlowAction=t.ShowExistingFlowsAction=t.LaunchConfigureFlowsPanelAction=t.AddFlowAction=void 0;t.AddFlowAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.AddFlowAction))});t.LaunchConfigureFlowsPanelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchConfigureFlowsPanelAction))});t.ShowExistingFlowsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowExistingFlowsAction))});t.SetUpApprovalFlowAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SetUpApprovalFlowAction))});t.SetUpReminderFlowAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.SetUpReminderFlowAction))({columnName:t.columnName,columnDisplayName:t.columnDisplayName})});t.TriggerFlowAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),s=t?i.default.getAction(t.flow,r):r.TriggerFlowAction;return new(e.injected(s))({flow:t.flow})});t.TriggerFlowItemAction=s.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),s=t?i.default.getAction(t.flow,r,!0):r.TriggerFlowByIdAction;return new(e.injected(s))({item:t.item,userInvokedItem:!0,flow:t.flow,noCache:t.noCache})})});
define("vYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchFormatViewPaneAction=void 0;t.LaunchFormatViewPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchFormatViewPaneAction))})});
define("EYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPanelAction=void 0;t.LaunchMoveCopyPanelAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchMoveCopyPanelAction))({isMove:t.isMove})})});
define("yYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MakeHomePageAction=void 0;t.MakeHomePageAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.MakeHomepageAction))})});
define("AYe",["require","exports","Uxe"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInExplorerExecutor=void 0;t.openInExplorerExecutor=function(e){var t=e.isODB,r=e.explorerWindowUrl;if(r){t&&n.set("odbnu","0");window.open(r,"_blank")}}});
define("gYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInPowerBIAction=void 0;t.OpenInPowerBIAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInPowerBIAction))})});
define("hYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SeeAllAppsAction=t.LaunchCreateAppViewPanelAction=t.CustomizeFormsNavigationAction=void 0;t.CustomizeFormsNavigationAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CustomizeFormsNavigationAction))});t.LaunchCreateAppViewPanelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchCreateAppViewPanelAction))});t.SeeAllAppsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SeeAllAppsAction))})});
define("bYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchQuickEditAction=void 0;t.LaunchQuickEditAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditAction))})});
define("kYe",["require","exports","LO","lYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowPermissionsAction=void 0;t.ShowPermissionsAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ShowPermissionsAction))({item:t.item})},{isExecutorOnly:!0})});
define("_Ye",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeamChannelAction=void 0;t.TeamChannelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchTeamChannelAction))})});
define("LYe",["require","exports","ww","r","Iee","LO","oYe","Lv","Z_","qi","So","Qi","Ex","gc","Vs","jo","ih","Gi","Bc","e3","xo","Wv","Je","Ge","Tb","tC","mw"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UploadFolderAction=t.UploadFileAction=void 0;var k=new a.ProgressKeyFacet("shimUpload");var L=o.createItemsScopeActionFromKnockout(function(e,t){var n=t.uploadProcessorType,r=t.createUploadObserver,i=e.consume(s.actionMap);return new(e.injected(i.UploadAction))({uploadProcessorType:n,createUploadObserver:r})},{isExecutorOnly:!0});function A(e){return E.connectToItemCache(M)(function(t){var i=(function(e){var t=this,r=e.itemKey,i=e.overrides,s=i.onItemUploaded,o=i.onUploadStarted,u=i.onUploadCompleted,c=e.getUploadedItemKey,p=b.useItemCacheDispatch();return w.useEventHandler(function(){var e,i,d=a.progressBatchKeyFacet.serializeNext(),b=k.serializeBatchKey(d);r&&p(v.resolveItems({items:(e={},e[r]=n.__assign({},g.activeUploadProjectionFoldersFacet.pack((i={},i[b]={},i))),e)}));o&&p(o({progressItemKey:b}));return{onItemUploaded:function(e){var t,r=e.type===h.default.Folder,i=c(e);if(i){var o=e.parent?c(e.parent):void 0,u=k.serializeTaskKey(d,i,{});p(v.resolveItems({items:(t={},t[u]=m.createdItemFacet.pack({itemKey:i}),t[i]=n.__assign(n.__assign(n.__assign({},y.displayNameFacet.pack(e.displayName)),y.parentFolderItemFacet.pack(o?{itemKey:o}:void 0)),y.folderFacet.pack(r?{}:void 0)),t)}));s&&p(s({progressItemKey:u}))}},onUploadCompleted:function(){var e,t;r&&p(v.resolveItems({items:(e={},e[r]=f.pack({activeUploadProjectionFolders:g.activeUploadProjectionFoldersFacet},{activeUploadProjectionFolders:(t={},t[b]=new l.Delete,t)}),e)}));u&&p(u({progressItemKey:b}))},resolveParentItem:function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,p(N.demandItems(function(e){return e.demandItemFacet(C.knockoutStoreItemFacet,r)}))];case 1:e.sent();return[2]}})})}}})})(t);return r.createElement(L,{uploadProcessorType:e,createUploadObserver:i})})}var O=S.default.isActivated("0F47DF9E-205A-4A21-BA79-DE69FAE2CBE5","5/4/2020","Invoke control handlers within KO upload actions");t.UploadFileAction=O?o.createItemsScopeActionFromKnockout(function(e){var t=e.consume(s.actionMap);return new(e.injected(t.UploadAction))({uploadProcessorType:i.UploadProcessorType.Html5file})},{isExecutorOnly:!0}):A(i.UploadProcessorType.Html5file);t.UploadFolderAction=O?o.createItemsScopeActionFromKnockout(function(e){var t=e.consume(s.actionMap);return new(e.injected(t.UploadAction))({uploadProcessorType:i.UploadProcessorType.Folder})},{isExecutorOnly:!0}):A(i.UploadProcessorType.Folder);function M(e){var t=p.getCurrentItemKey(e),r=e.demandItemFacet(c.spItemGroupKeyFacet,t),i=d.getCurrentItemSetKey(e),s=e.demandItemFacet(u.uploadItemsActionControl,t),o=e.demandItemFacet(g.spPageContextFacet,T.odspNextAppItemKey),a=e.demandItemFacet(c.spFolderItemSetKeyFacet,i)||r&&r.itemSetKey;return{itemKey:t,overrides:u.uploadItemsActionControl.evaluate(s)(e,{itemKey:t,targetItemKey:t,isAvailable:!0}),getUploadedItemKey:function(e){var t,r=null===(t=e.properties)||void 0===t?void 0:t.ID,i=e.type===h.default.Folder;if((i||r)&&a&&o){var s=new x.ItemUrlHelper({},{pageContext:o}).getItemUrlParts(e.key),u=s.serverRelativeItemUrl,f=u===s.serverRelativeListUrl?"":u,l=a.webAbsoluteUrl,p=a.listFullUrl;return c.spItemKeyFacet.serialize(n.__assign({webAbsoluteUrl:l,listFullUrl:p},i?{rootFolder:f}:{itemId:r}))}}}}});
define("mYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VersionHistoryAction=void 0;t.VersionHistoryAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowVersionHistoryAction))})});
define("dYe",["require","exports","lYe","LO"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewCommentsAction=void 0;t.ViewCommentsAction=n.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(r.actionMap);return new(e.injected(n.ViewItemAction))({item:t.item,preferredSection:"comments"})})});
define("fYe",["require","exports","LO","oYe"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewItemAction=void 0;t.ViewItemAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ViewItemAction))({preferredSection:t.preferredSection})})});
define("$Je",["require","exports","I7","Ow","fv"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkBaseAvailability=void 0;t.checkBaseAvailability=function(e,t){var s=t.itemKey;if(!s)return!1;var o=n.getPageContextFromItemCache(e,s),u=o&&o.webTemplate,a=Number(u)===i.default.mySite,f=!!a&&!!o&&(!1===o.isSiteOwner||void 0===o.isSiteOwner&&!o.isSiteAdmin);return!!o&&!o.isAnonymousGuestUser&&!o.isEmailAuthenticationGuestUser&&!o.disableFlows&&r.isFeatureEnabled(r.ProcessSimple)&&(!a||r.isFeatureEnabled(r.ODBFlow))&&!f}});
define("ZJe",["require","exports","ww","e7","bc","$Je","I7","Ow","zi","Je"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SetUpApprovalFlowAction=void 0;t.SetUpApprovalFlowAction=i.withCurrentItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["SYe"],t,n)})];case 1:return[2,t.sent().SetUpApprovalFlowAction]}})})},function(e,t){var n=t.itemKey,r=o.getPageContextFromItemCache(e,n);return!!r&&!!n&&s.checkBaseAvailability(e,{itemKey:n})&&r.hasManageWebPermissions&&u.isFeatureEnabled(u.WexSitePagesContentApproval)&&r.listBaseTemplate===a.ListTemplateType.webPageLibrary&&!r.disableFlows&&(f.default.isActivated("9905bd80-6e9f-4cd7-ab5d-e4929ce90551","08/07/2020","hide approval button on GCC")||!!r.farmSettings&&"0"!==r.farmSettings.ExternalService_pagecontentapprovalenabled)}))});
define("XJe",["require","exports","ww","e7","bc","$Je","Ow"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SetUpReminderFlowAction=void 0;var u=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["SYe"],t,n)})];case 1:return[2,t.sent().SetUpReminderFlowAction]}})})},function(e,t){var n=t.itemKey;return!!n&&o.isFeatureEnabled(o.DynamicFlowDates)&&s.checkBaseAvailability(e,{itemKey:n})});t.SetUpReminderFlowAction=i.withCurrentItem()(u)});
define("YJe",["require","exports","ww","e7","bc","$Je","I7","Ow","Qi","Gi","Bc","bZ","pZ","JJe","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TriggerFlowItemAction=t.TriggerFlowAction=void 0;var v=d.default.isActivated("ff312379-d00f-4a6b-88e5-bece529c9b72","08/19/2020","Compute isTeamSiteInODB boolean");function m(e,t){var n=t.flow,r=t.itemKey,i=t.defaultToTriggerById;if(!r)return!1;var m=o.getPageContextFromItemCache(e,r),g=e.demandItemFacet(a.spItemKeyFacet,r),y=g&&a.spListKeyFacet.serialize(g),b=e.demandItemFacet(f.listFacet,y),w=!0;if(!i){if(!(w=!!m&&s.checkBaseAvailability(e,{itemKey:r})))return!1;if(d.default.isActivated("54C8743A-E2F3-40AA-9710-17365D247500","10/30/2020","No need to check for SPOFlowIntegration flight")){var E=!!b&&!!b.isDocumentLibrary;if(!(w=u.isFeatureEnabled(u.SPOFlowIntegration)||E))return!1}else;}if(n&&n.categoryNames)if(n.categoryNames.indexOf(c.EnvironmentAppropriateRequestSignoffTemplateCategory)>-1){var S=e.demandItemFacet(f.rowDataFacet,r),x=!v&&p.computeIsTeamSiteInODB(e,m);w=!!m&&!!b&&!!S&&!x&&h.isTriggerSignoffFlowActionAvailable(m,b,{properties:{CheckedOutUserId:S.CheckedOutUserId}})}else if(n.categoryNames.indexOf("ODB_CONVERT_TO_PDF")>-1){var T=e.demandItemFacet(l.fileNameFacet,r);w=!!T&&!!T.extension&&h.isTriggerODBConvertToPdfFlowActionAvailable({extension:T.extension})}return w}var g=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["SYe"],t,n)})];case 1:return[2,t.sent().TriggerFlowAction]}})})},function(e,t){return m(e,t)});t.TriggerFlowAction=i.withSelectedItems()(i.withExactlyOneItem()(g));t.TriggerFlowItemAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["SYe"],t,n)})];case 1:return[2,t.sent().TriggerFlowItemAction]}})})},function(e,t){return m(e,n.__assign(n.__assign({},t),{defaultToTriggerById:!0}))})});
define("eZe",["require","exports","ww","bc","e7","b1","Tb","c3","Gi","uv","zi","Fb","U3","xv","LI","fB","Ow","xx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleFiltersPaneAction=void 0;t.ToggleFiltersPaneAction=r.withOnlyCurrentItem()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["krt"],t,n)})];case 1:return[2,t.sent().ToggleFiltersPaneAction]}})})},function(e,t){var n=e.demandItemFacet(a.spPageContextFacet,o.odspNextAppItemKey),r=n&&Number(n.webTemplate)===f.default.mySite;if(!r)return!0;var i=u.getItemsScope(e).itemsScopeItemKey,s=e.demandItemFacet(c.currentViewParamsFacet,i)||{},y=d.getQueryType(s),b=h.isSearchType(y),w=y===p.default.SharedWithMe,E=v.isFeatureEnabled(m.SharedWithMeItemsScope)||!g.isGallatin();return!(r&&n.listBaseTemplate&&Number(n.listBaseTemplate)===l.ListTemplateType.mySiteDocumentLibrary)||v.isFeatureEnabled(v.FiltersInODB)&&b||E&&w},function(e,t){var n=e.demandItemFacet(s.currentPaneFacet,o.odspNextAppItemKey);return!!n&&n.paneKey===s.FILTERS_PANE_KEY}))});
define("Net",["require","exports","ww","Wv","Mc","Ac","Gi","Qi","Ow","Het"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NewReportAction=void 0;t.NewReportAction=r.connectToItemCache(function(e,t){var r=t.itemKey,i=(function(e,t){var n=t.itemKey,r=e.demandItemFacet(u.spItemKeyFacet,n),i=e.demandItemFacet(o.spPageContextFacet,u.spPageContextKeyFacet.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl})),s=i.farmSettings&&i.farmSettings.ExternalService_powerbihostname;if(!s)return"";var a=i.webAbsoluteUrl+i.listUrl.substring(i.webServerRelativeUrl.length);return"http://"+s+"/sharepointlist?spListId="+i.listId+"&spListUrl="+a+"&spListUniqueId="+f.computeUniqueId(i)})(e,{itemKey:r});return n.__assign({isAvailable:!!i&&a.isFeatureEnabled(a.PowerBIIntegration),onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){window.open(i,"_blank");return[2]})})}},s.getItemActionEngagement(e,{itemKey:r,engagement:{name:"NewReportAction",isIntentional:!0}}))})(i.Action)});
define("Uet",["require","exports","ww","Wv","Mc","Ac"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NoReportAction=void 0;t.NoReportAction=r.connectToItemCache(function(e,t){var r=t.itemKey;return n.__assign({isAvailable:!1},s.getItemActionEngagement(e,{itemKey:r,engagement:{name:"NoReportAction",isIntentional:!0}}))})(i.Action)});
define("Fet",["require","exports","ww","Wv","Mc","Ac","Gi","Qi","Ow","Het"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenReportAction=void 0;t.OpenReportAction=r.connectToItemCache(function(e,t){var r=t.itemKey,i=(function(e,t){var n=t.itemKey,r=t.report,i=e.demandItemFacet(u.spItemKeyFacet,n),s=e.demandItemFacet(o.spPageContextFacet,u.spPageContextKeyFacet.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})),a=s.farmSettings&&s.farmSettings.ExternalService_powerbihostname;if(!a)return"";var l=s.webAbsoluteUrl+s.listUrl.substring(s.webServerRelativeUrl.length);return"http://"+a+"/sharepointlist/groups/"+r.groupId+"/reports/"+r.reportId+"?spListId="+s.listId+"&spListUrl="+l+"&spListUniqueId="+f.computeUniqueId(s)})(e,{itemKey:r,report:t.report});return n.__assign({isAvailable:!!i&&a.isFeatureEnabled(a.PowerBIIntegration),onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){window.open(i,"_blank");return[2]})})}},s.getItemActionEngagement(e,{itemKey:r,engagement:{name:"OpenReportAction",isIntentional:!0}}))})(i.Action)});
define("Het",["require","exports","M"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.computeUniqueId=void 0;t.computeUniqueId=function(e){var t=e.siteId,r=e.listId;return n.default.normalizeLower(t,!1)+n.default.normalizeLower(r,!1)}});
define("I$e",["require","exports","ww","r","dce","_A","MA","ou","Zm","F$e","fe","U$e","T$e","P$e","E$e","C$e","g","OL","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s._createModelPanelContent=r.createRef();s._viewModelPanelContent=r.createRef();s.onRendeCreateModelFooterContent=function(){return r.createElement(i.Stack,{gap:15},r.createElement(i.Stack.Item,{className:"footerDescription"},r.createElement(g.Text,null,f.default.AIBuilderContinueText)),r.createElement(i.Stack.Item,null,r.createElement(a.PrimaryButton,{onClick:s.onCreateClick,style:{marginRight:"8px"},disabled:s.state.isWorking||s.state.isLoading||!s.state.requireFieldSatisfied},f.default.NextText),r.createElement(a.DefaultButton,{onClick:s.props.onDismiss},f.default.CancelText)))};s.onCreateClick=function(){return n.__awaiter(s,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:if(!this._createModelPanelContent.current)return[2];this.setState({isWorking:!0});return[4,this._createModelPanelContent.current.onCreate()];case 1:e=t.sent();this.setState({isWorking:!1});this.props.onComplete(!!e);return[2]}})})};s.onRendeUpdateModelFooterContent=function(){return r.createElement(i.Stack,{gap:15},r.createElement(i.Stack.Item,null,r.createElement(a.PrimaryButton,{onClick:s.onUpdateClick,style:{marginRight:"8px"},disabled:s.state.isWorking||s.state.isLoading||!s.state.requireFieldSatisfied},f.default.SaveText),r.createElement(a.DefaultButton,{onClick:s.props.onDismiss},f.default.CancelText)))};s.onUpdateClick=function(){return n.__awaiter(s,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:if(!this._viewModelPanelContent.current)return[2];this.setState({isWorking:!0});return[4,this._viewModelPanelContent.current.onUpdate()];case 1:e=t.sent();this.setState({isWorking:!1});this.props.onComplete(!!e);return[2]}})})};s.state={loadingError:"",isLoading:!0,isWorking:!1,requireFieldSatisfied:!1,renderFooter:!1};s._listAIModelDataSource=s.props.resources.consume(c.resourceKey);s._contentTypeDataSource=s.props.resources.consume(h.resourceKey);s._peopleDataSource=s.props.resources.consume(p.resourceKey);return s}t.prototype.componentDidMount=function(){var e;return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s,o,u,a,f,c,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:t=this.props.createModelContext,r=t.webAbsoluteUrl,i=t.listId;n.label=1;case 1:n.trys.push([1,9,,10]);return[4,this._listAIModelDataSource.getListAIModel(r,i)];case 2:s=n.sent();if(!(o=null==s?void 0:s.predictionModel)){this.setState({isLoading:!1,loadingError:"",viewModelContext:void 0});return[2]}if(o.modifiedBy)return[3,3];a=void 0;return[3,5];case 3:return[4,this._peopleDataSource.getPeopleByLoginName(r,o.modifiedBy)];case 4:a=n.sent();n.label=5;case 5:u=a;if(o.contentTypeId)return[3,6];c=void 0;return[3,8];case 6:return[4,this._contentTypeDataSource.getContentTypeById(r,i,o.contentTypeId)];case 7:c=n.sent();n.label=8;case 8:f=c;this.setState({isLoading:!1,loadingError:"",viewModelContext:{model:o,people:u,contentType:f,webAbsoluteUrl:r,listId:i}});return[3,10];case 9:h=n.sent();p=null===(e=this.props.resources.consume(m.pageContext))||void 0===e?void 0:e.CorrelationId;d="";if(h&&h.message&&h.message.value){d=h.message.value;v=h.correlationId||p||"";d=d+" correlationId: "+v}else d=JSON.stringify(h);l.default.log("[CreateAIBModelPanel] Error "+d);this.setState({isLoading:!1,loadingError:d||"Please try again later. CorrelationId: "+p,viewModelContext:void 0});return[3,10];case 10:return[2]}})})};t.prototype.render=function(){var e=this,t=this.state,n=t.isLoading,a=t.loadingError,l=t.viewModelContext,c=t.renderFooter,h=n,p=!n&&!a,m=!!(l&&l.model&&l.model.id&&l.model.environment),g=!n&&m,y=!n&&!m||!this.props.createModelContext.isPredictionModelApplied&&!m,b=y&&!n,w=!y&&c&&!n;return r.createElement(s.Panel,{closeButtonAriaLabel:f.default.CloseText,headerText:y?f.default.CreateModelHeader:g?f.default.ViewModelHeader:"",isOpen:!0,isLightDismiss:!0,onDismiss:this.props.onDismiss,onRenderFooterContent:b?this.onRendeCreateModelFooterContent:w?this.onRendeUpdateModelFooterContent:void 0,type:s.PanelType.smallFixedFar},g&&r.createElement(v.ViewModelPanelContent,{ref:this._viewModelPanelContent,resources:this.props.resources,viewModelContext:l,getRequiredFieldSatisfied:function(t){e.setState({requireFieldSatisfied:t})},retentionLabelRendered:function(t){e.setState({renderFooter:t})}}),y&&r.createElement(d.CreateModelPanelContent,{ref:this._createModelPanelContent,createModelContext:this.props.createModelContext,resources:this.props.resources,getRequiredFieldSatisfied:function(t){e.setState({requireFieldSatisfied:t})}}),h&&r.createElement(i.Stack,null,r.createElement(u.Spinner,{size:u.SpinnerSize.small,className:"CreateAIBModelPanel-separator",ariaLive:"assertive",labelPosition:"right",label:f.default.LoadingText})),p&&r.createElement(i.Stack,null,r.createElement(o.Label,{className:"ErrorTextStyle"},a)))};return t})(r.Component);t.default=y});
define("E$e",["require","exports","ww","r","JR","ou","nre","MA","dce","jR","OL","oL","M$e","fe","qJe","T$e","k$e","t_","L$e","Oe","sB","bl","Je","ZSe","fB","g","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateModelPanelContent=void 0;var C=S.default.isActivated("1c1b9b86-3568-49ee-aa81-028fa23aff97","11/05/2020","Show rentention label setting in model creation panel"),k="create",L="select",A="Intelligent Document Content Types",O="0x0101",M=(function(e){n.__extends(t,e);function t(t){var c=e.call(this,t)||this;c._renderAdvancedSettings=function(){var e=c.state.showAdvancedSettings;return r.createElement("div",null,c._renderAdvancedSettingsHeader(),e&&c._renderAdvancedSettingsContent())};c._toggleAdvancedSettings=function(){c.setState({showAdvancedSettings:!c.state.showAdvancedSettings},function(){c._postAdvancedSettingsToggleActions(c.state.showAdvancedSettings)})};c._postAdvancedSettingsToggleActions=function(e){var t=e?"AdvancedSettingsExpanded":"AdvancedSettingsCollapsed",n=e?h.default.AdvancedSettingsExpandedScreenReaderText:h.default.AdvancedSettingsCollapsedScreenReaderText;c._engagement&&c._engagement.logData({name:t,isIntentional:!0,component:"CreateFormProcessingModelPanel"});y.default.alert(t,n)};c._screenReaderCall=function(){var e=c.state.showAdvancedSettings?"collapse":"expand";y.default.alert("Click here to "+e+" advanced settings panel",b.format(h.default.ScreenReaderCallText,e))};c._renderAdvancedSettingsHeader=function(){var e=c.state.showAdvancedSettings;return r.createElement("div",{onFocus:c._screenReaderCall,onClick:c._toggleAdvancedSettings,className:"sp-CreateAIBModelPanel-AdvancedSettingsHeader"},r.createElement("div",{className:"sp-CreateAIBModelPanel-AdvancedSettingsHeaderText"},h.default.AdvancedSettingsText),r.createElement(g.IconButton,{style:{fontSize:"13px"},className:"sp-CreateAIBModelPanel-ChevronColor",iconProps:{iconName:e?"ChevronUp":"ChevronDown"},title:h.default.AdvancedSettingsText,ariaLabel:e?h.default.HideAdvancedSettingsText:h.default.ShowAdvancedSettingsText}))};c._renderAdvancedSettingsContent=function(){return r.createElement("div",{className:"sp-CreateAIBModelPanel-AdvancedSettingsExpandedMargin"},c._renderAssociatedContentTypeHeader(),c._renderDescriptionText(),c._renderChoiceGroup(),c._renderContentTypesDropdown(),c._renderRetentionLabel(),c._renderViewSetting())};c._renderAssociatedContentTypeHeader=function(){return r.createElement(u.Label,{styles:{root:{marginTop:"20px"}}},r.createElement(a.Stack,{horizontal:!0,verticalAlign:"center"},r.createElement("span",null,h.default.ContentTypeHeaderFormProcessing," ")))};c._renderDescriptionText=function(){return r.createElement(l.Text,null," ",h.default.AdvancedSettingsDescription)};c._renderChoiceGroup=function(){var e=[{key:k,text:h.default.createContentType},{key:L,text:h.default.selectContentType}];return r.createElement(i.ChoiceGroup,{options:e,onChange:c.onChoiceGroupSelectedChange,selectedKey:c.state.contentTypeOperationSelected})};c._renderContentTypesDropdown=function(){var e=c.state,t=e.contentTypeOperationSelected,n=e.contentTypeErrorMessage,i=e.contentTypeOptions,u=e.loadingContentTypeCompleted,f=e.isCreating;return r.createElement(r.Fragment,null,t===L&&r.createElement(r.Fragment,null,r.createElement(o.Dropdown,{ariaLabel:h.default.selectContentTypeIndicator,className:"sp-CreateAIBModelPanel-Dropdown",errorMessage:n,onChange:c.onDropdownSelectionChange(),options:i,placeholder:h.default.selectContentTypeIndicator,disabled:f||!u}),!u&&r.createElement(a.Stack.Item,null,r.createElement(s.Spinner,{size:s.SpinnerSize.small,className:"sp-CreateAIBModelPanel-Spinner",ariaLive:"assertive",labelPosition:"right",label:h.default.LoadingText}))))};c._renderViewSetting=function(){return r.createElement("div",{className:"sp-CreateAIBModelPanel-ViewContainer"},r.createElement(a.Stack,{gap:10},c._renderViewSettingHeader(),r.createElement(f.Checkbox,{ariaLabel:h.default.LibraryViewSetDefaultToggleText,defaultChecked:!0,label:h.default.LibraryViewSetDefaultToggleText,onChange:c.onCheckboxChange})))};c._renderViewSettingHeader=function(){return r.createElement(u.Label,null,r.createElement(a.Stack,{horizontal:!0,verticalAlign:"center"},r.createElement("span",null,h.default.LibraryViewCreateDiscrptionText," ")))};c._renderRetentionLabel=function(){return C||!T.isFeatureEnabled(T.FormProcessingModelRetentionLabelSupport)?null:c.state.showAdvancedSettings&&c.state.loadingRetentionLabelCompleted&&c.state.retentionLabelDropdownOptions.length&&c.state.retentionLabelDropdownOptions.filter(function(e){return!!e.id}).length?r.createElement("div",{className:"sp-CreateAIBModelPanel-RetentionLabel"},c._renderRetentionLabelHeader(),c._renderRetentionLabelView()):c.state.loadingRetentionLabelCompleted?void 0:r.createElement(a.Stack.Item,null,r.createElement(s.Spinner,{size:s.SpinnerSize.small,className:"sp-CreateAIBModelPanel-Spinner",ariaLive:"assertive",labelPosition:"right",label:h.default.LoadingText}))};c._renderRetentionLabelHeader=function(){return r.createElement(u.Label,null,r.createElement(a.Stack,{horizontal:!0,verticalAlign:"center"},r.createElement("span",null,h.default.RetentionLabelText," ")))};c._renderRetentionLabelView=function(){var e=c.state,t=e.retentionLabelDropdownOptions,n=e.retentionLabelErrorMessage,i=e.isCreating,s=e.loadingRetentionLabelCompleted;return r.createElement(a.Stack,{tokens:{childrenGap:10}},r.createElement(l.Text,null,h.default.RetentionLabelDescriptionText),r.createElement(o.Dropdown,{onChange:c._onRetentionLabelDropDownChange,defaultSelectedKey:"",placeholder:h.default.RetentionLabelPlaceholderText,options:t,errorMessage:n,disabled:i||!s,onRenderOption:c._onRenderOption}))};c._onRetentionLabelDropDownChange=function(e,t,n){c.setState({selectedRetentionLabel:t})};c._onRenderOption=function(e,t){var n,i=t(e);e&&e.data&&e.data.description&&(n=r.createElement("span",{className:"sp-CreateAIBModelPanel-retentionLabelDescription"},e.data.description));return n?r.createElement("div",{key:e.key},i,n):i};c.onTextFieldChange=function(e,t){c.setState({contentTypeName:t||"",contentTypeErrorMessage:""});c.props.getRequiredFieldSatisfied(""!==t)};c.onChoiceGroupSelectedChange=function(e,t){c.setState({contentTypeOperationSelected:t.key,contentTypeSelected:t.key===L?{key:"",value:""}:c.state.contentTypeSelected,contentTypeErrorMessage:""})};c.onDropdownSelectionChange=function(){return function(e,t,n,r){var i=t&&t.key||"",s=t&&t.text||r;c.setState({contentTypeSelected:{key:i,value:s},contentTypeName:s,contentTypeErrorMessage:""});c.props.getRequiredFieldSatisfied(!!s)}};c.onCheckboxChange=function(e,t){c.setState({isSetDefaultViewRequired:t})};c.onCreateClick=function(){return n.__awaiter(c,void 0,void 0,function(){var e,t,r,i,s,o,u,a,f,l,c,v,m,g,y,b,w,E,S,x,N,M,_,D,P,H,B,j,F,I,q,R,U;return n.__generator(this,function(n){switch(n.label){case 0:e=this.state,t=e.contentTypeOperationSelected,r=e.contentTypeSelected,i=e.isSetDefaultViewRequired,s=e.contentTypeName,o=e.selectedRetentionLabel;u=this.props.createModelContext,a=u.webAbsoluteUrl,f=u.listId,l=u.listFullUrl,c=u.aiBuilderEnvironmentConfig;v=r.key;m=r.value;this.setState({isCreating:!0});if(t===L&&!m){this.setState({isCreating:!1,contentTypeErrorMessage:h.default.ContentTypeNameInvalidText});return[2,!1]}if(t!==k)return[3,4];if(!s){this.setState({isCreating:!1,contentTypeErrorMessage:h.default.ContentTypeNameInvalidText});return[2,!1]}n.label=1;case 1:n.trys.push([1,3,,4]);g={name:s,group:A,discription:"",id:""};return[4,this._contentTypeDataSource.createSiteContentType(a,g,O)];case 2:y=n.sent();v=y.id;m=y.name;return[3,4];case 3:b=n.sent();_=null===(I=null==b?void 0:b.message)||void 0===I?void 0:I.value;"183, Microsoft.SharePoint.SPException"===(null==b?void 0:b.code)&&(_=h.default.ContentTypeNameAlreadyUsed);this.setState({isCreating:!1,contentTypeErrorMessage:_});p.default.log("[CreateModelPanelContent] create content type api call failed: "+(null===(q=null==b?void 0:b.message)||void 0===q?void 0:q.value));return[2,!1];case 4:w="";n.label=5;case 5:n.trys.push([5,12,,13]);return[4,this._viewDataSource.getViews(a,f)];case 6:E=n.sent();S=E.filter(function(e){return e.title===m});x=S.filter(function(e){return!e.isHidden});return 0!==S.length?[3,8]:[4,this._viewDataSource.createView(a,f,m)];case 7:N=n.sent();w=N.id;return[3,11];case 8:if(!(x.length>0))return[3,9];w=x[0].id;return[3,11];case 9:return[4,this._viewDataSource.createView(a,f,m)];case 10:N=n.sent();w=N.id;n.label=11;case 11:return[3,13];case 12:M=n.sent();_=null===(R=null==M?void 0:M.message)||void 0===R?void 0:R.value;this.setState({isCreating:!1,contentTypeErrorMessage:_});p.default.log("[CreateModelPanelContent] create view api call failed: "+(null===(U=null==M?void 0:M.message)||void 0===U?void 0:U.value));return[2,!1];case 13:D=d.getCreateAIBuilderModelRunTimeHost();P=d.isPowerAppsTestEnvSupportedKillSwitchActivated?d.getAIBuilderRunTimeHost():D.hostName;H=!C&&T.isFeatureEnabled(T.FormProcessingModelRetentionLabelSupport)?!d.isPowerAppsTestEnvSupportedKillSwitchActivated&&D.isTest?{contentTypeId:v,setViewAsDefault:i,retentionLabel:(null==o?void 0:o.id)||"",modelInTestEnv:!0}:{contentTypeId:v,setViewAsDefault:i,retentionLabel:(null==o?void 0:o.id)||""}:!d.isPowerAppsTestEnvSupportedKillSwitchActivated&&D.isTest?{contentTypeId:v,setViewAsDefault:i,modelInTestEnv:!0}:{contentTypeId:v,setViewAsDefault:i};B=("modelNameSeed="+encodeURIComponent(m)).concat("&templateName=SharePointFormProcessing","&context.sharepoint.site="+encodeURIComponent(a),"&context.sharepoint.list="+encodeURIComponent(f),"&context.sharepoint.listfullurl="+encodeURIComponent(l),"&context.sharepoint.view="+encodeURIComponent(w),"&context.sharepoint.context="+encodeURIComponent(JSON.stringify(H)));j="https://"+P+"/aibuilder/createModel?"+B;if(!d.isPowerAppsTestEnvSupportedKillSwitchActivated){F=d.parseAIBuilderEnvironmentConfig(c);D.isTest||!F.envName||void 0===F.isDefault||F.isDefault?D.isTest&&F.testEnvName&&void 0!==F.isTestEnvDefault&&!F.isTestEnvDefault&&(j="https://"+P+"/e/"+F.testEnvName+"/aibuilder/createModel?"+B):j="https://"+P+"/e/"+F.envName+"/aibuilder/createModel?"+B}window.open(""+j,"_blank");this.setState({isCreating:!1});return[2,!0]}})})};c.state={contentTypeOperationSelected:k,contentTypeErrorMessage:"",contentTypeOptions:[],contentTypeSelected:{key:"",value:""},loadingContentTypeCompleted:!1,isCreating:!1,isSetDefaultViewRequired:!0,contentTypeName:"",showAdvancedSettings:!1,retentionLabelDropdownOptions:[],selectedRetentionLabel:void 0,retentionLabelErrorMessage:"",loadingRetentionLabelCompleted:!1};c._contentTypeDataSource=c.props.resources.consume(v.resourceKey);c._viewDataSource=c.props.resources.consume(m.resourceKey);c._engagement=c.props.resources.consume(w.resourceKey);c._complianceTagProvider=c.props.resources.consume(x.resourceKey.optional);c._modelNameTextFieldRef=r.createRef();return c}t.prototype.onCreate=function(){return this.onCreateClick()};t.prototype.componentDidMount=function(){var e=this,t=this.props.createModelContext.webAbsoluteUrl;this._contentTypeDataSource.getSiteDocumentDescendantContentTypes(t,!1,!1).then(function(t){var n=e.getContentTypeOptions(t);e.setState({contentTypeOptions:n,loadingContentTypeCompleted:!0});e._modelNameTextFieldRef&&e._modelNameTextFieldRef.current&&e._modelNameTextFieldRef.current.focus()}).catch(function(t){var n;e.setState({loadingContentTypeCompleted:!0});p.default.log("[CreateModelPanelContent] fetching content types failed "+(null===(n=null==t?void 0:t.message)||void 0===n?void 0:n.value))});if(!C&&T.isFeatureEnabled(T.FormProcessingModelRetentionLabelSupport)&&this._complianceTagProvider){var n=[];this._complianceTagProvider.getAvailableTagsForSite().then(function(t){t&&t.length>0&&t.forEach(function(e){n.push({id:e.tagId,key:e.tagId,text:e.tagName,title:e.tagTooltip,data:{description:e.tagDescription}})});e.setState({retentionLabelDropdownOptions:n,loadingRetentionLabelCompleted:!0})}).catch(function(t){var n,r="";if(t&&t.message&&t.message.value){r=t.message.value;var i=null===(n=e.props.resources.consume(N.pageContext))||void 0===n?void 0:n.CorrelationId;r=r+" correlationId: "+(t.correlationId||i||"")}else r=JSON.stringify(t);e.setState({retentionLabelErrorMessage:h.default.RetentionLabelWarningText,retentionLabelDropdownOptions:[],loadingRetentionLabelCompleted:!0});p.default.log("[CreateModelPanelContent] fetching retention labels failed "+r)})}else this.setState({loadingRetentionLabelCompleted:!0})};t.prototype.render=function(){var e=this.state,t=e.contentTypeOperationSelected,n=e.contentTypeName,i=e.contentTypeErrorMessage,o=e.isCreating;return r.createElement(r.Fragment,null,r.createElement(a.Stack,{gap:15},r.createElement(a.Stack.Item,{styles:{root:{marginTop:"15px"}}},r.createElement(l.Text,null,h.default.CreateModelInstructionText+" "),r.createElement(E.Link,{href:"https://go.microsoft.com/fwlink/?linkid=2128020",target:"_blank"},""+h.default.LearnMoreLinkText)),r.createElement(a.Stack.Item,{styles:{root:{marginBottom:"25px"}}},r.createElement(c.TextField,{componentRef:this._modelNameTextFieldRef,ariaLabel:h.default.ModelNameInputAriaLabel,errorMessage:t===L?"":i,value:n,disabled:t===L,label:h.default.ModelInputTextFieldLabel,onChange:this.onTextFieldChange,required:!0})),r.createElement(a.Stack.Item,{className:"sp-CreateAIBModelPanel-AdvancedSettingsContainer"},this._renderAdvancedSettings()),r.createElement(a.Stack.Item,null,o&&r.createElement(s.Spinner,{size:s.SpinnerSize.small,ariaLive:"assertive",labelPosition:"right",label:""}))))};t.prototype.getContentTypeOptions=function(e){var t=[],n=new Map;e.forEach(function(e){n.has(e.group)||n.set(e.group,[]);n.get(e.group).push(e)});n.forEach(function(e,n){t.push({key:n,text:n,itemType:o.DropdownMenuItemType.Header});e.sort(function(e,t){return e.name.toUpperCase()>t.name.toUpperCase()?1:-1});(t=t.concat(e.map(function(e){return{key:e.id,text:e.name}}))).push({key:"divider_"+n,text:"-",itemType:o.DropdownMenuItemType.Divider})});return t};return t})(r.Component);t.CreateModelPanelContent=M});
define("C$e",["require","exports","ww","r","MA","dce","w$e","qJe","Zm","g","P6","KH","H6","H6","Kb","FS","nre","ou","OL","ZSe","U$e","fe","Je","fB","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewModelPanelContent=void 0;var T=S.default.isActivated("79e43cb8-7838-4e5b-8523-f2d554f5ca18","11/24/2020","Show rentention label setting in model detail panel"),N=(function(e){n.__extends(t,e);function t(t){var a=e.call(this,t)||this;a._aiBuilderHost=u.getAIBuilderRunTimeHost();a.onUpdate=function(){return n.__awaiter(a,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this._onUpdate()]})})};a._renderRetentionLabel=function(){return T||!x.isFeatureEnabled(x.FormProcessingModelRetentionLabelSupport)?null:a.state.loadingRetentionLabelCompleted&&a.state.retentionLabelDropdownOptions.length&&a.state.retentionLabelDropdownOptions.filter(function(e){return!!e.id}).length?r.createElement("div",{className:"sp-ViewAIBModelPanel-RetentionLabel"},a._renderRetentionLabelHeader(),a._renderRetentionLabelView()):a.state.loadingRetentionLabelCompleted?void 0:r.createElement(s.Stack.Item,null,r.createElement(g.Spinner,{size:g.SpinnerSize.small,className:"sp-ViewAIBModelPanel-Spinner",ariaLive:"assertive",labelPosition:"right",label:o.default.LoadingText}))};a._renderRetentionLabelHeader=function(){return r.createElement(i.Label,null,r.createElement(s.Stack,{horizontal:!0,verticalAlign:"center"},r.createElement("span",null,o.default.RetentionLabelText," ")))};a._renderRetentionLabelView=function(){var e=a.state,t=e.retentionLabelDropdownOptions,n=e.selectedRetentionLabel,i=e.updateRetentionLabelErrorMessage,u=e.isUpdating,f=e.loadingRetentionLabelCompleted;a.props.retentionLabelRendered(!0);return r.createElement(s.Stack,{tokens:{childrenGap:10}},r.createElement(y.Text,null,o.default.RetentionLabelDescriptionText),r.createElement(m.Dropdown,{onChange:a._onRetentionLabelDropDownChange,defaultSelectedKey:null==n?void 0:n.key,placeholder:"",options:t,errorMessage:i,disabled:u||!f,onRenderOption:a._onRenderOption}))};a._onRetentionLabelDropDownChange=function(e,t,n){var r;if(t){a.setState({selectedRetentionLabel:t});a.props.getRequiredFieldSatisfied((null===(r=a.state.originalRetentionLabel)||void 0===r?void 0:r.id)!==t.id)}};a._onRenderOption=function(e,t){var n,i=t(e);e&&e.data&&e.data.description&&(n=r.createElement("span",{className:"sp-ViewAIBModelPanel-retentionLabelDescription"},e.data.description));return n?r.createElement("div",{key:e.key},i,n):i};a._onUpdate=function(){return n.__awaiter(a,void 0,void 0,function(){var e,t,r,i,s=this;return n.__generator(this,function(n){this.setState({isUpdating:!0});e=this.state.selectedRetentionLabel;t=this.props.viewModelContext,r=t.webAbsoluteUrl,i=t.listId;return[2,this._listAIModelDataSource.updateFormProcessingModelRetentionLabel(r,i,null==e?void 0:e.id).then(function(){s.setState({isUpdating:!1,updateRetentionLabelErrorMessage:""});return!0}).catch(function(e){var t="";if(e&&e.message&&e.message.value){t=(t=e.message.value)+" correlationId: "+(e.correlationId||s._pageContext.CorrelationId||"")}else t=JSON.stringify(e);s.setState({isUpdating:!1,updateRetentionLabelErrorMessage:t||"Please try again later. CorrelationId: "+s._pageContext.CorrelationId});E.default.log("[ViewModelPanelContent] updateFormProcessingModelRetentionLabel api call failed: "+t);return!1})]})})};a.state={originalRetentionLabel:void 0,retentionLabelDropdownOptions:[],selectedRetentionLabel:void 0,loadRetentionLabelErrorMessage:"",loadingRetentionLabelCompleted:!1,updateRetentionLabelErrorMessage:"",isUpdating:!1};a._pageContext=a.props.resources.consume(f.pageContext);a._complianceTagProvider=a.props.resources.consume(b.resourceKey.optional);a._listAIModelDataSource=a.props.resources.consume(w.resourceKey);return a}t.prototype.componentDidMount=function(){var e=this;if(!T&&x.isFeatureEnabled(x.FormProcessingModelRetentionLabelSupport)&&this._complianceTagProvider){var t=[];this._complianceTagProvider.getAvailableTagsForSite().then(function(n){var r;n&&n.length>0&&n.forEach(function(e){t.push({id:e.tagId,key:e.tagId,text:e.tagName,title:e.tagTooltip,data:{description:e.tagDescription}})});var i=null===(r=e.props.viewModelContext.model)||void 0===r?void 0:r.retentionLabel,s=t.find(function(e){return!e.id&&!i||!!e.id&&!!i&&0===e.id.toUpperCase().localeCompare(i.toUpperCase())});e.setState({retentionLabelDropdownOptions:t,originalRetentionLabel:s,selectedRetentionLabel:s,loadingRetentionLabelCompleted:!0,loadRetentionLabelErrorMessage:""})}).catch(function(t){var n="";if(t&&t.message&&t.message.value){n=(n=t.message.value)+" correlationId: "+(t.correlationId||e._pageContext.CorrelationId||"")}else n=JSON.stringify(t);e.setState({retentionLabelDropdownOptions:[],selectedRetentionLabel:void 0,loadingRetentionLabelCompleted:!0,loadRetentionLabelErrorMessage:n});E.default.log("[ViewModelPanelContent] getAvailableTagsForSite api call failed: "+n)})}else this.setState({loadingRetentionLabelCompleted:!0})};t.prototype.render=function(){var e,t=this.props.viewModelContext,n=t.people?{name:t.people.displayName,email:t.people.email,title:t.people.title,imageUrl:"/_layouts/15/userphoto.aspx?accountname="+encodeURIComponent(t.people.accountName)+"&size=S"}:void 0,f=null===(e=t.contentType)||void 0===e?void 0:e.name,l=t.model,c=l.id,h=l.environment,p=l.modifiedTimestamp&&parseInt(l.modifiedTimestamp,10)||void 0,d=l.state,m=u.isPowerAppsTestEnvSupportedKillSwitchActivated?this._aiBuilderHost:u.getViewAIBuilderModelRunTimeHost(l.modelInTestEnv).hostName,g=p?new Date(p):void 0,y=g?v.getRelativeDateTimeStringPast(g):void 0,b=t.people?this._getUserUpn(t.people):void 0,E=this._pageContext.userPrincipalName,S=!(!b||!E)&&0===b.toUpperCase().localeCompare(E.toUpperCase());return r.createElement(s.Stack,{gap:25},r.createElement("div",null,r.createElement("span",null," ",o.default.ModelPublishedText)),!!h&&S&&r.createElement("div",null,r.createElement(a.PrimaryButton,{ariaDescription:o.default.ManageModelLinkText,href:"https://"+m+"/environment/"+h+"/aibuilder/models/"+c,target:"_about"},o.default.ManageModelLinkText)),f&&r.createElement("div",null,r.createElement(i.Label,null,o.default.ModelLabelText),r.createElement("div",null,r.createElement("span",null,f))),(d===w.ModelState.Online||d===w.ModelState.Offline)&&r.createElement("div",null,r.createElement(i.Label,null,o.default.StatusLabelText),r.createElement("div",null,r.createElement("span",null,d===w.ModelState.Online?o.default.ModelPublishedStatusText:o.default.ModelUnpublishedStatusText)),y&&r.createElement("div",null,r.createElement("span",{className:"item-timeStamp"},y))),n&&r.createElement("div",null,r.createElement(i.Label,null,o.default.ModelOwnerLabelText),r.createElement("div",null,this._getPersonaControl(n))),this._renderRetentionLabel())};t.prototype._makeDeferredLpcProps=function(e){var t=this.props.resources.consume(d.resourceKey),n=p.waitForPageLoadWithTimeout(t);return{personaType:"User",identifier:e&&e.email,pageContext:this._pageContext,moduleLoader:h.getReactDeferredComponentModuleLoader(),customWaiter:n,addGroupMembersCallback:void 0,lpcHoverTargetProps:{upn:e&&e.email,hostAppPersonaInfo:{PersonaDisplayName:e&&e.name}}}};t.prototype._wrapPersona=function(e){var t=this;return function(n,i){var s=t._makeDeferredLpcProps(e);return l.wrapWithDeferredSpLivePersonaCard(s,r.createElement("div",null,i(n)))}};t.prototype._getPersonaControl=function(e){return r.createElement(c.Persona,{imageUrl:e.imageUrl,primaryText:e.name,secondaryText:e.title,size:c.PersonaSize.small,hidePersonaDetails:!1,onRenderCoin:this._wrapPersona(e),onRenderPrimaryText:this._wrapPersona(e),"data-automationid":"ModelPersona"})};t.prototype._getUserUpn=function(e){return e.accountName?e.accountName.slice(e.accountName.lastIndexOf("|")+1):e.email};return t})(r.Component);t.ViewModelPanelContent=N});
define("uYe",["require","exports","ww","r","Wv","Bz","mw"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withKnockoutStoreItems=t.withKnockoutStoreItem=void 0;t.withKnockoutStoreItem=function(e){return function(t){var u=t;return i.connectToItemCache(function(e,t){return{storeItem:e.demandItemFacet(o.knockoutStoreItemFacet,t.itemKey)}})(function(t){var i=t.storeItem,o=s.useObservableValue(i),a=s.useObservable(o);return r.createElement(u,n.__assign({},t,e(a,t)))})}};t.withKnockoutStoreItems=function(){return function(e){var t=e;return i.connectToItemCache(function(e,t){return{items:t.itemKeys.map(function(t){return e.demandItemFacet(o.knockoutStoreItemFacet,t)})}})(t)}}});
define("tJe",["require","exports","tq","B5e","kte","fB","Qi","Gi","JP","cc","bw","Nq","Rq","CQ","gQ","OQ","fe","Nie"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.requestColumnsEditorPanel=void 0;t.requestColumnsEditorPanel=function(e){var t=e.consume(n.resourceKey),y=e.consume(i.itemsScopeCurrentDerivedViewUpdatorResourceKey),b=e.consume(d.resourceKey),w=e.consume(g.crossWindowClientKey.optional),E=t.requestPanel({hasCommandBar:!0,component:{name:r.default.tagName,params:{onComplete:function(t){var n=!1;y(function(e){n=e.isDirty();e.replaceFields(t);return e});var r=e.consume(h.isItemsScopeEnabledResourceKey);s.isFeatureEnabled(s.ColumnFieldsAutoSave)&&r&&e.consumeAsync(l.resourceKey).then(function(t){e.consumeAsync(c.resourceKey).then(function(e){var r,i,s=t.dispatch(f.readItems(function(t){var n=t.demandItemFacet(o.spFolderItemSetKeyFacet,e.peek());return{setKey:n,viewKey:n&&n.viewKey&&o.spViewKeyFacet.serialize(n.viewKey)}}));if(s.setKey&&s.viewKey){if(t.dispatch(f.readItems(function(e){var t=e.demandItemFacet(u.listFacet,o.spListKeyFacet.serialize({webAbsoluteUrl:s.setKey.webAbsoluteUrl,listFullUrl:s.setKey.listFullUrl}));return!!(t&&t.permissions&&t.permissions.manageLists)}))){var l=b.register({name:"",type:p.default.editViewColumns,payloads:{}});l.state(v.default.started);t.dispatch(a.saveViewCore({items:(r={},r[o.spListViewsSetKeyFacet.serialize(s.setKey)]={views:(i={},i[s.viewKey]={shouldSaveViewFieldsOnly:!0},i),qosName:"autoSaveShowHide"},r)})).then(function(){!1===n&&y(function(e){e.baseViewXml=e.getEffectiveViewXml();return e});null==w||w.sendCommand({command:"columnsEditorChanged",payload:""});E.state(1);l.state(v.default.completed)},function(e){m.default.logError(e,{eventName:"ShowHideAutoSave",feature:"ColumnFieldsAutoSave",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});y(function(e){e.setIsDirty(!0);return e});l.state(v.default.failed);null==w||w.sendCommand({command:"onColumnsEditorError",payload:""});throw e})}}})});w||E.state(1)}}}});return E.wait().then(function(){null==w||w.sendCommand({command:"columnsEditorClosed",payload:""})})}});
define("Aet",["require","exports","ww","r","r","Zm","zSe","T2","U1"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemScopeCoachmarkCommand=void 0;var f=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._target=i.createRef();t._onMenuClicked=function(e,n){var r=t.props,i=r.hideCoachmark,s=r.onMenuClick;s&&s(e,n);i&&i()};t._onClick=function(e,n){var r,i=t.props,s=i.hideCoachmark,o=i.onClick;o&&(r=o(e,n));s&&s();return r};t._getCoachmark=function(){var e=t.props,n=e.isCoachmarkVisible,i=e.teachingBubbleCampaign,s=e.onCoachmarkAnimationOpen,u=e.onDismissTeachingBubble;if(n)return r.createElement(o.ItemScopeTeachingBubbleCoachmarkContainer,{target:t._target.current,teachingBubbleCampaign:i,onDismiss:u,onAnimationOpenStart:s,onTeachingBubbleSeen:t._onTeachingBubbleSeen})};t._onTeachingBubbleSeen=function(){var e=t.props.resources.consume(u.teachingBubble.optional);e&&e.markBubbleAsSeen(t.props.teachingBubbleCampaign);var n=t.props.onTeachingBubbleSeen;n&&n()};return t}t.prototype.render=function(){var e=this.props,t=e.defaultRender,i=void 0===t?s.CommandBarButton:t,o=n.__rest(e,["defaultRender"]),u=i;return r.createElement(r.Fragment,null,r.createElement("div",{ref:this._target},r.createElement(u,n.__assign({},o,{onClick:this._onClick,onMenuClick:this._onMenuClicked}))),this._getCoachmark())};return t})(r.PureComponent);t.ItemScopeCoachmarkCommand=a.withResources()(f)});
define("wet",["require","exports","ww","r","I","tB","T2","Fie","Aet","U1","gQ","bv","iZ","Wv","Eet"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createCoachmarkCommand=t.CoachmarkCommand=void 0;var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._hideCoachmark=function(){var e=n.state.teachingBubble;e&&n._observables.wrap(e.isVisible)(!1)};n._onDismissTeachingBubble=function(){var e=n.state.teachingBubble;if(e){n._hideCoachmark();n._isReminderFlowCoachmark&&c.Engagement.logData({name:"ReminderFlowCoachmark.Close"});n._teachingBubbleProvider.markBubbleAsDismissed(e.campaign())}};n._getCurrentTeachingBubble=function(){return n._observables.unwrap(n._coachmarkProvider.getCurrentTeachingBubble())};n._hideToastNotifications=function(){var e=n.props.resources.consume(l.resourceKey.optional);e&&e.cleanup(!0)};n._onTeachingBubbleSeen=function(){n._isReminderFlowCoachmark()&&c.Engagement.logData({name:"ReminderFlowCoachmark.Rendered"})};n._isReminderFlowCoachmark=function(){var e=n.state.teachingBubble;if(!e)return!1;var t=e.campaign();return t&&t.campaignGuid===h.FLOW_REMIND_ME.campaignGuid};var r=t.resources;n._scope=new i.default;n._coachmarkProvider=r.consume(u.resourceKey.optional);n._observables=n._scope.attach(new(r.consume(s.observablesFactoryTypeResourceKey))({owner:n}));n.state={isCoachmarkVisible:!1,teachingBubble:n._getCurrentTeachingBubble()};return n}t.prototype.render=function(){var e=this.state,t=e.isCoachmarkVisible,i=e.teachingBubble;return r.createElement(a.ItemScopeCoachmarkCommand,n.__assign({isCoachmarkVisible:t,teachingBubbleCampaign:i&&i.campaign(),hideCoachmark:this._hideCoachmark,onCoachmarkAnimationOpen:this._hideToastNotifications,onDismissTeachingBubble:this._onDismissTeachingBubble,onTeachingBubbleSeen:this._onTeachingBubbleSeen},this.props))};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.componentDidMount=function(){var e=this;this._observables.compute(function(){e._computeShowCoachmark()})};t.prototype._computeShowCoachmark=function(){var e=this,t=this._getCurrentTeachingBubble();if(t){var n=this._observables.unwrap(t.isVisible),r=t.campaign(),i=this.state.isCoachmarkVisible;if(this._isCampaignCompatible(r)){this._teachingBubbleProvider||(this._teachingBubbleProvider=this.props.resources.consume(o.teachingBubble.optional));this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(r,!1).then(function(r){e.setState({isCoachmarkVisible:r&&n,teachingBubble:t})})}else i&&this.setState({isCoachmarkVisible:!1})}};t.prototype._isCampaignCompatible=function(e){var t=this.props.coachmarkCampaign;return t===e||t===(e&&e.compatibleCampaign)};return t})(r.Component);t.CoachmarkCommand=f.withResources()(v);t.createCoachmarkCommand=function(e,i){var s=(function(i){n.__extends(s,i);function s(){var t=null!==i&&i.apply(this,arguments)||this;t._update=function(n,r){if(n.doesCoachmarkApply!==r.doesCoachmarkApply){var i=t.props.coachmarkProvider;n.doesCoachmarkApply?i.isVisible.peek()||i.setCampaign(e):i.isVisible.peek()&&e===i.currentCampaign.peek()&&i.hideCampaign()}};return t}s.prototype.componentDidMount=function(){this._update(this.props,{doesCoachmarkApply:!1})};s.prototype.render=function(){return r.createElement(t.CoachmarkCommand,n.__assign({},this.props))};s.prototype.componentDidUpdate=function(e){this._update(this.props,e)};return s})(r.PureComponent);return p.connectToItemCache(function(e){return{doesCoachmarkApply:i(e,{})}})(d.withCoachmarkProvider(e)(s))}});
define("GJe",["require","exports","r","qi","Ng","KJe","ov"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.aibuilderCommand=void 0;var u={key:new r.Facet("CreateAIBuilderModel").id,name:o.default.CreateAIBuilderModel,action:n.createElement(i.HideWithSelection,null,n.createElement(s.CreateAIBuilderModelAction,null))},a={key:new r.Facet("ViewAIBuilderModelDetails").id,name:o.default.ViewAIBuilderModelDetails,action:n.createElement(i.HideWithSelection,null,n.createElement(s.ViewAIBuilderModelDetailsAction,null))},f={key:new r.Facet("GotoAIBuilder").id,name:o.default.GotoAIBuilder,action:n.createElement(i.HideWithSelection,null,n.createElement(s.ViewAIBuilderModelsAction,null))};t.aibuilderCommand={key:new r.Facet("AIBuilder").id,name:o.default.AIBuilderCommandLabel,iconProps:{iconName:"HomeGroup"},subMenuProps:{items:[u,a,f]}}});
define("FXe",["require","exports","r","qi","od","Ng","HXe","mz"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveCommand=void 0;t.addToOneDriveCommand={key:new r.Facet("AddToOneDrive").id,name:u.default.CreateMountPoint,action:n.createElement(s.ShowOnlyWithSelection,null,n.createElement(o.AddToOneDriveAction,null)),iconProps:{iconType:i.IconType.Image,imageProps:{src:window.require.toUrl("odsp-media/images/addtoonedrive/a2od.svg"),width:"16px",height:"16px"}}}});
define("bZe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToQuickLaunchCommandKey=void 0;t.addToQuickLaunchCommandKey=n.getNextId("addToQuickLaunch")});
define("hZe",["require","exports","ww","r","qi","_Ze","ov","EXe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.alertMeCommand=void 0;t.alertMeCommand={key:new i.Facet("AlertMe").id,name:o.default.Alert,action:r.createElement(s.AlertMeAction,null),iconProps:{iconName:"Ringer"},automationId:"alertMe",facets:n.__assign({},u.isClassicSharePointCommandFacet.pack(!0))}});
define("MXe",["require","exports","r","qi","PXe","mz"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelEditCommand=void 0;t.cancelEditCommand={key:new r.Facet("CancelEdit").id,name:s.default.cancelEdit,action:n.createElement(i.LaunchCancelEditAtion,null),iconProps:{iconName:"CheckMark"}}});
define("xXe",["require","exports","r","qi","xZe","mz"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelPublishCommand=void 0;t.cancelPublishCommand={key:new r.Facet("CancelApproval").id,name:s.default.CancelApproval,action:n.createElement(i.CancelApprovalAction,null)}});
define("iZe",["require","exports","r","qi","rZe","mz"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.captureVersionCommand=void 0;t.captureVersionCommand={key:new r.Facet("CaptureVersion").id,name:s.default.CaptureVersion,action:n.createElement(i.CaptureVersionAction,null),iconProps:{iconName:"StackIndicator"}}});
define("wXe",["require","exports","ww","r","qi","xZe","mz","EXe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.complianceDetailsCommand=void 0;t.complianceDetailsCommand={key:new i.Facet("ComplianceDetails").id,name:o.default.ComplianceDetails,action:r.createElement(s.ComplianceDetailsAction,null),automationId:"complianceDetails",facets:n.__assign({},u.isClassicSharePointCommandFacet.pack(!0))}});
define("Bet",["require","exports","r","Vet","ov","jet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.contentCenterCreateModelCommand=void 0;t.contentCenterCreateModelCommand={key:s.contentCenterCreateModelCommandKey,name:i.default.CreateModel,action:n.createElement(r.LaunchCreateModelPanelAction,null),iconProps:{iconName:"Add"}}});
define("jet",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.contentCenterCreateModelCommandKey=void 0;t.contentCenterCreateModelCommandKey=n.getNextId("contentCenterCreateModel")});
define("YXe",["require","exports","r","qi","Ng","aJe","mz"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.copyToCommand=void 0;t.copyToCommand={key:new r.Facet("CopyTo").id,name:o.default.Copy,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.LaunchMoveCopyPanelAction,{isMove:!1})),iconProps:{iconName:"Copy"}}});
define("SXe",["require","exports","ww","r","IXe","Ng","mz","DXe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createPersistentShortcutCommand=t.createShortcutCommand=void 0;t.createShortcutCommand={key:u.createShortcutCommandKey,name:o.default.CreateShortcut,action:r.createElement(s.HideWithSelection,null,r.createElement(i.CreateShortcutAction,null)),iconProps:{iconName:"Globe"}};t.createPersistentShortcutCommand=n.__assign(n.__assign({},t.createShortcutCommand),{action:r.createElement(i.CreatePersistentShortcutAction,null)})});
define("DXe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createShortcutCommandKey=void 0;t.createShortcutCommandKey=n.getNextId("createShortcut")});
define("aZe",["require","exports","ww","r","sJe","g1","f7"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsCommand=void 0;t.detailsCommand=n.__assign(n.__assign({},o.detailsCommandBaseWithoutAction),{action:r.createElement(s.WithKnockoutResourceScope,null,r.createElement(i.ToggleInfoPaneAction,null)),automationId:"detailsCommand"})});
define("f7",["require","exports","ww","r","ov","U1","m7","p7"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsCommandBaseWithoutAction=void 0;t.detailsCommandBaseWithoutAction={key:u.detailsCommandKey,automationId:"detailsPane",iconProps:{iconName:"Info"},title:i.default.DetailsPane,ariaLabel:i.default.DetailsPane,shortcutProps:{content:i.default.DetailsPane,keySequences:["I"]},commandBarButtonAs:function(e){var t=e.defaultRender,i=s.useResourceScope().consume(o.resourceKey),u=e.actionState,a=u&&u.isToggled;return t?r.createElement(t,n.__assign({},e,{"aria-controls":i,"aria-expanded":!!a})):null}}});
define("p7",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsCommandKey=void 0;t.detailsCommandKey=n.getNextId("detailsPane")});
define("tZe",["require","exports","r","nZe","mz","ov","p7"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsMenuCommand=void 0;t.detailsMenuCommand={key:o.detailsCommandKey,name:i.default.Details,ariaLabel:s.default.DetailsPane,action:n.createElement(r.ShowInfoPaneAction,null),automationId:"detailsMenuCommand"}});
define("vZe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.viewDocumentPropertyCommandKey=t.bulkEditDocumentPropertyCommandKey=t.commentItemCommandKey=t.viewItemCommandKey=t.editItemCommandKey=void 0;t.editItemCommandKey=n.getNextId("editItem");t.viewItemCommandKey=n.getNextId("viewItem");t.commentItemCommandKey=n.getNextId("commentItem");t.bulkEditDocumentPropertyCommandKey=n.getNextId("bulkEditDocumentProperty");t.viewDocumentPropertyCommandKey=n.getNextId("viewDocumentProperty")});
define("iXe",["require","exports","r","qi","rXe","mz"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileRequestCommand=void 0;t.fileRequestCommand={key:new r.Facet("FileRequest").id,name:s.default.CreateFileRequest,action:n.createElement(i.FileRequestAction,null),iconProps:{iconName:"FileRequest"}}});
define("XXe",["require","exports","ww","r","eZe","ZXe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filtersPaneCommand=void 0;t.filtersPaneCommand=n.__assign(n.__assign({},s.filtersPaneCommandBaseWithoutAction),{action:r.createElement(i.ToggleFiltersPaneAction,null)})});
define("ZXe",["require","exports","ww","r","ov","$Xe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filtersPaneCommandBaseWithoutAction=void 0;t.filtersPaneCommandBaseWithoutAction={key:s.filtersPaneCommandKey,automationId:"filtersPane",title:i.default.FiltersPane,ariaLabel:i.default.FiltersPane,iconProps:{iconName:"Filter"},commandBarButtonAs:function(e){var t=e.actionState&&e.actionState.isToggled,i=e.defaultRender;return i?r.createElement(i,n.__assign({},e,{"aria-expanded":!!t})):null}}});
define("$Xe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filtersPaneCommandKey=void 0;t.filtersPaneCommandKey=n.getNextId("filtersPane")});
define("set",["require","exports","r","mz","qi","cet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.focusFloodgateShortcutCommand=void 0;t.focusFloodgateShortcutCommand={key:new i.Facet("focusFloodgateShortcutCommand").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:r.default.FloodgateShortcutDescription},action:n.createElement(s.SetFocusAction,{elementId:"obf-TPromptContainer"})}});
define("Let",["require","exports","qi","ov","dZe","I7","jJe","ket","$s","Ow"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getIntegrateCommand=void 0;var l=new n.Facet("Integrate").id;t.getIntegrateCommand=function(e,t){if(!(a.getSelectedItemKeys(e).length>0)){var n=s.getPageContextFromItemCache(e,t),c=[i.powerAppsCommand];n&&c.push(o.getPowerAutomateCommand(n));if(f.isFeatureEnabled(f.PowerBIIntegration)){var h=u.getPowerBICommand(e,t);h&&c.push(h)}return{key:l,name:r.default.IntegrateCommandLabel,iconProps:{iconName:"AppIconDefault"},engagement:{name:"IntegrateMenu",isIntentional:!0},subMenuProps:{items:c}}}}});
define("zJe",["require","exports","zi","Ow","UO"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shouldDisplayIntegrateCommand=void 0;t.shouldDisplayIntegrateCommand=function(e){return r.isFeatureEnabled(r.IntegrateCommandOnLists)&&r.isFeatureEnabled(r.RulesPanel)&&e===n.ListTemplateType.genericList&&!i.isNucleusOfflineState()}});
define("gZe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.launchFormatViewPaneCommandKey=void 0;t.launchFormatViewPaneCommandKey=n.getNextId("launchFormatViewPane")});
define("nXe",["require","exports","r","Ng","mh","mz","aXe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAccessCommand=void 0;t.manageAccessCommand={key:o.manageAccessCommandKey,name:s.default.ManageAccess,action:n.createElement(r.ShowOnlyWithSelection,null,n.createElement(i.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"},automationId:"manageAccessCommand"}});
define("aXe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAccessCommandKey=void 0;t.manageAccessCommandKey=n.getNextId("manageAccess")});
define("mZe",["require","exports","ww","r","qi","_Ze","ov","EXe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAlertCommand=void 0;t.manageAlertCommand={key:new i.Facet("ManageAlert").id,name:o.default.ManageAlert,action:r.createElement(s.ManageAlertAction,null),iconProps:{iconName:"EditNote"},facets:n.__assign({},u.isClassicSharePointCommandFacet.pack(!0))}});
define("JXe",["require","exports","r","qi","Ng","aJe","mz"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveToCommand=void 0;t.moveToCommand={key:new r.Facet("MoveTo").id,name:o.default.Move,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.LaunchMoveCopyPanelAction,{isMove:!0})),iconProps:{iconName:"FabricMoveToFolder"}}});
define("pXe",["require","exports","r","qi","mXe","mz"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInExplorerCommand=void 0;var o={iconName:void 0,styles:{root:{display:"none!important"}}};t.openInExplorerCommand={key:new r.Facet("OpenInExplorer").id,name:s.default.OpenInExplorer,action:n.createElement(i.OpenInExplorerAction,null),iconProps:o}});
define("gXe",["require","exports","r","yXe","mz","vXe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInPowerBICommand=void 0;t.openInPowerBICommand={key:s.openInPowerBICommandKey,name:i.default.OpenInPowerBI,action:n.createElement(r.OpenInPowerBIAction,null),iconProps:{iconName:"PowerBILogo16"}}});
define("vXe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInPowerBICommandKey=void 0;t.openInPowerBICommandKey=n.getNextId("openInPowerBI")});
define("uXe",["require","exports","r","qi","fXe","ov"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInSharePointCommand=void 0;t.openInSharePointCommand={key:new r.Facet("OpenInSharePoint").id,name:s.default.OpenInSharePoint,action:n.createElement(i.OpenInSharePointAction,null),iconProps:{iconName:"SharepointLogo"}}});
define("_Xe",["require","exports","r","bXe","mz","g1","hXe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInTextEditorCommand=void 0;t.openInTextEditorCommand={key:o.openInTextEditorCommandKey,name:i.default.OpenInTextEditor,action:n.createElement(s.WithKnockoutResourceScope,null,n.createElement(r.OpenInTextEditorAction,null)),iconProps:{iconName:"Edit"}}});
define("hXe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInTextEditorCommandKey=void 0;t.openInTextEditorCommandKey=n.getNextId("openInTextEditor")});
define("Det",["require","exports","ww","r","$T","eU"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PersistentCreateNewListItemCommand=void 0;t.PersistentCreateNewListItemCommand=n.__assign(n.__assign({},i.createListItemCommand),{action:r.createElement(s.CreateListItemIgnoreSelectionAction,null)})});
define("dZe",["require","exports","r","qi","Ng","uZe","ov","Ow","lZe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.powerAppsCommand=void 0;var f={key:new r.Facet("CustomizeListForms").id,name:o.default.CustomizeListForms,engagement:{name:"LaunchCustomizePowerAppForm",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.CustomizeFormsNavigationAction,null))},l={key:new r.Facet("CreateAppView").id,name:o.default.CreateAppView,engagement:{name:"LaunchCreatePowerAppPanel",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.LaunchCreateAppViewPanelAction,null))},c={key:new r.Facet("SeeAllApps").id,name:o.default.SeeAllAppsLabel,engagement:{name:"LaunchSeeAllPowerApps",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.SeeAllAppsAction,null))};t.powerAppsCommand={key:a.powerAppsCommandKey,name:u.isFeatureEnabled(u.PowerAppsIncludeSpace)?o.default.AppViewsCommandLabel_WithSpace:o.default.AppViewsCommandLabel,iconProps:{iconName:"PowerApps2Logo"},engagement:{name:"PowerAppsMainMenu",isIntentional:!0},subMenuProps:{items:[l,c,f]}}});
define("lZe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.powerAppsCommandKey=void 0;t.powerAppsCommandKey=n.getNextId("powerApps")});
define("sZe",["require","exports","r","qi","Ng","cZe","ov"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.powerBICommand=void 0;t.powerBICommand={key:new r.Facet("PowerBI").id,name:o.default.PowerBICommandLabel,iconProps:{iconName:"PowerBILogo"},action:n.createElement(i.HideWithSelection,null,n.createElement(s.PowerBIAction,null))}});
define("LXe",["require","exports","r","rJe","mz","kXe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.previewCommand=void 0;t.previewCommand={key:s.previewCommandKey,name:i.default.Preview,automationId:"Preview",action:n.createElement(r.PreviewAction,null)}});
define("kXe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.previewCommandKey=void 0;t.previewCommandKey=n.getNextId("preview")});
define("OXe",["require","exports","r","qi","xZe","mz"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.publishCommand=void 0;t.publishCommand={key:new r.Facet("Publish").id,name:s.default.Publish,action:n.createElement(i.PublishAction,null)}});
define("TXe",["require","exports","r","qi","UXe","mz","Ng"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditCommand=void 0;t.quickEditCommand={key:new r.Facet("QuickEdit").id,name:s.default.EditAll,action:n.createElement(o.HideWithSelection,null,n.createElement(i.LaunchQuickEditAtion,null)),iconProps:{iconName:"Edit"}}});
define("Set",["require","exports","ww","$T","T0","Je","Ow","Iet","Det"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getQuickEditNewItemCommand=t.quickEditNewItemCommand=t.listLibraryNewButtonCleanupKS=void 0;t.listLibraryNewButtonCleanupKS=!s.default.isActivated("07130C81-2E5D-435B-AA30-AA32E0CF790F","9/11/2020","List Library New Button Color Change");t.quickEditNewItemCommand={key:i.newCommand.key,action:o.isFeatureEnabled(o.ListsPersistentNewCommand)?a.PersistentCreateNewListItemCommand.action:r.createListItemCommand.action,iconProps:i.newCommand.iconProps,name:i.newCommand.name};t.getQuickEditNewItemCommand=function(){return t.listLibraryNewButtonCleanupKS?n.__assign(n.__assign({},t.quickEditNewItemCommand),{commandBarButtonAs:u.PrimaryNewButton}):t.quickEditNewItemCommand}});
define("WXe",["require","exports","r","Ng","QXe","mz","qXe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.runModelCommand=void 0;t.runModelCommand={key:o.runModelCommandKey,name:s.default.RunModelText,title:s.default.RunModelToolTip,action:n.createElement(r.ShowOnlyWithSelection,null,n.createElement(i.RunModelAction,null)),iconProps:{iconName:"Play"}}});
define("qXe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.runModelCommandKey=void 0;t.runModelCommandKey=n.getNextId("runModel")});
define("dXe",["require","exports","ww","r","qi","lXe","mz","ot","fB"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.teamChannelCommand=void 0;t.teamChannelCommand={key:new i.Facet("TeamChannel").id,name:o.default.Channel,action:r.createElement(s.TeamChannelAction,null),iconProps:a.isFeatureEnabled(a.CommandBarBrandIcons)?n.__assign(n.__assign({},u.getBrandTypeIconProps({extension:"",brand:"teams",size:16})),{styles:{root:{width:"16px",height:"16px",selectors:{img:{width:"16px",height:"16px",display:"block"}}}}}):{iconName:"TeamsLogo"}}});
define("CXe",["require","exports","r","qi","xZe","mz"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.unPublishCommand=void 0;t.unPublishCommand={key:new r.Facet("UnPublish").id,name:s.default.UnPublish,action:n.createElement(i.UnPublishAction,null)}});
define("cXe",["require","exports","r","qi","Ng","sXe","mz"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFileCommand=void 0;t.uploadFileCommand={key:new r.Facet("UploadFile").id,automationId:"uploadFileCommand",name:o.default.UploadFile,action:n.createElement(i.HideWithSelection,null,n.createElement(s.UploadFileAction,null))}});
define("oXe",["require","exports","r","qi","Ng","sXe","mz"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFolderCommand=void 0;t.uploadFolderCommand={key:new r.Facet("UploadFolder").id,automationId:"uploadFolderCommand",name:o.default.UploadFolder,action:n.createElement(i.HideWithSelection,null,n.createElement(s.UploadFolderAction,null))}});
define("fZe",["require","exports","ww","r","qi","pZe","ov","EXe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.versionHistoryCommand=void 0;t.versionHistoryCommand={key:new i.Facet("VersionHistory").id,name:o.default.ShowVersionHistory,action:r.createElement(s.VersionHistoryAction,null),iconProps:{iconName:"StackIndicator"},facets:n.__assign({},u.isClassicSharePointCommandFacet.pack(!0))}});
define("AXe",["require","exports","ww","r","qi","xZe","mz","EXe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.workflowCommand=void 0;t.workflowCommand={key:new i.Facet("Workflow").id,name:o.default.Workflow,action:r.createElement(s.WorkflowAction,null),automationId:"workflow",facets:n.__assign({},u.isClassicSharePointCommandFacet.pack(!0))}});
define("RXe",["require","exports","ww","r","qi","ov","NXe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fullscreenCommand=void 0;t.fullscreenCommand={action:o.FullscreenAction,automationId:"expandCollapseList",key:new i.Facet("FullscreenMode").id,commandBarButtonAs:function(e){var t=e.defaultRender,i=e.actionState&&e.actionState.isToggled;return t?r.createElement(t,n.__assign({},e,{iconProps:{iconName:i?"BackToWindow":"FullScreen"},title:i?s.default.collapseContent:s.default.expandContent})):null}}});
define("hJe",["require","exports","ww","r","JR","_A","ou","nre","MA","bl","Zm","cN","dce","OL","oL","vJe","gJe","Oe","g","fe","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=["Document","Folder"],E="Intelligent Document Content Types",S=(function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s._renderAdvancedSettings=function(){var e=s.state.showAdvancedSettings;return r.createElement("div",null,s._renderAdvancedSettingsHeader(),e&&s._renderAdvancedSettingsContent())};s._toggleAdvancedSettings=function(){s.setState({showAdvancedSettings:!s.state.showAdvancedSettings})};s._renderAdvancedSettingsHeader=function(){var e=s.state.showAdvancedSettings;return r.createElement("div",{onClick:s._toggleAdvancedSettings,className:"advancedSettingsHeader"},r.createElement("div",{className:"advancedSettingsHeaderText"},v.default.AdvancedSettingsText),r.createElement(l.IconButton,{style:{fontSize:"13px",color:"black"},iconProps:{iconName:e?"ChevronUp":"ChevronDown"},title:v.default.AdvancedSettingsText,ariaLabel:v.default.AdvancedSettingsText}))};s._renderAdvancedSettingsContent=function(){return r.createElement("div",{className:"advancedSettingsExpandedMargin"},s._renderDescriptionText(),s._renderAssociatedContentTypeHeader(),s._renderChoiceGroup())};s._renderDescriptionText=function(){return r.createElement(p.Text,null," ",v.default.CreateModelInstructionText4)};s._renderAssociatedContentTypeHeader=function(){return r.createElement(a.Label,{styles:{root:{marginTop:"20px"}}},r.createElement(h.Stack,{horizontal:!0,verticalAlign:"center"},r.createElement("span",null,v.default.ContentTypeHeader," ")))};s._renderChoiceGroup=function(){var e=[{key:"create",text:v.default.createContentType,ariaLabel:v.default.createContentType},{key:"select",text:v.default.selectContentType,ariaLabel:v.default.selectContentType}];return r.createElement(i.ChoiceGroup,{options:e,onChange:s.onChoiceGroupSelectedChange,selectedKey:s.state.contentTypeSelected})};s.onMessageBarDismiss=function(){s.setState({isMessageBarHidden:!0})};s.onTextFieldChange=function(e,t){s.setState({modelName:t||"",classifierErrorMessage:"",isMessageBarHidden:!0})};s.onChoiceGroupSelectedChange=function(e,t){s.setState({contentTypeSelected:t.key,classifierSelected:"select"===t.key?{key:"",value:""}:s.state.classifierSelected,classifierErrorMessage:"",isMessageBarHidden:!0})};s.onDropdownSelectionChange=function(){return function(e,t,n,r){var i=t&&t.key||"",o=t&&t.text||r;s.setState({classifierSelected:{key:i,value:o},classifierErrorMessage:"",isMessageBarHidden:!0,modelName:o})}};s.onRenderFooterContent=function(){return r.createElement(r.Fragment,null,r.createElement(l.PrimaryButton,{onClick:s.onCreateClick,style:{marginRight:"8px"},disabled:s.state.isSaving||!s.state.modelName},v.default.NextText),r.createElement(l.DefaultButton,{onClick:s.props.onDismiss},v.default.CancelText))};s.onCreateClick=function(){return n.__awaiter(s,void 0,void 0,function(){var e,t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:e=this.state,t=e.classifierSelected,r=e.contentTypeSelected,i=e.modelName;if("create"===r){t.key=i;t.value=i}if(""===t.value){this.setState({classifierErrorMessage:v.default.ClassifierNameInvalidText});return[2]}if(!(this._loadedContentTypes.filter(function(e){return e.name===t.value&&e.group===E}).length>0))return[3,1];this.setState({isDialogHidden:!1,isMessageBarHidden:!1});return[3,3];case 1:return[4,this._createOrReviewModel()];case 2:n.sent();n.label=3;case 3:return[2]}})})};s._createOrReviewModel=function(){return n.__awaiter(s,void 0,void 0,function(){var e,t=this;return n.__generator(this,function(n){e=this.state.classifierSelected;this.setState({isSaving:!0});this._contentCenterDataSource.createOrUpdateModel(e.value,e.key,"","").then(function(e){t.setState({isSaving:!1});if(e.d.DriveId&&e.d.ObjectId){var n=e.d.UniqueId;t.props.onDismiss();t._contentCenterDataSource.navigateToModelHomePage(n);t.props.onComplete(!0)}else{b.default.log("[ccui] create or retrieve model failed, empty modelId");t.setState({classifierErrorMessage:v.default.EmptyModelPathErrorText})}}).catch(function(e){b.default.log("[ccui] create model api call failed "+e.message.value);t.setState({isSaving:!1,classifierErrorMessage:e.message.value});t.props.onComplete(!1)});return[2]})})};s.state={contentTypeSelected:"create",classifierErrorMessage:"",classfierDropdownOptions:[],classifierOptions:[],classifierSelected:{key:"",value:""},isLoading:!0,isSaving:!1,isDialogHidden:!0,isMessageBarHidden:!0,modelName:"",showAdvancedSettings:!1};s._contentCenterDataSource=s.props.resources.consume(m.resourceKey);s._pageContext=s.props.resources.consume(y.pageContext);s._modelNameTextFieldRef=r.createRef();return s}t.prototype.componentDidMount=function(){var e=this;this._contentCenterDataSource.getSiteContentTypes(this._pageContext.webAbsoluteUrl,this._pageContext.webServerRelativeUrl,this._pageContext.siteId||"").then(function(t){var n=[];e._loadedContentTypes=t;(t=t.filter(function(e){return-1===w.indexOf(e.name)&&e.id.startsWith("0x0101")})).sort(function(e,t){return e.name.toUpperCase()>t.name.toUpperCase()?1:-1});t.forEach(function(e){n.push({key:e.id,text:e.name})});e.setState({classifierOptions:n,isLoading:!1});e._modelNameTextFieldRef&&e._modelNameTextFieldRef.current&&e._modelNameTextFieldRef.current.focus()}).catch(function(t){b.default.log("[ccui] fetching content type failed "+t.message.value);e.setState({isLoading:!1})})};t.prototype.render=function(){var e=this.state,t=e.contentTypeSelected,n=e.classifierErrorMessage,i=e.classifierOptions,a=e.isLoading,l=e.isSaving,m=e.isMessageBarHidden,y=e.modelName;return r.createElement(s.Panel,{closeButtonAriaLabel:v.default.CloseText,headerText:v.default.CreateModelHeader,isOpen:!0,isFooterAtBottom:!0,isLightDismiss:!0,onDismiss:this.props.onDismiss,onRenderFooterContent:this.onRenderFooterContent,type:s.PanelType.smallFixedFar},!m&&r.createElement("div",{className:"warningMassage"},r.createElement(c.MessageBar,{messageBarType:c.MessageBarType.warning,isMultiline:!0,onDismiss:this.onMessageBarDismiss,dismissButtonAriaLabel:v.default.CloseText},v.default.ContentTypeExistsMessageBarText1,r.createElement(f.Link,{onClick:this._createOrReviewModel},v.default.ContentTypeExistsMessageBarText2),v.default.ContentTypeExistsMessageBarText3)),r.createElement(h.Stack,{gap:15},r.createElement(h.Stack.Item,{styles:{root:{marginTop:"15px"}}},r.createElement(p.Text,null,v.default.CreateModelInstructionText3," ")),r.createElement(h.Stack.Item,{styles:{root:{marginBottom:"25px"}}},r.createElement(d.TextField,{componentRef:this._modelNameTextFieldRef,ariaLabel:v.default.ModelNameInputAriaLabel,errorMessage:"select"===t?"":n,value:y,disabled:"select"===t,label:v.default.ModelInputTextFieldLabel,onChange:this.onTextFieldChange,required:!0})),r.createElement(h.Stack.Item,{className:"advancedSettingsContainer"},this._renderAdvancedSettings(),"select"===t&&this.state.showAdvancedSettings&&r.createElement(r.Fragment,null,r.createElement(u.Dropdown,{ariaLabel:v.default.selectContentTypeIndicator,className:"ContentCenterCreateModelPanel-dropdown",errorMessage:n,onChange:this.onDropdownSelectionChange(),options:i,placeholder:v.default.selectContentTypeIndicator}),a&&r.createElement(o.Spinner,{className:"spinner-topMargin",size:o.SpinnerSize.small,ariaLive:"assertive",labelPosition:"right",label:v.default.LoadingText}))),l&&r.createElement(h.Stack.Item,null,r.createElement(o.Spinner,{className:"spinner-topMargin",size:o.SpinnerSize.small,ariaLive:"assertive",ariaLabel:g.format(v.default.CreateNewModelArialabel,this.state.modelName),role:"status",labelPosition:"right",label:v.default.UpdatingModelFileText}))))};return t})(r.Component);t.default=S});
define("NYe",["require","exports","ww","r","bv","QYe","VYe","jYe","BYe"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContentTypeManagementPanelContainer=void 0;var f=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;i.Engagement.logData({name:"ContentTypeManagementPanel.PanelOpened"});r._state=new s.ContentTypeManagementPanelContainerStateManager({contentTypeManagementPanelContainer:r,strings:n.__assign({},u.default),errorStrings:n.__assign({},a.default)});return r}t.prototype.render=function(){var e=this._state.getRenderProps();return r.createElement(o.ContentTypeManagementPanel,n.__assign({},e))};return t})(r.Component);t.ContentTypeManagementPanelContainer=f;t.default=f});
define("G$e",["require","exports","C2","v"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new r.ResourceKey({name:e("module").id,loader:new r.AliasResourceLoader(function(){return n.loadModuleExport({path:"Hee",getModule:function(){return new Promise(function(t,n){e(["Hee"],t,n)})},getExport:function(e){return e.resourceKey}})})})});
define("W$e",["require","exports","ww","r","Jv","t","Dge","MCe","Sge","LO","$be","Pe","g","xv","pO","mz","k3","sB","f0e","Xye","O2","Qb","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(t){n.__extends(S,t);function S(n){var i=t.call(this,n)||this;i.onFileIconRender=function(){return r.createElement("div",{className:"ms-FileHoverCard-compactCard--fileIcon"},u.renderFileTypeIcon({item:i.props.item,size:32,resources:i.resources,isDisabled:!1}))};i.getAccessToken=function(){return b.getGraphAccessToken(i.state.graphDataSource,i.props.item)};i.onKeyPoints=function(e){i._engagement.logData({name:"FileHoverCard.KeyPoints.OpenEditPanel"});i._showKeyPointsAction(e,!1)};i.onSendFeedbackClick=function(e){i._engagement.logData({name:"FileHoverCard.KeyPoints.SendFeedback"});i._showKeyPointsAction(e,!0)};i.onView=function(e){new(i.resources.injected(i.actionMap.ShowItemAnalyticsAction))({item:s.observable(i.props.item)}).execute(e)};i.onShare=function(e){i._engagement.logData({name:"FileHoverCard.CommandBar.ShareClick"});i._selectItem(e);var t=new(i.resources.injected(i.actionMap.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey});i.props.onClickShare?i.props.onClickShare(e):t.execute(e)};i.onDetails=function(e,t){i._openInfoPane(e)};i.onFileCheckin=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.FileCheckIn"});i._selectItem(e);(new(i.resources.injected(i.actionMap.CheckInAction))).execute(e)};i.onDiscardCheckOut=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.DiscardCheckOut"});i._selectItem(e);(new(i.resources.injected(i.actionMap.UndoCheckOutAction))).execute(e)};i.onViewPolicyTip=function(t){i._engagement.logData({name:"FileHoverCard.LifeCycle.ViewPolicyTip"});i._selectItem(t);new Promise(function(t,n){e(["v9e"],t,n)}).then(w.getDefaultExport).then(function(e){new(i.resources.injected(e))({item:s.observable(i.props.item)}).execute(t)})};i.onAddMetadataNow=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.AddMetadata"});i._selectItem(e);new(i.resources.injected(i.actionMap.EditItemAction))({item:s.observable(i.props.item)}).execute(e)};i._onShareWithDefaultPeople=function(e,t){i._selectItem(e);var n=new(i.resources.injected(i.actionMap.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey,defaultRecipients:t});i.props.onClickShare?i.props.onClickShare(e):n.execute(e)};i.resources=n.resources;i.state={fileHoverCardStore:i.resources.consume(a.resourceKey.optional),graphDataSource:i.resources.consume(d.graph.optional),target:i.props.target};i.actionMap=i.resources.consume(f.actionMap);i._pageContext=i.resources.consume(h.pageContext);i._platform=i.resources.consume(m.platformDetection);i._engagement=i.resources.consume(g.resourceKey);i._itemSetSelectionModel=i.resources.consume(f.itemsSelection);i._scope=new E.default;return i}S.prototype.componentDidMount=function(){var e=this,t=this.resources.consumeAsync(a.resourceKey),n=this.resources.consumeAsync(d.graph);this._scope.trackPromise(t);this._scope.trackPromise(n);t.then(function(t){e.setState({fileHoverCardStore:t})});n.then(function(t){e.setState({graphDataSource:t})});if(this.props.getUpdatedTarget){var r=this.props.getUpdatedTarget();this.setState({target:r})}};S.prototype.componentWillUnmount=function(){this._scope.dispose()};S.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,i=e.graphDataSource;if(!this.props.item)return null;var s=this.props.item,u=s.appMap,a=s.dateModified,f=s.extension,l=s.graph,h=s.itemId,d=s.isPlaceholder,m=s.lifeCycleStatus,g=s.name,w=s.openUrl,E=s.properties,S=s.queryType,x=s.id;if(d)return null;var T=E&&E.modifiedByUser,N=b.getGraphItemUrl(i,this.props.item),C=T&&T.email,k=T&&T.title,L=T&&C?{displayName:k||"",id:h||"",email:C,image:c.getUserPhotoUrl({userLoginName:C})}:void 0,A=m&&m.isMalwareDetected?void 0:[{key:"share",iconProps:{iconName:"share"},title:v.default.Share,onClick:this.onShare}],O=this._platform.isMobile,M={itemTitle:g||"",item:{itemId:h,graph:l,extension:f,queryType:p.default[S||0],graphItemUrl:N,getAccessToken:this.getAccessToken,appMap:u,path:x},target:this.state.target,currentUserActivity:{activityDateTime:a||"",activityType:"Modified",actor:{user:L}},onDetails:this.canShowActions()?this.onDetails:void 0,onKeyPointsClick:this.onKeyPoints,onView:this.onView,onCheckIn:this.onFileCheckin,onDiscardCheckOut:this.onDiscardCheckOut,onViewPolicyTip:this.onViewPolicyTip,onAddMetadataNow:this.onAddMetadataNow,isViewCountClickable:!0,actionBarItems:this.canShowActions()?A:void 0,loginUserEmail:this._pageContext.userLoginName,userEmail:this._pageContext.userEmail,pageUrl:w,gapSpace:this.props.gapData?12+this.props.gapData.inlineCommandCount*y.COMMAND_BUTTON_WIDTH:0,onSendFeedbackClick:this.onSendFeedbackClick,onShareWith:this._onShareWithDefaultPeople,uniqueId:E&&E.uniqueId,onRenderFileTypeIcon:this.onFileIconRender,onRenderShareWithPeople:this.props.onRenderShareWithPeople};return t&&i&&!O?r.createElement(o.FileHoverCard,n.__assign({},M)):this.props.children?this.props.children:null};S.prototype.getChildContext=function(){return{fileHoverCardStore:this.state.fileHoverCardStore}};S.prototype._selectItem=function(e){new(this.resources.injected(this.actionMap.SelectAction))({item:s.observable(this.props.item),showProperties:!1}).execute(e)};S.prototype._showKeyPointsAction=function(e,t){new(this.resources.injected(this.actionMap.ShowKeyPointsAction))({item:s.observable(this.props.item),showFeedbackPanel:t}).execute(e)};S.prototype._openInfoPane=function(e){var t=s.observable(this.props.item);new(this.resources.injected(this.actionMap.SelectAction))({item:t,selectItems:[t],showProperties:!0}).execute(e)};S.prototype.canShowActions=function(){var e=this.props.item,t=s.observable(e);return!e.isPlaceholder&&this._itemSetSelectionModel.canSelectItem(t)};S.childContextTypes={fileHoverCardStore:i.object.isRequired};return S})(r.Component);t.default=S});
define("GZe",["require","exports","ww","r","COe","qA","Te","Co","QS","N5","ODBItemsScopeDeferred_mini_css","W","ra","w3","bg"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";l=l.Sdk80FilePickerHost_module_4;Object.defineProperty(t,"__esModule",{value:!0});t.Sdk80FilePickerHost=void 0;t.Sdk80FilePickerHost=d.withResponsiveMode()(function(e){var t=this,v=e.options,m=e.pageContext,g=e.app,y=e.scenario,b=e.responsiveMode,w=void 0===b?d.ResponsiveMode.large:b,E=r.useState(null),S=E[0],x=E[1],T=r.useRef(),N=T.current||(T.current=new c.Qos({name:"Sdk80FilePickerHost."+y+".load"})),C=r.useRef(null),k=r.useCallback(function(e){C.current=e;x(e&&e.contentWindow||null)},[]),L=r.useState(function(){return"filePicker-"+a.generate()})[0],A=m.webAbsoluteUrl,O=m.layoutsUrl,M=r.useMemo(function(){return n.__assign({sdk:"8.0",messaging:{origin:location.origin,channelId:L}},v||{})},[v]),_=r.useMemo(function(){return A+"/"+O+"/FilePicker.aspx?"+f.serializeQuery({app:g,scenario:y,filePicker:JSON.stringify(M)})},[]),D=new o.SimpleUri(_).authority,P=u.useEventHandler(e.onPick),H=u.useEventHandler(e.onClose),B=u.useEventHandler(e.onLoad);r.useEffect(function(){if(S){var e=i.createHost({initTimeoutMs:6e4,channelId:L,origin:D,onNotification:function(e){switch(e.notification){case"page-loaded":N.end({resultType:c.ResultTypeEnum.Success});B({})}},onCommand:function(e){switch(e.command){case"pick":return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:N.end({resultType:c.ResultTypeEnum.Success});return[4,P({items:e.items})];case 1:t.sent();return[2,{result:"success"}]}})});case"close":return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:N.end({resultType:c.ResultTypeEnum.ExpectedFailure});return[4,H({})];case 1:e.sent();return[2,{result:"success"}]}})})}},identifyParent:!0,source:S});n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){(e=S.document.createElement("form")).setAttribute("method","POST");e.setAttribute("action",_);S.document.body.appendChild(e);e.submit();C.current&&C.current.focus();return[2]})});return function(){e.dispose()}}},[S]);var j=u.useEventHandler(function(){N.end({resultType:c.ResultTypeEnum.ExpectedFailure});H({})}),F=p.getResponsiveModeClassName(w);return r.createElement(s.Modal,{isOpen:!0,onDismiss:j,styles:{main:{display:"flex"}}},r.createElement("iframe",{ref:k,className:h.css(l.frame,F)}))})});
define("NK",["require","exports","ww","r","$s","b3","c3","bc","Qi","BK","Wv"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GraphItemUpdater=void 0;var c=s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["VK"],t,n)})];case 1:return[2,t.sent().SetPreferredKeyFacetForGraphItem]}})})});t.GraphItemUpdater=l.createItemCacheComponent(function(e,t){var n=o.getItemsScope(e).itemsScopeItemKey,s=u.getCurrentItemSetKey(e,n);if(s){if(!e.demandItemFacet(a.spItemKeyFacet,s)){var l=i.getSelectedItemKeys(e);if(1===l.length){var h=l[0];if(f.isGraphItemWithoutPreferredKey(e,h))return r.createElement(c,{itemKey:l[0]})}}}return null})});
define("VK",["require","exports","ww","r","Mc","Tc","zK","Vh","Xp","p3","Qi","Os","e3","Wv"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.setPreferredKeyFacet=t.SetPreferredKeyFacetForGraphItem=t.bindPreferredKeyClickAction=void 0;var d=p.createItemCacheComponent(function(e,t){var i=t.itemKey,o=n.__rest(t,["itemKey"]),f=e.demandItemFacet(c.preferredKeyFacetFacet,i),h=f&&e.demandItemFacet(f,i);if(h&&h.webAbsoluteUrl&&h){return l.spItemKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,itemId:h.itemId,rootFolder:h.rootFolder})&&r.createElement(s.WithAction,{action:r.createElement(a.ItemDefaultClickAction,{itemKey:i})},function(e){return r.createElement(u.AutoActionExecutor,n.__assign({},e,{onComplete:o.resolve,onError:o.reject}))})}return null});t.bindPreferredKeyClickAction=function(e){var t=this,a=e.itemKey,f=s.renderComponentOnExecute(function(e){return r.createElement(s.WithAction,{action:r.createElement(o.SetPreferredKeyAction,{itemKey:a})},function(t){return r.createElement(u.AutoActionExecutor,n.__assign({},t,{onComplete:e.resolve,onError:e.reject}))})}),l=s.renderComponentOnExecute(function(e){return r.createElement(s.WithAction,{action:r.createElement(o.SelectItemAction,{itemKey:a})},function(t){return r.createElement(u.AutoActionExecutor,n.__assign({},t,{onComplete:e.resolve,onError:e.reject}))})}),c=s.renderComponentOnExecute(function(e){return r.createElement(d,n.__assign({},e,{itemKey:a}))});return r.createElement(i.Action,{onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,f(e)];case 1:t.sent();return[4,l(e)];case 2:t.sent();return[4,c(e)];case 3:t.sent();return[2]}})})}})};t.SetPreferredKeyFacetForGraphItem=function(e){var t=e.itemKey,n=h.useItemCacheDispatch();r.useEffect(function(){n(v({itemKey:t}))},[t]);return null};function v(e){return function(t){var r,i=e.itemKey;t(f.resolveItems({items:(r={},r[i]=n.__assign({},o.getPreferredKeyFacet(i)),r)}))}}t.setPreferredKeyFacet=v});
define("zK",["require","exports","ww","Wv","Mc","Ac","p3","Qi","Os","So","qi","th","Vb","yo","vo"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SelectItemAction=t.SetPreferredKeyAction=t.getGraphItemPreferredFacet=t.getPreferredKeyFacet=void 0;t.getPreferredKeyFacet=function(e){return n.__assign(n.__assign({},l.pack({preferredKeyFacet:a.preferredKeyFacetFacet},{preferredKeyFacet:new f.IfNotMatchPatch(u.spItemFullUrlKeyFacet,function(e){return e===u.spItemKeyFacet})})),c.getInvalidationFacet().forFacet(a.preferredKeyFacetFacet).thenInvalidate(e,a.preferredKeyFacetFacet).pack())};t.getGraphItemPreferredFacet=function(e,t){var n=e.demandItemFacet(u.spItemFullUrlKeyFacet,t),r=e.demandItemFacet(a.preferredKeyFacetFacet,t),i=r&&e.demandItemFacet(r,t),s=i&&i.webAbsoluteUrl,o=e.demandItemFacet(h.driveItemKeyFacet,t);return{preferredValue:i,graphItemHasPreferredKey:!!n&&s&&!!o}};t.SetPreferredKeyAction=r.connectToItemCache(function(e,r){var i=r.itemKey,u=e.dispatch,a=t.getGraphItemPreferredFacet(e,i).graphItemHasPreferredKey;return n.__assign({isAvailable:!a,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(r){u(o.resolveItems({items:(e={},e[i]=n.__assign({},t.getPreferredKeyFacet(i)),e)}));return[2]})})}},s.getItemActionEngagement(e,{itemKey:i,engagement:{name:"SetPreferredGraphItemKey",isIntentional:!1}}))})(i.Action);t.SelectItemAction=r.connectToItemCache(function(e,t){var r=t.itemKey,i=d.getItemsScope(e).itemsScopeItemKey,o=e.dispatch;return n.__assign({isAvailable:!0,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){i&&o(p.selectItems({currentSelectionKey:void 0,itemsScopeItemKey:i,selectedItemKeys:[r]}));return[2]})})}},s.getItemActionEngagement(e,{itemKey:r,engagement:{name:"SelectItem",isIntentional:!1}}))})(i.Action)});
define("WZe",["require","exports","ww","r","LO","bc","eW","Wv","Gi","Eoe","U1"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeamChannelHeader=t.TeamChannelHeaderBase=void 0;var c=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.progId,n=e.resources,s=n.consume(i.actionMap);return o.isProgIdTeamChannelFolder(t)?r.createElement(f.default,{actionMap:s,resources:n}):null};return t})(r.PureComponent);t.TeamChannelHeaderBase=c;t.TeamChannelHeader=s.withCurrentItem()(u.connectToItemCache(function(e,t){return{progId:e.demandItemFacet(a.progIdFacet,t.itemKey)}})(l.withResources()(c)))});
define("rz",["require","exports","r","Hz","Mz","kz","dz","oz","U1","v","Je","g1"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TransclusionContent=void 0;function h(e){var t=a.useResourceScope(),o=n.useMemo(function(){return i.toSpecification(s.resourceKey,{})},[]);return n.createElement(c.WithKnockoutResourceScope,null,n.createElement(r.default,{specification:o,resources:t}))}var p=a.withChildResources(function(e){e.exposeFactory(o.typeResourceKey,new f.AliasResourceFactory(u.typeResourceKey))},{owner:e("module").id})(h);t.TransclusionContent=l.default.isActivated("F2A3B2C8-3374-4D27-A19A-C791E9C75D2C","8/16/2019","ItemSelectionHelper shim for Knockout")?h:p});
define("H$e",["require","exports","ww","r","fA","SK","Lxe","N6","dh","Yv","Hxe"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.knockoutResourceKey=t.resourceKey=t.ItemsPicker=void 0;function c(e,t){return{addMetadataAction:null,checkInAction:null,policyTipAction:null,publishNowAction:null,showDetailsPane:null,showFeedbackPane:null,showFileAnalytics:null,showKeyPointsPane:null,undoCheckOutAction:null}}function h(e,t){return{isAvailable:!1}}var p=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.context.dependencies.currentItemsScope;return r.createElement(f.ControlHandlerProvider,{controlHandlers:n.__assign(n.__assign({},u.hoverCardCommandsControl.pack(c)),a.shareActionControl.pack(h))},r.createElement(e,null,r.createElement(i.ItemsPicker,n.__assign({},this.props))))};t.contextTypes=s.RESOLVED_COMPONENT_CONTEXT_TYPES;return t})(r.PureComponent);t.ItemsPicker=p;t.resourceKey=s.createResolvedComponentTypeResourceKey(e("module").id,p,{currentItemsScope:l.resourceKey.local});t.knockoutResourceKey=o.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-picker",name:e("module").id+".knockout"})});
define("R$e",["require","exports","ww","r","SK","Lxe","B$e","Hxe","N$e"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.knockoutResourceKey=t.resourceKey=t.ItemsSearch=void 0;var f=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.context.dependencies,t=e.currentItemsScope,n=e.itemContentControlHandlers;return r.createElement(t,null,r.createElement(n,null,r.createElement(o.SearchBar,null)))};t.contextTypes=i.RESOLVED_COMPONENT_CONTEXT_TYPES;return t})(r.PureComponent);t.ItemsSearch=f;t.resourceKey=i.createResolvedComponentTypeResourceKey(e("module").id,f,{currentItemsScope:u.resourceKey.local,itemContentControlHandlers:a.resourceKey});t.knockoutResourceKey=s.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-search",name:e("module").id+".knockout"})});
define("IJe",["require","exports","ww","r","vg","Yv","Q0","Lxe","Tu","SK","v","cge","tB","I","dxe","Hxe","Oo","Zb","OJe","CJe","Tb","Bc","Aae","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.knockoutResourceKey=t.resourceKey=t.ItemsScopeCommandBar=void 0;var S={commands:[],farCommands:[],overflowCommands:[]},x=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._itemsCommandBarControlHandler=function(e,t){var n=t.itemKey;if(!e.isItemFacetResolved(E.displayNameFacet,n))return S;var r=e.demandItemFacet(b.extendedCommandBarControl,w.odspNextAppItemKey);return r?b.extendedCommandBarControl.evaluate(r)(e,t):S};r._scope=new p.default;var i=r._scope.attach(new(r.context.dependencies.resources.injected(c.default))({renderLabel:1})).command;r._observables=r._scope.attach(new r.context.dependencies.observablesFactoryType({owner:r}));r._reactCommandManager=r._scope.attach(new r.context.dependencies.reactCommandManagerType({commandSet:{commands:r._observables.createArray([i])}}));r.state={farItems:r._reactCommandManager.commandBarItems.peek().farItems};r._itemsScopeManager=n.dependencies.itemsScopeManager;r._controlHandlers=o.itemsCommandBarControl.pack(r._itemsCommandBarControlHandler);return r}t.prototype.componentDidMount=function(){var e=this;this._observables.subscribe(this._reactCommandManager.commandBarItems,function(t){e.setState({farItems:n.__spreadArrays(t.farItems)})});this.props.handleRenderComplete(m.now(),this._itemsScopeManager)};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.context.dependencies,t=e.currentItemsScope,n=e.actionControlHandlers,o=this.state.farItems,u=r.createElement(n,null,r.createElement(s.ControlHandlerProvider,{controlHandlers:this._controlHandlers},r.createElement(t,null,r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{display:"block",width:"100%"}},r.createElement(i.ItemsCommandBar,{farItems:o}))))));return r.createElement(a.Fabric,null,u)};t.contextTypes=f.RESOLVED_COMPONENT_CONTEXT_TYPES;return t})(r.PureComponent);t.ItemsScopeCommandBar=x;t.resourceKey=f.createResolvedComponentTypeResourceKey(e("module").id,x,{resources:l.resourceScopeKey,observablesFactoryType:h.observablesFactoryTypeResourceKey,reactCommandManagerType:d.typeResourceKey,currentItemsScope:v.resourceKey.local,itemsScopeManager:g.resourceKey,actionControlHandlers:y.resourceKey});t.knockoutResourceKey=u.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-scope-command-bar",name:e("module").id+".knockout"})});
define("TJe",["require","exports","ww","r","e3","U1","cc","Bc","q2","tne"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DesktopAppDownloader=void 0;t.DesktopAppDownloader=function(e){var t=this,l=e.resolve,c=e.reject,h=i.useItemCacheDispatch(),p=s.useResourceScope();r.useLayoutEffect(function(){n.__awaiter(t,void 0,void 0,function(){var t,r,i,s,d,v;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,e.getDownloadData()];case 1:t=n.sent();r=e.itemKeys[0];i=h(o.readItems(function(e){return e.demandItemFacet(u.displayNameFacet,r)}));return[4,p.consumeAsync(a.resourceKey)];case 2:s=n.sent();d={command:"Download",type:f.WinAppDownloadType.DownloadSingleFile,downloadUrl:t.url,zipFileName:i,postBody:JSON.stringify({})};if("POST"===t.method){d.postBody=JSON.stringify({request:t.postData});d.zipFileName=t.postData.zipFileName;d.type=f.WinAppDownloadType.DownloadMultiFile}s.sendCommand({command:JSON.stringify({DownloadCommand:d})});l();return[3,4];case 3:v=n.sent();c(v);return[3,4];case 4:return[2]}})})},[]);return null}});
define("UJe",["require","exports","ww","r","cc","T2","az","fB","e3","U1"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DownloaderWithRecents=void 0;t.DownloaderWithRecents=function(e){var t=this,l=e.defaultRender,c=n.__rest(e,["defaultRender"]),h=e.itemKeys,p=a.useItemCacheDispatch(),d=f.useResourceScope();r.useLayoutEffect(function(){if(u.isFeatureEnabled(u.WriteMruSignalWhenMediaDownloaded)){var e=p(i.readItems(function(e){return h.map(function(t){return e.demandItemFacet(o.oneDriveItemFacet,t)})}));n.__awaiter(t,void 0,void 0,function(){var t,r,i,o,u;return n.__generator(this,function(n){switch(n.label){case 0:return[4,d.consumeAsync(s.mruRecent.optional)];case 1:if(!(t=n.sent()))return[3,3];r=[];for(i=0,o=e;i<o.length;i++)(u=o[i])&&r.push(t.recordDocumentView(u));return[4,Promise.all(r)];case 2:n.sent();n.label=3;case 3:return[2]}})})}},[]);return l?r.createElement(l,n.__assign({},c)):null}});
define("NZe",["require","exports","ww","jZe","BZe","hZ","v"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new o.ResourceKey({name:e("module").id,factory:{dependencies:{flowProcessorType:s.typeResourceKey},create:function(e){var t=new(0,e.flowProcessorType)({}),s=function(e,i){return r.loadAllFlows(e,n.__assign(n.__assign({},i),{flowProcessor:t}))};return{instance:function(e,t){return{loadAllFlows:s,getFlowCommandSubMenuProps:i.getFlowCommandSubMenuProps}},disposable:t}}}})});
define("K$e",["require","exports","r","Bz","Tc","rh","W$e","v","dh","Yv","bl","DJe","bv","Wv","mw","U1","dz","oz"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemHoverCardLauncher=void 0;var y=p.connectToItemCache(function(e,t){return{item:e.demandItemFacet(d.knockoutStoreItemFacet,t.itemKey)}})(r.withKnockoutComputed(function(e){var t=e.item;return{item:t&&t()}})(o.default));t.ItemHoverCardLauncher=v.withChildResources(function(e){e.exposeFactory(m.typeResourceKey,new u.AliasResourceFactory(g.typeResourceKey))},{owner:e("module").id})(function(e){var t=e.root,r=e.itemKey,o=v.useResourceScope(),u=function(e){return n.createElement(f.ControlHandlerProvider,{controlHandlers:a.shareActionControl.pack(function(t,n){return{defaultRecipients:e}})},n.createElement(i.WithAction,{action:n.createElement(s.ItemShareAction,{itemKey:r})},function(e){var r=e.isAvailable,i=e.execute,s=r?function(e){h.Engagement.logData({name:"FileHoverCard.RecommendedActions.ShareWith",isIntentional:!0});e.target=t;e.persist();i({event:e})}:void 0;return n.createElement(l.Link,{className:"ms-FileHoverCard-ShareWithLink",onClick:s},c.default.ShareWithThem)}))};return t&&r?n.createElement(i.WithAction,{action:n.createElement(s.ItemShareAction,{itemKey:r})},function(e){var i=e.isAvailable,s=e.execute,a=i?function(e){h.Engagement.logData({name:"FileHoverCard.CommandBar.ShareClick"});e.target=t;e.persist();s({event:e})}:void 0;return n.createElement(y,{itemKey:r,target:t,onClickShare:a,resources:o,onRenderShareWithPeople:u})}):n.createElement(n.Fragment,null)})});
define("tXe",["require","exports","ww","r","mz","qi","Ng","HZe","FZe","UZe","TZe","PZe","MZe","kZe","LZe","AZe","EZe","wZe","OZe","xZe","IZe","DZe","SZe","WP","H0","yZe","xv","V0","Mg","M0","vZe","gZe","bZe","oZe","iZe","aZe","tZe","XXe","JXe","YXe","WXe","RXe","FXe","TXe","MXe","LXe","AXe","wXe","OXe","CXe","xXe","SXe","gXe","_Xe","pXe","uXe","dXe","cXe","oXe","iXe","nXe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NavigateToSharedByMeCommand=t.NavigateToSharedWithMeCommand=t.ManageAccessCommand=t.FileRequestCommand=t.UploadFolderCommand=t.UploadFileCommand=t.TeamChannelCommand=t.EditNewMenuCommand=t.launchFormatViewPaneCommand=t.openFileCommand=t.openInOfficeClientCommand=t.openInOfficeOnlineCommand=t.OpenInSharePointCommand=t.OpenInExplorerCommand=t.OpenInTextEditorCommand=t.AddToQuickLaunchCommand=t.OpenInPowerBICommand=t.surveyCommand=t.editSurveyCommand=t.viewSurveyCommand=t.shareSurveyCommand=t.createTextFileCommand=t.createExcelSurveyCommand=t.createOneNoteCommand=t.createPowerPointCommand=t.createExcelCommand=t.createWordCommand=t.CreateShortcutCommand=t.CancelPublishCommand=t.UnPublishCommand=t.PublishCommand=t.EditRenditionsCommand=t.ComplianceDetailsCommand=t.WorkflowCommand=t.previewCommand=t.approveRejectCommand=t.reportAbuseCommand=t.removeMountPointCommand=t.createMountPointCommand=t.embedCommand=t.orderPrintsCommand=t.rotateCommand=t.makeHomePageCommand=t.ViewDocumentPropertyCommand=t.bulkEditDocumentPropertyCommand=t.CommentItemCommand=t.ViewItemCommand=t.EditItemCommand=t.copyFieldCommand=t.cancelEditCommand=t.quickEditCommand=t.addToOneDriveCommand=t.fullscreenCommand=t.runModelCommand=t.copyToCommand=t.moveToCommand=t.filtersPaneCommand=t.detailsMenuCommand=t.detailsCommand=t.captureVersionCommand=t.aibuilderCommand=t.powerAppsCommand=t.versionHistoryCommand=t.manageAlertCommand=t.alertMeCommand=void 0;var ue={iconName:void 0,styles:{root:{display:"none!important"}}};Object.defineProperty(t,"alertMeCommand",{enumerable:!0,get:function(){return D.alertMeCommand}});Object.defineProperty(t,"manageAlertCommand",{enumerable:!0,get:function(){return D.manageAlertCommand}});Object.defineProperty(t,"versionHistoryCommand",{enumerable:!0,get:function(){return D.versionHistoryCommand}});Object.defineProperty(t,"powerAppsCommand",{enumerable:!0,get:function(){return D.powerAppsCommand}});Object.defineProperty(t,"aibuilderCommand",{enumerable:!0,get:function(){return D.aibuilderCommand}});Object.defineProperty(t,"captureVersionCommand",{enumerable:!0,get:function(){return P.captureVersionCommand}});Object.defineProperty(t,"detailsCommand",{enumerable:!0,get:function(){return H.detailsCommand}});Object.defineProperty(t,"detailsMenuCommand",{enumerable:!0,get:function(){return B.detailsMenuCommand}});Object.defineProperty(t,"filtersPaneCommand",{enumerable:!0,get:function(){return j.filtersPaneCommand}});Object.defineProperty(t,"moveToCommand",{enumerable:!0,get:function(){return F.moveToCommand}});Object.defineProperty(t,"copyToCommand",{enumerable:!0,get:function(){return I.copyToCommand}});Object.defineProperty(t,"runModelCommand",{enumerable:!0,get:function(){return q.runModelCommand}});Object.defineProperty(t,"fullscreenCommand",{enumerable:!0,get:function(){return R.fullscreenCommand}});Object.defineProperty(t,"addToOneDriveCommand",{enumerable:!0,get:function(){return U.addToOneDriveCommand}});Object.defineProperty(t,"quickEditCommand",{enumerable:!0,get:function(){return z.quickEditCommand}});Object.defineProperty(t,"cancelEditCommand",{enumerable:!0,get:function(){return W.cancelEditCommand}});t.copyFieldCommand={key:new s.Facet("CopyField").id,name:i.default.CopyField,action:r.createElement(y.CopyFieldAction,null),hasLaunchTarget:!0,automationId:"copyFieldCommand"};t.EditItemCommand={key:O.editItemCommandKey,name:i.default.editProperties,action:r.createElement(y.EditItemAction,null),iconProps:{iconName:"Edit"},automationId:"editProperties"};t.ViewItemCommand={key:O.viewItemCommandKey,name:i.default.Open,action:r.createElement(y.ViewItemAction,null),automationId:"viewItemCommand"};t.CommentItemCommand={key:O.commentItemCommandKey,name:i.default.commentCommandText,action:r.createElement(y.ViewItemAction,{preferredSection:"comments"}),iconProps:{iconName:"Comment"},engagement:{name:"CommentItemCommand",isIntentional:!0,usageType:"Click"}};t.bulkEditDocumentPropertyCommand={key:O.bulkEditDocumentPropertyCommandKey,name:i.default.viewProperties,action:r.createElement(y.EditItemAction,{isBulkEdit:!0}),iconProps:{iconName:"Edit"}};t.ViewDocumentPropertyCommand={key:O.viewDocumentPropertyCommandKey,name:i.default.viewProperties,action:r.createElement(y.ViewItemAction,null),iconProps:{iconName:"Edit"}};t.makeHomePageCommand={key:new s.Facet("MakeHomePage").id,name:i.default.MakeHomepage,action:r.createElement(h.MakeHomePageAction,null),iconProps:{iconName:"Home"}};t.rotateCommand={key:new s.Facet("rotate").id,name:i.default.rotate,action:r.createElement(p.RotateAction,null),iconProps:{iconName:"rotate"}};t.orderPrintsCommand={key:new s.Facet("orderPrints").id,name:i.default.OrderPrints,action:r.createElement(d.OrderPrintsAction,null),iconProps:{iconName:"Print"}};t.embedCommand={key:new s.Facet("embed").id,automationId:"embed",name:i.default.Embed,action:r.createElement(v.EmbedAction,null),iconProps:{iconName:"Embed"}};t.createMountPointCommand={key:new s.Facet("createMountPoint").id,automationId:"createMountPoint",name:i.default.CreateMountPoint,action:r.createElement(w.CreateMountPointAction,null),iconProps:{iconName:"FabricFolderLink"}};t.removeMountPointCommand={key:new s.Facet("removeMountPoint").id,name:i.default.RemoveMountPoint,action:r.createElement(w.RemoveMountPointAction,null),iconProps:{iconName:"Cancel"}};t.reportAbuseCommand={key:new s.Facet("reportAbuse").id,name:i.default.reportAbuse,action:r.createElement(c.ReportAbuseAction,null),iconProps:{iconName:"EditNote"}};t.approveRejectCommand={key:new s.Facet("ApproveReject").id,name:i.default.ApproveReject,action:r.createElement(S.ApproveRejectAction,null),iconProps:ue};Object.defineProperty(t,"previewCommand",{enumerable:!0,get:function(){return X.previewCommand}});Object.defineProperty(t,"WorkflowCommand",{enumerable:!0,get:function(){return V.workflowCommand}});Object.defineProperty(t,"ComplianceDetailsCommand",{enumerable:!0,get:function(){return $.complianceDetailsCommand}});t.EditRenditionsCommand={key:new s.Facet("EditRenditions").id,name:i.default.EditRenditions,action:r.createElement(b.EditRenditionsAction,null)};Object.defineProperty(t,"PublishCommand",{enumerable:!0,get:function(){return J.publishCommand}});Object.defineProperty(t,"UnPublishCommand",{enumerable:!0,get:function(){return K.unPublishCommand}});Object.defineProperty(t,"CancelPublishCommand",{enumerable:!0,get:function(){return Q.cancelPublishCommand}});Object.defineProperty(t,"CreateShortcutCommand",{enumerable:!0,get:function(){return G.createShortcutCommand}});t.createWordCommand={key:new s.Facet("createWord").id,automationId:"createWordCommand",name:k.default.CreateWord,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateWordAction,null)),iconProps:T.getCommandIconProps({extension:"docx",size:16})};t.createExcelCommand={key:new s.Facet("createExcel").id,automationId:"createExcelCommand",name:k.default.CreateExcel,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateExcelAction,null)),iconProps:T.getCommandIconProps({extension:"xlsx",size:16})};t.createPowerPointCommand={key:new s.Facet("createPowerPoint").id,automationId:"createPowerPointCommand",name:k.default.CreatePowerPoint,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreatePowerPointAction,null)),iconProps:T.getCommandIconProps({extension:"pptx",size:16})};t.createOneNoteCommand={key:new s.Facet("createOneNote").id,automationId:"createOneNoteCommand",name:k.default.CreateOneNote,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateOneNoteAction,null)),iconProps:T.getCommandIconProps({extension:"onetoc",size:16})};t.createExcelSurveyCommand={key:new s.Facet("createExcelSurvey").id,automationId:"createExcelSurveyCommand",name:k.default.CreateExcelSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateExcelSurveyAction,null)),iconProps:T.getCommandIconProps({extension:"xlsx",size:16})};t.createTextFileCommand={key:new s.Facet("createTextFile").id,name:i.default.CreateText,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateTextFileAction,null)),iconProps:T.getCommandIconProps({extension:"txt",size:16})};t.shareSurveyCommand={key:new s.Facet("shareSurvey").id,name:i.default.shareSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.ShareSurveyAction,null)),iconProps:ue};t.viewSurveyCommand={key:new s.Facet("viewSurvey").id,name:i.default.viewSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.ViewSurveyAction,null)),iconProps:ue};t.editSurveyCommand={key:new s.Facet("editSurvey").id,name:i.default.editSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.EditSurveyAction,null)),iconProps:ue};t.surveyCommand={key:new s.Facet("survey").id,name:"Survey",subMenuProps:{items:[t.shareSurveyCommand,t.viewSurveyCommand,t.editSurveyCommand]},iconProps:ue};Object.defineProperty(t,"OpenInPowerBICommand",{enumerable:!0,get:function(){return Y.openInPowerBICommand}});t.AddToQuickLaunchCommand={key:_.addToQuickLaunchCommandKey,name:i.default.AddToQuickLaunch,action:r.createElement(a.AddToQuickLaunch,null),iconProps:{iconName:"Pin"}};Object.defineProperty(t,"OpenInTextEditorCommand",{enumerable:!0,get:function(){return Z.openInTextEditorCommand}});Object.defineProperty(t,"OpenInExplorerCommand",{enumerable:!0,get:function(){return ee.openInExplorerCommand}});Object.defineProperty(t,"OpenInSharePointCommand",{enumerable:!0,get:function(){return te.openInSharePointCommand}});t.openInOfficeOnlineCommand={key:new s.Facet("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",name:"##Localized_OpenInOfficeOnline##",action:r.createElement(f.OpenInOfficeOnlineAction,null),facets:n.__assign({},L.isReadonlyFacet.pack(!0))};t.openInOfficeClientCommand={key:new s.Facet("openInOfficeClient").id,automationId:"openInOfficeClientCommand",name:"##Localized_OpenInOfficeClient##",action:r.createElement(l.OpenInOfficeClientAction,null),facets:n.__assign({},L.isReadonlyFacet.pack(!0))};t.openFileCommand={key:A.openCommand.key,automationId:A.openCommand.automationId,name:"##Localized_Open##",subMenuProps:{items:[t.openInOfficeOnlineCommand,t.openInOfficeClientCommand]},facets:n.__assign({},L.isReadonlyFacet.pack(!0))};t.launchFormatViewPaneCommand={key:M.launchFormatViewPaneCommandKey,name:i.default.FormatView,action:r.createElement(o.HideWithSelection,null,r.createElement(E.LaunchFormatViewPaneAction,null)),iconProps:ue,automationId:"launchFormatViewPaneCommand"};t.EditNewMenuCommand={key:x.editNewMenuKey,name:i.default.editNewMenu,action:r.createElement(o.HideWithSelection,null,r.createElement(u.EditNewMenuAction,null)),iconProps:{iconName:"Edit"}};Object.defineProperty(t,"TeamChannelCommand",{enumerable:!0,get:function(){return ne.teamChannelCommand}});Object.defineProperty(t,"UploadFileCommand",{enumerable:!0,get:function(){return re.uploadFileCommand}});Object.defineProperty(t,"UploadFolderCommand",{enumerable:!0,get:function(){return ie.uploadFolderCommand}});Object.defineProperty(t,"FileRequestCommand",{enumerable:!0,get:function(){return se.fileRequestCommand}});Object.defineProperty(t,"ManageAccessCommand",{enumerable:!0,get:function(){return oe.manageAccessCommand}});t.NavigateToSharedWithMeCommand={key:new s.Facet("NavigateToSharedWithMe").id,name:i.default.SharedWithYou,title:i.default.SharedWithYou,action:r.createElement(N.NavigateToQueryRootAction,{queryType:C.default.SharedWithMe}),isPermanent:!0};t.NavigateToSharedByMeCommand={key:new s.Facet("NavigateToSharedByMe").id,name:i.default.SharedByYou,title:i.default.SharedByYou,action:r.createElement(N.NavigateToQueryRootAction,{queryType:C.default.SharedByMe}),isPermanent:!0}});
define("yJe",["require","exports","ww","r","J9","Xse","_A","cN","uCe","OQ","UZ","Qi","D7","bw","M4","DJe","Oe","bl","Wb","Je","ODBItemsScopeDeferred_mini_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SchedulingComponent=void 0;var w="-2146232832, Microsoft.SharePoint.SPFeatureDependencyNotActivatedException",E=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.learnMoreLink=r.createElement(g.Link,{key:"learn_more_link",href:"https://go.microsoft.com/fwlink/?linkid=2112547",target:"_blank"},v.default.LearnMore);n.majorMinorLearnHowLink=r.createElement(g.Link,{key:"major_minor_learn_more_link",href:"https://go.microsoft.com/fwlink/?linkid=2142930",target:"_blank"},v.default.LearnHow);n._onChange=function(e,t){n._webDataSource.setSchedulingFeature(t).then(function(e){n.setState({schedulingOn:e.isFeatureActivated});var r=n._resources.consume(h.resourceKey).getUrlParts({}),i=c.spPageContextKeyFacet.serialize({webAbsoluteUrl:n.props.pageContext.webAbsoluteUrl,listFullUrl:r.fullListUrl}),s=n._getUpdatedPageContext(t);if(s){n._resources.consumeAsync(p.resourceKey).then(function(e){e.dispatch(d.updatePageContext({itemKey:i,options:{pageContext:s}}))});if(!b.default.isActivated("f08f5202-8ed8-49bf-8d00-c5504a67dbb0","4/16/2020","use clearPageCache when scheduling is toggled")){var o=n._resources.consume(y.resourceKey);o.clearPageCache&&o.clearPageCache()}}},function(e){if(b.default.isActivated("8f1f5f2e-b7be-4915-870a-716ed44f0e5c","09/11/2020","Scheduling should not activate if major minor versions are not enabled.")){n._operation.state(f.default.failed);n._operation.error(new l.default({message:"Error",payloads:e}))}else(null==e?void 0:e.code)===w&&n.setState({error:"MajorMinorNotEnabled"})})};n._onDismiss=function(){n.setState({isOpen:!1})};n._resources=n.props.resources;n._webDataSource=n._resources.consume(a.resourceKey);n.state={schedulingOn:n._isSchedulingTurnedOn(n.props.pageContext&&n.props.pageContext.featureInfo),isOpen:!0,error:void 0};n.learnMore=m.formatToArray(v.default.SchedulingDescription,n.learnMoreLink);n.majorMinorLearnMore=m.formatToArray(v.default.SchedulingActivationMajorMinor,n.majorMinorLearnHowLink);return n}t.prototype.render=function(){return r.createElement(o.Panel,{"data-automationid":"SchedulingPanel",isOpen:this.state.isOpen,type:o.PanelType.smallFixedFar,headerText:v.default.Scheduling,isLightDismiss:!0,onDismiss:this._onDismiss,closeButtonAriaLabel:v.default.SchedulingPanelCloseLabel},r.createElement("div",null,this.learnMore),r.createElement(s.Toggle,{className:"SchedulingComponentToggle-topPadding",label:v.default.EnableScheduling,checked:this.state.schedulingOn,onChange:this._onChange,onText:v.default.SchedulingOnToggleText,offText:v.default.SchedulingOffToggleText}),r.createElement("div",null,"MajorMinorNotEnabled"===this.state.error&&r.createElement(u.MessageBar,{ariaLabel:v.default.SchedulingActivationMajorMinor,messageBarType:u.MessageBarType.warning},this.majorMinorLearnMore)),r.createElement("div",null,this.state.schedulingOn&&r.createElement(u.MessageBar,{ariaLabel:v.default.DisableSchedulingWarning,messageBarType:u.MessageBarType.warning},v.default.DisableSchedulingWarning)))};t.prototype._getUpdatedPageContext=function(e){if(this.props.pageContext&&this.props.pageContext.featureInfo){var t=n.__assign({},this.props.pageContext.featureInfo);t.SitePagesScheduling.Enabled=e;return n.__assign(n.__assign({},this.props.pageContext),{featureInfo:t})}};t.prototype._isSchedulingTurnedOn=function(e){if(!e)return!1;var t=new i.default(e);if(t){var n=t.get("SitePagesScheduling");return!!n&&n.enabled}return!1};return t})(r.PureComponent);t.SchedulingComponent=E});
define("V$e",["require","exports","v","d9","Hee"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{resources:n.resourceScopeKey,isInfoPaneExpanded:i.resourceKey},create:function(e){return{instance:function(t,n){return{onSwitchLayout:function(t){return function(n){var i=e.isInfoPaneExpanded;t.layoutType===r.quickEditLayoutType&&i&&i.peek()&&i(!1)}}}}}}}})});
define("z6",["require","exports","ww","r","v","b3","Kb"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:{pageLoadMonitor:o.resourceKey},create:function(t){var i=t.pageLoadMonitor,o=s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,i.waitForPLT()];case 1:t.sent();return[4,new Promise(function(t,n){e(["oJe"],t,n)})];case 2:return[2,t.sent().SyncAction]}})})});return{instance:function(e,t){return"syncGroove"===t.syncState?{isAvailable:!0,fallbackAction:r.createElement(o,null)}:{}}}}}})});
define("Ret",["require","exports","Gi","Qi","Ow","r7","dv"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getMetaData=void 0;t.getMetaData=function(e,t){var u,a;if(!i.isFeatureEnabled(i.PowerBIIntegration))return{canShow:!1};if(o.isTeamsWebView())return{canShow:!1};if(s.isCrossOrigin())return{canShow:!1};var f=e.demandItemFacet(r.spItemKeyFacet,t);if(!f)return{canShow:!1};var l=e.demandItemFacet(n.spPageContextFacet,r.spPageContextKeyFacet.serialize({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}));if(!l||l.isAnonymousGuestUser||l.isEmailAuthenticationGuestUser||0===(null===(a=null===(u=l.farmSettings)||void 0===u?void 0:u.ExternalService_powerbihostname)||void 0===a?void 0:a.length))return{canShow:!1};var c={webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl},h=r.spListKeyFacet.serialize(c),p=e.demandItemFacet(n.listFacet,h);return{listKey:c,canShow:!0,pageContext:l,isDocumentLibrary:!!p&&!!p.isDocumentLibrary}}});
define("jJe",["require","exports","ww","r","qi","uv","zi","eXe","Qi","Gi","QJe","Ow","ov","i7","l2","R3","GJe","rm","jo","uo","Je","Tb","zJe","UO","VJe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPowerAutomateCommand=t.getFlowCommand=void 0;var N=new i.Facet("addFlow").id,C=new i.Facet("configureFlows").id,k=new i.Facet("existingFlows").id,L=new i.Facet("setUpApprovalFlow").id,A=i.getNextId("createRuleCommand"),O=i.getNextId("manageRulesCommand"),M=i.getNextId("powerAutomateCommand"),_=w.default.isActivated("E91D3604-01E2-4BBF-9444-596B07A532FC","5/27/2020","Show Flow menu only when populated"),D=w.default.isActivated("6157EEB4-D679-4A7D-855D-CD2BE8C5D9FA","10/16/2020","Check SharePoint Syntex License to show the AIBuilder Menu or not");t.getFlowCommand=function(e,t){var i=p.getFlowMetaData(e,t),l=i.canShow,w=i.pageContext,N=i.listKey,C=i.isDocumentLibrary;if(l&&w&&N){var k=e.demandItemFacet(d.flowProcessorControl,E.odspNextAppItemKey),L=d.flowProcessorControl.evaluate(k)(e,{}),M=L.loadAllFlows,B=L.getFlowCommandSubMenuProps,j=!1;if(T.isCheckSharePointSyntexLicenseKillSwitchActivated){var F=e.demandItemFacet(a.spItemKeyFacet,t);if(F){var I={webAbsoluteUrl:F.webAbsoluteUrl,listFullUrl:F.listFullUrl},q=a.spListKeyFacet.serialize(I),R=e.demandItemFacet(f.listFacet,q);j=!!R&&!!R.aiBuilderEnabled&&(D||!!R.machineLearningCaptureEnabled)&&!!(null==R?void 0:R.isDocumentLibrary)&&R.templateType!==o.default.webPageLibrary}}else{var U=T.getListSyntexContext(e),z=U.isAIBuilderEnabled,W=U.isMachineLearningCaptureEnabled,X=U.listTemplateType;j=z&&W&&!!C&&X!==o.default.webPageLibrary}var V=(function(e,t){var i=[];if(c.isFeatureEnabled(c.RulesPanel)&&e&&e.listBaseTemplate===o.default.genericList){var s={key:A,automationId:"CreateRuleCommand",name:h.default.CreateRuleCommandLabel,iconProps:{iconName:"Add"},action:r.createElement(u.LaunchManageRulesAction,null),engagement:{name:"Automate.ListRules.Create",isIntentional:!0}},a={key:O,automationId:"ManageRulesCommand",name:h.default.ManageRulesCommandLabel,iconProps:{iconName:"EditNote"},action:r.createElement(u.LaunchManageRulesAction,{openManagementPanel:!0}),engagement:{name:"Automate.ListRules.Manage",isIntentional:!0}};i.push(s);i.push(a)}if(c.isFeatureEnabled(c.AutomateMenuNewLayout)&&c.isFeatureEnabled(c.ChangeFlowToAutomate)){if(!S.shouldDisplayIntegrateCommand(null==e?void 0:e.listBaseTemplate)&&!x.isNucleusOfflineState()){var f=P(e);i.push(f)}t&&i.push(m.aibuilderCommand)}else{var l=H(e);i=n.__spreadArrays(i,l)}return i})(w,j),$=v.flowSetKeyFacet.serialize(N),J=e.demandItemFacet(v.allowLoadAllFlowsFacet,E.odspNextAppItemKey),K=c.isFeatureEnabled(c.ProcessSimple)?J?M?M(e,{key:N,isDocumentLibrary:!!C,pageContext:w,staticFlowCommands:V}):{commands:V,isResolved:!!_}:{commands:V,isResolved:!0}:{commands:[],isResolved:!0},Q=K.commands,G=K.isResolved,Y=Number(w.webTemplate)===s.default.mySite,Z=B&&B(e,{key:N,flowSetKey:$,isODB:Y,pageContext:w}),ee=e.dispatch,te=function(){ee(g.asBatch(function(){var e;Z&&Z.onMenuOpened();ee(y.resolveItems({items:(e={},e[E.odspNextAppItemKey]=n.__assign({},v.allowLoadAllFlowsFacet.pack(!0)),e)}))}));ee(b.forceStoreUpdate())},ne=function(){ee(g.asBatch(function(){var e;Z&&Z.onMenuDismissed();ee(y.resolveItems({items:(e={},e[E.odspNextAppItemKey]=n.__assign({},v.allowLoadAllFlowsFacet.pack(!1)),e)}))}))};return n.__assign(n.__assign(n.__assign({},p.getFlowCommandTemplate()),{subMenuProps:n.__assign({items:Q},_?{onMenuOpened:Z&&Z.onMenuOpened,onMenuDismissed:Z&&Z.onMenuDismissed}:{})}),_?{}:{postProcess:function(e){var t=e.subMenuProps;return n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},t||{}),{onMenuOpened:te,onMenuDismissed:ne,items:G&&J&&t&&t.items||[]})})}})}};function P(e){var t=H(e);return{key:M,name:h.default.PowerAutomateCommandLabel,iconProps:{iconName:"PowerAutomateLogo"},subMenuProps:{items:t}}}t.getPowerAutomateCommand=P;function H(e){var t=[{key:N,automationId:"AddFlowCommand",name:h.default.AddFlow,action:r.createElement(l.AddFlowAction,null)},{key:k,automationId:"ExistingFlowsCommand",name:h.default.ExistingFlows,action:r.createElement(l.ShowExistingFlowsAction,null)},{key:L,automationId:"SetUpApprovalFlowCommand",name:h.default.setUpApprovalFlow,action:r.createElement(l.SetUpApprovalFlowAction,null)}],n=Number(e.webTemplate)===s.default.mySite;c.isFeatureEnabled(c.RequestSignOffSwitch)&&e&&e.listBaseTemplate!==o.default.webPageLibrary&&!n&&t.push({key:C,automationId:"ConfigureFlowsCommand",name:h.default.ConfigureFlows,action:r.createElement(l.LaunchConfigureFlowsPanelAction,null)});return t}});
define("BZe",["require","exports","ww","tc","jo","Mie","$_","R3","Je","yie","Tb"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFlowCommandSubMenuProps=void 0;var c=a.default.isActivated("E91D3604-01E2-4BBF-9444-596B07A532FC","5/27/2020","Show Flow menu only when populated");t.getFlowCommandSubMenuProps=function(e,t){var a=e.dispatch,h=t.key,p=t.flowSetKey,d=t.isODB,v=t.pageContext;return{onMenuOpened:function(){var e,t;s.FlowWidgetProvider2.preloadSdk(d?f.HostId.ODB:f.HostId.SPO,v);var i=new o.ItemResolver;c&&i.resolveItems({items:(e={},e[l.odspNextAppItemKey]=n.__assign({},u.allowLoadAllFlowsFacet.pack(!0)),e)});var m=u.flowTemplateSetKeyFacet.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl});i.invalidateItems({items:(t={},t[p]=[r.childItemsFacet],t[m]=[r.childItemsFacet],t)});a(i.execute())},onMenuDismissed:function(){var e;c&&a(i.resolveItems({items:(e={},e[l.odspNextAppItemKey]=n.__assign({},u.allowLoadAllFlowsFacet.pack(!1)),e)}))}}}});
define("Met",["require","exports","ww","tc","$_","R3","Tb","jo"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPowerBICommandSubMenuProps=void 0;t.getPowerBICommandSubMenuProps=function(e,t){var a=e.dispatch,f=t.powerBISetKey;return{onMenuOpened:function(){var e,t,u=new i.ItemResolver;u.resolveItems({items:(e={},e[o.odspNextAppItemKey]=n.__assign({},s.allowLoadAllReportsFacet.pack(!0)),e)});u.invalidateItems({items:(t={},t[f]=[r.childItemsFacet],t)});a(u.execute())},onMenuDismissed:function(){var e;a(u.resolveItems({items:(e={},e[o.odspNextAppItemKey]=n.__assign({},s.allowLoadAllReportsFacet.pack(!1)),e)}))}}}});
define("jZe",["require","exports","ww","r","Ng","_p","qi","QJe","Vs","tc","fB","mz","R3","VZe","Bc","Gi","yS","bv","fv","Je","JJe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadAllFlows=void 0;var E=new o.Facet("flowInstance").id,S=b.default.isActivated("ff312379-d00f-4a6b-88e5-bece529c9b72","08/19/2020","Compute isTeamSiteInODB boolean"),x={name:"-",key:"divider_1",itemType:s.ContextualMenuItemType.Divider},T={name:"-",key:"divider_2",itemType:s.ContextualMenuItemType.Divider},N=function(e){var t=e.id||e.templateName;return{key:E+"-"+t,automationId:"FlowInstanceCommand",name:e.displayName,action:r.createElement(i.ShowOnlyWithSelection,null,r.createElement(u.TriggerFlowAction,{flow:e}))}};t.loadAllFlows=function(e,t){var i=t.staticFlowCommands,s=t.isDocumentLibrary,o=t.pageContext,h=a.getCurrentItemSetKey(e),p=e.demandItemFacet(f.schemaFacet,h),y=!S&&w.computeIsTeamSiteInODB(e,o)?[]:(function(e,t){var n=[];if(l.isFeatureEnabled(l.DynamicFlowDates)&&t){for(var i=[],s=0,o=t.columnKeys;s<o.length;s++){var a=o[s],f=e.demandItemFacet(v.mappedColumnFieldTypeFacet,a),h=e.demandItemFacet(d.displayNameFacet,a)||"",p=e.demandItemFacet(v.isCalculatedFacet,a),y=e.demandItemFacet(v.internalNameFacet,a)||"";f!==m.ColumnFieldType.DateTime||p||"Modified"===y||"Created"===y||i.push({key:A+"_"+y,automationId:"RemindMeColumnCommand_"+y,name:h,action:r.createElement(u.SetUpReminderFlowAction,{columnName:y,columnDisplayName:h})})}if(i.length>0){var b={key:L,automationId:"RemindMeCommand",name:c.default.remindMeCommandName,subMenuProps:{items:i,onMenuOpened:function(){g.Engagement.logData({name:"FlowSetAReminder.Expanded"})}}};n.push(b)}}return n})(e,p);if(b.default.isActivated("A26EFE07-F4E2-4260-A720-FA3D234A0650","10/29/2020","Fold FlowForLibraries and SPOFlowIntegration into ProcessSimple feature")){D=!0;if(l.isFeatureEnabled(l.FlowForLibraries)&&s||!s&&l.isFeatureEnabled(l.SPOFlowIntegration)){P=[];var E=M(e,t);B=E.flowInstances;E.isResolved||(D=!1);if(l.isFeatureEnabled(l.AutomateMenuCreateSubsections)){var O=n.__spreadArrays(y),_=[];B.forEach(function(e){k(e)?O.push(N(e)):_.push(N(e))});C(O);C(_);P=O.concat(x,_,T,i)}else{for(I=0,q=n.__spreadArrays(y);I<B.length;I++)q.push(N(B[I]));C(q);q.push(x);P=q.concat(i)}return{commands:P,isResolved:D}}return{commands:i,isResolved:D}}var D=!0,P=[],H=M(e,t),B=H.flowInstances;H.isResolved||(D=!1);if(l.isFeatureEnabled(l.AutomateMenuCreateSubsections)){var j=n.__spreadArrays(y),F=[];B.forEach(function(e){k(e)?j.push(N(e)):F.push(N(e))});C(j);C(F);P=j.concat(x,F,T,i)}else{for(var I=0,q=n.__spreadArrays(y);I<B.length;I++)q.push(N(B[I]));C(q);q.push(x);P=q.concat(i)}return{commands:P,isResolved:D}};function C(e){e.sort(function(e,t){var n=e.name?e.name.toLowerCase():"",r=t.name?t.name.toLowerCase():"";return n===r?0:n>r?1:-1})}function k(e){var t,n=null===(t=e.categoryNames)||void 0===t?void 0:t.indexOf("OOB_CURRENT");n=n||-1;return"FromTemplate"===e.provisioningMethod||n>=0}var L=new o.Facet("remindMe").id,A=new o.Facet("remindMeColumn").id;function O(e,t,n,r){var i=[],s=e.demandItemFacet(f.childItemsFacet,r),o=e.isItemFacetResolved(f.childItemsFacet,r);s&&s.itemKeys&&s.itemKeys.forEach(function(t){var r=e.demandItemFacet(n,t);r&&i.push(r)});return{results:i,isResolved:o}}function M(e,t){var r=t.key,i=t.flowProcessor,s=h.flowSetKeyFacet.serialize(r),o=O(e,0,p.flowItemFacet,s),u=o.results,a=o.isResolved,f=h.flowTemplateSetKeyFacet.serialize(r),l=O(e,0,p.flowTemplateItemFacet,f),c=l.results,d=l.isResolved,v=a&&d,m=Number(t.pageContext.webTemplate)===y.default.mySite;return{flowInstances:i.buildDisplayedFlowsInstances(u.map(function(e){return n.__assign({},e)}),c,m),isResolved:v}}});
define("Pet",["require","exports","ww","r","_p","qi","Fet","Uet","tc","Tet","ov"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadAllReports=void 0;var c=new s.Facet("powerBIReport").id,h={name:"-",key:"divider",itemType:i.ContextualMenuItemType.Divider},p=function(e,t){var n=t.reportId+t.groupId;return{key:c+"-"+n,automationId:"PBIReportCommand",name:t.displayName,action:r.createElement(o.OpenReportAction,{itemKey:e,report:t})}},d=function(e){return{key:"NoReports",automationId:"NoPBIReportCommand",name:l.default.NoReportsCommandLabel,isPermanent:!0,action:r.createElement(u.NoReportAction,{itemKey:e})}};t.loadAllReports=function(e,t){var r=t.staticCommands,i=t.spItemKey,s=!0,o=[],u=(function(e,t){var n=t.powerBISetKey,r=(function(e,t,n,r){var i=[],s=e.demandItemFacet(a.childItemsFacet,r),o=e.isItemFacetResolved(a.childItemsFacet,r);s&&s.itemKeys&&s.itemKeys.forEach(function(t){var r=e.demandItemFacet(n,t);r&&i.push(r)});return{results:i,isResolved:o}})(e,0,f.powerBIReportFacet,n),i=r.results,s=r.isResolved;return{reports:i,isResolved:s}})(e,t),l=u.reports;u.isResolved||(s=!1);var c=n.__spreadArrays(r),v=[];l.forEach(function(e){v.push(p(i,e))});v.sort(function(e,t){var n=e.name?e.name.toLowerCase():"",r=t.name?t.name.toLowerCase():"";return n===r?0:n>r?1:-1});o=c.concat(h,v);0===l.length&&o.push(d(i));return{commands:o,isResolved:s}}});
define("ket",["require","exports","r","Net","Ow","ov","Ret","R3","Tb","Pet","Met","Ow"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPowerBICommand=void 0;t.getPowerBICommand=function(e,t){var h=o.getMetaData(e,t),p=h.canShow,d=h.pageContext,v=h.listKey;if(p&&d&&v){var m=(function(e){var t=[],i={key:"CreatePBIReport",automationId:"NewReportCommand",name:s.default.CreateReportCommandLabel,action:n.createElement(r.NewReportAction,{itemKey:e}),engagement:{name:"CreateReport",isIntentional:!0}};t.push(i);return t})(t),g=u.powerBISetKeyFacet.serialize({webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl,pbiApiRootUrl:c.getServiceConfigSetting("ExternalService_powerbiapibaseurl"),siteId:d.siteId,listId:d.listId}),y=e.demandItemFacet(u.allowLoadAllReportsFacet,a.odspNextAppItemKey),b=(function(){if(!i.isFeatureEnabled(i.PowerBIIntegration)||!c.getServiceConfigSetting("ExternalService_powerbihostname"))return{commands:[],isResolved:!0};if(!y)return{commands:m,isResolved:!0};var n={key:v,spItemKey:t,powerBISetKey:g,staticCommands:m};return f.loadAllReports?f.loadAllReports(e,n):{commands:m,isResolved:!1}})().commands,w=l.getPowerBICommandSubMenuProps&&l.getPowerBICommandSubMenuProps(e,{key:v,powerBISetKey:g});return{key:"PBICommandKey",automationId:"PowerBICommand",name:s.default.PowerBICommandMenuLabel,iconProps:{iconName:"PowerBILogo"},engagement:{name:"PowerBICommand",isIntentional:!0},subMenuProps:{items:b,onMenuOpened:w&&w.onMenuOpened,onMenuDismissed:w&&w.onMenuDismissed}}}}});
define("Oet",["require","exports","ww","wet","iZ","Pg","id","kJe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveForLaterCommand=t.SaveForLaterCoachmarkCommand=void 0;t.SaveForLaterCoachmarkCommand=r.createCoachmarkCommand(i.SAVE_FOR_LATER_COMMAND,function(e){return u.hasNoSavedItemsForLater(e)});t.saveForLaterCommand=n.__assign(n.__assign({},s.followCommand),{commandBarButtonAs:o.defaultRenderComponentOption().merge(t.SaveForLaterCoachmarkCommand,s.followCommand.commandBarButtonAs)})});
define("pet",["require","exports","r","qi","Ng","met","ov","Je"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.scheduleCommand=void 0;var a=u.default.isActivated("b58a6d2d-20a9-4cf2-be8f-cd6c5a1cdd3b","7/14/2020","localize Scheduling string");t.scheduleCommand={key:new r.Facet("SchedulingCommand").id,automationId:"schedulingCommand",name:a?"Scheduling":o.default.Scheduling,action:n.createElement(i.HideWithSelection,null,n.createElement(s.SchedulingAction,null)),iconProps:{iconName:"DateTime2"}}});
define("xet",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getIconStyles=void 0;t.getIconStyles=function(){return{root:{selectors:{".ms-Icon":{fontWeight:600},".ms-Button-icon":{width:14,height:14,fontSize:14,lineHeight:14},".ms-Button-menuIcon":{marginTop:1}}}}}});
define("Cet",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPrimaryStyles=t.getBaseStyles=void 0;t.getBaseStyles=function(){return{root:{padding:0,backgroundColor:"transparent",margin:"0px 8px",selectors:{".ms-Button-label":{fontWeight:600},".ms-Fabric--isFocusVisible &:focus::after":{left:3,top:9,bottom:9,right:3}}},flexContainer:{height:32,paddingLeft:12,paddingRight:12,borderRadius:2},rootHovered:{backgroundColor:"transparent",selectors:{".ms-Button-label":{fontWeight:600},".ms-Button-menuIcon":{backgroundColor:"transparent"}}},rootPressed:{backgroundColor:"transparent"},rootExpanded:{backgroundColor:"transparent"},rootExpandedHovered:{backgroundColor:"transparent",selectors:{".ms-Button-menuIcon":{backgroundColor:"transparent"}}}}};t.getPrimaryStyles=function(e){var t=e.theme;return{root:{selectors:{".ms-Button-label":{color:t.semanticColors.primaryButtonText},".ms-Icon":{color:t.semanticColors.primaryButtonText},".ms-Fabric--isFocusVisible &:focus::after":{outline:"1px solid "+t.semanticColors.primaryButtonText}}},flexContainer:{backgroundColor:t.palette.themePrimary},rootHovered:{selectors:{".ms-Button-flexContainer":{backgroundColor:t.palette.themeDarkAlt},".ms-Icon":{color:t.semanticColors.primaryButtonText}}},rootPressed:{selectors:{".ms-Button-flexContainer":{backgroundColor:t.palette.themeDark},".ms-Icon":{color:t.semanticColors.primaryButtonText}}},rootExpanded:{selectors:{".ms-Button-flexContainer":{backgroundColor:t.palette.themePrimary},".ms-Button-icon":{color:t.semanticColors.primaryButtonText},".ms-Button-menuIcon":{color:t.semanticColors.primaryButtonText}}},rootExpandedHovered:{backgroundColor:"transparent",selectors:{".ms-Button-flexContainer":{backgroundColor:t.palette.themeDarkAlt},".ms-Button-icon":{color:t.semanticColors.primaryButtonText},".ms-Button-menuIcon":{color:t.semanticColors.primaryButtonText}}}}}});
define("Iet",["require","exports","ww","r","ld","pc","Cet","xet"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PrimaryNewButton=void 0;t.PrimaryNewButton=function(e){var t=e.defaultRender,a=n.__rest(e,["defaultRender"]),f=i.getTheme();return t?r.createElement(t,n.__assign({},a,{className:s.css("spo--primaryNewButton",e.className),styles:i.concatStyleSets(o.getBaseStyles(),o.getPrimaryStyles({theme:f}),u.getIconStyles())})):null}});
define("z$e",["require","exports","ww","tc","G$e","Qi","Gi","cc","yo","tC"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.onUploadCompletedHelper=void 0;t.onUploadCompletedHelper=function(e,t,l){var c=this;return function(h){return n.__awaiter(c,void 0,void 0,function(){var c,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:return t?[4,h(f.demandItems(function(e){e.demandItemFacet(r.childItemsFacet,t)}))]:[3,2];case 1:n.sent();v=h(u.readItems(function(e){var n=[];c=e.demandItemFacet(s.spFolderItemSetKeyFacet,t);p=s.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:c});d=e.demandItemFacet(r.childItemsFacet,p);if(l&&l.itemsScopeItemKey&&d&&d.itemKeys)for(var i=0,u=d.itemKeys;i<u.length;i++){var a=u[i],f=e.demandItemFacet(o.missingMetadataFieldsFacet,a);for(var h in f)if(f.hasOwnProperty(h)){n.push(a);break}}return n}));if(l&&l.itemsScopeItemKey&&d&&d.itemKeys&&v&&v.length>0){h(a.selectItems({itemsScopeItemKey:l.itemsScopeItemKey,selectedItemKeys:v,currentSelectionKey:void 0}));e.resources.consumeAsync(i.resourceKey).then(function(e){e(!0)})}n.label=2;case 2:return[2]}})})}}});
define("let",["require","exports","Te","K9","EM","M0","uet","Je","NT"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendContextMenuOpenFileCommand=t.getExtendedCommandsWithFileHandlers=void 0;var f=!u.default.isActivated(o.SHOW_FILEHANDLER_COMMANDS_FIRST,"7/5/2019","Show file handler commands before OOB commands");function l(e,t){var s=new n.SimpleUri(t).authority,o=r.driveAppsKeyFacet.serialize({endpoint:s});return i.getFileHandlerCommands(e,{itemKey:o})}t.getExtendedCommandsWithFileHandlers=function(e,t,n){return(function(e,t){return e.map(function(e){return e.key===s.openCommand.key?o.getOpenFileCommandWithHandler(t,f):e})})(n,l(e,t))};t.extendContextMenuOpenFileCommand=function(e,t,n){var r=n.key,s=l(e,t);if(r===a.openFileCommand.key){var o=s&&s.open||[];o.length>0&&a.openFileCommandForContextMenu.subMenuProps&&(a.openFileCommandForContextMenu.subMenuProps.items=i.mergeFileHandlerCommands(a.openFileCommandForContextMenu.subMenuProps.items,o,f));return a.openFileCommandForContextMenu}return n}});
define("fet",["require","exports","ww","tXe","Fx","M8","$s"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharedNavigationCommands=void 0;t.getSharedNavigationCommands=function(e,t){var u=e.demandItemFacet(s.sharedByMeRootItemKeyFacet,t),a=e.demandItemFacet(i.sharedWithMeRootItemKeyFacet,t);if(!u&&!a)return[];var f=n.__assign(n.__assign({},r.NavigateToSharedByMeCommand),{className:u?"is-pivot is-current-view":"is-pivot"}),l=n.__assign(n.__assign({},r.NavigateToSharedWithMeCommand),{className:a?"is-pivot is-current-view":"is-pivot"}),c=o.getSelectedItemKeys(e);return c&&0!==c.length?[]:[l,f]}});
define("oet",["require","exports","ww","kb","Tb","oZe","tXe","Bet","Gi","YT","Qi","my","T0","M0","D0","x0","Kg","p0","Pg","o0","Zg","fv","zi","jJe","Let","Oet","t8","fB","dv","r7","qP","fU","_p","Je","Fx","M8","LGe","_et","NT","_y","o7","pet","Ny","iXe","fet","let","z0","dv","zJe","det","set","NJe","HJe","VJe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedItemsCommandBarControlHandler=void 0;t.extendedItemsCommandBarControlHandler=r.createControlHandler()(function(){return function(e){return ee}});function ee(e,t){var r=t.itemKey,i=t.commands,u=t.farCommands,f=t.overflowCommands,h=L.isTeamsWebView(),p=A.isCrossOrigin(),d=h||p,v=e.demandItemFacet(l.spItemKeyFacet,r),m=e.demandItemFacet(c.savedForLaterRootItemKeyFacet,r),g=e.demandItemFacet(P.sharedWithMeRootItemKeyFacet,r),y=e.demandItemFacet(H.SharedByMeRootItemKeyFacet,r),b=e.demandItemFacet(I.recentRootItemKeyFacet,r),w={commands:i,hostedInTeamsDesktop:h,hostedCrossOrigin:p,itemCache:e,overflowCommands:f};if(v){var N=e.demandItemFacet(a.spPageContextFacet,l.spPageContextKeyFacet.serialize({webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl})),C=N&&N.webTemplate,k=N&&N.listBaseTemplate,O=Number(C)===E.WebTemplateType.mySite,_=Number(k)===S.ListTemplateType.contentCenterModelLibrary,B=Number(k)===S.ListTemplateType.contentCenterModelUsageList,R=Z.getListSyntexContext(e).isMachineLearningCaptureEnabled,U={webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl},z=l.spListKeyFacet.serialize(U),X=e.demandItemFacet(a.listFacet,z),V=!!X&&!!X.isDocumentLibrary,$=!!X&&X.allowCreateFolder,K=!!X&&X.permissions,Q=x.getFlowCommand(e,r),G=T.getIntegrateCommand(e,r);if(i&&i.length>0&&i[0].key===M.exitQuickEditCommand.key){if(D.default.isActivated("86CDDB78-0503-4987-9214-48BC92A7E039","8/1/2019","Allow more commands in command bar in quick edit"))return n.__assign({farCommands:[o.filtersPaneCommand]},ae(e,t));var Y=ie(F.openFileCommand);return j.getQuickEditCommands(e,{itemKey:r,listKey:U,pageContext:N,isDocumentLibrary:V,extraCommands:{flowCommand:Q,openCommand:Y,integrateCommand:J.shouldDisplayIntegrateCommand(k)?G:void 0}})}var ee=i?ne(e,{defaultCommands:i||[],isODB:O,isDocumentLibrary:V,isContentCenterModelLibrary:_,isContentCenterModelUsageList:B,isMachineLearningCaptureEnabled:R,allowCreateFolder:$,hosted:d,hostedCrossOrigin:p,hostedInTeamsDesktop:h,listTemplate:k}):[];!Q||_||B||ee.push(Q);G&&J.shouldDisplayIntegrateCommand(k)&&ee.push(G);var re=se(e,{farCommands:u,isDocumentLibrary:V,canModifySchema:!!(K&&!(!K.manageLists&&!K.managePersonalViews)),hosted:d,isOdb:O}),fe=(function(e,t){var r=t.overflowCommands,i=void 0===r?[]:r,u=t.isODB,a=t.isDocumentLibrary,f=t.hostedCrossOrigin,l=t.hostedInTeamsDesktop;if(!i)return[];var c=[];if(u||f&&l)c=n.__spreadArrays([s.versionHistoryCommand],i);else{c=f&&!l?[s.versionHistoryCommand,s.manageAlertCommand]:l&&!f?[s.versionHistoryCommand,s.alertMeCommand]:[s.versionHistoryCommand,s.alertMeCommand,s.manageAlertCommand];a&&c.push(o.makeHomePageCommand);c=c.concat(i)}return c})(0,{overflowCommands:f,isODB:O,isDocumentLibrary:V,hostedCrossOrigin:p,hostedInTeamsDesktop:h});if(O){var le=q.buildSortCommand(e,{itemKey:r});re.unshift(le)}return n.__assign({commands:ue(ee),farCommands:ue(re),overflowCommands:ue(fe)},ae(e,t))}if(m)return n.__assign(n.__assign({},oe(e,n.__assign({endpoint:m.endpoint},w))),ae(e,t));if(g){var ce,he=[];he=te(e,{endpoint:g.endpoint,payload:{defaultCommands:i||[],isODB:!0,isSharedTab:!0,isDocumentLibrary:!0,isContentCenterModelLibrary:!1,isContentCenterModelUsageList:!1,isMachineLearningCaptureEnabled:!1,allowCreateFolder:!1,hosted:h||p,hostedCrossOrigin:p,hostedInTeamsDesktop:h,isSavedForLaterPivot:!1},itemKey:r});var pe=W.getSharedNavigationCommands(e,r);ce=n.__spreadArrays(pe,he);re=se(e,{farCommands:u,isDocumentLibrary:!0,canModifySchema:!1,hosted:d,isOdb:!0});return n.__assign({commands:ce,farCommands:re,overflowCommands:[]},ae(e,t))}if(y){var de;he=[];he=te(e,{endpoint:y.tenantRootUrl,payload:{defaultCommands:i||[],isODB:!0,isSharedTab:!0,isDocumentLibrary:!0,isContentCenterModelLibrary:!1,isContentCenterModelUsageList:!1,isMachineLearningCaptureEnabled:!1,allowCreateFolder:!1,hosted:h||p,hostedCrossOrigin:p,hostedInTeamsDesktop:h,isSavedForLaterPivot:!1},itemKey:r});re=se(e,{farCommands:u,isDocumentLibrary:!1,canModifySchema:!0,hosted:d,isOdb:!0}),pe=W.getSharedNavigationCommands(e,r);de=n.__spreadArrays(pe,he);return n.__assign({commands:de,farCommands:re,overflowCommands:[]},ae(e,t))}if(b){var ve=b.endpoint;return n.__assign(n.__assign({},oe(e,n.__assign({endpoint:ve},w))),ae(e,t))}return n.__assign({},ae(e,t))}function te(e,t){var n,r=t.endpoint,i=t.payload;n=i.defaultCommands?ne(e,i):[];return X.getExtendedCommandsWithFileHandlers(e,r,n)}function ne(e,t){var r=[],i=t.isODB,u=t.isSharedTab,a=t.isDocumentLibrary,l=t.isContentCenterModelLibrary,c=t.isContentCenterModelUsageList,m=t.isMachineLearningCaptureEnabled,E=t.hostedCrossOrigin,S=t.defaultCommands,x=t.hosted,T=t.hostedInTeamsDesktop,L=t.allowCreateFolder,A=t.isSavedForLaterPivot,M=t.listTemplate;i||(a?E||r.push(o.cancelEditCommand):E?r.push(o.EditItemCommand):r.push(o.cancelEditCommand,o.EditItemCommand));for(var _=0,D=S;_<D.length;_++){var P=D[_];if(P.key===h.newCommand.key)(Z.isCheckSharePointSyntexLicenseKillSwitchActivated||!l||m)&&r.push(re(P,!!a,!!l,!!L,i));else if(P.key===d.copyLinkCommand.key){r.push(d.copyLinkCommand);i&&r.push(o.FileRequestCommand)}else if(P.key===p.openCommand.key)r.push(ie(P));else if(P.key===g.downloadCommand.key&&k.isFeatureEnabled(k.TeamChannelFolder)){r.push(P);r.push(o.TeamChannelCommand);r.push(o.runModelCommand)}else if(P.key!==g.downloadCommand.key||k.isFeatureEnabled(k.TeamChannelFolder))if(P.key===y.followCommand.key&&U.isSavedForLaterEnabled())r.push(N.saveForLaterCommand);else if(P.key===f.exportListCommand.key)T||(k.isFeatureEnabled(k.CommandBarBrandIcons)?r.push(f.exportListCommandBrandIcon):r.push(P));else if(P.key===v.uploadCommand.key){var H=P;k.isFeatureEnabled(k.ShimSharePointUploader)||(H=n.__assign(n.__assign({},H),{subMenuProps:n.__assign(n.__assign({},H.subMenuProps),{items:[o.UploadFileCommand,o.UploadFolderCommand]})}));H.subMenuProps&&H.subMenuProps.items&&H.subMenuProps.items.length>0&&H.subMenuProps.items[H.subMenuProps.items.length-1].key!==O.UploadTemplateCommand.key&&!i&&a&&(H=n.__assign(n.__assign({},H),{subMenuProps:n.__assign(n.__assign({},H.subMenuProps),{items:n.__spreadArrays(H.subMenuProps.items,[O.UploadTemplateCommand])})}));r.push(H)}else if(A&&U.isSavedForLaterEnabled()){var j=P.key===b.renameCommand.key,F=P.key===w.deleteCommand.key,I=P.key===z.fileRequestCommand.key;j||F||I||r.push(P)}else r.push(P);else r.push(o.runModelCommand)}if(i)if(u)r.push(o.addToOneDriveCommand);else{r.push(o.quickEditCommand);k.isFeatureEnabled(k.UseItemsScopeMoveCopy)?r.push(G.launchMovePickerCommand,Y.launchCopyPickerCommand):r.push(o.moveToCommand,o.copyToCommand)}else if(a){if(!E){r.push(o.quickEditCommand);B.default.arePowerAppsFormsEnabled()&&r.push(s.powerAppsCommand)}k.isFeatureEnabled(k.UseItemsScopeMoveCopy)?r.push(G.launchMovePickerCommand,Y.launchCopyPickerCommand):r.push(o.moveToCommand,o.copyToCommand);r.push(o.AddToQuickLaunchCommand);k.isFeatureEnabled(k.WexSitePagesScheduling)&&r.push(R.scheduleCommand)}else{E||(J.shouldDisplayIntegrateCommand(M)?r.push(o.quickEditCommand):r.push(o.quickEditCommand,s.powerAppsCommand));k.isFeatureEnabled(k.UseItemsScopeMoveCopy)?r.push(G.launchMovePickerCommand):r.push(o.moveToCommand);x&&r.push(o.OpenInSharePointCommand)}l?r=r.filter(function(e){return e.key!==C.syncCommand.key&&e.key!==o.quickEditCommand.key&&e.name!==o.quickEditCommand.name&&e.key!==s.powerAppsCommand.key&&e.key!==f.exportListCommand.key&&e.key!==s.aibuilderCommand.key}):c&&(r=[]);return r}function re(e,t,r,i,s){if(e.key!==h.newCommand.key)return e;if(t){if(r)return u.contentCenterCreateModelCommand;if($.isOneDriveWinApp()&&k.isFeatureEnabled(k.UseItemsScopeInODApp)&&e.subMenuProps)return n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},e.subMenuProps),{items:[V.createFolderCommand]})});if(e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key!==O.AddTemplateCommand.key)return n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},e.subMenuProps),{items:n.__spreadArrays(e.subMenuProps.items,[o.CreateShortcutCommand],s?[]:[{name:"-",key:"divider_2",itemType:_.ContextualMenuItemType.Divider},o.EditNewMenuCommand,O.AddTemplateCommand])})})}else if(e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key===f.createListItemCommand.key&&e.subMenuProps.items.length<=2&&!i)return{key:e.key,action:f.createListItemCommand.action,iconProps:e.iconProps,name:e.name};return e}function ie(e){return e.key!==p.openCommand.key?e:e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key!==o.OpenInPowerBICommand.key&&n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},e.subMenuProps),{items:n.__spreadArrays(e.subMenuProps.items,[o.OpenInTextEditorCommand,o.OpenInPowerBICommand])})})||e}function se(e,t){for(var r=t.farCommands,s=void 0===r?[]:r,u=t.isDocumentLibrary,a=t.canModifySchema,f=t.hosted,l=t.isOdb,c=e.demandItemFacet(i.nucleusOfflineFacet,i.odspNextAppItemKey),h=[],p=0,d=s;p<d.length;p++){var v=d[p];if(v.key===m.switchLayoutCommand.key){var g=v.subMenuProps?n.__spreadArrays(v.subMenuProps.items):[];if(u&&v.subMenuProps&&v.subMenuProps.items)for(var y=0,b=0,w=g;b<w.length;b++){if("tilesListCommand"===w[b].automationId&&(!g[y+1]||g[y+1].key!==o.OpenInExplorerCommand.key)){g.splice(y+1,0,o.OpenInExplorerCommand);break}y++}h.push(n.__assign(n.__assign({},v),{subMenuProps:n.__assign(n.__assign({},v.subMenuProps),{items:v.subMenuProps&&(a&&!c?n.__spreadArrays(g,[o.launchFormatViewPaneCommand]):n.__spreadArrays(g))||[o.launchFormatViewPaneCommand]})}))}else h.push(v)}h.push(o.filtersPaneCommand,o.detailsCommand);!k.isFeatureEnabled(k.SPListLightSpeed)||!e.demandItemFacet(i.isLightspeedAppFacet,i.odspNextAppItemKey)||f||l||L.isWebViewHosted()||h.push(o.fullscreenCommand);return h}function oe(e,t){var r=t.endpoint,i=t.commands,o=t.hostedInTeamsDesktop,u=t.hostedCrossOrigin,a=t.overflowCommands,f=[],l=[];f=i?ne(0,{defaultCommands:i||[],isODB:!0,isDocumentLibrary:!0,allowCreateFolder:!1,hosted:o||u,hostedCrossOrigin:u,hostedInTeamsDesktop:o,isSavedForLaterPivot:!0}):[];f=X.getExtendedCommandsWithFileHandlers(e,r,f);u&&o&&(l=a?n.__spreadArrays([s.versionHistoryCommand],a):[s.versionHistoryCommand]);return{commands:f,farCommands:[],overflowCommands:l}}function ue(e){if(!e||!e.length)return e;for(var t=[],n={},r=0,i=e;r<i.length;r++){var s=i[r];if(!n[s.key]){t.push(s);n[s.key]=!0}}return t}function ae(e,t){var n=t.shortcutCommands,r=[];if(n)for(var i=0,s=n;i<s.length;i++){var o=s[i];o.key===K.getNPSSurveyFocusShortcut.key||r.push(o)}r.push(Q.focusFloodgateShortcutCommand);return{shortcutCommands:r}}});
define("FJe",["require","exports","ww","tXe","D0","M0","Zg","UT","ET","kb","r7","jJe","fB","Ow","zi","mz","Qi","M8","Gi","BJe","dv","Gp","Tb","NJe","HJe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedItemsContextMenuControlHandler=void 0;t.extendedItemsContextMenuControlHandler=f.createControlHandler()(function(){return function(e){return C}});var N=new E.PlatformDetection;function C(e,t){var f=0,E=t.itemKey,C=e.demandItemFacet(m.spItemKeyFacet,E),k=e.demandItemFacet(g.SharedByMeRootItemKeyFacet,E),L=e.demandItemFacet(S.nucleusOfflineFacet,S.odspNextAppItemKey);if(C){var A={webAbsoluteUrl:"",listFullUrl:""};C&&(A={webAbsoluteUrl:C.webAbsoluteUrl,listFullUrl:C.listFullUrl});var O=m.spListKeyFacet.serialize(A),M=e.demandItemFacet(y.listFacet,O),_=!!M&&!M.isDocumentLibrary,D=!1,P=!1;if(M){D=M.templateType===d.default.publishingAsset;P=M.templateType===d.default.mySiteDocumentLibrary}var H=e.demandItemFacet(y.spPageContextFacet,m.spPageContextKeyFacet.serialize({webAbsoluteUrl:C.webAbsoluteUrl,listFullUrl:C.listFullUrl})),B=l.isCrossOrigin(),j=c.getFlowCommand(e,E),F=H&&M&&h.isFeatureEnabled(h.WexSitePagesContentApproval)&&M.templateType===d.default.webPageLibrary&&M.isModerated?n.__assign(n.__assign({},r.PublishCommand),{name:v.default.Submit}):r.PublishCommand,I=!L&&b.isManageAccessItemsScopeOn(),q=N.isMobile,R=!(null==H?void 0:H.CommentsOnListItemsDisabled)&&h.isFeatureEnabled(h.EnableActivityPaneForSPCustomList)&&h.isFeatureEnabled(h.EnableCommentsForSPCustomList);R=(R=R&&(!q||h.isFeatureEnabled(h.EnableActivityPaneInListFormForMobile)))&&(!w.isTeamsWebView()||h.isFeatureEnabled(h.EnableActivityPaneInListFormForTeamsApp));return _?{contextMenuOverride:[{command:i.copyLinkCommand,followupCommands:I?n.__spreadArrays(R?[r.CommentItemCommand,b.divider(f++)]:[],[r.copyFieldCommand,r.ManageAccessCommand,b.divider(f++)]):n.__spreadArrays(R?[r.CommentItemCommand]:[],[r.copyFieldCommand,b.divider(f++)])},{command:o.deleteCommand,followupCommands:j?[j,b.divider(f++)]:[b.divider(f++)]},{command:a.MoreCommands,beforeCommands:B||L?[h.isFeatureEnabled(p.UseItemsScopeMoveCopy)?x.launchMovePickerCommand:r.moveToCommand,b.divider(f++),r.versionHistoryCommand]:[h.isFeatureEnabled(p.UseItemsScopeMoveCopy)?x.launchMovePickerCommand:r.moveToCommand,b.divider(f++),r.captureVersionCommand,r.versionHistoryCommand,r.alertMeCommand],beforeChildrenCommands:L?[r.ComplianceDetailsCommand]:[r.WorkflowCommand,r.ComplianceDetailsCommand]},{command:null,followupCommands:[b.divider(f++),r.detailsMenuCommand],bottomCommand:!0},{command:null,followupCommands:[r.ViewItemCommand,r.EditItemCommand],topCommand:!0}]}:P?{contextMenuOverride:[{command:o.deleteCommand,followupCommands:h.isFeatureEnabled(p.UseItemsScopeMoveCopy)?[x.launchMovePickerCommand,T.launchCopyPickerCommand]:[r.moveToCommand,r.copyToCommand]},{command:i.copyLinkCommand,followupCommands:I?[r.FileRequestCommand,r.ManageAccessCommand,b.divider(f++)]:[r.FileRequestCommand,b.divider(f++)]},{command:a.MoreCommands,beforeCommands:n.__spreadArrays([b.divider(f++)],j?[j]:[],[r.versionHistoryCommand]),beforeChildrenCommands:[r.WorkflowCommand,r.ComplianceDetailsCommand],followupChildrenCommands:n.__spreadArrays(D?[r.EditRenditionsCommand]:[],[F,r.UnPublishCommand,r.CancelPublishCommand])},{command:null,followupCommands:[b.divider(f++),r.detailsMenuCommand],bottomCommand:!0},{command:s.openCommand,followupCommands:[r.previewCommand],topCommand:!0}]}:{contextMenuOverride:[{command:u.editPinnedItemCommand,followupCommands:n.__spreadArrays([r.moveToCommand,r.copyToCommand],h.isFeatureEnabled(h.SPBulkEditItemCommand)?[r.bulkEditDocumentPropertyCommand]:[])},{command:i.copyLinkCommand,followupCommands:I?[r.ManageAccessCommand,b.divider(f++)]:[b.divider(f++)]},{command:o.deleteCommand,followupCommands:j?[j,b.divider(f++)]:[b.divider(f++)]},{command:a.MoreCommands,beforeCommands:B?[b.divider(f++),r.versionHistoryCommand,r.makeHomePageCommand]:[b.divider(f++),r.captureVersionCommand,r.versionHistoryCommand,r.alertMeCommand,r.makeHomePageCommand],beforeChildrenCommands:[r.ViewDocumentPropertyCommand,r.WorkflowCommand,r.ComplianceDetailsCommand],followupChildrenCommands:n.__spreadArrays(D?[r.EditRenditionsCommand]:[],[F,r.UnPublishCommand,r.CancelPublishCommand])},{command:null,followupCommands:[b.divider(f++),r.detailsMenuCommand],bottomCommand:!0},{command:s.openCommand,followupCommands:[r.previewCommand],topCommand:!0}]}}return k?{contextMenuOverride:[{command:s.openCommand,followupCommands:[r.previewCommand],topCommand:!0},{command:i.copyLinkCommand,followupCommands:[b.divider(f++)]},{command:null,followupCommands:[b.divider(f++),r.detailsMenuCommand],bottomCommand:!0}]}:{contextMenuOverride:void 0}}});
define("BJe",["require","exports","_p","fB"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isManageAccessItemsScopeOn=t.divider=void 0;t.divider=function(e){return{name:"-",key:"breakBefore"+e.toString(),itemType:n.ContextualMenuItemType.Divider,automationId:"divider"}};t.isManageAccessItemsScopeOn=function(){return r.isFeatureEnabled(r.EnableManageAccessItemsScope)}});
define("oZe",["require","exports","hZe","mZe","fZe","dZe","GJe","sZe"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.powerBICommand=t.aibuilderCommand=t.powerAppsCommand=t.versionHistoryCommand=t.manageAlertCommand=t.alertMeCommand=void 0;Object.defineProperty(t,"alertMeCommand",{enumerable:!0,get:function(){return n.alertMeCommand}});Object.defineProperty(t,"manageAlertCommand",{enumerable:!0,get:function(){return r.manageAlertCommand}});Object.defineProperty(t,"versionHistoryCommand",{enumerable:!0,get:function(){return i.versionHistoryCommand}});Object.defineProperty(t,"powerAppsCommand",{enumerable:!0,get:function(){return s.powerAppsCommand}});Object.defineProperty(t,"aibuilderCommand",{enumerable:!0,get:function(){return o.aibuilderCommand}});Object.defineProperty(t,"powerBICommand",{enumerable:!0,get:function(){return u.powerBICommand}})});
define("RZe",["require","exports","I7","Qi","Gi","O4","ty","zi"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.launchMoveCopyPanelActionControlHandler=void 0;t.launchMoveCopyPanelActionControlHandler=function(e,t){for(var n=t.isMove,r=0,i=t.itemKeys;r<i.length;r++){if(!a(e,{itemKey:i[r],isMove:n}))return{isAvailable:!1}}return{isAvailable:!0}};function a(e,t){var a=t.itemKey,f=t.isMove,l=e.demandItem({spItem:r.spItemKeyFacet,mountPoint:i.mountPointFacet,permissions:i.permissionsFacet,itemComplianceStatus:s.itemComplianceStatusFacet},a),c=l.spItem,h=l.mountPoint,p=l.permissions,d=l.itemComplianceStatus,v=n.getPageContextFromItemCache(e,a);if(!v||!c||v.isAnonymousGuestUser)return!1;if(3===d||4===d||h||!o.PermissionMask.hasItemPermission({permissions:p},o.PermissionMask.openItems))return!1;if(f){var m=r.spListKeyFacet.serialize(c),g=e.demandItemFacet(i.listFacet,m);if(g){if(g.templateType===u.default.webPageLibrary)return!1;if(!g.isDocumentLibrary&&!g.allowCreateFolder)return!1}return o.PermissionMask.hasItemPermission({permissions:p},o.PermissionMask.editListItems)&&o.PermissionMask.hasItemPermission({permissions:p},o.PermissionMask.deleteListItems)}return!0}});
define("_et",["require","exports","ww","tXe","YT","Qi","D0","p0","fU","t8","tc","_U","Vs","M","Zg","Wg","fB","Set","vet","het","zJe","UO"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getQuickEditCommands=void 0;function S(e,t){return n.__spreadArrays([g.getQuickEditNewItemCommand(),a.getExitQuickEditCommand(e),r.EditItemCommand],m.isFeatureEnabled(m.QuickEditUndoRedo)?[y.quickEditUndoCommand,b.quickEditRedoCommand]:[],E.isNucleusOfflineState()?[]:[o.shareCommand],[o.copyLinkCommand],t?[r.CommentItemCommand]:[],E.isNucleusOfflineState()?[]:[m.isFeatureEnabled(m.CommandBarBrandIcons)?i.exportListCommandBrandIcon:i.exportListCommand],E.isNucleusOfflineState()?[]:w.shouldDisplayIntegrateCommand(null==e?void 0:e.listBaseTemplate)?[]:[r.powerAppsCommand],[d.deleteCommand])}function x(e){return n.__spreadArrays([a.getExitQuickEditCommand(e)],m.isFeatureEnabled(m.QuickEditUndoRedo)?[y.quickEditUndoCommand,b.quickEditRedoCommand]:[],[o.shareCommand,o.copyLinkCommand,f.syncCommand,u.downloadCommand,m.isFeatureEnabled(m.CommandBarBrandIcons)?i.exportListCommandBrandIcon:i.exportListCommand,d.deleteCommand,r.bulkEditDocumentPropertyCommand])}var T=E.isNucleusOfflineState()?[]:[r.alertMeCommand,r.manageAlertCommand],N=[r.ViewDocumentPropertyCommand,r.versionHistoryCommand,r.alertMeCommand,r.manageAlertCommand],C=[v.showProgressCommand,r.filtersPaneCommand],k=[v.showProgressCommand,r.filtersPaneCommand];t.getQuickEditCommands=function(e,t){var i,o,u=t.itemKey,a=t.listKey,f=t.pageContext,d=t.isDocumentLibrary,v=t.extraCommands,m=t.isCommentCommandEnabled,g=h.getCurrentItemSetKey(e),y=e.demandItemFacet(s.spItemKeyFacet,u),b=e.demandItemFacet(s.spFolderItemSetKeyFacet,g),w={webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl},E=s.spListViewsSetKeyFacet.serialize(w),L=e.demandItemFacet(l.childItemsFacet,E),A="";b&&b.viewKey&&(A=b.viewKey.viewId);!A&&f&&f.viewId&&(A=p.default.normalizeLower(f.viewId,!1));if(L&&y){var O=[];if((i=c.getViewsCommands(e,{viewKeys:L.itemKeys,webAbsoluteUrl:y.webAbsoluteUrl,listViewSetKey:w,itemSetKey:g,currentViewKey:s.spViewKeyFacet.serialize({viewId:A})}))&&i.subMenuProps&&i.subMenuProps.items){for(var M=i.subMenuProps.items,_=-1,D=0;D<M.length;D++){var P=M[D].automationId;if(P&&(0===P.indexOf("switchToFixedGridLayoutCommand")||0===P.indexOf("switchViewCommand_")||0===P.indexOf("saveCommand"))){_=D;break}}-1!==_&&(O=M.slice(_));O.push(r.launchFormatViewPaneCommand)}i=n.__assign(n.__assign({},i),{subMenuProps:n.__assign(n.__assign({},i.subMenuProps),{items:O})})}o=d?{commands:x(f),overflowCommands:N,farCommands:k}:{commands:S(f,m),overflowCommands:T,farCommands:C};v&&v.flowCommand&&(o.commands=n.__spreadArrays(o.commands,[v.flowCommand]));v&&v.integrateCommand&&(o.commands=n.__spreadArrays(o.commands,[v.integrateCommand]));v&&v.openCommand&&d&&(o.commands=n.__spreadArrays([v.openCommand],o.commands));i&&(o.farCommands=n.__spreadArrays([i],o.farCommands));v&&v.fullscreenCommand&&(o.farCommands=n.__spreadArrays(o.farCommands,[v.fullscreenCommand]));return o}});
define("o7",["require","exports","r","Gi","Qi","_p","tc","Bc","l7","d7","s7","qi","Vs"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.buildSortCommand=t.oneDriveSortCommandKey=void 0;var p="";t.oneDriveSortCommandKey=c.getNextId("oneDriveSortCommand");t.buildSortCommand=function(e,c){var d=c.itemKey,v=[],m=h.getCurrentItemSetKey(e),g=e.demandItemFacet(i.spFolderItemSetKeyFacet,m);if(m&&g){var y=e.demandItemFacet(o.sortFacet,d),b=y&&e.demandItemFacet(i.spListFieldKeyFacet,y.columnKey),w=b&&b.internalName||g.sortFieldKey||p,E=y?y.isAscending:g.sortAscending||!0,S=e.demandItemFacet(o.schemaFacet,m),x=S&&S.columnKeys;if(x)for(var T=0,N=x;T<N.length;T++){var C=N[T],k=e.demandItem({internalName:r.internalNameFacet,displayName:u.displayNameFacet,isSortable:a.isSortableFacet},C),L=k.internalName,A=k.displayName;k.isSortable&&L&&v.push({key:"sort"+C,automationId:"sort-"+L,name:A,role:"menuitemradio",action:n.createElement(l.SortAction,{itemSetKey:m,sortFieldKey:L,isAscending:E})})}v.push({name:"-",key:"divider_1",itemType:s.ContextualMenuItemType.Divider});v.push({key:"sortAsc",automationId:"sortAsc",role:"menuitemradio",name:f.default.SortAscending,title:f.default.SortAcendingCommandTooltip,action:n.createElement(l.SortAction,{itemSetKey:m,sortFieldKey:w,isAscending:!0})});v.push({key:"sortDesc",automationId:"sortDesc",role:"menuitemradio",name:f.default.SortDescending,title:f.default.SortDescendingCommandTooltip,action:n.createElement(l.SortAction,{itemSetKey:m,sortFieldKey:w,isAscending:!1})})}return{key:t.oneDriveSortCommandKey,automationId:"sortCommand",name:f.default.Sort,title:f.default.SortCommandTooltip,iconProps:{iconName:"SortLines"},subMenuProps:{items:v}}}});
define("zZe",["require","exports","ww","r","Wv","Gi","Qi","Tb","GZe","Co","u5","Hs","Dm","tC","e3","N","XE","we"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MoveCopyPickerWizard=void 0;function y(e){var t=this,i=e.pageContext,s=e.spItem,u=e.resolve,h=e.reject,m=e.onRenderMoveCopyAction,g=e.title,y=e.completeButtonText,b=r.useState(!0),w=b[0],E=b[1],S=r.useMemo(function(){return{typesAndSources:{mode:"folders",pivots:{recent:!1,search:!1,shared:!1}},selection:{mode:"pick"},entry:n.__assign({},s?{sharePoint:{byPath:{web:s.webAbsoluteUrl,list:s.listFullUrl,folder:s.rootFolder}}}:{}),commands:{pick:{label:y}},telemetry:{sessionId:null==i?void 0:i.CorrelationId},title:g}},[s,i,g,y]),x=l.useLazyActionHost(),T=x[0],N=x[1],C=d.useItemCacheDispatch(),k=f.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,i,s,a,f;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);E(!1);t=e.items[0];if(!(r=t.webDavUrl))throw new v.ApiError({code:"PickedItemMissingWebDavUrl"});i=o.spItemFullUrlKeyFacet.serialize({itemFullUrl:decodeURI(r)});return[4,C(p.demandItems(function(e){return e.demandItemFacet(o.spItemKeyFacet,i,{suppressGetItems:!1})}))];case 1:if(!(s=n.sent()))throw new v.ApiError({code:"UnableToResolvePickedItem"});a=o.spItemKeyFacet.serialize(s);return[4,N(m({itemKey:a}))];case 2:n.sent();u();return[3,4];case 3:f=n.sent();h(f);return[3,4];case 4:return[2]}})})}),L=f.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){h(new c.CancelError);return[2]})})}),A=f.useEventHandler(function(){});r.useEffect(function(){i||h(new v.ApiError({code:"MissingPageContextForFilePicker"}))},[i]);return i?r.createElement(r.Fragment,null,T,w&&i?r.createElement(a.Sdk80FilePickerHost,{app:"SPO Web",scenario:"MoveCopy",options:S,pageContext:i,onPick:k,onClose:L,onLoad:A}):null):null}t.MoveCopyPickerWizard=i.createItemCacheComponent(function(e,t){var n=t.sourceItemKeys,i=t.entryItemKey,a=t.isMove,f=t.resolve,l=t.reject,c=t.onExecuteProps,p=e.demandItemFacet(s.spPageContextFacet,u.odspNextAppItemKey),d=e.demandItemFacet(o.spItemKeyFacet,i),v=g.format(g.getLocalizedCountValue(a?m.default.MovePanelTitleFormat:m.default.CopyPanelTitleFormat,a?m.default.MovePanelTitleIntervals:m.default.CopyPanelTitleIntervals,n.length)||"",n.length),b=a?m.default.MovePanelSelectActionText:m.default.CopyPanelSelectActionText;return r.createElement(y,{resolve:f,reject:l,onExecuteProps:c,title:v,completeButtonText:b,pageContext:p,spItem:d,onRenderMoveCopyAction:function(e){return r.createElement(h.ItemMoveCopyAction,{itemKeys:n,itemKey:e.itemKey,isMove:a})}})})});
define("Q$e",["require","exports","ww","r","Zm","Tc","rh","Bx","Wv","Tb","SK","Hxe","bw","$Ve","Lxe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.knockoutResourceKey=t.resourceKey=t.ShareAfterUploadContainer=t.ShareAfterUpload=t.ShareAfterUploadBase=void 0;var v=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props.itemKey,t=p.default.shareActionText,n=e&&r.createElement(s.WithAction,{action:r.createElement(o.ItemShareAction,{itemKey:e})},function(e){var n=e.isAvailable,s=e.execute;return r.createElement(i.PrimaryButton,{disabled:!n,className:"od-Button od-Button--primary od-operationMonitor-ShareLinkButton",text:t,onClick:function(){s()}})});return r.createElement("div",{className:"od-operationMonitor-ShareLink"},n)};return t})(r.Component);t.ShareAfterUploadBase=v;t.ShareAfterUpload=a.connectToItemCache(function(e,t){var n=e.demandItemFacet(u.viewParamsToItemKeyControl,f.odspNextAppItemKey);return{itemKey:u.viewParamsToItemKeyControl.evaluate(n)(e,{viewParams:t.urlDataSource.getKeyParams(t.storeKey)}).itemKey}})(v);var m=(function(e){n.__extends(i,e);function i(){return null!==e&&e.apply(this,arguments)||this}i.prototype.render=function(){var e=this.context.dependencies.currentItemsScope;return r.createElement(e,null,r.createElement(t.ShareAfterUpload,n.__assign({},this.props)))};i.contextTypes=l.RESOLVED_COMPONENT_CONTEXT_TYPES;return i})(r.PureComponent);t.ShareAfterUploadContainer=m;t.resourceKey=l.createResolvedComponentTypeResourceKey(e("module").id,m,{itemCacheStore:h.resourceKey,currentItemsScope:c.resourceKey.local});t.knockoutResourceKey=d.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-scope-share-after-upload",name:e("module").id+".knockout"})});
define("gJe",["require","exports","ww","Aq","LZ","v","g","tg","M","kk","fe","eQ"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var h=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,n.pageContext)||this;r.extractFileName=function(e){var t=e.split("/");return t[t.length-1]};r._apiUrlHelper=n.apiUrlHelper;r._navigation=n.navigation;r._pageContext=n.pageContext;r._vroomDataRequestor=n.vroomDataRequestor;return r}t.prototype.getWebFields=function(e){var t=e+"/_api/web/fields?$select=Id,Title&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (TypeDisplayName ne 'Managed Metadata') and (Group ne '_Hidden')";return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getSiteContentTypes=function(e,t,n,r){void 0===r&&(r="Intelligent Document Content Types");var i=e.substr(0,e.indexOf(t)),s=i.replace("https://",""),o=i+"/_api/V2.0/sites/"+s+","+(n=n.replace("{","").replace("}",""))+"/ContentTypes";return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){var t=JSON.parse(e).value;r&&(t=t.filter(function(e){return e.group===r}));return t},qosName:"getSiteContentTypes",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getColumnsForSiteContentType=function(e,t,n,r){var i=e.substr(0,e.indexOf(t)),s=i.replace("https://",""),o=i+"/_api/V2.0/sites/"+s+","+(n=n.replace("{","").replace("}",""))+"/ContentTypes/"+r+"/columnLinks";return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e).value.map(function(e){return a.default.normalizeLower(e.id)})},qosName:"getColumnsForSiteContentType",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getViewIds=function(e,t){var n=e+"/_api/Web/Lists(guid'"+t+"')/views";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t=JSON.parse(e).value,n=[];t.forEach(function(e){return n.push(e.ListViewXml)});return n},qosName:"getViewIds",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getMachineTeachingModelsForList=function(e,t){var n=e+"/_api/web/Lists(guid'"+t+"')/contenttypes?$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/machinelearning/modelid', SchemaXml) eq true";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getMachineTeachingModelsForList",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getFormProcessingModelsForList=function(e,t){var n=e+"/_api/web/Lists(guid'"+t+"')/contenttypes?$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/formprocessing/models', SchemaXml) eq true";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getFormProcessingModelsForList",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getModelDetails=function(e,t,n){var r=e+"/_api/v2.1/drives/"+t+"/items/"+n+" ";return this._vroomDataRequestor.send({path:r.toString(),apiName:"modelDetails",qosExtraData:{qosName:"getModelDetails"},requestType:"GET",allowCookies:!0,getErrorAsMessage:!0,expectedErrorCodes:{403:!0}})};t.prototype.getModelDetailsManageModelKillSwitchActivated=function(e,t,n){var r=e+"/_api/v2.1/drives/"+t+"/items/"+n+" ";return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"getModelDetailsManageModelKillSwitchActivated",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getUserInformation=function(e,t,n){var r=e+"/_api/web/lists/modelusage/items?$select=Author/Name,Author/Title&$expand=Author/Id&"+("$filter=ModelUsageModelName eq '"+n+"' and ModelUsageTargetListID eq '"+t+"'");return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){return JSON.parse(e).value[0]},qosName:"getUserInformation",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getModelSettings=function(e,t){var n=e+"/_api/machinelearning/models/getbyuniqueid('"+t+"')";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t=JSON.parse(e);return JSON.parse(t.ModelSettings)},qosName:"getModelSettings",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.runModel=function(e){var t=this._apiUrlHelper.build().segment("machinelearning").segment("workItems");return this.runModelBatchRequest(t.toString(),function(e){return e},"runModel",function(){return e})};t.prototype.createOrUpdateModel=function(e,t,n,r,i){void 0===i&&(i="Intelligent Document Content Types");var s={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningModelEntityData"},ColumnId:r,ColumnName:n,ContentTypeGroup:i,ContentTypeId:t,ContentTypeName:e,Schemas:""},o=this._apiUrlHelper.build().segment("machinelearning").segment("models");return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"createContentTypeAndModel",additionalPostData:JSON.stringify(s),method:"POST"})};t.prototype.navigateToTrainingPage=function(e){var t=[];t.push(this._pageContext.webAbsoluteUrl);t.push(this._pageContext.layoutsUrl);t.push("training.aspx");var n=t.join("/")+e;this._navigation.navigateTo(n)};t.prototype.navigateToModelHomePage=function(e){var t="?v=modelHome&modelUniqueId="+e,n=[];n.push(this._pageContext.webAbsoluteUrl);n.push(this._pageContext.layoutsUrl);n.push("training.aspx");var r=n.join("/")+t;this._navigation.navigateTo({url:r,frameId:"_blank"})};t.prototype.getModelIdByContentType=function(e){var t=this._apiUrlHelper.build().toString();t=t+"/machinelearning/models/getbytitle('"+e+"')";return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).UniqueId},qosName:"getModelIdByContentType",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.importModel=function(){var e=this;return this.getModelIdByContentType("BenefitsChangeNotice.classifier").then(function(t){if(t)return Promise.resolve("Model already exists");var n=e._apiUrlHelper.build().segment("machinelearning").segment("models").segment("import('BenefitsChangeNotice.cmp')");return e.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t,n;return(null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d)||void 0===n?void 0:n.UniqueId)||""},qosName:"createContentImportModel",method:"Post"})})};t.prototype.checkIfModelExists=function(){var e=this._pageContext,t=e.webAbsoluteUrl+"/_api/web/GetFileByServerRelativeUrl('"+e.webServerRelativeUrl+"/Model/BenefitsChangeNotice.classifier')";return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return!0},qosName:"checkIfModelExists",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.runModelBatchRequest=function(e,t,n,r){var i=this;if(!r)return Promise.reject("failed");for(var s=a.default.generate(),o="multipart/mixed; boundary=batch_"+s,u=[],c=Math.ceil(r().length/30),h=0;h<c;h++){var p=r().slice(30*h,30*(h+1)),d=this.getConvertedData(p,e,s);u.push(this.dataRequestor.getData({url:f.DataBatchOperationHelper.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:t,qosName:this.getDataSourceName()+"."+n,additionalPostData:d,method:"POST",contentType:o}).then(function(e){return f.DataBatchOperationHelper.getBatchResponseText(e)}).catch(function(e){var t;l.default.log("[ccui] fetching content type failed "+(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.value));Promise.reject(e)}))}return Promise.all(u).then(function(e){var t=[].concat.apply([],e);return new Set(t.map(function(e){var t,n;if((null===(t=null==(e=JSON.parse(e))?void 0:e.d)||void 0===t?void 0:t.Created)&&(null===(n=null==e?void 0:e.d)||void 0===n?void 0:n.TargetServerRelativeUrl))return i.extractFileName(e.d.TargetServerRelativeUrl)}))})};t.prototype.getConvertedData=function(e,t,n){void 0===t&&(t="");void 0===n&&(n="");if(!e)return e;var r=f.DataBatchOperationHelper.defaultBatchAcceptData,i=[],s=[],o=[],u=f.DataBatchOperationHelper.defaultBatchRequestPostData,a=1;e.forEach(function(e){o.push(""+a++);i.push(t);s.push(JSON.stringify(e))});return f.DataBatchOperationHelper.getBatchContentExtended(n,i,"POST",u,s,r)};t.dependencies={pageContext:o.pageContext,apiUrlHelper:r.resourceKey,navigation:u.navigation,vroomDataRequestor:c.resourceKey};return t})(i.default);t.default=h;t.resourceKey=s.createResolvedResourceKey(e("module").id,h)});
define("BY",["require","exports","ww","Vb","mw","cc","jq","qq","v","pO","Je"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new a.ResourceKey({name:e("module").id,factory:{dependencies:{vroomUrlHelper:u.resourceKey,authTokenFetcher:o.resourceKey,graphDataSource:f.graph},create:function(e){var t=e.vroomUrlHelper,o=e.authTokenFetcher,u=e.graphDataSource;return{instance:function(e,a,f){var c=this;return function(e){return n.__awaiter(c,void 0,void 0,function(){var c,h,p,d,v,m,g;return n.__generator(this,function(n){switch(n.label){case 0:c=f&&t.getUrlParts(f);if(!(h=c&&c.driveId)&&!l.default.isActivated("8166AF21-A682-4F83-8DA3-3F57848BCE82","6/22/2020","Avoid fetching tokens if driveId is unknown"))return[2,void 0];p=r.driveItemKeyFacet.serialize({endpoint:a,driveId:h,itemId:"root"});d=e(s.readItems(function(e){return e.demandItemFacet(i.knockoutStoreItemFacet,p)}));return(v=d&&d.peek())?[4,o.ensureAuthToken(v.key)]:[3,3];case 1:n.sent();m=f&&f.indexOf("/v2.1")>-1;return[4,u.getAccessToken(v,{apiVersion:m?"v2.1":"V2.0"})];case 2:if((g=n.sent())&&(l.default.isActivated("A1EECBC8-4B38-491F-8F2D-311D6F192CB3","6/16/2020","Validate drive URL for token auth")||!g.tokenUrl&&!f||g.tokenUrl===f))return[2,g.accessToken];n.label=3;case 3:return[2]}})})}}}}}})});
define("$Ze",["require","exports","ww","mw","v","K_","Ms","zq","pO","$_","tC","cc","zb","az","th","Bc","Es","Q1","N","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var w=b.default.isActivated("6980AF2E-8FE7-4292-ACFB-B04FFCFF2289","11/12/2020","Assign errors per-item for KO mapping");t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:{urlDataSource:a.url,itemTaskObserverType:u.resourceKey},create:function(e){var t=e.urlDataSource,i=e.itemTaskObserverType;return{instance:s.createSingleItemOperationHandler({maxParallelOperationCount:30,mergeForSameItemKey:!0})(function(e){var s=this,a=r.odspNextStoreKeyFacet.deserialize(e.itemKey).itemKey;return function(b){return n.__awaiter(s,void 0,void 0,function(){var s,E,S,x,T,N,C,k,L,A,O,M,_,D;return n.__generator(this,function(P){switch(P.label){case 0:if(!(s=b(c.readItems(function(e){return e.demandItemFacet(h.knockoutStoreIdentityFacet,a)}))))return[3,5];E=s.key;S=t.getKeyParams(E);x=t.getQueryType(S);(T=new i).update([new u.Task(E).succeed({item:{key:E,queryType:x}})]);P.label=1;case 1:P.trys.push([1,3,,4]);return[4,b(l.demandItems(function(e){return e.demandItemFacet(p.oneDriveItemFacet,a)}))];case 2:N=P.sent();T.update([new u.Task(E).succeed({item:N})]);return[3,4];case 3:C=P.sent();if(w){L=0;A="";O="";C instanceof Error&&(O=C.message);C instanceof y.ApiError&&(A=C.code);C instanceof o.ItemOperationError&&(g.itemNotFoundErrorFacet.unpack(C.facets)?L=2:g.accessDeniedErrorFacet.unpack(C.facets)?L=2:g.authFailureErrorFacet.unpack(C.facets)&&(L=1));T.update([new u.Task(E).succeed({item:{error:{type:L,data:{errorCode:A,errorTitle:O}}}})])}return[3,4];case 4:if(!w&&(k=b(c.readItems(function(e){return e.demandItemFacet(m.errorFacet,a)})))){L=0;A="";O="";k instanceof Error&&(O=k.message);k instanceof y.ApiError&&(A=k.code);k instanceof o.ItemOperationError&&(g.itemNotFoundErrorFacet.unpack(k.facets)?L=2:g.accessDeniedErrorFacet.unpack(k.facets)?L=2:g.authFailureErrorFacet.unpack(k.facets)&&(L=1));T.update([new u.Task(E).succeed({item:{error:{type:L,data:{errorCode:A,errorTitle:O}}}})])}T.flush();P.label=5;case 5:(M=new f.ItemResolver).resolveItems({items:n.__assign(n.__assign({},a?(_={},_[a]=n.__assign({},d.getInvalidationFacet().forFacet(v.displayNameFacet).thenInvalidate(e.itemKey,r.createdStoreItemFacet).pack()),_):{}),(D={},D[e.itemKey]=n.__assign({},r.createdStoreItemFacet.pack(void 0)),D))});b(M.execute());return[2]}})})}})}}}})});
define("c$e",["require","exports","ww","v","n$e","Kq","zq","Bx","xv","cc","$_","zb","LI","M","Je","eW","pO","d$e","Xq","g","B8e","mw","th","Bc","Tb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var N=d.default.isActivated("D349E556-140B-4BFA-8B14-5DD337AAFB41","7/2/2020","Use per-list store for MicroServiceDataSource"),C=!d.default.isActivated("B2674AC0-2974-4648-A267-F071B5046467","2/26/2020","Create a new MicroServiceDataSource per list response."),k=(function(){function e(e,t){this._listItemBuilder=t.listItemBuilder;this._listItemResultProcessor=t.listItemResultProcessor;this._itemTaskObserverType=t.itemTaskObserverType;this._urlDataSource=t.urlDataSource;this._microServiceDataSource=t.microServiceDataSource;this._microServiceDataSourceType=t.microServiceDataSourceType;this._microServiceDataSourceStore=t.microServiceDataSourceStore;this._listContext=t.listContext}e.prototype.updateFromResponse=function(e){var t=this;return function(r){var i=new t._itemTaskObserverType,s=e.itemSetKey,o=e.serverData,p=e.isItemSetRequest,v=r(f.readItems(function(e){return e.demandItemFacet(c.knockoutStoreIdentityFacet,s)}));if(void 0!==v){var m=[v],g=v.key,y=t._listItemResultProcessor.processResponse({response:o,requestKey:g,observer:i}).listRootItemKey;if(p){var b=t._processRootFolder({response:o,requestKey:g,observer:i,isItemSetRequest:p});b&&m.push(b.item);o&&w.ListItemBuilderHelpers.updateListContext(o,t._listContext)}var k,L=o.ListData&&o.ListData.Row||[];N?C&&(k=new t._microServiceDataSourceType):k=t._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(y);if(k&&o.ListSchema){var A={data:o.ListSchema,allowCookies:!1};k.setBaseInfo(A);t._microServiceDataSource.setBaseInfo(A)}if(!(o.ListSchema&&"TRUE"===o.ListSchema.Collapse))for(var O=0,M=L;O<M.length;O++){var _=M[O],D=t._listItemBuilder.getItemResult({microServiceDataSource:k,itemFromServer:n.__assign({},_),requestKey:g,queryType:a.default.Files,supportsNestedGroups:!1,isItemDataOnly:!p,observer:i}).item;m.push(D)}i.flush();if(!d.default.isActivated("2282EF64-8A86-46E8-9221-D8554DC1D731","6/26/2020","Mark KO shim items as resolved when processing list response")){var P=r(f.readItems(function(e){for(var t,r=new l.ItemResolver,s=0,o=m;s<o.length;s++){var a=o[s],f=i.getItem(a);if(f&&!f.isPlaceholder){var c=h.getKeyParams(a.key),p=e.demandItemFacet(u.viewParamsToItemKeyControl,T.odspNextAppItemKey),d=u.viewParamsToItemKeyControl.evaluate(p)(e,{viewParams:c,isNavigation:!1}).itemKey;if(d){var v=E.odspNextStoreKeyFacet.serialize({itemKey:d});r.resolveItems({items:(t={},t[d]=n.__assign({},S.getInvalidationFacet().forFacet(x.displayNameFacet).thenInvalidate(v,E.createdStoreItemFacet).pack()),t[v]=n.__assign({},E.createdStoreItemFacet.pack(void 0)),t)})}}}return r}));r(P.execute())}}}};e.prototype._processRootFolder=function(e){var t=e.response,n=e.requestKey,r=e.observer,i=e.isItemSetRequest,s=t.ListData,o=t.ListSchema,u=(void 0===o?{}:o).Collapse,a=void 0===u?"FALSE":u;if(s){var f=s&&s.Row,l="";s.NextHref&&(l=(l=s.NextHref).replace("&View="+p.default.Empty,""));var c="TRUE"===a,h=!c&&f?f.slice(0):[],d=this._urlDataSource.getKeyParams(n),m={id:d.id,folder:{childCount:h.length,children:h},nextRequestToken:l,PermMask:s.FolderPermissions,groups:c?f:null,isRootFolder:!1};if(v.isTeamChannelBannerEnabled()){var g=s&&s.CurrentFolderProgId;m.ProgId=g}return this._listItemBuilder.getItemResult({requestKey:n,queryType:this._urlDataSource.getQueryType(d),itemFromServer:m,supportsNestedGroups:!1,isItemDataOnly:!i,observer:r})}};return e})();t.default=k;t.resourceKey=r.createResolvedResourceKey(e("module").id,k,{listItemBuilder:i.resourceKey,listItemResultProcessor:s.resourceKey,itemTaskObserverType:o.resourceKey,urlDataSource:m.url,microServiceDataSource:g.resourceKey,microServiceDataSourceType:g.typeResourceKey,microServiceDataSourceStore:y.resourceKey,listContext:b.listContext})});
define("e$e",["require","exports","ww","v","tB","LO","pO","Eq","n$e","Kq","zq","xv","Z$","g","N8e","zi","Gq","B8e","Je","$q","Xq","t$e","je","Gz","fB","bw","cc","Gb","Tb","Fb","Gi","Qi","kte","gc","Vs","$s","tc","nm","T2","Zb","zie","Ex","LGe","M","DS","Pee","G9","K9","Te"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var K=y.default.isActivated("D349E556-140B-4BFA-8B14-5DD337AAFB41","7/2/2020","Use per-list store for MicroServiceDataSource"),Q=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._listItemBuilder=n.listItemBuilder;r._listItemResultProcessor=n.listItemResultProcessor;r._store=n.itemsStore;r._itemTaskObserverType=n.itemTaskObserverType;r._itemsScopeItemKeyToKOItemKeyMap={};r._itemProvider=n.itemProvider;r._fileHandlerCacheDataSource=n.fileHandlerCacheDataSource;r._resources=n.resources;r._listContext=n.listContext;r._pageContext=n.pageContext;r._microServiceDataSource=n.microServiceDataSource;r._microServiceDataSourceStore=n.microServiceDataSourceStore;r._onePageContext=n.onePageContext;r._itemCacheStore=n.itemCacheStore;r._getItemsScopeCurrentViewKey=n.getItemsScopeCurrentViewKey;r._getItemsScopeCurrentDerivedView=n.getItemsScopeCurrentServerView;r._bundleLoaderProvider=n.bundleLoaderProvider;r._itemsScopeManager=n.itemsScopeManager;r._useItemsScope=n.useItemsScope;r._clientSideExtensionHelper=n.clientSideExtensionHelper;r.koItem=r._currentKOItem=n.currentKOItem;r.koItemSet=r._currentKOItemSet=n.currentKOItemSet;r.selectedKOItemKeys=r._selectedKOItemKeys=r.observables.create([]);r._initializeStateSubscription();return r}t.prototype._initializeStateSubscription=function(){var e=this,t=this._itemCacheStore,n={},r={currentItemKey:void 0,currentItemSetKey:void 0,selectedItemKeys:[],parentItemKey:void 0,childItems:void 0,getItemResponse:void 0,spFolderItemSet:void 0,fileHandlerRawData:void 0},i={},s=function(){var t;t=e._onStoreUpdate(r,n,i),r=t.itemsScopeInfo,n=t.keyMap};s();t.subscribe(s);this.observables.backgroundCompute(function(){e._bundleLoaderProvider.isPageLoaded.peek()?s():e._bundleLoaderProvider.isPageLoaded()})};t.prototype._onStoreUpdate=function(e,t,n){if(!this._bundleLoaderProvider.isPageLoaded.peek())return{itemsScopeInfo:e,keyMap:t};var r=this._itemCacheStore,i=this._itemsScopeManager.itemsScopeItemKey,s=r.dispatch(G({itemsScopeItemKey:i,pageContext:this._pageContext}));if(!this._useItemsScope.peek())return{itemsScopeInfo:s,keyMap:t};if(s.currentItemKey){var o=s.childItems,u=o&&o.itemKeys&&o.itemKeys.length>0&&Y(r,o.itemKeys[0]);if(u||e.childItems!==s.childItems||e.parentItemKey!==s.parentItemKey||e.getItemResponse!==s.getItemResponse){var a=s.parentItemKey,f=s.getItemResponse;if(o&&a){var l={},c=!1,h=!1,p=o.itemKeys;if(!n[a]||n[a].getItemResponse!==f){n[a]={getItemResponse:f};c=!0}u&&(p=(function(e,t){for(var n=!1,r=!1,i=[],s=0;s<t.itemKeys.length;s++){var o=Z(e,t.itemKeys[s]),u=o&&o.itemKeys;if(u){if(!n){r=u.length>0&&Y(e,u[0]);n=!0}if(r)for(var a=0;a<u.length;a++){var f=Z(e,u[a]),l=f&&f.itemKeys;l&&(i=i.concat(l))}else i=i.concat(u)}}return i})(r,o));for(var d=function(e){var i=r.dispatch(C.readItems(function(t){return{rowData:t.demandItemFacet(O.rowDataFacet,e)}})).rowData;if(n[e]&&n[e].rowData===i)l[e]={item:{rowData:i},mappedKOItemKey:t[e]};else{h=!0;n[e]={rowData:i};l[e]={item:{rowData:i}}}},v=0,m=p;v<m.length;v++){d(m[v])}(h||c||e.currentItemKey!==s.currentItemKey)&&(t=this._updateKOCurrentItemSet({itemsScopeItemKey:i,allChildItems:l,childItemsChanged:h,shouldSkipProcessParentItem:!c}).itemsScopeItemKeyToKOItemKeyMap)}}}s.fileHandlerRawData&&this._fileHandlerCacheDataSource&&this._fileHandlerCacheDataSource.setFileHandlerData(s.fileHandlerRawData);if((function(e,t){if(e.length!==t.length)return!0;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(e.indexOf(i)<0)return!0}return!1})(e.selectedItemKeys,s.selectedItemKeys)){var g=s.selectedItemKeys.map(function(e){return t[e]});this._selectedKOItemKeys(g)}return{itemsScopeInfo:s,keyMap:t}};t.prototype._updateKOCurrentItemSet=function(e){var t=this,r=e.itemsScopeItemKey,i=e.allChildItems,o=e.shouldSkipProcessParentItem,u=this._itemCacheStore,a=u.dispatch(G({itemsScopeItemKey:r,pageContext:this._pageContext})),f=a.parentItemKey,l=a.getItemResponse,h=a.spFolderItemSet,b={itemKey:f},w=h||{},N=w.webAbsoluteUrl,_=void 0===N?void 0:N,D=w.listFullUrl,P=void 0===D?void 0:D,H=u.dispatch(C.readItems(function(e){return{folderPath:e.demandItemFacet(O.folderPathFacet,f),permissions:e.demandItemFacet(O.permissionsFacet,f)}})),B={id:H.folderPath,permissions:H.permissions},j=this._getItemsScopeCurrentViewKey(),F=this._getItemsScopeCurrentDerivedView(j),I=M.spListKeyFacet.serialize({webAbsoluteUrl:_,listFullUrl:P}),q=u.dispatch(C.readItems(function(e){var t=e.demandItemFacet(O.contentTypeKeysFacet,I)||[],n=e.demandItemFacet(O.contentTypeKeysFacet,f)||[];return{contentTypes:t.map(function(t){return e.demandItemFacet(O.spListContentTypeFacet,t)}),folderContentTypeOrder:n.map(function(t){return e.demandItemFacet(O.spFolderContentTypeFacet,t)})}})),W=q.contentTypes,X=q.folderContentTypeOrder,V=this._itemCacheStore.dispatch(C.readItems(function(e){return e.demandItemFacet(O.spPageContextFacet,M.spPageContextKeyFacet.serialize({webAbsoluteUrl:_,listFullUrl:P}))}));l&&g.ListItemBuilderHelpers.updateListContext(l,this._listContext);var $=this.resources.consume(U.resourceKey);$&&!y.default.isActivated("975DFDE1-C9F7-44A9-A628-D9DD6F9BB63D","09/05/2019","Make power app pre-loading more robust")&&$.ensureListContextUpdateSignal().complete();if(V&&(V.listId!==this._pageContext.listId||!this._pageContext.listUrl||z.default.normalizeLower(this._listContext.listId)!==z.default.normalizeLower(this._pageContext.listId))){var J=this._onePageContext;if(J){this._listContext.refreshClientForm=!0;if(V.listUrl&&this._listContext.listId.toUpperCase()===V.listId.toUpperCase())S.extend(this._pageContext,V);else{this._pageContext.listUrl=this._listContext.listUrl;this._pageContext.listId=this._listContext.listId;this._pageContext.listTitle=this._listContext.listTitle;this._pageContext.listBaseTemplate=this._listContext.listTemplateType}this._pageContext.serverRequestPath=void 0;var Q=this.resources.consume(x.resourceKey.optional);if(Q){Q.clearCachedPromise();Q.updateWorkloadSettingsLinks()}this._useItemsScope.peek()&&this._updateSpfxContext(I);J.onePageNavigationDataFetch(!0);J.onePageNavigationDataFetch(!1)}}var Y=(0,this._itemCacheStore.dispatch)(C.readItems(function(e){var t=e.demandItemFacet(k.itemKeyToStoreKeyControl,L.odspNextAppItemKey),n=e.demandItemFacet(A.currentViewParamsFacet,r),i=k.itemKeyToStoreKeyControl.evaluate(t)(e,{itemKey:b.itemKey,viewParams:n||{}}).storeKey;return i&&i.key})),Z=new this._itemTaskObserverType,ee=[];if(l&&b&&!o){var te=l.ListSchema,ne=this._listItemResultProcessor.processResponse({response:l,requestKey:Y,observer:Z}).listRootItemKey;if(te&&!T.isFeatureEnabled(T.SkipSettingMicroserviceBaseInfo)){var re={data:te,allowCookies:!1};if(!K){this._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(ne).setBaseInfo(re)}this._microServiceDataSource.setBaseInfo(re)}y.default.isActivated("AA918EC4-B203-49D2-9EF6-0DB64E830D56","1/09/2018","Disable list token update automatically")||this.resources.consumeAsync(E.resourceKey).then(function(e){e.trackListToken(Y)});this._itemsScopeItemKeyToKOItemKeyMap[b.itemKey]=Y}B&&Z.update([new m.default(Y).succeed({item:n.__assign(n.__assign({},B),{folder:{},type:R.default.Folder,isDropEnabled:!0,isPlaceholder:!1})})]);var ie=this.resources.consume(s.currentView);F&&ie&&ie(F.clone());var se=this.resources.consume(p.contentTypes.optional);se&&se(W);for(var oe in i){var ue=i[oe],ae=ue.item,fe=ue.mappedKOItemKey;if(fe){this._itemsScopeItemKeyToKOItemKeyMap[oe]=fe;ee.push(fe)}else{var le=ae.rowData;if(le){var ce=this._listItemBuilder.getItemResult({itemFromServer:n.__assign({},le),parentItemKey:Y,requestKey:Y,queryType:c.default.Files,supportsNestedGroups:!1,isItemDataOnly:!0,observer:Z});this._itemsScopeItemKeyToKOItemKeyMap[oe]=ce.item.key;ee.push(ce.item.key)}}}var he=void 0;l&&l.ListSchema&&(he=d.getListSchema({listSchema:l.ListSchema,resources:this._resources,groupSchema:{},hasFixedSchema:this._listContext.listTemplateType===v.ListTemplateType.mySiteDocumentLibrary,listContext:this._listContext,getItemContext:void 0,sortFallback:{sortField:l.ListData.SortField,sortDirection:l.ListData.SortDir}}));if(Y||ee.length){Z.flush();var pe=this._store.getItem(Y),de=ee.map(function(e){return t._store.getItem(e)}),ve=this._itemProvider.getItemSync({parentKey:Y});ve.isPlaceholder=!1;ve.content({items:de,groupings:[]});he&&ve.schema(he);pe&&this._currentKOItem(pe.peek());X&&ve.contentTypes(X);this._currentKOItemSet(ve)}return{itemsScopeItemKeyToKOItemKeyMap:this._itemsScopeItemKeyToKOItemKeyMap}};t.prototype._updateSpfxContext=function(e){if(this._itemCacheStore&&this._listContext&&e&&this._clientSideExtensionHelper)try{var t=(0,this._itemCacheStore.dispatch)(C.readItems(function(t){return{cachedSpfxPageContext:t.demandItemFacet(W.spClientSideFrameworkContextFacet,e)}})).cachedSpfxPageContext,n=this._clientSideExtensionHelper.getApplication();if(n&&"function"==typeof n.navigateToPreloadedData&&t){var r=n&&n.context&&n.context.pageContext&&n.context.pageContext.list&&n.context.pageContext.list.id&&n.context.pageContext.list.id.toString();z.default.normalizeLower(r)!==z.default.normalizeLower(this._listContext.listId)&&n.navigateToPreloadedData(JSON.parse(t))}}catch(e){console.log("Error updating SpfxContext, error "+e)}};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{itemsStore:u.resourceKey,listItemBuilder:a.resourceKey,listItemResultProcessor:f.resourceKey,currentKOItem:s.currentItem,currentKOItemSet:s.currentItemSet,itemTaskObserverType:l.resourceKey,itemProvider:h.resourceKey,listContext:p.listContext,microServiceDataSource:b.resourceKey,microServiceDataSourceStore:w.resourceKey,pageContext:p.pageContext,onePageContext:p.onePageContext.optional,itemCacheStore:N.resourceKey,getItemsScopeCurrentViewKey:_.getItemsScopeCurrentViewKeyResourceKey,getItemsScopeCurrentServerView:_.getItemsScopeCurrentDerivedViewResourceKey,bundleLoaderProvider:F.bundleLoader,itemsScopeManager:I.resourceKey,useItemsScope:q.resourceKey,clientSideExtensionHelper:X.clientSideExtensionHelper.optional,fileHandlerCacheDataSource:o.fileHandlerFromCache.optional});return t})(i.default);t.default=Q;function G(e){var t=e.itemsScopeItemKey,n=e.pageContext;return function(e){return e(C.readItems(function(e){var r=D.getCurrentItemKey(e,{itemsScopeItemKey:t}),i=H.getSelectedItemKeys(e,{itemsScopeItemKey:t}),s=P.getCurrentItemSetKey(e,t),o=e.demandItemFacet(M.spFolderItemSetKeyFacet,s),u=e.demandItemFacet(B.childItemsFacet,s),a=e.demandItemFacet(B.parentItemFacet,s),f=a&&a.itemKey,l=e.demandItemFacet(O.getItemResponseFacet,s),c=n.webAbsoluteUrl,h=new J.default(c).authority+"/_api/v2.0",p=$.driveAppsKeyFacet.serialize({endpoint:h});return{currentItemKey:r,selectedItemKeys:i,spFolderItemSet:o,childItems:u,parentItemKey:f,getItemResponse:l,currentItemSetKey:s,fileHandlerRawData:e.demandItemFacet(V.fileHandlerRawDataFacet,p)}}))}}function Y(e,t){return!!e.dispatch(C.readItems(function(e){return e.demandItemFacet(j.isGroupFacet,t)}))}function Z(e,t){return e.dispatch(C.readItems(function(e){return e.demandItemFacet(B.childItemsFacet,t)}))}t.resourceKey=r.createResolvedResourceKey(e("module").id,Q)});
define("qZe",["require","exports","ww","D7","Qi","g","v","bw","tc","th","Nq","cc","Qi","Gi","tc","QM","nm","Cs","p3","DS","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ItemInvalidator=void 0;var E=(function(){function e(e,t){void 0===e&&(e={});var n=t.itemUrlHelper,r=t.pageContext,i=t.itemCacheStore;this._itemCacheStore=i;this._pageContext=r;this._itemUrlHelper=n;this._itemsScopeCurrentItemKey=t.itemsScopeCurrentItemKey}e.prototype.invalidateItemSet=function(e){var t;this._itemCacheStore.dispatch(f.invalidateItems({items:(t={},t[e]=[d.childItemsFacet],t)}))};e.prototype.invalidateCurrentItemSet=function(){var e=this._itemsScopeCurrentItemKey.peek();if(e){var t=this._itemCacheStore.dispatch(c.readItems(function(t){return t.demandItemFacet(h.remoteItemKeyFacet,e)}));t?this.invalidateItemSet(t.remoteItemKey):this.invalidateItemSet(e)}};e.prototype.invalidateItems=function(e){var t=this._getItemKeyFromKOKey(e);this._invalidateFolderItems(t)};e.prototype.invalidateCurrentView=function(){var e,t=this._itemsScopeCurrentItemKey.peek(),n=t&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,t)})),r=n&&n.viewKey&&h.spViewKeyFacet.serialize(n.viewKey);r&&this._itemCacheStore.dispatch(f.invalidateItems({items:(e={},e[r]=[p.serverViewFacet,p.currentDerivedViewFacet],e)}))};e.prototype.invalidateAvailableViews=function(){var e,t=this._itemsScopeCurrentItemKey.peek(),n=t&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,t)})),r=n&&i.spListViewsSetKeyFacet.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl});r&&this._itemCacheStore.dispatch(f.invalidateItems({items:(e={},e[r]=[d.childItemsFacet],e)}))};e.prototype.notifySpfxLoaded=function(e){var t,r=this._itemsScopeCurrentItemKey.peek(),i=r&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,r)})),s=i&&h.spListKeyFacet.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl});if(s){var o=void 0;try{if(e&&e.context&&e.context.preloadedData){var u=e,a=u.context.preloadedData;!a.spPageContextInfo&&u.context.pageContext&&u.context.pageContext.legacyPageContext&&(a.spPageContextInfo=u.context.pageContext.legacyPageContext);o=JSON.stringify(a)}}catch(e){console.log("Failed to get spfx application preloaded data to cache: "+e)}this._itemCacheStore.dispatch(y.resolveItems({items:(t={},t[s]=n.__assign(n.__assign({},b.isSpfxLoadedFacet.pack(!0)),o?b.spClientSideFrameworkContextFacet.pack(o):{}),t)}))}};e.prototype.invalidateListContentTypes=function(){var e,t=this._itemsScopeCurrentItemKey.peek(),n=t&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,t)})),r=n&&h.spListKeyFacet.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl});r&&this._itemCacheStore.dispatch(f.invalidateItems({items:(e={},e[r]=[p.contentTypeKeysFacet],e)}))};e.prototype.refreshItemsInCurrentItemSet=function(e,t){var n;void 0===t&&(t=!1);var r=this._itemsScopeCurrentItemKey.peek(),s=this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(h.spFolderItemSetKeyFacet,r)}));if(r&&s){for(var o=s.webAbsoluteUrl,u=s.listFullUrl,a={},l={},d=0,m=e;d<m.length;d++){var g=m[d],y=i.spItemKeyFacet.serialize({webAbsoluteUrl:o,listFullUrl:u,itemId:g});a[y]={};l[y]=[p.rowDataFacet]}!w.default.isActivated("64FDA156-A200-4BD5-8989-9DC4D502E0AF","10/22/2020","Invalidate to trigger update on calendar canvas")&&t&&this._itemCacheStore.dispatch(f.invalidateItems({items:l}));this._itemCacheStore.dispatch(v.refreshItemsInSet({items:(n={},n[r]=a,n)}))}};e.prototype.invalidateGroups=function(e){var t=e||[],n=this._itemsScopeCurrentItemKey.peek();if(n&&h.spFolderItemSetKeyFacet.matches(n)){if(0===t.length){var r=n&&this._itemCacheStore.dispatch(c.readItems(function(e){return e.demandItemFacet(d.childItemsFacet,n)})),s=r&&r.itemKeys||[];t=s.filter(function(e){return i.spItemGroupKeyFacet.matches(e)})}if(t.length>0){this.invalidateItemSet(n);if(this._itemCacheStore.dispatch(g.readItem({defaultCollapsed:m.defaultCollapsedFacet},t[0])).defaultCollapsed){var o=this._itemCacheStore.dispatch(c.readItems(function(e){for(var n={},r=0,i=t;r<i.length;r++){var s=i[r],o=e.demandItemFacet(d.childItemsFacet,s);(w.default.isActivated("cb8cd0db-659a-466a-bf83-172c57cdaebf","9/18/2020","only invalidate group that has resolved child items")||void 0!==o)&&(n[s]=[d.childItemsFacet])}return n}));this._itemCacheStore.dispatch(f.invalidateItems({items:o}))}}}};e.prototype.invalidateCurrentFolderItems=function(){var e=this._itemsScopeCurrentItemKey.peek(),t=this._itemCacheStore.dispatch(c.readItems(function(t){return t.demandItemFacet(a.parentItemFacet,e)}));t&&t.itemKey&&this._invalidateFolderItems(t.itemKey)};e.prototype._invalidateFolderItems=function(e){var t;this._itemCacheStore.dispatch(f.invalidateItems({items:(t={},t[e]=[a.defaultChildItemSetFacet],t)}))};e.prototype._getItemKeyFromKOKey=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return i.spItemKeyFacet.serialize({webAbsoluteUrl:t.isCrossList?"":this._pageContext.webAbsoluteUrl,listFullUrl:t.fullListUrl,rootFolder:t.serverRelativeItemUrl!==t.serverRelativeListUrl?t.serverRelativeItemUrl:""})};e.dependencies={itemUrlHelper:r.resourceKey,pageContext:s.pageContext,itemCacheStore:u.resourceKey,itemsScopeCurrentItemKey:l.resourceKey};return e})();t.ItemInvalidator=E;t.resourceKey=o.createResolvedResourceKey(e("module").id,E)});
define("QZe",["require","exports","ww","Qi","v","bw","cc","yo","Xb","Nq","tC","tc"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ItemUpdator=void 0;var h=(function(){function e(e,t){void 0===e&&(e={});var n=t.itemCacheStore,r=t.itemsScopeCurrentItemKey,i=t.itemsScopeItemKey;this._itemCacheStore=n;this._itemsScopeCurrentItemKey=r;this._itemsScopeItemKey=i}e.prototype.selectItems=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,i,s,a,f,h,p,d;return n.__generator(this,function(n){switch(n.label){case 0:t=[];i=this._itemsScopeCurrentItemKey.peek();if(!(s=i&&this._itemCacheStore.dispatch(o.readItems(function(e){return e.demandItemFacet(r.spFolderItemSetKeyFacet,i)})))||!i)return[2];for(a=0,f=e;a<f.length;a++){h=f[a];p={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl,itemId:h};d=r.spItemKeyFacet.serialize(p);t.push(d)}return[4,this._itemCacheStore.dispatch(l.demandItems(function(e){e.demandItemFacet(c.childItemsFacet,i)}))];case 1:n.sent();this._itemCacheStore.dispatch(u.selectItems({itemsScopeItemKey:this._itemsScopeItemKey,selectedItemKeys:t,currentSelectionKey:void 0}));return[2]}})})};return e})();t.ItemUpdator=h;t.resourceKey=i.createResolvedResourceKey(e("module").id,h,{itemCacheStore:s.resourceKey,itemsScopeCurrentItemKey:f.resourceKey,itemsScopeItemKey:a.resourceKey})});
define("YZe",["require","exports","ww","D7","Qi","g","v","bw","cc","Gi","$_"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ShortcutUpdater=void 0;var c=(function(){function e(e,t){void 0===e&&(e={});var n=t.itemUrlHelper,r=t.pageContext,i=t.itemCacheStore;this._itemCacheStore=i;this._pageContext=r;this._itemUrlHelper=n}e.prototype.updateItemShortcutValues=function(e,t,r){var s,o=this._getItemKeyFromKOKey(e,t),u=this._itemCacheStore.dispatch(a.readItems(function(e){return e.demandItem({key:i.spItemKeyFacet,rowData:f.rowDataFacet},o)})),c=u.key,h=u.rowData;if(c&&h){var p=n.__assign({},h);p._ShortcutUrl=r.url;p._ShortcutSiteId=r.siteId;p._ShortcutWebId=r.webId;p._ShortcutUniqueId=r.uniqueId;var d=new l.ItemResolver;d.resolveItems({items:(s={},s[o]=n.__assign({},f.rowDataFacet.pack(p)),s)});this._itemCacheStore.dispatch(d.execute())}};e.prototype._getItemKeyFromKOKey=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e);return i.spItemKeyFacet.serialize({webAbsoluteUrl:n.isCrossList?"":this._pageContext.webAbsoluteUrl,listFullUrl:n.fullListUrl,itemId:t||"",rootFolder:t||n.serverRelativeItemUrl===n.serverRelativeListUrl?"":n.serverRelativeItemUrl})};return e})();t.ShortcutUpdater=c;t.resourceKey=o.createResolvedResourceKey(e("module").id,c,{itemUrlHelper:r.resourceKey,pageContext:s.pageContext,itemCacheStore:u.resourceKey})});
define("JZe",["require","exports","ww","K_","p3","R3","tc","rm"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.flowAddon=void 0;t.flowAddon=r.createAddon(function(){return function(t){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(a){t(u.asBatch(function(){t(i.supportFacets({keyFacet:s.flowSetKeyFacet,facets:[o.childItemsFacet]}));t(i.supportFacets({keyFacet:s.flowTemplateSetKeyFacet,facets:[o.childItemsFacet]}));t(r.registerOperationHandler(s.flowSetKeyFacet,i.getItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["ZZe"],t,n)})];case 1:return[2,t.sent().getFlowSetOperationHandler]}})})})));t(r.registerOperationHandler(s.flowTemplateSetKeyFacet,i.getItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["ZZe"],t,n)})];case 1:return[2,t.sent().getFlowTemplateSetOperationHandler]}})})})))}));return[2]})})}})});
define("ZZe",["require","exports","ww","tc","R3","Qi","Gi","K_","p3","Cs","zi","XZe","bZ","VZe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFlowTemplateSetOperationHandler=t.getFlowSetOperationHandler=void 0;t.getFlowSetOperationHandler=u.createSingleItemOperationHandler()(function(e){var t=this,s=e.itemKey,o=i.flowSetKeyFacet.deserialize(s),u=o.webAbsoluteUrl,f=o.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,l;return n.__generator(this,function(h){switch(h.label){case 0:t={};return[4,e(c.getFlowInstancesData(u,f))];case 1:l=h.sent();(function(e,t,s,o){var u=[];o.forEach(function(t){var r=i.flowItemKeyFacet.serialize(n.__assign(n.__assign({},s),{id:t.id}));e[r]=n.__assign({},p.flowItemFacet.pack(t));u.push(r)});e[t]=n.__assign({},r.childItemsFacet.pack({itemKeys:u}))})(t,s,o,l);e(a.resolveItems({items:t}));return[2]}})})}});t.getFlowTemplateSetOperationHandler=u.createSingleItemOperationHandler()(function(e){var t=this,u=e.itemKey,d=i.flowTemplateSetKeyFacet.deserialize(u),v=d.webAbsoluteUrl,m=d.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:t={};g=e(f.readItem({list:o.listFacet},s.spListKeyFacet.serialize({webAbsoluteUrl:v,listFullUrl:m})));(y=g.list&&g.list.templateType)===l.default.mySiteDocumentLibrary?b=h.EnvironmentAppropriateODBTemplateCategory:l.isDocumentLibrary(y)?b="OOB_SHAREPOINT_LIBRARY":l.isGenericList(y)&&(b="OOB_SHAREPOINT_LIST");return[4,e(c.getFlowTemplatesData(v,m,b))];case 1:w=E.sent();(function(e,t,s,o){var u=[];o.forEach(function(t){var r=i.flowTemplateItemKeyFacet.serialize(n.__assign(n.__assign({},s),{id:t.templateId}));e[r]=n.__assign({},p.flowTemplateItemFacet.pack(t));u.push(r)});e[t]=n.__assign({},r.childItemsFacet.pack({itemKeys:u}))})(t,u,d,w);e(a.resolveItems({items:t}));return[2]}})})}})});
define("XZe",["require","exports","W3","e9","hZ"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFlowTemplatesData=t.getFlowInstancesData=void 0;t.getFlowInstancesData=function(e,t){var o=r.getListApiUrl({webAbsoluteUrl:e,listFullUrl:t}).segment("SyncFlowInstances").toString();return function(r){return r(n.getData({webAbsoluteUrl:e,listFullUrl:t,method:"POST",url:o,qosName:"SyncFlowInstances",noRedirect:!0})).then(function(e){var t=s(e);return i.default.processFlowInstances(t,"Request")})}};t.getFlowTemplatesData=function(e,t,o){var u=r.getListApiUrl({webAbsoluteUrl:e,listFullUrl:t}).segment("SyncFlowTemplates").toString(),a=o?JSON.stringify({category:o}):"";return function(t){return t(n.getData({webAbsoluteUrl:e,listFullUrl:"",method:"POST",url:u,body:a,qosName:"SyncFlowTemplates",noRedirect:!0})).then(function(e){var t=s(e);return i.default.processTrustedTemplates(t,"OOB_CURRENT")})}};function s(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=JSON.stringify(e);var n=e;t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t}});
define("T$e",["require","exports","ww","LZ","v","g"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getMachineTeachingContentTypes=function(e,t,n,r){return this.getContentTypes(e,t,"$select=Name,Discription,Group,StringId,SchemaXml,Hidden","$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/machinelearning/modelid', SchemaXml) eq true",n,r)};t.prototype.getFormProcessingContentTypes=function(e,t,n,r){return this.getContentTypes(e,t,"$select=Name,Discription,Group,StringId,SchemaXml,Hidden","$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/formprocessing/models', SchemaXml) eq true",n,r)};t.prototype.getSiteContentTypes=function(e,t,n,r){var i=t?"$filter=Group eq '"+t+"'":void 0;return this.getContentTypes(e,void 0,"$select=Name,Discription,Group,StringId,Hidden",i,n,r)};t.prototype.getSiteDocumentDescendantContentTypes=function(e,t,n,r,i){var s="$filter=startswith(StringId,'0x0101') and StringId ne '0x0101'";t||(s+=" and Hidden eq false");n||(s+=" and Group ne '_Hidden'");return this.getContentTypes(e,void 0,"$select=Name,Discription,Group,StringId,Hidden",s,r,i)};t.prototype.addContentTypeToList=function(e,t,n){var r={contentTypeId:n},i=e+"/_api/web/Lists('"+t+"')/contenttypes/AddAvailableContentType";return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){var t=JSON.parse(e);return{id:t.StringId,name:t.Name,discription:t.Discription,group:t.Group,hidden:t.Hidden}},qosName:"addContentTypeToList",additionalPostData:JSON.stringify(r),method:"POST"})};t.prototype.createSiteContentType=function(e,t,n){var r={parameters:{__metadata:{type:"SP.ContentTypeEntityData"},Name:t.name,Description:t.discription,Group:t.group,ParentContentTypeId:n}},i=e+"/_api/web/contenttypes/create";return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){var t,n,r,i,s,o=JSON.parse(e);return{id:null===(t=null==o?void 0:o.d)||void 0===t?void 0:t.StringId,name:null===(n=null==o?void 0:o.d)||void 0===n?void 0:n.Name,discription:null===(r=null==o?void 0:o.d)||void 0===r?void 0:r.Discription,group:null===(i=null==o?void 0:o.d)||void 0===i?void 0:i.Group,hidden:null===(s=null==o?void 0:o.d)||void 0===s?void 0:s.Hidden}},qosName:"createSiteContentType",additionalPostData:JSON.stringify(r),method:"POST"})};t.prototype.createSiteContentTypeLegacy=function(e,t){var n={__metadata:{type:"SP.ContentType"},Name:t.name,Description:t.discription,Group:t.group},r=e+"/_api/web/contenttypes";return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){var t,n,r,i,s,o=JSON.parse(e);return{id:null===(t=null==o?void 0:o.d)||void 0===t?void 0:t.StringId,name:null===(n=null==o?void 0:o.d)||void 0===n?void 0:n.Name,discription:null===(r=null==o?void 0:o.d)||void 0===r?void 0:r.Discription,group:null===(i=null==o?void 0:o.d)||void 0===i?void 0:i.Group,hidden:null===(s=null==o?void 0:o.d)||void 0===s?void 0:s.Hidden}},qosName:"createSiteContentType",additionalPostData:JSON.stringify(n),method:"POST"})};t.prototype.getContentTypeById=function(e,t,n){var r=t?e+"/_api/web/Lists('"+t+"')/contenttypes/getbyid('"+n+"')":e+"/_api/web/contenttypes/getbyid('"+n+"')";return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){var t=JSON.parse(e),n=null==t?void 0:t.d;return n?{id:n.StringId,name:n.Name,discription:n.Discription,group:n.Group,hidden:n.Hidden}:void 0},qosName:t?"getListContentTypeById":"getSiteContentTypeById",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.prototype.getContentTypes=function(e,t,n,r,i,s){var o=n;o+=o&&r?"&":"";o+=r||"";o+=o&&i?"&":"";o+=i?"$top="+i:"";o+=o&&s?"&":"";o=(o+=s?"$skip="+s:"")?"?"+o:"";var u=t?e+"/_api/web/Lists('"+t+"')/contenttypes"+o:e+"/_api/web/contenttypes"+o;return this.dataRequestor.getData({url:u.toString(),parseResponse:function(e){var t,n,r=JSON.parse(e);return((null===(t=null==r?void 0:r.d)||void 0===t?void 0:t.results)?null===(n=null==r?void 0:r.d)||void 0===n?void 0:n.results:[]).map(function(e){return{id:e.StringId,name:e.Name,discription:e.Discription,group:e.Group,hidden:e.Hidden}})},qosName:t?"getListContentTypes":"getSiteContentTypes",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("U$e",["require","exports","ww","LZ","v","g","fe"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ModelState=void 0;var u=(function(){function e(){}e.Online="Online";e.Offline="Offline";return e})();t.ModelState=u;var a=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getListAIModel=function(e,t){var n=e+"/_api/web/Lists('"+t+"')/rootfolder/properties?$select=vti_x005f_modellibrary,vti_x005f_predictionmodelid,vti_x005f_predictionmodel";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t=JSON.parse(e);return null==t?void 0:t.d},qosName:"getListModelProperty",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}}).then(function(e){var t=e.vti_x005f_modellibrary||"",n=t?{driveId:t}:void 0,r=e.vti_x005f_predictionmodelid||"",i=e.vti_x005f_predictionmodel||"",s=[];if(i)try{s=JSON.parse(i)}catch(e){o.default.logError("JSON parse failed for vti_x005f_predictionmodel propety value: "+i)}var u=r&&s&&s.length>0?s.find(function(e){return e.id===r}):void 0;return{machineTeachingModel:n,predictionModel:u||(!u&&r?{id:r}:void 0)}})};t.prototype.updateFormProcessingModelRetentionLabel=function(e,t,n){var r=e+"/_api/web/Lists('"+t+"')/UpdateFormProcessingModelRetentionLabel(retentionLabel='"+n+"')";return this.dataRequestor.getData({url:r.toString(),qosName:"updateFormProcessingModelRetentionLabel",method:"POST",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"},noRedirect:!0})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=a;t.resourceKey=i.createResolvedResourceKey(e("module").id,a)});
define("P$e",["require","exports","ww","LZ","v","g"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getPeopleByLoginName=function(e,t){var n=e+"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(AccountName=@v)?@v='"+encodeURIComponent(t)+"'&$select=AccountName,DisplayName,Email,Title";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t=JSON.parse(e),n=null==t?void 0:t.d;return n?{accountName:n.AccountName,displayName:n.DisplayName,email:n.Email,title:n.Title}:void 0},qosName:"getPeopleProperties",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("k$e",["require","exports","ww","LZ","v","g"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var o=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}t.prototype.getViews=function(e,t){var n=e+"/_api/web/Lists('"+t+"')/Views?$select=Id,Title,DefaultView,Hidden";return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t,n,r=JSON.parse(e);return((null===(t=null==r?void 0:r.d)||void 0===t?void 0:t.results)?null===(n=null==r?void 0:r.d)||void 0===n?void 0:n.results:[]).map(function(e){return{id:e.Id,title:e.Title,isHidden:e.Hidden,isDefault:e.DefaultView}})},qosName:"getViews",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})};t.prototype.createView=function(e,t,n){var r={parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:n,Query:'"<OrderBy><FieldRef Name="FileLeafRef"/></OrderBy>"',Paged:!0,PersonalView:!1,RowLimit:30,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:["DocIcon","LinkFilename","ContentType","Modified","Editor"]}}},i=e+"/_api/web/Lists('"+t+"')/Views/Add";return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){var t,n,r,i,s=JSON.parse(e);return{id:null===(t=null==s?void 0:s.d)||void 0===t?void 0:t.Id,title:null===(n=null==s?void 0:s.d)||void 0===n?void 0:n.Title,isHidden:null===(r=null==s?void 0:s.d)||void 0===r?void 0:r.Hidden,isDefault:null===(i=null==s?void 0:s.d)||void 0===i?void 0:i.DefaultView}},qosName:"createView",additionalPostData:JSON.stringify(r),method:"POST"})};t.dependencies={pageContext:s.pageContext};return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("y$e",["require","exports","ww","v","Qi","D8","OAe","BAe","cc","tC","mw","hk","z","po","tB","Hs","jo","Bc","ih","Nk","Bk","Q1","qi","Rk","Gi","A","Te","Fk"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:{singleFileUploaderType:o.typeResourceKey,html5FileUploadType:u.typeResourceKey,observablesFactoryType:d.observablesFactoryTypeResourceKey},create:function(e){var t=e.singleFileUploaderType,r=e.html5FileUploadType,o=e.observablesFactoryType;return{instance:function(e){var u=this,d=e.itemKey,A=e.options.sourceEntries,O=i.spItemKeyFacet.deserialize(d),M=O.webAbsoluteUrl,_=O.listFullUrl,D=O.rootFolder,P=Object.keys(A)[0],H=A[P],B=H.progressItemKey,j=H.conflictResolution;return function(A){return n.__awaiter(u,void 0,void 0,function(){var u,O,H,F=this;return n.__generator(this,function(I){switch(I.label){case 0:u=A(a.readItems(function(e){return{folderPath:e.demandItemFacet(T.folderPathFacet,d)}})).folderPath,O=void 0===u?D:u;H=new C.SimpleUri(_).path+"/Forms";return!!O&&O.slice(0,H.length)===H?[4,A(k.uploadListItem(e))]:[3,2];case 1:return[2,I.sent()];case 2:return[4,h.withScope(function(e){return n.__awaiter(F,void 0,void 0,function(){var u,h,C,k,O,D,H,F,I,q,R,U,z,W,X,V,$;return n.__generator(this,function(J){switch(J.label){case 0:return[4,A(f.demandItems(function(e){return{storeItem:e.demandItemFacet(l.knockoutStoreItemFacet,d)}}))];case 1:u=J.sent().storeItem;h=A(a.readItems(function(e){return{sourceFile:e.demandItemFacet(c.sourceFileFacet,P)}})).sourceFile;if(!(C=u&&u.peek()))throw new b.UploadError({message:"No parent item available for upload.",errorType:w.UploadErrorType.general,code:"ClientMissingParentItem"});if(!h)throw new b.UploadError({message:"No source file for upload.",errorType:w.UploadErrorType.general,code:"ClientMissingSourceFile"});k=e.attach(new r({file:h}));O="replace"===j?1:0;D=e.attach(new t({nameConflictBehavior:O,fileUpload:k,parentItem:C,metadata:{},qosContext:{scenario:"ItemsScope.Upload",folderUpload:!0,wasDraggedAndDropped:!1}}));B&&A(m.resolveItems({items:(V={},V[B]=n.__assign({},y.progressSizeFacet.pack({total:h.size,current:0})),V)}));H=e.attach(new o);F=new p.Signal;H.backgroundCompute(function(){var e,t=D.uploadedBytes();B&&A(m.resolveItems({items:(e={},e[B]=S.pack({progressSize:y.progressSizeFacet},{progressSize:{current:t}}),e)}))}).extend({rateLimit:{timeout:300}});H.backgroundCompute(function(){var e=D.state.peek();2===e?F.resolve():4===e?F.reject(D.error.peek()||new b.UploadError({message:"Unknown upload error.",errorType:w.UploadErrorType.general,code:"ClientUnknown"})):3===e?F.reject(new v.CancelError):D.state()});D.start().catch();(I=A(a.readItems(function(e){return e.demandItemFacet(y.cancelSourceFacet,B)})))&&e.attach({dispose:I.token.subscribe(function(){D.abort()})});J.label=2;case 2:J.trys.push([2,4,,5]);return[4,F.promise];case 3:J.sent();return[3,5];case 4:if((q=J.sent())instanceof v.CancelError)throw q;if(N.default.isCanceled(q))throw new v.CancelError;if(q instanceof b.UploadError)throw new s.UploadItemOperationError({facets:L(q),innerError:q});if(x.isErrorData(q))throw new s.UploadItemOperationError({facets:n.__assign(n.__assign({},"-2130575257"===q.code?n.__assign({},E.conflictErrorFacet.pack({supportsRename:!1})):n.__assign({},E.retryErrorFacet.pack({}))),T.spErrorDataFacet.pack(q)),message:x.getErrorMessage(q)});throw q;case 5:if(!(R=D.item.peek()))throw new b.UploadError({message:"No item created during upload.",errorType:w.UploadErrorType.general,code:"ClientNoCreatedItem"});U=R.properties;z=U&&U.ID;W=U&&U.uniqueId;if(!z)throw new b.UploadError({message:"No item id determined after upload.",errorType:w.UploadErrorType.general,code:"ClientNoAssignedItemId"});X=i.spItemKeyFacet.serialize({webAbsoluteUrl:M,listFullUrl:_,itemId:z});A(m.resolveItems({items:($={},$[X]=n.__assign(n.__assign(n.__assign(n.__assign({},T.folderPathFacet.pack(R.id)),g.displayNameFacet.pack(R.displayName)),W?T.uniqueIdFacet.pack(W):{}),g.parentFolderItemFacet.pack({itemKey:d})),$)}));return[2,{itemKey:X}]}})})})];case 3:return[2,I.sent()]}})})}}}}}});function L(e){switch(e.errorType){case w.UploadErrorType.conflict:return n.__assign({},E.conflictErrorFacet.pack({supportsRename:!1}));case w.UploadErrorType.accessDenied:return n.__assign({},E.accessDeniedErrorFacet.pack({}));case w.UploadErrorType.disconnected:return n.__assign({},E.offlineErrorFacet.pack({}));case w.UploadErrorType.emptyFileOrFolder:case w.UploadErrorType.emptyFileOrFolderForDocLib:return n.__assign({},E.emptyFolderUnsupportedFacet.pack({}));case w.UploadErrorType.folderUploadNotSupported:return n.__assign({},E.folderUploadUnsupportedFacet.pack({}));case w.UploadErrorType.invalidName:return n.__assign({},E.invalidNameErrorFacet.pack({}));case w.UploadErrorType.lockMismatch:return n.__assign({},E.lockMismatchErrorFacet.pack({}));case w.UploadErrorType.malwareDetected:return n.__assign({},E.malwareErrorFacet.pack({}));case w.UploadErrorType.overQuota:return n.__assign({},E.overQuotaErrorFacet.pack({}));case w.UploadErrorType.targetFolderMissing:return n.__assign({},E.targetFolderErrorFacet.pack({}));case w.UploadErrorType.throttled:return n.__assign({},E.throttleErrorFacet.pack({}));case w.UploadErrorType.versionMismatch:return n.__assign({},E.versionMismatchFacet.pack({}))}return n.__assign({},E.retryErrorFacet.pack({}))}});
define("mJe",["require","exports","ww","fTe","Ex","zi","Be","v"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var a=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getAppSubfolder=function(e){return e?"odb":"splist"};t.prototype.getDefaultClickUrl=function(t,n){void 0===n&&(n={});return t?s.isGenericList(this._listContext().listTemplateType)&&t.type===i.default.File?this.getDisplayFormUrl(t):e.prototype.getDefaultClickUrl.call(this,t,n):""};t.prototype.getRecycleBinQueryUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/RecycleBin.aspx"};t.prototype.getUriWithAdjustForCurrentRootFolder=function(e){var t=new o.default(e),n=this.getCurrentItemKey();if(n){var r=this.getKeyParams(n).id;t.setQueryParameter("RootFolder",r)}return t};t.prototype.getNewFormUrl=function(t){var n=e.prototype._getListItemFormUrl.call(this,this._listContext().newFormUrl),r=this.getUriWithAdjustForCurrentRootFolder(n);t&&r.setQueryParameter("ContentTypeId",t);return r.toString()};t.prototype.getQuickLaunchSettingsUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/quiklnch.aspx"};t.prototype.getAreaNavigationSettingsUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/AreaNavigationSettings.aspx"};t.prototype.getTopNavSettingsUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/topnav.aspx"};t.prototype.getWACResourcesPreloadUrl=function(){return e.prototype.getWACResourcesPreloadUrl.call(this)};t.prototype.getWopiDocUrl=function(){return e.prototype.getWopiDocUrl.call(this)};t.prototype.getSitePagesUrl=function(){return this.getWebUrl()+"/SitePages/Forms/AllPages.aspx"};t.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")};t.prototype.getNavLinkClickUrl=function(e){return this._urlDataSourceLite.getNavLinkClickUrl(e)};return t})(r.default);t.default=a;t.resourceKey=u.createResolvedResourceKey(e("module").id,a)});
define("NXe",["require","exports","ww","r","Mc","jXe","g","BXe","A3"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FullscreenAction=void 0;t.FullscreenAction=s.createComponentWithSPOAppContext([s.ContextKeys.pageControls,s.ContextKeys.resources])(function(e){var t=e.pageControls,f=e.resources,l=t.isFullscreen,c=f.consume(u.resourceKey);return r.createElement(i.Action,{isToggled:l,engagement:{isIntentional:!0,name:l?"FullscreenListOff":"FullscreenListOn"},onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){t=f.consume(o.pageContext);(r=t&&t.listUrl)&&c.setFullscreenToStorage(!l,r);a.default.raise(document.body,"resize",void 0,!0);e.handleContextDataChange(((i={})[s.ContextKeys.pageControls]={isFullscreen:!l},i));return[2]})})}})})});
define("KXe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hotMainComponent=t.pageControls=t.paneControls=t.resources=t.itemsScopeCurrentItemKey=t.responsiveUIMetrics=t.viewParams=t.legacyMode=void 0;t.legacyMode="legacyMode";t.viewParams="viewParams";t.responsiveUIMetrics="responsiveUIMetrics";t.itemsScopeCurrentItemKey="itemsScopeCurrentItemKey";t.resources="resources";t.paneControls="paneControls";t.pageControls="pageControls";t.hotMainComponent="hotMainComponent"});
define("VXe",["require","exports","ww","A3","v","KXe"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.SPOAppContextHandler=t.ContextKeys=void 0;t.ContextKeys=s;var o=(function(){function e(){this._events=new r.default(this);this._events.declare("contextUpdated")}e.prototype.registerContextChangeHandler=function(e){this._handleContextDataChange=e};e.prototype.update=function(e){this._handleContextDataChange&&this._handleContextDataChange(e)};e.prototype.onUpdated=function(e){this._events.on(this,"contextUpdated",e)};e.prototype.offUpdated=function(e){this._events.off(this,"contextUpdated",e)};e.prototype.notifyUpdate=function(e){this._contextData=e;this._events.raise("contextUpdated",e)};e.prototype.getContext=function(){return n.__assign({},this._contextData)};e.prototype.dispose=function(){this._events.dispose()};return e})();t.SPOAppContextHandler=o;t.resourceKey=new i.ResourceKey({name:e("module").id+"s",factory:new i.SimpleResourceFactory(o)})});
define("zXe",["require","exports","tg","bH","LO","LO","GXe","Exe","F2","KXe","BXe","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createSPOAppContextData=t.ContextItemUpdateMethod=void 0;var h;(function(e){e[e.READONLY=0]="READONLY";e[e.REPLACE=1]="REPLACE";e[e.PATCH=2]="PATCH"})(h=t.ContextItemUpdateMethod||(t.ContextItemUpdateMethod={}));t.createSPOAppContextData=function(e,t){var p;void 0===t&&(t={});var d=e.consume(o.resourceKey),v=e.consume(n.navigation),m={name:f.legacyMode,updateMethod:h.REPLACE,data:!1},g={name:f.viewParams,data:v.viewParams,updateMethod:h.REPLACE,onChange:function(t,n){e.consume(i.originalViewParams)&&r.default(e.consume(i.originalViewParams),n);var o=e.consume(s.viewParams.optional);o&&o(n);d.updateViewParams(n)}};g.data&&d.updateViewParams(g.data);var y=e.consume(a.resourceKey),b={name:f.responsiveUIMetrics,updateMethod:h.PATCH,data:y.metrics},w={name:f.resources,updateMethod:h.READONLY,data:e},E={name:f.itemsScopeCurrentItemKey,data:e.consume(u.resourceKey).currentItemKey,updateMethod:h.REPLACE,onChange:function(t,n){if(n!==t){e.consume(u.resourceKey).currentItemKey=n;d.openItem(n)}}},S={name:f.paneControls,updateMethod:h.PATCH,data:{isLeftNavExpanded:!1,isRightPaneExpanded:!1,isInfoPaneExpanded:!1,isFiltersPaneExpanded:!1,isColumnCustomizationPaneExpanded:!1,isO365FlexPaneVisible:!1,isTipsNTricksPaneVisible:!1}},x=e.consume(l.resourceKey.optional),T=!c.default.isActivated("E6C29515-A1B5-472F-9759-B19A2BE8C623","02/11/20","Get fullscreen list setting from local storage")&&x&&x.getFullscreenFromStorage();return{legacyMode:m,viewParams:g,responsiveUIMetrics:b,resources:w,itemsScopeCurrentItemKey:E,paneControls:S,pageControls:{name:f.pageControls,updateMethod:h.PATCH,data:{canUserSelect:!0,isSuiteNavHamburgerVisible:y.metrics.isHamburgerVisible,isFullscreen:!!T}},hotMainComponent:{name:f.hotMainComponent,updateMethod:h.REPLACE,data:null!==(p=t[f.hotMainComponent])&&void 0!==p?p:void 0}}}});
define("jXe",["require","exports","ww","So","bo","r","F2","KXe","zXe","VXe"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createNewContextData=t.createComponentWithSPOAppContext=t.pickContextItems=t.SPOAppContextProvider=t.ContextKeys=void 0;t.ContextKeys=u;var l=s.createContext({}),c=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._isDisposed=!1;r._handleContextChange=function(e){if(!r._isDisposed){var t=r.state,i=t.contextData,s=t.handleContextDataChange,o=p(i,e);if(!o)return null;r.setState({contextData:o,handleContextDataChange:s},function(){r._contextHandler.notifyUpdate(n.__assign({},o))})}};r._contextHandler=t.resources.consume(f.resourceKey);r._setContextInitState();return r}t.prototype.componentDidMount=function(){this._contextHandler.registerContextChangeHandler(this._handleContextChange);this._contextHandler.notifyUpdate(n.__assign({},this.state.contextData))};t.prototype.componentWillUnmount=function(){this._isDisposed=!0;this._stopListener&&this._stopListener()};t.prototype.render=function(){return s.createElement(l.Provider,{value:this.state},this.props.children)};t.prototype._setContextInitState=function(){var e=this,t=this.props,r=t.resources,i=t.overrideContextData,s=r.consume(o.resourceKey);this._stopListener=s.listen(function(t){var r;e._handleContextChange(((r={})[u.responsiveUIMetrics]=n.__assign({},t),r))});this.state={contextData:a.createSPOAppContextData(r,i),handleContextDataChange:this._handleContextChange}};return t})(s.PureComponent);t.SPOAppContextProvider=c;function h(e,t){for(var n=t.contextData,r={handleContextDataChange:t.handleContextDataChange},i=[],s=0,o=e;s<o.length;s++){var u=o[s],a=n[u].data;r[u]=a;i.push(a)}return{pickedContext:r,contextDeps:i}}t.pickContextItems=h;t.createComponentWithSPOAppContext=function(e){return function(t){return function(r){var i=s.useContext(l),o=h(e,i),u=o.pickedContext,a=o.contextDeps,f=t;return s.useMemo(function(){return s.createElement(f,n.__assign({},u,r))},n.__spreadArrays(a,[r]))}}};function p(e,t){var n={},s=!1;for(var o in t){var u=e[o],f=u.data,l=t[o],c=void 0;switch(u.updateMethod){case a.ContextItemUpdateMethod.READONLY:throw'Read-only SPOAppContextItem "'+o+'" cannot be updated';case a.ContextItemUpdateMethod.REPLACE:c=l;break;case a.ContextItemUpdateMethod.PATCH:default:c=r.graft(f,l)}if(i.areShallowDifferent(f,c)){s=!0;n[o]={data:new r.ReplacePatch(c)};u.onChange&&u.onChange(f,c)}}return s?r.graft(e,n):null}t.createNewContextData=p});
define("Y$e",["require","exports","ww","r","dce","ODBItemsScopeDeferred_mini_css","t_","J$e","OL","Zm","U1","gJe","CQ","OQ","gQ","sz","jP","Ex","g","Uxe"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";s=s.ContentCenterModelImportBanner_module_1;Object.defineProperty(t,"__esModule",{value:!0});t.ContentCenterModelImportBanner=void 0;var w=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._renderBannerActionComponent=function(){return r.createElement(i.Stack,{horizontal:!0,gap:30},r.createElement(i.Stack.Item,null,r.createElement("h2",{className:s.bannerHeaderTagStyle},r.createElement(a.Text,{className:s.bannerPrimaryText},u.default.BannerHeader))),r.createElement(i.Stack.Item,null,r.createElement(i.Stack,{horizontal:!0,gap:15,className:s.buttonStack},r.createElement(f.PrimaryButton,{disabled:n.state.isImportButtonDisabled,ariaLabel:u.default.ImportSampleButtonText,onClick:n._onImportClicked},u.default.ImportSampleButtonText))))};n._getOneDriveItem=function(){var e=new v.default("BenefitChangeNotice");e.name="BenefitChangeNotice";e.extension="classifier";e.displayName="BenefitChangeNotice";e.key="BenefitChangeNotice";return e};n._createOperation=function(){var e=n.props.resources.consume(d.resourceKey),t=n._getOneDriveItem(),r=e.register({name:t.name||"",iconName:m.getIconNameFromItem({type:g.default.Unknown,extension:t.extension}),type:h.default.importModel,payloads:{importModel:{item:t}}});r.progress.maximum(1);r.progress.current(0);r.state(p.default.started);return r};n._onImportClicked=function(){var e,t=n._createOperation();n.setState({isImportButtonDisabled:!0});null===(e=n._contentCenterDataSource)||void 0===e||e.importModel().then(function(e){var r;if(e&&"Model already exists"!==e){t.state(p.default.completed);n.props.onDismiss();null===(r=n._contentCenterDataSource)||void 0===r||r.navigateToModelHomePage(e)}else if("Model already exists"===e){n.props.onDismiss();t.state(p.default.canceled)}else{n.setState({isImportButtonDisabled:!1});t.state(p.default.failed)}}).catch(function(e){return t.state(p.default.failed)})};var o=n.props.resources;n._contentCenterDataSource=o&&o.consume(c.resourceKey);n.state={isSampleModelPresent:!0,isImportButtonDisabled:!1};return n}t.prototype.componentDidMount=function(){var e,t=this;null===(e=this._contentCenterDataSource)||void 0===e||e.checkIfModelExists().then(function(e){return t.setState({isSampleModelPresent:!0})}).catch(function(e){return t.setState({isSampleModelPresent:!1})})};t.prototype.render=function(){return this.state.isSampleModelPresent?null:r.createElement(i.Stack,{horizontal:!0,className:s.container},r.createElement(i.Stack.Item,{className:s.imageContainer},r.createElement("img",{alt:u.default.ModelImportImageAltText,height:"140px",src:window.require.toUrl("odsp-media/images/contentcenter/modelimporticon.png")})),r.createElement(i.Stack.Item,{className:s.bannerContent},r.createElement(i.Stack,null,r.createElement(i.Stack.Item,null,r.createElement(i.Stack,{className:s.bannerPrimaryContent},r.createElement(i.Stack.Item,{className:s.closeButtonDiv},r.createElement(o.IconButton,{ariaLabel:u.default.DismissButtonAriaLabel,className:s.closeButton,title:u.default.DismissButtonAriaLabel,onClick:this.props.onDismiss,iconProps:{iconName:"ChromeClose"}})),r.createElement(i.Stack.Item,{className:s.bannerHeaderContent},this._renderBannerActionComponent()))),r.createElement(i.Stack.Item,{className:s.descriptionContainer},r.createElement("div",{className:s.descriptionText},r.createElement(a.Text,null,u.default.BannerDescriptionText))))))};return t})(r.Component);t.ContentCenterModelImportBanner=function(e){var t=l.useResourceScope(),n=t.consume(y.pageContext),i=!b.get("hideContentCenterModelImport"),s=r.useState(i),o=s[0],u=s[1];return o?r.createElement(w,{onDismiss:function(){u(!1);var e=n.webAbsoluteUrl,t=(new Date).getTime()+864e5;b.set("hideContentCenterModelImport","true",{expires:t,path:e})},resources:t}):null}});
define("GXe",["require","exports","ww","v","Axe","p3","D_","Fb","So","qi","Z2","Yb","Exe","$b"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=t.ItemsScopeHelper=void 0;var d=new c.default,v=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.openActionControlHandler=function(e,t){throw new Error("Not Implemented")};r._itemsScopeItemKey=n.itemsScopeKeys.itemKey;r._itemCacheStore=n.itemCacheStore;r._itemCacheStore.dispatch(o.blockItemPage());return r}t.prototype.unblockItemPageRender=function(){var e=this;d.setTimeout(function(){return e._itemCacheStore.dispatch(o.unblockItemPage())},0)};t.prototype.updateViewParams=function(e){var t;(0,this._itemCacheStore.dispatch)(s.resolveItems({items:(t={},t[this._itemsScopeItemKey]=f.pack({viewParams:u.currentViewParamsFacet},{viewParams:new a.MirrorPatch(e)}),t)}))};t.prototype.openItem=function(e){var t=this._itemCacheStore.dispatch,n=this._nextOpenItem;if(n){this._nextOpenItem=void 0;t(n)}else t(p.openItemWithAddon({itemsScopeItemKey:this._itemsScopeItemKey,currentItemKey:e}))};t.dependencies=n.__assign(n.__assign({},l.default.dependencies),{itemsScopeKeys:h.resourceKey,itemCacheStore:i.resourceKey});return t})(l.default);t.ItemsScopeHelper=v;t.resourceKey=r.createResolvedResourceKey(e("module").id,v)});
define("VZe",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.flowTemplateItemFacet=t.flowItemFacet=void 0;t.flowItemFacet=new n.Facet("flow");t.flowTemplateItemFacet=new n.Facet("flowTemplate")});
define("az",["require","exports","ww","cs","Bc","Vb","xv","jS","ys","Ex","jP","Tb","zb","nm","Gi","iz","N3","Ah","Gi","qS","Je"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.oneDriveItemFacet=void 0;var E=w.default.isActivated("05C4FA92-0F9B-44BF-93E9-70913775DFAE","11/12/2020","Avoid demanding parent item data just to determine identity");t.oneDriveItemFacet=new r.ComputedItemFacet("oneDriveItem",function(e,t){var r=t.itemKey,w=e.demandItemFacet(h.knockoutStoreIdentityFacet,r);if(void 0!==w){var S=w.key,x=w.id,T=e.demandItemFacet(i.displayNameFacet,r),N=e.demandItemFacet(i.fileNameFacet,r),C=N&&N.name||"",k=N&&N.extension||"",L=e.demandItemFacet(s.driveItemKeyFacet,r),A=e.demandItemFacet(i.fileSizeFacet,r),O=e.demandItemFacet(i.folderFacet,r),M=e.demandItemFacet(i.dateModifiedFacet,r),_=e.demandItemFacet(a.localeFacet,a.configurationItemKey),D=_&&_.language||window.navigator.language,P=e.demandItemFacet(i.openUrlFacet,r),H=O?f.default.Folder:f.default.File,B=l.getIconNameFromItem({type:H,extension:k,textEditorMimeType:void 0}),j=e.demandItemFacet(p.countFacet,r),F=e.demandItemFacet(d.officeAppFacet,r),I=e.demandItemFacet(v.sharedFacet,r),q=I&&new Date(I.sharedDateTime).getTime(),R=e.demandItemFacet(i.dateCreatedFacet,r),U=e.demandItem({createdByPerson:g.createdByPersonFacet},r).createdByPerson,z=e.demandItemFacet(y.uniqueIdFacet,r),W=e.demandItemFacet(y.listItemIdFacet,r),X=e.demandItemFacet(y.listIdFacet,r),V=e.demandItemFacet(i.parentFolderItemFacet,r,{suppressGetItems:!1}),$=V&&V.itemKey,J=e.demandItemFacet(h.knockoutStoreIdentityFacet,$,{suppressGetItems:!E}),K=J&&J.key,Q=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({key:S,queryType:o.default.Files,displayType:o.default.Files,id:x},L?{itemId:L.itemId}:{}),L?{graph:{itemId:L.itemId,driveId:L.driveId}}:{}),C?{name:C}:{}),T?{displayName:T}:{}),k?{extension:k}:{}),void 0!==A?{size:A}:{}),{type:O?f.default.Folder:f.default.File}),O?{folder:{}}:{}),{childCount:j}),K?{parentKey:K}:{}),void 0===M||isNaN(M)?{}:{dateModifiedTime:new Date(M),dateModified:u.getRelativeDateTimeStringPast(new Date(M),D)}),void 0===R||isNaN(R)?{}:{dateCretedTime:new Date(R),dateCreated:u.getRelativeDateTimeStringPast(new Date(R),D)}),void 0===q||isNaN(q)?{}:{dateSharedTime:new Date(q),dateShared:u.getRelativeDateTimeStringPast(new Date(q),D)}),{properties:n.__assign(n.__assign(n.__assign({},z?{uniqueId:b.normalizeLower(z,!0)}:{}),X?{listId:b.normalizeLower(X,!0)}:{}),W?{ID:W}:{})}),B?{iconName:B}:{}),F?{appMap:F}:{}),{urls:{}}),P?{openUrl:P}:{}),{creatorName:U&&U.displayValue,isPlaceholder:!e.isItemFacetResolved(i.displayNameFacet,r),state:{},recycleBinProperties:{},reputationProperties:{},statistics:{}}),G=e.demandItemFacet(m.oneDriveItemControl,c.odspNextAppItemKey);return m.oneDriveItemControl.evaluate(G)(e,{itemKey:r,key:S,item:Q}).item}})});
define("Tet",["require","exports","qi"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.powerBIReportFacet=void 0;t.powerBIReportFacet=new n.Facet("powerBI")});
define("Z$e",["require","exports","v","Ex","Gi","Qi","Tx","Px","Tb","xv"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{},create:function(e){return{instance:function(e,t){var n=t.itemKey;if(!t.item)return{};var l={},c=e.demandItemFacet(i.permissionsFacet,n);l.permissions=c;var h=e.demandItemFacet(s.spWebKeyFacet,n),p=e.demandItemFacet(s.spLibrariesItemSetKeyFacet,n),d=e.demandItemFacet(s.spAllSitesKeyFacet,n),v=e.demandItemFacet(u.searchItemSetKeyFacet,n),m=e.demandItemFacet(o.searchItemsRootItemKeyFacet,n),g=e.demandItemFacet(s.spOneDriveDocumentLibraryKeyFacet,n),y=e.demandItemFacet(a.odspNextQueryRootKeyFacet,n);if(h||p||d||g||y||m||v){if(p)l.queryType=l.displayType=f.default.DocumentLibraries;else if(d)l.queryType=l.displayType=f.default.Subsites;else if(m||v)l.queryType=l.displayType=f.default.Search;else if(y){var b=y.queryType;l.queryType=l.displayType=b}l.folder={};l.type=r.default.Folder}return{item:l}}}}}})});
define("Eet",["require","exports","Nm","Fie","U1"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withCoachmarkProvider=void 0;t.withCoachmarkProvider=function(e){return function(t){return i.withResources()(n.injectInitialProps(function(t){return{coachmarkCampaign:e,coachmarkProvider:t.resources.consume(r.resourceKey.optional)}})(t))}}});
define("L$e",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.alert=function(t,n,r,i){void 0===r&&(r=!1);var s="sp_a11y_alert_"+t,o=document.querySelector("#"+s);o&&document.body.removeChild(o);var u=document.createElement("p");r||u.setAttribute("style",e._cssHidden);i&&u.classList.add(i);u.setAttribute("role","alert");u.setAttribute("aria-live","assertive");u.setAttribute("id",s);var a=document.createTextNode(n);document.body.appendChild(u);u.appendChild(a)};e._cssHidden="position:absolute;text-indent:-9999px;\n    width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0;";return e})();t.default=n});
define("qJe",["require","exports","fB","Je","fe"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.parseAIBuilderEnvironmentConfig=t.getViewAIBuilderModelRunTimeHost=t.getCreateAIBuilderModelRunTimeHost=t.isPowerAppsTestEnvSupportedKillSwitchActivated=t.getAIBuilderRunTimeHost=void 0;t.getAIBuilderRunTimeHost=function(){var e="make.powerapps.com";n.isFeatureEnabled(n.PreviewAIBuilder)?e="make.preview.powerapps.com":n.isFeatureEnabled(n.PowerAppsAndAndProcessSimpleTestEnvironment)&&(e="make.test.powerapps.com");return e};t.isPowerAppsTestEnvSupportedKillSwitchActivated=r.default.isActivated("ABCAE0FE-AF77-4DEF-BD52-6F9DCDF43685","11/19/2020","Better support for make.test.powerapps.com");var s="make.powerapps.com",o="make.preview.powerapps.com",u="make.test.powerapps.com";t.getCreateAIBuilderModelRunTimeHost=function(){var e={hostName:s,isTest:!1};if(n.isFeatureEnabled(n.PowerAppsAndAndProcessSimpleTestEnvironment)){e.hostName=u;e.isTest=!0}if(n.isFeatureEnabled(n.PreviewAIBuilder)){e.hostName=o;e.isTest=!1}return e};t.getViewAIBuilderModelRunTimeHost=function(e){var t={hostName:s,isTest:!1};n.isFeatureEnabled(n.PreviewAIBuilder)&&(t.hostName=o);if(e){t.hostName=u;t.isTest=!0}return t};var a={envName:void 0,isDefault:void 0,testEnvName:void 0,isTestEnvDefault:void 0};t.parseAIBuilderEnvironmentConfig=function(e){if(!e)return a;try{return JSON.parse(e)}catch(t){i.default.log("[AIBuilderHelper] failed to parse aiBuilderEnvConfig: "+e+" "+t);return a}}});
define("w3",["require","exports","bg"],function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});t.getResponsiveModeClassName=void 0;var i=((r={})[n.ResponsiveMode.small]="sm",r[n.ResponsiveMode.medium]="md",r[n.ResponsiveMode.large]="lg",r[n.ResponsiveMode.xLarge]="xlg",r[n.ResponsiveMode.xxLarge]="xxlg",r[n.ResponsiveMode.xxxLarge]="xxxlg",r[n.ResponsiveMode.unknown]="",r);t.getResponsiveModeClassName=function(e){return i[e]}});
define("BXe",["require","exports","v","g"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;var i=(function(){function e(e,t){this._pageContext=t.pageContext}e.prototype.setFullscreenToStorage=function(e,t){if(window&&window.localStorage)try{var n=localStorage&&localStorage.getItem("sp-fullscreen-list");if(n){var r=JSON.parse(n);e?r[t]=!0:delete r[t];localStorage.setItem("sp-fullscreen-list",JSON.stringify(r))}else this._setInitialFullscreenToStorage(e,t)}catch(n){this._setInitialFullscreenToStorage(e,t)}};e.prototype.getFullscreenFromStorage=function(){var e=this._pageContext&&this._pageContext.listUrl,t=localStorage&&localStorage.getItem("sp-fullscreen-list"),n=!1;if(t&&e)try{n=!!JSON.parse(t)[e]}catch(e){}return n};e.prototype._setInitialFullscreenToStorage=function(e,t){var n,r=((n={})[t]=e,n);localStorage.setItem("sp-fullscreen-list",JSON.stringify(r))};e.dependencies={pageContext:r.pageContext};return e})();t.default=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i)});
define("VJe",["require","exports","Vs","Qi","Gi","zi","Je"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isCheckSharePointSyntexLicenseKillSwitchActivated=t.getListSyntexContext=void 0;t.getListSyntexContext=function(e){var t=n.getCurrentItemSetKey(e),o=e.demandItemFacet(r.spFolderItemSetKeyFacet,t),u=o&&r.spListKeyFacet.serialize(o),a=e.demandItemFacet(i.listFacet,u),f=!!a&&!!a.flags2&&4096==(4096&a.flags2)&&!!(null==a?void 0:a.isDocumentLibrary)&&(null==a?void 0:a.templateType)!==s.default.webPageLibrary&&(null==a?void 0:a.templateType)!==s.default.contentCenterSampleLibrary&&(null==a?void 0:a.templateType)!==s.default.contentCenterModelLibrary&&(null==a?void 0:a.templateType)!==s.default.mySiteDocumentLibrary,l=!!a&&!!a.flags2&&8192==(8192&a.flags2)&&!!(null==a?void 0:a.isDocumentLibrary)&&(null==a?void 0:a.templateType)!==s.default.webPageLibrary&&(null==a?void 0:a.templateType)!==s.default.contentCenterModelLibrary&&(null==a?void 0:a.templateType)!==s.default.mySiteDocumentLibrary,c=!!a&&!!a.machineLearningCaptureEnabled,h=!!a&&!!a.aiBuilderEnabled;return{listId:a?a.id:void 0,listTemplateType:null==a?void 0:a.templateType,webAbsoluteUrl:o?o.webAbsoluteUrl:void 0,isMachineTeachingModelApplied:f,isPredictionModelApplied:l,isMachineLearningCaptureEnabled:c,isAIBuilderEnabled:h}};t.isCheckSharePointSyntexLicenseKillSwitchActivated=o.default.isActivated("64C2342B-1DE8-4D4C-9C44-C1A5F33143CC","10/20/2020","Check SharePoint Syntex License")});
define("JJe",["require","exports","Tb","zi","Gi","fv"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.computeIsTeamSiteInODB=void 0;t.computeIsTeamSiteInODB=function(e,t){var o=e.demandItemFacet(i.spPageContextFacet,n.odspNextAppItemKey),u=!!o&&Number(o.webTemplate)===s.default.mySite,a=t&&t.listBaseTemplate===r.default.mySiteDocumentLibrary;return u&&!a}});
define('ODBItemsScopeDeferred_mini_css',["nt","Ew"],function(e){"use strict";e.loadStyles([{"rawString":".topCollaPlaceHolder_d98a3068{display:-webkit-box;display:-ms-flexbox;display:flex;min-width:13px;height:21px}[dir='ltr'] .topCollaPlaceHolder_d98a3068{padding-right:10px}[dir='rtl'] .topCollaPlaceHolder_d98a3068{padding-left:10px}.topCollaboratorIcon_d98a3068{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_d98a3068{font-weight:700}.topCollaboratorTooltip_d98a3068{padding:0 2px}.userWithTopCollaborator_d98a3068{display:-webkit-box;display:-ms-flexbox;display:flex}.userWithTopCollaborator_d98a3068 .topCollaPlaceHolder_d98a3068{min-width:13px}[dir='ltr'] .userWithTopCollaborator_d98a3068 .topCollaPlaceHolder_d98a3068{padding-right:7px}[dir='rtl'] .userWithTopCollaborator_d98a3068 .topCollaPlaceHolder_d98a3068{padding-left:7px}[dir='ltr'] .columnHeader_d98a3068{margin-left:20px}[dir='rtl'] .columnHeader_d98a3068{margin-right:20px}\n"},{"rawString":".root_496c5d97{margin-top:15px;margin-bottom:15px;font-size:17px}[dir='ltr'] .root_496c5d97{margin-left:96px}[dir='rtl'] .root_496c5d97{margin-right:96px}\n"},{"rawString":".iconContainer_7dd788dd{position:relative;font-size:16px;margin:0 4px;height:16px;width:16px}.menuItemIconContainer_7dd788dd{position:relative;margin:0 4px;height:32px;width:14px}.logoFillIcon_7dd788dd,.logoIcon_7dd788dd{position:absolute;left:0;right:0}.logoFillIcon_7dd788dd[data-icon-name='ExcelLogo16'],.logoIcon_7dd788dd[data-icon-name='ExcelLogo16']{color:#217346}.logoFillIcon_7dd788dd[data-icon-name='OneNoteLogo16'],.logoIcon_7dd788dd[data-icon-name='OneNoteLogo16']{color:#5c2d91}.logoFillIcon_7dd788dd[data-icon-name='PowerPointLogo16'],.logoIcon_7dd788dd[data-icon-name='PowerPointLogo16']{color:#d24726}.logoFillIcon_7dd788dd[data-icon-name='WordLogo16'],.logoIcon_7dd788dd[data-icon-name='WordLogo16']{color:#2b579a}.logoFillIcon_7dd788dd[data-icon-name='VisioLogo16'],.logoIcon_7dd788dd[data-icon-name='VisioLogo16']{color:#3854a2}.logoFillIcon_7dd788dd{color:#ffffff}.contextualMenuItemLinkContent_7dd788dd{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.contextualMenuItemTextLabel_7dd788dd{margin:0 4px;vertical-align:middle;display:inline-block;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}\n"},{"rawString":".root_c4c46d59{margin-top:15px;margin-bottom:15px;font-size:17px}[dir='ltr'] .root_c4c46d59{margin-left:96px}[dir='rtl'] .root_c4c46d59{margin-right:96px}\n"},{"rawString":".saveViewDialogTextField_3cbf8109{margin-bottom:8px}.saveViewDialogCheckbox_3cbf8109{min-height:36px}.saveViewDialogSpinner_3cbf8109{display:inline-block;padding-bottom:7px;vertical-align:bottom}\n"},{"rawString":".syncDialog_f917fdca{-webkit-box-shadow:rgba(0,0,0,0.22) 0px 25.6px 57.6px;box-shadow:rgba(0,0,0,0.22) 0px 25.6px 57.6px;text-align:center}.syncDialogContent_f917fdca{margin:0 -8px;overflow-x:hidden}.syncDialogContent_f917fdca .syncImg_f917fdca{width:100%;max-width:100%;-webkit-transform:scale(1.2, 1.2);transform:scale(1.2, 1.2);margin-bottom:20px;margin-top:10px;height:278px}.copyLibraryId_f917fdca{height:10px;color:#0000ee;padding:9px 0;font-size:14px;font-weight:600}.pointerText_f917fdca{text-decoration:none}.footNote_f917fdca{font-size:12px}.syncTitle_f917fdca{font-weight:600;font-size:20px}.contentContainer_f917fdca{margin:10px 0px}.adminContentContainer_f917fdca{margin:2.5px -2.5px}.separator_f917fdca{margin:-5px}.errorContainer_f917fdca{padding:10px;color:#a80000;background-color:#fde7e9}.errorTitle_f917fdca{font-weight:600}.spinner_f917fdca{padding:4px}\n"},{"rawString":".customActionCommandIcon_4e556d3a{width:16px;height:16px}\n"},{"rawString":".needsAttentionIconOverlay_6e57506a{position:relative}.needsAttentionIconOverlay_6e57506a:after{content:'';position:absolute;top:-3px;height:8px;width:8px;border-radius:8px;background-color:#a80000}[dir='ltr'] .needsAttentionIconOverlay_6e57506a:after{left:15px}[dir='rtl'] .needsAttentionIconOverlay_6e57506a:after{right:15px}.needsAttentionIcon_6e57506a{color:#a80000}\n"},{"rawString":".alert_b1843c56{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}[dir='ltr'] .filterPanelClearAllButton_b1843c56{margin-left:8px}[dir='rtl'] .filterPanelClearAllButton_b1843c56{margin-right:8px}.filterPanelRoot_b1843c56 .ms-Panel-content{padding-bottom:0px}.filterPanelFooter_b1843c56{display:-webkit-box;display:-ms-flexbox;display:flex}.filterPanelSuggestionsNone_b1843c56{text-align:center;color:"},{"theme":"info","defaultValue":"#666666"},{"rawString":";font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";line-height:30px}.filterPanelSuggestionItem_b1843c56{overflow:auto;overflow-wrap:break-word;padding:7px 12px}html[dir='ltr'] .filterPanelSuggestionItem_b1843c56{text-align:left}html[dir='rtl'] .filterPanelSuggestionItem_b1843c56{text-align:right}.peoplePickerRoot_b1843c56{margin-bottom:12px}.peoplePickerRoot_b1843c56 .ms-BasePicker-text{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.filterPickerRoot_b1843c56{margin-bottom:8px}\n"},{"rawString":".IFrameDialog_3b24ebc2 .ms-Dialog-main{width:100%;max-width:600px}.IFrameDialog_3b24ebc2 iframe{border:none;width:100%}\n"},{"rawString":".commentRoot_7276829d{margin-top:20px}.approveRejectDialogSpinner_7276829d{display:inline-block;padding-bottom:7px;vertical-align:bottom}.approveRejectDialogMessageBar_7276829d{margin-bottom:8px}.approveRejectDialogStatusLabel_7276829d{font-weight:600}\n"},{"rawString":".odSitePinIcon_6b85bac2{padding:6px 8px}.odSitePinButtonDefault_6b85bac2{background-color:Transparent;border:none;color:grey;float:right;display:inline}.odSitePinButtonDefault_6b85bac2 :hover{color:#4a8aef}.odSitePinButtonHover_6b85bac2{background-color:Transparent;border:none;color:grey;float:right;display:none}.odSitePinButtonHover_6b85bac2 :hover{color:#4a8aef}.odSitePinPinHover_6b85bac2{background-color:Transparent;border:none;color:grey;float:right;display:none}.odSitePinPinHover_6b85bac2 :hover{color:#4a8aef}.sitePinLeftNavParent_6b85bac2{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;height:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.sitePinLeftNavParent_6b85bac2:hover .odSitePinButtonDefault_6b85bac2{display:none}.sitePinLeftNavParent_6b85bac2:hover .odSitePinButtonHover_6b85bac2{display:inline}.sitePinLeftNavParent_6b85bac2:hover .odSitePinPinHover_6b85bac2{display:none}.sitePinAllSitesParent_6b85bac2:hover .odSitePinButtonDefault_6b85bac2{display:none}.sitePinAllSitesParent_6b85bac2:hover .odSitePinButtonHover_6b85bac2{display:inline}.sitePinAllSitesParent_6b85bac2:hover .odSitePinPinHover_6b85bac2{display:none}.odSitePinContainer_6b85bac2{z-index:1;opacity:0.99}.odSitePinContainer_6b85bac2:hover .odSitePinButtonDefault_6b85bac2{display:none}.odSitePinContainer_6b85bac2:hover .odSitePinButtonHover_6b85bac2{display:none}.odSitePinContainer_6b85bac2:hover .odSitePinPinHover_6b85bac2{display:inline}\n"},{"rawString":".folderCover_30e6a311{margin:3px}.blankFolderCover_30e6a311{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";display:inline-block}\n"},{"rawString":".name_22e50cfa{font-size:16px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-weight:600}\n"},{"rawString":".acronym_9c941adf{position:relative;width:24px;height:24px;border-radius:2px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden}.acronymText_9c941adf{display:block;text-align:center;color:white;font-size:9px;font-weight:100;line-height:12px;margin:0px}.siteLogo_9c941adf{position:absolute;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:2px}.siteLogoHidden_9c941adf{display:none}\n"},{"rawString":".root_8026515c{display:-webkit-box;display:-ms-flexbox;display:flex;position:absolute;top:0;left:0;bottom:0;right:0;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.root_8026515c:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.icon_8026515c{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}[dir='ltr'] .icon_8026515c{margin-right:8px}[dir='rtl'] .icon_8026515c{margin-left:8px}.nameplate_8026515c{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex}.name_8026515c{font-size:17px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";display:inline-block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.activity_8026515c{padding:0 16px}\n"},{"rawString":".root_012d5c5f{display:-webkit-box;display:-ms-flexbox;display:flex;width:99%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:6px;background:"},{"theme":"menuBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,0.132),0 0.3px 0.9px 0 rgba(0,0,0,0.108);box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,0.132),0 0.3px 0.9px 0 rgba(0,0,0,0.108)}.root_012d5c5f:hover{-webkit-box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108)}.nameplate_012d5c5f{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex}.name_012d5c5f{font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-weight:400;display:inline-block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.activity_012d5c5f{padding:0 16px}div.icon_012d5c5f{border-radius:4px}.icon_012d5c5f p{font-weight:600}\n"},{"rawString":".icon_6f3811cb{display:block;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}[dir='ltr'] .icon_6f3811cb{margin-right:8px}[dir='rtl'] .icon_6f3811cb{margin-left:8px}.siteName_6f3811cb{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-flex:10;-ms-flex-positive:10;flex-grow:10;text-overflow:ellipsis;white-space:nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}[dir='ltr'] .siteName_6f3811cb{text-align:left}[dir='rtl'] .siteName_6f3811cb{text-align:right}.siteNameContainer_6f3811cb{width:100%;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex}.linkName_6f3811cb{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}[dir='ltr'] .linkName_6f3811cb{padding-left:32px}[dir='rtl'] .linkName_6f3811cb{padding-right:32px}.linkName_6f3811cb:hover,.linkName_6f3811cb:active{color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":"}.parentContainer_6f3811cb{width:inherit}.dragContainer_6f3811cb{height:36px;display:-webkit-box;display:-ms-flexbox;display:flex}.siteContainer_6f3811cb{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.dropZoneParent_6f3811cb{position:absolute;width:100%;height:inherit}.parentContainer_6f3811cb:hover .dropZoneParent_6f3811cb{z-index:-1}.topDropZoneHover_6f3811cb{height:17px;border-top:1px solid #0078b4}.bottomDropZoneHover_6f3811cb{height:17px;border-bottom:1px solid #0078b4}.dropZone_6f3811cb{height:17px}.dragHandler_6f3811cb{position:absolute;height:inherit;top:-2px;opacity:0;cursor:move;z-index:1;font-size:16px}[dir='ltr'] .dragHandler_6f3811cb{margin-left:-16px}[dir='rtl'] .dragHandler_6f3811cb{margin-right:-16px}.dragContainer_6f3811cb:hover .dragHandler_6f3811cb{opacity:0.5}\n"},{"rawString":".customTile_261e255c.ms-Tile{-webkit-transform:none !important;transform:none !important;outline-offset:-2px}.customTile_261e255c.ms-Tile--isSelected{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":" !important}.customTile_261e255c.ms-Tile--uninvokable{background-color:transparent !important}.customTile_261e255c.ms-Tile--uninvokable .ms-Tile-link{pointer-events:auto}.customTile_261e255c.ms-Tile--uninvokable .ms-Tile-check{height:auto !important;width:auto !important;right:5px;top:5px;padding:8px 8px 14px 14px}[dir='rtl'] .customTile_261e255c.ms-Tile--uninvokable .ms-Tile-check{padding:8px 14px 14px 8px}.customTile_261e255c.ms-Tile--uninvokable:hover{background-color:transparent !important}.customTile_261e255c.ms-Tile--uninvokable:hover .sp-card-borderHighlight{border:1px solid #c8c6c4;border-radius:4px;-webkit-box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important;box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important}.customTile_261e255c.ms-Tile--isSelected .sp-card-borderHighlight{border:1px solid #c8c6c4;border-radius:4px;-webkit-box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important;box-shadow:rgba(0,0,0,0.133) 0px 3.2px 7.2px 0px,rgba(0,0,0,0.11) 0px 0.6px 1.8px 0px !important}.customTile_261e255c .sp-field-customFormatter{pointer-events:auto}.customTile_261e255c .customTileFocusZone_261e255c{width:100%;height:100%}\n"},{"rawString":".commandButton_b69fa478{font-size:14px}\n"},{"rawString":".keyboardMapGroup_ef2ba83e{display:inline-block;width:50%;min-width:200px;font-size:12px;vertical-align:top}.keyboardMapTable_ef2ba83e{display:table;list-style:none;margin:0;padding:0}.keyboardMapRow_ef2ba83e{display:table-row}.keyboardMapRow_ef2ba83e span{display:table-cell}.keyboardMapKey_ef2ba83e{color:#0078d4;min-width:55px}.keyboardMapVal_ef2ba83e{padding:4px 8px}\n"},{"rawString":".root_d3ac4a74{display:block}.showAllCell_d3ac4a74{position:'relative';padding:'10px 84px';cursor:'pointer'}\n"},{"rawString":".tile_2dea517e.hideFileTypeIcon_2dea517e .fileTypeIcon_2dea517e,.tile_2dea517e.hideFileTypeIcon_2dea517e .tileAppIcon_2dea517e{display:none}.tile_2dea517e.hideThumbnail_2dea517e .thumbnail_2dea517e{display:none}.defaultTile_2dea517e .ms-Tile-foreground>*{pointer-events:none}.defaultTile_2dea517e .ms-Tile-background>*{pointer-events:none}.folderCover_2dea517e{margin:3px}.thumbnail_2dea517e{display:inline-block}.thumbnailNotResolved_2dea517e{display:none}.fileTypeIcon_2dea517e{margin:16px}.name_2dea517e{display:inline;max-width:100%}.blankFolderCover_2dea517e{background:"},{"theme":"itemTileBlankFolderCoverColor","defaultValue":"#fff"},{"rawString":";display:inline-block}.tileAppIcon_2dea517e{position:absolute;bottom:0;margin:4px}[dir='ltr'] .tileAppIcon_2dea517e{left:0px}[dir='rtl'] .tileAppIcon_2dea517e{right:0px}\n"},{"rawString":".nameDialogContent_e73d00a0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.nameDialogContent_e73d00a0 .ms-TextField{width:100%}.nameDialogContent_e73d00a0 .ms-TextField .ms-TextField-errorMessage{max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content}.nameDialogContentFileExtension_e73d00a0{padding:10px 5px 0;-ms-flex-item-align:start;align-self:flex-start}.nameDialogSpinner_e73d00a0{display:inline-block;padding-bottom:7px;vertical-align:bottom}\n"},{"rawString":".callout_f7d6e7fb{min-width:315px}[dir='ltr'] .callout_f7d6e7fb{padding-left:12px}[dir='rtl'] .callout_f7d6e7fb{padding-right:12px}[dir='ltr'] .callout_f7d6e7fb{padding-right:4px}[dir='rtl'] .callout_f7d6e7fb{padding-left:4px}.progressList_f7d6e7fb{display:block}.viewAllButton_f7d6e7fb{display:block}.accessibleStatus_f7d6e7fb{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".tile_9fe29b4a{display:block;position:relative;padding-bottom:8px}[dir='ltr'] .tile_9fe29b4a{padding-right:40px}[dir='rtl'] .tile_9fe29b4a{padding-left:40px}.tile_9fe29b4a.hasIcon_9fe29b4a{min-height:60px}[dir='ltr'] .tile_9fe29b4a.hasIcon_9fe29b4a{padding-left:56px}[dir='rtl'] .tile_9fe29b4a.hasIcon_9fe29b4a{padding-right:56px}.title_9fe29b4a{display:inline;white-space:pre-line}.icon_9fe29b4a{position:absolute;width:48px;display:block}[dir='ltr'] .icon_9fe29b4a{left:0}[dir='rtl'] .icon_9fe29b4a{right:0}.icon_9fe29b4a.hasProgress_9fe29b4a{top:8px}.progress_9fe29b4a{display:block}.error_9fe29b4a .progress_9fe29b4a .ms-ProgressIndicator-itemProgress{display:none}.description_9fe29b4a{font-size:12px}.error_9fe29b4a .description_9fe29b4a{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":"}.actions_9fe29b4a{display:block;margin:8px 0 20px 0}.cancel_9fe29b4a{position:absolute;display:block;top:0;width:32px;font-size:14px}[dir='ltr'] .cancel_9fe29b4a{right:0}[dir='rtl'] .cancel_9fe29b4a{left:0}\n"},{"rawString":".root_90d4ef9e{overflow-x:hidden}.group_90d4ef9e{margin:14px 0}.item_90d4ef9e{margin:0}\n"},{"rawString":".dragging_685629c0 *{pointer-events:none !important}.canDrop_685629c0:after{content:' ';display:block;pointer-events:none;border:2px dashed "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";position:absolute;top:0;left:0;bottom:0;right:0;z-index:999}.dragOver_685629c0:after{content:' ';display:block;pointer-events:none;border:2px dashed "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";position:absolute;top:0;left:0;bottom:0;right:0;z-index:999}\n"},{"rawString":".dragPreviewRoot_084c3e71{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:"},{"theme":"menuBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);pointer-events:none}.dragPreviewIcon_084c3e71{margin:5px;height:20px;width:20px}[dir='ltr'] .dragPreviewText_084c3e71{margin-right:5px}[dir='rtl'] .dragPreviewText_084c3e71{margin-left:5px}\n"},{"rawString":".errorIcon_53f979a1{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":";font-size:14px}\n"},{"rawString":".spGridTableHead_7ed50b05{display:none}.spGridPagingFooter_7ed50b05{margin-top:16px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.spGridPagingFooterContent_7ed50b05{padding:0 8px 2px}.spGridCustomFormatField_7ed50b05{min-height:inherit;margin:-11px 0;white-space:normal}.wrapperTable_7ed50b05{border-spacing:0px}.wrapperTd_7ed50b05{padding:0}.gridFocusEntryPoint_7ed50b05{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.gridFocusEntryPoint_7ed50b05:focus{outline:none}.gridFocusEntryPoint_7ed50b05:focus+.gridParentFocusable_7ed50b05::after{content:'';position:absolute;top:0;bottom:0;left:0;right:0;border:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:6px;pointer-events:none;z-index:99999}.spGridRoot_7ed50b05 iframe{border:none}.spGridRoot_7ed50b05 input[type='radio']{vertical-align:middle;margin:3px 3px 0px 5px}[dir='rtl'] .spGridRoot_7ed50b05 input[type='radio']{margin:3px 5px 0px 3px}.spGridRoot_7ed50b05 label{vertical-align:middle}.spGridRoot_7ed50b05 .ms-accessible,.spGridRoot_7ed50b05 .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.spGridRoot_7ed50b05 .ms-accessible-quickedit,.spGridRoot_7ed50b05 .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.spGridRoot_7ed50b05 .skipGridContentButton_7ed50b05{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.spGridRoot_7ed50b05 .skipGridContentButton_7ed50b05:focus{top:2px;background-color:#fff;color:#000;padding:2px 4px;z-index:12;height:auto;width:auto}.spGridRoot_7ed50b05 .ms-spGrid-HeaderContentStyle-Rename{padding:3px 5px 0px 5px}.spGridRoot_7ed50b05 .ms-spGrid-HeaderContentStyle-Rename input{padding:2px 5px}.spGridErrorIcon_7ed50b05{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":";background-color:"},{"theme":"errorBackground","defaultValue":"#FDE7E9"},{"rawString":";border-radius:8px}.srOnly_7ed50b05{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0}.boolIconDiv_7ed50b05{text-align:center}.boolIcon_7ed50b05{font-size:16px}.dropHintStyle_7ed50b05{display:inline-block;position:absolute}.dropHintStyle_7ed50b05.containerRefreshed_7ed50b05{height:42px}.dropHintCaretStyle_7ed50b05{display:none;position:absolute;top:22px;left:-7.5px;color:#004e8c;overflow:visible;z-index:10}.dropHintCaretStyle_7ed50b05.caretRefreshed_7ed50b05{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";left:-6.5px;top:unset;bottom:0}.dropHintLineStyle_7ed50b05{display:none;position:absolute;bottom:0px;top:-3px;overflow:hidden;height:37px;width:1px;background-color:#004e8c}.dropHintLineStyle_7ed50b05.lineRefreshed_7ed50b05{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";height:28px;top:7px}@media screen and (-ms-high-contrast: active){.dropHintLineStyle_7ed50b05.lineRefreshed_7ed50b05{background-color:WindowText}}.jsgrid-control-multiline-quickedit{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgrid-control-rte-quickedit{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgrid-widget-hyperlink-quickedit{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";border:1px solid "},{"theme":"inputBorder","defaultValue":"#605e5c"},{"rawString":"}.jsgrid-widget-hyperlink-buttonarea-quickedit{background-color:"},{"theme":"buttonBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgrid-changehighlight{background-color:"},{"theme":"bodyStandoutBackground","defaultValue":"#faf9f8"},{"rawString":"}.ms-vb a:link,.ms-vb2 a:link,.ms-vb-user a:link{text-decoration:none}.ms-vb a.ms-listlink,.ms-vb2 a.ms-listlink,.ms-vb-user a.ms-listlink,.ms-vb a.ms-listlink:visited,.ms-vb a.ms-listlink:visited:hover{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";text-decoration:none}.listLink_7ed50b05{font-weight:600}.ms-vb-title .isTitleOrNameFieldVisualRefresh_7ed50b05{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";font-weight:600}.ms-vb-title .isTitleOrNameField_7ed50b05{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";font-weight:400}.cellHiddenOverflow_7ed50b05,.cellBreakWordOverflow_7ed50b05{display:inline-block;width:100%;position:relative;z-index:15}.cellHiddenOverflow_7ed50b05{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:middle}.cellHiddenOverflow_7ed50b05.personaPillOverflowContainer_7ed50b05{text-overflow:clip}.cellHiddenOverflow_7ed50b05.personaPillOverflowContainer_7ed50b05>div{margin:0}[dir='ltr'] .cellHiddenOverflow_7ed50b05.personaPillOverflowContainer_7ed50b05>div:not(:last-child){margin-right:7px}[dir='rtl'] .cellHiddenOverflow_7ed50b05.personaPillOverflowContainer_7ed50b05>div:not(:last-child){margin-left:7px}.cellBreakWordOverflow_7ed50b05{overflow:hidden;overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.cellBreakWordOverflow_7ed50b05.personaPillOverflowContainer_7ed50b05{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.cellBreakWordOverflow_7ed50b05.personaPillOverflowContainer_7ed50b05>div{margin:0}.cellBreakWordOverflow_7ed50b05.personaPillOverflowContainer_7ed50b05>div:not(:last-child){margin-bottom:12px}.customFormatField_7ed50b05{margin:0}.msGridWidgetDock_7ed50b05{border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:#fdfdfd;height:20px;position:absolute;cursor:pointer;z-index:20}.stickyEditor_7ed50b05{z-index:1020}.msGridWidgetDockHover_7ed50b05{border-color:#92c0e0;background-color:#e6f2fa}.msGridWidgetDockPressed_7ed50b05{border-color:#2a8dd4;background-color:#92b7d1}.msGridWidgetCell_7ed50b05{overflow:hidden;padding:2px;height:16px;width:16px;top:0px;position:absolute}[dir='ltr'] .msGridWidgetCell_7ed50b05{float:left}[dir='rtl'] .msGridWidgetCell_7ed50b05{float:right}.msGridCellSelectedEditable_7ed50b05{cursor:text}.msGridCellSelectedEditable_7ed50b05 a:hover{cursor:text}.msGridCellSelectedEditable_7ed50b05 [ms-jsgrid-click-passthrough='true']{cursor:auto}.spGridErrorNotification_7ed50b05{color:#bf0000;text-align:left}.msGrid_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-right-style:solid;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-bottom-style:solid;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridLink_7ed50b05{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":";background-color:#663399}.msGridSelection_7ed50b05{border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";color:#9ccef0}[dir='ltr'] .msGridSelection_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridSelection_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridSelection_7ed50b05{border-right-color:rgba(0,0,0,0)}[dir='rtl'] .msGridSelection_7ed50b05{border-left-color:rgba(0,0,0,0)}.msGridSelectionReadonly_7ed50b05{border-bottom-color:#e1e1e1}.msGridEdit_7ed50b05{background-color:#cde6f7;border-top-color:#bf0000}[dir='ltr'] .msGridEdit_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridEdit_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridTimescale_7ed50b05{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-bottom-style:solid;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridTimescale_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridTimescale_7ed50b05{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridTimescale_7ed50b05{border-right-style:solid}[dir='rtl'] .msGridTimescale_7ed50b05{border-left-style:solid}[dir='ltr'] .msGridTimescale_7ed50b05{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridTimescale_7ed50b05{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.msGridColHeaderNormal_7ed50b05{font-size:1em;font-weight:normal;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-top-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='ltr'] .msGridColHeaderNormal_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderNormal_7ed50b05{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderNormal_7ed50b05{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderNormal_7ed50b05{border-right-color:rgba(0,0,0,0)}.msGridColHeaderElemBgColorsNormal_7ed50b05{background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsNormal_7ed50b05{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderElemBgColorsNormal_7ed50b05{border-right-color:rgba(0,0,0,0)}[dir='ltr'] .msGridColHeaderElemBgColorsNormal_7ed50b05{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsNormal_7ed50b05{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.msGridColHeaderElemHoverBgColorsNormal_7ed50b05{color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsNormal_7ed50b05{border-right-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsNormal_7ed50b05{border-left-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}.ms-core-needIEFilter .msGridColHeaderElemHoverBgColorsNormal_7ed50b05{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridColElemColorsClickNormal_7ed50b05{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickNormal_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickNormal_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderNormalHover_7ed50b05{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsNormalHover_7ed50b05{background-color:transparent;border-bottom-color:transparent}[dir='ltr'] .msGridColHeaderElemBgColorsNormalHover_7ed50b05{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsNormalHover_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsNormalHover_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsNormalHover_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsNormalHover_7ed50b05{background-color:transparent;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsNormalHover_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsNormalHover_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickNormalHover_7ed50b05{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickNormalHover_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickNormalHover_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderPartSelected_7ed50b05{font-size:1em;font-weight:normal;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderPartSelected_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderPartSelected_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderPartSelected_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderPartSelected_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsPartSelected_7ed50b05{background-color:transparent;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelected_7ed50b05{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelected_7ed50b05{border-right-color:rgba(0,0,0,0)}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelected_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelected_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsPartSelected_7ed50b05{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsPartSelected_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsPartSelected_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickPartSelected_7ed50b05{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickPartSelected_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickPartSelected_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderPartSelectedHover_7ed50b05{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsPartSelectedHover_7ed50b05{background-color:transparent;border-bottom-color:transparent}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelectedHover_7ed50b05{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelectedHover_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsPartSelectedHover_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsPartSelectedHover_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsPartSelectedHover_7ed50b05{background-color:transparent;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsPartSelectedHover_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsPartSelectedHover_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickPartSelectedHover_7ed50b05{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickPartSelectedHover_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickPartSelectedHover_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderAllSelected_7ed50b05{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderAllSelected_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderAllSelected_7ed50b05{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderAllSelected_7ed50b05{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderAllSelected_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.msGridColHeaderElemBgColorsAllSelected_7ed50b05{background-color:transparent;border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsAllSelected_7ed50b05{border-left-color:rgba(0,0,0,0)}[dir='rtl'] .msGridColHeaderElemBgColorsAllSelected_7ed50b05{border-right-color:rgba(0,0,0,0)}.msGridColHeaderElemHoverBgColorsAllSelected_7ed50b05{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsAllSelected_7ed50b05{border-right-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsAllSelected_7ed50b05{border-left-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}.msGridColElemColorsClickAllSelected_7ed50b05{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickAllSelected_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickAllSelected_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderAllSelectedHover_7ed50b05{font-size:1em;font-weight:normal;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";background-color:transparent;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemBgColorsAllSelectedHover_7ed50b05{background-color:transparent;border-bottom-color:transparent}[dir='ltr'] .msGridColHeaderElemBgColorsAllSelectedHover_7ed50b05{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsAllSelectedHover_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemBgColorsAllSelectedHover_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemBgColorsAllSelectedHover_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColHeaderElemHoverBgColorsAllSelectedHover_7ed50b05{background-color:transparent;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='ltr'] .msGridColHeaderElemHoverBgColorsAllSelectedHover_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColHeaderElemHoverBgColorsAllSelectedHover_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridColElemColorsClickAllSelectedHover_7ed50b05{background-color:transparent}[dir='ltr'] .msGridColElemColorsClickAllSelectedHover_7ed50b05{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] .msGridColElemColorsClickAllSelectedHover_7ed50b05{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.msGridRowHeaderNormal_7ed50b05{border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.msGridRowHeaderNormalHover_7ed50b05,.msGridRowHeaderPartSelected_7ed50b05,.msGridRowHeaderPartSelectedHover_7ed50b05,.msGridRowHeaderAllSelected_7ed50b05,.msGridRowHeaderAllSelectedHover_7ed50b05{border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.msGridSplitter_7ed50b05{border-top-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridSplitter_7ed50b05{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridSplitter_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.ms-core-needIEFilter .msGridSplitter_7ed50b05{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHandle_7ed50b05{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridSplitterHandle_7ed50b05{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridSplitterHandle_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='ltr'] .msGridSplitterHandle_7ed50b05{border-right-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='rtl'] .msGridSplitterHandle_7ed50b05{border-left-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.ms-core-needIEFilter .msGridSplitterHandle_7ed50b05{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHover_7ed50b05{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridSplitterHover_7ed50b05{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .msGridSplitterHover_7ed50b05{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.ms-core-needIEFilter .msGridSplitterHover_7ed50b05{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHandleHover_7ed50b05{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleHover_7ed50b05{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridSplitterHandleHover_7ed50b05{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleHover_7ed50b05{border-right-color:rgba(0,0,0,0)}[dir='rtl'] .msGridSplitterHandleHover_7ed50b05{border-left-color:rgba(0,0,0,0)}.ms-core-needIEFilter .msGridSplitterHandleHover_7ed50b05{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterDrag_7ed50b05{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='ltr'] .msGridSplitterDrag_7ed50b05{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridSplitterDrag_7ed50b05{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.ms-core-needIEFilter .msGridSplitterDrag_7ed50b05{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.msGridSplitterHandleDrag_7ed50b05{border-top-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":";border-bottom-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleDrag_7ed50b05{border-left-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .msGridSplitterHandleDrag_7ed50b05{border-right-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='ltr'] .msGridSplitterHandleDrag_7ed50b05{border-right-color:rgba(0,0,0,0)}[dir='rtl'] .msGridSplitterHandleDrag_7ed50b05{border-left-color:rgba(0,0,0,0)}.ms-core-needIEFilter .msGridSplitterHandleDrag_7ed50b05{background-color:transparent;-ms-filter:'progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#c6efefef,endColorstr=#c6efefef)'}.spGridControlFocusElement_7ed50b05:focus{outline:none}input[type='text'].spGridControlEditbox_7ed50b05,.spGridControlEditbox_7ed50b05,.spGridControlFocusElement_7ed50b05{font-family:inherit;font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;border:0px;padding:2px 6px 0;z-index:30;overflow:hidden;outline:none}[dir='ltr'] input[type='text'].spGridControlEditbox_7ed50b05.inputIsNumber_7ed50b05,[dir='ltr'] .spGridControlEditbox_7ed50b05.inputIsNumber_7ed50b05,[dir='ltr'] .spGridControlFocusElement_7ed50b05.inputIsNumber_7ed50b05{text-align:right}[dir='rtl'] input[type='text'].spGridControlEditbox_7ed50b05.inputIsNumber_7ed50b05,[dir='rtl'] .spGridControlEditbox_7ed50b05.inputIsNumber_7ed50b05,[dir='rtl'] .spGridControlFocusElement_7ed50b05.inputIsNumber_7ed50b05{text-align:left}input[type='text'].spGridControlEditbox_7ed50b05.inputIsTitle_7ed50b05,.spGridControlEditbox_7ed50b05.inputIsTitle_7ed50b05,.spGridControlFocusElement_7ed50b05.inputIsTitle_7ed50b05{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:600}input[type='text'].spGridControlEditbox_7ed50b05.spGridControlEditboxDynamicHeight_7ed50b05,.spGridControlEditbox_7ed50b05.spGridControlEditboxDynamicHeight_7ed50b05,.spGridControlFocusElement_7ed50b05.spGridControlEditboxDynamicHeight_7ed50b05{padding-top:0}input[type='text'].spGridControlEditbox_7ed50b05.stickyEditor_7ed50b05,.spGridControlEditbox_7ed50b05.stickyEditor_7ed50b05,.spGridControlFocusElement_7ed50b05.stickyEditor_7ed50b05{z-index:1020}input[type='text'].spGridControlEditbox_7ed50b05::-ms-clear{display:none}.jsgridControlMultilineTextarea_7ed50b05{font-family:inherit;font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;border:0px;padding:2px 6px 0;z-index:30;outline:none;padding-bottom:2px}.jsgridControlRteContainer_7ed50b05{z-index:30;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.jsgridControlRteContainer_7ed50b05 .ms-shadow{-webkit-box-shadow:0px 0px 7px 0px rgba(0,0,0,0.47);box-shadow:0px 0px 7px 0px rgba(0,0,0,0.47)}.msRteStateField_7ed50b05{padding:1px 0}.msRteStateField_7ed50b05 div:first-child{padding:1px 0}.ms-grid-group1{background-color:#0072c6}.ms-grid-group2{background-color:#00485b}.ms-grid-group3{background-color:#288054}.ms-grid-group4{background-color:#767956}.ms-grid-group5{background-color:#ed0033}.ms-grid-group6{background-color:#682a7a}.ms-grid-group7{background-color:#0072c6}.ms-grid-group8{background-color:#00485b}.ms-grid-group9{background-color:#288054}.outer-scroll-bar{position:relative;background-color:#e6e8eb;top:0px}[dir='ltr'] .outer-scroll-bar{left:0px}[dir='rtl'] .outer-scroll-bar{right:0px}.inner-scroll-bar{border-top:1px solid #f5f6f7;border-bottom:1px solid #f5f6f7;background-color:#f0f0f0;position:relative;top:1px}[dir='ltr'] .inner-scroll-bar{border-right:1px solid #f8f9f9}[dir='rtl'] .inner-scroll-bar{border-left:1px solid #f8f9f9}[dir='ltr'] .inner-scroll-bar{border-left:1px solid #f5f6f7}[dir='rtl'] .inner-scroll-bar{border-right:1px solid #f5f6f7}[dir='ltr'] .inner-scroll-bar{left:1px}[dir='rtl'] .inner-scroll-bar{right:1px}.scroll-bar-cell{border:1px solid #f6f6f6;background-color:#d5dded}.scroll-bar-inner-arrow-cell{border:1px solid transparent}.scroll-bar-arrow-cell{border:1px solid transparent;position:absolute;top:0px}[dir='ltr'] .scroll-bar-arrow-cell{left:0px}[dir='rtl'] .scroll-bar-arrow-cell{right:0px}.scroll-bar-outer-box{border:1px solid #a3a6ab;background-color:#eeeff2;position:absolute;top:0px}[dir='ltr'] .scroll-bar-outer-box{left:0px}[dir='rtl'] .scroll-bar-outer-box{right:0px}.scroll-bar-background-main{background-color:#f2f3f5}.scroll-bar-background-shade{background-color:#edeef0}.scroll-bar-inner-box-main{background-color:#dbdfe5}.scroll-bar-inner-box-shade{background-color:#e5e8ec}.scroll-bar-arrow{border:0px;padding:0px;text-align:center;vertical-align:top}.scroll-bar-grip{position:absolute;top:0px;border-color:#a7aaaf;background-color:#fefefe}[dir='ltr'] .scroll-bar-grip{left:0px}[dir='rtl'] .scroll-bar-grip{right:0px}.horiz-scroll-bar-bg-block{height:100%}[dir='ltr'] .horiz-scroll-bar-bg-block{float:left}[dir='rtl'] .horiz-scroll-bar-bg-block{float:right}.horiz-scroll-bar-arrow-cell{top:-2px}.horiz-scroll-bar-outer-box{top:-1px}.horiz-scroll-bar-grip{height:5px;width:1px}[dir='ltr'] .horiz-scroll-bar-grip{border-left-style:solid}[dir='rtl'] .horiz-scroll-bar-grip{border-right-style:solid}[dir='ltr'] .horiz-scroll-bar-grip{border-left-width:1px}[dir='rtl'] .horiz-scroll-bar-grip{border-right-width:1px}[dir='ltr'] .vert-scroll-bar-inner-box-main{float:right}[dir='rtl'] .vert-scroll-bar-inner-box-main{float:left}[dir='ltr'] .vert-scroll-bar-inner-box-shade{float:left}[dir='rtl'] .vert-scroll-bar-inner-box-shade{float:right}[dir='ltr'] .vert-scroll-bar-background-main{float:right}[dir='rtl'] .vert-scroll-bar-background-main{float:left}[dir='ltr'] .vert-scroll-bar-background-shade{float:left}[dir='rtl'] .vert-scroll-bar-background-shade{float:right}[dir='ltr'] .vert-scroll-bar-arrow-cell{left:-2px}[dir='rtl'] .vert-scroll-bar-arrow-cell{right:-2px}[dir='ltr'] .vert-scroll-bar-outer-box{left:-1px}[dir='rtl'] .vert-scroll-bar-outer-box{right:-1px}.vert-scroll-bar-grip{border-top:1px solid;height:1px;width:5px}.clip6x9,.clip9x6,.clip11x11,.clip13x13,.clip16x16{position:relative;overflow:hidden}.clip6x9{width:6px;height:9px}.clip9x6{width:9px;height:6px}.clip11x11{width:11px;height:11px}.clip13x13{width:13px;height:13px}.clip16x16{width:16px;height:16px}.clip6x9 img,.clip6x9 input,.clip9x6 img,.clip9x6 input,.clip11x11 img,.clip11x11 input,.clip13x13 img,.clip13x13 input,.clip16x16 img,.clip16x16 input{position:absolute;margin:0;padding:0;width:auto;height:auto}.jsgridcluster_editheader{top:0}[dir='ltr'] .jsgridcluster_editheader{left:0}[dir='rtl'] .jsgridcluster_editheader{right:0}.jsgridcluster_newrowheader{top:0}[dir='ltr'] .jsgridcluster_newrowheader{left:-16px}[dir='rtl'] .jsgridcluster_newrowheader{right:-16px}.jsgridcluster_conflictheader{top:-16px}[dir='ltr'] .jsgridcluster_conflictheader{left:0}[dir='rtl'] .jsgridcluster_conflictheader{right:0}.jsgridcluster_transferheader{top:-16px}[dir='ltr'] .jsgridcluster_transferheader{left:-16px}[dir='rtl'] .jsgridcluster_transferheader{right:-16px}.jsgridcluster_cell-error{top:0}[dir='ltr'] .jsgridcluster_cell-error{left:-32px}[dir='rtl'] .jsgridcluster_cell-error{right:-32px}.jsgridcluster_jsgrid-header-filter-icon{top:-16px}[dir='ltr'] .jsgridcluster_jsgrid-header-filter-icon{left:-32px}[dir='rtl'] .jsgridcluster_jsgrid-header-filter-icon{right:-32px}.jsgridcluster_scrollbar-mousein-rightarrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-rightarrow{left:0}[dir='rtl'] .jsgridcluster_scrollbar-mousein-rightarrow{right:0}.jsgridcluster_scrollbar-mousein-downarrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-downarrow{left:-6px}[dir='rtl'] .jsgridcluster_scrollbar-mousein-downarrow{right:-6px}.jsgridcluster_scrollbar-mousein-uparrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-uparrow{left:-15px}[dir='rtl'] .jsgridcluster_scrollbar-mousein-uparrow{right:-15px}.jsgridcluster_scrollbar-mousein-leftarrow{top:-32px}[dir='ltr'] .jsgridcluster_scrollbar-mousein-leftarrow{left:-24px}[dir='rtl'] .jsgridcluster_scrollbar-mousein-leftarrow{right:-24px}.jsgridcluster_scrollbar-mouseout-rightarrow{top:-27px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-rightarrow{left:-32px}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-rightarrow{right:-32px}.jsgridcluster_scrollbar-mouseout-uparrow{top:-27px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-uparrow{left:-38px}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-uparrow{right:-38px}.jsgridcluster_scrollbar-mouseout-downarrow{top:-33px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-downarrow{left:-38px}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-downarrow{right:-38px}.jsgridcluster_scrollbar-mouseout-leftarrow{top:-41px}[dir='ltr'] .jsgridcluster_scrollbar-mouseout-leftarrow{left:0}[dir='rtl'] .jsgridcluster_scrollbar-mouseout-leftarrow{right:0}.jsgridcluster_jsgrid-up-arrow{top:-38px}[dir='ltr'] .jsgridcluster_jsgrid-up-arrow{left:-6px}[dir='rtl'] .jsgridcluster_jsgrid-up-arrow{right:-6px}.jsgridcluster_jsgrid-down-arrow{top:-44px}[dir='ltr'] .jsgridcluster_jsgrid-down-arrow{left:-6px}[dir='rtl'] .jsgridcluster_jsgrid-down-arrow{right:-6px}\n"},{"rawString":".msGridEditControlContainer_2c47ad2a{position:absolute;visibility:hidden;border:0px;top:0px;overflow-x:visible;margin-left:-1px}.msGridEditControlEditBox_2c47ad2a{visibility:hidden;position:absolute;top:0px;left:0px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.ms-BasePicker-text .ms-BasePicker-input{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.errorWidgetContainer_2c47ad2a,.readOnlyWidgetContainer_2c47ad2a{z-index:20;visibility:hidden;font-size:12px;position:absolute;border-radius:"},{"theme":"roundedCorner2","defaultValue":"2px"},{"rawString":";padding:5px 8px;white-space:nowrap}.errorWidgetContainer_2c47ad2a.stickyZIndex_2c47ad2a,.readOnlyWidgetContainer_2c47ad2a.stickyZIndex_2c47ad2a{z-index:1020}.errorWidgetContainer_2c47ad2a.widgetExpanded_2c47ad2a,.readOnlyWidgetContainer_2c47ad2a.widgetExpanded_2c47ad2a{visibility:visible}.errorWidgetContainer_2c47ad2a{color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":";border:1px solid "},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":";background-color:"},{"theme":"blockingBackground","defaultValue":"#FDE7E9"},{"rawString":"}.readOnlyWidgetContainer_2c47ad2a{color:"},{"theme":"bodySubtext","defaultValue":"#605e5c"},{"rawString":";border:1px solid "},{"theme":"warningIcon","defaultValue":"#797775"},{"rawString":";background-color:"},{"theme":"disabledBackground","defaultValue":"#f3f2f1"},{"rawString":"}\n"},{"rawString":".personDisplayPill_3babd190{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:24px;border-radius:12px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}[dir='ltr'] .personDisplayPill_3babd190{padding-right:8px}[dir='rtl'] .personDisplayPill_3babd190{padding-left:8px}.personDisplayCoin_3babd190{border-radius:12px;display:inline-block;width:24px;height:24px;text-align:center;font-size:10px;font-weight:600;line-height:24px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.personDisplayPhoto_3babd190{display:block;width:24px;height:24px;-o-object-fit:cover;object-fit:cover;position:absolute;border-radius:12px}.personDisplayName_3babd190{white-space:nowrap}[dir='ltr'] .personDisplayName_3babd190{padding-left:5px}[dir='rtl'] .personDisplayName_3babd190{padding-right:5px}\n"},{"rawString":".checkBox_f56072a9{z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%)}[dir='ltr'] .checkBox_f56072a9{left:50%}[dir='rtl'] .checkBox_f56072a9{right:50%}[dir='ltr'] .checkBox_f56072a9{margin-left:1px}[dir='rtl'] .checkBox_f56072a9{margin-right:1px}\n"},{"rawString":".pill_494d3723,.pillNoHoverStyle_494d3723,.pillWithHoverByDefault_494d3723{-webkit-box-sizing:border-box;box-sizing:border-box;min-height:inherit;padding:5px 0px 2px 8px;font-size:12px}[dir='rtl'] .pill_494d3723,[dir='rtl'] .pillNoHoverStyle_494d3723,[dir='rtl'] .pillWithHoverByDefault_494d3723{padding:5px 8px 2px 0px}.pill_494d3723 div:not(.innerPillPlainText_494d3723):first-child,.pillNoHoverStyle_494d3723 div:not(.innerPillPlainText_494d3723):first-child,.pillWithHoverByDefault_494d3723 div:not(.innerPillPlainText_494d3723):first-child{margin:0px}.pillNoHoverStyle_494d3723{display:inline-block;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.pillNoHoverStyle_494d3723 .innerPillPlainText_494d3723{padding:0 8px;margin:0 -8px}.pillNoHoverStyle_494d3723:focus{outline:none}.pillNoHoverStyle_494d3723:focus div[class^='sp-css-backgroundColor'],.pillNoHoverStyle_494d3723:focus div[class^='sp-field-borderAllRegular'],.pillNoHoverStyle_494d3723:focus .innerPillPlainText_494d3723{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";outline-offset:2px}.pillNoHoverStyle_494d3723:focus .innerPillPlainText_494d3723{outline-offset:-3px}.innerPillPlainText_494d3723{height:29px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.pill_494d3723{margin:0 -8px}.pill_494d3723:hover{background-color:"},{"theme":"buttonBackgroundHovered","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"buttonTextHovered","defaultValue":"#201f1e"},{"rawString":"}@media screen and (-ms-high-contrast: active){.pill_494d3723:hover{background-color:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}.pill_494d3723:hover div[class^='sp-css-backgroundColor']{background-color:transparent}}.pillWithHoverByDefault_494d3723{margin:0 -8px;background-color:"},{"theme":"buttonBackgroundHovered","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"buttonTextHovered","defaultValue":"#201f1e"},{"rawString":"}@media screen and (-ms-high-contrast: active){.pillWithHoverByDefault_494d3723{background-color:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}.pillWithHoverByDefault_494d3723 div[class^='sp-css-backgroundColor']{background-color:transparent}}.wellInput_494d3723{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.editorButtonsContainer_494d3723{margin-top:12px;padding-top:8px;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.flyOutButtonsContainer_494d3723{margin-top:0px}.fillInWrapperDiv_494d3723,.fillInWrapperDivWithBackground_494d3723{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:36px;margin:0 -8px}.fillInWrapperDivWithBackground_494d3723{background-color:"},{"theme":"buttonBackgroundHovered","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"buttonTextHovered","defaultValue":"#201f1e"},{"rawString":"}.fillInWrapperDiv_494d3723:hover{background-color:"},{"theme":"buttonBackgroundHovered","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"buttonTextHovered","defaultValue":"#201f1e"},{"rawString":"}.fillInPillDiv_494d3723{border:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-radius:10px;padding:0 5px}[dir='ltr'] .fillInPillDiv_494d3723{margin-left:10px}[dir='rtl'] .fillInPillDiv_494d3723{margin-right:10px}.fillInLabel_494d3723{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:14px}[dir='ltr'] .fillInLabel_494d3723{margin-left:8px}[dir='rtl'] .fillInLabel_494d3723{margin-right:8px}.buttonBorderFocused_494d3723{border:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.iconClass_494d3723{font-size:12px;line-height:16px}[dir='ltr'] .iconClass_494d3723{margin-left:8px}[dir='rtl'] .iconClass_494d3723{margin-right:8px}\n"},{"rawString":".quickEditDateTimeEditor_233cf129 .ms-DatePicker-wrap{padding:0px}.quickEditDateTimeEditorInput_233cf129{position:relative;font-size:12px;padding:0px 6px;margin:2px;border:0px;z-index:30;font-family:inherit;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.quickEditDateTimeEditorInput_233cf129:focus{outline:none}.quickEditDateTimeEditorTimeInput_233cf129{height:32px;width:112px;font-size:14px;background-color:inherit}\n"},{"rawString":".locationEditor_07a1042b{position:relative;z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.locationEditor_07a1042b.styleFix_07a1042b .ms-BasePicker-text{border:none}.locationEditor_07a1042b.styleFix_07a1042b .ms-BasePicker-text:after{content:none}.locationEditor_07a1042b.styleFix_07a1042b .ms-LocationPicker-item{display:-webkit-box;display:-ms-flexbox;display:flex;border:1px solid transparent;border-radius:21px}.locationEditor_07a1042b.styleFix_07a1042b .ms-LocationPicker-item:focus{outline:none;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.locationEditor_07a1042b.styleFix_07a1042b .ms-PickerItem-removeButton{border-radius:2px 21px 21px 2px}.locationEditor_07a1042b.styleFix_07a1042b.hasLocationPill_07a1042b{padding:8px}.locationEditor_07a1042b.stickyEditor_07a1042b{z-index:1020}\n"},{"rawString":".numberEditorUnit_b3b1adee{text-overflow:ellipsis;padding:10px 7px;margin-bottom:1px;overflow-x:hidden}\n"},{"rawString":".peopleEditor_9fd4d02d.increaseZIndex_9fd4d02d{position:relative;z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.peopleEditor_9fd4d02d.styleUpdates_9fd4d02d .ms-BasePicker-text{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;border:none;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content}.peopleEditor_9fd4d02d.styleUpdates_9fd4d02d .ms-BasePicker-text:after{content:none}.peopleEditor_9fd4d02d.styleUpdates_9fd4d02d .ms-BasePicker-text .ms-BasePicker-input{height:36px;width:100%;padding:4px;max-height:36px;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-flex-item-align:start;align-self:flex-start}[dir='ltr'] .peopleEditor_9fd4d02d.styleUpdates_9fd4d02d .ms-BasePicker-text .ms-BasePicker-input{padding-left:8px}[dir='rtl'] .peopleEditor_9fd4d02d.styleUpdates_9fd4d02d .ms-BasePicker-text .ms-BasePicker-input{padding-right:8px}[dir='ltr'] .peopleEditor_9fd4d02d.styleUpdates_9fd4d02d .ms-BasePicker-text .ms-BasePicker-input{margin-left:-4px}[dir='rtl'] .peopleEditor_9fd4d02d.styleUpdates_9fd4d02d .ms-BasePicker-text .ms-BasePicker-input{margin-right:-4px}.peopleEditor_9fd4d02d.styleUpdates_9fd4d02d .ms-BasePicker-text .ms-BasePicker-itemsWrapper{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow-y:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}@supports ((max-width: -webkit-fit-content) or (max-width: -moz-fit-content) or (max-width: fit-content)){.peopleEditor_9fd4d02d.styleUpdates_9fd4d02d .ms-BasePicker-text .ms-BasePicker-itemsWrapper{-ms-flex-line-pack:start;align-content:flex-start;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}}.peopleEditor_9fd4d02d .ms-Button{min-width:0px;margin-left:0px}.peopleEditor_9fd4d02d:not(.styleUpdates_9fd4d02d) .ms-BasePicker-input{border:none;padding:0 6px 0px}.peopleEditor_9fd4d02d:not(.inStickyMode_9fd4d02d) .ms-BasePicker-text:after{content:none}\n"},{"rawString":".taxonomyEditorSpan_97377dcd{display:-webkit-box;display:-ms-flexbox;display:flex}.taxonomyEditorSpan_97377dcd.increaseZIndex_97377dcd{position:relative;z-index:20;background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.taxonomyEditorSpan_97377dcd .ms-BasePicker-text:after{content:none}[dir='ltr'] .taxonomyEditorSpan_97377dcd .taxonomyEditor-Picker{padding-left:4px}[dir='rtl'] .taxonomyEditorSpan_97377dcd .taxonomyEditor-Picker{padding-right:4px}\n"},{"rawString":".spGridHeaderIconSpan_00a3e1f1{font-size:16px}.spGridHeaderCoreContent_00a3e1f1{overflow:hidden;text-overflow:none;white-space:nowrap;color:#2e4f69}.gridHeaderCell_00a3e1f1{border-bottom:2px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";position:relative}[dir='ltr'] .gridHeaderCell_00a3e1f1{border-right-width:0px}[dir='rtl'] .gridHeaderCell_00a3e1f1{border-left-width:0px}.gridHeaderCell_00a3e1f1:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";outline-offset:-1px}.gridHeaderCell_00a3e1f1:active{outline:none}.gridHeaderCell_00a3e1f1.columnIsActive_00a3e1f1{border-bottom-color:"},{"theme":"inputFocusBorderAlt","defaultValue":"#0078d4"},{"rawString":"}.resizeContainer_00a3e1f1{-webkit-transition:opacity 0.3s linear 0s;transition:opacity 0.3s linear 0s}.resizeContainer_00a3e1f1:after{content:'';position:absolute;left:8px;top:7px;display:block;width:1px;height:28px;background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.resizeContainer_00a3e1f1:active:after{-webkit-box-shadow:rgba(0,0,0,0.4) 0px 0px 5px 0px;box-shadow:rgba(0,0,0,0.4) 0px 0px 5px 0px}.renameInputContainer_00a3e1f1{height:42px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.renameInputContainer_00a3e1f1 input{color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":";border:1px solid transparent;border-radius:2px;height:32px;font-size:14px;outline:none}[dir='ltr'] .renameInputContainer_00a3e1f1 input{padding-left:12px}[dir='rtl'] .renameInputContainer_00a3e1f1 input{padding-right:12px}[dir='ltr'] .renameInputContainer_00a3e1f1 input{padding-right:8px}[dir='rtl'] .renameInputContainer_00a3e1f1 input{padding-left:8px}.renameInputContainer_00a3e1f1 input:focus{border-color:"},{"theme":"inputFocusBorderAlt","defaultValue":"#0078d4"},{"rawString":"}@media screen and (-ms-high-contrast: active){.resizeContainer_00a3e1f1::after{background-color:Highlight}.gridHeaderCell_00a3e1f1.columnIsActive_00a3e1f1{border-bottom-color:Highlight}.gridHeaderCell_00a3e1f1 .QuickEditHeaderColumn:hover{color:Highlight}.gridHeaderCell_00a3e1f1 .QuickEditHeaderColumn:hover .ms-Icon{color:Highlight}}\n"},{"rawString":".topFrameElement_4330d6f0{border-top:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:2px 2px 0 0;z-index:25}.topFrameElement_4330d6f0.dashedBorder_4330d6f0{border-top-style:dashed;border-radius:0}.topFrameElement_4330d6f0.dashedBorderUnfocused_4330d6f0{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.bottomFrameElement_4330d6f0{border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:0 0 2px 2px;z-index:25}.bottomFrameElement_4330d6f0.dashedBorder_4330d6f0{border-bottom-style:dashed;border-radius:0}.bottomFrameElement_4330d6f0.dashedBorderUnfocused_4330d6f0{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.leftFrameElement_4330d6f0{border-left:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:2px 0 0 2px;z-index:25}.leftFrameElement_4330d6f0.dashedBorder_4330d6f0{border-left-style:dashed;border-radius:0}.leftFrameElement_4330d6f0.dashedBorderUnfocused_4330d6f0{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.rightFrameElement_4330d6f0{border-right:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:0 2px 2px 0;z-index:25}.rightFrameElement_4330d6f0.dashedBorder_4330d6f0{border-right-style:dashed;border-radius:0}.rightFrameElement_4330d6f0.dashedBorderUnfocused_4330d6f0{border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.topFrameElement_4330d6f0.stickyFrame_4330d6f0,.bottomFrameElement_4330d6f0.stickyFrame_4330d6f0,.leftFrameElement_4330d6f0.stickyFrame_4330d6f0,.rightFrameElement_4330d6f0.stickyFrame_4330d6f0{z-index:1025}.solidBorder_4330d6f0{border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.copyFrame_4330d6f0{z-index:9}.selectionDragHandle_4330d6f0{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-radius:2px;border-width:1px;border-style:solid;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;z-index:26;cursor:crosshair}.selectionDragHandle_4330d6f0:after{content:'';position:absolute;width:8px;height:8px;bottom:0}[dir='ltr'] .selectionDragHandle_4330d6f0:after{right:0}[dir='rtl'] .selectionDragHandle_4330d6f0:after{left:0}[dir='ltr'] .selectionDragHandle_4330d6f0.rowSelectionHandle_4330d6f0:after{left:0}[dir='rtl'] .selectionDragHandle_4330d6f0.rowSelectionHandle_4330d6f0:after{right:0}.selectionDragHandle_4330d6f0.editorIsActive_4330d6f0{display:none}.selectionDragHandle_4330d6f0.stickyHandle_4330d6f0{z-index:1026}[dir='ltr'] .rowSelectionHandle_4330d6f0 .selectionDragHandleContents_4330d6f0:after{left:0}[dir='rtl'] .rowSelectionHandle_4330d6f0 .selectionDragHandleContents_4330d6f0:after{right:0}.selectionDragHandleContainer_4330d6f0{margin-left:-2px;height:0px;overflow-y:visible}.selectionDragHandleContainer_4330d6f0.stickyHandle_4330d6f0{z-index:1026}.selectionDragHandleContainer_4330d6f0.editorIsActive_4330d6f0{display:none}.selectionDragHandleContents_4330d6f0{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-radius:2px;border-width:1px;border-style:solid;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box;z-index:26;cursor:crosshair;height:6px;width:6px;position:absolute}.selectionDragHandleContents_4330d6f0:after{content:'';position:absolute;width:8px;height:8px;bottom:0}[dir='ltr'] .selectionDragHandleContents_4330d6f0:after{right:0}[dir='rtl'] .selectionDragHandleContents_4330d6f0:after{left:0}[dir='ltr'] .selectionDragHandleContents_4330d6f0.rowSelectionHandle_4330d6f0:after{left:0}[dir='rtl'] .selectionDragHandleContents_4330d6f0.rowSelectionHandle_4330d6f0:after{right:0}.readonlySelectionRect_4330d6f0{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.dragToFillFrame_4330d6f0{border:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:2px}@media screen and (-ms-high-contrast: active) and (-ms-high-contrast: active){.selectionDragHandle_4330d6f0,.topFrameElement_4330d6f0,.bottomFrameElement_4330d6f0,.leftFrameElement_4330d6f0,.rightFrameElement_4330d6f0{border-color:Highlight}}@media screen and (-ms-high-contrast: active) and (-ms-high-contrast: active){.selectionDragHandleContents_4330d6f0{border-color:Highlight}}\n"},{"rawString":".msGridBaseStyle_9f05992a{font-size:12px;font-family:\"Segoe UI\",\"Segoe UI Web (West European)\",\"Segoe UI\",-apple-system,BlinkMacSystemFont,\"Roboto\",\"Helvetica Neue\",sans-serif}.msGridCell_9f05992a{font-style:normal;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.msGridCellReadonly_9f05992a{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.msGridCellReadonlyFocused_9f05992a{color:"},{"theme":"disabledText","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"buttonBackgroundDisabled","defaultValue":"#f3f2f1"},{"rawString":"}.ms-spgrid-col-header-normal{border-bottom-color:"},{"theme":"menuDivider","defaultValue":"#c8c6c4"},{"rawString":"}.ms-spgrid-col-header-part-selected{border-bottom-color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}.ms-spgrid-col-header-all-selected{border-bottom-color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}.ms-newdocument-iconouter{display:inline-block;height:16px;width:16px;position:relative;overflow:hidden;text-align:center;top:4px}.ms-newdocument-icon{left:-91px;top:-196px;position:absolute}.ms-inputBox{border:1px solid "},{"theme":"inputBorder","defaultValue":"#605e5c"},{"rawString":";background-color:"},{"theme":"inputBackground","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"inputText","defaultValue":"#323130"},{"rawString":"}.ms-inputBoxActive,.ms-inputBox.ms-inputBoxActive:hover{border-color:"},{"theme":"focusBorder","defaultValue":"#605e5c"},{"rawString":"}.ms-dlgOverlay{position:absolute;top:0px;width:100%;height:100%;opacity:0.4;background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";display:none}[dir='ltr'] .ms-dlgOverlay{left:0px}[dir='rtl'] .ms-dlgOverlay{right:0px}.ms-dlgFrameContainer{padding:0px 19px 10px;overflow:auto}.ms-dlgTitle{padding:13px 19px 15px;white-space:nowrap;cursor:move;overflow:hidden}.ms-dlgFrameContainerNoPadding{padding:0px;overflow:auto}.ms-dlgTitleNoPadding{padding:0px;white-space:nowrap;cursor:move;overflow:hidden}.ms-dlgFrame{width:100%;height:100%;border:none}.ms-dlgContent{border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";position:absolute;background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47);box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47)}.ms-dlgContent h1{margin:auto;color:"},{"theme":"bodySubtext","defaultValue":"#605e5c"},{"rawString":";font-weight:200}.ms-dlgContent .ms-accessible,.ms-dlgContent .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.ms-dlgContent .ms-accessible-quickedit,.ms-dlgContent .ms-hidden{position:absolute;top:-2000px;overflow:hidden;height:1px;width:1px;display:block}.ms-dlgContentNoBorder{border:0px;position:absolute;background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47);box-shadow:0px 0px 30px 0px rgba(0,0,0,0.47)}.ms-dlg-heading{font-family:'Segoe UI Semilight', 'Segoe UI', 'Segoe', Tahoma, Helvetica, Arial, sans-serif;font-size:1.46em;color:#444}.ms-dlgTitleText{float:left;overflow:hidden;text-overflow:ellipsis}.ms-dlgContent>.ms-dlgBorder>.ms-dlgTitle>.ms-dlgCloseBtn>.s4-clust{height:16px !important;width:16px !important}.ms-dlgTitleBtns{margin-top:-10px;height:30px;float:right}[dir='ltr'] .ms-dlgTitleBtns{margin-right:-18px}[dir='rtl'] .ms-dlgTitleBtns{margin-left:-18px}.ms-dlgCloseBtn>span{cursor:pointer;border:1px solid transparent}.ms-dlgErrItem{display:inline}[dir='ltr'] .ms-dlgErrItem{padding-right:10px}[dir='rtl'] .ms-dlgErrItem{padding-left:10px}.ms-dlgLoadingTextDiv{padding:0px 0px 16px;white-space:nowrap}.ms-dlgLoadingText{text-align:left;width:100%}[dir='ltr'] .ms-dlgLoadingText{padding-left:3px}[dir='rtl'] .ms-dlgLoadingText{padding-right:3px}.ms-accentText{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-core-pageTitle{font-family:'Segoe UI Light', 'Segoe UI', 'Segoe', Tahoma, Helvetica, Arial, sans-serif;font-size:2.77em;white-space:nowrap}.ms-alignCenter{text-align:center}.ms-vb-icon{white-space:nowrap}img.ms-vb-icon-overlay{height:9px;width:9px}.ms-vb-icon-overlay{border:0px;position:relative;bottom:-2px;height:9px;width:9px}[dir='ltr'] .ms-vb-icon-overlay{left:-7px}[dir='rtl'] .ms-vb-icon-overlay{right:-7px}.ms-jsgrid-rowheader-partselected{border-bottom-color:"},{"theme":"inputFocusBorderAlt","defaultValue":"#0078d4"},{"rawString":";border-right-color:#c6c6c6}.jsgrid-control-focuselement:focus{outline:none}\n"},{"rawString":".spGridSelectAllIconContainer_88fa2e20{text-align:center;vertical-align:middle;min-height:25px;width:25px}.spGridSelectAllIcon_88fa2e20{font-size:16px}.spGridCell_88fa2e20{padding-top:11px;padding-bottom:11px;-webkit-box-sizing:border-box;box-sizing:border-box;min-height:42px}[dir='ltr'] .spGridCell_88fa2e20{padding-left:12px}[dir='rtl'] .spGridCell_88fa2e20{padding-right:12px}[dir='ltr'] .spGridCell_88fa2e20{padding-right:8px}[dir='rtl'] .spGridCell_88fa2e20{padding-left:8px}.tableColumnHeadersRow_88fa2e20 th{background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.errorAsterisk_88fa2e20{color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":"}[dir='ltr'] .errorAsterisk_88fa2e20{padding-left:4px}[dir='rtl'] .errorAsterisk_88fa2e20{padding-right:4px}.gridSelectAllIconContainer_88fa2e20{padding:0;text-align:center;vertical-align:middle;min-height:25px;width:58px;border-bottom:2px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridSelectAllIconContainer_88fa2e20.selectAllCheckMarkCell_88fa2e20{-webkit-box-sizing:border-box;box-sizing:border-box}[dir='ltr'] .gridSelectAllIconContainer_88fa2e20.selectAllCheckMarkCell_88fa2e20{padding-left:30px}[dir='rtl'] .gridSelectAllIconContainer_88fa2e20.selectAllCheckMarkCell_88fa2e20{padding-right:30px}.gridSelectAllIconContainer_88fa2e20.selectAllCheckMarkCell_88fa2e20 .selectionCheckIconsWrapper_88fa2e20{visibility:visible}.gridSelectAllIconContainer_88fa2e20.selectAllCheckMarkCell_88fa2e20:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";outline-offset:-1px}.gridSelectAllIconContainer_88fa2e20.selectAllCheckMarkCell_88fa2e20:focus .selectionCheckIcon_88fa2e20{visibility:visible}.gridSelectAllIconContainer_88fa2e20.allRowsSelected_88fa2e20 .selectionCheckIconsWrapper_88fa2e20:before{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.gridSelectAllIconContainer_88fa2e20.allRowsSelected_88fa2e20 .selectionCheckIcon_88fa2e20,.gridSelectAllIconContainer_88fa2e20.allRowsSelected_88fa2e20 .selectionCircleIcon_88fa2e20{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridSelectAllIconContainer_88fa2e20.allRowsSelected_88fa2e20 .selectionCheckIcon_88fa2e20{visibility:visible;font-weight:900}.headerStateContainer_88fa2e20{-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;width:20px;height:100%}.headerStateContainer_88fa2e20.hasStateElements_88fa2e20{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.headerStateContainer_88fa2e20.hasStateElements_88fa2e20 .headerStateBar_88fa2e20{display:none}.headerStateBar_88fa2e20{width:4px;border-radius:2px;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.selectionCheckMark_88fa2e20,.inlineNewItemAddIconContainer_88fa2e20{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;vertical-align:bottom;width:36px;height:100%}.selectionCheckIconsWrapper_88fa2e20{width:18px;height:18px;line-height:1;position:relative;visibility:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.selectionCheckIconsWrapper_88fa2e20:before{content:'';position:absolute;top:1px;right:1px;bottom:1px;left:1px;border-radius:50%;opacity:1;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.selectionCheckIconsWrapper_88fa2e20:hover .selectionCheckIcon_88fa2e20{visibility:visible}.selectionCircleIcon_88fa2e20,.selectionCheckIcon_88fa2e20{display:inline-block;position:absolute;left:0;top:0;width:18px;height:18px;text-align:center;vertical-align:middle;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.selectionCircleIcon_88fa2e20{font-size:18px}.selectionCheckIcon_88fa2e20{font-size:16px;visibility:hidden;left:0.5px}.stickyEditor_88fa2e20.selectedEditor_88fa2e20:before{z-index:1010}.selectedEditor_88fa2e20:after{pointer-events:none;content:'';position:absolute;left:0px;top:0px;bottom:0px;right:0px;border-radius:2px;border-width:2px;border-style:solid;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";-o-border-image:initial;border-image:initial;z-index:10}.inlineNewItemAddIcon_88fa2e20{font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.inlineNewItemAddIcon_88fa2e20:hover{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.inlineNewItemAddIconContainer_88fa2e20{display:none}.inlineNewItemPlaceHolder_88fa2e20{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:600;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";display:none}:not(.rowIsActive_88fa2e20).inLineNewItemRow_88fa2e20 .gridCell_88fa2e20{border-bottom:0px}:not(.rowIsActive_88fa2e20).inLineNewItemRow_88fa2e20 .gridCell_88fa2e20:after{content:none}:not(.rowIsActive_88fa2e20).inLineNewItemRow_88fa2e20 .inlineNewItemAddIconContainer_88fa2e20{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}:not(.rowIsActive_88fa2e20).inLineNewItemRow_88fa2e20 :not(.cellIsFocusedAndSelected_88fa2e20) .inlineNewItemPlaceHolder_88fa2e20{display:inline-block}:not(.rowIsActive_88fa2e20).inLineNewItemRow_88fa2e20 .selectionCheckMark_88fa2e20,:not(.rowIsActive_88fa2e20).inLineNewItemRow_88fa2e20 .headerStateBar_88fa2e20{display:none}:not(.rowIsActive_88fa2e20).inLineNewItemRow_88fa2e20:hover .inlineNewItemPlaceHolder_88fa2e20{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.gridCell_88fa2e20{padding:8px;min-height:28px;height:28px;vertical-align:middle;color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":";font-size:12px;border-bottom:2px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";position:relative}[dir='ltr'] .gridCell_88fa2e20{text-align:left}[dir='rtl'] .gridCell_88fa2e20{text-align:right}.gridCell_88fa2e20:after{content:'';position:absolute;width:1px;right:0px;top:0;bottom:0;margin:8px 0;border-radius:1px;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.gridCell_88fa2e20.gridStickySecondDataColumn_88fa2e20:after{right:2px}[dir='rtl'] .gridCell_88fa2e20:after{right:unset;left:0}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20.cellIsSticky_88fa2e20:before{z-index:1010}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20:before{content:'';position:absolute;z-index:10;top:0;left:0;right:0;bottom:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20.cellLeftBorder_88fa2e20:before{border-left-width:2px;border-left-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-left-style:dashed}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20.cellRightBorder_88fa2e20:before{border-right-width:2px;border-right-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-right-style:dashed;width:100% !important}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-width:2px;border-top-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-top-style:dashed}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-width:2px;border-bottom-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-bottom-style:dashed;height:100% !important}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20.cellLeftBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-left-radius:2px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20.cellLeftBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-left-radius:2px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20.cellRightBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-right-radius:2px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20.cellRightBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-right-radius:2px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellLeftBorder_88fa2e20):before{border-left-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-left-style:solid;border-left-width:2px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellTopBorder_88fa2e20):before{border-top-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-top-style:solid;border-top-width:2px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellTopBorder_88fa2e20):not(.cellLeftBorder_88fa2e20):before{border-top-left-radius:2px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellTopBorder_88fa2e20):not(.cellRightBorder_88fa2e20):before{border-top-right-radius:2px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellBottomBorder_88fa2e20):before{border-bottom-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-bottom-style:solid;border-bottom-width:2px;height:100%}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellBottomBorder_88fa2e20):not(.cellLeftBorder_88fa2e20):before{border-bottom-left-radius:2px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellBottomBorder_88fa2e20):not(.cellRightBorder_88fa2e20):before{border-bottom-right-radius:2px}.gridCell_88fa2e20.cellHasCopyBorder_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellRightBorder_88fa2e20):before{border-right-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-right-style:solid;border-right-width:2px}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellIsSticky_88fa2e20:before{z-index:1010}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.readOnlySelectionFrame_88fa2e20:before{border-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":" !important}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20:before{content:'';position:absolute;z-index:10;top:0px;left:0;right:0;bottom:0;width:100%;height:calc(100% + 2px);-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0px}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellLeftBorder_88fa2e20:before{border-left-width:2px;border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-left-style:solid}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellLeftBorder_88fa2e20:before{border-left-color:Highlight}}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellRightBorder_88fa2e20:before{border-right-width:2px;border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-style:solid;width:100% !important}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellRightBorder_88fa2e20:before{border-right-color:Highlight}}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-width:2px;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-style:solid}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-color:Highlight}}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-width:2px;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-style:solid;height:100% !important}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-color:Highlight}}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellLeftBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-left-radius:2px}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellLeftBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-left-radius:2px}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellRightBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-right-radius:2px}.gridCell_88fa2e20.cellHasFillDownBorder_88fa2e20.cellRightBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-right-radius:2px}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellIsSticky_88fa2e20:before{z-index:1010}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.readOnlySelectionFrame_88fa2e20:before{border-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":" !important}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20:before{content:'';position:absolute;z-index:10;top:0px;left:0;right:0;bottom:0;width:100%;height:calc(100% + 2px);-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0px}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellLeftBorder_88fa2e20:before{border-left-width:2px;border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-left-style:solid}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellLeftBorder_88fa2e20:before{border-left-color:Highlight}}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellRightBorder_88fa2e20:before{border-right-width:2px;border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-style:solid;width:100% !important}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellRightBorder_88fa2e20:before{border-right-color:Highlight}}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-width:2px;border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-style:solid}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-color:Highlight}}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-width:2px;border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-style:solid;height:100% !important}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-color:Highlight}}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellLeftBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-left-radius:2px}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellLeftBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-left-radius:2px}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellRightBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-right-radius:2px}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellRightBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-right-radius:2px}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellHasCopyBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-bottom-style:dashed}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellHasCopyBorder_88fa2e20.cellBottomBorder_88fa2e20:before{border-bottom-color:Highlight}}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellHasCopyBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-top-style:dashed}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellHasCopyBorder_88fa2e20.cellTopBorder_88fa2e20:before{border-top-color:Highlight}}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellHasCopyBorder_88fa2e20.cellLeftBorder_88fa2e20:before{border-left-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-left-style:dashed}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellHasCopyBorder_88fa2e20.cellLeftBorder_88fa2e20:before{border-left-color:Highlight}}.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellHasCopyBorder_88fa2e20.cellRightBorder_88fa2e20:before{border-right-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-right-style:dashed}@media screen and (-ms-high-contrast: active){.gridCell_88fa2e20.cellHasSelectionBorder_88fa2e20.cellHasCopyBorder_88fa2e20.cellRightBorder_88fa2e20:before{border-right-color:Highlight}}.gridCell_88fa2e20:not(.cellHasSelectionBorder_88fa2e20):not(.cellHasCopyBorder_88fa2e20):not(.cellHasFillDownBorder_88fa2e20):not(.firstCell_88fa2e20):hover:before{content:'';position:absolute;z-index:10;top:0;left:0;right:0;bottom:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;border-width:2px;border-style:solid;border-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-radius:2px}.gridCell_88fa2e20:not(.cellHasSelectionBorder_88fa2e20):not(.cellHasCopyBorder_88fa2e20):not(.cellHasFillDownBorder_88fa2e20):not(.firstCell_88fa2e20):hover.cellHasError_88fa2e20:before{border-color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":"}.gridCell_88fa2e20:not(.cellHasSelectionBorder_88fa2e20):not(.cellHasCopyBorder_88fa2e20):not(.cellHasFillDownBorder_88fa2e20):not(.firstCell_88fa2e20):hover:after{content:none}:not(.tableHasMouseDown_88fa2e20) .gridCell_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellIsSelected_88fa2e20){background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridCell_88fa2e20:not(.firstCell_88fa2e20):hover.cellHasError_88fa2e20:before{border-color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":" !important}.gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{content:attr(data-error-message);color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":";font-style:italic;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:calc(100% - 8px);background-color:transparent}[dir='ltr'] .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{border-right:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}[dir='rtl'] .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{border-left:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.gridCell_88fa2e20.cellIsFocusedAndSelected_88fa2e20:not(.firstCell_88fa2e20){background-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.gridCell_88fa2e20.cellIsFocusedAndSelected_88fa2e20:not(.firstCell_88fa2e20):after{content:none}.gridCell_88fa2e20.lastCell_88fa2e20{visibility:hidden}.gridCell_88fa2e20.firstCell_88fa2e20{padding:8px 0;font-size:0px}.gridCell_88fa2e20.firstCell_88fa2e20.cellHasSelectionBorder_88fa2e20 .selectionCheckIcon_88fa2e20,.gridCell_88fa2e20.firstCell_88fa2e20.cellHasSelectionBorder_88fa2e20 .selectionCircleIcon_88fa2e20{visibility:visible}.gridCell_88fa2e20.firstCell_88fa2e20:after{content:none}.gridCell_88fa2e20.cellHasError_88fa2e20{color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":"}.gridCell_88fa2e20.imageTypeCell_88fa2e20{padding:4px;font-size:0 !important}.gridCell_88fa2e20.customFormatterCell_88fa2e20{padding:4px;min-height:36px}.tableParentDiv_88fa2e20:not(.tableHasMouseDown_88fa2e20) .gridCell_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellLeftBorder_88fa2e20):before{border-left-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-left-style:solid;border-left-width:2px}.tableParentDiv_88fa2e20:not(.tableHasMouseDown_88fa2e20) .gridCell_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellTopBorder_88fa2e20):before{border-top-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-top-style:solid;border-top-width:2px}.tableParentDiv_88fa2e20:not(.tableHasMouseDown_88fa2e20) .gridCell_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellTopBorder_88fa2e20):not(.cellLeftBorder_88fa2e20):before{border-top-left-radius:2px}.tableParentDiv_88fa2e20:not(.tableHasMouseDown_88fa2e20) .gridCell_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellTopBorder_88fa2e20):not(.cellRightBorder_88fa2e20):before{border-top-right-radius:2px}.tableParentDiv_88fa2e20:not(.tableHasMouseDown_88fa2e20) .gridCell_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellBottomBorder_88fa2e20):before{border-bottom-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-bottom-style:solid;border-bottom-width:2px;height:100%}.tableParentDiv_88fa2e20:not(.tableHasMouseDown_88fa2e20) .gridCell_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellBottomBorder_88fa2e20):not(.cellLeftBorder_88fa2e20):before{border-bottom-left-radius:2px}.tableParentDiv_88fa2e20:not(.tableHasMouseDown_88fa2e20) .gridCell_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellBottomBorder_88fa2e20):not(.cellRightBorder_88fa2e20):before{border-bottom-right-radius:2px}.tableParentDiv_88fa2e20:not(.tableHasMouseDown_88fa2e20) .gridCell_88fa2e20:not(.firstCell_88fa2e20):hover:not(.cellRightBorder_88fa2e20):before{border-right-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-right-style:solid;border-right-width:2px}.gridRow_88fa2e20.rowIsSelected_88fa2e20{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridRow_88fa2e20.rowIsSelected_88fa2e20 .gridCell_88fa2e20:after{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.gridRow_88fa2e20.rowIsSelected_88fa2e20 .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{background-color:transparent}[dir='ltr'] .gridRow_88fa2e20.rowIsSelected_88fa2e20 .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{border-right-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}[dir='rtl'] .gridRow_88fa2e20.rowIsSelected_88fa2e20 .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{border-left-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.gridRow_88fa2e20.rowIsSelected_88fa2e20 .selectionCheckIconsWrapper_88fa2e20{visibility:visible}.gridRow_88fa2e20.rowIsSelected_88fa2e20 .selectionCheckIconsWrapper_88fa2e20:before{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.gridRow_88fa2e20.rowIsSelected_88fa2e20 .selectionCheckIcon_88fa2e20,.gridRow_88fa2e20.rowIsSelected_88fa2e20 .selectionCircleIcon_88fa2e20{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridRow_88fa2e20.rowIsSelected_88fa2e20 .selectionCheckIcon_88fa2e20{visibility:visible;font-weight:900}.gridRow_88fa2e20.rowIsSelected_88fa2e20 .gridCell_88fa2e20.firstCell_88fa2e20.cellIsFocusedAndSelected_88fa2e20{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridRow_88fa2e20.rowIsSelected_88fa2e20 .gridCell_88fa2e20.gridStickyDataColumn_88fa2e20:not(.cellIsFocusedAndSelected_88fa2e20),.gridRow_88fa2e20.rowIsSelected_88fa2e20 .gridCell_88fa2e20.gridStickyCheckColumn_88fa2e20:not(.cellIsFocusedAndSelected_88fa2e20){background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridRow_88fa2e20:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.gridRow_88fa2e20:hover .gridCell_88fa2e20:after{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.gridRow_88fa2e20:hover .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{background-color:transparent}[dir='ltr'] .gridRow_88fa2e20:hover .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{border-right-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}[dir='rtl'] .gridRow_88fa2e20:hover .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{border-left-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.gridRow_88fa2e20:hover .gridStickyDataColumn_88fa2e20:not(.cellIsFocusedAndSelected_88fa2e20),.gridRow_88fa2e20:hover .gridStickyCheckColumn_88fa2e20{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.gridRow_88fa2e20:hover .gridCell_88fa2e20{border-bottom-color:"},{"theme":"listBackground","defaultValue":"#ffffff"},{"rawString":"}.gridRow_88fa2e20:hover .selectionCheckIconsWrapper_88fa2e20{visibility:visible}.gridRow_88fa2e20:hover.rowIsSelected_88fa2e20{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.gridRow_88fa2e20:hover.rowIsSelected_88fa2e20 .gridCell_88fa2e20:after{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.gridRow_88fa2e20:hover.rowIsSelected_88fa2e20 .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{background-color:transparent}[dir='ltr'] .gridRow_88fa2e20:hover.rowIsSelected_88fa2e20 .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{border-right-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}[dir='rtl'] .gridRow_88fa2e20:hover.rowIsSelected_88fa2e20 .gridCell_88fa2e20.cellHasError_88fa2e20.hasErrorData_88fa2e20[data-error-message]::after{border-left-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.gridRow_88fa2e20:hover.rowIsSelected_88fa2e20 .gridStickyDataColumn_88fa2e20:not(.cellIsFocusedAndSelected_88fa2e20),.gridRow_88fa2e20:hover.rowIsSelected_88fa2e20 .gridStickyCheckColumn_88fa2e20{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.gridRow_88fa2e20:not(.rowIsSelected_88fa2e20) .cellIsSelected_88fa2e20{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.gridRow_88fa2e20:not(.rowIsSelected_88fa2e20) .cellIsSelected_88fa2e20:after{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.gridRow_88fa2e20.rowHasOnlyOneCellSelected_88fa2e20 .selectionCircleIcon_88fa2e20{visibility:visible}.gridRow_88fa2e20.rowHasOnlyOneCellSelected_88fa2e20 .cellHasSelectionBorder_88fa2e20.cellHasError_88fa2e20:before{border-color:"},{"theme":"errorIcon","defaultValue":"#A80000"},{"rawString":" !important}.gridRow_88fa2e20+.gridRow_88fa2e20:hover .gridCell_88fa2e20:not(.cellHasSelectionBorder_88fa2e20):not(.cellHasCopyBorder_88fa2e20):not(.cellHasFillDownBorder_88fa2e20):before{content:'';position:absolute;top:-2px;left:0;right:0;height:2px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.gridRow_88fa2e20+.gridRow_88fa2e20:hover .gridCell_88fa2e20:not(.cellHasSelectionBorder_88fa2e20):not(.cellHasCopyBorder_88fa2e20):not(.cellHasFillDownBorder_88fa2e20):not(.firstCell_88fa2e20):not(.cellHasFillDownBorder_88fa2e20):hover:before{top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-color:transparent;-webkit-box-shadow:0px -2px 0px "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";box-shadow:0px -2px 0px "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.tableHasMouseDown_88fa2e20 .gridRow_88fa2e20:hover .gridCell_88fa2e20.gridCell_88fa2e20:not(.cellHasSelectionBorder_88fa2e20):not(.cellHasCopyBorder_88fa2e20):not(.cellHasFillDownBorder_88fa2e20):hover:before{content:none}[dir='ltr'] .gridStickyChromeLeft_88fa2e20{left:32px}[dir='rtl'] .gridStickyChromeLeft_88fa2e20{right:32px}[dir='ltr'] .gridStickyChromelessLeft_88fa2e20{left:0px}[dir='rtl'] .gridStickyChromelessLeft_88fa2e20{right:0px}.gridStickyCheckColumn_88fa2e20,.gridStickyCheckColumnHeader_88fa2e20{position:-webkit-sticky;position:sticky;will-change:transform;z-index:1015}.gridStickyCheckColumn_88fa2e20.gridStickyCheckColumnHeader_88fa2e20{z-index:1035 !important}[dir='ltr'] .gridStickyDataLeft_88fa2e20{left:90px}[dir='rtl'] .gridStickyDataLeft_88fa2e20{right:90px}[dir='ltr'] .gridStickyDataLeftChromeless_88fa2e20{left:58px}[dir='rtl'] .gridStickyDataLeftChromeless_88fa2e20{right:58px}.gridStickyDataColumn_88fa2e20,.gridStickyDataColumnHeader_88fa2e20{position:-webkit-sticky;position:sticky;will-change:transform;z-index:1015}.gridStickydataColumnHeaderImportant_88fa2e20{position:-webkit-sticky !important;position:sticky !important}.gridStickyDataColumn_88fa2e20,.gridStickyCheckColumn_88fa2e20{border-left:none;border-right:none;border-top:none}.gridStickyDataColumn_88fa2e20.gridStickyDataColumnHeader_88fa2e20{z-index:1035 !important}[dir='ltr'] .stickyLeftEdgeKeeperContainerWithChrome_88fa2e20{left:32px}[dir='rtl'] .stickyLeftEdgeKeeperContainerWithChrome_88fa2e20{right:32px}[dir='ltr'] .stickyLeftEdgeKeeperContainerChromeless_88fa2e20{left:0px}[dir='rtl'] .stickyLeftEdgeKeeperContainerChromeless_88fa2e20{right:0px}.stickyLeftEdgeKeeperContainer_88fa2e20{position:-webkit-sticky;position:sticky;will-change:transform;height:0px;overflow-y:visible;z-index:999}[dir='ltr'] .stickyLeftEdgeKeeperWithChrome_88fa2e20{left:-33px}[dir='rtl'] .stickyLeftEdgeKeeperWithChrome_88fa2e20{right:-33px}[dir='ltr'] .stickyLeftEdgeKeeperChromeless_88fa2e20{left:-1px}[dir='rtl'] .stickyLeftEdgeKeeperChromeless_88fa2e20{right:-1px}.stickyLeftEdgeKeeper_88fa2e20{background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";width:calc(100% + 28px);position:absolute}.stickyTableHeaderLeftEdgeKeeper_88fa2e20{height:46px}.stickyColumnShadow_88fa2e20{width:14px;position:absolute;background:-webkit-gradient(linear, left top, right top, from(rgba(0,0,0,0.08)), color-stop(54.85%, rgba(0,0,0,0)));background:linear-gradient(90deg, rgba(0,0,0,0.08) 0%, rgba(0,0,0,0) 54.85%);content:'';-webkit-transition:opacity 0.15s ease-in-out;transition:opacity 0.15s ease-in-out}.stickyColumnShadowRtl_88fa2e20{width:14px;position:absolute;background:-webkit-gradient(linear, right top, left top, from(rgba(0,0,0,0.08)), color-stop(54.85%, rgba(0,0,0,0)));background:linear-gradient(270deg, rgba(0,0,0,0.08) 0%, rgba(0,0,0,0) 54.85%);content:'';-webkit-transition:opacity 0.15s ease-in-out;transition:opacity 0.15s ease-in-out}@media screen and (-ms-high-contrast: active){.stickyColumnShadow_88fa2e20{border-left:1px solid "},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":"}.gridCell_88fa2e20::after{-ms-high-contrast-adjust:none}.selectionCheckIcon_88fa2e20{-ms-high-contrast-adjust:none}.gridRow_88fa2e20+.gridRow_88fa2e20:hover .gridCell_88fa2e20:not(.cellHasSelectionBorder_88fa2e20):not(.cellHasCopyBorder_88fa2e20):not(.cellHasFillDownBorder_88fa2e20):before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-color:transparent;-webkit-box-shadow:0px 2px 0px WindowText;box-shadow:0px 2px 0px WindowText}.gridRow_88fa2e20+.gridRow_88fa2e20:hover .gridCell_88fa2e20:not(.cellHasSelectionBorder_88fa2e20):not(.cellHasCopyBorder_88fa2e20):not(.cellHasFillDownBorder_88fa2e20):not(.firstCell_88fa2e20):hover:before{content:'';-webkit-box-shadow:0px -2px 0px WindowText;box-shadow:0px -2px 0px WindowText;border-color:WindowText}}\n"},{"rawString":".ms-ContentTypeManagementPanel-Spinner{height:100vh}.ms-ContentTypeManagementPanel{display:-webkit-box;display:-ms-flexbox;display:flex;height:100vh}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel{-webkit-box-flex:1;-ms-flex:1;flex:1;background:#ffffff;padding:0px 10px 10px 30px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel{padding:0px 30px 10px 10px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Title{font-size:20px;font-family:'Segoe UI';margin:40px 0px 0px 0px;text-align:left}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Title{margin:40px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown{width:100%;margin:24px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-Dropdown{margin:24px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:70vh;overflow-y:auto;margin:12px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-ContentTypes-Container{margin:12px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label{margin:31px 0px 6px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentTypes-Label{margin:31px 0px 6px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-DefaultButton{border:none;font-family:'Segoe UI';font-style:normal;font-weight:600;font-size:14px;padding:0px 0px 0px 0px;width:100%;height:100%;text-align:left;background-color:inherit}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-DefaultButton{padding:0px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCTCheckbox{padding:11px 8px 11px 12px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCTCheckbox{padding:11px 12px 11px 8px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container{display:-webkit-box;display:-ms-flexbox;display:flex;padding:10px;border:none;width:100%;height:36px;text-align:left}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedCT-button-cell{-webkit-box-flex:1;-ms-flex:1;flex:1}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container:hover,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container:hover{cursor:pointer}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-container-selected,.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-AddedContentType-container-selected{background:#f3f2f1;border:none;width:100%;height:36px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-row-checkbox{-webkit-box-flex:1;-ms-flex:1;flex:1}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-PrimaryPanel .ms-ContentTypeManagementPanel-PrimaryPanel-SelectedContentType-row-text{-webkit-box-flex:100;-ms-flex:100;flex:100;border:none}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{-webkit-box-flex:2;-ms-flex:2;flex:2}html[dir='ltr'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{margin-left:20px}html[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel{margin-right:20px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Content{margin:97px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Content{margin:97px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle{margin:20px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-createNewViewToggle{margin:20px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-column{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-row{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex:1;flex:1;margin:10px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-container-row{margin:10px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-row{-webkit-box-flex:1;-ms-flex:1;flex:1;margin:8px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-row{margin:8px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView{margin:25px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-addColumnsToCurrentView{margin:25px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Columns{margin:25px 0px 0px 0px}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-Columns{margin:25px 0px 0px 0px}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{width:100%;margin-top:8px}[dir='ltr'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{text-align:left}[dir='rtl'] .ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable{text-align:right}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content thead{display:table;width:100%;table-layout:fixed}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content tbody{height:calc(100vh - 420px);overflow-y:auto;display:block;overflow-wrap:break-word}.ms-ContentTypeManagementPanel .ms-ContentTypeManagementPanel-SecondaryPanel .ms-ContentTypeManagementPanel-SecondaryPanel-FieldsTable-Content tbody tr{table-layout:fixed;display:table;width:100%}.ms-ContentTypeManagementPanel-Button{margin:10px 10px 10px 10px}[dir='rtl'] .ms-ContentTypeManagementPanel-Button{margin:10px 10px 10px 10px}.ms-ContentTypeManagementPanel-CancelButton{background-color:#f3f2f1}.ms-ContentTypeManagementPanel-PrimaryPanel-Buttons{position:absolute;bottom:0}[dir='ltr'] .ms-ContentTypeManagementPanel-PrimaryPanel-Buttons{margin-left:20px}[dir='rtl'] .ms-ContentTypeManagementPanel-PrimaryPanel-Buttons{margin-right:20px}.ms-ContentTypeManagementPanel-SecondaryPanel-Buttons{position:absolute;bottom:0}.ms-ContentTypeManagementPanel-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".ms-siteScriptProgress-accessible{position:absolute;top:-9001px;left:-9001px;height:1px;width:1px}.ms-siteScriptProgress-panel .ms-Panel-navigation{display:none}.ms-siteScriptProgress-panel .ms-Panel-scrollableContent{height:100%}html[dir='ltr'] .ms-siteScriptProgress-schemaArea{padding-right:20px}html[dir='rtl'] .ms-siteScriptProgress-schemaArea{padding-left:20px}.ms-siteScriptProgress-siteDesignLogoImage img{max-width:370px}.ms-siteScriptProgress-workingImage{margin-top:64px;max-height:227px;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1}.ms-siteScriptProgress-darker{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.ms-siteScriptProgress-xButton{width:40px;height:40px}html[dir='ltr'] .ms-siteScriptProgress-xButton{float:right}html[dir='rtl'] .ms-siteScriptProgress-xButton{float:left}.ms-siteScriptProgress-navigation{-webkit-box-flex:0;-ms-flex:0 0 40px;flex:0 0 40px;height:40px;padding-bottom:32px}.ms-siteScriptProgress-siteDesignDescription{padding:10px 0 20px}.ms-siteScriptProgress-explainerTitle{font-weight:600;padding:0 0 10px}.ms-siteScriptProgress-explainerLink{padding:10px 0 0}.ms-siteScriptProgress-runChoiceChecked{background:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.ms-siteScriptProgress-runChoiceChecked .ms-siteScriptProgress-runChoiceArrow{visibility:visible}.ms-ChoiceField:hover .ms-siteScriptProgress-runChoiceRoot{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ms-ChoiceField:hover .ms-siteScriptProgress-runChoiceRoot.ms-siteScriptProgress-runChoiceChecked{background:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.ms-ChoiceField:hover .ms-siteScriptProgress-runChoiceRoot .ms-siteScriptProgress-runChoiceArrow{visibility:visible}.ms-siteScriptProgress-runChoiceRoot{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;border-bottom:1px solid "},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";padding:16px 0;cursor:pointer}.ms-siteScriptProgress-runChoiceRadio{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;visibility:hidden}html[dir='ltr'] .ms-siteScriptProgress-runChoiceRadio{padding-right:5px}html[dir='rtl'] .ms-siteScriptProgress-runChoiceRadio{padding-left:5px}html[dir='ltr'] .ms-siteScriptProgress-runChoiceRadio{padding-left:25px}html[dir='rtl'] .ms-siteScriptProgress-runChoiceRadio{padding-right:25px}.ms-siteScriptProgress-runChoiceText{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}.ms-siteScriptProgress-runChoicePrimaryText{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;font-weight:600;padding:0 0 2px 0}.ms-siteScriptProgress-runChoiceSecondaryText{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.ms-siteScriptProgress-runChoiceArrow{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;visibility:hidden}html[dir='ltr'] .ms-siteScriptProgress-runChoiceArrow{padding-right:20px}html[dir='rtl'] .ms-siteScriptProgress-runChoiceArrow{padding-left:20px}.ms-siteScriptProgress-columnHeader{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}.ms-siteScriptProgress-columnBody{-webkit-box-flex:1;-ms-flex:1 1 0px;flex:1 1 0;margin:0 0 32px}.ms-siteScriptProgress-scrollable{overflow-y:auto}.ms-siteScriptProgress-columnFooter{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}.ms-siteScriptProgress-leftColumn .ms-siteScriptProgress-columnFooter{padding:0 0 60px}.ms-siteScriptProgress-leftColumn .ms-ChoiceField-wrapper{width:100%}.ms-siteScriptProgress-leftColumn .ms-ChoiceField{margin:0}.ms-siteScriptProgress-columnInternal{width:370px;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}[dir='ltr'] .ms-siteScriptProgress-columnInternal{padding-right:40px}[dir='rtl'] .ms-siteScriptProgress-columnInternal{padding-left:40px}.ms-siteScriptProgress-rightColumn .ms-siteScriptProgress-columnFooter{padding:20px 0;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ms-siteScriptProgress-tenantSiteDesignsLink{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400}.ms-siteScriptProgress-panelBottomTextBold{font-weight:800}.ms-siteScriptProgress-panelRoot{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%}.ms-siteScriptProgress-column{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:72px 40px 0;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1}.ms-siteScriptProgress-column.ms-siteScriptProgress-rightColumn{padding-top:0px}[dir='ltr'] .ms-siteScriptProgress-column.ms-siteScriptProgress-rightColumn{padding-right:0px}[dir='rtl'] .ms-siteScriptProgress-column.ms-siteScriptProgress-rightColumn{padding-left:0px}.ms-siteScriptProgress-noProgressIndicator{margin:0 0 21px;font-weight:600}.ms-siteScriptProgress-tenantSiteDesignTitle{margin:0 0 10px;font-weight:600}.ms-siteScriptProgress-panel .ms-Panel-contentInner{height:100%}.ms-siteScriptProgress-panel.ms-siteScriptProgress-panel{margin-top:50px}[dir='ltr'] .ms-siteScriptProgress-panel.ms-siteScriptProgress-panel .ms-Panel-main{left:auto}[dir='rtl'] .ms-siteScriptProgress-panel.ms-siteScriptProgress-panel .ms-Panel-main{right:auto}.ms-siteScriptProgress-panel.ms-siteScriptProgress-panel .ms-Panel-content{height:100%;padding:0}.ms-siteScriptProgress-emptyStageContainer{margin:auto}.ms-siteScriptProgress-errorIcon,.ms-siteScriptProgress-errorText{color:"},{"theme":"errorText","defaultValue":"#a4262c"},{"rawString":"}.ms-siteScriptProgress-inProgressSpinner{vertical-align:middle;display:inline-block}[dir='ltr'] .ms-siteScriptProgress-inProgressSpinner{margin-right:8px}[dir='rtl'] .ms-siteScriptProgress-inProgressSpinner{margin-left:8px}.ms-siteScriptProgress-actionIcon{-ms-flex-negative:0;flex-shrink:0}[dir='ltr'] .ms-siteScriptProgress-actionIcon{margin-right:8px}[dir='rtl'] .ms-siteScriptProgress-actionIcon{margin-left:8px}.ms-siteScriptProgress-successIcon{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-siteScriptProgress-gear{position:relative;top:3px}.ms-siteScriptProgress-activeActionTitle{color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":"}.ms-siteScriptProgress-actionIcon,.ms-siteScriptProgress-errorIcon{font-size:16px;line-height:16px}.ms-siteScriptProgress-errorText{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400;margin-top:4px}[dir='ltr'] .ms-siteScriptProgress-errorText{margin-left:24px}[dir='rtl'] .ms-siteScriptProgress-errorText{margin-right:24px}.ms-siteScriptProgress-actionTitle{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400;-ms-flex-negative:1;flex-shrink:1;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;min-width:0px;overflow-wrap:break-word;word-wrap:break-word;line-height:16px}[dir='ltr'] .ms-siteScriptProgress-actionTitleNoIcon{margin-left:24px}[dir='rtl'] .ms-siteScriptProgress-actionTitleNoIcon{margin-right:24px}.ms-siteScriptProgress-incompleteIcon{color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.ms-siteScriptProgress-inactiveActionTitle{color:"},{"theme":"disabledText","defaultValue":"#a19f9d"},{"rawString":"}.ms-siteScriptProgress-stageTitle{font-size:"},{"theme":"xSmallFontSize","defaultValue":"10px"},{"rawString":";font-weight:400}[dir='ltr'] .ms-siteScriptProgress-stageTitle{margin-left:24px}[dir='rtl'] .ms-siteScriptProgress-stageTitle{margin-right:24px}.ms-siteScriptProgress-stageTitle{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.ms-siteScriptProgress-siteScriptProgressSubtext,.ms-siteScriptProgress-siteScriptLongRunningText{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.ms-siteScriptProgress-siteScriptLongRunningText{margin:12px 0 0}.ms-siteScriptProgress-progressIndicatorContainer{margin:12px 0 20px}.ms-siteScriptProgress-progressIndicatorContainer .ms-ProgressIndicator-itemName{font-weight:600;padding:0}.ms-siteScriptProgress-siteDesignChooserTitle{font-weight:600;margin:0 0 8px}.ms-siteScriptProgress-panelTitle{font-size:"},{"theme":"xLargeFontSize","defaultValue":"20px"},{"rawString":";font-weight:100;font-weight:400;margin-bottom:20px}.ms-siteScriptProgress-panelBigTitle.ms-siteScriptProgress-panelTitle{font-size:"},{"theme":"xxLargeFontSize","defaultValue":"28px"},{"rawString":";font-weight:100}.ms-siteScriptProgress-panelSubtitle{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400;margin-bottom:20px}.ms-siteScriptProgress-titleContainer{margin:32px 0 28px}.ms-siteScriptProgress-actionContainer{margin-bottom:20px}.ms-siteScriptProgress-emptyStageProgressIndicator{margin-bottom:22px}.ms-siteScriptProgress-stageContainer{margin-top:8px}.ms-siteScriptProgress-actionHeader{display:-webkit-box;display:-ms-flexbox;display:flex}\n"},{"rawString":".fileHoverCardConversationsSection_10fcc140{display:block;position:relative;padding-bottom:8px;margin-right:12px;font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.fileHoverCardConversationsTitle_10fcc140{font-weight:600;padding:16px 0px 9px 4px;display:inline-block}.fileHoverCardConversation_10fcc140{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:7px 0px 8px 14px;margin:0 -24px 4px -12px;cursor:pointer}.fileHoverCardConversation_10fcc140:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.fileHoverCardConversationIcon_10fcc140{margin-right:4px;width:17px;height:17px}.fileHoverCardConversationParticipants_10fcc140{width:254px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:1px}.fileHoverCardConversationContext_10fcc140{width:254px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:2px}.fileHoverCardMeetingConversationContext_10fcc140{width:234px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block}.fileHoverCardConversationReferencePreview_10fcc140{width:254px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";margin-bottom:4px}.fileHoverCardConversationSharedByUser_10fcc140{font-weight:600}.fileHoverCardConversationsMeetingIcon_10fcc140{display:inline-block;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";vertical-align:top;padding-top:2.5px;margin-right:8px}\n"},{"rawString":".fileHoverCardRelatedFilesSection_ec3a626d{display:block;position:relative;padding-bottom:8px;margin-right:12px;font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.fileHoverCardRelatedFilesTitle_ec3a626d{font-weight:600;padding:16px 0px 9px 4px;display:inline-block}.fileHoverCardRelatedFile_ec3a626d{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:7px 0px 8px 14px;margin:0 -24px 0px -12px;cursor:pointer}.fileHoverCardRelatedFile_ec3a626d:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.fileHoverCardRelatedFilesName_ec3a626d{width:254px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fileHoverCardRelatedFileIcon_ec3a626d{margin-right:8px;width:17px;height:17px}\n"},{"rawString":".CreateAIBModelPanel-separator{margin-top:5px}.ErrorTextStyle{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.footerDescription{border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}"},{"rawString":".sp-CreateAIBModelPanel-Spinner{margin-top:5px}.sp-CreateAIBModelPanel-Dropdown{margin-top:15px}.sp-CreateAIBModelPanel-AdvancedSettingsContainer{border-color:#edebe9;border-style:solid;border-width:1px 0 1px 0;padding:20px 0 20px 0}.sp-CreateAIBModelPanel-AdvancedSettingsHeader{display:flex;justify-content:space-between;cursor:pointer}.sp-CreateAIBModelPanel-AdvancedSettingsHeaderText{display:flex;justify-content:center;align-items:center}.sp-CreateAIBModelPanel-ChevronColor{color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.sp-CreateAIBModelPanel-AdvancedSettingsExpandedMargin{margin-top:10px}.sp-CreateAIBModelPanel-ViewContainer{margin-top:20px}.sp-CreateAIBModelPanel-RetentionLabel{margin-top:20px}.sp-CreateAIBModelPanel-TooltipIcon{top:4px;left:5px;position:relative;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.sp-CreateAIBModelPanel-retentionLabelDescription{display:inline-block;font-size:11px;font-style:italic;padding-bottom:5px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir=ltr] .sp-CreateAIBModelPanel-retentionLabelDescription{margin-left:4px}[dir=rtl] .sp-CreateAIBModelPanel-retentionLabelDescription{margin-right:4px}"},{"rawString":".option-container{border-color:#edebe9;border-style:solid;border-width:1px 0 1px 0;padding:20px 0 20px 0}.item-timeStamp{color:#605e5c;font-size:12px}.sp-ViewAIBModelPanel-Spinner{margin-top:5px}.sp-ViewAIBModelPanel-RetentionLabel{margin-top:20px}.sp-ViewAIBModelPanel-retentionLabelDescription{display:inline-block;font-size:11px;font-style:italic;padding-bottom:5px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir=ltr] .sp-ViewAIBModelPanel-retentionLabelDescription{margin-left:4px}[dir=rtl] .sp-ViewAIBModelPanel-retentionLabelDescription{margin-right:4px}"},{"rawString":".ContentCenterCreateModelPanel-bottomMargin{margin-bottom:10px}.ContentCenterCreateModelPanel-dropdown{margin-top:15px}.spinner-topMargin{margin-top:5px}.advancedSettingsContainer{border-color:#edebe9;border-style:solid;border-width:1px 0 1px 0;padding:20px 0 20px 0}.advancedSettingsHeader{display:flex;justify-content:space-between;cursor:pointer}.advancedSettingsHeaderText{display:flex;justify-content:center;align-items:center}.advancedSettingsExpandedMargin{margin-top:10px}.warningMassage{position:absolute;top:0;left:0;z-index:1}.infoIcon{top:4px;left:5px;position:relative;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}"},{"rawString":".ms-ActivityItem-personaContainer{display:inline}.ms-CommandBar.ms-AnalyticsActionBar--bar{background-color:transparent;padding-left:0;padding-right:0}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar{background-color:transparent}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-textContainer{font-size:12px;font-weight:400}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-icon,.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-textContainer{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar:hover{background-color:transparent}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar:hover .ms-Button-textContainer{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}"},{"rawString":".frame_4310f2e1{border:none;display:block;width:800px;height:600px;max-width:100%;max-height:100%}"},{"rawString":".isFluent .od-TopBar-commandBar .ms-Button--commandBar .ms-Button-menuIcon{background-color:inherit}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot{position:relative;border-bottom:2px solid transparent;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot .ms-Button-label:after{transition:all .1s ease-in-out}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot:active{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled{border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view:hover,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view:hover .ms-Button-label:after,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled:hover .ms-Button-label:after{width:100%;left:0}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view .ms-Button-label,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled .ms-Button-label{font-weight:600}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view .ms-Button-label:after,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled .ms-Button-label:after{content:'';display:block;position:absolute;left:8px;border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";bottom:-2px;width:calc(100% - (8px + 8px))}.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled,.od-TopBar-commandBar .ms-CommandBar button.is-pivot:active,.od-TopBar-commandBar .ms-CommandBar button.is-pivot:hover{border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled{font-weight:600}[dir=ltr] .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-last-pivot{margin-right:24px}[dir=rtl] .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-last-pivot{margin-left:24px}.od-TopBar-commandBar .ms-CommandBar button.is-toggled{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-TopBar-commandBar .ms-CommandBar button.is-toggled:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.od-TopBar.od--hasSelection .ms-CommandBar{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";transition:none}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";background-color:inherit;transition:none}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:hover{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-toggled{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-toggled:hover{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:active{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-expanded:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}"},{"rawString":".SchedulingComponentToggle-topPadding{padding-top:20px;padding-bottom:10px}"},{"rawString":".container_1addcdca{border:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:200px;margin:0 30px 0 30px;margin-top:30px;min-width:1100px}.closeButtonDiv_1addcdca{display:flex;justify-content:flex-end;padding-top:5px;padding-right:10px}.closeButton_1addcdca{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.closeButton_1addcdca:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.bannerContent_1addcdca{width:100%}.bannerHeaderContent_1addcdca{height:90px}.bannerPrimaryContent_1addcdca{padding-left:16%;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.bannerPrimaryText_1addcdca{font-size:large;font-weight:600}.bannerSecondaryText_1addcdca{font-size:medium;font-weight:600}.buttonStack_1addcdca{margin-top:10px}.bannerHeaderTagStyle_1addcdca{display:flex;justify-content:center;align-items:center}.descriptionContainer_1addcdca{padding-left:16%;width:84%;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";height:75px;padding-top:15px}.descriptionText_1addcdca{width:80%}.imageContainer_1addcdca{display:flex;justify-content:center;align-items:center;width:14%;height:200px;position:absolute}@media only screen and (max-width:900px){.imageContainer_1addcdca{padding-left:30px}}"}]);return {TopCollaborator_8:{topCollaPlaceHolder:'topCollaPlaceHolder_d98a3068',topCollaboratorIcon:'topCollaboratorIcon_d98a3068',topCollaboratorUserName:'topCollaboratorUserName_d98a3068',topCollaboratorTooltip:'topCollaboratorTooltip_d98a3068',userWithTopCollaborator:'userWithTopCollaborator_d98a3068',columnHeader:'columnHeader_d98a3068'},GroupItemDetailsHeader_0:{root:'root_496c5d97'},OpenCommandButton_8:{iconContainer:'iconContainer_7dd788dd',menuItemIconContainer:'menuItemIconContainer_7dd788dd',logoFillIcon:'logoFillIcon_7dd788dd',logoIcon:'logoIcon_7dd788dd',contextualMenuItemLinkContent:'contextualMenuItemLinkContent_7dd788dd',contextualMenuItemTextLabel:'contextualMenuItemTextLabel_7dd788dd'},RecentGroupItemDetailsHeader_9:{root:'root_c4c46d59'},SaveViewDialog_0:{saveViewDialogTextField:'saveViewDialogTextField_3cbf8109',saveViewDialogCheckbox:'saveViewDialogCheckbox_3cbf8109',saveViewDialogSpinner:'saveViewDialogSpinner_3cbf8109'},SyncDialog_6:{syncDialog:'syncDialog_f917fdca',syncDialogContent:'syncDialogContent_f917fdca',syncImg:'syncImg_f917fdca',copyLibraryId:'copyLibraryId_f917fdca',pointerText:'pointerText_f917fdca',footNote:'footNote_f917fdca',syncTitle:'syncTitle_f917fdca',contentContainer:'contentContainer_f917fdca',adminContentContainer:'adminContentContainer_f917fdca',separator:'separator_f917fdca',errorContainer:'errorContainer_f917fdca',errorTitle:'errorTitle_f917fdca',spinner:'spinner_f917fdca'},CustomActionCommands_5:{customActionCommandIcon:'customActionCommandIcon_4e556d3a'},ViewCommands_5:{needsAttentionIconOverlay:'needsAttentionIconOverlay_6e57506a',needsAttentionIcon:'needsAttentionIcon_6e57506a'},FilterPanel_7:{alert:'alert_b1843c56',filterPanelClearAllButton:'filterPanelClearAllButton_b1843c56',filterPanelRoot:'filterPanelRoot_b1843c56',filterPanelFooter:'filterPanelFooter_b1843c56',filterPanelSuggestionsNone:'filterPanelSuggestionsNone_b1843c56',filterPanelSuggestionItem:'filterPanelSuggestionItem_b1843c56',peoplePickerRoot:'peoplePickerRoot_b1843c56',filterPickerRoot:'filterPickerRoot_b1843c56'},IFrameDialog_9:{IFrameDialog:'IFrameDialog_3b24ebc2'},ApproveRejectDialog_9:{commentRoot:'commentRoot_7276829d',approveRejectDialogSpinner:'approveRejectDialogSpinner_7276829d',approveRejectDialogMessageBar:'approveRejectDialogMessageBar_7276829d',approveRejectDialogStatusLabel:'approveRejectDialogStatusLabel_7276829d'},PinSite_9:{odSitePinIcon:'odSitePinIcon_6b85bac2',odSitePinButtonDefault:'odSitePinButtonDefault_6b85bac2',odSitePinButtonHover:'odSitePinButtonHover_6b85bac2',odSitePinPinHover:'odSitePinPinHover_6b85bac2',sitePinLeftNavParent:'sitePinLeftNavParent_6b85bac2',sitePinAllSitesParent:'sitePinAllSitesParent_6b85bac2',odSitePinContainer:'odSitePinContainer_6b85bac2'},PinnedItemsCardRenderer_0:{folderCover:'folderCover_30e6a311',blankFolderCover:'blankFolderCover_30e6a311'},SiteHeaderTileCell_3:{name:'name_22e50cfa'},SiteIcon_5:{acronym:'acronym_9c941adf',acronymText:'acronymText_9c941adf',siteLogo:'siteLogo_9c941adf',siteLogoHidden:'siteLogoHidden_9c941adf'},SiteItemTile_3:{root:'root_8026515c',icon:'icon_8026515c',nameplate:'nameplate_8026515c',name:'name_8026515c',activity:'activity_8026515c'},SiteItemTile_v2_7:{root:'root_012d5c5f',nameplate:'nameplate_012d5c5f',name:'name_012d5c5f',activity:'activity_012d5c5f',icon:'icon_012d5c5f'},teamSiteNavLink_1:{icon:'icon_6f3811cb',siteName:'siteName_6f3811cb',siteNameContainer:'siteNameContainer_6f3811cb',linkName:'linkName_6f3811cb',parentContainer:'parentContainer_6f3811cb',dragContainer:'dragContainer_6f3811cb',siteContainer:'siteContainer_6f3811cb',dropZoneParent:'dropZoneParent_6f3811cb',topDropZoneHover:'topDropZoneHover_6f3811cb',bottomDropZoneHover:'bottomDropZoneHover_6f3811cb',dropZone:'dropZone_6f3811cb',dragHandler:'dragHandler_6f3811cb'},CustomFormatterItemTile_6:{customTile:'customTile_261e255c',customTileFocusZone:'customTileFocusZone_261e255c'},CommandButton_8:{commandButton:'commandButton_b69fa478'},ShowKeyboardMap_4:{keyboardMapGroup:'keyboardMapGroup_ef2ba83e',keyboardMapTable:'keyboardMapTable_ef2ba83e',keyboardMapRow:'keyboardMapRow_ef2ba83e',keyboardMapKey:'keyboardMapKey_ef2ba83e',keyboardMapVal:'keyboardMapVal_ef2ba83e'},SocialBar_2:{commandLink:'commandLink_55545429',link:'link_55545429',pageUsageChartContainer:'pageUsageChartContainer_55545429',root:'root_55545429',socialBarList:'socialBarList_55545429',socialBarPanel:'socialBarPanel_55545429',socialBarPanelContent:'socialBarPanelContent_55545429',spSocialPanelPivotContent:'spSocialPanelPivotContent_55545429',socialBarPanelHeader:'socialBarPanelHeader_55545429',socialBarPanelHeaderText:'socialBarPanelHeaderText_55545429',socialBarPanelPersona:'socialBarPanelPersona_55545429',socialBarPanelPersonaDescription:'socialBarPanelPersonaDescription_55545429',viewsIcon:'viewsIcon_55545429',analyticsStatsLink:'analyticsStatsLink_55545429'},ItemSetTilesList_2:{root:'root_d3ac4a74',showAllCell:'showAllCell_d3ac4a74'},ItemTile_8:{tile:'tile_2dea517e',hideFileTypeIcon:'hideFileTypeIcon_2dea517e',fileTypeIcon:'fileTypeIcon_2dea517e',tileAppIcon:'tileAppIcon_2dea517e',hideThumbnail:'hideThumbnail_2dea517e',thumbnail:'thumbnail_2dea517e',defaultTile:'defaultTile_2dea517e',folderCover:'folderCover_2dea517e',thumbnailNotResolved:'thumbnailNotResolved_2dea517e',name:'name_2dea517e',blankFolderCover:'blankFolderCover_2dea517e'},NameDialog_8:{nameDialogContent:'nameDialogContent_e73d00a0',nameDialogContentFileExtension:'nameDialogContentFileExtension_e73d00a0',nameDialogSpinner:'nameDialogSpinner_e73d00a0'},ProgressCallout_7:{callout:'callout_f7d6e7fb',progressList:'progressList_f7d6e7fb',viewAllButton:'viewAllButton_f7d6e7fb',accessibleStatus:'accessibleStatus_f7d6e7fb'},ProgressItemTile_3:{tile:'tile_9fe29b4a',hasIcon:'hasIcon_9fe29b4a',title:'title_9fe29b4a',icon:'icon_9fe29b4a',hasProgress:'hasProgress_9fe29b4a',progress:'progress_9fe29b4a',error:'error_9fe29b4a',description:'description_9fe29b4a',actions:'actions_9fe29b4a',cancel:'cancel_9fe29b4a'},ProgressList_3:{root:'root_90d4ef9e',group:'group_90d4ef9e',item:'item_90d4ef9e'},DragLayerPreview_5:{dragPreviewRoot:'dragPreviewRoot_084c3e71',dragPreviewIcon:'dragPreviewIcon_084c3e71',dragPreviewText:'dragPreviewText_084c3e71'},DragDropWrapper_0:{dragging:'dragging_685629c0',canDrop:'canDrop_685629c0',dragOver:'dragOver_685629c0'},LayoutMode_0:{root:'root_ea8e7c65',absolute:'absolute_ea8e7c65',fullHeight:'fullHeight_ea8e7c65'},SPGrid_6:{spGridTableHead:'spGridTableHead_7ed50b05',spGridPagingFooter:'spGridPagingFooter_7ed50b05',spGridPagingFooterContent:'spGridPagingFooterContent_7ed50b05',spGridCustomFormatField:'spGridCustomFormatField_7ed50b05',wrapperTable:'wrapperTable_7ed50b05',wrapperTd:'wrapperTd_7ed50b05',gridFocusEntryPoint:'gridFocusEntryPoint_7ed50b05',gridParentFocusable:'gridParentFocusable_7ed50b05',spGridRoot:'spGridRoot_7ed50b05',skipGridContentButton:'skipGridContentButton_7ed50b05',spGridErrorIcon:'spGridErrorIcon_7ed50b05',srOnly:'srOnly_7ed50b05',boolIconDiv:'boolIconDiv_7ed50b05',boolIcon:'boolIcon_7ed50b05',dropHintStyle:'dropHintStyle_7ed50b05',containerRefreshed:'containerRefreshed_7ed50b05',dropHintCaretStyle:'dropHintCaretStyle_7ed50b05',caretRefreshed:'caretRefreshed_7ed50b05',dropHintLineStyle:'dropHintLineStyle_7ed50b05',lineRefreshed:'lineRefreshed_7ed50b05',listLink:'listLink_7ed50b05',isTitleOrNameFieldVisualRefresh:'isTitleOrNameFieldVisualRefresh_7ed50b05',isTitleOrNameField:'isTitleOrNameField_7ed50b05',cellHiddenOverflow:'cellHiddenOverflow_7ed50b05',cellBreakWordOverflow:'cellBreakWordOverflow_7ed50b05',personaPillOverflowContainer:'personaPillOverflowContainer_7ed50b05',customFormatField:'customFormatField_7ed50b05',msGridWidgetDock:'msGridWidgetDock_7ed50b05',stickyEditor:'stickyEditor_7ed50b05',msGridWidgetDockHover:'msGridWidgetDockHover_7ed50b05',msGridWidgetDockPressed:'msGridWidgetDockPressed_7ed50b05',msGridWidgetCell:'msGridWidgetCell_7ed50b05',msGridCellSelectedEditable:'msGridCellSelectedEditable_7ed50b05',spGridErrorNotification:'spGridErrorNotification_7ed50b05',msGrid:'msGrid_7ed50b05',msGridLink:'msGridLink_7ed50b05',msGridSelection:'msGridSelection_7ed50b05',msGridSelectionReadonly:'msGridSelectionReadonly_7ed50b05',msGridEdit:'msGridEdit_7ed50b05',msGridTimescale:'msGridTimescale_7ed50b05',msGridColHeaderNormal:'msGridColHeaderNormal_7ed50b05',msGridColHeaderElemBgColorsNormal:'msGridColHeaderElemBgColorsNormal_7ed50b05',msGridColHeaderElemHoverBgColorsNormal:'msGridColHeaderElemHoverBgColorsNormal_7ed50b05',msGridColElemColorsClickNormal:'msGridColElemColorsClickNormal_7ed50b05',msGridColHeaderNormalHover:'msGridColHeaderNormalHover_7ed50b05',msGridColHeaderElemBgColorsNormalHover:'msGridColHeaderElemBgColorsNormalHover_7ed50b05',msGridColHeaderElemHoverBgColorsNormalHover:'msGridColHeaderElemHoverBgColorsNormalHover_7ed50b05',msGridColElemColorsClickNormalHover:'msGridColElemColorsClickNormalHover_7ed50b05',msGridColHeaderPartSelected:'msGridColHeaderPartSelected_7ed50b05',msGridColHeaderElemBgColorsPartSelected:'msGridColHeaderElemBgColorsPartSelected_7ed50b05',msGridColHeaderElemHoverBgColorsPartSelected:'msGridColHeaderElemHoverBgColorsPartSelected_7ed50b05',msGridColElemColorsClickPartSelected:'msGridColElemColorsClickPartSelected_7ed50b05',msGridColHeaderPartSelectedHover:'msGridColHeaderPartSelectedHover_7ed50b05',msGridColHeaderElemBgColorsPartSelectedHover:'msGridColHeaderElemBgColorsPartSelectedHover_7ed50b05',msGridColHeaderElemHoverBgColorsPartSelectedHover:'msGridColHeaderElemHoverBgColorsPartSelectedHover_7ed50b05',msGridColElemColorsClickPartSelectedHover:'msGridColElemColorsClickPartSelectedHover_7ed50b05',msGridColHeaderAllSelected:'msGridColHeaderAllSelected_7ed50b05',msGridColHeaderElemBgColorsAllSelected:'msGridColHeaderElemBgColorsAllSelected_7ed50b05',msGridColHeaderElemHoverBgColorsAllSelected:'msGridColHeaderElemHoverBgColorsAllSelected_7ed50b05',msGridColElemColorsClickAllSelected:'msGridColElemColorsClickAllSelected_7ed50b05',msGridColHeaderAllSelectedHover:'msGridColHeaderAllSelectedHover_7ed50b05',msGridColHeaderElemBgColorsAllSelectedHover:'msGridColHeaderElemBgColorsAllSelectedHover_7ed50b05',msGridColHeaderElemHoverBgColorsAllSelectedHover:'msGridColHeaderElemHoverBgColorsAllSelectedHover_7ed50b05',msGridColElemColorsClickAllSelectedHover:'msGridColElemColorsClickAllSelectedHover_7ed50b05',msGridRowHeaderNormal:'msGridRowHeaderNormal_7ed50b05',msGridRowHeaderNormalHover:'msGridRowHeaderNormalHover_7ed50b05',msGridRowHeaderPartSelected:'msGridRowHeaderPartSelected_7ed50b05',msGridRowHeaderPartSelectedHover:'msGridRowHeaderPartSelectedHover_7ed50b05',msGridRowHeaderAllSelected:'msGridRowHeaderAllSelected_7ed50b05',msGridRowHeaderAllSelectedHover:'msGridRowHeaderAllSelectedHover_7ed50b05',msGridSplitter:'msGridSplitter_7ed50b05',msGridSplitterHandle:'msGridSplitterHandle_7ed50b05',msGridSplitterHover:'msGridSplitterHover_7ed50b05',msGridSplitterHandleHover:'msGridSplitterHandleHover_7ed50b05',msGridSplitterDrag:'msGridSplitterDrag_7ed50b05',msGridSplitterHandleDrag:'msGridSplitterHandleDrag_7ed50b05',spGridControlFocusElement:'spGridControlFocusElement_7ed50b05',spGridControlEditbox:'spGridControlEditbox_7ed50b05',inputIsNumber:'inputIsNumber_7ed50b05',inputIsTitle:'inputIsTitle_7ed50b05',spGridControlEditboxDynamicHeight:'spGridControlEditboxDynamicHeight_7ed50b05',jsgridControlMultilineTextarea:'jsgridControlMultilineTextarea_7ed50b05',jsgridControlRteContainer:'jsgridControlRteContainer_7ed50b05',msRteStateField:'msRteStateField_7ed50b05'},RowHeaderState_3:{errorIcon:'errorIcon_53f979a1'},tablemgr_9:{spGridSelectAllIconContainer:'spGridSelectAllIconContainer_88fa2e20',spGridSelectAllIcon:'spGridSelectAllIcon_88fa2e20',spGridCell:'spGridCell_88fa2e20',tableColumnHeadersRow:'tableColumnHeadersRow_88fa2e20',errorAsterisk:'errorAsterisk_88fa2e20',gridSelectAllIconContainer:'gridSelectAllIconContainer_88fa2e20',selectAllCheckMarkCell:'selectAllCheckMarkCell_88fa2e20',selectionCheckIconsWrapper:'selectionCheckIconsWrapper_88fa2e20',selectionCheckIcon:'selectionCheckIcon_88fa2e20',allRowsSelected:'allRowsSelected_88fa2e20',selectionCircleIcon:'selectionCircleIcon_88fa2e20',headerStateContainer:'headerStateContainer_88fa2e20',hasStateElements:'hasStateElements_88fa2e20',headerStateBar:'headerStateBar_88fa2e20',selectionCheckMark:'selectionCheckMark_88fa2e20',inlineNewItemAddIconContainer:'inlineNewItemAddIconContainer_88fa2e20',stickyEditor:'stickyEditor_88fa2e20',selectedEditor:'selectedEditor_88fa2e20',inlineNewItemAddIcon:'inlineNewItemAddIcon_88fa2e20',inlineNewItemPlaceHolder:'inlineNewItemPlaceHolder_88fa2e20',rowIsActive:'rowIsActive_88fa2e20',inLineNewItemRow:'inLineNewItemRow_88fa2e20',gridCell:'gridCell_88fa2e20',cellIsFocusedAndSelected:'cellIsFocusedAndSelected_88fa2e20',gridStickySecondDataColumn:'gridStickySecondDataColumn_88fa2e20',cellHasCopyBorder:'cellHasCopyBorder_88fa2e20',cellIsSticky:'cellIsSticky_88fa2e20',cellLeftBorder:'cellLeftBorder_88fa2e20',cellRightBorder:'cellRightBorder_88fa2e20',cellTopBorder:'cellTopBorder_88fa2e20',cellBottomBorder:'cellBottomBorder_88fa2e20',firstCell:'firstCell_88fa2e20',cellHasFillDownBorder:'cellHasFillDownBorder_88fa2e20',readOnlySelectionFrame:'readOnlySelectionFrame_88fa2e20',cellHasSelectionBorder:'cellHasSelectionBorder_88fa2e20',cellHasError:'cellHasError_88fa2e20',tableHasMouseDown:'tableHasMouseDown_88fa2e20',cellIsSelected:'cellIsSelected_88fa2e20',hasErrorData:'hasErrorData_88fa2e20',lastCell:'lastCell_88fa2e20',imageTypeCell:'imageTypeCell_88fa2e20',customFormatterCell:'customFormatterCell_88fa2e20',tableParentDiv:'tableParentDiv_88fa2e20',gridRow:'gridRow_88fa2e20',rowIsSelected:'rowIsSelected_88fa2e20',gridStickyDataColumn:'gridStickyDataColumn_88fa2e20',gridStickyCheckColumn:'gridStickyCheckColumn_88fa2e20',rowHasOnlyOneCellSelected:'rowHasOnlyOneCellSelected_88fa2e20',gridStickyChromeLeft:'gridStickyChromeLeft_88fa2e20',gridStickyChromelessLeft:'gridStickyChromelessLeft_88fa2e20',gridStickyCheckColumnHeader:'gridStickyCheckColumnHeader_88fa2e20',gridStickyDataLeft:'gridStickyDataLeft_88fa2e20',gridStickyDataLeftChromeless:'gridStickyDataLeftChromeless_88fa2e20',gridStickyDataColumnHeader:'gridStickyDataColumnHeader_88fa2e20',gridStickydataColumnHeaderImportant:'gridStickydataColumnHeaderImportant_88fa2e20',stickyLeftEdgeKeeperContainerWithChrome:'stickyLeftEdgeKeeperContainerWithChrome_88fa2e20',stickyLeftEdgeKeeperContainerChromeless:'stickyLeftEdgeKeeperContainerChromeless_88fa2e20',stickyLeftEdgeKeeperContainer:'stickyLeftEdgeKeeperContainer_88fa2e20',stickyLeftEdgeKeeperWithChrome:'stickyLeftEdgeKeeperWithChrome_88fa2e20',stickyLeftEdgeKeeperChromeless:'stickyLeftEdgeKeeperChromeless_88fa2e20',stickyLeftEdgeKeeper:'stickyLeftEdgeKeeper_88fa2e20',stickyTableHeaderLeftEdgeKeeper:'stickyTableHeaderLeftEdgeKeeper_88fa2e20',stickyColumnShadow:'stickyColumnShadow_88fa2e20',stickyColumnShadowRtl:'stickyColumnShadowRtl_88fa2e20'},control_2:{msGridEditControlContainer:'msGridEditControlContainer_2c47ad2a',msGridEditControlEditBox:'msGridEditControlEditBox_2c47ad2a',errorWidgetContainer:'errorWidgetContainer_2c47ad2a',readOnlyWidgetContainer:'readOnlyWidgetContainer_2c47ad2a',stickyZIndex:'stickyZIndex_2c47ad2a',widgetExpanded:'widgetExpanded_2c47ad2a'},PersonDisplay_7:{personDisplayPill:'personDisplayPill_3babd190',personDisplayCoin:'personDisplayCoin_3babd190',personDisplayPhoto:'personDisplayPhoto_3babd190',personDisplayName:'personDisplayName_3babd190'},panemgr_9:{topFrameElement:'topFrameElement_4330d6f0',dashedBorder:'dashedBorder_4330d6f0',dashedBorderUnfocused:'dashedBorderUnfocused_4330d6f0',bottomFrameElement:'bottomFrameElement_4330d6f0',leftFrameElement:'leftFrameElement_4330d6f0',rightFrameElement:'rightFrameElement_4330d6f0',stickyFrame:'stickyFrame_4330d6f0',solidBorder:'solidBorder_4330d6f0',copyFrame:'copyFrame_4330d6f0',selectionDragHandle:'selectionDragHandle_4330d6f0',rowSelectionHandle:'rowSelectionHandle_4330d6f0',editorIsActive:'editorIsActive_4330d6f0',stickyHandle:'stickyHandle_4330d6f0',selectionDragHandleContents:'selectionDragHandleContents_4330d6f0',selectionDragHandleContainer:'selectionDragHandleContainer_4330d6f0',readonlySelectionRect:'readonlySelectionRect_4330d6f0',dragToFillFrame:'dragToFillFrame_4330d6f0'},CheckboxEditor_0:{checkBox:'checkBox_f56072a9'},ChoicePill_6:{pill:'pill_494d3723',pillNoHoverStyle:'pillNoHoverStyle_494d3723',pillWithHoverByDefault:'pillWithHoverByDefault_494d3723',innerPillPlainText:'innerPillPlainText_494d3723',wellInput:'wellInput_494d3723',editorButtonsContainer:'editorButtonsContainer_494d3723',flyOutButtonsContainer:'flyOutButtonsContainer_494d3723',fillInWrapperDiv:'fillInWrapperDiv_494d3723',fillInWrapperDivWithBackground:'fillInWrapperDivWithBackground_494d3723',fillInPillDiv:'fillInPillDiv_494d3723',fillInLabel:'fillInLabel_494d3723',buttonBorderFocused:'buttonBorderFocused_494d3723',iconClass:'iconClass_494d3723'},DateEditor_5:{quickEditDateTimeEditor:'quickEditDateTimeEditor_233cf129',quickEditDateTimeEditorInput:'quickEditDateTimeEditorInput_233cf129',quickEditDateTimeEditorTimeInput:'quickEditDateTimeEditorTimeInput_233cf129'},LocationEditor_1:{locationEditor:'locationEditor_07a1042b',styleFix:'styleFix_07a1042b',hasLocationPill:'hasLocationPill_07a1042b',stickyEditor:'stickyEditor_07a1042b'},NumberEditor_5:{numberEditorUnit:'numberEditorUnit_b3b1adee'},PeopleEditor_7:{peopleEditor:'peopleEditor_9fd4d02d',increaseZIndex:'increaseZIndex_9fd4d02d',styleUpdates:'styleUpdates_9fd4d02d',inStickyMode:'inStickyMode_9fd4d02d'},TaxonomyEditor_2:{taxonomyEditorSpan:'taxonomyEditorSpan_97377dcd',increaseZIndex:'increaseZIndex_97377dcd'},headermgr_6:{spGridHeaderIconSpan:'spGridHeaderIconSpan_00a3e1f1',spGridHeaderCoreContent:'spGridHeaderCoreContent_00a3e1f1',gridHeaderCell:'gridHeaderCell_00a3e1f1',columnIsActive:'columnIsActive_00a3e1f1',resizeContainer:'resizeContainer_00a3e1f1',renameInputContainer:'renameInputContainer_00a3e1f1'},styles_9:{msGridBaseStyle:'msGridBaseStyle_9f05992a',msGridCell:'msGridCell_9f05992a',msGridCellReadonly:'msGridCellReadonly_9f05992a',msGridCellReadonlyFocused:'msGridCellReadonlyFocused_9f05992a'},Conversations_module_6:{fileHoverCardConversationsSection:'fileHoverCardConversationsSection_10fcc140',fileHoverCardConversationsTitle:'fileHoverCardConversationsTitle_10fcc140',fileHoverCardConversation:'fileHoverCardConversation_10fcc140',fileHoverCardConversationIcon:'fileHoverCardConversationIcon_10fcc140',fileHoverCardConversationParticipants:'fileHoverCardConversationParticipants_10fcc140',fileHoverCardConversationContext:'fileHoverCardConversationContext_10fcc140',fileHoverCardMeetingConversationContext:'fileHoverCardMeetingConversationContext_10fcc140',fileHoverCardConversationReferencePreview:'fileHoverCardConversationReferencePreview_10fcc140',fileHoverCardConversationSharedByUser:'fileHoverCardConversationSharedByUser_10fcc140',fileHoverCardConversationsMeetingIcon:'fileHoverCardConversationsMeetingIcon_10fcc140'},RelatedFiles_module_4:{fileHoverCardRelatedFilesSection:'fileHoverCardRelatedFilesSection_ec3a626d',fileHoverCardRelatedFilesTitle:'fileHoverCardRelatedFilesTitle_ec3a626d',fileHoverCardRelatedFile:'fileHoverCardRelatedFile_ec3a626d',fileHoverCardRelatedFilesName:'fileHoverCardRelatedFilesName_ec3a626d',fileHoverCardRelatedFileIcon:'fileHoverCardRelatedFileIcon_ec3a626d'},AnalyticsLifeCycle_module_8:{fileHoverCardLifeCycle:'fileHoverCardLifeCycle_bf67164d',fileHoverCardLifeCycleMessage:'fileHoverCardLifeCycleMessage_bf67164d',fileHoverCardLifeCycleTitle:'fileHoverCardLifeCycleTitle_bf67164d',fileHoverCardLifeCycleAction:'fileHoverCardLifeCycleAction_bf67164d',fileHoverCardLifeCycleNewSignal:'fileHoverCardLifeCycleNewSignal_bf67164d'},FileHoverCard_module_7:{fileHoverCardCompactCard:'fileHoverCardCompactCard_f3329bf4',fileHoverCardCompactCardTitleRegion:'fileHoverCardCompactCardTitleRegion_f3329bf4',fileHoverCardCompactCardFileIcon:'fileHoverCardCompactCardFileIcon_f3329bf4',fileHoverCardCompactCardTitle:'fileHoverCardCompactCardTitle_f3329bf4',titleNotExpanded:'titleNotExpanded_f3329bf4',fileHoverCardCompactCardActivity:'fileHoverCardCompactCardActivity_f3329bf4',fileHoverCardExpandedCard:'fileHoverCardExpandedCard_f3329bf4',fileHoverCardExpandedCardScrollableSection:'fileHoverCardExpandedCardScrollableSection_f3329bf4',fileHoverCardExpandedCardLoadError:'fileHoverCardExpandedCardLoadError_f3329bf4',fileHoverCardExpandedCardSuggestion:'fileHoverCardExpandedCardSuggestion_f3329bf4',fileHoverCardExpandedCardHostScroll:'fileHoverCardExpandedCardHostScroll_f3329bf4',fileHoverCardActivitiesSection:'fileHoverCardActivitiesSection_f3329bf4',fileCardExpandSectionContainer:'fileCardExpandSectionContainer_f3329bf4',fileCardExpandSectionButton:'fileCardExpandSectionButton_f3329bf4',collapsedFileCardTooltip:'collapsedFileCardTooltip_f3329bf4'},Sdk80FilePickerHost_module_4:{frame:'frame_4310f2e1'},ContentCenterModelImportBanner_module_1:{container:'container_1addcdca',closeButtonDiv:'closeButtonDiv_1addcdca',closeButton:'closeButton_1addcdca',bannerContent:'bannerContent_1addcdca',bannerHeaderContent:'bannerHeaderContent_1addcdca',bannerPrimaryContent:'bannerPrimaryContent_1addcdca',bannerPrimaryText:'bannerPrimaryText_1addcdca',bannerSecondaryText:'bannerSecondaryText_1addcdca',buttonStack:'buttonStack_1addcdca',bannerHeaderTagStyle:'bannerHeaderTagStyle_1addcdca',descriptionContainer:'descriptionContainer_1addcdca',descriptionText:'descriptionText_1addcdca',imageContainer:'imageContainer_1addcdca'}}});